

# ğŸŒŸ Unreal Engine 4 å…¥é—¨
- Installing Unreal Engine https://docs.unrealengine.com/4.26/en-US/Basics/InstallingUnrealEngine
- è®¸å¯ç”¨æˆ·çš„ä¸Šæ‰‹æŒ‡å— https://docs.unrealengine.com/4.27/zh-CN/Basics/InstallingUnrealEngine/CustomLicenseInstructions/GamesGettingStarted/
- Starter Content åˆå­¦è€…å†…å®¹èµ„æºåŒ… https://docs.unrealengine.com/4.27/zh-CN/Basics/Projects/Browser/Packs/
- Content Example ç¤ºä¾‹ä¸æ•™å­¦èµ„æº https://docs.unrealengine.com/4.27/zh-CN/Resources/
- è™šå¹»æ„å»ºç³»ç»Ÿ https://docs.unrealengine.com/4.27/zh-CN/ProductionPipelines/UnrealBuildSystem/
- UBT è™šå¹»å¼•æ“å’Œæ¸¸æˆç¼–è¯‘å·¥å…· https://docs.unrealengine.com/4.27/zh-CN/ProductionPipelines/BuildTools/
- è™šå¹»å¼•æ“ 4 æœ¯è¯­ https://docs.unrealengine.com/4.27/zh-CN/Basics/UnrealEngineTerminology/
- UE 4.23 HTML5 æ¸¸æˆå¼€å‘ https://docs.unrealengine.com/4.27/zh-CN/SharingAndReleasing/HTML5/
- Web Remote Control https://docs.unrealengine.com/4.27/zh-CN/ProductionPipelines/ScriptingAndAutomation/WebControl/
- Pixel Streaming Overview https://docs.unrealengine.com/4.27/zh-CN/SharingAndReleasing/PixelStreaming/PixelStreamingOverview/
- Pixel Streaming Demo https://docs.unrealengine.com/4.27/en-US/Resources/Showcases/PixelStreamingShowcase/
- Unreal Pixel Streaming in Azure https://docs.microsoft.com/en-us/gaming/azure/reference-architectures/unreal-pixel-streaming-in-azure
- UE5 å…¨æ–°æ¸²æŸ“ç‰¹æ€§ https://docs.unrealengine.com/5.0/zh-CN/RenderingFeatures
- å‰–æè™šå¹»æ¸²æŸ“ä½“ç³» - ç»¼è¿°å’ŒåŸºç¡€ https://www.cnblogs.com/timlly/p/13877623.html
- MetaHuman æ•°å­—äºº https://metahuman.unrealengine.com
- UE4 C++ ç¼–ç¨‹ç®€ä»‹ https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ProgrammingWithCPP/IntroductionToCPP/
- ç»´åº¦ï¼šæ•°å­¦æ¼«æ­¥ Dimensions: a walk through mathematics https://www.bilibili.com/video/BV1zg41177Dk?p=5
- 3B1B çº¿æ€§ä»£æ•°çš„æœ¬è´¨ - 07 - ç‚¹ç§¯ä¸å¯¹å¶æ€§ https://www.bilibili.com/video/BV1ys411472E?p=10

æ­£ç¡®çš„ Unreal Engine å­¦ä¹ å§¿åŠ¿ï¼š

- æœ‰ä¸€å®šçš„ C++ ç¼–ç¨‹è¯­è¨€åŸºç¡€ï¼›
- æœ‰ä¸€å®šçš„ C# åŸºç¡€ï¼Œå› ä¸ºæ¨¡å—åŒ–ç¼–ç¨‹éœ€è¦ä½¿ç”¨ï¼›
- ç†è§£å¯è§†åŒ–ç¼–ç¨‹çš„æ¦‚å¿µï¼Œå› ä¸º UE4 çš„ Blueprint å°±æ˜¯å¯è§†åŒ–è„šæœ¬ç¼–ç¨‹ï¼›
- æœ‰è®¡ç®—æœºå›¾å½¢å­¦åŸºç¡€ï¼Œäº†è§£ 3D æ¸¸æˆå¼•æ“çš„ä¸€äº›åŸºç¡€æ¦‚å¿µï¼Œå¦‚çŸ¥é“ä»€ä¹ˆæ˜¯æè´¨ã€ç€è‰²å™¨ã€éª¨éª¼åŠ¨ç”»èåˆç­‰ï¼›

è™šå¹»å¼•æ“å†ç» 20 å¤šå¹´çš„å‘å±•ï¼Œå·²ç»ä½œä¸ºä¸€æ¬¾å¼ºå¤§çš„é€šç”¨å¼•æ“ï¼Œè¢«å¹¿æ³›åº”ç”¨äºæ¸¸æˆåˆ¶ä½œï¼Œå½±è§†è™šæ‹Ÿåˆ¶ç‰‡ï¼ŒARï¼ŒVRï¼Œ
è®¾è®¡ä¸å¯è§†åŒ–è¡¨ç°ç­‰å¤šä¸ªé¢†åŸŸï¼ŒUE4 çš„å…¨çƒç”¨æˆ·å°±è¶…è¿‡ 400 ä¸‡äººã€‚

æœ€æ–°çš„ UE 5 é¢„å‘Šå®£ä¼ é‡Œæœ‰ä¸¤å¤§æ ¸å¿ƒæŠ€æœ¯ï¼š

- Lumenï¼Œå…¨å±€å…‰ç…§å’Œåå°„ç³»ç»Ÿï¼Œè§£å†³å®æ—¶æ¸²æŸ“ä¸­çš„å…¨å±€å…‰ç…§é—®é¢˜ï¼›
- Naniteï¼Œå®æ—¶åŒå±ä¸Šäº¿ä¸‰è§’å½¢ï¼Œå‡†å­åƒç´ çº§çš„å‡ ä½•æ¸²æŸ“æŠ€æœ¯ï¼›

å¯¹äºç°æœ‰é¡¹ç›®ï¼Œæ¯”å¦‚ä½¿ç”¨è™šå¹»å¼•æ“ 4 åˆ›å»ºçš„é¡¹ç›®ï¼Œä¸ä¼šè‡ªåŠ¨å¯ç”¨ Lumenï¼Œä¸ºäº†é˜²æ­¢ç ´åæˆ–æ›´æ”¹è¿™äº›é¡¹ç›®çš„
ä»»ä½•å…‰ç…§è·¯å¾„ã€‚

é€šè¿‡é¡¹ç›®é…ç½®å¯ç”¨ Lumen ç…§æ˜ï¼Œå°†åŠ¨æ€å…¨å±€å…‰ç…§ç±»åˆ«è®¾ç½®ä¸º Lumenã€‚è¿˜è¦å°†åå°„æ–¹æ³•ï¼ˆReflection Methodï¼‰
è®¾ç½®ä¸º Lumenï¼Œå¹¶å¯ç”¨ç”Ÿæˆç½‘æ ¼ä½“è·ç¦»åœºï¼ˆGenerate Mesh Distance Fieldsï¼‰ï¼Œåœ¨ Lumen çš„è½¯ä»¶
å…‰çº¿è¿½è¸ªæ¨¡å¼ä¸‹ï¼Œè¿™æ˜¯å¿…éœ€çš„ã€‚
Project Settings -> Rendering -> Dynamic Global Illumination


Naniteçš„ä¼˜åŠ¿

- å‡ ä½•ä½“å½¢çŠ¶çš„å¤æ‚åº¦æé«˜äº†æ•°ä¸ªæ•°é‡çº§ï¼›ä¸‰è§’å½¢å’Œå¯¹è±¡çš„å®æ—¶æ¸²æŸ“æ•°é‡è¾¾åˆ°äº†å‰æ‰€æœªæœ‰çš„é«˜åº¦ã€‚
- å¸§é¢„ç®—ï¼ˆFrame Budgetï¼‰ä¸å†ä¼šå› ä¸ºå¤šè¾¹å½¢æ•°é‡ã€ç»˜åˆ¶è°ƒç”¨å’Œå†…å­˜ä½¿ç”¨æƒ…å†µè€Œå—é™ã€‚
- å¯ä»¥ç›´æ¥å¯¼å…¥ç”µå½±çº§å“è´¨çš„ç¾æœ¯èµ„æºï¼Œä¾‹å¦‚ ZBrush é›•åˆ»æ¨¡å‹å’Œæ‘„å½±æµ‹é‡æ‰«ææ•°æ®
- é€šè¿‡é«˜æ¨¡å®ç°ç»†èŠ‚ï¼Œè€Œéé€šè¿‡çƒ˜åŸ¹æ³•çº¿è´´å›¾æ¥å®ç°
- è‡ªåŠ¨å¤„ç† LODï¼Œä¸å†éœ€è¦æ‰‹åŠ¨è®¾ç½®
- å“è´¨æŸå¤±æå°‘æˆ–æ²¡æœ‰æŸå¤±ï¼Œç‰¹åˆ«æ˜¯åœ¨ LOD å‘ç”Ÿè¿‡æ¸¡æ—¶


è™šæ‹Ÿçº¹ç†å¹¶ä¸è¦æ±‚ä¸Naniteä¸€èµ·ä½¿ç”¨ï¼Œä½†æ¨èè¿™ä¹ˆåšã€‚è™šæ‹Ÿçº¹ç†æ˜¯ä¸€ä¸ªå•ç‹¬çš„è™šå¹»å¼•æ“åŠŸèƒ½ï¼Œå®ƒä¸çº¹ç†æ•°æ®çš„
å…³ç³»ç±»ä¼¼äº Nanite å¯¹ç½‘æ ¼ä½“æ•°æ®çš„å…³ç³»ã€‚

å¯ä»¥é€šè¿‡å¤šç§æ–¹æ³•åœ¨ç¬¦åˆæ¡ä»¶çš„å‡ ä½•ä½“ä¸Šå¯ç”¨ Naniteï¼šåœ¨å¯¼å…¥æ—¶æ‰“å¼€ã€é€šè¿‡å•ç‹¬çš„ç½‘æ ¼ä½“ç¼–è¾‘å™¨æ‰“å¼€ã€æˆ–è€…åœ¨
å†…å®¹æµè§ˆå™¨ä¸­æ‰¹é‡è®¾ç½®ã€‚

- åœ¨å¯¼å…¥è¦ç”¨äº Nanite çš„ç½‘æ ¼ä½“æ—¶ï¼Œé€‰ä¸­ Mesh -> Build Nanite å¤é€‰æ¡†ï¼Œå†å¯¼å…¥ã€‚
- å¯¹äºå·²æœ‰çš„å¤§é‡å¸Œæœ›å¯ç”¨ Nanite çš„èµ„äº§ï¼Œé‚£ä¹ˆæœ‰ä¸¤ç§åŠæ³•ï¼šä¸€ä¸ªæ˜¯ä½¿ç”¨å†…å®¹æµè§ˆå™¨æ‰¹é‡å¯ç”¨èµ„äº§ï¼ŒäºŒæ˜¯åœ¨æ¯ä¸ªèµ„äº§çš„ç¼–è¾‘å™¨ä¸­å•ç‹¬å¯ç”¨ã€‚
- æ‰¹é‡é™æ€ç½‘æ ¼ä½“èµ„äº§å¯ç”¨ Naniteï¼Œåœ¨ Content Browser é€‰æ‹©å®ƒä»¬ï¼Œç„¶åå³é”®ç‚¹å‡»å¹¶é€‰æ‹© Nanite -> Enableã€‚
- ä½ ä¹Ÿå¯ä»¥åœ¨é™æ€ç½‘æ ¼ä½“èµ„äº§å’Œå‡ ä½•ä½“é›†åˆ ï¼ˆç”± Chaos ç‰©ç†ç³»ç»Ÿé©±åŠ¨çš„ç ´ç¢ç½‘æ ¼ä½“ï¼‰å„è‡ªçš„ç¼–è¾‘å™¨ä¸­å°†å…¶æ‰“å¼€ï¼Œå¹¶é€šè¿‡ Details é¢æ¿å¯ç”¨ã€‚
- å¯¹äºï¼ˆStatic Meshesï¼‰ï¼Œå…ˆæ‰“å¼€é™æ€ç½‘æ ¼ä½“èµ„äº§ï¼Œåœ¨ç»†èŠ‚é¢æ¿è®¾ç½® Details -> Nanite Settings -> Enabledï¼Œç‚¹å‡»ï¼ˆApply Changesï¼‰ æŒ‰é’®ã€‚
- å¯¹äºå‡ ä½•ä½“é›†åˆï¼ˆGeometry Collectionsï¼‰ï¼Œå…ˆæ‰“å¼€å‡ ä½•ä½“é›†åˆèµ„äº§ï¼Œè®¾ç½® Details ->  Nanite -> Enabledã€‚


ä»è™šå¹»å¼•æ“ 4.24 èµ·ï¼Œå¯¹ HTML5 å¹³å°çš„æ”¯æŒå·²ä»å¼•æ“è½¬ç§»åˆ°å…¬å¼€çš„å¹³å°æ‰©å±•ä¸Šï¼Œç”±ç¤¾åŒºæˆå‘˜ç»´æŠ¤å’Œæ”¹è‰¯ã€‚
æ‰€ä»¥ Unreal Engine 4.23.1 æ˜¯æœ€åä¸€ä¸ªé›†æˆ HTML5 å¹³å°æ”¯æŒçš„ç‰ˆæœ¬ã€‚

åŒæ—¶ï¼Œè™šå¹»å¼•æ“ 4.21 æ¨å‡ºçš„åƒç´ æµæŠ€æœ¯ Pixel Streaming ä½¿å¾—åœ¨ç½‘é¡µç«¯æµç•…ä½¿ç”¨å¤§å‹ç¨‹åºæˆä¸ºå¯èƒ½ï¼Œ
ä¹Ÿæ‰©å±•äº†è™šå¹»ç¨‹åºç»ˆç«¯çš„ä½¿ç”¨ç±»å‹ã€‚å®˜æ–¹çš„ MetaHubman æ•°å­—äººå·¥å…·ç°åœ¨å°±æ˜¯é€šè¿‡ Pixel Streaming 
æŠ€æœ¯åœ¨ Web æä¾›è¯•ç”¨ã€‚

åˆ©ç”¨åƒç´ æµé€æŠ€æœ¯ï¼Œå¯ä»¥åœ¨ç”¨æˆ·ä¸å¯è§çš„ç”µè„‘ä¸Šè¿œç¨‹è¿è¡Œè™šå¹»å¼•æ“åº”ç”¨ç¨‹åºï¼Œè€Œç©å®¶é€šè¿‡ä¸€ä¸ªæµè§ˆå™¨è¿è¡Œçš„ 
Web åº”ç”¨æ¥å‚ä¸æ¸¸æˆã€‚è™šå¹»å¼•æ“å°†ä½¿ç”¨è¯¥ç”µè„‘å¯ç”¨çš„èµ„æºï¼ˆCPUã€GPUã€å†…å­˜ç­‰ï¼‰æ¥è¿è¡Œæ¸¸æˆé€»è¾‘å¹¶æ¸²æŸ“æ¯ä¸€å¸§ã€‚
å®ƒä¼šä¸æ–­å°†æ­¤æ¸²æŸ“è¾“å‡ºç¼–ç åˆ°ä¸€ä¸ªåª’ä½“æµé€ä¸­ï¼Œå†é€šè¿‡ä¸€ä¸ªè½»é‡çº§çš„ç½‘é¡µæœåŠ¡å †æ ˆè¿›è¡Œä¼ é€’ã€‚ç”¨æˆ·å³å¯åœ¨å…¶ä»–
ç”µè„‘å’Œç§»åŠ¨è®¾å¤‡ä¸Šè¿è¡Œçš„æ ‡å‡†ç½‘é¡µæµè§ˆå™¨ä¸­æŸ¥çœ‹ç›´æ’­æµé€ï¼Œå¹¶å°†è¾“å…¥æ§åˆ¶å›ä¼ åˆ°è¿œç¨‹è¿è¡Œä¸­çš„è™šå¹»å¼•æ“ã€‚

å®‰è£… UE4 æ—¶ï¼Œå¯ä»¥é€‰æ‹©å®‰è£… StarterContentï¼Œè¿™æ¥è¿‘ 1GB çš„èµ„æºå¯ä»¥ç”¨äºåˆå§‹å­¦è€…å­¦ä¹ æ—¶ä½¿ç”¨ï¼Œé‡Œé¢
åŒ…å«ç”¨äºç¤ºèŒƒçš„å£°é¢‘ã€Blueprintsã€HDRIã€Mapsã€æè´¨ã€ç²’å­ã€çº¹ç†è´´å›¾ç­‰ã€‚

åœ¨åˆ›å»ºé¡¹ç›®æ—¶ï¼Œä½¿ç”¨ with Starter Content é€‰é¡¹å°±å¯ä»¥åœ¨é¡¹ç›®ä¸­ä½¿ç”¨è¿™äº›ç´ æçš„å‰¯æœ¬ï¼Œå¯ä»¥åœ¨é¡¹ç›®ä¸­
åˆ é™¤å®ƒã€‚åœ¨å†…å®¹æµè§ˆå™¨ä¸­åˆ é™¤ StarterContentï¼Œç„¶åå³é”®æœ€ä¸Šçº§å†…å®¹ï¼Œé€‰æ‹©ä¿®å¤ç›®å½•é‡å®šå‘ï¼š
Fix Up Redirectors in Folderã€‚

ç”¨æˆ·é€šè¿‡è‡ªå·±çš„æµè§ˆå™¨å¯¹ä½“éªŒè¿›è¡Œæ§åˆ¶ï¼Œå°†é”®ç›˜ã€é¼ æ ‡ã€è§¦æ‘¸äº‹ä»¶å’Œæ’­æ”¾å™¨ç½‘é¡µå‘å‡ºçš„è‡ªå®šä¹‰äº‹ä»¶å‘é€å›è™šå¹»å¼•æ“ã€‚

ä½¿ç”¨åƒç´ æµé€ç³»ç»Ÿæœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹ï¼š

- ç§»åŠ¨è®¾å¤‡å’Œè½»é‡çº§ç½‘é¡µæµè§ˆå™¨èƒ½å€Ÿæ­¤æ˜¾ç¤ºåŸæœ¬æ— æ³•æ˜¾ç¤ºçš„é«˜è´¨é‡ç”»é¢ã€‚å…¶èƒ½å€ŸåŠ©æ‹¥æœ‰å¼ºå¤§GPUçš„æœ¬åœ°æ¡Œé¢åº”ç”¨ç¨‹åºä¸­å¯ç”¨çš„æ¸²æŸ“åŠŸèƒ½ï¼Œä»¥é«˜åˆ†è¾¨ç‡æ˜¾ç¤ºå¤æ‚åœºæ™¯ã€‚
- ç”¨æˆ·æ— éœ€æå‰ä¸‹è½½å¤§å‹å¯æ‰§è¡Œæ–‡ä»¶æˆ–å†…å®¹æ–‡ä»¶ï¼Œä¹Ÿä¸éœ€è¦å®‰è£…ä»»ä½•å†…å®¹ï¼Œç”¨æˆ·éœ€è¦ä¸‹è½½çš„å”¯ä¸€å†…å®¹ä¾¿æ˜¯æ’­æ”¾çš„åª’ä½“æµé€çš„ Web åº”ç”¨ã€‚
- æ— éœ€åˆ›å»ºå¹¶å‘å¸ƒå¤šä¸ªå•ç‹¬çš„åŒ…å³å¯æ”¯æŒå¤šå¹³å°ï¼Œå¹¶ä¸”ç¨‹åºå­˜åœ¨æœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥é‡å¤ä½¿ç”¨ä¸”ä¸ç”¨æ‹…å¿ƒèµ„æºæ³„éœ²ã€‚é’ˆå¯¹ Windows æ‰“åŒ…åº”ç”¨ç¨‹åºåï¼Œç”¨æˆ·ä½¿ç”¨ä»»æ„å¹³å°å‡å¯ä½“éªŒé¡¹ç›®ã€‚ç”¨æˆ·å¯åœ¨ä»»æ„æ”¯æŒ WebRTC è¿æ¥æ¨¡å‹çš„ä¸»æµæµè§ˆå™¨ï¼ŒChrome æˆ– Firefoxï¼Œåœ¨ç”µè„‘ã€iOS å’Œ Android å¹³å°è§‚çœ‹æµé€ã€‚
- åƒç´ æµé€ç³»ç»Ÿæ‰€å«çš„ç»„ä»¶æ•°æå°‘ï¼Œåœ¨æœ¬åœ°ç½‘ç»œä¸­è¿›è¡Œè®¾ç½®ç›¸å¯¹å®¹æ˜“ã€‚ç„¶è€Œï¼Œç»éªŒä¸°å¯Œçš„å›¢é˜Ÿä¹Ÿå®Œå…¨å¯ä»¥å°†å…¶ç”¨ä½œåŸºç¡€æ¥åˆ›å»ºè‡ªå®šä¹‰äº‘ç«¯å¹³å°ï¼Œéƒ¨ç½²ç½‘é¡µæœåŠ¡ã€‚
- åƒç´ æµé€ä½¿ç”¨ WebRTC ç‚¹å¯¹ç‚¹é€šä¿¡æ¡†æ¶ï¼Œä½¿ç”¨è€…å’Œè™šå¹»å¼•æ“åº”ç”¨ç¨‹åºä¹‹é—´çš„å»¶è¿Ÿå¾ˆä½ã€‚

åƒç´ æµé€æ’ä»¶åœ¨è™šå¹»å¼•æ“ä¸­è¿è¡Œï¼Œå®ƒä½¿ç”¨ H.264 è§†é¢‘å‹ç¼©å¯¹æ¯ä¸ªæ¸²æŸ“å¸§çš„æœ€ç»ˆç»“æœè¿›è¡Œç¼–ç ï¼Œå°†è¿™äº›è§†é¢‘å¸§éšæ¸¸æˆéŸ³é¢‘ä¸€åŒæ‰“åŒ…åˆ°åª’ä½“æµé€ä¸­ï¼Œå¹¶é€šè¿‡ç›´æ¥ç‚¹å¯¹ç‚¹è¿æ¥å°†è¯¥æµé€å‘é€åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªè¿çº¿çš„æµè§ˆå™¨ä¸Šã€‚

å¦å¤–ä¸€ä¸ªç»„ä»¶å°±æ˜¯ä¿¡ä»¤ Web æœåŠ¡å™¨è´Ÿè´£äº¤æ¶‰æµè§ˆå™¨å’Œåƒç´ æµé€æ’ä»¶ä¹‹é—´çš„è¿æ¥ï¼Œå°†æ’­æ”¾åª’ä½“æµé€çš„ HTML å’Œ JavaScript ç¯å¢ƒæä¾›ç»™æµè§ˆå™¨ã€‚

åœ¨è™šå¹»å¼•æ“å®‰è£…æ–‡ä»¶å¤¹ä¸­å¯ä»¥æ‰¾åˆ°ä¿¡ä»¤æœåŠ¡å™¨ï¼ŒEngine/Source/Programs/PixelStreaming/WebServers/SignallingWebServerã€‚

UHT - Unreal Header Tool è™šå¹»å¤´æ–‡ä»¶åˆ†æå·¥å…·æ˜¯æ”¯æŒ UObject ç³»ç»Ÿçš„è‡ªå®šä¹‰è§£æå’Œä»£ç ç”Ÿæˆå·¥å…·ã€‚æ˜¯ Unreal engine èƒŒåå¼ºå¤§çš„åå°„æœºåˆ¶ï¼Œå¦‚ UENUM()ã€UCLASS()ã€USTRUCT()ã€UFUNCTION()ã€UPROPERTY() è¿™äº›å®ç”¨æ¥æ ‡è®°ä¸åŒçš„ç±»å‹å’Œæˆå‘˜å˜é‡ã€‚

ä»£ç ç¼–è¯‘åˆ†ä¸¤ä¸ªé˜¶æ®µè¿›è¡Œï¼š

- è°ƒç”¨ UHTï¼Œå®ƒå°†è§£æ C++ å¤´æ–‡ä»¶ä¸­å¼•æ“ç›¸å…³ç±»å…ƒæ•°æ®ï¼Œå¹¶ç”Ÿæˆè‡ªå®šä¹‰ä»£ç ï¼Œä»¥å®ç°è¯¸å¤š UObject ç›¸å…³çš„åŠŸèƒ½ã€‚
- è°ƒç”¨æ™®é€š C++ ç¼–è¯‘å™¨ï¼Œä»¥ä¾¿å¯¹ç»“æœè¿›è¡Œç¼–è¯‘ã€‚

UBT - Unreal Build Tool æ˜¯ UE4 ç¼–è¯‘å™¨ï¼Œç”± C# ç¼–å†™ï¼Œå½“ä½ è¿è¡Œ"GenerateProjectFiles"ï¼ˆä¸€ä¸ªæ‰¹å¤„ç†æ–‡ä»¶ï¼Œç”¨äº Window å¹³å°ä¸‹ç”Ÿæˆ Visual Studio çš„è§£å†³æ–¹æ¡ˆå’Œå·¥ç¨‹ï¼‰ï¼Œç¬¬ä¸€ä¸ªæ­¥éª¤å°±æ˜¯åœ¨ UE4 æºä»£ç  Source/Programs/UnrealBuildTool/UnrealBuiltTool.csproj å·¥ç¨‹ç›®å½•ä¸‹æ‰§è¡Œ MSBuild æ¥ç¼–è¯‘è¿™ä¸ª"Unreal Build Tool"ï¼Œæ‰€ä»¥å¯ä»¥ç†è§£UBTå…¶å®å°±æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œç¨‹åºï¼Œå´å¯ä»¥å®Œæˆå¾ˆå¤šäº‹æƒ…ï¼Œæ¯”å¦‚ç”Ÿæˆå·¥ç¨‹æ–‡ä»¶ã€æ‰§è¡Œ UBTã€ä¸ºå„ç§ä¸åŒçš„å¹³å°æ„å»ºé£æ ¼æ¥è°ƒç”¨ç¼–è¯‘å™¨ï¼ˆCompilerï¼‰å’Œé“¾æ¥å™¨ï¼ˆLinkerï¼‰

å¼€å‘è€…ç¼–å†™çš„ C++ ä»£ç ï¼Œç³…åˆ UHT è½¬æ¢æˆæ ‡å‡†çš„ C++ ä»£ç ï¼Œè€Œ UBT è´Ÿè´£è°ƒç”¨ UHT æ¥å®ç°è¿™ä¸ªè½¬åŒ–å·¥ä½œï¼Œè½¬åŒ–å®Œä¹‹å UBT è°ƒç”¨ C++ ç¼–è¯‘å™¨å®ŒæˆäºŒè¿›åˆ¶æ–‡ä»¶çš„ç¼–è¯‘ã€‚

è™šå¹»å¼•æ“ä¸­çš„ç±»æ‹¥æœ‰ä¸€ä¸ªæ ‡å‡†åŒ–çš„å‘½åæ–¹æ¡ˆï¼Œé€šè¿‡é¦–å­—æ¯æˆ–å‰ç¼€å³å¯ç«‹å³æ˜äº†å…¶ä¸ºå“ªç§ç±»ã€‚

GamePlay æ¶æ„ç±»çš„å‰ç¼€æœ‰ï¼š

- A ä»å¯ç”Ÿæˆçš„ GamePlay å¯¹è±¡çš„åŸºç¡€ç±»è¿›è¡Œæ‰©å±•ï¼Œå®ƒä»¬æ˜¯ Actor å­ç±»ï¼Œå¦‚ AControllerï¼Œå¯ç›´æ¥ç”Ÿæˆæ·»åŠ åˆ°ä¸–ç•Œåœºæ™¯ä¸­ã€‚
- U ä»æ‰€æœ‰ GamePlay çš„åŸºç¡€ç±»è¿›è¡Œæ‰©å±•ï¼Œå®ƒä»¬æ˜¯ UComponent å­ç±»ï¼Œæ— æ³•è¢«å®ä¾‹åˆ°ä¸–ç•Œåœºæ™¯ä¸­ï¼Œå¿…é¡»ä»å±äº Actorã€‚

ä»æºä»£ç ç»„ç»‡ä¸Šï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°å®ƒä»¬å½’å±äº Components å’Œ GameFramework ä¸¤ä¸ªä¸åŒçš„æ–‡ä»¶å¤¹ï¼Œé€»è¾‘ç”¨é€”çš„å·®åˆ«ä¹Ÿæ˜¯æ˜æ˜¾çš„ã€‚

UE4 GamePlay æ¶æ„ä¸­çš„åŸºæœ¬å¯¹è±¡è§£æï¼š

- `Actor` ä¸€ä¸ªå¯ä»¥åœ¨ä¸–ç•Œä¸­æ‘†æ”¾ï¼Œæˆ–è€…ç”Ÿæˆçš„è§’è‰²ã€‚
    - æ‰€æœ‰å¯ä»¥æ”¾å…¥å…³å¡çš„å¯¹è±¡éƒ½æ˜¯ Actorï¼Œæ¯”å¦‚æ‘„åƒæœºã€é™æ€ç½‘æ ¼ä½“ã€ç©å®¶èµ·å§‹ä½ç½®ã€‚
    - Actor æ”¯æŒä¸‰ç»´å˜æ¢ï¼Œä¾‹å¦‚å¹³ç§»ã€æ—‹è½¬å’Œç¼©æ”¾ã€‚ä½ å¯ä»¥é€šè¿‡æ¸¸æˆé€»è¾‘ä»£ç ï¼ˆC++æˆ–è“å›¾ï¼‰åˆ›å»ºï¼ˆç”Ÿæˆï¼‰æˆ–é”€æ¯ Actorã€‚
    - åœ¨ C++ ä¸­ï¼Œ`AActor` æ˜¯æ‰€æœ‰ Actor çš„åŸºç±»ã€‚
- `Pawn` æ˜¯ä¸€ä¸ªå¯ä»¥ä»æ§åˆ¶å™¨è·å¾—è¾“å…¥ä¿¡æ¯å¹¶è¿›è¡Œå¤„ç†çš„ `Actor`ã€‚
    - Pawn æ˜¯ Actor çš„å­ç±»ï¼Œå®ƒå¯ä»¥å……å½“æ¸¸æˆä¸­çš„åŒ–èº«æˆ–äººç‰©ï¼ˆä¾‹å¦‚æ¸¸æˆä¸­çš„è§’è‰²ï¼‰ã€‚
    - Pawn å¯ä»¥ç”±ç©å®¶æ§åˆ¶ï¼Œä¹Ÿå¯ä»¥ç”±æ¸¸æˆ AI æ§åˆ¶ï¼Œå¦‚éç©å®¶è§’è‰² NPCã€‚
    - å½“ Pawn è¢«äººç±»ç©å®¶æˆ– AIController æ§åˆ¶æ—¶ï¼Œå®ƒè¢«è§†ä¸ºå·²è¢«æ§åˆ¶ï¼ˆPossessedï¼‰ï¼Œå¦åˆ™è§†ä¸ºæœªè¢«æ§åˆ¶ï¼ˆUnpossessedï¼‰ã€‚
- `Character` äººç‰©è§’è‰²æ˜¯ä¸€ä¸ªåŒ…å«äº†è¡Œèµ°ï¼Œè·‘æ­¥ï¼Œè·³è·ƒä»¥åŠæ›´å¤šåŠ¨ä½œçš„ `Pawn`ï¼Œè¿˜å¯ä»¥æ·»åŠ ç”±ç©å®¶æ§åˆ¶çš„è¿åŠ¨é™„åŠ ä»£ç ã€‚
- `PlayerController` æ§åˆ¶å™¨è´Ÿè´£æ§åˆ¶åœºæ™¯ä¸­çš„ Actorã€‚
    - ç©å®¶æ§åˆ¶å™¨ Player Controller ä¼šè·å–æ¸¸æˆä¸­ç©å®¶çš„è¾“å…¥ä¿¡æ¯ï¼Œç„¶åè½¬æ¢ä¸ºäº¤äº’æ•ˆæœï¼Œæ¯ä¸ªæ¸¸æˆä¸­è‡³å°‘æœ‰ä¸€ä¸ªç©å®¶æ§åˆ¶å™¨ã€‚
    - ç©å®¶æ§åˆ¶å™¨é€šå¸¸ä¼šæ§åˆ¶ä¸€ä¸ª Pawn æˆ–è§’è‰²ï¼Œå°†å…¶ä½œä¸ºç©å®¶åœ¨æ¸¸æˆä¸­çš„åŒ–èº«ã€‚
    - åœ¨å¤šäººè”ç½‘æ¸¸æˆä¸­ï¼Œæ§åˆ¶å™¨è¿˜æ˜¯çš„ä¸»è¦ç½‘ç»œäº¤äº’èŠ‚ç‚¹ã€‚æœåŠ¡å™¨ä¼šä¸ºæ¸¸æˆä¸­çš„æ¯ä¸ªç©å®¶ç”Ÿæˆä¸€ä¸ªç©å®¶æ§åˆ¶å™¨å®ä¾‹ï¼Œå› ä¸ºå®ƒå¿…é¡»å¯¹æ¯ä¸ªç©å®¶è¿›è¡Œè”ç½‘æ§åˆ¶ã€‚
    - æ¯ä¸ªå®¢æˆ·ç«¯åªæ‹¥æœ‰ä¸å…¶ç©å®¶ç›¸å¯¹åº”çš„ç©å®¶æ§åˆ¶å™¨ï¼Œå¹¶ä¸”åªèƒ½ä½¿ç”¨å…¶ç©å®¶æ§åˆ¶å™¨ä¸æœåŠ¡å™¨é€šä¿¡ã€‚
- `Game Mode` æ¸¸æˆæ¨¡å¼ç±»è´Ÿè´£è®¾ç½®å½“å‰æ¸¸æˆçš„è§„åˆ™ã€‚è§„åˆ™åŒ…æ‹¬ï¼š
    - 1.ç©å®¶å¦‚ä½•åŠ å…¥æ¸¸æˆã€‚
    - 2.æ˜¯å¦å¯ä»¥æš‚åœæ¸¸æˆã€‚
    - 3.ä»»ä½•ä¸æ¸¸æˆç›¸å…³çš„è¡Œä¸ºï¼Œä¾‹å¦‚è·èƒœæ¡ä»¶ç­‰ç­‰ã€‚
- `World` ä¸–ç•Œåœºæ™¯æ˜¯ä¸€ä¸ªå®¹å™¨ï¼ŒåŒ…å«äº†æ¸¸æˆä¸­çš„æ‰€æœ‰å…³å¡ã€‚å®ƒå¯ä»¥å¤„ç†å…³å¡æµé€ï¼Œè¿˜èƒ½ç”ŸæˆåŠ¨æ€ Actorã€‚
- `Level` å…³å¡ï¼Œå³æ¸¸æˆé˜¶æ®µé€»è¾‘çš„æ‹†åˆ†ï¼Œæ¯”å¦‚å®Œæˆä¸€ä¸ªæ¸¸æˆä»»åŠ¡ï¼Œé€šå¸¸ä¿å­˜åœ¨ Maps ç›®å½•ã€‚ä»»æ„ä¸ªå…³å¡ç»„æˆä¸€ä¸ª Worldï¼Œæ¯ä¸ªå…³å¡é‡ŒåŒ…å«å¤šä¸ª Actorã€‚ç›¸åº”çš„ ULevel ç±»ä¹Ÿæ˜¯ç»§æ‰¿äº UObjectï¼Œæ‰€ä»¥æ”¯æŒè“å›¾ï¼Œå¯¹åº”å…³å¡è“å›¾ ALevelScriptActorã€‚

ä¸åŒçš„æ¸¸æˆå¼•æ“å¼€å‘è€…æ€ç»´ä¹Ÿä¸ä¸€æ ·ï¼ŒCocos2dx ä¸­ï¼Œè®¤ä¸ºæ¸¸æˆä¸–ç•Œç”± Scene ç»„æˆï¼Œæ¯ä¸ªåœºæ™¯å†ç”±å¤šä¸ª Layer å±‚å è¡¨ç°ï¼Œç„¶åç”±ä¸€ä¸ª Director æ¥å¯¼æ¼”æ•´ä¸ªæ¸¸æˆã€‚

                        +-------------+
                        |    Game     |
                        |  GameMode   |
                        |  GameState  |
                        +------^------+
                               |
         Contains:  +----------+-----------+           +---------------+
       +----------- |    PlayerController  |           |  AIController |
       |            +----------+-----------+           +-------+-------+
       |                       |                               |
       |    +---------+        | Possess  +---------+  Possess |
       +--> |   HUD   |        +--------> |   Pawn  | <--------+
       |    +---------+                   +---------+
       |    +---------+
       +--> |  Input  |
       |    +---------+
       |    +------------------------+
       +--> |  PlayerCameraManager   |
            +------------------------+

[GamePlay Framework Class Relationships](https://docs.unrealengine.com/4.27/en-US/InteractiveExperiences/Framework/QuickReference/)

UE4 ä¸­ Brush è¿™ä¸ªæ¦‚å¿µæœ‰ç‚¹ç‰¹åˆ«ï¼Œå®ƒå¯ä»¥ç”¨ Mesh å½“ä½œé™æ€æ¨¡å‹çš„æ„é€ å…ƒä»¶ï¼Œä½†æ˜¯ç”¨å¾—è¶Šå¤šå°±éœ€è¦è¶Šå¤šå†…å­˜ï¼Œå› ä¸º UE4 éœ€è¦ä¸æ–­åœ°å¤åˆ¶å‰¯æœ¬ï¼Œå°±åƒæ˜¯ç”»ç¬”ä¸Šçš„é¢œæ–™ä¸æ–­åœ°æ¶ˆè€—ã€‚è€Œ Static Mesh å°±ä¸åŒï¼Œå®ƒå°±æ˜¯ç°åœ¨çš„ä¸€ç»„æ•°æ®ï¼Œç›´æ¥å¤ç”¨ï¼Œä¸ç”¨å¤åˆ¶ã€‚å‚è€ƒ Beginning Unreal Game Development by David Nixonã€‚


# ğŸŒŸ Viewport Shortcut
- Gameplay Debugger https://docs.unrealengine.com/4.26/zh-CN/ProgrammingAndScripting/GameplayDebugger/
- è™šå¹»å¼•æ“ä¸­çš„å„ç§åæ ‡ç©ºé—´ https://docs.unrealengine.com/4.27/zh-CN/Basics/Actors/CoordinateSpace/
- Viewport Basics https://docs.unrealengine.com/4.27/en-US/BuildingWorlds/LevelEditor/Viewports/Basics/
- Viewport Modes https://docs.unrealengine.com/4.27/zh-CN/BuildingWorlds/LevelEditor/Viewports/ViewModes/
- Viewport Controls https://docs.unrealengine.com/4.27/zh-CN/BuildingWorlds/LevelEditor/Viewports/ViewportControls/
- ç¼–è¾‘å™¨ VR æ¨¡å¼ https://docs.unrealengine.com/4.27/zh-CN/BuildingWorlds/VRMode
- Useful Editor Preferences https://benui.ca/unreal/useful-editor-preferences/
- ç½‘æ ¼ä½“ç»˜åˆ¶ç”¨æˆ·æŒ‡å— https://docs.unrealengine.com/4.27/zh-CN/BuildingWorlds/LevelEditor/Modes/MeshPaintMode/VertexColor/

å…³å¡ç¼–è¾‘å™¨æ˜¯æœ€å¸¸ç”¨çš„ç•Œé¢ï¼Œæ‰“å¼€ UE ç¼–è¾‘å™¨ç•Œé¢åŸºæœ¬ä¸Šå°±æ˜¯åœ¨ä½¿ç”¨å…³å¡ç¼–è¾‘å™¨ã€‚

é¦–å…ˆï¼Œè®¾ç½®ä½ çš„ç¼–è¾‘å™¨ï¼Œå°†èµ„äº§ç¼–è¾‘å™¨çª—å£çš„é»˜è®¤æ¨¡å¼æ”¹ä¸º Main Windownï¼Œè¿™æ ·å°±å¯ä»¥ä½œä¸ºä¸»çª—å£çš„é€‰é¡¹å¡å‡ºç°ï¼ŒèŠ‚çœåˆ‡æ¢çª—å£çš„éº»çƒ¦ã€‚General > Appearance > User Interface > Asset Editor Open Location to Main Window

å¦å¤–ï¼Œå„ç§èµ„äº§ç¼–è¾‘è¿‡åä¼šéœ€è¦ç¼–è¯‘æ“ä½œï¼Œè®¾ç½® Save on Compile ä¸º On Success Only å¯ä»¥è‡ªåŠ¨æ‰§è¡Œä¿å­˜ã€‚

å¯ä»¥åœ¨ç¼–è¾‘å™¨é…ç½® Level Editor - Viewports - Controls æ‘„åƒæœºé£è¡Œç±»å‹ Flight Camera Control Typeï¼Œé»˜è®¤æ˜¯ Use WASD only when a Mouse Button is Pressedã€‚

æŒæ¡ Viewport è§†å›¾çš„å¯¼èˆªæ“ä½œå¾ˆé‡è¦ï¼Œå…³é”®æ˜¯ Focus ç„¦ç‚¹ï¼Œè§†åœºè§’ FOV - Field-of-View å’Œç§»åŠ¨åŠæ—‹è½¬çš„æŠŠæ¡ï¼š

- æŒ‰ä½ Left Button å‘å‰ç§»ã€å‘åé€€å¯¹åº”ç§»åŠ¨å°†æ‘„åƒæœºä½ï¼Œå·¦å³ç§»åŠ¨è¡¨ç¤ºæ—‹è½¬æ‘„åƒæœºçš„æ–¹å‘ï¼Œå¯¹åº” WASD åŠŸèƒ½é”®ã€‚
- æŒ‰ä½ Right Button ç§»åŠ¨é¼ æ ‡åˆ™æ˜¯æ‘‡åŠ¨æ‘„åƒæœºé•œå¤´æ–¹å‘ï¼›
- æŒ‰ä½ Left + Rigth Button åˆ™å¯ä»¥æ²¿ Z è½´è¿›è¡Œå‡é™ç§»åŠ¨æ‘„åƒæœºï¼Œä»¥åŠå·¦å³ç§»åŠ¨ã€‚
- æŒ‰ä½ Alt + Left Button å†ç§»åŠ¨é¼ æ ‡å¯¹åœºæ™¯è¿›è¡Œå„ä¸ªè½´çš„æ—‹è½¬ï¼Œä»¥æ‘„åƒ*ç„¦ç‚¹*ä¸ºä¸­å¿ƒç‚¹ã€‚
- æŒ‰ä½ Alt + Right Button å·¦å³ç§»åŠ¨é¼ æ ‡ï¼Œå¯¹åº”è¿œç¦»æˆ–æ¨è¿‘é•œå¤´åˆ°*ç„¦ç‚¹*ã€‚
- æ»šè½®è°ƒæ•´ FOV è§†åœºè§’ï¼Œå¯ä»¥æ”¾å¤§æˆ–ç¼©å°ç”»é¢ï¼ŒæŒ‰ç€é¼ æ ‡æ—¶ä½¿ç”¨ Z å’Œ C é”®ä¸´æ—¶è°ƒæ•´ FOVã€‚
- ä½¿ç”¨ F å¯ä»¥èšé›†åˆ°é€‰ä¸­çš„ Static Mesh å¯¹è±¡ï¼Œå¦‚æœå¯¹è±¡å†…éƒ¨æœ‰æ‘„åƒæœºæœºç»„ä»¶ï¼Œåˆ™ä¼šå®šä½åˆ°å†…éƒ¨è§†è§’ã€‚
- åœ¨å…¶å®ƒç¼–è¾‘å™¨ä¸­ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ Browser åŠŸèƒ½ï¼ŒCtrl + B æ¥å®šä½å¯¹è±¡åœ¨ Content Browser çš„ç›®å½•ä½ç½®ã€‚

å°†æ‘„åƒæœºèšç„¦åœ¨é€‰å®šå¯¹è±¡ä¸Šï¼Œè¦å……åˆ†åˆ©ç”¨ç¿»è½¬æ‘„åƒæœºï¼Œåªè¦ä½ å®šä½å¥½è§‚å¯Ÿç‰©ä½“çš„é•œå¤´çš„è§’åº¦ï¼ŒæŒ‰ä¸‹ F é”®å°±ä¼šè‡ªåŠ¨å¸®ä½ å°†é•œå¤´ç§»åŠ¨åˆ°ç‰©ä½“çš„å‰æ–¹ã€‚

å¯¹äºæœ‰ SkyAtmosphere å’Œ VolumetricCloud çš„åœºæ™¯ï¼Œå¦‚ DayOfTime å…³å¡æ¨¡æ¿ï¼Œéœ€è¦å°†é•œå¤´å®šä½åˆ°ä¸€ç™¾ä¸‡ç±³çš„é«˜å±‚å¤©ç©ºï¼ŒViewport è§†å£æ‘„åƒæœºé•œå¤´åæ ‡ä¸èƒ½ç›´æ¥è®¾ç½®ï¼Œå¯ä»¥é€šè¿‡æ”¾ç½® Actor å¹¶è®¾ç½®ç›¸åº”çš„ Z è½´é«˜åº¦ï¼Œä¿æŒé€‰ä¸­çŠ¶æ€å¹¶æŒ‰ F é”®å°±å¯ä»¥å°†é•œå¤´ç§»åˆ°ç›¸åº”çš„é«˜åº¦ã€‚

åœ¨åœºæ™¯ä¸­ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ Pilot åŠŸèƒ½ï¼ŒCtrl + Shift + Pï¼Œé€‰æ‹©ç‰©ä½“è¿›å…¥é£è¡Œæ¨¡å¼åï¼Œå°±å¯ä»¥ä½¿ç”¨ä»¥ä¸Šçš„æ“ä½œæ¥ç»™ Flying Mode çŠ¶æ€çš„å¯¹è±¡è®¾ç½®ä½ç½®ã€æ—‹è½¬ç­‰å±æ€§ï¼Œå¹¶ä¸”å®æ—¶è§‚å¯Ÿåˆ°å¯¹è±¡æ­£é¢çš„ç”»é¢ã€‚è®¾ç½®å®Œæˆåï¼Œé€šè¿‡ Viewport å·¦ä¸Šè§’çš„ Stop Piloting é€€å‡ºé£è¡Œæ¨¡å¼ã€‚

é€‰ä¸­æ‘„åƒæœºæ—¶ï¼Œä¼šæœ‰é•œå¤´ç”»é¢é¢„è§ˆçª—å£ï¼Œå¯ä»¥è°ƒæ•´å¤§å°ï¼šEditor Settings -> Level Editor -> Viewports -> Look and Feel -> Preview Selected Cameras, Camera Preview Size, Use Camera Location from Play-In-Viewportã€‚

åœ¨æ¸¸æˆè¿è¡Œæ—¶æŒ‰ä¸‹æ’‡å·ï¼ˆ'ï¼‰é”®å³å¯å¯ç”¨ AI è°ƒè¯•ï¼Œåˆ†å·ï¼ˆ;ï¼‰é”®æ‰“å¼€ Gameplay Debuggerï¼Œå®ƒä¼šæ·»åŠ ä¸€ä¸ªæ”¯æŒ WASD è¿åŠ¨çš„æ‘„åƒæœºã€‚

UE 4 ä¸å†ä½¿ç”¨ 1 uu = 0.75 in = 1.905 cm è¿™æ ·çš„å•ä½ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨ cmï¼Œåœ¨å·¥ç¨‹é…ç½®å¯ä»¥è®¾ç½® Measuring Tool Unitï¼ŒCentimeters/Meters/Kilometersã€‚

UE4 åæ ‡ç³»ç»Ÿä½¿ç”¨ Z è½´æœä¸‹çš„å·¦æ‰‹åæ ‡ç³»ç»Ÿï¼Œæ‹‡æŒ‡å¯¹åº” Y è½´å‘å³ï¼Œé£ŸæŒ‡å¯¹åº” Z è½´å‘å‰ï¼Œä¸­æŒ‡å¯¹åº” X è½´ã€‚åœ¨ 3D è§†å›¾ä¸­ X è½´å‘å³ï¼ŒY è½´å‘å‚ç›´å±å¹•å‘å¤–ï¼ŒZ è½´å‘ä¸Šï¼Œåˆ†åˆ«ç”¨çº¢ã€é»„ã€è“ä¸‰ç§è‰²è¡¨ç¤ºã€‚å’Œ Blender çš„åæ ‡ç³»ç»Ÿä¸åŒï¼Œå®ƒä½¿ç”¨å³æ‰‹åæ ‡ç³»ç»Ÿï¼Œæ‹‡æŒ‡å¯¹åº” X è½´æ­£æ–¹å‘å³ï¼Œé£ŸæŒ‡å¯¹åº” Y è½´æ­£å‘å‚ç›´äºå±å¹•å‘é‡Œï¼Œæœå‘åˆšå¥½å’Œ UE4 ç›¸åï¼Œä¸­æŒ‡å¯¹åº” Z è½´ç«–èµ·å‘ä¸Šã€‚

é”å®šä¸€ä¸ªè½´å‘ï¼Œå°±è¡¨ç¤ºä¸èƒ½åœ¨è¿™ä¸ªè½´ä¸Šç§»åŠ¨ï¼Œæˆ–è€…ä¸èƒ½ä»¥è¿™ä¸ªè½´ä¸ºä¸­å¿ƒè¿›è¡Œæ—‹è½¬ã€‚

åœ¨èˆªç©ºé¢†åŸŸï¼ŒX è½´æ­£æ–¹å‘ä¸ºå³æ–¹ï¼ŒY è½´æ­£æ–¹å‘ä¸ºä¸Šæ–¹ï¼ŒZ è½´è´Ÿæ–¹å‘ä¸ºå‰æ–¹ï¼š

- Pitch ä¿¯ä»°è§’è°ƒæ•´å³ä»¥ Y è½´ä¸ºä¸­å¿ƒæ—‹è½¬ï¼›
- Yaw åèˆªè§’è°ƒæ•´å³ä»¥ Z è½´ä¸ºä¸­å¿ƒæ—‹è½¬ï¼›
- Roll æ»šè½¬è§’è°ƒæ•´å³ä»¥ X è½´ä¸ºä¸­å¿ƒæ—‹è½¬ï¼›

è™šå¹»ç¼–è¾‘å™¨ä¸­ä¸»è¦æœ‰ä¸¤ç§è§†å£ç±»å‹ï¼šé€è§†å’Œæ­£äº¤è§†å›¾ Perspective & Orthographicã€‚é€è§†è§†å›¾æ˜¯è¿›å…¥æ¸¸æˆåœºæ™¯ çš„ä¸€ä¸ª 3D çª—å£ã€‚æ­£äº¤è§†å›¾ï¼ˆæ­£é¢è§†å›¾ã€ä¾§é¢è§†å›¾å’Œé¡¶éƒ¨è§†å›¾ï¼‰æ˜¯ 2D è§†å£ï¼Œæ¯ä¸ªè§†å›¾ä¿¯è§†ä¸€ä¸ªä¸»è½´ï¼ˆXè½´ã€Yè½´æˆ–Zè½´ï¼‰ã€‚

å¯ä»¥è®¾æƒ³åœ¨è§†å£ä¸­ï¼Œæ²¿ X è½´æ”¾ä¸€æ¶é£æœºï¼Œæœºå¤´å‘å³ï¼Œå³æœå‘ X è½´æ­£å‘ã€‚Pitch å°±æ˜¯æŠ¬èµ·æˆ–ä¸‹é™æœºå¤´è§’åº¦ï¼ŒRoll å°±æ˜¯å°†æœºèº«æ²¿ X è½´æ—‹è½¬çš„ç¿»æ»šï¼ŒYaw å°±æ˜¯æŒ‰é©¾é©¶å‘˜çš„è§†è§’å·¦å³åè½¬ï¼Œæ²¿ç€ Z è½´æ—‹è½¬ã€‚é»˜è®¤çŠ¶æ€ä¸‹ï¼Œé€è§†è§†å£çš„é•œå¤´ä½äºæ¥è¿‘ Right è§†å£çš„ä¸€ä¸ªè§’åº¦ã€‚Front è§†å£å¾€ X è½´è´Ÿå‘çœ‹ï¼ŒLeft è§†å£å¾€ Y è½´æ­£å‘å‘ï¼ŒTop è§†å£å¾€ Z è½´è´Ÿå‘çœ‹ã€‚

ä¸‰ç»´è½¯ä»¶å¯¹è±¡çš„æ“ä½œç•Œé¢é€šå¸¸å« Gizmoï¼Œå¯¹è±¡çš„è°ƒç”¨ä½¿ç”¨ä¸¤ä¸ªåæ ‡ç³»ç»Ÿï¼Œä¸€ä¸ªå…¨å±€åæ ‡ Global Spaceï¼Œå¦ä¸€ä¸ªæ˜¯å¯¹è±¡å†…éƒ¨åæ ‡ Local Spaceï¼Œä½¿ç”¨ Ctrl + ~ åˆ‡æ¢ã€‚å…¨å±€åæ ‡å°±æ˜¯ Viewport å·¦ä¸‹è§’æ˜¾ç¤ºçš„åæ ‡ã€‚è¿™ä¸¤ä¸ªåæ ‡äº’ç›¸å½±å“ï¼Œåˆšæ·»åŠ åˆ°åœºæ™¯çš„å¯¹è±¡ï¼Œé»˜è®¤ä¸¤ä¸ªåæ ‡ä¿æŒæ–¹å‘ä¸€è‡´ã€‚ä½†æ˜¯ï¼Œå°†å¯¹è±¡ Local Space è¿›è¡Œæ—‹è½¬ä¸€ä¸‹ï¼Œæ¯”å¦‚æ²¿ Y è½´æ—‹è½¬ 90Â°ï¼Œå…ˆåˆ‡æ¢ä¸º Local Space å†æ—‹è½¬æ“ä½œã€‚å°±æ˜¯å¾€ Y è½´è´Ÿæ–¹å‘çœ‹ï¼Œè®©ç‰©ä½“é€†æ—¶é’ˆè½¬ 90Â°ï¼Œè¿™å’Œæ•°å­¦ä¸Šçš„äºŒç»´åæ ‡æ—‹è½¬åŒæ ·ã€‚æ—‹è½¬åï¼Œå¯¹è±¡çš„å±€éƒ¨åæ ‡å˜æˆ X è½´æŒ‡å‘ä¸Šå³åŸå…ˆ Z è½´çš„æ­£å‘ï¼Œè€Œæ–°çš„ Z è½´æŒ‡å‘åŸå…ˆ X è½´è´Ÿæ–¹å‘ã€‚è¿™é‡Œç§»åŠ¨å¯¹è±¡ï¼Œå¦‚æœæŒ‰æœ¬åœ° X è½´æ–¹å‘ç§»åŠ¨ï¼Œé‚£ä¹ˆå°±ç›¸å½“åœ¨å…¨å±€ç©ºé—´çš„ Z è½´æ–¹å‘ç§»åŠ¨ã€‚åœ¨ç¨‹åºå¤„ç†ä¸­ï¼Œå°±éœ€è¦è€ƒè™‘è¿™ä¸ªå…³ç³»ï¼Œæ¯”å¦‚æœ¬åœ°åæ ‡çš„æŸä¸ªç‚¹æ˜ å°„å…¨å±€ç©ºé—´çš„ä»€ä¹ˆåæ ‡ï¼Œç›¸äº’ä¹‹é—´éœ€è¦è¿›è¡Œå˜æ¢ã€‚

åœ¨ Details -> Transform é¢æ¿ä¸­ï¼ŒLocationã€Rotationã€Scale ç­‰å±æ€§éƒ½å¯ä»¥è®¾ç½® Relative æˆ– Worldï¼Œä½†å¯¹è±¡åˆšæ·»åŠ åˆ°åœºæ™¯ä¸­ï¼Œæ‰€ä»¥å…¶çˆ¶çº§å°±æ˜¯ Worldï¼Œè¿™ä¸ªè®¾ç½®æ²¡æœ‰å½±å“ã€‚ä½†æ˜¯ï¼Œå½“å¯¹è±¡æ·»åŠ åˆ°å…¶å®ƒå¯¹è±¡å†…éƒ¨ä½œä¸ºå­å¯¹è±¡åï¼Œè¿™ä¸ªç›¸å¯¹æŒ‡çš„å°±æ˜¯ä¸æ˜¯ç›¸å¯¹ World è€Œæ˜¯å¦å¤–é‚£ä¸ªçˆ¶çº§å¯¹è±¡äº†ã€‚

è§†å£é€‰é¡¹åŠŸèƒ½æ“ä½œï¼š

- Ctrl + Shift + T æ˜¾ç¤º/éšè—å·¥å…·æ¡ Hide Viewport UIï¼›
- Ctrl + Shift + H æ˜¾ç¤º FPS å¸§ç‡ï¼Œç­‰äºè¿è¡Œæ§åˆ¶å°å‘½ä»¤ stat fpsï¼›
- Shift + L æ˜¾ç¤ºåŸºæœ¬ç»Ÿè®¡ä¿¡æ¯ï¼Œç­‰äºè¿è¡Œæ§åˆ¶å°å‘½ä»¤ stat unitï¼›

é€‰ä¸­å¯¹è±¡æ“ä½œï¼š

- Escape å–æ¶ˆé€‰æ‹©ï¼›
- W ä½¿ç”¨ç§»åŠ¨æ“ä½œå·¥å…·ï¼›
    - Alt + æ‹–åŠ¨ï¼Œå¤åˆ¶å¯¹è±¡ï¼Œç›¸å½“ Ctrl + Wï¼›
    - Shift + æ‹–åŠ¨ï¼Œç§»åŠ¨å¯¹è±¡å‘¨æ—¥ä¹Ÿç§»åŠ¨é•œå¤´ï¼›
    - Ctrl + æ‹–åŠ¨ï¼ˆLMBï¼‰ï¼Œé”å®šåˆ° X è½´å‘ç§»åŠ¨ï¼›
    - Ctrl + æ‹–åŠ¨ï¼ˆRMBï¼‰ï¼Œé”å®šåˆ° Y è½´å‘ç§»åŠ¨ï¼›
    - Ctrl + æ‹–åŠ¨ï¼ˆLMB+RMBï¼‰ï¼Œé”å®šåˆ° Z è½´å‘ç§»åŠ¨ï¼›
- E ä½¿ç”¨æ—‹è½¬æ“ä½œå·¥å…·ï¼›
    - CTRL + æ‹–åŠ¨ï¼ˆLMBï¼‰ï¼Œæ²¿ç€ X è½´æ—‹è½¬ï¼›
    - CTRL + æ‹–åŠ¨ï¼ˆRMBï¼‰ï¼Œæ²¿ç€ Y è½´æ—‹è½¬ï¼›
    - CTRL + æ‹–åŠ¨ï¼ˆLMB+RMBï¼‰ï¼Œæ²¿ç€ Z è½´æ—‹è½¬ï¼›
- R ä½¿ç”¨ç»½æ”¾æ“ä½œå·¥å…·ï¼›
    - CTRL + æ‹–åŠ¨ï¼ˆLMBï¼‰ï¼Œæ²¿ç€æ‰€æœ‰è½´ä¸€è‡´ç¼©æ”¾ï¼ˆæ­£äº¤å’Œé€è§†è§†å£éƒ½é€‚ç”¨ï¼‰ï¼›
- V åˆ‡æ¢é¡¶ç‚¹å¯¹é½ï¼Œå®ƒå…è®¸ä½ å¯¹é½åˆ°åœºæ™¯ä¸­å…¶ä»–å‡ ä½•ä½“çš„é¡¶ç‚¹ã€‚

æ­£äº¤è§†å£ä¸‹çš„ç§»åŠ¨å·¥å…·ã€ç¼©æ”¾å·¥å…·å¯ä»¥ä½¿ç”¨ Ctrl + æ‹–åŠ¨ï¼ˆLMBï¼‰æ¥çº¦æŸè½´å‘ã€‚

è§†å›¾åˆ‡æ¢ï¼š

- ALT + G åˆ‡æ¢åˆ° Perspective Viewportï¼›
- ALT + H/J/K åˆ†åˆ«åˆ‡æ¢ Front/Top/Left è§†å£ã€‚
- ALT + Shift + H/J/K åˆ†åˆ«åˆ‡æ¢ Back/Bottom/Right è§†å£ã€‚
- G å¯ç”¨æ¸¸æˆè§†å›¾ï¼Œéšè—ä¸å¯è§çš„ Actor å’Œè¾…åŠ©å·¥å…·ï¼›
- F11 æ²‰æµ¸æ¨¡å¼ï¼ˆImmersive Modeï¼‰å³å°†å½“å‰è§†å£å…¨å±åŒ–å‡å°‘å…¶å®ƒå¹²æ‰°å› ç´ ï¼›

åœ¨ Mac è®¡ç®—æœºä¸Šï¼ŒSystem Preference -> Mouse ä¸­ä¸ºé¼ æ ‡å¯ç”¨è¾…åŠ©ç‚¹å‡»åï¼Œæˆ–åœ¨ System Preference -> Trackpad ä¸­ä¸ºè§¦æ§æ¿å¯ç”¨ä¸¤æ ¹æ‰‹æŒ‡è¾…åŠ©ç‚¹å‡»åï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹åŠŸèƒ½æŒ‰é’®ã€‚

é€è§†è§†å£æ“ä½œï¼š

- å•æŒ‡ç‚¹å‡» + æ‹–åŠ¨ï¼Œå‰åç§»åŠ¨æ‘„åƒæœºï¼Œå¹¶å·¦å³æ—‹è½¬ã€‚
- åŒæŒ‡ç‚¹å‡» + æ‹–åŠ¨ï¼Œè½¬è§†å£æ‘„åƒæœºã€‚
- åŒæŒ‡ç‚¹è§¦ + æ‹–åŠ¨ï¼Œæ—‹è½¬è§†å£æ‘„åƒæœºã€‚

æ­£äº¤ï¼ˆé¡¶ç«¯ã€å‰ç«¯ã€ä¾§é¢ï¼‰æ“ä½œï¼š

- å•æŒ‡ç‚¹å‡» + æ‹–åŠ¨ï¼Œåˆ›å»ºä¸€ä¸ªåŒºåŸŸé€‰æ‹©æ¡†ã€‚
- åŒæŒ‡ç‚¹å‡» + æ‹–åŠ¨ï¼Œå¹³ç§»è§†å£æ‘„åƒæœºã€‚
- åŒæŒ‡ç‚¹è§¦ + æ‹–åŠ¨ï¼Œå¹³ç§»è§†å£æ‘„åƒæœºã€‚


è™šå¹»ç¼–è¾‘å™¨è§†å£æä¾›äº†è®¸å¤šå¯è§†åŒ–æ¨¡å¼æ¥å¸®åŠ©æ‚¨æŸ¥çœ‹åœºæ™¯ä¸­æ­£åœ¨å¤„ç†çš„æ•°æ®ç±»å‹ï¼Œä»¥åŠè¯Šæ–­ä»»ä½•é”™è¯¯æˆ–æ„å¤–ç»“æœã€‚è¾ƒä¸ºå¸¸ç”¨çš„è§†å›¾æ¨¡å¼æœ‰è‡ªå·±çš„çƒ­é”®ï¼Œä½†æ‰€æœ‰è§†å›¾æ¨¡å¼éƒ½å¯ä»è§†å£å†…é€šè¿‡è§†å›¾æ¨¡å¼ï¼ˆView Modeï¼‰èœå•è¿›è¡Œè®¿é—®ã€‚

ä»¥ä¸‹ä¸ºå„æ¨¡å¼å¿«æ·é”®å’Œæ§åˆ¶å°å‘½ä»¤ï¼š

- Alt + 2 çº¿æ¡†è§†å›¾æ¨¡å¼ï¼Œ*viewmode wireframe* æ˜¾ç¤ºåœºæ™¯ä¸­çš„æ‰€æœ‰å¤šè¾¹å½¢è¾¹ç¼˜ã€‚å¯¹äº"ç”»åˆ·"ï¼Œæ‚¨å°†çœ‹åˆ°æ‰€äº§ç”Ÿçš„å‡ ä½•ä½“ã€‚
- Alt + 3 ä¸ç…§äº®è§†å›¾æ¨¡å¼ï¼Œ*viewmode unlit* ä»åœºæ™¯ä¸­ç§»é™¤æ‰€æœ‰ç…§æ˜ï¼Œä»è€Œåªæ˜¾ç¤ºåº•è‰²ã€‚
- Alt + 4 ç…§äº®è§†å›¾æ¨¡å¼ï¼Œ*viewmode lit* æ˜¾ç¤ºåº”ç”¨æ‰€æœ‰æè´¨å’Œç…§æ˜ä¹‹åçš„åœºæ™¯æœ€ç»ˆç»“æœã€‚
- Alt + 5 ç»†èŠ‚ç…§æ˜è§†å›¾æ¨¡å¼ï¼Œ*viewmode lit_detaillighting*  ä½¿ç”¨åŸå§‹æè´¨çš„æ³•çº¿è´´å›¾åœ¨æ•´ä¸ªåœºæ™¯å†…æ¿€æ´»ä¸­æ€§æè´¨ã€‚è¿™å¯¹äºè¿›è¡Œéš”ç¦»è€Œè¨€éå¸¸æœ‰ç”¨ï¼Œè€Œæ— è®ºåº•è‰²æ˜¯å¦å› ä¸ºè¿‡æš—æˆ–å™ªå£°è¿‡é«˜è€Œé®è”½äº†å…‰çº¿ã€‚
- Alt + 6 ä»…ç…§æ˜è§†å›¾æ¨¡å¼ï¼Œ*viewmode lightingonly* æ˜¾ç¤ºä»…å—ç…§æ˜å½±å“çš„ä¸­æ€§æè´¨ã€‚æ­¤æ¨¡å¼ä¸ç»†èŠ‚ç…§æ˜æ¨¡å¼çš„åŒºåˆ«åœ¨äºï¼Œçœ‹ä¸åˆ°æ³•çº¿è´´å›¾ã€‚
- Alt + 7 å…‰çº¿å¤æ‚æ€§è§†å›¾æ¨¡å¼ï¼Œ*viewmode lightcomplexity* æ˜¾ç¤ºå½±å“å‡ ä½•ä½“çš„éé™æ€å…‰çº¿æ•°ç›®ã€‚è¿™å¯¹äºè·Ÿè¸ªç…§æ˜æˆæœ¬è€Œè¨€éå¸¸æœ‰ç”¨ - å½±å“è¡¨é¢çš„å…‰çº¿è¶Šå¤šï¼Œè¿›è¡Œæ˜æš—å¤„ç†çš„æˆæœ¬è¶Šé«˜ï¼Œé¢œè‰²ä»é»‘åˆ°ç»¿ï¼Œå†åˆ°çº¢ã€‚æ­¤é¢œè‰²æ–¹æ¡ˆæ˜¯åœ¨ç€è‰²å™¨ä»£ç ä¸­å®šä¹‰çš„ã€‚
- Alt + 8 ç€è‰²å™¨å¤æ‚æ€§è§†å›¾æ¨¡å¼ï¼Œ*viewmode shadercomplexity* ç”¨æ¥æ˜¾ç¤ºç”¨äºè®¡ç®—åœºæ™¯ä¸­æ¯ä¸ªåƒç´ çš„ç€è‰²å™¨æŒ‡ä»¤æ•°ã€‚é€šå¸¸ï¼Œè¿™å¯ä»¥å¾ˆå¥½åœ°æŒ‡ç¤ºåœºæ™¯çš„æ€§èƒ½çŠ¶å†µã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ­¤æ¨¡å¼ç”¨æ¥æµ‹è¯•åŸºæœ¬åœºæ™¯çš„æ•´ä½“æ€§èƒ½ä»¥åŠä¼˜åŒ–ç²’å­æ•ˆæœï¼Œè¿™äº›æ•ˆæœå¯èƒ½ä¼šå¯¼è‡´çŸ­æ—¶é—´å†…å‘ç”Ÿå¤§é‡è¿‡åº¦ç»˜åˆ¶ï¼Œä»è€Œå¯¼è‡´æ€§èƒ½çªé™ã€‚æ­¤è§†å›¾æ¨¡å¼ä½¿ç”¨è‰²è°±æ¥æŒ‡ç¤ºåœºæ™¯çš„æˆæœ¬ã€‚*ç»¿è‰²*åˆ°*çº¢è‰²*è¡¨ç¤º"æˆæœ¬éå¸¸ä½"åˆ°"æˆæœ¬é«˜"çš„çº¿æ€§å…³ç³»ï¼Œè€Œ*ç²‰çº¢è‰²*å’Œ*ç™½è‰²*è¡¨ç¤ºå¿«é€Ÿè·³è·ƒè‡³"æˆæœ¬éå¸¸é«˜"çš„åƒç´ ã€‚è¾ƒå°çš„ç™½è‰²åŒºåŸŸå¯ä»¥å®¹å¿ï¼Œä½†å¦‚æœå±å¹•çš„å¤§éƒ¨åˆ†åŒºåŸŸéƒ½æ˜¾ç¤ºä¸ºé²œçº¢è‰²æˆ–ç™½è‰²ï¼Œé‚£ä¹ˆè¡¨ç¤ºæ€§èƒ½ä¸ä½³ã€‚
- é™æ­¢å…‰çº¿é‡å è§†å›¾æ¨¡å¼ StationaryLightOverlapï¼Œé»˜è®¤æƒ…å†µä¸‹åªèƒ½é€šè¿‡èœå•è¿›è¡Œè®¿é—®ã€‚
- Alt + 0 å…‰ç…§è´´å›¾å¯†åº¦è§†å›¾æ¨¡å¼ LightmapDensityï¼Œæ˜¾ç¤ºè¿›è¡Œäº†çº¹ç†è´´å›¾çš„å¯¹è±¡çš„å…‰ç…§è´´å›¾å¯†åº¦ï¼ŒæŒ‰å…¶ä¸ç†æƒ³/æœ€å¤§å¯†åº¦è®¾ç½®çš„å…³ç³»å¯¹å…¶è¿›è¡Œé¢œè‰²ç¼–ç ï¼Œå¹¶æ˜¾ç¤ºæ˜ å°„åˆ°å®é™…å…‰ç…§è´´å›¾çº¹ç´ çš„ç½‘æ ¼ã€‚åœ¨æ•´ä¸ªåœºæ™¯å†…ä½¿ç”¨å¶æ•°çº¹ç´ å¯†åº¦ä»¥è·å¾—ä¸€è‡´çš„å…‰ç…§è´´å›¾ç…§æ˜ååˆ†é‡è¦ã€‚


åˆ©ç”¨ç½‘æ ¼ä½“ç»˜åˆ¶ `Mesh Paint` å·¥å…·å¯ä»¥åœ¨å…³å¡è§†å£ä¸­äº¤äº’å¼åœ°åœ¨é™æ€ç½‘æ ¼ä½“ä¸Šç»˜åˆ¶é¡¶ç‚¹é¢œè‰²ã€‚å¯ä»¥ç”¨ç‹¬æœ‰çš„é¢œè‰²/é€æ˜åº¦å€¼æ¥å¯¹å•ä¸€ç½‘æ ¼ä½“çš„å¤šä¸ªå®ä¾‹è¿›è¡Œç»˜åˆ¶ï¼Œå¹¶éšå¿ƒæ‰€æ¬²åœ°åœ¨æè´¨ä¸­ä½¿ç”¨æ­¤æ•°æ®ã€‚

UE4 Mesh Paint æä¾›ä¸‰ç§ç»˜ç”»æ¨¡å¼ï¼š

- é¡¶ç‚¹é¢œè‰²ç»˜åˆ¶ï¼ˆVertex Color Paintingï¼‰ï¼Œè¯¥æ¨¡å¼å°†é¢œè‰²æ•°æ®ç›´æ¥ç»˜åˆ¶åˆ°ç½‘æ ¼ä½“çš„é¡¶ç‚¹ä¸Šï¼›
- é¡¶ç‚¹æƒé‡ç»˜åˆ¶ï¼ˆVertex Weight Paintingï¼‰ï¼Œåœ¨ç½‘æ ¼ä½“ä¸Šç»˜åˆ¶é¡¶ç‚¹æƒé‡ï¼Œç»˜åˆ¶æ—¶æ··åˆä¸åŒçš„çº¹ç†ï¼›
- çº¹ç†æƒé‡ç»˜åˆ¶ï¼ˆTexture Weight Paintingï¼‰ï¼Œè¯¥æ¨¡å¼å…è®¸åœ¨çº¹ç†ä¸Šç»˜åˆ¶ã€‚

é¡¶ç‚¹ç»˜åˆ¶æ˜¯ç›®å‰å¾ˆé€šç”¨çš„æè´¨å¤„ç†æŠ€æœ¯ï¼Œåƒ Blender å°±éå¸¸é‡è§†é¡¶ç‚¹ç»˜åˆ¶æŠ€æœ¯ã€‚ 

ç½‘æ ¼ä½“ç»˜åˆ¶ç³»ç»Ÿè¦æ±‚ç½‘æ ¼ä½“æè´¨åŒ…å«ä¸€ä¸ªé¡¶ç‚¹é¢œè‰²èŠ‚ç‚¹ `Vertex Color`ï¼Œå› ä¸ºè¿™æ˜¯ä»ç½‘æ ¼ä½“å°†æ¨¡å‹çš„é¡¶ç‚¹é¢œè‰²æ•°æ®ä¼ è‡³æè´¨çš„æ–¹å¼ï¼ŒMesh -> Vertex Color -> Materialã€‚

Vertex Color å››ä¸ªè¾“å‡ºç«¯ç‚¹è¯´æ˜ï¼š

- RGB é£æ ¼ä½“é¡¶ç‚¹çš„ä¸‰é€šé“è‰²å½©è¾“å‡ºï¼›
- R é£æ ¼ä½“é¡¶ç‚¹çš„çš„ Red åˆ†é‡è¾“å‡ºï¼›
- G é£æ ¼ä½“é¡¶ç‚¹çš„çš„ Green åˆ†é‡è¾“å‡ºï¼›
- B é£æ ¼ä½“é¡¶ç‚¹çš„çš„ Blue åˆ†é‡è¾“å‡ºï¼›
- A é£æ ¼ä½“é¡¶ç‚¹çš„çš„ Alpha åˆ†é‡è¾“å‡ºï¼›

å®é™…ä¸Šæœ‰æ— æ•°ç§æ–¹æ³•æ¥åº”ç”¨é¡¶ç‚¹é¢œè‰²æè´¨è¡¨è¾¾å¼ä¸­çš„é¢œè‰²ï¼Œå¦‚ Lerp æˆ– HeightLerp æ’å€¼èŠ‚ç‚¹ã€‚ç®€å•ä¸€äº›ï¼Œå¯ä»¥ä»…é€šè¿‡ä¹˜æ³•è¡¨è¾¾å¼æŠŠé¢œè‰²åŠ å…¥åˆ°ç°æœ‰æè´¨ä¸­ã€‚æ¯”å¦‚ï¼Œæ·»åŠ  Multiply èŠ‚ç‚¹æ¥è¿æ¥å¯¹åº”çš„ Vertex Color èŠ‚ç‚¹åˆ°æè´¨çš„ Base Colorã€‚è¿™ä½¿æˆ‘ä»¬å¯ä»¥å…·å¤‡åŸå§‹è´´å›¾ï¼Œé€šè¿‡ç½‘æ ¼ä½“æç”»å·¥å…·ç»™å…¶ç€è‰²ã€‚

ç‚¹å‡» `Paint` æŒ‰é’®æ¿€æ´»ç½‘æ ¼ä½“ç»˜åˆ¶é¢æ¿ï¼Œæ­¤æ—¶ï¼Œä½ ä»ç„¶å¯ä»¥æ‰§è¡Œå¤§éƒ¨åˆ†å¸¸è§çš„ç¼–è¾‘å™¨æ“ä½œï¼Œä¾‹å¦‚ç§»åŠ¨å¹¶é€‰ä¸­æ‘„è±¡æœºã€‚ä½†ç‰¹å®šåŠŸèƒ½ä¼šè¢«ç¦ç”¨ï¼Œå¦‚è½¬æ¢å¯¹è±¡ã€‚ç½‘æ ¼ä½“ç»˜åˆ¶é¢æ¿æ¿€æ´»æ—¶ï¼ŒPlace Actors é¢æ¿ä»ç„¶å¯ä»¥ä½¿ç”¨ã€‚é€è§†è§†å£å°†é»˜è®¤ä½¿ç”¨å®æ—¶æ¨¡å¼ Realtimeã€‚è¦ä¿®æ”¹å®ƒæˆ–è€…å…¶ä»–è§†å£è®¾ç½®ï¼Œå¯ç‚¹å‡»è§†å£å·¦ä¸Šè§’çš„ä¸‹æ‹‰ç®­å¤´ã€‚

ä½ å¯ä»¥æŒ‰ X é”®åœ¨ç»˜åˆ¶é¢œè‰²å’Œæ“¦é™¤é¢œè‰²ä¹‹é—´åˆ‡æ¢ï¼ŒSHIFT + LMB + æ‹–åŠ¨ç”¨ä½œæ©¡çš®æ“¦é¢œè‰²çš„é¢œè‰²ã€‚

çº¹ç†æƒé‡ç»˜åˆ¶æ¨¡å¼å¯ä»¥è®©ä½ ç»™çº¹ç†ä¸Šè‰²ï¼Œå¹¶åœ¨æ­¤è¿‡ç¨‹ä¸­è®¿é—®å…¶å¯ç”¨å±æ€§ã€‚ä½ å¯ä»¥ä½¿ç”¨å·¥å…·æ ï¼Œæˆ–è€…æŒ‰ å¥å·ï¼ˆ.ï¼‰å’Œ é€—å·ï¼ˆ,ï¼‰é”®åœ¨çº¹ç†é—´åˆ‡æ¢ã€‚åœ¨å®Œæˆç»™çº¹ç†ä¸Šè‰²åï¼Œä½ å¯ä»¥ä½¿ç”¨å·¥å…·æ æˆ–æŒ‰ Ctrl + Shift + C æ‰§è¡Œä¿®æ”¹ï¼Œç­‰ä»·ç‚¹å‡» Commit Texture æŒ‰é’®ã€‚



# ğŸŒŸ Folder Structure è™šå¹»å¼•æ“çš„ç›®å½•ç»“æ„
- è™šå¹»å¼•æ“ç›®å½•ç»“æ„ https://docs.unrealengine.com/4.27/zh-CN/Basics/DirectoryStructure/
- è™šå¹»å¼•æ“å’Œæ¸¸æˆç¼–è¯‘å·¥å…· https://docs.unrealengine.com/4.27/zh-CN/ProductionPipelines/BuildTools/
- åˆ›å»ºè™šå¹»å¼•æ“æ’ä»¶ https://docs.unrealengine.com/4.27/zh-CN/ProductionPipelines/Plugins/
- è®¾ç½®ä¸“ç”¨æœåŠ¡å™¨ https://docs.unrealengine.com/4.27/zh-CN/InteractiveExperiences/Networking/HowTo/DedicatedServers/
- Getting started with the Unreal Engine API https://docs.unrealengine.com/5.0/en-US/API/QuickStart/
- Include What You Use https://docs.unrealengine.com/4.27/zh-CN/ProductionPipelines/BuildTools/UnrealBuildTool/IWYU/
- Creating a Gameplay Module https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ProgrammingWithCPP/ModuleQuickStart/
- Unreal Engine Modules https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ProgrammingWithCPP/Modules/

æºä»£ç æ ¹ç›®å½•ä¸­çš„å¼•æ“ç›®å½•ï¼ˆEngineï¼‰ï¼ŒEngine ç›®å½•åŒ…å«å¼•æ“è‡ªèº«åŠå…¶éšé™„å·¥å…·ã€‚
å¼•æ“ç›®å½•ä¹Ÿå­˜åœ¨äºæ¸¸æˆé¡¹ç›®æ ¹ç›®å½•ä¸­ï¼Œæ¯ä¸ªæ¸¸æˆç›®å½•éƒ½åŒ…å«ä¸è¯¥æ¸¸æˆæœ‰å…³çš„æ‰€æœ‰æ–‡ä»¶ã€‚
ä¸å…ˆå‰çš„å¼•æ“ç‰ˆæœ¬ç›¸æ¯”ï¼ŒUE4 ä¸­çš„å¼•æ“å’Œæ¸¸æˆåœ¨ç›®å½•ç»“æ„ä¸Šæœ‰äº†æ›´æ˜æ˜¾çš„åŒºåˆ†ã€‚

Unreal Engine å¼•æ“æœ¬èº«çš„å¼€å‘æ˜¯åŸºäºæ¨¡å—åŒ–çš„ï¼ŒåŸºæœ¬å¼•æ“å¼€å‘çš„å·¥ç¨‹ä¹Ÿä¼ æ‰¿äº†æ¨¡å—åŒ–ç®¡ç†ã€‚

æ ¹ç›®å½•ç»“æ„ï¼š

- **Engine** - åŒ…å«æ„æˆå¼•æ“çš„æ‰€æœ‰æºä»£ç ã€å†…å®¹ç­‰ã€‚
- **Templates** - åˆ›å»ºæ–°é¡¹ç›®æ—¶å¯ç”¨çš„é¡¹ç›®æ¨¡æ¿é›†åˆã€‚
- **GenerateProjectFiles.bat** - è„šæœ¬ç”¨äºåˆ›å»º UE4 çš„ Visual Studio è§£å†³æ–¹æ¡ˆå’Œé¡¹ç›®æ–‡ä»¶ã€‚
- **UE4Games.uprojectdirs** - è¾…åŠ©æ–‡ä»¶ï¼Œå¸®åŠ©å¼•æ“æ‰¾åˆ°å­ç›®å½•ä¸­çš„é¡¹ç›®ã€‚

å¼•æ“ä¸“æœ‰ç›®å½•ï¼Œéƒ¨åˆ†å­ç›®å½•åªå­˜åœ¨äº Engine ç›®å½•ä¸­ã€‚

- **Documentation** - åŒ…å«å¼•æ“æ–‡æ¡£ï¼ŒåŒ…æ‹¬æºæ–‡ä»¶å’Œå‘å¸ƒçš„æ–‡ä»¶ã€‚
    - **HTML** - å‘å¸ƒçš„ HTML æ–‡æ¡£æ–‡ä»¶ã€‚
    - **Source** - markdown æºæ–‡æ¡£æ–‡ä»¶ã€‚
- **Extras** - å…¶ä»–è¾…åŠ©å’Œå·¥å…·æ–‡ä»¶ã€‚
- **Plugins** - åŒ…å«å¼•æ“ä¸­ä½¿ç”¨çš„æ’ä»¶ã€‚
- **Programs** - åŒ…å«è™šå¹»å­ç¨‹åºçš„é…ç½®æ–‡ä»¶å’Œæ—¥å¿—æ–‡ä»¶ï¼Œå¦‚ UnrealFrontendã€UnrealHeaderToolã€‚
- **Shaders** - ä¿å­˜å¼•æ“çš„ç€è‰²å™¨æºæ–‡ä»¶ï¼ˆ.usfï¼‰ã€‚

é€šç”¨ç›®å½•ï¼ŒæŸäº›å­ç›®å½•åœ¨ Engine ç›®å½•å’Œæ¸¸æˆé¡¹ç›®ä¸­éƒ½èƒ½æ‰¾åˆ°ï¼š

- **Binaries** - åŒ…å«å¯æ‰§è¡Œæ–‡ä»¶æˆ–ç¼–è¯‘æœŸé—´åˆ›å»ºçš„å…¶ä»–æ–‡ä»¶ã€‚
- **Build** - åŒ…å«ç¼–è¯‘å¼•æ“æˆ–æ¸¸æˆæ‰€éœ€çš„æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸ºæŸäº›ç‰¹å®šå¹³å°åˆ›å»ºé¡¹ç›®ç‰ˆæœ¬æ—¶æ‰€éœ€çš„æ–‡ä»¶ã€‚
- **Config** - é…ç½®æ–‡ä»¶åŒ…å«çš„å‚æ•°å¯ç”¨äºæ§åˆ¶å¼•æ“çš„è¡Œä¸ºã€‚é¡¹ç›®ä¸­è®¾ç½®çš„é…ç½®å€¼ä¼šè¦†ç›–æ­¤ç›®å½•ä¸­è®¾ç½®çš„å€¼ã€‚
- **Content** - ä¿å­˜å¼•æ“æˆ–æ¸¸æˆä¸­çš„å†…å®¹ï¼Œä¾‹å¦‚èµ„äº§åŒ…ã€è´´å›¾ã€‚
- **DerivedDataCache** - åŒ…å«æ´¾ç”Ÿæ•°æ®æ–‡ä»¶ã€‚è¿™ç±»æ•°æ®ä¸“ä¸ºè¢«å¼•ç”¨å†…å®¹ç”Ÿæˆï¼Œå¹¶ä¸”åœ¨åŠ è½½æ—¶ç”Ÿæˆã€‚
- **Intermediate** - åŒ…å«ç¼–è¯‘å¼•æ“æˆ–æ¸¸æˆæ—¶ç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶ã€‚åœ¨æ¸¸æˆç›®å½•ä¸­ï¼Œç€è‰²å™¨ä¹Ÿä¿å­˜åœ¨æ­¤ç›®å½•ä¸­ã€‚
- **Saved** - åŒ…å«è‡ªåŠ¨ä¿å­˜æ–‡ä»¶ã€é…ç½®æ–‡ä»¶ï¼ˆ.iniï¼‰ã€æ—¥å¿—æ–‡ä»¶ã€å´©æºƒæ—¥å¿—ã€ç¡¬ä»¶ä¿¡æ¯å’Œ Swarm é€‰é¡¹ä¸æ•°æ®ã€‚
- **Source** - åŒ…å«å¼•æ“æˆ–æ¸¸æˆçš„æ‰€æœ‰æºæ–‡ä»¶ï¼ŒåŒ…æ‹¬å¼•æ“æºä»£ç ã€å·¥å…·å’Œæ¸¸æˆç±»ç­‰ã€‚
    - å¼•æ“æºæ–‡ä»¶ä¸­çš„ **Sources** æ–‡ä»¶å¤¹ç»„ç»‡ç»“æ„å¦‚ä¸‹ï¼š
        - **Developer** - ç¼–è¾‘å™¨å’Œå¼•æ“å…±åŒä½¿ç”¨çš„æ–‡ä»¶ã€‚
        - **Editor** - ä»…ä¾›ç¼–è¾‘å™¨ä½¿ç”¨çš„æ–‡ä»¶ã€‚
        - **Programs** - å¼•æ“æˆ–ç¼–è¾‘å™¨ä½¿ç”¨çš„å¤–éƒ¨å·¥å…·ã€‚
        - **Runtime** - ä»…ä¾›å¼•æ“ä½¿ç”¨çš„æ–‡ä»¶ã€‚
    - æ¸¸æˆé¡¹ç›®ä¸­çš„ **Sources** æ–‡ä»¶æŒ‰æ¨¡å—åˆ†ç»„ï¼Œä¸€ä¸ªæ¨¡å—ä¸€ä¸ªç›®å½•ï¼Œæ¯ä¸ªæ¸¸æˆæ¨¡å—åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š
        - **Classes** - åŒ…å«æ‰€æœ‰çš„å¤´æ–‡ä»¶ï¼ˆ.hï¼‰ã€‚
        - **Private** - åŒ…å«æ‰€æœ‰ .cpp æ–‡ä»¶ï¼ŒåŒ…æ‹¬æ¸¸æˆé€»è¾‘ç±»ä»¥åŠå„ç§æ¨¡å—çš„å®ç°æ–‡ä»¶ã€‚
        - **Public** - åŒ…å«æ¨¡å—çš„å¤´æ–‡ä»¶ã€‚

æ¸¸æˆé¡¹ç›®ç›®å½•

- **Binaries** åŒ…å«å¯æ‰§è¡Œæ–‡ä»¶æˆ–ç¼–è¯‘æœŸé—´åˆ›å»ºçš„å…¶ä»–æ–‡ä»¶ã€‚
- **Config** æ¸¸æˆçš„é»˜è®¤é¡¹ç›®è®¾ç½®ã€‚
- **Content** åŒ…å«å¼•æ“æˆ–æ¸¸æˆçš„å†…å®¹ï¼ŒåŒ…æ‹¬èµ„äº§åŒ…å’Œè´´å›¾ã€‚
- **External dependencies** æ˜¾ç¤ºå…¬æœ‰çš„å¼•æ“å¤´æ–‡ä»¶ï¼ˆä»…åœ¨Visual Studioä¸­å¯è§ï¼‰ã€‚
- **Intermediate** åŒ…å« UnrealBuildTool ç”Ÿæˆçš„æ–‡ä»¶ï¼Œå¦‚ Visual Studio é¡¹ç›®æ–‡ä»¶ã€‚
- **Saved** åŒ…å«å¼•æ“ç”Ÿæˆçš„æ–‡ä»¶ï¼Œå¦‚é…ç½®æ–‡ä»¶å’Œæ—¥å¿—ã€‚è¿™äº›æ–‡ä»¶å¯ä»¥åˆ é™¤å¹¶é‡æ–°æ„å»ºã€‚
- **Source** åŒ…å«æ¸¸æˆæ¨¡å—å¯¹è±¡ç±»æ–‡ä»¶ã€‚

è§£å†³æ–¹æ¡ˆç›®å½•

- **Classes** åŒ…å«æ¸¸æˆå¯¹è±¡çš„ç±»å®šä¹‰ï¼ˆ.h æ–‡ä»¶ï¼‰ã€‚
- **Config** æ¸¸æˆçš„é»˜è®¤é¡¹ç›®è®¾ç½®ã€‚
- **External dependencies** æ˜¾ç¤ºå…¬æœ‰å¼•æ“å¤´æ–‡ä»¶ï¼ˆä»…åœ¨Visual Studioä¸­å¯è§ï¼‰ã€‚
- **Private** åŒ…å«ç§æœ‰æ¸¸æˆå¯¹è±¡ç±»çš„å®ç°æ–‡ä»¶ï¼ˆ.cpp æ–‡ä»¶ï¼‰ã€‚
- **Public** åŒ…å«å…¬æœ‰æ¸¸æˆå¯¹è±¡ç±»çš„å®ç°æ–‡ä»¶ï¼ˆ.cpp æ–‡ä»¶ï¼‰ã€‚

æ³¨æ„ï¼Œé¡¹ç›®ä¸­ Binariesã€Intermediateã€Saved ä¸‰ä¸ªç›®å½•ï¼Œä¼šéšç€å¼€å‘è¿‡ç¨‹ä¸æ–­çš„æ·»åŠ çš„å†…å®¹ä»¥åŠ
ç¼–è¯‘æ“ä½œä¸æ–­äº§ç”Ÿå¤§é‡ä¸´æ—¶æ–‡ä»¶ï¼Œå¯ä»¥åˆ é™¤ï¼Œä½†å†æ¬¡æ‰“å¼€æ—¶å°±éœ€è¦é‡æ–°ç¼–è¯‘ç¼ºå¤±çš„æ–‡ä»¶ã€‚

å¦å¤–ï¼Œåœ¨ç”¨æˆ·ç›®å½•ä¸‹çš„ AppData\Local\UnrealEngine ç›®å½•ä¸‹ä¹Ÿä¼šå¤§é‡çš„ç¼“å­˜æ–‡ä»¶ã€‚

åœ¨ UE3 çš„æ—¶å€™ç”¨ MakeFiles å®ç°é¡¹ç›®çš„è‡ªåŠ¨åŒ–ç¼–è¯‘ï¼ŒUE4 å¼•å…¥ C# ç¼–å†™çš„ UBTï¼ˆUnrealBuildToolï¼‰
å’Œ UnrealHeaderTool ç¼–è¯‘è¾…åŠ©å·¥å…·ï¼Œå¼•å…¥äº†æ¨¡å—æœºåˆ¶ã€‚UE4 æºç å·¥ç¨‹æœ¬èº«ä¹Ÿä½¿ç”¨ UBT æ¥ç»„ç»‡ç¼–è¯‘ã€‚


å‰–æè™šå¹»æ¸²æŸ“ä½“ç³»ï¼ˆ10ï¼‰- RHI
https://www.cnblogs.com/timlly/p/15156626.html
https://docs.unrealengine.com/5.2/en-US/graphics-programming-overview-for-unreal-engine/
UE çš„æ¸²æŸ“æµç¨‹ä¸­ï¼Œå­˜åœ¨ 4 ç§å·¥ä½œçº¿ç¨‹ï¼š

1. æ¸¸æˆçº¿ç¨‹ï¼ˆGame Threadï¼‰
2. æ¸²æŸ“çº¿ç¨‹ï¼ˆRender Threadï¼‰
3. RHI çº¿ç¨‹
4. GPUï¼ˆå«é©±åŠ¨ï¼‰

RHI - Render Hardware Interfaceï¼ˆæ¸²æŸ“ç¡¬ä»¶æ¥å£ï¼‰æ˜¯ UE æ¸²æŸ“ä½“ç³»ä¸­éå¸¸åŸºç¡€ä¸”é‡è¦çš„æ¨¡å—ï¼Œ
å°è£…äº†ä¼—å¤šå›¾å½¢ APIï¼ˆDirectXã€OpenGLã€Vulkanã€Metalï¼‰ä¹‹é—´çš„å·®å¼‚ï¼Œæä¾›äº†ç®€ä¾¿ä¸”ä¸€è‡´çš„æ¦‚å¿µã€
æ•°æ®ã€èµ„æºå’Œæ¥å£ä¾›ç»™  Game å’Œ Renderer æ¨¡å—è°ƒç”¨ï¼Œå®ç°ä¸€ä»½æ¸²æŸ“ä»£ç è·‘åœ¨å¤šä¸ªå¹³å°çš„ç›®æ ‡ã€‚

RHI çº¿ç¨‹è´Ÿè´£å°†æ¸²æŸ“çº¿ç¨‹ Push è¿›æ¥çš„ RHI ä¸­é—´æŒ‡ä»¤è½¬è¯‘åˆ°å¯¹åº”å›¾å½¢å¹³å°çš„ GPU æŒ‡ä»¤ã€‚åœ¨éƒ¨åˆ†å›¾å½¢ 
APIï¼ˆDX12ã€Vulkanã€ä¸»æœºï¼‰æ”¯æŒå¹¶è¡Œçš„æƒ…å†µä¸‹ï¼Œå¦‚æœæ¸²æŸ“çº¿ç¨‹æ˜¯å¹¶è¡Œç”Ÿæˆçš„ RHI ä¸­é—´æŒ‡ä»¤ï¼Œé‚£ä¹ˆ RHI 
çº¿ç¨‹ä¹Ÿä¼šå¹¶è¡Œè½¬è¯‘ã€‚

æ¸¸æˆçº¿ç¨‹æ˜¯æ•´ä¸ªå¼•æ“çš„é©±åŠ¨è€…ï¼Œæä¾›æ‰€æœ‰çš„æºæ•°æ®å’Œäº‹ä»¶ï¼Œä»¥é©±åŠ¨æ¸²æŸ“çº¿ç¨‹å’Œ RHI çº¿ç¨‹ã€‚æ¸¸æˆçº¿ç¨‹é¢†å…ˆæ¸²æŸ“çº¿ç¨‹
ä¸è¶…è¿‡ 1 å¸§ï¼Œæ›´å…·ä½“åœ°è¯´å¦‚æœç¬¬Nå¸§çš„æ¸²æŸ“çº¿ç¨‹åœ¨ç¬¬ N+1 å¸§çš„æ¸¸æˆçº¿ç¨‹çš„ Tick ç»“æŸæ—¶è¿˜æ²¡æœ‰å®Œæˆï¼Œé‚£ä¹ˆæ¸¸æˆ
çº¿ç¨‹ä¼šè¢«æ¸²æŸ“çº¿ç¨‹å¡ä½ã€‚åä¹‹ï¼Œå¦‚æœæ¸¸æˆçº¿ç¨‹è´Ÿè½½è¿‡é‡ï¼Œæ²¡èƒ½åŠæ—¶å‘é€äº‹ä»¶å’Œæ•°æ®ç»™æ¸²æŸ“çº¿ç¨‹ï¼Œæ¸²æŸ“çº¿ç¨‹ä¹Ÿä¼šå¡ä½ã€‚

æ¸²æŸ“çº¿ç¨‹è´Ÿè´£äº§ç”Ÿ RHI çš„ä¸­é—´å‘½ä»¤ï¼Œåœ¨é€‚å½“çš„æ—¶æœºæ´¾å‘ã€åˆ·æ–°æŒ‡ä»¤åˆ° RHI çº¿ç¨‹ã€‚å› æ­¤ï¼Œæ¸²æŸ“çº¿ç¨‹çš„å¡é¡¿
ä¹Ÿå¯èƒ½å¯¼è‡´ RHI çš„å¡é¡¿ã€‚

RHI çº¿ç¨‹è´Ÿè´£æ´¾å‘ï¼ˆå¯é€‰ï¼‰ã€è½¬è¯‘ã€æäº¤æŒ‡ä»¤ï¼Œä¸”æ¸²æŸ“çš„æœ€åä¸€æ­¥éœ€è¦ SwapBufferï¼Œè¿™ä¸€æ­¥éœ€è¦ç­‰å¾… GPU 
å®Œæˆæ¸²æŸ“å·¥ä½œã€‚å› æ­¤ï¼Œæ¸²æŸ“ GPU çš„ç¹å¿™ä¹Ÿä¼šå¯¼è‡´ RHI çº¿ç¨‹çš„å¡é¡¿ã€‚

é™¤äº†æ¸¸æˆçº¿ç¨‹ï¼Œæ¸²æŸ“çº¿ç¨‹ã€RHI çº¿ç¨‹å’Œ GPU çš„å·¥ä½œéƒ½æ˜¯å­˜åœ¨é—´éš™çš„ï¼Œå³æ¸¸æˆçº¿ç¨‹æä¾›ç»™æ¸²æŸ“ä»»åŠ¡çš„æ—¶æœº
ä¼šå½±å“æ¸²æŸ“å·¥ä½œçš„å¯†åº¦ï¼Œä¹Ÿä¼šå½±å“åˆ°æ¸²æŸ“çš„æ—¶é—´ï¼Œå°é‡å¤šæ¬¡ä¼šæµªè´¹æ¸²æŸ“æ•ˆç‡ã€‚


Windows å¹³å°ä¸Šï¼Œä¸»è¦ä½¿ç”¨ DirectX æ¸¸æˆå›¾å½¢ç¼–ç¨‹æ¥å£ï¼Œå®˜æ–¹æä¾›çš„ DirectXShaderCompiler 
æ˜¯ç€è‰²å™¨ç¨‹åºç¼–è¯‘å™¨ï¼Œä¹Ÿå°±æ˜¯ HLSL ç€è‰²å™¨ç¼–è¯‘å™¨å¼€æºé¡¹ç›®ã€‚HLSL Shader ç›®å‰æœ€æ–°çš„ç‰ˆæœ¬ä¸º v6.6ï¼Œ
æŒ‰å¾®è½¯çš„å«æ³•å°±æ˜¯ sm6.6ï¼Œåˆå¢åŠ äº†å¾ˆå¤šæ–°çš„å…‰è¿½ Shader ç‰¹æ€§ã€‚

UE5 ä¸­å¯ä»¥è®¾ç½®é¡¹ç›®å¯ç”¨ SM6ã€‚Platforms -> Windows -> D3D12TargetedShaderFormats -> SM6ã€‚
ä½†æ˜¯ï¼ŒIntel çš„æ ¸æ˜¾é©±åŠ¨å¯èƒ½ä¸æ”¯æŒ shader model 6.0ï¼Œå¯ä»¥ä½¿ç”¨ DirectX Capabilities Viewer
å·¥å…·æ£€æµ‹ DirectX 12 å½“å‰æ”¯æŒçš„ SM ç‰ˆæœ¬ï¼š
Identifying the Shader Model of Your Graphics Card in Windows
https://www.chiefarchitect.com/support/article/KB-03146/identifying-the-shader-model-of-your-graphics-card-in-windows.html 
https://cloud.chiefarchitect.com/1/downloads/support/dxcapsviewer.exe
https://docs.unrealengine.com/5.1/zh-CN/hardware-and-software-specifications-for-unreal-engine/

å¦‚æœç¡®è®¤ä¸æ”¯æŒï¼Œå°±éœ€è¦ç¦æ­¢å…‰è¿½æˆ–è€…åˆ‡æ¢æˆ DirectX11ã€‚å®˜æ–¹ç¤¾åŒºè¯´ UE5.1.0 ç³»ç»Ÿè¦æ­é…æœ€æ–°çš„ DX12ï¼Œ
è€Œå¯¹äº Windows ç³»ç»Ÿ(1909ç‰ˆæœ¬ç­‰)è¦åœ¨ç³»ç»Ÿè®¾ç½®ç‚¹å‡» Windows æ›´æ–°æœ€æ–° DX12ï¼Œè¦ä¹ˆå°±ç”¨å› UE5.0.3ã€‚

VSM å’Œ Nanite éœ€è¦ shading model 6.6ï¼Œå»ºè®®æ›´æ–°é©±åŠ¨ï¼Œä¹Ÿå¯èƒ½ Intel æ‹‰å®è¿˜æ²¡åšå‡ºæ¥æ”¯æŒçš„é©±åŠ¨ã€‚
ä¸è¿‡ Intel æ ¸æ˜¾æ€§èƒ½å¥½åƒæœ¬æ¥å°±è·‘ä¸èµ·æ¥ä»€ä¹ˆé«˜çº§æ¸²æŸ“åŠŸèƒ½ï¼Œä¸åŠ AMD æ ¸æ˜¾ï¼Œå»ºè®®æ”¹å› sm5 å®‰å¿ƒç”¨ã€‚

https://www.nvidia.com/en-us/geforce/technologies/directx-12-ultimate/
GeForce 10 ç³»åˆ—æ˜¾ç¤ºä¸æ”¯æŒæœ€æ–°çš„ DirectX 12 Ultimateï¼Œå› æ­¤åªèƒ½ä½¿ç”¨å…¼å®¹ DirectX APIï¼Œ
ä¸èƒ½ä½¿ç”¨ DX12 Ultimate é«˜çº§åŠŸèƒ½ï¼Œåº”è¯¥ä½¿ç”¨ RTX 20, RTX 30 æˆ–è€… Radeon 6000 ç­‰çº§åˆ«æ˜¾å¡ï¼Œ
ä»¥æ”¯æŒ DirectX 12 Ultimate é«˜çº§åŠŸèƒ½ï¼š

    DXR (DirectX Ray Tracing)
    VRS (Variable Rate Shading)
    Mesh Shading
    Sampler Feedback

UE4 æ”¯æŒæ¨¡å—å’Œæ’ä»¶å…±ç”Ÿï¼Œé€šè¿‡åœ¨ uproject æ–‡ä»¶ä¸­å¯ç”¨æ’ä»¶ï¼Œé¡¹ç›®æ¨¡å—å°±å¯ä¾èµ–æ’ä»¶ã€‚ç±»ä¼¼åœ°ï¼Œé€šè¿‡åœ¨
æ’ä»¶è‡ªèº« çš„ uplugin æ–‡ä»¶ä¸­å¯ç”¨å…¶ä»–æ’ä»¶è¡¨æ˜ä¾èµ–ã€‚

æ¸¸æˆé¡¹ç›®å¼€å‘æ˜¯æ¨¡å—åŒ–çš„ï¼Œç¼–è¯‘å‘å¸ƒæ—¶åªä¼šæ‰“åŒ…é¡¹ç›®ç”¨åˆ°çš„æ¨¡å—ã€‚

è™šå¹»ç¼–è¯‘å·¥å…·æ”¯æŒæ•°ä¸ªç›®æ ‡ç±»å‹çš„ç¼–è¯‘ï¼š

- æ¸¸æˆ   â€”â€” éœ€è¦çƒ˜ç„™æ•°æ®æ‰èƒ½è¿è¡Œçš„ standalone æ¸¸æˆã€‚
- å®¢æˆ·ç«¯ â€”â€” ä¸æ¸¸æˆç›¸åŒï¼Œä½†ä¸åŒ…å«ä»»ä½•æœåŠ¡å™¨ä»£ç ã€‚é€‚ç”¨äºè”ç½‘æ¸¸æˆã€‚
- æœåŠ¡å™¨ â€”â€” ä¸æ¸¸æˆç›¸åŒï¼Œä½†ä¸åŒ…å«ä»»ä½•å®¢æˆ·ç«¯ä»£ç ã€‚é€‚ç”¨äºè”ç½‘æ¸¸æˆä¸­çš„ä¸“ç”¨æœåŠ¡å™¨ã€‚
- ç¼–è¾‘å™¨ â€”â€” æ‰©å±•è™šå¹»ç¼–è¾‘å™¨çš„ç›®æ ‡ã€‚
- ç¨‹åº   â€”â€” åŸºäºè™šå¹»å¼•æ“æ‰“é€ çš„ standalone å·¥å…·ç¨‹åºã€‚

ç›®æ ‡æ–‡ä»¶çš„å…¸å‹ç»“æ„å¦‚ä¸‹ï¼š

```cpp,ignore
    using UnrealBuildTool;
    using System.Collections.Generic;
    public class MyProjectTarget :TargetRules
    {
        public MyProjectTarget(TargetInfo Target) : base(Target)
        {
            Type = TargetType.Game;
            // æ­¤å¤„ä¸ºå…¶ä»–å±æ€§
        }
    }
```

ç±»çš„åç§°å¿…é¡»ä¸åœ¨å…¶ä¸­å£°æ˜è¿™ä¸ªç±»çš„æ–‡ä»¶çš„åç§°ç›¸åŒ¹é…ï¼Œåè·Ÿ"Target"ï¼Œä¾‹å¦‚ï¼ŒMyProject.target.cs
å®šä¹‰ç±» "MyProjectTarget"ã€‚

UE4 æ¯ä¸ªæ¨¡å—éƒ½æ‹¥æœ‰æ§åˆ¶å…¶ç¼–è¯‘æ–¹å¼çš„ build.cs æ–‡ä»¶ï¼ŒåŒ…æ‹¬å®šä¹‰æ¨¡å—ç›¸ä¾æ€§çš„é€‰é¡¹ã€é¢å¤–çš„åº“ã€åŒ…å«è·¯å¾„ç­‰ã€‚
è¿™äº›æ¨¡å—è¢«é»˜è®¤ç¼–è¯‘ä¸º DLL æ–‡ä»¶ï¼Œå¹¶é€šè¿‡å•ä¸€å¯æ‰§è¡Œæ–‡ä»¶è¿›è¡ŒåŠ è½½ï¼Œå¯é€‰æ‹©åœ¨ BuildConfiguration.cs 
æ–‡ä»¶ä¸­ç¼–è¯‘ä¸€ä¸ªå•å—å¯æ‰§è¡Œæ–‡ä»¶ã€‚

æ¨¡å—é€šè¿‡ C# æºæ–‡ä»¶å£°æ˜ï¼Œæ‰©å±•åä¸º build.csï¼Œå­˜å‚¨åœ¨é¡¹ç›®çš„ Source ç›®å½•ä¸‹ã€‚å±äºä¸€ä¸ªæ¨¡å—çš„ C++ 
æºä»£ç ä¸ build.cs æ–‡ä»¶å¹¶åˆ—å­˜å‚¨ï¼Œæˆ–è€…å­˜å‚¨åœ¨å®ƒçš„å­ç›®å½•ä¸­ã€‚æ¯ä¸ª. build.cs æ–‡ä»¶éƒ½å£°æ˜ä¸€ä¸ªç±»ï¼Œ
ä» `ModuleRules` åŸºç±»è¡ç”Ÿè€Œæ¥ï¼Œå¹¶è®¾ç½®å±æ€§æ¥æ§åˆ¶å¦‚ä½•ä»å…¶æ„é€ å‡½æ•°è¿›è¡Œæ„å»ºã€‚è¿™äº› build.cs æ–‡ä»¶
éƒ½ç”± UnrealBuildTool ç¼–è¯‘ï¼Œå¹¶è¢«æ„é€ æ¥ç¡®å®šæ•´ä¸ªç¼–è¯‘ç¯å¢ƒã€‚

ç›®æ ‡é€šè¿‡ C# æºæ–‡ä»¶å£°æ˜ï¼Œæ‰©å±•åä¸º target.csï¼Œå¹¶å­˜å‚¨åœ¨é¡¹ç›®çš„ Source ç›®å½•ä¸‹ã€‚æ¯ä¸ª target.cs 
æ–‡ä»¶éƒ½å£°æ˜ä¸€ä¸ªç±»ï¼Œä» `TargetRules` åŸºç±»è¡ç”Ÿè€Œæ¥ï¼Œå¹¶è®¾ç½®å±æ€§æ¥æ§åˆ¶å¦‚ä½•ä»å…¶æ„é€ å‡½æ•°è¿›è¡Œç¼–è¯‘ã€‚
ç±»åç§°å¿…é¡»ä¸åœ¨å…¶ä¸­å£°æ˜è¿™ä¸ªç±»çš„æ–‡ä»¶çš„åç§°ç›¸åŒ¹é…ï¼Œå½“è¦æ±‚ç¼–è¯‘ç›®æ ‡æ—¶ï¼Œè™šå¹»ç¼–è¯‘å·¥å…·å°†ç¼–è¯‘ target.cs 
æ–‡ä»¶ï¼Œå¹¶åœ¨å…¶ä¸­æ„é€ ç±»æ¥ç¡®å®šå…¶è®¾ç½®ã€‚

é¡¹ç›®çš„ Games ç¨‹åºæˆ– Unreal Editor éƒ½æ˜¯ Target å®šä¹‰ï¼Œæ¯ä¸ª Target éƒ½ç”±ä¸€ç³»åˆ— C++ æ¨¡å—æ„æˆã€‚
æ¯ä¸ªæ¨¡å—çš„ä»£ç å¯ä»¥è¢«å…¶å®ƒæ¨¡å—å¼•ç”¨ï¼Œåªéœ€è¦åœ¨æ„æˆé…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–æ¨¡å—ã€‚æ¯ä¸ª Targets å’Œ Modules 
éƒ½é€šè¿‡ C# ç¼–å†™çš„ UnrealBuildTool è™šå¹»å¼•æ“ä¸“ç”¨æ„å»ºå·¥å…·ç¼–è¯‘ã€‚`Modules` çš„æ„å»ºè§„åˆ™é…ç½®ä»£ç 
æ–‡ä»¶ä»¥ `build.cs` ä¸ºæ‰©å±•åï¼Œ`Target` çš„æ„å»ºè§„åˆ™é…ç½®ä»£ç æ–‡ä»¶ä»¥ `target.cs` ä¸ºæ‰©å±•åã€‚

Unreal Engine å°†æ¨¡å—åˆ†æˆä¸‰ç±»ï¼š

- Runtime è¿™æ˜¯å¤§å¤šæ•°å¼€å‘è€…éœ€è¦ä½¿ç”¨çš„è¿è¡Œæ—¶æ¨¡å—ï¼Œæ¸¸æˆè¿è¡Œéœ€è¦çš„åŸºæœ¬æ¨¡å—ï¼›
- Editor åŠŸèƒ½æ”¯æŒæ¨¡å—ï¼Œè™šå¹»ç¼–è¾‘å™¨çš„åŠŸèƒ½å¯ä»¥é€šè¿‡æ’ä»¶çš„å½¢å¼æ‰©å±•ï¼›
- Developer utilities å¼€å‘è€…å·¥å…·ï¼›

è€Œåœ¨ Runtime æ¨¡å—ä¸­ï¼Œå¼€å‘è€…æœ€å¸¸ç”¨åˆ°çš„ä¸‰ä¸ªéƒ¨åˆ†æ˜¯ï¼š

- `Core` æ ¸å¿ƒéƒ¨åˆ†ï¼Œæä¾›ä¸€ä¸ªä¾›å„æ¨¡å—äº’ç›¸é€šä¿¡çš„é€šå¸¸æ„æ¶ï¼ŒåŒ…å«æ”¯æŒå¤šå¹³å°çš„ç¡¬ä»¶å±‚æŠ½è±¡ï¼Œè¿˜æœ‰ï¼š
    - åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå¦‚ bool, float/double, int8/int16/int32/int64, uint8/uint16/uint32/uint64, ANSICHAR, TCHAR, FStringï¼›
    - æ•°å­¦åº“ï¼Œå¦‚ FMath, FVector, FRotator, FTransform, FMatrix, More...
    - å®¹å™¨åº“ï¼Œå¦‚ TArray, TList, TMap, More...
    - Other:  FName, FArchive, FOutputDevice
- `CoreUObject` æ ¸å¿ƒå¯¹è±¡åŸºç±»ï¼Œå®šä¹‰äº† `UObject` å®ç°äº†å¼ºå¤§çš„è¿è¡Œæ—¶ç±»å‹çš„æ”¯æŒï¼Œä½¿å¾—å¼•æ“å¯ä»¥å¯¹å…¶å­ç±»è¿›è¡Œç®¡ç†ï¼Œå¹¶ä¸è“å›¾ç¼–è¾‘é›†æˆã€‚æä¾› serialization, network replication, and runtime type information, garbage collectedã€‚
    - Classes: UObject, UClass, UProperty, UPackage
    - Functions: ConstructObject, FindObject, Cast, CastChecked
- `Engine` æ¸¸æˆå¼•æ“æ ¸å¿ƒï¼ŒåŒ…æ‹¬æ¸¸æˆæ¨¡æ‹Ÿä¸–ç•Œä¸­çš„å¯¹è±¡ï¼Œworld, actors, characters, physics and special effectsï¼›
    - Actors: AActor, AVolume, AGameMode, AHUD, More...
    - Pawns: APawn, ACharacter, AWheeledVehicle
    - Controllers: AController, AAIController, APlayerController
    - Components: UActorComponent, UBrainComponent, UInputComponent, USkeletalMeshComponent, UParticleSystemComponent, More...
    - Gameplay: UPlayer, ULocalPlayer, UWorld, ULevel
    - Assets: UTexture, UMaterial, UStaticMesh, USkeletalMesh, UParticleSystem

Include What You Useï¼ˆIWYUï¼‰åŒ…å«æ‚¨æ‰€ä½¿ç”¨ï¼Œæ„å‘³ç€å¼•æ“çš„æºä»£ç åªåŒ…æ‹¬å…¶éœ€è¦ç¼–è¯‘çš„ä¾èµ–æ€§ã€‚
IWYU è§„èŒƒçš„ç›®çš„æ˜¯ä¸ºé¿å…åŒ…å«å•å—å¤´æ–‡ä»¶ï¼Œå¦‚ *Engine.h* æˆ– *UnrealEd.h*ï¼Œå€Ÿæ­¤çœå»ä¸å¿…è¦çš„ä¾èµ–æ€§ã€‚

å¦‚éœ€è¦æ¸¸æˆä½¿ç”¨ IWYUï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

- åœ¨æ¯ä¸ªå¤´æ–‡ä»¶çš„é¡¶éƒ¨åŒ…å« *CoreMinimal.h*ã€‚
- ç¦ç”¨PCHæ–‡ä»¶ï¼Œåœ¨éç»Ÿä¸€æ¨¡å¼ä¸­ç¼–è¯‘æ¸¸æˆé¡¹ç›®ï¼Œå³å¯éªŒè¯æ‰€æœ‰æºæ–‡ä»¶åŒ…å«å…¶å¿…éœ€çš„æ‰€æœ‰ä¾èµ–æ€§ã€‚
- å¦‚æœéœ€è¦è®¿é—® Runtime\Engine\Classes\Engine\Engine.h ä¸­å®šä¹‰çš„ UEngine æˆ– GEngineï¼Œå¯ *#include Engine/Engine.h*ï¼Œå®ƒæœ‰åˆ«äº Runtime\Engine\Public\Engine.hã€‚
- å¦‚æœæ‚¨ä½¿ç”¨äº†ç¼–è¯‘å™¨æ— æ³•è¯†åˆ«çš„ç±»ï¼Œä¹Ÿä¸äº†è§£éœ€è¦åŒ…æ‹¬çš„å†…å®¹ï¼Œåˆ™å¯èƒ½ä¼šç¼ºå¤±å¤´æ–‡ä»¶ã€‚å¦‚æœä»æ­£ç¡®ç¼–è¯‘çš„é IWYU ä»£ç è½¬æ¢è€Œæ¥ï¼Œæƒ…å†µå°¤ä¸ºå¦‚æ­¤ã€‚æ‚¨å¯ä»¥åœ¨ API æ–‡æ¡£ä¸­æŸ¥æ‰¾ç±»ï¼Œå¹¶åœ¨é¡µé¢åº•éƒ¨æŸ¥æ‰¾å¿…è¦çš„æ¨¡å—å’Œå¤´æ–‡ä»¶ã€‚


åˆ›å»ºæ–°é¡¹ç›®æ—¶ï¼Œä¸€èˆ¬æœ‰ Blueprint Project å’Œ C++ Project ä¸¤ç§é£æ ¼ã€‚

ä»¥ 2D Side Scroller æ¨¡æ¿åˆ›å»ºä¸€ä¸ªè“å›¾å·¥ç¨‹ï¼Œåç§°ä¸º P2Dã€‚é»˜è®¤çŠ¶æ€ä¸‹ï¼Œé¡¹ç›®æ–‡ä»¶ P2D.uproject ä¸å« Modules é…ç½®ï¼Œæ¨¡å—é…ç½®å†…å®¹ç”± `ModuleDescriptor` æè¿°ã€‚

åœ¨é¡¹ç›®ä¸­é€šè¿‡ New C++ Class ç±»å‘å¯¼åˆ›å»ºç±»æ—¶ï¼Œæ¯”å¦‚åˆ›å»ºä¸€ä¸ª MyActor ç±»ï¼Œå®ƒå°±å¯ä»¥å˜æˆä¸€ä¸ª C++ å·¥ç¨‹ï¼Œä¹Ÿå°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ¸¸æˆæ¨¡å—ï¼Œé¡¹ç›®æ–‡ä»¶ä¼šæ·»åŠ  Modules é…ç½®ï¼š

```json
{
    "FileVersion": 3,
    "EngineAssociation": "4.27",
    "Category": "",
    "Description": "",
    "Modules": [
        {
            "Name": "P2D",
            "Type": "Runtime",
            "LoadingPhase": "Default",
            "AdditionalDependencies": [
                "Engine"
            ]
        }
    ],
    "Plugins": [
        {
            "Name": "Paper2D",
            "Enabled": true
        }
    ]
}
```

å¹¶ä¸”ä¼šåˆ›å»º Sources ç›®å½•ï¼Œé™¤äº†ç±»æ–‡ä»¶ï¼Œè¿˜ä¼šåˆ›å»º UBT ç›¸å…³çš„ç¼–è¯‘è§„åˆ™ç±»æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š

- P2D.Target.cs æ¸¸æˆé¡¹ç›®ç¼–è¯‘è§„åˆ™ç±» `TargetRules`ï¼ŒUBT æ‰§è¡Œæ—¶ä¼šç¼–è¯‘å‡ºæœ€ç»ˆå¯æ‰§è¡Œçš„æ¸¸æˆç¨‹åºï¼›
- P2DEditor.Target.cs ç¼–è¯‘å™¨ç¼–è¯‘è§„åˆ™ `TargetRules`ï¼ŒUBT æ‰§è¡Œç¼–è¯‘å‡ºæ‰©å±•è™šå¹»ç¼–è¾‘å™¨çš„ç›®æ ‡ï¼›
- P2D/ æ¸¸æˆé¡¹ç›®æ¨¡å—ç›®å½•ï¼Œä¿å­˜æ¨¡å—ç›¸å…³ä»£ç ï¼›
- p2D/MyActor.h
- p2D/MyActor.cpp
- p2D/P2D.h æ¸¸æˆæ¨¡å—å¤´æ–‡ä»¶ï¼Œä¸»è¦å¼•å…¥å¼•æ“æœ€åŸºæœ¬çš„å¤´æ–‡ä»¶ `#include "CoreMinimal.h"`ï¼›
- p2D/P2D.cpp æ¨¡å—å®ç°æ–‡ä»¶ï¼Œä¸»è¦åŒ…å« `IMPLEMENT_PRIMARY_GAME_MODULE` å®çš„ä½¿ç”¨ï¼›
- p2D/P2D.Build.cs æ¨¡å—ä¾èµ–è§„åˆ™é…ç½®ç±» `ModuleRules`ï¼Œç¼–è¯‘æ—¶æ ¹æ®å®ƒå¼•å…¥ä¾èµ–æ¨¡å—ï¼Œå¹¶æœ€ç»ˆç”Ÿæˆ DLL æ–‡ä»¶ï¼›

æ¨¡å—ç±»å®šä¹‰æ ¹æ® ModuleManager æä¾›çš„ `IModuleInterface` æ¥å£å®ç°ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ `IMPLEMENT_PRIMARY_GAME_MODULE` å®å®ç°åŸºæœ¬éª¨æ¶ã€‚

```C++,
    // P2D.h
    #pragma once

    #include "CoreMinimal.h"

    // P2D.cpp
    #include "P2D.h"
    #include "Modules/ModuleManager.h"

    IMPLEMENT_PRIMARY_GAME_MODULE( FDefaultGameModuleImpl, P2D, "P2D" );
```

æ ¹æ®é»˜è®¤æ¨¡å—å®ç°å®çš„å®šä¹‰ï¼Œåœ¨ç”Ÿæˆçš„ Intermediate\Build\Win64\UnrealEditor\Development\Puzzle\Definitions.Puzzle.h å°±ä¼šåŒ…å«ä»¥ä¸‹å®šä¹‰ï¼Œåœ¨å®šä¹‰ç±»æ—¶å¯ä»¥ç”¨æ¥å£°æ˜å¯¼å‡º APIï¼š

```C++,
#define P2D_API DLLEXPORT
```

ä¾‹å¦‚ MyPawn.h ä¸­ä½¿ç”¨å®ƒæ¥å®šä¹‰å¯¼å‡ºçš„ APIï¼š

```C++,
    #pragma once

    #include "CoreMinimal.h"
    #include "GameFramework/Pawn.h"
    #include "MyPawn.generated.h"

    UCLASS()
    class P2D_API AMyPawn : public APawn
    {
        GENERATED_BODY()

    public:
        // Sets default values for this pawn's properties
        AMyPawn();

    };
```

åˆšåˆ›å»ºçš„ Target.cs å’Œ Editor.Target.cs å·®åˆ«ä¸å¤§ï¼Œä¸»è¦æ˜¯ TargetType ç±»å‹é€‰æ‹©ä¸åŒï¼Œå‰è€…æ˜¯ Game åè€…æ˜¯ Editorã€‚

```C#,
    // Fill out your copyright notice in the Description page of Project Settings.

    using UnrealBuildTool;
    using System.Collections.Generic;

    public class P2DTarget : TargetRules
    {
        public P2DTarget(TargetInfo Target) : base(Target)
        {
            Type = TargetType.Game;
            DefaultBuildSettings = BuildSettingsVersion.V2;

            ExtraModuleNames.AddRange( new string[] { "P2D" } );
        }
    }
```

è¿˜å¯ä»¥æ„å»ºä¸“æœ‰æœåŠ¡å™¨ç¨‹åºï¼Œåªéœ€è®¾ç½®ä¸º `TargetType.Server`ã€‚ç„¶åï¼Œåœ¨é¡¹ç›®åŸºæœ¬ç›®å½•ä¸­æ‰¾åˆ°é¡¹ç›®çš„ uproject æ–‡ä»¶ï¼Œä½¿ç”¨å³é”®èœå• Generate Visual Studio Project Files ä¸ºæ¸¸æˆé‡æ–°ç”Ÿæˆ Visual Studio è§£å†³æ–¹æ¡ˆï¼Œè¿™ä¸ªæ–¹æ¡ˆä¼šæä¾›ç”¨äºæ„å»ºä¸“æœ‰æœåŠ¡å™¨ç¨‹åºçš„é…ç½®ã€‚

Build.cs æ–‡ä»¶å†…å®¹å‚è€ƒï¼š

```C#,
    // Fill out your copyright notice in the Description page of Project Settings.

    using UnrealBuildTool;

    public class P2D : ModuleRules
    {
        public P2D(ReadOnlyTargetRules Target) : base(Target)
        {
            PCHUsage = PCHUsageMode.UseExplicitOrSharedPCHs;
        
            PublicDependencyModuleNames.AddRange(new string[] { "Core", "CoreUObject", "Engine", "InputCore" });

            PrivateDependencyModuleNames.AddRange(new string[] {  });

            // Uncomment if you are using Slate UI
            // PrivateDependencyModuleNames.AddRange(new string[] { "Slate", "SlateCore" });
            
            // Uncomment if you are using online features
            // PrivateDependencyModuleNames.Add("OnlineSubsystem");

            // To include OnlineSubsystemSteam, add it to the plugins section in your uproject file with the Enabled attribute set to true
        }
    }
```

æ‰‹åŠ¨æ·»åŠ æ¨¡å—æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

- ä¿®æ”¹ `uproject` æ–‡ä»¶ï¼Œæ·»åŠ æ–°æ¨¡å—é…ç½®ï¼›
- åˆ›å»º `Build.cs` æ–‡ä»¶ï¼Œå°†æ–°çš„æ¨¡å—ä½œä¸ºä¾èµ–æ¨¡å—æ·»åŠ ï¼Œå¹¶ä¸”åˆåˆ›å»º `Private` å’Œ `Public` å­ç›®å½•ï¼Œåˆ†åˆ«å­˜æ”¾ä»£ç å’Œå¤´æ–‡ä»¶ï¼›
- åˆ›å»ºæ¨¡å—ç±»ï¼Œæ ¹æ® ModuleManager æä¾›çš„ `IModuleInterface` æ¥å£å®ç°æ¨¡å—ç±»ï¼›
- åˆ›å»ºè‡³å°‘ä¸€ä¸ªç±»ï¼ŒåŒ…æ‹¬å¤´æ–‡ä»¶å’Œä»£ç ï¼›

å¦‚ä¸Šæ‰€è¯´ï¼Œæ¸¸æˆæ¨¡å—è‡³å°‘è¦åŒ… Privateã€Public æ–‡ä»¶å¤¹ï¼Œå¦å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªç¼–è¯‘æ–‡ä»¶ `*.Build.cs`ã€‚

æŒ‰ä»¥ä¸‹ç›®å½•ç»“æ„ï¼Œæ·»åŠ  ModuleTest æ¨¡å—ï¼Œå¹¶åˆ›å»º ModuleTest.Build.cs æ„å»ºè§„åˆ™ï¼Œå†åœ¨å·¥ç¨‹ä¸­æ·»åŠ æ­¤æ¨¡å—ï¼š

    - P2D/
       +- Source/
           +- P2D.Target.cs 
           +- P2DEditor.Target.cs
           +- P2D/ (Primary game module folder)
           |    +- Private/
           |    +- Public/
           |    +- P2D.Build.cs
           |    +- Other C++ classes in your game module
           +- ModuleTest
               +- Private/
               +- Public/


å‚è€ƒ https://www.orfeasel.com/creating-custom-modules/

ç›¸å…³æºä»£ç ï¼š

- Epic Games\UE_4.27\Engine\Source\Runtime\Core\Public\Modules\ModuleManager.h
- Epic Games\UE_4.27\Engine\Source\Runtime\Projects\Public\ModuleDescriptor.h


# ğŸŒŸ Actor & Component
- Framework Class Relationships https://docs.unrealengine.com/4.27/en-US/InteractiveExperiences/Framework/QuickReference/
- ä¸ºUnityå¼€å‘è€…å‡†å¤‡çš„è™šå¹»å¼•æ“4æŒ‡å— https://docs.unrealengine.com/4.27/zh-CN/Basics/UnrealEngineForUnityDevs/
- Gameplay æ¡†æ¶å¿«é€Ÿå‚è€ƒ https://docs.unrealengine.com/4.27/zh-CN/InteractiveExperiences/Framework/QuickReference/
- Gameplay Actors https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ProgrammingWithCPP/UnrealArchitecture/Actors/
- Actors å¯¹è±¡ä»‹ç» https://docs.unrealengine.com/4.27/zh-CN/Basics/Actors
- Components å¯¹è±¡ä»‹ç»  https://docs.unrealengine.com/4.27/zh-CN/Basics/Components
- AActor API https://docs.unrealengine.com/4.27/en-US/API/Runtime/Engine/GameFramework/AActor/
- UActorComponent API https://docs.unrealengine.com/4.27/en-US/API/Runtime/Engine/Components/UActorComponent/
- USceneComponent API https://docs.unrealengine.com/4.27/en-US/API/Runtime/Engine/Components/USceneComponent/
- UPrimitiveComponent API https://docs.unrealengine.com/4.27/en-US/API/Runtime/Engine/Components/UPrimitiveComponent/

ç»å¤§éƒ¨åˆ†æ¸¸æˆå¼•æ“éƒ½å¾—è§£å†³ä¸€ä¸ªåŸºæœ¬é—®é¢˜ï¼šå°†ç°å®ä¸–ç•ŒæŠ½è±¡ä¸ºä¸€ä¸ª 3D æ¸¸æˆæ¨¡æ‹Ÿçš„ä¸–ç•Œã€‚æ ¹æ®åŸºæœ¬çš„è®¡ç®—æœºå›¾å½¢å­¦çŸ¥è¯†ï¼Œä¸ºäº†å±•ç¤ºè¿™ä¸ªä¸–ç•Œï¼Œéœ€è¦ä¸€ä¸ªä¸ªå¸¦ç€å˜æ¢çš„æ¸¸æˆå¯¹è±¡ï¼Œæ¥ç€è®©å®ƒä»¬çˆ¶å­åµŒå¥—ä»¥è¡¨ç°æ›´å¤æ‚çš„ç»“æ„ã€‚æœ¬è´¨ä¸Šï¼Œå…¶ä»–çš„ç‰©ç†æ¨¡æ‹Ÿï¼Œæ¸¸æˆé€»è¾‘ç­‰åŠŸèƒ½ç»„ä»¶ï¼Œæœ€ç»ˆç›®çš„ä¹Ÿåªæ˜¯ä¸ºäº†æ“ä½œè¿™äº›æ¸¸æˆä¸–ç•Œä¸­çš„å¯¹è±¡ã€‚

UE4 çš„ä¸–ç•Œä¸­ï¼Œä¸‡ç‰©çš† `UObject`ï¼Œæ¥ç€æœ‰ `AActor` å’Œ
`UActorComponent`ï¼Œä»¥åŠå®ƒä»¬çš„ç”Ÿå‘½å‘¨æœŸï¼ŒBeginPlayã€EndPlayã€Tickï¼Œäº‹ä»¶ä¼ é€’ç­‰æœºåˆ¶ã€‚

è—‰ç€ UObject æä¾›çš„å…ƒæ•°æ®ã€åå°„ç”Ÿæˆã€GCåƒåœ¾å›æ”¶ã€åºåˆ—åŒ–ã€ç¼–è¾‘å™¨å¯è§ï¼ŒClass Default Object ç­‰ï¼ŒUE4 å¯ä»¥æ„å»ºä¸€ä¸ªå¯¹è±¡è¿è¡Œçš„ä¸–ç•Œã€‚

Actor çš„æ¦‚å¿µåœ¨ UE é‡Œå…¶å®ä¸æ˜¯æŸç§å…·è±¡åŒ–çš„ 3D ä¸–ç•Œé‡Œçš„å¯¹è±¡ï¼Œè€Œæ˜¯ä¸–ç•Œé‡Œçš„ç§ç§å…ƒç´ ï¼Œç”¨æ›´æ³›åŒ–æŠ½è±¡çš„æ¦‚å¿µæ¥çœ‹ï¼Œå°åˆ°ä¸€ä¸ªä¸ªåœ°ä¸Šçš„çŸ³å¤´ï¼Œå¤§åˆ°æ•´ä¸ªä¸–ç•Œçš„è¿è¡Œè§„åˆ™ã€‚

Actor ä¹‹é—´è¿˜å¯ä»¥äº’ç›¸åµŒå¥—ï¼Œæ‹¥æœ‰ç›¸å¯¹çš„çˆ¶å­å…³ç³»ï¼Œè¿˜æœ‰ Tick å¿ƒè·³äº‹ä»¶ï¼Œè¿™æ ·åœ¨æ¸¸æˆä¸­è¿›è¡Œå®šæœŸçš„äº‹ä»¶å¤„ç†ï¼Œä¸åŒçš„ Actor ç±»å‹å…·æœ‰ä¸åŒçš„åŠŸèƒ½ç”¨é€”ã€‚

å¯èƒ½å› ä¸º UE æ›´éµå¾ª C++ è®¾è®¡å“²å­¦â€œä¸ä¸ºä½ ä¸éœ€è¦çš„ä¸œè¥¿ä»˜ä»£ä»·â€ï¼Œè€Œä¸€ä¸ª Transform å†åŠ ä¸Šé™„å¸¦çš„é€†çŸ©é˜µä¹‹ç±»çš„è¡¨ç¤ºï¼Œå†…å­˜å ç”¨ä¸Šå…¶å®ä¹Ÿæ˜¯æŒºå¯è§‚çš„ã€‚æ‰€ä»¥ï¼ŒActor ä¸åƒ GameObject ä¸€æ ·è‡ªå¸¦ Transformã€‚

åœ¨æ•´ä¸ªå¤æ‚çš„ UE æ¨¡æ‹Ÿä¸–ç•Œä¸­ï¼ŒActor åªæä¾›ä¸€äº›é€šç”¨çš„åŸºæœ¬èƒ½åŠ›ï¼Œé€šè¿‡ç»„åˆä¸åŒçš„ Component å°±å¯ä»¥è®© Actor å…·æœ‰ç‰¹å®šçš„èƒ½åŠ›ã€‚

ç»„ä»¶å°±æ˜¯å¯ä»¥æ·»åŠ åˆ° Actor ä¸Šçš„ä¸€é¡¹åŠŸèƒ½æ€§æ‰©å±•ï¼Œç»„ä»¶å¿…é¡»ç»‘å®šåœ¨ Actor èº«ä¸Šã€‚ç”±äºç»„ä»¶æ˜¯æ¸²æŸ“ç½‘æ ¼ä½“å’Œå›¾åƒã€å®ç°ç¢°æ’å’Œæ’­æ”¾éŸ³é¢‘çš„å”¯ä¸€æ–¹æ³•ï¼Œå› æ­¤ç©å®¶æ¸¸æˆæœŸé—´åœ¨åœºæ™¯ä¸­çœ‹åˆ°æˆ–è¿›è¡Œäº¤äº’çš„ä¸€åˆ‡å…¶å®éƒ½æ˜¯æŸä¸€ç±»ç»„ä»¶çš„æˆæœã€‚

å½“ä½ ä¸º Actor æ·»åŠ ç»„ä»¶åï¼Œè¯¥ Actor ä¾¿è·å¾—äº†è¯¥ç»„ä»¶æ‰€æä¾›çš„åŠŸèƒ½ï¼Œå°† Component ä¸ Actor ç»„ä»¶åœ¨ä¸€èµ·åˆå…³ç³»ç€ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ã€‚

å…¶å®ƒä¸€äº›ç»„ä»¶å‚è€ƒï¼š

- Application Lifecycle ç»„ä»¶è´Ÿè´£æ¥æ”¶æ¥è‡ªæ“ä½œç³»ç»Ÿçš„åº”ç”¨çŠ¶æ€ï¼ˆå¼€å§‹ã€åœæ­¢ã€ç»“æŸç­‰ï¼‰é€šçŸ¥ã€‚
- Cable Component æ’ä»¶åˆ›å»ºå’Œæ§åˆ¶ç¼†ç»³çš„å¤–è§‚ã€å“åº”æ–¹å¼ï¼Œç”šè‡³æ˜¯è®©å®ƒå’Œå…³å¡ä¸­çš„ç‰©ä½“å‘ç”Ÿç¢°æ’ã€‚
- Widget æ§ä»¶ç»„ä»¶æ˜¯æ§ä»¶è“å›¾çš„ 3D å®ä¾‹ï¼Œå¯ä»¥åœ¨æ¸¸æˆåœºæ™¯ä¸­ä¸ä¹‹äº¤äº’ã€‚
- èšå…‰ç¯ç»„ä»¶ï¼ˆSpot Light Componentï¼‰å…è®¸ä½ çš„ Actor åƒèšå…‰ç¯ä¸€æ ·å‘å…‰ï¼Œ
- æ—‹è½¬ç§»åŠ¨ç»„ä»¶ï¼ˆRotating Movement Componentï¼‰èƒ½ä½¿ä½ çš„ Actor å››å¤„æ—‹è½¬ï¼Œ
- AudioComponent ç”¨äºåˆ›å»ºå’Œæ§åˆ¶æ¸¸æˆå†…éƒ¨å£°éŸ³çš„å®ä¾‹ï¼Œä½¿ä½ çš„ Actor èƒ½å¤Ÿæ’­æ”¾å£°éŸ³ã€‚

Actor å¹¶æ²¡æœ‰ AddChild å‡½æ•°ï¼Œåªæœ‰ä½¿ç”¨ AttachToActor å’Œ AttachToComponent æ¥åˆ›å»ºçˆ¶å­é“¾æ¥ã€‚

ç±»ä¼¼äº Unity çš„ Startï¼ŒOnDestroy å’Œ Update å‡½æ•°ï¼Œè™šå¹» 4 åœ¨ Actor ä¸­æœ‰ç±»ä¼¼çš„æ–¹æ³•ï¼Œè€Œç»„ä»¶ä½¿ç”¨ä¸åŒçš„å‡½æ•°ï¼Œä»¥ä¸‹æ˜¯ç¤ºä¾‹ï¼š

```C++,
    UCLASS()
    class AMyActor : public AActor
    {
        GENERATED_BODY()

        // æ¸¸æˆå¼€å§‹æ—¶è°ƒç”¨
        // è“å›¾äº‹ä»¶ï¼šEvent Begin Play
        void BeginPlay();

        // å½“æ­¤Actoré”€æ¯æ—¶è°ƒç”¨
        // è“å›¾äº‹ä»¶ï¼šEvent End Play
        void EndPlay(const EEndPlayReason::Type EndPlayReason);

        // æ¯å¸§è°ƒç”¨ï¼Œç”¨äºæ›´æ–°æ­¤Actor
        // è“å›¾äº‹ä»¶ï¼šEvent Tick
        void Tick(float DeltaSeconds);
    };


    UCLASS()
    class UMyComponent : public UActorComponent
    {
        GENERATED_BODY()

        // å½“æ‰€å±Actoråˆ›å»ºæ—¶è°ƒç”¨
        // è“å›¾äº‹ä»¶ï¼šEvent Initialize Component
        void InitializeComponent();

        // å½“ç»„ä»¶æˆ–æ‰€å±Actoré”€æ¯æ—¶è°ƒç”¨
        // è“å›¾äº‹ä»¶ï¼šEvent Uninitialize Component
        void UninitializeComponent();

        // ç»„ä»¶ç‰ˆçš„Tickå‡½æ•°
        // è“å›¾äº‹ä»¶ï¼šEvent Tick Component
        void TickComponent(float DeltaTime, enum ELevelTick TickType, FActorComponentTickFunction* ThisTickFunction);
    };
```

ç»„ä»¶æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„å¯¹è±¡ï¼ŒActor å¯ä»¥å°†ç»„ä»¶ä½œä¸ºå­å¯¹è±¡é™„åŠ åˆ°è‡ªèº«ã€‚ç»„ä»¶é€‚ç”¨äºå…±äº«ç›¸åŒçš„è¡Œä¸ºï¼Œä¾‹å¦‚æ˜¾ç¤ºè§†è§‰è¡¨ç°ã€æ’­æ”¾å£°éŸ³ã€‚å®ƒä»¬è¿˜å¯ä»¥è¡¨ç¤ºé¡¹ç›®ç‰¹æœ‰çš„æ¦‚å¿µï¼Œä¾‹å¦‚è½½å…·è§£è¯‘è¾“å…¥å’Œæ”¹å˜å…¶é€Ÿåº¦ä¸æ–¹å‘çš„æ–¹å¼ã€‚ä¸¾ä¾‹è€Œè¨€ï¼ŒæŸä¸ªé¡¹ç›®æ‹¥æœ‰ç”¨æˆ·å¯æ§åˆ¶è½¦è¾†ã€é£æœºå’Œèˆ¹åªã€‚å¯ä»¥é€šè¿‡æ›´æ”¹è½½å…· Actor æ‰€ä½¿ç”¨çš„ç»„ä»¶æ¥å®ç°è½½å…·æ§åˆ¶å’Œç§»åŠ¨çš„å·®å¼‚ã€‚

åˆ›å»ºè‡ªå·±çš„ç»„ä»¶æ—¶ï¼Œéœ€è¦äº†è§£ä¸‰å¤§åŸºç¡€ç»„ä»¶ AC/SC/PCï¼š

- `UActorComponent` æ‰€æœ‰ç»„ä»¶åŸºç±»ï¼Œæœ€é€‚ç”¨äº Actor çš„æŠ½è±¡è¡Œä¸ºï¼Œä¾‹å¦‚ç§»åŠ¨ã€ç‰©å“æ æˆ–å±æ€§ç®¡ç†ï¼Œä»¥åŠå…¶ä»–éç‰©ç†æ¦‚å¿µã€‚AC ç»„ä»¶ä¸å…·æœ‰åµŒå¥—èƒ½åŠ›ï¼Œæ²¡æœ‰å˜æ¢èƒ½åŠ›ï¼Œå³å®ƒä»¬åœ¨åœºæ™¯ä¸­ä¸å­˜åœ¨ä»»ä½•ç‰©ç†ä½ç½®æˆ–æ—‹è½¬ã€‚
- `USceneComponent` åœºæ™¯ç»„ä»¶ï¼ŒUActorComponent çš„å­ç±»ï¼Œæ”¯æŒåŸºäºä½ç½®çš„è¡Œä¸ºï¼Œè¿™ç±»è¡Œä¸ºä¸éœ€è¦å‡ ä½•è¡¨ç¤ºã€‚è¿™åŒ…æ‹¬å¼¹ç°§è‡‚ã€æ‘„åƒæœºã€ç‰©ç†åŠ›å’Œçº¦æŸï¼ˆä½†ä¸åŒ…æ‹¬ç‰©ç†å¯¹è±¡ï¼‰ï¼Œç”šè‡³éŸ³é¢‘ã€‚
- `UPrimitiveComponent` åŸºå…ƒç»„ä»¶ï¼ŒUSceneComponent çš„å­ç±»ï¼Œæ˜¯æ‹¥æœ‰å‡ ä½•è¡¨ç¤ºçš„åœºæ™¯ç»„ä»¶ï¼Œé€šå¸¸ç”¨äºæ¸²æŸ“è§†è§‰å…ƒç´ æˆ–ä¸ç‰©ç†å¯¹è±¡å‘ç”Ÿç¢°æ’æˆ–é‡å ã€‚è¿™åŒ…æ‹¬é™æ€æˆ–éª¨æ¶ç½‘æ ¼ä½“ã€Sprite æˆ–å…¬å‘Šæ¿ã€ç²’å­ç³»ç»Ÿä»¥åŠç›’ä½“ã€èƒ¶å›Šä½“å’Œçƒä½“ç¢°æ’ä½“ç§¯ã€‚

Actor æ”¯æŒæ‹¥æœ‰ä¸€ä¸ª SceneComponent å±‚çº§ã€‚UE æŠŠ Transform åŠŸèƒ½å°è£…è¿›äº† SceneComponent ç»„ä»¶ï¼Œå½“ä½œ Actor çš„ RootComponent æˆå‘˜ã€‚ä½†åœ¨æƒè¡¡åˆ°ä½¿ç”¨çš„ä¾¿åˆ©æ€§ï¼Œå¤§éƒ¨åˆ† Actor éƒ½æœ‰ Transform APIï¼Œå¦‚(Get/Set)ActorLocation ç­‰ï¼Œå…¶å®å†…éƒ¨éƒ½æ˜¯è½¬å‘åˆ° RootComponent å¼•ç”¨çš„åœºæ™¯ç»„ä»¶ä¸Šè¿›è¡Œçš„ã€‚

Actor å…¶å®æ›´åƒæ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œåªæä¾›äº†åŸºæœ¬çš„åˆ›å»ºé”€æ¯ï¼Œç½‘ç»œå¤åˆ¶ï¼Œäº‹ä»¶è§¦å‘ç­‰ä¸€äº›é€»è¾‘æ€§çš„åŠŸèƒ½ï¼Œè€ŒæŠŠçˆ¶å­çš„å…³ç³»ç»´æŠ¤éƒ½äº¤ç»™äº†å…·ä½“çš„ Componentï¼Œæ‰€ä»¥æ›´å‡†ç¡®çš„è¯´ï¼Œå…¶å®æ˜¯ä¸åŒ Actor çš„ SceneComponent ä¹‹é—´æœ‰çˆ¶å­å…³ç³»ï¼Œè€Œ Actor æœ¬èº«å…¶å®å¹¶ä¸å¤ªå…³å¿ƒã€‚

åªæœ‰åœºæ™¯ç»„ä»¶åŠå…¶å­ç±»å¯ä»¥å½¼æ­¤é™„åŠ ï¼Œå› ä¸ºéœ€è¦å˜æ¢æ¥æè¿°å­é¡¹å’Œçˆ¶é¡¹ç»„ä»¶ä¹‹é—´çš„ç©ºé—´å…³ç³»ã€‚è™½ç„¶åœºæ™¯ç»„ä»¶å¯ä»¥æ‹¥æœ‰ä»»æ„æ•°é‡çš„å­é¡¹ï¼Œä½†åªèƒ½æ‹¥æœ‰ä¸€ä¸ªçˆ¶é¡¹ï¼Œæˆ–å¯ç›´æ¥æ”¾ç½®åœ¨åœºæ™¯ä¸­ã€‚åœºæ™¯ç»„ä»¶ç³»ç»Ÿä¸æ”¯æŒé™„åŠ å¾ªç¯ã€‚

æä¾›ä¸¤ç§ä¸»è¦æ–¹æ³•ï¼š

- `SetupAttachment` ç”± USceneComponent ç»„ä»¶æä¾›ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­ã€ä»¥åŠå¤„ç†å°šæœªæ³¨å†Œçš„ç»„ä»¶æ—¶ååˆ†å®ç”¨ï¼›
- `AttachToComponent` æ–¹æ³•ï¼ŒActor å’Œ USceneComponent éƒ½æä¾›ï¼Œä¼šç«‹å³å°†åœºæ™¯ç»„ä»¶é™„åŠ åˆ°å¦ä¸€ä¸ªç»„ä»¶ï¼Œåœ¨æ¸¸æˆè¿›è¡Œä¸­ååˆ†å®ç”¨ã€‚è®¸å°† Actor å½¼æ­¤ä¹‹é—´è¿›è¡Œé™„åŠ ï¼Œæ–¹æ³•æ˜¯å°†ä¸€ä¸ª Actor çš„æ ¹ç»„ä»¶é™„åŠ åˆ°å±äºå¦ä¸€ä¸ª Actor çš„ç»„ä»¶ã€‚

æ‰€æœ‰å¯æ”¾ç½®åˆ°å…³å¡çš„ Actor éƒ½æœ‰ä¸€ä¸ª RootComponent å±æ€§ï¼Œå¼•ç”¨æ”¾ç½®å­çº§å¯¹è±¡çš„ SceneComponentã€‚åœºæ™¯ç»„ä»¶æŒ‡å®šäº† Actor åœ¨ä¸–ç•Œä¸­çš„ä½ç½®ã€è§’åº¦åŠç¼©æ”¾æ¯”ä¾‹ï¼Œè€Œè¿™äº›å±æ€§ä¼šå½±å“è¯¥ Actor çš„æ‰€æœ‰å­å¯¹è±¡ã€‚

å³ä¾¿æ˜¯ä¸€ä¸ªç©º Actorï¼Œä¹Ÿæ‹¥æœ‰ä¸€ä¸ªé»˜è®¤åœºæ™¯æ ¹ Default Scene Root å¯¹è±¡ï¼Œè¿™æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„åœºæ™¯ç»„ä»¶ã€‚åœ¨ç¼–è¾‘å™¨æ“ä½œé˜¶æ®µï¼Œå½“æˆ‘ä»¬ç»™æŸä¸ª Actor æ”¾ç½®ä¸€ä¸ªæ–°çš„åœºæ™¯ç»„ä»¶æ—¶ï¼Œè¯¥ Actor çš„é»˜è®¤åœºæ™¯æ ¹å¯¹è±¡ä¼šè¢«æ›¿æ¢æ‰ã€‚

    +===========+ 
    |   Actor   | 
    +===========+ 
          |       
          |       +===============+          Next Level
          +-----> | RootComponent | <-------------+
          |       +===============+               |
          |                                       |
          |       +================+      +=======v========+         Next Level
          +-----> | ActorComponent |      | SceneComponent | -------------+
          |       +================+      +================+              |
          |                                       |                       |
          |       +================+      +=======v========+      +=======v========+
          +-----> | ActorComponent |      | SceneComponent |      | SceneComponent |
          |       +================+      +================+      +================+
          |                                       |                       |
          |       +==========+               +====v====+             +====v====+    
          +-----> | More.... |               | More... |             | More... |    
                  +==========+               +=========+             +=========+    

    Actor & Component å±‚æ¬¡ç»“æ„

ä»¥ä¸‹ä»£ç ç‰‡æ®µç¤ºèŒƒåœ¨ Pawn ç±»ä¸­é™„åŠ ä¸€ä¸ªé™æ€ç½‘æ ¼ç»„ä»¶ï¼š

```C++,
    UStaticMeshComponent* VisualMesh;

    VisualMesh = CreateDefaultSubobject<UStaticMeshComponent>(TEXT("Mesh"));
    VisualMesh->SetupAttachment(RootComponent);

    static ConstructorHelpers::FObjectFinder<UStaticMesh> 
    CubeVisualAsset(TEXT("/Engine/StarterContent/Shapes/Shape_Cube"));
    // "/Game/Engine Content/StarterContent/Shapes/Shape_Cube.Shape_Cube";

    if (CubeVisualAsset.Succeeded()) 
    { 
            VisualMesh->SetStaticMesh(CubeVisualAsset.Object); 
            VisualMesh->SetRelativeLocation(FVector(0.0f, 0.0f, 0.0f)); 
    }
```

ç»„ç»‡ç»“æ„ä¸Šï¼ŒComponent æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª Ownerï¼Œå³ä¸€ä¸ª Actor æ‹¥æœ‰ä»»æ„ä¸ªç»„ä»¶ï¼Œä½†ç»„ä»¶åªèƒ½è¢«åŒä¸€ä¸ª Actor æ‹¥æœ‰ã€‚

ç»„ä»¶åœ¨ Actor ä½œä¸ºç±»çš„æ•°æ®æˆå‘˜å­˜åœ¨ï¼ŒåŸºäº UHT å®ç°çš„è¿è¡Œæ—¶ç±»å‹ç³»ç»Ÿï¼Œä» Actor è·å– Component å¯ä»¥é€šè¿‡ç»„ä»¶ Class ç±»å‹æŸ¥æ‰¾ï¼Œè€Œè·å–ç»„ä»¶çš„æ‰€æœ‰è€…åˆ™ç®€å•å¤šäº†ã€‚

```C++,
    AActor* Actor = Component->GetOwner();

    UInputComponent* InputComponent;
    InputComponent = GetOwner()->FindComponentByClass<UInputComponent>();
```

Actor çš„ RootComponent æˆå‘˜æ˜¯ç›¸å½“é‡è¦çš„ï¼Œå®ƒå¼•ç”¨çš„æ˜¯ USceneComponent å®ä¾‹ï¼Œè¿™ç§ä» UActorComponet æ‰©å±•çš„ç»„ä»¶å…·æœ‰å¯åµŒå¥—æ€§ã€‚

```C++,
    /** Adds a component to the instance components array */
    void AddInstanceComponent(UActorComponent* Component);

    /** Removes a component from the instance components array */
    void RemoveInstanceComponent(UActorComponent* Component);

    /** Clears the instance components array */
    void ClearInstanceComponents(bool bDestroyComponents);

    /** Returns the instance components array */
    const TArray<UActorComponent*>& GetInstanceComponents() const;
```


## âš¡ Actor Lifecycle
- Actor Lifecycle https://docs.unrealengine.com/4.27/en-US/ProgrammingAndScripting/ProgrammingWithCPP/UnrealArchitecture/Actors/ActorLifecycle/

Actor çš„äº§ç”Ÿæœ‰å¤šç§é€”å¾„ï¼Œå…·æœ‰å·®å¼‚åŒ–çš„ç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹ï¼š

- Play in Editor åœ¨å¼•æ“ç¼–è¾‘å™¨ä¸­æ‰€æœ‰ Actor éƒ½å¤åˆ¶å®ä¾‹åˆ°ä¸€ä¸ªæ–°çš„ World ç¯å¢ƒä¸­ï¼›
- Load from Disk é€šè¿‡ `UEngine::LoadMap` æˆ– `UWorld::AddToWorld` ä»ç£ç›˜åŠ è½½ Actorï¼›
- Spawning  é€šè¿‡ `UWorld::SpawnActor` ç”Ÿæˆï¼›
- Deferred Spawn é€šè¿‡ `UWorld::SpawnActorDeferred` å»¶æ—¶ç”Ÿæˆï¼›

åœ¨è¿è¡Œå®Œå‰æœŸçš„ç”Ÿå‘½å‘¨æœŸæµç¨‹äº‹ä»¶ï¼ŒActor ä¼šè¿›å…¥ Ticking å³ä»¥è§„åˆ™é—´éš”ï¼ˆå¸¸ä¸ºæ¯å¸§ä¸€æ¬¡ï¼‰åœ¨ä¸€ä¸ª actor æˆ–ç»„ä»¶ä¸Šè¿è¡Œä¸€æ®µä»£ç æˆ–è“å›¾è„šæœ¬ã€‚æ­£ç¡®ç†è§£æ¸¸æˆ actor å’Œç»„ä»¶ä¹‹é—´ç›¸å¯¹çš„ tick é¡ºåºå’Œ å¼•æ“æ‰§è¡Œçš„å…¶ä»–æ¯å¸§ä»»åŠ¡ååˆ†é‡è¦ï¼Œå¯é¿å…å¸§å·®ä¸€é—®é¢˜ï¼Œå¹¶ç¡®ä¿æ¸¸æˆè¿è¡Œçš„ä¸€è‡´æ€§ã€‚Actors å’Œç»„ä»¶å¯è®¾ä¸ºæ¯å¸§ tickï¼Œä¹Ÿå¯è®¾ä¸ºä»¥æœ€ä½æ—¶é—´é—´éš” tickï¼Œæˆ–å®Œå…¨ä¸ä½¿ç”¨ tickã€‚æ­¤å¤–ï¼Œå®ƒä»¬å¯åœ¨å¼•æ“æ¯å¸§æ›´æ–°å¾ªç¯ä¸­çš„ä¸åŒé˜¶æ®µè¢«åˆå¹¶ä¸ºç»„ï¼›ä¹Ÿå¯æ¥å—å•ç‹¬æŒ‡ä»¤ï¼Œç­‰å¾…ç‰¹å®š tick å®Œæˆåå†å¼€å§‹ã€‚

å¯ä»¥è®¤ä¸ºæ²¡æœ‰ç»„ä»¶çš„ Actor å°±æ˜¯ä¸ªç©ºå£³ï¼Œæ‰€ä»¥ï¼Œæ— è®ºå“ªç§æ–¹å¼ï¼Œæ‰€æœ‰è¿›åœºçš„ç»„ä»¶éƒ½ç»è¿‡åˆå§‹åŒ–æ‰èƒ½å®Œæˆ Actor å®ä¾‹çš„åˆå§‹åŒ–ï¼š

- `PreInitializeComponents` - åœ¨ Actor çš„ç»„ä»¶ä¸Šè°ƒç”¨ InitializeComponent ä¹‹å‰è¿›è¡Œè°ƒç”¨ã€‚
- `InitializeComponent` - Actor ä¸Šå®šä¹‰çš„æ¯ä¸ªç»„ä»¶çš„åˆ›å»ºè¾…åŠ©å‡½æ•°ã€‚
- `PostInitializeComponents` - Actor çš„ç»„ä»¶åˆå§‹åŒ–åè°ƒç”¨ã€‚

æ‰§è¡Œå®Œç»„ä»¶çš„åˆå§‹åŒ–äº‹ä»¶ï¼Œå°±ä¼šè¿›å…¥å¦‚ä»¥ä¸‹æµç¨‹å›¾æ‰€æç¤ºçš„æ‰§è¡Œè¿‡ç¨‹ï¼š

          +=============+                  +==========================+
          |  BeginPlay  |  <-------------- | PostInitializeComponents |
          +=============+                  +==========================+
                 |
    +============v============+
    |     Actor is Ticking    |
    | Or stuff is appening in |
    |     the application.    |
    +=========================+
                 |                            
                 |     +=======================+                 +=============+
                 +---> | Event Destory calle   | ----+---------> ||  EndPlay  ||
                 |     | on Actor?             |     |           +=============+
                 |     +=======================+     |                  |
                 |                                   |      +===========v============+
                 |     +=======================+     |      |      Actor marked      |
                 +---> | Actor Life Time       | ----+      |     RF_PendingKill     |
                 |     | execeeded?            |     |      +========================+
                 |     +=======================+     |                  |
                 |                                   |      +===========v============+
                 |     +=======================+     |      |     Next GC cycle      |
                 +---> | Is a Level Transition | ----+      |   will deallocate it   |
                 |     | occurring?            |     |      +========================+
                 |     +=======================+     |                  |
                 |                                   |      +===========v============+
                 |     +=======================+     |      |    Remove Actor from   |
                 +---> | Is Play in Editor     | ----+      | ULevel array of actors |
                 |     | ending?               |     |      +========================+
                 |     +=======================+     |                  |
                 |                                   |      +===========v============+
                 |     +=======================+     |      ||     BeginDestroy     ||
                 +---> | Is the Game ending?   | ----+      +========================+
                 |     |                       |     |                  |
                 |     +=======================+     |      +===========v=============+
                 |                                   |      ||IsReadyForFinishDestroy||
                 |     +=======================+     |      +=========================+
                 +---> | Is the application    | ----+                  |
                       | closing?              |            +===========v============+
                       +=======================+            ||     FinishDestroy    ||
                                                            +========================+

åœ¨ *BeginPlay* äº‹ä»¶æ‰§è¡Œä¹‹å‰ï¼Œæ ¹æ®ä¸åŒçš„ Actor äº§ç”Ÿé€”å¾„ï¼Œä¼šæœ‰ä»¥ä¸‹çš„ä¸åŒæ‰§è¡Œæµç¨‹ï¼Œå®ƒä»¬åç»­ç´§æ¥ç€ç»„ä»¶åˆå§‹åŒ–è¿‡ç¨‹ã€‚


    +==================+     +=========+       +============+          +============+            +============+
    |  Play in Editor  |     | LoadMap | --+-- | AddToWorld |          | SpawnActor |            | SpawnActor |
    +==================+     +=========+   |   +============+          +============+            +============+
              |                            |                                  |                         |
    +=========v========+       +===========v===========+           +==========v==========+   +==========v==========+
    |  All Actors are  |       | Load Actors from Disk |           | PostSpawnInitialize |   | PostSpawnInitialize |
    |  Duplicated to a |       +=======================+           +=====================+   +=====================+
    |  new World       |                   |                                  |                         |
    +==================+       +===========v===========+           +==========v==========+   +==========v==========+
              |                | Each loaded actor     |           |  PostActorCreated   |   |  PostActorCreated   |
    +=========v========+       | Calls PostLoad        |           +=====================+   +=====================+
    |  PostDuplicate   |       +=======================+                      |                         |                         |
    +==================+                   |                       +==========v==========+   +==========v==========+
              |               +============v============+          | ExecuteConstruction |   |  FinishSpawingActor |
              +-------------> | InitializeActorsForPlay |          +=====================+   +=====================+
                              +=========================+                     |                         |
                                           |                       +==========v==========+              |
                              +============v============+          ||   OnConstruction  || <------------+
                              |   RouteActorInitialize  |          +=====================+
                              +=========================+                     |
                                          |                                   |
                                          |    +=========================+    |
                                          +--> | PreInitializeComponents | <--+
                                               +=========================+

ä»ç£ç›˜åŠ è½½çš„åŸºæœ¬æµç¨‹ï¼š

- å·²ä½äºå…³å¡ä¸­çš„ Actor é€‚ç”¨æ­¤æµç¨‹ï¼Œå¦‚ `LoadMap` å‘ç”Ÿæ—¶ã€æˆ– `AddToWorld`ï¼ˆä»æµå…³å¡æˆ–å­å…³å¡ï¼‰è¢«è°ƒç”¨æ—¶ã€‚
- ä»ç£ç›˜ä¸­è¿›è¡ŒåŠ è½½åŒ…/å…³å¡ä¸­çš„ Actor å¯¹è±¡ã€‚
- `PostLoad` - åœ¨åºåˆ—åŒ– Actor ä»ç£ç›˜åŠ è½½å®Œæˆåè¢«è°ƒç”¨ï¼Œåœ¨æ­¤å¤„å¯æ‰§è¡Œè‡ªå®šä¹‰ç‰ˆæœ¬åŒ–å’Œä¿®å¤æ“ä½œï¼Œä¸ `PostActorCreated` äº’æ–¥ã€‚
- `InitializeActorsForPlay` è¢«æ‰§è¡Œã€‚
    - ä¸ºæœªåˆå§‹åŒ–çš„ Actor æ‰§è¡Œ `RouteActorInitialize`ï¼ˆåŒ…å«æ— ç¼è¡Œç¨‹æºå¸¦ï¼‰
    - `PreInitializeComponents` - åœ¨ Actor çš„ç»„ä»¶ä¸Šè°ƒç”¨ InitializeComponent ä¹‹å‰è¿›è¡Œè°ƒç”¨ã€‚
    - `InitializeComponent` - Actor ä¸Šå®šä¹‰çš„æ¯ä¸ªç»„ä»¶çš„åˆ›å»ºè¾…åŠ©å‡½æ•°ã€‚
    - `PostInitializeComponents` - Actor çš„ç»„ä»¶åˆå§‹åŒ–åè°ƒç”¨ã€‚
- `BeginPlay` - å…³å¡å¼€å§‹åè°ƒç”¨ã€‚

Play in Editor æ–¹å¼åŠ è½½æµç¨‹ï¼Œä¸ Load from Disk ååˆ†ç›¸ä¼¼ï¼Œç„¶è€Œ Actor å´å¹¶éä»ç£ç›˜ä¸­åŠ è½½ï¼Œè€Œæ˜¯ä»ç¼–è¾‘å™¨ä¸­å¤åˆ¶è€Œæ¥ã€‚

- ç¼–è¾‘å™¨ä¸­çš„ Actor è¢«å¤åˆ¶åˆ°æ–°åœºæ™¯ä¸­ï¼Œ`PostDuplicate` è¢«è°ƒç”¨ã€‚
- `InitializeActorsForPlay` è¢«æ‰§è¡Œã€‚
    - ä¸ºæœªåˆå§‹åŒ–çš„ Actor æ‰§è¡Œ `RouteActorInitialize`ï¼ˆåŒ…å«æ— ç¼è¡Œç¨‹æºå¸¦ï¼‰ã€‚
    - `PreInitializeComponents` - åœ¨ Actor çš„ç»„ä»¶ä¸Šè°ƒç”¨ InitializeComponent ä¹‹å‰è¿›è¡Œè°ƒç”¨ã€‚
    - `InitializeComponent` - Actor ä¸Šå®šä¹‰çš„æ¯ä¸ªç»„ä»¶çš„åˆ›å»ºè¾…åŠ©å‡½æ•°ã€‚
    - `PostInitializeComponents` - Actor çš„ç»„ä»¶åˆå§‹åŒ–åè°ƒç”¨ã€‚
- `BeginPlay` - å…³å¡å¼€å§‹åè°ƒç”¨ã€‚

SpawnActor æ–¹å¼å®ä¾‹åŒ–ç”Ÿæˆæµç¨‹ï¼š

- `SpawnActor` è¢«è°ƒç”¨ã€‚
- `PostSpawnInitialize`
- `PostActorCreated` - åˆ›å»ºåå³è¢«ç”Ÿæˆçš„ Actor è°ƒç”¨ï¼Œæ„å»ºå‡½æ•°ç±»è¡Œä¸ºåœ¨æ­¤å‘ç”Ÿï¼Œä¸ `PostLoad` äº’æ–¥ã€‚
- ExecuteConstructionï¼š
    - `OnConstruction` - Actor çš„æ„å»ºã€‚è“å›¾ Actor çš„ç»„ä»¶åœ¨æ­¤å¤„åˆ›å»ºï¼Œè“å›¾å˜é‡åœ¨æ­¤å¤„åˆå§‹åŒ–
- PostActorConstructionï¼š
    - `PreInitializeComponents` - åœ¨ Actor çš„ç»„ä»¶ä¸Šè°ƒç”¨ InitializeComponent ä¹‹å‰è¿›è¡Œè°ƒç”¨ã€‚
    - `InitializeComponent` - Actor ä¸Šå®šä¹‰çš„æ¯ä¸ªç»„ä»¶çš„åˆ›å»ºè¾…åŠ©å‡½æ•°ã€‚
    - `PostInitializeComponents` - Actor çš„ç»„ä»¶åˆå§‹åŒ–åè°ƒç”¨ã€‚
    - `OnActorSpawned` åœ¨ UWorld ä¸Šæ’­æ”¾ã€‚
- `BeginPlay` è¢«è°ƒç”¨ã€‚

Deferred Spawn å»¶è¿Ÿç”Ÿæˆæ–¹å¼æµç¨‹ï¼š

- å°†ä»»æ„å±æ€§è®¾ä¸º Expose on Spawn å³å¯å»¶è¿Ÿ Actor çš„ç”Ÿæˆã€‚
- `SpawnActorDeferred` - ç”Ÿæˆç¨‹åºåŒ– Actorï¼Œåœ¨è“å›¾æ„å»ºè„šæœ¬ä¹‹å‰è¿›è¡Œé¢å¤–è®¾ç½®ã€‚
- `SpawnActor` ä¸­çš„æ‰€æœ‰æ“ä½œå‘ç”Ÿï¼›`PostActorCreated` ä¹‹åå‘ç”Ÿä»¥ä¸‹æ“ä½œï¼š
    - é€šè¿‡ä¸€ä¸ªæœ‰æ•ˆä½†ä¸å®Œæ•´çš„ Actor å®ä¾‹è®¾ç½®/è°ƒç”¨å¤šä¸ª"åˆå§‹åŒ–å‡½æ•°"ã€‚
    - `FinishSpawningActor` -è°ƒç”¨åå¯¹ Actor è¿›è¡Œæœ€ç»ˆåŒ–ï¼Œåœ¨ Spawn Actor è¡Œä¸­é€‰å– ExecuteConstructionã€‚


Actor ç”Ÿå‘½èµ°å‘ç»ˆç‚¹è¿›è¡Œé”€æ¯ï¼Œé”€æ¯ Actor çš„æ–¹å¼æœ‰è®¸å¤šç§ï¼Œä½†ç»ˆç»“å…¶å­˜åœ¨çš„æ–¹å¼å§‹ç»ˆå¦‚ä¸€ã€‚

åœ¨æ¸¸æˆè¿›ç¨‹ä¸­ï¼šå®ƒä»¬çš„é”€æ¯è¡Œä¸ºå®Œå…¨ä¸ºå¯é€‰ï¼Œå› ä¸ºè®¸å¤š Actor åœ¨æ¸¸æˆè¿›ç¨‹ä¸­ä¸ä¼šå®é™…æ¶ˆäº¡ã€‚

- `Destroy` - æ¸¸æˆåœ¨ Actor éœ€è¦è¢«ç§»é™¤æ—¶æ‰‹åŠ¨è°ƒç”¨ï¼Œä½†æ¸¸æˆè¿›ç¨‹ä»åœ¨ç»§ç»­ã€‚Actor è¢«æ ‡è®°ä¸ºç­‰å¾…é”€æ¯å¹¶ä»å…³å¡çš„ Actor é˜µåˆ—ä¸­ç§»é™¤ã€‚
- `EndPlay` - åœ¨æ•°ä¸ªåœ°æ–¹è°ƒç”¨ï¼Œä¿è¯ Actor çš„ç”Ÿå‘½èµ°å‘ç»ˆç‚¹ã€‚åœ¨æ¸¸æˆè¿‡ç¨‹ä¸­ï¼Œå¦‚åŒ…å«æµå…³å¡çš„ Actor è¢«å¸è½½ï¼ŒDestroy å°†å‘å°„æ­¤é¡¹å’Œå…³å¡è¿‡æ¸¡ã€‚
- `OnDestroy` - è¿™æ˜¯å¯¹ Destroy çš„æ—§æœ‰ååº”ã€‚ä¹Ÿè®¸åº”è¯¥å°†è¿™é‡Œçš„æ‰€æœ‰å†…å®¹ç§»åˆ° EndPlayï¼Œå› ä¸ºå®ƒè¢«å…³å¡è¿‡æ¸¡å’Œå…¶ä»–æ¸¸æˆæ¸…ç†å‡½æ•°è°ƒç”¨ã€‚

è°ƒç”¨ EndPlay çš„å…¨éƒ¨æƒ…å½¢ï¼š

- å¯¹ Destroy æ–¹æ³•æ˜¾å¼è°ƒç”¨ã€‚
- Play in Editor ç»ˆç»“ã€‚
- å…³å¡è¿‡æ¸¡ï¼Œæ— ç¼è¡Œç¨‹æˆ–åŠ è½½åœ°å›¾ï¼ŒåŒ…å« Actor çš„æµå…³å¡è¢«å¸è½½ã€‚
- Actor çš„ç”Ÿå‘½æœŸå·²è¿‡ã€‚
- åº”ç”¨ç¨‹åºå…³é—­ï¼Œå…¨éƒ¨ Actor è¢«é”€æ¯ã€‚

æ— è®ºè¿™äº›æƒ…å½¢å‡ºç°çš„æ–¹å¼å¦‚ä½•ï¼ŒActor éƒ½å°†è¢«æ ‡è®°ä¸º RF_PendingKillï¼Œå› æ­¤åœ¨ä¸‹ä¸ªåƒåœ¾å›æ”¶å‘¨æœŸä¸­å®ƒå°†è¢«è§£é™¤åˆ†é…ã€‚æ­¤å¤–ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨æ›´æ•´æ´çš„ `FWeakObjectPtr<AActor>` ä»£æ›¿æ‰‹åŠ¨æ£€æŸ¥"ç­‰å¾…é”€æ¯"ã€‚

åƒåœ¾å›æ”¶é˜¶æ®µï¼šä¸€ä¸ªå¯¹è±¡è¢«æ ‡è®°å¾…é”€æ¯çš„ä¸€æ®µæ—¶é—´åï¼Œåƒåœ¾å›æ”¶ä¼šå°†å…¶ä»å†…å­˜ä¸­å®é™…ç§»é™¤ï¼Œé‡Šæ”¾å…¶ä½¿ç”¨çš„èµ„æºã€‚

åœ¨å¯¹è±¡çš„é”€æ¯è¿‡ç¨‹ä¸­ï¼Œä»¥ä¸‹å‡½æ•°å°†è¢«è°ƒç”¨ï¼š

- `BeginDestroy` - å¯¹è±¡å¯åˆ©ç”¨æ­¤æœºä¼šé‡Šæ”¾å†…å­˜å¹¶å¤„ç†å…¶ä»–å¤šçº¿ç¨‹èµ„æºï¼ˆå³ä¸ºå›¾åƒçº¿ç¨‹ä»£ç†å¯¹è±¡ï¼‰ã€‚ä¸é”€æ¯ç›¸å…³çš„å¤§å¤šæ•°æ¸¸æˆæ€§åŠŸèƒ½ç†åº”åœ¨ EndPlay ä¸­æ›´æ—©åœ°è¢«å¤„ç†ã€‚
- `IsReadyForFinishDestroy` - åƒåœ¾å›æ”¶è¿‡ç¨‹å°†è°ƒç”¨æ­¤å‡½æ•°ï¼Œä»¥ç¡®å®šå¯¹è±¡æ˜¯å¦å¯è¢«æ°¸ä¹…è§£é™¤åˆ†é…ã€‚è¿”å› falseï¼Œæ­¤å‡½æ•°å³å¯å»¶è¿Ÿå¯¹è±¡çš„å®é™…é”€æ¯ï¼Œç›´åˆ°ä¸‹ä¸€ä¸ªåƒåœ¾å›æ”¶è¿‡ç¨‹ã€‚
- `FinishDestroy` - æœ€åå¯¹è±¡å°†è¢«é”€æ¯ï¼Œè¿™æ˜¯é‡Šæ”¾å†…éƒ¨æ•°æ®ç»“æ„çš„å¦ä¸€ä¸ªæœºä¼šã€‚è¿™æ˜¯å†…å­˜é‡Šæ”¾å‰çš„æœ€åä¸€æ¬¡è°ƒç”¨ã€‚

è™šå¹»å¼•æ“ 4 ä¸­çš„åƒåœ¾å›æ”¶è¿‡ç¨‹å°†æ„å»ºå…±åŒè¢«é”€æ¯å¯¹è±¡çš„é›†ç¾¤ã€‚è¾ƒä¹‹äºå•ä¸ªåˆ é™¤å¯¹è±¡ï¼Œé›†ç¾¤å¯å‡å°‘åƒåœ¾å›æ”¶ç›¸å…³çš„æ€»ä½“æ—¶é—´å’Œæ•´ä½“å†…å­˜æµå¤±ã€‚å¯èƒ½éšå¯¹è±¡çš„åŠ è½½åˆ›å»ºå­å¯¹è±¡ã€‚å°†å¯¹è±¡ä¸å…¶å­å¯¹è±¡ç»„åˆåˆ°åƒåœ¾å›æ”¶å™¨çš„å•ä¸ªé›†ç¾¤åï¼Œå¼•æ“å¯å»¶è¿Ÿé‡Šæ”¾é›†ç¾¤ä½¿ç”¨çš„èµ„æºï¼Œç›´åˆ°æ•´ä¸ªå¯¹è±¡å¯è¢«é‡Šæ”¾æ—¶ä¸€æ¬¡æ€§é‡Šæ”¾å…¨éƒ¨èµ„æºã€‚

å¤šæ•°é¡¹ç›®ä¸­æ— éœ€å¯¹åƒåœ¾å›æ”¶è¿›è¡Œé…ç½®æˆ–ä¿®æ”¹ï¼Œä½†å­˜åœ¨ä¸€äº›ç‰¹å®šæƒ…å†µï¼Œå¯ä»¥å¯¹é¡¹ç›®é…ç½®çš„åƒåœ¾å›æ”¶å™¨çš„"é›†ç¾¤"è¡Œä¸ºè¿›è¡Œè°ƒæ•´ï¼Œä»¥æé«˜æ•ˆç‡ã€‚


ä¸ºäº†è®© Actor ç»„ä»¶èƒ½å¤Ÿé€å¸§æ›´æ–°å¹¶å½±å“åœºæ™¯ï¼Œå¼•æ“å¿…é¡»æ³¨å†Œè¿™ç±»ç»„ä»¶ã€‚å¦‚æœåœ¨ Actor äº§ç”Ÿè¿‡ç¨‹ä¸­ï¼Œä½œä¸º Actor å­å¯¹è±¡è‡ªåŠ¨åˆ›å»ºçš„ç»„ä»¶ä¼šè‡ªåŠ¨æ³¨å†Œã€‚ä½†æ˜¯ï¼Œæ¸¸æˆæœŸé—´åˆ›å»ºçš„ç»„ä»¶å¯ä»¥ä½¿ç”¨æ‰‹åŠ¨æ³¨å†Œã€‚`UActorComponent::RegisterComponent` å‡½æ•°æä¾›äº†è¿™ä¸ªåŠŸèƒ½ï¼Œè¦æ±‚æ˜¯ç»„ä»¶ä¸ Actor å…³è”ã€‚

æ³¨æ„ï¼šæ¸¸æˆæœŸé—´æ³¨å†Œç»„ä»¶å¯èƒ½ä¼šå½±å“æ€§èƒ½ï¼Œå› æ­¤åªåº”åœ¨å¿…è¦æ—¶è¿›è¡Œæ­¤æ“ä½œã€‚

åœ¨æ³¨å†Œç»„ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œå¼•æ“ä¼šå°†ç»„ä»¶ä¸åœºæ™¯å…³è”èµ·æ¥ï¼Œè®©å…¶å¯ç”¨äºé€å¸§æ›´æ–°ï¼Œå¹¶è¿è¡Œä»¥ä¸‹ UActorComponent å‡½æ•°ï¼š

- `OnRegister` åœ¨æ³¨å†Œç»„ä»¶æ—¶ï¼Œå¯ä»¥è¦†å†™æ­¤å‡½æ•°æ¥æ·»åŠ ä»£ç ã€‚
- `CreateRenderState` åˆå§‹åŒ–ç»„ä»¶çš„æ¸²æŸ“çŠ¶æ€ã€‚
- `OnCreatePhysicsState` åˆå§‹åŒ–ç»„ä»¶çš„ç‰©ç†çŠ¶æ€ã€‚

è¦ä»æ›´æ–°ã€æ¨¡æ‹Ÿæˆ–æ¸²æŸ“è¿‡ç¨‹ä¸­ç§»é™¤ Actor ç»„ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ UnregisterComponent å‡½æ•°å°†å…¶å–æ¶ˆæ³¨å†Œã€‚

åœ¨ç»„ä»¶å–æ¶ˆæ³¨å†Œæ—¶ï¼Œå°†è¿è¡Œä¸‹é¢çš„ UActorComponent å‡½æ•°ï¼š

- `OnUnregister` åœ¨å–æ¶ˆæ³¨å†Œç»„ä»¶æ—¶ï¼Œå¯ä»¥è¦†å†™æ­¤å‡½æ•°æ¥æ·»åŠ ä»£ç ã€‚
- `DestroyRenderState` å–æ¶ˆåˆå§‹åŒ–ç»„ä»¶çš„æ¸²æŸ“çŠ¶æ€ã€‚
- `OnDestroyPhysicsState` å–æ¶ˆåˆå§‹åŒ–ç»„ä»¶çš„ç‰©ç†çŠ¶æ€ã€‚

è¿™äº›äº‹ä»¶å‡½æ•°éƒ½æ¶‰åŠæ›´æ–°ã€æ¸²æŸ“çŠ¶æ€å’Œç‰©ç†çŠ¶æ€çš„ç®¡ç†ã€‚

Actor ç»„ä»¶èƒ½å¤Ÿä»¥ç±»ä¼¼äº Actor çš„æ–¹æ³•é€å¸§æ›´æ–°ï¼Œä½¿ç”¨ `TickComponent` å‡½æ•°å…è®¸ç»„ä»¶é€å¸§è¿è¡Œä»£ç ã€‚ä¾‹å¦‚ï¼ŒUSkeletalMeshComponent ä½¿ç”¨æ­¤å‡½æ•°æ¥æ›´æ–°åŠ¨ç”»å’Œéª¨æ¶æ§åˆ¶å™¨ï¼Œè€Œ UParticleSystemComponent æ›´æ–°å…¶å‘å°„å™¨å’Œå¤„ç†ç²’å­äº‹ä»¶ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼ŒActor ç»„ä»¶ä¸æ›´æ–°ï¼Œä¸ºäº†è®©Actorç»„ä»¶é€å¸§æ›´æ–°ï¼Œå¿…é¡»åœ¨æ„é€ å‡½æ•°ä¸­è®¾ç½® `PrimaryComponentTick.bCanEverTick = true` æ¥å¯ç”¨ tickã€‚ä¹‹åï¼Œåœ¨æ„é€ å‡½æ•°ä¸­æˆ–å…¶ä»–ä½ç½®å¤„ï¼Œå¿…é¡»è°ƒç”¨ `PrimaryComponentTick.SetTickFunctionEnable(true)` ä»¥å¼€å¯æ›´æ–°ï¼Œä¹‹åå¯è°ƒç”¨å¹¶ä¼ å…¥ false åœç”¨ tickã€‚å¦‚æœæ‰“ç®—æ‰‹åŠ¨è°ƒç”¨è‡ªå·±çš„æ›´æ–°å‡½æ•°ï¼ˆä¹Ÿè®¸ä»æ‹¥æœ‰çš„Actorç±»ï¼‰ï¼Œå°† PrimaryComponentTick.bCanEverTick ä¿ç•™ä¸ºé»˜è®¤å€¼ false å³å¯ï¼Œè¿™æ ·å¯ä»¥ç¨å¾®æ”¹å–„æ€§èƒ½ã€‚

ä¸ºè¿›è¡Œæ¸²æŸ“ç®¡ç†ï¼ŒActor ç»„ä»¶å¿…é¡»åˆ›å»ºæ¸²æŸ“çŠ¶æ€ï¼Œå®ƒä¼šå‘Šè¯‰å¼•æ“ï¼Œéœ€è¦æ›´æ–°æ¸²æŸ“æ•°æ®çš„ç»„ä»¶å·²å‘ç”Ÿå˜æ›´ã€‚å½“å‘ç”Ÿæ­¤ç±»å˜æ›´æ—¶ï¼Œæ¸²æŸ“çŠ¶æ€ä¼šè¢«æ ‡è®°ä¸º"dirty"ã€‚å¦‚æœç¼–è¯‘æ‚¨è‡ªå·±çš„ç»„ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ `MarkRenderStateDirty` å‡½æ•°å°†æ¸²æŸ“æ•°æ®æ ‡è®°ä¸º dirtyã€‚åœ¨ä¸€å¸§ç»“æŸæ—¶ï¼Œæ‰€æœ‰ dirty ç»„ä»¶çš„æ¸²æŸ“æ•°æ®éƒ½ä¼šåœ¨å¼•æ“ä¸­æ›´æ–°ã€‚åœºæ™¯ç»„ä»¶ï¼ŒåŒ…æ‹¬åŸºå…ƒç»„ä»¶é»˜è®¤ä¼šåˆ›å»ºæ¸²æŸ“çŠ¶æ€ï¼Œè€Œ Actor ç»„ä»¶åˆ™ä¸ä¼šã€‚

è¦ä¸å¼•æ“çš„ç‰©ç†æ¨¡æ‹Ÿç³»ç»Ÿäº¤äº’ï¼ŒActor ç»„ä»¶éœ€è¦ç‰©ç†çŠ¶æ€ã€‚ç‰©ç†çŠ¶æ€ä¼šåœ¨å‘ç”Ÿå˜åŒ–æ—¶ç«‹å³æ›´æ–°ï¼Œé˜²æ­¢å‡ºç°"å¸§è½å"ç‘•ç–µç­‰é—®é¢˜ï¼Œä¹Ÿä¸éœ€è¦"dirty"æ ‡è®°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒActor ç»„ä»¶å’Œåœºæ™¯ç»„ä»¶æ²¡æœ‰ç‰©ç†çŠ¶æ€ï¼Œä½†åŸºå…ƒç»„ä»¶æœ‰ã€‚è¦†ç›– `ShouldCreatePhysicsState` å‡½æ•°ä»¥ç¡®å®šç»„ä»¶ç±»å®ä¾‹æ˜¯å¦éœ€è¦ç‰©ç†çŠ¶æ€ã€‚

å¦‚æœç±»ä½¿ç”¨ç‰©ç†ï¼Œä¸å»ºè®®åªè¿”å› trueï¼Œè¯·å‚é˜… UPrimitiveComponent::ShouldCreatePhysicsState() çš„å®ç°ï¼Œä¸»è¦æ˜¯äº†è§£ä¸åº”åˆ›å»ºç‰©ç†çŠ¶æ€çš„æƒ…å†µï¼ˆä¾‹å¦‚åœ¨ç»„ä»¶ç ´åæœŸé—´ï¼‰ã€‚åœ¨æ­£å¸¸è¿”å› true çš„æƒ…å†µä¸‹ï¼Œè¿˜å¯ä»¥è¿”å› Super::ShouldCreatePhysicsStateã€‚


## âš¡ FObjectInitializer å¯¹è±¡åˆå§‹åŒ–æœºåˆ¶
- UE4 FObjectInitializer https://zhuanlan.zhihu.com/p/423567885
- Archetypes Technical Guide https://docs.unrealengine.com/udk/Three/ArchetypesTechnicalGuide.html
- https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ProgrammingWithCPP/UnrealArchitecture/Objects/Creation/

å…ˆäº†è§£ä¸€ä¸ªå¼•æ“å†…éƒ¨ä½¿ç”¨çš„å±‚æ¬¡æ¦‚å¿µï¼Œå½“ä½ åœ¨ç¼–è¾‘å™¨ä¸­å°†ä¸€ä¸ª Actor ä»å†…å®¹æµè§ˆå™¨æ‹–æ”¾åˆ°åœºæ™¯ä¸­æ—¶ï¼Œè¿™ä¸ªè¿‡ç¨‹æ¶‰åŠçš„å¯¹è±¡å±‚æ¬¡å…³ç³»å¦‚ä¸‹ï¼š

- ä½ çœ¼å‰çš„åœ°å›¾æœ€å¤–å±‚å³ Outermost æ˜¯ä¸€ä¸ª Packageï¼›
- è€Œ Package é‡Œé¢åŒ…å« Worldï¼›
- World é‡Œé¢åŒ…å« Levelï¼Œå½“ç„¶ï¼Œè¿™ä¸ª World ä¸èƒ½é€šè¿‡ *GetOuter()* è·å–åˆ°ï¼›
- Level é‡Œé¢åŒ…å«å„ç§ Actorsï¼›
- Component é€šå¸¸å°† Actor ä½œä¸ºå¤–éƒ¨å¯¹è±¡(Outer)ã€‚

æ‰€æœ‰å¯¹è±¡éƒ½å¯ä»¥è®¾ç½®ä¸€ä¸ªåç§°ï¼Œä½¿ç”¨ä¸“ç”¨çš„ *FName* æ•°æ®ç±»å‹ã€‚å¯¹å¼€å‘è€…æ¥è¯´ï¼Œ*UObject* å°±æ˜¯æ‰€æœ‰ UE4 å¯¹è±¡çš„åŸºç±»ï¼Œè€Œåœ¨å†…éƒ¨ï¼Œå®ƒåŸºäºå¦å¤–ä¸¤ä¸ªåº•å±‚çš„åŸºç±»ï¼Œ*UObjectBaseUtility* -> *UObjectBase*ã€‚

å¦å¤–ï¼Œ*UObject*è¿˜æ‹¥æœ‰*OuterPrivate*ã€*ClassPrivate*ç­‰å±æ€§ï¼Œå®ƒä»¬æ ‡è®°äº† Outer å¯¹è±¡ï¼š

```C++
private:

/** Flags used to track and report various object states. This needs to be 8 byte aligned on 32-bit
    platforms to reduce memory waste */
EObjectFlags                    ObjectFlags;

/** Index into GObjectArray...very private. */
int32                           InternalIndex;

/** Class the object belongs to. */
UClass*                         ClassPrivate;

/** Name of this object */
FName                           NamePrivate;

/** Object this object resides in. */
UObject*                        OuterPrivate;
```

åœ¨ *UObjectBase* æ„é€ å‡½æ•°ä¸­ï¼Œä¼šè°ƒç”¨ AddObject å‡½æ•°æŠŠè‡ªå·±åŠ åˆ°ä¸¤ä¸ªå…¨å±€çš„å¤§å®¹å™¨å†…ç®¡ç†ï¼Œåœ¨é”€æ¯çš„æ—¶å€™æŠŠè‡ªå·±ä»ç®¡ç†è‡ªå·±çš„å®¹å™¨ä¸­ç§»é™¤ï¼š

- UObjectArray è™šå¹»å¯¹è±¡ç®¡ç†æ•°ç»„ï¼Œæ¯ä¸ªåº”ç”¨ä¸­çš„ UObject å®ä¾‹æ•°é‡çº§å¾ˆå¤§ï¼Œä¸€èˆ¬æ¸¸æˆéƒ½ä¼šæœ‰å‡ åä¸‡ä¸ªï¼ŒUObjectArray ä¸ºäº†ä¿è¯èƒ½å­˜ä¸‹è¿™ä¹ˆå¤š UObject å°±åˆ’åˆ†äº† Chunkã€‚
- UObjectHash åŸºäºå“ˆå¸Œæ•£åˆ—ç»“æ„å®ç°å¿«é€Ÿæ’å…¥/å¿«é€ŸæŸ¥æ‰¾çš„æ•°æ®ç»“æ„ã€‚

åœ¨å¼•æ“ä»£ç çš„ç»„ç»‡ä¸­ï¼ŒOuter è¿™ä¸€è¯å°±ç†è§£ä¸ºå±‚æ¬¡å…³ç³»ä¸­çš„çˆ¶çº§ï¼Œå¯ä»¥ç†è§£ä¸ºçˆ¶å¯¹è±¡ï¼Œç§°ä¹‹ä¸ºå¤–éƒ¨å¯¹è±¡ã€‚ä½¿ç”¨*UObjectBaseUtility*æä¾›çš„æ–¹æ³•*GetOutermost()*æ¥è·å–å®ƒçš„æœ€é¡¶å±‚å¯¹è±¡ã€‚æˆ–è€…ä½¿ç”¨ *UObjectBase* æä¾›çš„ *GetOuter()* è·å–ä¸Šä¸€çº§å¯¹è±¡ã€‚

Outer è¿™ä¸€æ¦‚å¿µè¡¨æ˜å®ƒå¯¹å­å¯¹è±¡çš„æ‹¥æœ‰æƒï¼Œè€Œå¹¶ä¸æ˜¯æŒ‡ç¼–ç¨‹è¯­è¨€ä¸­çš„ç»§æ‰¿å…³ç³»ï¼Œå®ƒè¢«ç”¨æ¥æ§åˆ¶å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨åƒåœ¾æ”¶é›†èµ·åˆ°å‚è€ƒä½œç”¨ï¼Œå› ä¸ºè¢«å¼•ç”¨å¯¹è±¡çš„ä»»ä½•å¤–éƒ¨ä¹Ÿå¿…é¡»ç•™åœ¨å†…å­˜ä¸­ã€‚å½“çˆ¶å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç»“æŸæ—¶ï¼Œå®ƒæ‹¥æœ‰çš„å­å¯¹è±¡ä¹Ÿåº”è¯¥ç»“æŸã€‚å°±åƒäººçš„ç»†èƒä¾èµ–äºäººè€Œå­˜åœ¨ä¸€æ ·ï¼Œäººä¸€æ—¦æ­»äº¡ï¼Œç»†èƒä¹Ÿä¼šå…¨éƒ¨æ­»äº¡ã€‚

å¯¹è±¡å¯ä»¥å­˜åœ¨å¤šå±‚çº§çš„ç®¡ç†ä¸­ï¼Œæ‰€ä»¥å¯ä»¥æœ‰å¤šä¸ª Outerï¼Œä½†æ˜¯æœ€å¤–å±‚å¯¹è±¡ OuterMost éƒ½ä¸€å®šæ˜¯ä¸€ä¸ª UPackageã€‚å®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µï¼Œä½ å¯ä»¥å°†ä¸€ä¸ª*Package*ç†è§£ä¸ºä¸€ä¸ªèµ„äº§æ–‡ä»¶ï¼Œuasset æˆ– umap ç­‰ç­‰ï¼Œå®ƒåŒ…å«ä¸€äº›å¯ä»¥åœ¨ UE4 è¿›è¡Œæ“ä½œå’Œè®¿é—®çš„äºŒè¿›åˆ¶æ•°æ®æ–‡ä»¶ã€‚

å‡è®¾ç°åœ¨ä½ æœ‰ä¸€ä¸ªè“å›¾ç±»ï¼Œä½äºé¡¹ç›®å†…å®¹ç›®å½• */Content/blueprints/MyActor_BP.uasset*ï¼Œè¿™ä¸ªè“å›¾ç±»æœ¬èº« UClass çš„ Outer æ˜¯ä¸å®ƒåŒåçš„ã€‚
ä½¿ç”¨*UObjectBaseUtility*æä¾›çš„æ–¹æ³•è·å– Outermost å¯¹åº”çš„å°±æ˜¯ */Game/blueprints/MyActor_BP*ã€‚

æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š

```C++
UClass* Class = this->GetClass();
UObject* Outer = Class->GetOutermost();// GetOuter() from UObjectBase
FString OuterName = Outer->GetName();
GEngine->AddOnScreenDebugMessage(-1, 5.f, FColor::Green, OuterName);
```

åœ¨ Actor é‡Œæ„é€ å‡½æ•°ä¸­ï¼Œé€šå¸¸ä¼šé€šè¿‡è°ƒç”¨ *CreateDefaultSubobject* æ¥å®Œæˆç»„ä»¶å±‚æ¬¡çš„åˆ›å»ºï¼Œè¿™ä¸ªæ–¹æ³•å®šä¹‰åœ¨ UObject åŸºç±»ä¸Šã€‚åœ¨å†…éƒ¨ï¼Œ*UObjectGlobals*æä¾›äº†ä¸€ä¸ªä¼ ç”¨äº UObject åˆå§‹åŒ–çš„ç±»å‹ *FObjectInitializer*ï¼Œæ‰€æä¾›é‡è½½å‡½æ•°çš„æœ€ç®€å•å½¢å¼å°±æ˜¯ä¼ å…¥ä¸€ä¸ª *FName* å‚æ•°ï¼Œå¯¹å·²ç»æ‰§è¡Œè¿‡ C++ æ„é€ å™¨çš„å¯¹è±¡è¿›è¡Œä¸€æ¬¡å…¨é¢çš„ UObject å¯¹è±¡å±æ€§è®¾ç½®ã€‚

åœ¨ UObjectGlobals è¿˜æä¾›äº†å…¨å±€é‡è½½æ¨¡æ¿æ–¹æ³•*NewObject()*æ¥åˆ›å»ºå¯¹è±¡ï¼Œå®ƒæ˜¯æœ€ç®€å•çš„ UObject å·¥å‚æ–¹æ³•ã€‚æœ€åŸºæœ¬çš„å‚æ•°ä¸ºå¯¹åƒæ‰€åœ¨å±‚çº§çˆ¶å¯¹è±¡ *Outer* å’Œå¯¹è±¡åç§°ã€‚

```C++
// GObjTransientPkg = NewObject<UPackage>(nullptr, TEXT("/Engine/Transient"), RF_Transient);
MyObject* Obj = NewObject<MyObject>();// Outer = (UObject*)GetTransientPackage()
MyObject* Obj = NewObject<MyObject>(this, TEXT("MyName"));
MyObejct* obj = CreateDefaultSubobject<UMyObject>(TEXT("MyName"));
```

ä¸ç»™ NewObject æŒ‡å®š Outer å¯¹è±¡ï¼Œåˆ™ä½¿ç”¨*GetTransientPackage()*è·å–å½“å‰çš„ç¬æ€é¡¶çº§åŒ…å¯¹è±¡ä½œä¸º Outerï¼Œå³ *GObjTransientPkg* å…¨å±€å˜é‡å¼•ç”¨çš„å¯¹è±¡ï¼Œæ–¹æ³•å®ç°åœ¨ *Obj.cpp*ã€‚æ‰€è°“ç¬æ€å¯¹è±¡ï¼Œå°±æ˜¯å³é‚£äº›ä¸´æ—¶èµ·ä½œç”¨çš„ï¼Œä¸åº”è¯¥è¢«ä¿å­˜çš„å¯¹è±¡ã€‚å…³äºå¯¹è±¡å®ä¾‹çš„å„ç§çŠ¶æ€ï¼Œå‚è€ƒ ObjectMacros å®šä¹‰çš„*EObjectFlags*æšä¸¾ç±»å‹ã€‚å®ƒç®€æ˜åœ°æ ‡è®°äº†ä¸€ä¸ªå¯¹è±¡å®ä¾‹çš„ç±»å‹ã€åƒåœ¾å›æ”¶æœºåˆ¶çš„ç›¸å…³çŠ¶æ€ã€ç”Ÿå‘½å‘¨æœŸçŠ¶æ€ç­‰ä¿¡æ¯ã€‚

å®˜æ–¹ UE 4.27 æ–‡æ¡£æåˆ°äº† NewObject çš„ä¸‰ç§å½¢å¼ï¼Œé™¤äº†é»˜è®¤æ— å‚æ•°å½¢å¼å¤–ï¼Œå¦å¤–ä¸¤ç§æ˜¯ï¼š

- *NewNamedObject* é‡è½½å½¢å¼ï¼Œé€šè¿‡å…è®¸ä¸ºæ–°å®ä¾‹æŒ‡å®šä¸€ä¸ªåç§°ä»¥åŠå¯¹è±¡æ ‡è®°å’Œä¸€ä¸ªè¦æŒ‡å®šä¸ºå‚æ•°çš„æ¨¡æ¿å¯¹è±¡ã€‚
- *ConstructObject*å½¢å¼å¯ä»¥è·å¾—å®Œå…¨çš„çµæ´»æ€§æ¥åˆ›å»º UObject çš„æ–°å®ä¾‹ã€‚ç»“åˆ`FObjectInstancingGraph`ç»“æ„ä½“ï¼Œå®ƒåŒ…å«å®ä¾‹åŒ–å¯¹è±¡å’Œç»„ä»¶åˆ°å…¶æ¨¡æ¿çš„æ˜ å°„ï¼Œç”¨äºå®ä¾‹åŒ–æ–°å¯¹è±¡æ‰€æ‹¥æœ‰çš„ç»„ä»¶ã€‚

æ— è®ºå“ªç§æ–¹æ³•åˆ›å»ºè™šå¹»å¯¹è±¡ï¼Œè¿™ä¸ªè¿‡ç¨‹éƒ½ä¼šä½¿ç”¨åˆ°å†…éƒ¨çš„*StaticConstructObject_Internal*å…¨å±€å‡½æ•°ï¼Œå®ƒåˆ›å»ºä¸€ä¸ªå¯¹è±¡å¹¶å®Œæˆåˆå§‹åŒ–åè¿”å›ç»™ä¸Šå±‚ã€‚æ³¨æ„ï¼Œå¦‚æœä¼ å…¥å‚æ•°ï¼Œé€šè¿‡*FStaticConstructObjectParameters*ç»“æ„ä½“çš„*SetFlags*ä¼ å…¥çš„*InFlags*åŒ…å« *RF_NeedsLoad* è¡¨ç¤ºè¿™ä¸ªç»„ä»¶èµ„äº§éœ€è¦ä»ç£ç›˜ä¸­åŠ è½½ï¼Œå› æ­¤ä¼šè§¦å‘ *PostLoad()*ã€‚

å¯¹æ¯” *StaticConstructObject* å’Œ *StaticAllocateObject* å·®å¼‚ï¼Œå‰è€…å®ƒåˆ†é…å¯¹è±¡ï¼Œæ‰§è¡Œ*ClassConstructor*ï¼Œå¹¶æ‰§è¡Œä»»ä½•åˆå§‹åŒ–ï¼Œå¦‚åŠ è½½é…ç½®å±æ€§ï¼ŒåŠ è½½æœ¬åœ°åŒ–å±æ€§å’Œå®ä¾‹åŒ–ç»„ä»¶ã€‚

*StaticAllocateObject*çš„åŠŸèƒ½æ˜¯åˆ›å»ºä¸€ä¸ªå®ä¾‹æˆ–è€…æ›¿æ¢ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å®ä¾‹ã€‚å¦‚æœ Outer å’Œ Name éƒ½è¢«æŒ‡å®šï¼Œå¹¶ä¸”å†…å­˜ä¸­åŒæ ·å­˜åœ¨ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœå‚æ•° Classã€Outerã€Name å®Œå…¨ä¸€æ ·ï¼Œé‚£ä¹ˆè¿™ä¸ªå­˜åœ¨çš„å¯¹è±¡å°†ä¼šè¢«é”€æ¯ï¼Œæ–°å¯¹è±¡å°†ä¼šå ç”¨åŸæœ‰å¯¹è±¡çš„å†…å­˜ç©ºé—´.

å‰é¢æåˆ°çš„`FObjectInstancingGraph`å®šä¹‰åœ¨*UObject\Class.h*ï¼Œä»å®ƒçš„åå­—ä¸­çš„ Instancing å¯ä»¥äº†è§£åˆ°ï¼Œå®ƒæ˜¯åœ¨å¯¹è±¡å®ä¾‹åŒ–è¿‡ç¨‹ä¸­èµ·ä½œç”¨çš„ã€‚æ¯”å¦‚ï¼Œæ˜¯å¦å…è®¸å¯¹è±¡å®ä¾‹åŒ–ï¼Œç»™æ„é€ å™¨ä¼ å…¥*bDisableInstancing*å‚æ•°å°±å¯ä»¥æ§åˆ¶ã€‚

ä»¥ä¸‹æ‘˜å½•ä¸€æ®µè‡ªå«æ–‡æ¡£çš„æºä»£ç ï¼Œè¿™äº›æ•°æ®æˆå‘˜çš„ç”¨é€”å°±å¯ä»¥è¯´æ˜è¿™ä¸ªç»“æ„çš„ä½œç”¨ï¼š

```C++
/**
 * The root of the object tree that is the source used for instancing components;
 * - when placing an instance of an actor class, this would be the actor class default object
 * - when placing an instance of an archetype, this would be the archetype
 * - when creating an archetype, this would be the actor instance
 * - when duplicating an object, this would be the duplication source
 */
class       UObject*                        SourceRoot;

/**
 * The root of the object tree that is the destination used for instancing components
 * - when placing an instance of an actor class, this would be the placed actor
 * - when placing an instance of an archetype, this would be the placed actor
 * - when creating an archetype, this would be the actor archetype
 * - when updating an archetype, this would be the source archetype
 * - when duplicating an object, this would be the copied object (destination)
 */
class       UObject*                        DestinationRoot;

/**
 * Indicates whether we are currently instancing components for an archetype. 
 * true if we are creating or updating an archetype.
 */
bool                                        bCreatingArchetype;

/**
 * If false, components will not be instanced.
 */
bool                                        bEnableSubobjectInstancing;

/**
 * true when loading object data from disk.
 */
bool                                        bLoadingObject;

/**
 * Maps the source (think archetype) to the destination (think instance)
 */
TMap<class UObject*,class UObject*>         SourceToDestinationMap;

/**
* Maps instanced objects that need to have references updated
*/
TMap<UObject*, UObject*> ReplaceMap;
```

è¿™é‡Œè¿˜æœ‰ä¸€ä¸ª Archetype çš„æ¦‚å¿µï¼Œè¿™æ˜¯ä» UE3 ç³»ç»Ÿä¸­é—ç•™çš„äº§ç‰©ï¼Œæ–°å¼•æ“ä¸­å·²ç»ä¸å†ä½¿ç”¨ï¼Œå°±åƒ UnrealScript è¢« Blueprint æ›¿æ¢æ‰äº†ä¸€æ ·ã€‚ç®€å•æ¥è¯´ï¼ŒArchetypes å°±æ˜¯å…è®¸å†…å®¹å¼€å‘è€…å¯¹ç°æœ‰å¯¹è±¡è¿›è¡Œå¿«ç…§ä¿å­˜çš„æŠ€æœ¯ï¼ŒåŒ…æ‹¬å¯¹è±¡çš„å±æ€§å€¼ã€ç»„ä»¶ã€å¯¹è±¡å¼•ç”¨ç­‰ç­‰ã€‚å¿«ç…§å¯ä»¥å½“ä½œå†…å®¹æ¨¡æ¿ï¼Œä¾› Unrealscript ä½¿ç”¨ã€‚

Archetypes å°±åƒæ™®é€šçš„èµ„äº§åŒ…æ–‡ä»¶ä¸€æ ·å­˜å‚¨ï¼Œå¹¶ä¸”å…è®¸å†…å®¹å¼€å‘è€…åœ¨åœ°å›¾ä¸Šæ”¾ç½®åŸºäº Archetypes çš„å®ä¾‹ï¼Œè€Œæ— éœ€ä»»ä½•ç¨‹åºå‘˜ã€‚åŸºäºåŸå‹çš„å¯¹è±¡ä»ç„¶å…è®¸å†…å®¹å¼€å‘äººå‘˜å¼•ç”¨å…¶ä»–å†…å®¹å’Œå±æ€§ï¼Œä½†è¿™äº›å†…å®¹å’Œå±æ€§ä¸å¯æ”¾ç½®åœ¨è™šæ‹Ÿç¼–è¾‘å™¨ä¸­ã€‚

æºä»£ç å‚è€ƒï¼š

- UE_5.0EA\Engine\Source\Runtime\CoreUObject\Public\UObject\Object.h
- UE_5.0EA\Engine\Source\Runtime\CoreUObject\Private\UObject\Obj.cpp
- UE_5.0EA\Engine\Source\Runtime\CoreUObject\Public\UObject\Class.h
- UE_5.0EA\Engine\Source\Runtime\CoreUObject\Private\UObject\CoreNative.cpp
- UE_5.0EA\Engine\Source\Runtime\CoreUObject\Public\UObject\ObjectMacros.h
- UE_5.0EA\Engine\Source\Runtime\CoreUObject\Public\UObject\UObjectGlobals.h
- UE_5.0EA\Engine\Source\Runtime\CoreUObject\Private\UObject\UObjectGlobals.cpp
- UE_5.0EA\Engine\Source\Runtime\CoreUObject\Public\UObject\UObjectBaseUtility.h

ä»¥ä¸‹æ˜¯ UE5EA æºä»£ç ä¸­çš„ `UObject` å¯¹è±¡æ„é€ å™¨çš„é‡è½½å½¢å¼å‚è€ƒï¼š

```C++
/** Default constructor */
UObject();

/** Deprecated constructor, ObjectInitializer is no longer needed but is supported for older classes. */
UObject(const FObjectInitializer& ObjectInitializer);

/** DO NOT USE. This constructor is for internal usage only for statically-created objects. */
UObject(EStaticConstructor, EObjectFlags InFlags);

/** DO NOT USE. This constructor is for internal usage only for hot-reload purposes. */
UObject(FVTableHelper& Helper);
```

é™¤äº†åé¢ä¸¤ä¸ªä¸èƒ½ä½¿ç”¨ï¼Œå‰é¢ä¸¤ä¸ªæ„é€ å½¢å¼ä¸­æœ€å¸¸ç”¨çš„æ˜¯é»˜è®¤æ„é€ å™¨ï¼Œå³æ— å‚æ•°çš„é‚£ä¸ªã€‚

è€Œå¸¦`FObjectInitializer`å‚æ•°çš„é‚£ä¸ªä½œç”¨å¾ˆå¤§ï¼Œå®ƒå¯ä»¥æ”¹å†™åŸæœ‰çš„å¯¹è±¡åˆå§‹åŒ–é€»è¾‘ã€‚æ¯”å¦‚ç»™æŸäº› Actor æ›¿æ¢æŸä¸ªç»„ä»¶ã€‚å¦‚æœæ˜¯ç»Ÿä¸€è£…ä¸Šä¸€ä¸ªæ–°ç»„ä»¶è¿˜å¥½è¯´ï¼Œä½†æ˜¯å¦‚æœæ˜¯ç»Ÿä¸€æ›¿æ¢æ‰æŸä¸ªç»„ä»¶ï¼Œæ¯”å¦‚ç»Ÿä¸€æ›¿æ¢æ‰ Character çš„ç§»åŠ¨ç»„ä»¶ã€‚

é¦–å…ˆæˆ‘ä»¬å…ˆå£°æ˜ä¸€ä¸ª *MyCharacter*ï¼Œæ´¾ç”Ÿè‡ª *ACharacter*ï¼Œå¹¶ä½¿ç”¨åˆå§‹åŒ–å™¨*SetDefaultSubobjectClass*æ¥ä¿®æ”¹åŸæœ‰å­å¯¹è±¡è®¾ç½®é€»è¾‘ï¼š

```C++,
// AMyCharacter.h
#include "CoreMinimal.h"
#include "GameFramework/Character.h"
#include "MyCharacter.generated.h"

UCLASS()
class CPPLEARNING_API AMyCharacter : public ACharacter
{
    GENERATED_BODY()

public:
    // Sets default values for this character's properties
    AMyCharacter();
    AMyCharacter(const FObjectInitializer& ObjInitializer);
    //å…¶å®ƒé»˜è®¤ä»£ç ç•¥ã€‚
};


// MyCharacter.cpp
#include "AMyCharacter.h"

AMyCharacter::AMyCharacter(const FObjectInitializer& ObjInitializer)
    :Super(ObjInitializer.SetDefaultSubobjectClass<UMyMovementComponent>(TEXT("CharMoveComp")))
{
    // åªç»™ç§»åŠ¨ç»„ä»¶çš„ä¼ å…¥åå­—ï¼Œåç»­é€šè¿‡ GetName() è·å–ç»„ä»¶åå­—ã€‚
}

// UMyMovementComponent.h
#include "CoreMinimal.h"
#include "GameFramework/CharacterMovementComponent.h"
#include "MyMovementComponent.generated.h"

UCLASS()
class CPPLEARNING_API UMyMovementComponent : public UCharacterMovementComponent
{
    GENERATED_BODY()
        UMyMovementComponent();
protected:
    // Called when the game starts or when spawned
    virtual void BeginPlay() override;
};

// UMyMovementComponent.cpp
UMyMovementComponent::UMyMovementComponent()
{
    // ä½¿ç”¨æ‰“å°è¯­å¥éªŒè¯æ›¿æ¢æ˜¯å¦æˆåŠŸï¼š
    UE_LOG(LogTemp, Warning, TEXT("UMyMovementComponent Constructing..."));
}

void UMyMovementComponent::BeginPlay()
{
    Super::BeginPlay(); // ç»™çˆ¶ç±»æ‰§è¡Œ BeingPlay äº‹ä»¶çš„æœºä¼šã€‚
    FString Name = this->GetName();
    UE_LOG(LogTemp, Warning, TEXT("UMyMovementComponent BeginPlay..."));
    GEngine->AddOnScreenDebugMessage(-1, 5.f, FColor::Yellow, Name);
}
```



## âš¡ UObjectBase åº•å±‚ç»“æ„
- UObject https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ProgrammingWithCPP/UnrealArchitecture/Objects/
- UObject å¤„ç†ç³»ç»Ÿ https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ProgrammingWithCPP/UnrealArchitecture/Objects/Optimizations/
- Unreal Property System (Reflection) https://www.unrealengine.com/en-US/blog/unreal-property-system-reflection

è™šå¹»å¼•æ“æ‹¥æœ‰å¤„ç†æ¸¸æˆå¯¹è±¡çš„å¼ºå¤§ç³»ç»Ÿã€‚è™šå¹»å¼•æ“ä¸­çš„å¯¹è±¡åŸºç¡€ç±»ä¸º *UObject*ã€‚ `UCLASS` å®å¯ç”¨äºæ ‡è®°ä» UObject æ´¾ç”Ÿçš„ç±»ï¼Œä½¿ UObject å¤„ç†ç³»ç»Ÿè¯†åˆ«åˆ°å®ƒä»¬ã€‚

ä½¿ç”¨é€‚å½“çš„å®æ ‡è®°ç±»ã€å±æ€§å’Œå‡½æ•°å¯ä»¥å°†å®ƒä»¬è½¬å˜ä¸º`UClasses`ã€`UProperties`å’Œ`UFunctions`ã€‚è¿™è®©è™šå¹»å¼•æ“èƒ½å¤Ÿè®¿é—®å®ƒä»¬ï¼Œä»è€Œå…è®¸å®ç°ä¸€äº›åå°å¤„ç†åŠŸèƒ½ã€‚ä¸ºå®ç° UObject æ´¾ç”Ÿç±»å‹æ‰€æä¾›çš„åŠŸèƒ½ï¼Œå¼•æ“éœ€è¦åœ¨å¤´æ–‡ä»¶ä¸Šä¸ºè¿™äº›ç±»å‹æ‰§è¡Œä¸€ä¸ªé¢„å¤„ç†æ­¥éª¤ï¼Œä»¥æ ¸å¯¹éœ€è¦çš„ä¿¡æ¯ã€‚è¯¥é¢„å¤„ç†æ­¥éª¤ç”± UnrealHeaderToolï¼ˆç®€ç§° UHTï¼‰æ‰§è¡Œã€‚

```C++,
#pragma once

#include 'Object.h'
#include 'MyObject.generated.h'

/**
 * æ³¨æ„æ­¤å¤„çš„æ³¨è§£æ ¼å¼ï¼Œå†…å®¹ä¼šä½œä¸ºç¼–è¾‘å™¨çš„ tooltip æç¤ºä¿¡æ¯å±•ç¤ºã€‚
 */
UCLASS()
class MYPROJECT_API UMyObject : public UObject
{
    GENERATED_BODY()
};
```

`UCLASS` å®ä¸º UObject æä¾›ä¸€ä¸ªå¯¹ UCLASS çš„å¼•ç”¨ï¼Œæè¿°å…¶åŸºäºè™šå¹»å¼•æ“çš„ç±»å‹ã€‚ æ¯ä¸ª UCLASS ä¿ç•™ä¸€ä¸ªç§°ä½œ Class Default Object çš„å¯¹è±¡ï¼Œç®€ç§° CDOï¼Œæœ¬è´¨ä¸Šå®ƒæ˜¯ä¸€ä¸ªé»˜è®¤æ¨¡æ¿å¯¹è±¡ï¼Œç”±ç±»æ„å»ºå‡½æ•°ç”Ÿæˆï¼Œä¹‹åå¹¶æœªè¿›è¡Œä¿®æ”¹ã€‚ UCLASS å’Œ CDO å‡å¯ä¸ºç‰¹å®šå¯¹è±¡å®ä¾‹æ¢å¤ï¼Œä½†å®ƒä»¬é€šå¸¸ä¸ºåªè¯»ã€‚ä½¿ç”¨ *GetClass()* å‡½æ•°å³å¯éšæ—¶è®¿é—®å¯¹è±¡å®ä¾‹çš„ UCLASSã€‚

UCLASS åŒ…å«å®šä¹‰ç±»çš„ä¸€å¥—å±æ€§å’Œå‡½æ•°ï¼Œæ˜¯æœ¬åœ°ä»£ç å¯ç”¨çš„æ™®é€š C++ å‡½æ•°å’Œå˜é‡ï¼Œä½†è¢«è™šå¹»å¼•æ“ç‰¹æœ‰çš„å…ƒæ•°æ®æ‰€æ ‡è®°ï¼Œå®ƒä»¬åœ¨å¯¹è±¡ç³»ç»Ÿä¸­çš„è¡Œä¸ºä¹Ÿå› æ­¤å—åˆ°æ§åˆ¶ã€‚

æ³¨æ„ï¼šUObject ç±»è¿˜å¯åŒ…æ‹¬ä»…é™æœ¬åœ°çš„å±æ€§ï¼Œè¿™äº›å±æ€§ä¸å­˜åœ¨äºç›¸åº”çš„ UCLASS ä¸­ã€‚

æœ‰å¤šä¸ªå‡½æ•°å¯ç”¨äºæ–°å»º *UObject* å®ä¾‹ï¼š

- `NewObject<class>` ä½¿ç”¨æ‰€æœ‰å¯ç”¨åˆ›å»ºé€‰é¡¹çš„å¯é€‰å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹ï¼Œæä¾›æé«˜çš„çµæ´»æ€§ï¼ŒåŒ…æ‹¬å¸¦è‡ªåŠ¨ç”Ÿæˆå‘½åçš„ç®€å•ä½¿ç”¨æ¡ˆä¾‹ã€‚
- `new` ä½¿ç”¨ C++ çš„å…³é”®å­—åˆ›å»ºæ–°å®ä¾‹ï¼Œç”¨äºåœ¨ç‰¹å®šä½å±‚æƒ…å†µä¸‹æ„å»ºå¯¹è±¡ï¼Œå¦‚æ„å»ºå‡½æ•°éœ€è¦å‚æ•°æ—¶ã€‚

```C++,
    Public function T *  NewObject ( UObject* Outer )
    Public function T *  NewObject ( UObject* Outer, FName Name, EObjectFlags Flags, UObject* Template, 
                                     bool bCopyTransientsFromClassDefaul..., FObjectInstancingGraph* InInst... )

    // Convenience template for constructing a gameplay object
    Public function T *  NewObject ( UObject* Outer, const UClass* Class, FName Name, EObjectFlags Flags,
                                     UObject* Template, bool bCopyTransientsFromClassDefaul...,
                                     FObjectInstancingGraph* InInst..., UPackage* ExternalPackage )
```

UObject å¤„ç†ç³»ç»Ÿçš„å·¥ä½œå†…å®¹éå¸¸å¤šï¼Œè€Œä¸”å¤æ‚ï¼š

- Automatic Property Initialization è‡ªåŠ¨å±æ€§åˆå§‹åŒ–ã€‚

    åœ¨è°ƒç”¨æ„é€ å‡½æ•°ä¹‹å‰ï¼Œ`UObject`åœ¨åˆå§‹åŒ–æ—¶å¯¹æ•´ä¸ªç±»è‡ªåŠ¨æ‰§è¡Œå½’é›¶ï¼Œ`UProperties`å’Œ C++ åŸç”Ÿæˆå‘˜ç±»ä¼¼ï¼Œæˆå‘˜éšåå¯ä»¥ä½¿ç”¨ç±»æ„é€ å‡½æ•°ä¸­çš„è‡ªå®šä¹‰å€¼è¿›è¡Œåˆå§‹åŒ–ã€‚

- Automatic Updating of References è‡ªåŠ¨æ›´æ–°å¼•ç”¨ã€‚

    `AActor`æˆ–`UActorComponent`è¢«é”€æ¯æˆ–è€…ä»è¿è¡Œä¸­åˆ é™¤æ—¶ï¼Œåå°„ç³»ç»Ÿä¸­å¯è§çš„æ‰€æœ‰å¯¹å®ƒçš„å¼•ç”¨éƒ½å°†è‡ªåŠ¨æ¸…ç©ºï¼ŒåŒ…æ‹¬`UProperty`æŒ‡é’ˆå’Œè™šå¹»å¼•æ“å®¹å™¨ç±»ä¸­å­˜å‚¨çš„æŒ‡é’ˆï¼Œå¦‚`TArray`ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯é˜²æ­¢æ‚¬æŒ‚æŒ‡é’ˆæŒä¹…å­˜åœ¨å¹¶å¯¼è‡´åç»­é—®é¢˜ï¼Œä½†ä¹Ÿæ„å‘³ç€å¦‚æœå…¶ä»–æŸæ®µä»£ç å°†`AActor`å’Œ`UActorComponent`é”€æ¯ï¼Œè¿™äº›æŒ‡é’ˆä¹Ÿä¼šå˜ä¸ºç©ºã€‚æœ€ç»ˆçš„å¥½å¤„æ˜¯ç©ºæ£€æŸ¥æ›´å¯é ï¼Œå› ä¸ºä¼šæ£€æµ‹æ ‡å‡†æƒ…å†µç©ºæŒ‡é’ˆå’Œéç©ºæŒ‡é’ˆæŒ‡å‘åˆ é™¤å†…å­˜çš„æƒ…å†µã€‚

    å¿…é¡»ç†è§£çš„æ˜¯ï¼Œè¿™ç§åŠŸèƒ½ä»…é€‚ç”¨äºæ ‡è®°äº†`UPROPERTY`æˆ–å­˜å‚¨åœ¨è™šå¹»å¼•æ“å®¹å™¨ç±»ä¸­çš„`UActorComponent`æˆ–`AActor`å¼•ç”¨ã€‚å­˜å‚¨åœ¨åŸå§‹æŒ‡é’ˆä¸­çš„ Object å¼•ç”¨å¯¹äºè™šå¹»å¼•æ“å°†ä¸ºæœªçŸ¥ï¼Œå¹¶ä¸”ä¸ä¼šè‡ªåŠ¨æ¸…ç©ºï¼Œä¹Ÿä¸ä¼šå¦¨ç¢åƒåœ¾å›æ”¶ã€‚è¯·æ³¨æ„ï¼Œè¿™ä¸æ„å‘³ç€æ‰€æœ‰`UObject*`æŒ‡é’ˆå˜é‡éƒ½å¿…é¡»æ˜¯`UProperties`ã€‚å¦‚æœä½ éœ€è¦çš„ Object æŒ‡é’ˆä¸æ˜¯`UProperty`ï¼Œè¯·è€ƒè™‘ä½¿ç”¨`TWeakObjectPtr`ã€‚è¿™æ˜¯å¼±å¼•ç”¨æŒ‡é’ˆï¼Œæ„å‘³ç€ä¸ä¼šå¦¨ç¢åƒåœ¾å›æ”¶ï¼Œä½†å¯ä»¥æŸ¥è¯¢æœ‰æ•ˆæ€§ï¼Œç„¶åå†æ¥å—è®¿é—®ï¼Œå¹¶ä¸”å®ƒæ‰€æŒ‡å‘çš„ Object è¦è¢«é”€æ¯æ—¶ï¼Œå®ƒå°†è¢«è®¾ç½®ä¸ºç©ºã€‚

    å¦ä¸€ç§è‡ªåŠ¨æ¸…ç©ºè¢«å¼•ç”¨çš„ UObject UProperty çš„æƒ…å†µæ˜¯åœ¨ç¼–è¾‘å™¨ä¸­å¯¹èµ„æºä½¿ç”¨å¼ºåˆ¶åˆ é™¤ Force Delete æ“ä½œã€‚å› æ­¤ï¼Œä½œç”¨äºå±äºèµ„æºçš„ UObject çš„æ‰€æœ‰ä»£ç éƒ½å¿…é¡»å¤„ç†è¿™äº›å˜ä¸ºç©ºçš„æŒ‡é’ˆã€‚

- Serialization åºåˆ—åŒ–ã€‚

    å½“`UObject`è¢«åºåˆ—åŒ–æ—¶ï¼Œæ‰€æœ‰`UProperty`å€¼éƒ½å°†è¢«è‡ªåŠ¨å†™å…¥æˆ–è¯»å–ï¼Œé™¤éæ˜¾å¼æ ‡è®°ä¸º"ç¬æ—¶"æˆ–æ— æ³•ä»åæ„é€ å‡½æ•°é»˜è®¤å€¼è¿›è¡Œæ›´æ”¹ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥åœ¨å…³å¡ä¸­æ”¾å…¥`AEnemy`å®ä¾‹ï¼Œå°†å…¶"ä½“åŠ›ï¼ˆHealthï¼‰"è®¾ç½®ä¸º500ï¼Œä¿å­˜å¹¶æˆåŠŸåœ°é‡æ–°åŠ è½½ï¼Œè€Œä¸å¿…åœ¨`UClass`å®šä¹‰ä¹‹å¤–ç¼–å†™ä¸€è¡Œä»£ç ã€‚

    å½“æ·»åŠ æˆ–åˆ é™¤UPropertiesæ—¶ï¼Œç³»ç»Ÿä¼šæ— ç¼å¤„ç†åŠ è½½é¢„å…ˆå­˜åœ¨çš„å†…å®¹ã€‚æ–°å±æ€§ä»æ–°çš„CDOå¤åˆ¶é»˜è®¤å€¼ã€‚åˆ é™¤çš„å±æ€§å°†ä¼šè¢«é™é»˜å¿½ç•¥ã€‚

    å¦‚æœéœ€è¦è‡ªå®šä¹‰è¡Œä¸ºï¼Œåˆ™å¯ä»¥è¦†ç›–`UObject::Serialize`å‡½æ•°ã€‚è¿™å¯¹äºæ£€æµ‹æ•°æ®é”™è¯¯ï¼Œæ£€æŸ¥ç‰ˆæœ¬å·æˆ–æ‰§è¡Œè‡ªåŠ¨è½¬æ¢æˆ–æ›´æ–°ï¼ˆå¦‚æœæ•°æ®æ ¼å¼æœ‰æ‰€æ›´æ”¹ï¼‰ååˆ†æœ‰ç”¨ã€‚

- Updating of Property Values æ›´æ–°å±æ€§å€¼ã€‚

    å½“æ›´æ”¹`UClass`çš„ CDO å¯¹è±¡ï¼Œå¼•æ“å°†å°è¯•åœ¨åŠ è½½ç±»çš„æ‰€æœ‰å®ä¾‹æ—¶å¯¹è¿™äº›å®ä¾‹åº”ç”¨è¿™äº›æ›´æ”¹ã€‚å¯¹äºç»™å®š Object å®ä¾‹ï¼Œå¦‚æœæ›´æ–°çš„å˜é‡å€¼ä¸æ—§ CDO ä¸­çš„å€¼ç›¸åŒ¹é…ï¼Œåˆ™å°†æ›´æ–°ä¸ºå®ƒåœ¨æ–° CDO ä¸­ä¿å­˜çš„å€¼ã€‚å¦‚æœå˜é‡åŒ…å«ä»»ä½•å…¶ä»–å€¼ï¼Œç³»ç»Ÿä¼šå‡è®¾è¿™ä¸ªå€¼æ˜¯æ•…æ„è®¾ç½®çš„ï¼Œè¿™äº›æ›´æ”¹å°†ä¼šè¢«ä¿ç•™ã€‚
    
    ä¾‹å¦‚ï¼Œå‡è®¾ä½ åœ¨ä¸€ä¸ªå…³å¡ä¸­æ”¾ç½®äº†å¤šä¸ª AEnemy Object å¹¶ä¿å­˜ï¼Œç„¶åå°† AEnemy æ„é€ å‡½æ•°ä¸­çš„é»˜è®¤ Health å€¼è®¾ç½®ä¸º100ã€‚å†å‡è®¾å°† Enemy_3 çš„Health å€¼è®¾ç½®ä¸º 500ï¼Œå› ä¸ºå®ƒä»¬ç‰¹åˆ«éš¾å¯¹ä»˜ã€‚ç°åœ¨ï¼Œå‡è®¾ä½ æ”¹å˜æ³¨æ„äº†ï¼Œå°† Health çš„é»˜è®¤å€¼å¢åŠ åˆ° 150ã€‚ä¸‹æ¬¡åŠ è½½å…³å¡æ—¶ï¼Œè™šå¹»æ„è¯†åˆ°ä½ æ›´æ”¹äº† CDOï¼Œå°±ä¼šæ›´æ–°ä¸”åªæ›´æ‰€æœ‰ä½¿ç”¨æ—§ Health é»˜è®¤å€¼ï¼ˆ100ï¼‰çš„`AEnemy`å®ä¾‹ã€‚

- Editor Integration å’Œè™šå¹»ç¼–è¾‘å™¨é›†æˆã€‚

    ç¼–è¾‘å™¨ç†è§£`UObject`å’Œ`UProperties`ï¼Œç¼–è¾‘å™¨å¯ä»¥è‡ªåŠ¨å…¬å¼€è¿™äº›å€¼ä»¥ä¾›ç¼–è¾‘ï¼Œè€Œä¸å¿…ç¼–å†™ç‰¹æ®Šä»£ç ã€‚è¿™å¯ä»¥é€‰æ‹©åœ¨è“å›¾è§†è§‰è„šæœ¬ç³»ç»Ÿä¸­èå…¥é›†æˆã€‚æœ‰è®¸å¤šé€‰é¡¹å¯ä»¥æ§åˆ¶å˜é‡å’Œå‡½æ•°çš„å¯è®¿é—®æ€§å’Œå…¬å¼€ã€‚

- Run-Time Type Information and Casting è¿è¡Œæ—¶ç±»å‹ä¿¡æ¯ç³»ç»Ÿå’Œç±»å‹è½¬æ¢æ”¯æŒã€‚

    ç”±äº`UObject`æ˜¯è™šå¹»å¼•æ“åå°„ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œå®ƒä»¬å§‹ç»ˆçŸ¥é“å®ƒä»¬æ˜¯å“ªäº›`UClass`ï¼Œå¹¶å¯ä»¥åœ¨è¿è¡Œæ—¶åšå‡ºæœ‰å…³ç±»å‹çš„å†³å®šå’Œç±»å‹è½¬æ¢ã€‚

    åœ¨åŸç”Ÿä»£ç ä¸­ï¼Œæ¯ä¸ª`UObject`ç±»éƒ½å°†è‡ªå®šä¹‰`Super`ç±»å‹å®šä¹‰è®¾ç½®ä¸ºå…¶çˆ¶ç±»ï¼Œä»è€Œå¯ä»¥è½»æ¾æ§åˆ¶è¦†ç›–è¡Œä¸ºã€‚

- Garbage Collectionï¼Œè™šå¹»å®ç°åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œä¸å†è¢«å¼•ç”¨æˆ–å·²è¢«æ˜¾å¼æ ‡è®°ä¸ºé”€æ¯çš„`UObject`å°†å®šæœŸæ¸…é™¤ã€‚

    å¼•æ“æ„å»ºä¸€ä¸ªå¼•ç”¨å›¾è¡¨ä»¥ç¡®å®šå“ªäº›`UObject`ä»åœ¨ä½¿ç”¨ï¼Œå“ªäº›æ˜¯å­¤ç«‹é—å¼ƒçš„ã€‚è¯¥å›¾è¡¨æ ¹éƒ¨æ˜¯ä¸€ç»„æŒ‡å®šä¸º Root Set æ ¹é›†çš„ä¸€ç»„å¯¹è±¡ã€‚ä»»ä½•`UObject`éƒ½å¯ä»¥æ·»åŠ åˆ°æ ¹é›†ã€‚å½“è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œå¼•æ“å°†ä»æ ¹é›†å¼€å§‹ï¼Œæœç´¢å·²çŸ¥`UObject`å¼•ç”¨æ ‘æ¥è·Ÿè¸ªæ‰€æœ‰å¼•ç”¨çš„`UObject`ã€‚ä»»ä½•æœªè¢«å¼•ç”¨çš„`UObject`ï¼ˆæ„å‘³ç€æœªåœ¨æ ‘æœç´¢ä¸­æ‰¾åˆ°çš„å¯¹è±¡ï¼‰å°†è¢«å‡è®¾ä¸ºä¸å†éœ€è¦ï¼Œå› æ­¤è¢«åˆ é™¤ã€‚

    ä¸€ä¸ªå®é™…çš„å½±å“æ˜¯ï¼Œä½ é€šå¸¸éœ€è¦ä¿æŒå¯¹å¸Œæœ›ä¿æŒæ´»è·ƒçš„ä»»ä½• Object çš„`UPROPERTY`å¼•ç”¨ï¼Œæˆ–è€…å°†æŒ‡å‘å®ƒçš„æŒ‡é’ˆå­˜å‚¨åœ¨`TArray`æˆ–å…¶ä»–å¼•æ“å®¹å™¨ç±»ä¸­ã€‚Actor åŠå…¶ç»„ä»¶é€šå¸¸å±äºä¾‹å¤–æƒ…å†µï¼Œå› ä¸º Actor é€šå¸¸è¢«é“¾æ¥å›åˆ°æ ¹é›†çš„ Object å¼•ç”¨ï¼ˆä¾‹å¦‚å®ƒä»¬æ‰€å±çš„å…³å¡ï¼‰ï¼Œè€Œ Actor çš„ç»„ä»¶è¢« Actor è‡ªèº«å¼•ç”¨ã€‚Actor å¯ä»¥æ˜¾å¼æ ‡è®°ä¸ºé”€æ¯ï¼Œæ–¹æ³•æ˜¯è°ƒç”¨å®ƒä»¬çš„`Destroy`å‡½æ•°ï¼Œè¿™æ˜¯ä»è¿›è¡Œä¸­æ¸¸æˆç§»é™¤Actorçš„æ ‡å‡†æ–¹æ³•ã€‚ç»„ä»¶å¯ä»¥ä½¿ç”¨`DestroyComponent`å‡½æ•°æ˜¾å¼é”€æ¯ï¼Œä½†å®ƒä»¬é€šå¸¸åœ¨æ‹¥æœ‰å®ƒä»¬çš„ Actor ä»æ¸¸æˆä¸­ç§»é™¤æ—¶è¢«é”€æ¯ã€‚

    è™šå¹»å¼•æ“4ä¸­çš„åƒåœ¾å›æ”¶é€Ÿåº¦å¿«ï¼Œæ•ˆç‡é«˜ï¼Œå†…ç½®å¤§é‡çš„ä¼˜åŒ–åŠŸèƒ½ï¼Œèƒ½å¤Ÿå°½é‡é™ä½å¼€é”€ï¼Œå¦‚å¤šçº¿ç¨‹å¯è®¿é—®æ€§åˆ†æå¯ä»¥æ ‡è¯†å­¤ç«‹Objectï¼Œä¼˜åŒ–çš„ååŠ å¯†ä»£ç èƒ½å¤Ÿå°½å¿«ä»å®¹å™¨ä¸­ç§»é™¤Actorã€‚è¿˜æœ‰ä¸€äº›å…¶ä»–åŠŸèƒ½ä»¥è°ƒèŠ‚ï¼Œä»¥æ›´ç²¾å‡†åœ°æ§åˆ¶å¦‚ä½•ä»¥åŠä½•æ—¶æ‰§è¡Œåƒåœ¾å›æ”¶ï¼Œå¤§éƒ¨åˆ†éƒ½å¯ä»¥åœ¨ é¡¹ç›®è®¾ç½®ï¼ˆProject Settingsï¼‰ ä¸­çš„ å¼•æ“ - åƒåœ¾å›æ”¶ï¼ˆEngine - Garbage Collectionï¼‰ ä¸‹æ‰¾åˆ°ã€‚

- Network Replicationï¼Œ`UObject` ç³»ç»ŸåŒ…å«ä¸€ç»„å¯é çš„åŠŸèƒ½ï¼Œèƒ½å¤Ÿä¿ƒè¿›ç½‘ç»œé€šä¿¡å’Œå¤šäººæ¸¸æˆã€‚

    `UProperties`å¯ä»¥æ ‡è®°ä¸ºå‘Šè¯‰å¼•æ“åœ¨ç½‘ç»œæ¸¸æˆæœŸé—´å¤åˆ¶æ•°æ®ã€‚å¸¸è§æ¨¡å‹æ˜¯ä¸€ä¸ªå˜é‡åœ¨æœåŠ¡å™¨ä¸Šå‘ç”Ÿæ›´æ”¹ï¼Œå¼•æ“æ£€æµ‹åˆ°è¿™ä¸ªæ›´æ”¹ï¼Œå¹¶å°†å…¶å¯é åœ°å‘é€åˆ°æ‰€æœ‰å®¢æˆ·ç«¯ã€‚å½“å˜é‡é€šè¿‡å¤åˆ¶å‘ç”Ÿæ›´æ”¹æ—¶ï¼Œå®¢æˆ·ç«¯å¯ä»¥é€‰æ‹©æ€§æ¥æ”¶å›è°ƒå‡½æ•°ã€‚

    `UFunctions`ä¹Ÿå¯ä»¥æ ‡è®°ä¸ºåœ¨è¿œç¨‹æœºå™¨ä¸Šæ‰§è¡Œã€‚ä¾‹å¦‚ï¼Œ"server"å‡½æ•°åœ¨å®¢æˆ·ç«¯ä¸Šè°ƒç”¨æ—¶ï¼Œå°†ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œè¿™ä¸ªå‡½æ•°ä»¥è·å–æœåŠ¡å™¨ç‰ˆæœ¬çš„Actorã€‚è€Œå¦ä¸€æ–¹é¢ï¼Œ"client"å‡½æ•°å¯ä»¥ä»æœåŠ¡å™¨è°ƒç”¨ï¼Œå¹¶åœ¨æ‹¥æœ‰è¿™ä¸ªå‡½æ•°çš„å®¢æˆ·ç«¯ç‰ˆæœ¬çš„å¯¹åº”Actorä¸Šè¿è¡Œã€‚


ä»¥ä¸‹ç¤ºèŒƒ RIIT çš„ä½¿ç”¨ï¼š

```C++,
class AEnemy : public ACharacter
{
    virtual void Speak()
    {
        Say("Time to fight!");
    }
};

class AMegaBoss : public AEnemy
{
    virtual void Speak()
    {
        Say("Powering up!");
        Super::Speak();
    }
};
```

ä¸å‡ºæ„æ–™ï¼Œè°ƒç”¨`Speak`å°†ä¼šè®© MegaBoss è¯´"Powering up!Time to fight!"ã€‚

æ­¤å¤–ï¼Œä½ å¯ä»¥ä½¿ç”¨æ¨¡æ¿åŒ– `Cast` å‡½æ•°å®‰å…¨åœ°å°†å¯¹è±¡ä»åŸºç±»è½¬æ¢ä¸ºè¡ç”Ÿç±»ï¼Œæˆ–è€…`IsA`æŸ¥è¯¢çœ‹å¯¹è±¡æ˜¯ä¸æ˜¯ç‰¹å®šç±»ã€‚

```C++,
class ALegendaryWeapon : public AWeapon
{
    void SlayMegaBoss()
    {
        TArray<AEnemy> EnemyList = GetEnemyListFromSomewhere();

        // The legendary weapon is only effective against the MegaBoss
        for (AEnemy Enemy :EnemyList)
        {
            AMegaBoss* MegaBoss = Cast<AMegaBoss>(Enemy);
            if (MegaBoss)
            {
                Incinerate(MegaBoss);
            }
        }
    }
};
```

è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†`Cast`æ¥å°è¯•å°†`AEnemy`è½¬æ¢ä¸º`AMegaBoss`ã€‚å¦‚æœæ‰€æåŠ Object å®é™…ä¸Šä¸æ˜¯`AMegaBoss`æˆ–è€…å…¶å­ç±»ï¼Œåˆ™ Cast ä¼šè¿”å›ç©ºæŒ‡é’ˆï¼Œæˆ‘ä»¬å¯ä»¥é€‚å½“çš„åšå‡ºååº”ã€‚åœ¨ä»¥ä¸Šä»£ç ä¸­ï¼Œ`Incinerate`å°†ä»…å¯¹ MegaBoss è°ƒç”¨ã€‚





# ğŸŒŸ Assets & Packages
- èµ„äº§å’ŒåŒ… https://docs.unrealengine.com/4.27/zh-CN/Basics/AssetsAndPackages/
- å†…å®¹èµ„äº§ç±»å‹ https://docs.unrealengine.com/4.27/zh-CN/WorkingWithContent/Types/
- ç¼©å‡æ¸¸æˆåŒ…å®¹é‡ https://docs.unrealengine.com/4.27/zh-CN/TestingAndOptimization/PerformanceAndProfiling/ReducingPackageSize/
- çƒ˜ç„™å’Œæ•°æ®å—åˆ’åˆ† https://docs.unrealengine.com/4.27/zh-CN/SharingAndReleasing/Patching/GeneralPatching/CookingAndChunking/
- èµ„äº§ç®¡ç†-åŠ è½½ä¸å¸è½½ https://docs.unrealengine.com/4.27/zh-CN/ProductionPipelines/AssetManagement/
- èµ„æºå’ŒåŒ…çš„ç‰ˆæœ¬æ§åˆ¶ https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ProgrammingWithCPP/UnrealArchitecture/VersioningAssetsAndPackages/

èµ„äº§ Assets æ˜¯è™šå¹»å¼•æ“é¡¹ç›®ä¸­çš„ä¸€é¡¹å†…å®¹ï¼Œå¯å°†å…¶çœ‹ä½œåºåˆ—åŒ–åˆ°æ–‡ä»¶ä¸­çš„ `UObject`ã€‚åœ¨å†…å®¹æµè§ˆå™¨çš„ Sources Panel ä¸Šç‚¹å‡»å·¦ä¾§çš„ Show/Hide Sources and Collections æŒ‰é’®ï¼Œæ˜¾ç¤ºèµ„äº§ç›®å½•æ ‘ã€‚

èµ„äº§æ ‘ä»¥åˆ—è¡¨å½¢å¼æ˜¾ç¤ºå†…å®¹ç›®å½•ä¸­çš„æ–‡ä»¶å†…å®¹ï¼Œå†…å®¹ç›®å½•æ˜¯ .uasset æ–‡ä»¶æ‰€åœ¨çš„ä½ç½®ï¼Œå†…å®¹ç›®å½•**Content**æ˜¯å·¥ç¨‹ä¸“ç”¨ç›®å½•ï¼Œæ‰€æœ‰èµ„äº§æ–‡ä»¶éƒ½åœ¨è¿™ä¸ªç›®å½•ä¸‹ã€‚

æ¨èé€šè¿‡å†…å®¹æµè§ˆå™¨æ¥ç§»åŠ¨èµ„äº§ï¼Œè¿™æ˜¯å› ä¸ºå¯¹èµ„äº§çš„å¼•ç”¨åŒ…å«èµ„äº§çš„å®Œæ•´ç›®å½•è·¯å¾„ã€‚å¦‚æœç§»åŠ¨èµ„äº§ï¼Œå…¶è·¯å¾„å°†æ›´æ”¹ã€‚ ä½ å¯ä»¥åœ¨è™šå¹»ç¼–è¾‘å™¨å¤–ï¼Œåœ¨æ–‡ä»¶å¤¹é—´ç§»åŠ¨èµ„äº§æ–‡ä»¶ï¼Œä½†å¼•ç”¨å°†æ— æ³•ä¿æŒå®Œæ•´ã€‚

ç”¨æˆ·å¯åœ¨å¯¼å…¥æˆ–åˆ›å»ºèµ„äº§æ—¶å¯¹å…¶è¿›è¡Œå‘½åï¼Œèµ„äº§è·¯å¾„å°†ä¸å®ƒåœ¨ç£ç›˜ä¸Šçš„ä½ç½®ç›´æ¥å…³è”ï¼Œç”¨æˆ·åˆ›å»ºæˆ–å¯¼å…¥èµ„äº§æ—¶æŒ‡å®šçš„æ–‡ä»¶å¤¹å°†è‡ªåŠ¨è®¾ç½®æ­¤è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œè·¯å¾„ Content/Characters/MyCharacter å°†ä¿å­˜è‡³ /UE4/MyProject/Content/Characters/MyCharacter.MyCharacter.uassetã€‚

å¯åœ¨å†…å®¹æµè§ˆå™¨ä¸­å¯¹èµ„äº§è¿›è¡Œé‡å‘½åï¼Œé€‰ä¸­ç„¶åå·¦é”®å•å‡»å…¶åç§°æˆ–æŒ‰ F2 é”®ã€‚é€šè¿‡è¿™ç§æ–¹å¼é‡å‘½åæˆ–ç§»åŠ¨èµ„äº§ä¹‹åï¼Œå…¶ä»–èµ„äº§å¼•ç”¨ä¼šæ ¹æ®é‡å‘½åæˆ–ç§»åŠ¨æ“ä½œè¿›è¡Œç›¸åº”æ›´æ–°ï¼Œè€Œä¸”åœ¨åŸå§‹èµ„äº§æ‰€åœ¨ä½ç½®å°†ä¼šç•™ä¸‹ä¸å¯è§çš„é‡å®šå‘å™¨ã€‚å¯é€šè¿‡åœ¨å†…å®¹æµè§ˆå™¨ä¸­å³é”®å•å‡»å¹¶é€‰æ‹© Fix Up Redirectors in Folder æ¥æ¸…é™¤é‡å®šå‘å™¨ã€‚

è¯·æ³¨æ„ï¼Œä½ éœ€è¦é‡æ–°ä¿å­˜èµ„äº§ã€‚å¦å¤–ï¼Œå¦‚æœåˆ é™¤è¢«å¼•ç”¨çš„èµ„äº§ï¼Œå°†ä¼šæ˜¾ç¤ºè¯¢é—®åº”ä½¿ç”¨å“ªä¸ªç°æœ‰èµ„äº§ï¼ˆå¦‚æœ‰ï¼‰æ›¿ä»£åˆ é™¤çš„èµ„äº§çš„èœå•ã€‚

èµ„äº§é€šå¸¸ç”±è™šå¹»å¼•æ“è‡ªåŠ¨åŠ è½½æˆ–å¸è½½ã€‚ä½†æ˜¯ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç›´æ¥æ§åˆ¶è¯¥è¿‡ç¨‹å¯ä»¥æ˜¾è‘—æå‡æ€§èƒ½ï¼Œä¾‹å¦‚ï¼Œå¯ä»¥å‡å°‘ç”šè‡³æ¶ˆé™¤å†—ä½™åŠ è½½æ—¶é—´ï¼Œæ¶ˆé™¤æ¸¸æˆè¿›ç¨‹ä¸­çš„å¡é¡¿ã€‚æœ‰å…³ç®¡ç†èµ„äº§åŠ è½½å’Œå¸è½½çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…èµ„æºç®¡ç†é¡µé¢ã€‚éƒ¨ç½²é¡¹ç›®æ—¶ï¼Œèµ„äº§å°†è¢«è½¬åŒ–äºŒè¿›åˆ¶æ ¼å¼ï¼Œå¹¶å¯åˆ†åˆ°å¤šä¸ª .pak æ–‡ä»¶ä¸­ï¼Œä»¥ç”¨äºåˆ†å‘ã€‚

å½“å·¥ä½œæµåŒ…å«å¤šä¸ªåŒ…ï¼ˆpackageï¼‰æ–‡ä»¶ï¼Œä¸”æ¯ä¸ªåŒ…æ–‡ä»¶éƒ½åŒ…å«å¤šä¸ªèµ„äº§æ—¶ï¼Œå¯èƒ½ä¼šå‘ç”Ÿæºæ§åˆ¶å†²çªé—®é¢˜ã€‚ç„¶è€Œï¼Œå¦‚æœå·¥ä½œæµæ”¯æŒå¹¶é¼“åŠ±åˆ›å»ºå¤šä¸ªå•ç‹¬çš„èµ„äº§æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±å¯åˆ†åˆ«æ£€å‡ºæ¯ä¸ªèµ„äº§ã€‚è¿™å¯ä»¥å‡å°‘å·¥ä½œæµä¸­çš„æºæ§åˆ¶å†²çªå’Œç“¶é¢ˆï¼ŒåŒæ­¥å•ä¸ªèµ„äº§æ–‡ä»¶çš„æ—¶é—´ä¹Ÿè¦çŸ­äºåŒæ­¥åŒ…å«å¤šä¸ªèµ„äº§çš„åŒ…æ–‡ä»¶ã€‚

åœ¨è™šå¹»ç¼–è¾‘å™¨ä¸­ï¼Œèµ„äº§ä»¥ .uasset æ–‡ä»¶æ ¼å¼å­˜å‚¨ï¼Œé€šå¸¸ä»…åŒ…å«å•ä¸ªèµ„äº§ã€‚æ¯ä¸ªèµ„äº§å¼•ç”¨éƒ½åŒ…å«ç›®å½•å¼çš„è·¯å¾„ï¼Œæ¯ä¸ªè·¯å¾„éƒ½å¯å”¯ä¸€åœ°æ ‡è¯†æ¸¸æˆä¸­çš„ä»»ä½•èµ„äº§ã€‚

è®¸å¤šèµ„äº§æ˜¯æœ‰ä¾èµ–å…³ç³»çš„ï¼Œæ¯”å¦‚å®‰è£…å¯é€‰ç”¨æˆ·èµ„æºåŒ… StarterContentï¼Œå…¶ä¸­ Shapes ç›®å½•ä¸‹çš„ç¬¬ä¸‰ç§ StaticMesh å¯¹è±¡ä¾èµ–äº† Materials ç›®å½•ä¸‹çš„å„ç§æè´¨å¯¹è±¡ï¼Œè€Œæè´¨å¯¹è±¡åˆä¾èµ– Textures ç›®å½•ä¸‹çš„å„ç§çº¹ç†è´´å›¾æ–‡ä»¶ã€‚å¹¶ä¸”è¿™äº›è¢«ä¾èµ–çš„å¯¹è±¡ä½¿ç”¨çš„è·¯å¾„æ˜¯ä»¥ /Game/StarterContent/Shapes/Shape_Cube.Shape_Cube è¿™æ ·çš„è·¯å¾„ï¼Œå› æ­¤ç›´æ¥å¤åˆ¶ StarterContent ç›®å½•ä¸‹çš„æ–‡ä»¶åˆ°å…¶å®ƒç›®å½•ï¼Œå¦‚æœä¸æ˜¯é¡¹ç›®çš„ Content ç›®å½•ä¸‹ï¼Œå°±ä¼šå¯¼è‡´ä¾èµ–çš„èµ„æºä¸èƒ½æ­£ç¡®å®šä½ã€‚

å°†èµ„äº§å¤åˆ¶åˆ°å…¶ä»–é¡¹ç›®ï¼Œéœ€è¦ä½¿ç”¨å†…å®¹æµè§ˆå™¨ä¸­çš„è¿ç§»å·¥å…· Asset Actions -> Migrate Tool æ¥åˆ›å»ºèµ„äº§çš„å‰¯æœ¬ï¼ˆä»¥åŠå¤„ç†ä¾èµ–æ€§èµ„äº§ï¼‰ï¼Œä»¥åœ¨å…¶ä»–é¡¹ç›®ä¸­ä½¿ç”¨ã€‚

éœ€è¦æ³¨æ„ï¼Œä½¿ç”¨ Migrate Tool è¿ç§»èµ„äº§åï¼Œèµ„äº§æ–‡ä»¶ä¾èµ–çš„å…¶å®ƒèµ„äº§è·¯å¾„å¹¶ä¸ä¼šæ”¹å˜ï¼Œå®ƒåªæ˜¯æŒ‰åŸæœ‰èµ„äº§çš„ä¾èµ–å…³ç³»å¤åˆ¶ä¸€ä¸ªå‰¯æœ¬ã€‚æ‰€ä»¥ï¼Œå°†å·¥ç¨‹ Content ç›®å½•ä¸‹çš„èµ„äº§ï¼Œå¦‚ StarterContent è¿ç§»åˆ° Engine Content ç›®å½•ï¼Œè™½ç„¶è¿™æ ·æ¯ä¸ªé¡¹ç›®ä¸­éƒ½å¯ä»¥è®¿é—®ï¼Œèµ„æºä¹Ÿå¯ä»¥å•ç‹¬ä½¿ç”¨ã€‚ä½†æ˜¯ Engine Content ç›®å½•çš„èµ„äº§ä¸èƒ½æ­£ç¡®è¿ç§»å¤„ç†ï¼Œå…¶è·¯å¾„ä½¿ç”¨çš„æ˜¯ `/Engine`  å¼€å¤´æ›¿ä»£ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ `/Game` å¼€å¤´ï¼Œå®ƒä»¬å…·æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œè¿ç§»å·¥å…·ä¸ä¼šå»ä¿®æ”¹å®ƒã€‚æ‰€ä»¥ï¼Œä¸‹æ¬¡è¿ç§»å°±ä¸èƒ½æ­£ç¡®å¤„ç†ä¹‹å‰è¿ç§»åˆ° Engine Content ç›®å½•ä¸‹çš„èµ„äº§ä¾èµ–ã€‚

ä½¿ç”¨ API åŠ è½½èµ„äº§æ—¶ï¼Œæ‰©å±•åå¯ä»¥çœç•¥ã€‚ç‰¹åˆ«åœ°ï¼Œæ¯”å¦‚é€šè¿‡å†…å®¹æµè§ˆå™¨å¯ä»¥æŸ¥çœ‹åˆ° /Game/Engine Content/StarterContent/Shapes/Shape_Cube.Shape_Cube è¿™ä¸ªç«‹æ–¹ä½“æ¨¡å‹ï¼ŒåŠ è½½æ—¶ï¼Œä½¿ç”¨ `/Engine` è·¯å¾„å¼€å¤´æ›¿ä»£ /Game/Engine Contentã€‚å¦‚æœåŠ è½½å·¥ç¨‹ Content ç›®å½•ä¸‹çš„èµ„äº§ï¼Œå°±ä½¿ç”¨ `/Game` å¼€å¤´ã€‚

ä¹Ÿå°±æ˜¯è¯´ Migrate Tool åªèƒ½åšåŒç±»ç›®å½•çš„èµ„äº§è¿ç§»ï¼Œå¦‚å·¥ç¨‹ Content ç›®å½•çš„èµ„äº§äº’ç›¸è¿ç§»ï¼Œè€Œä¸èƒ½æ­£ç¡®åœ°å’Œ Engine Content ç›®å½•ä¸‹çš„èµ„äº§äº’ç›¸è¿ç§»ã€‚

ä½¿ç”¨å¼•ç”¨å…³ç³»æµè§ˆå™¨ Shift + Alt + Rï¼Œå¯ä»¥å¿«é€Ÿå®šä½åˆ°è¢«ä¾èµ–çš„æˆ–ä¾èµ–çš„å¯¹è±¡ï¼Œå¹¶ä¸”å¯ä»¥å°†ä¾èµ–å…³ç³»å¤åˆ¶ä¸‹æ¥ï¼š

    [/Game/SnowFoot/RenderTarget_BP - Dependencies]
      [HARD]
        /Game/SnowFoot/Mat_Depth.Mat_Depth
        /Game/SnowFoot/RenderTargetPersistent.RenderTargetPersistent
        /Game/SnowFoot/SnowMPC.SnowMPC
        /Game/SnowFoot/DrawToPersistent.DrawToPersistent
        /Game/SnowFoot/RenderTarget.RenderTarget
      [SOFT]
        /Game/SnowFoot/RenderTarget_BP.RenderTarget_BP

é¡¹ç›®è®¾ç½® Packaging æŒ‡å®šçƒ˜ç„™æ—¶æ’é™¤ç¼–è¾‘å™¨å†…å®¹ï¼Œçƒ˜ç„™æŒ‡å®šçš„å…³å¡åœ°å›¾ã€‚ç¼–è¾‘å™¨å†…å®¹åªåœ¨å¼€å‘é˜¶æ®µä½¿ç”¨ï¼Œ
åœ¨æ¸¸æˆæ‰“åŒ…å‘è¡Œåä¸éœ€è¦ã€‚ç¼–è¯‘æ—¶ï¼Œé…ç½®æŒ‡å®š Shippingï¼ˆProductionï¼‰ï¼Œå°±ä¼šå¯¹æ‰“åŒ…å†…å®¹è¿›è¡Œå‹ç¼©ï¼Œ
å¯ä»¥è¿›ä¸€æ­¥å‡å°æ‰“åŒ…ä½“ç§¯ã€‚

å¯ç”¨â€œåˆ›å»ºå‹ç¼©çš„å·²çƒ˜åŸ¹åŒ…â€ï¼ˆCreate compressed cooked packagesï¼‰å¤é€‰æ¡†çš„æƒ…å†µä¸‹æ‰“åŒ…æ¸¸æˆåï¼Œ
é¡¹ç›® APK åŒ…å¤§å°ä¸‹é™ 50% å¹¶ä¸ç½•è§ã€‚


## âš¡ Assets Reference èµ„æºå¼•ç”¨
- å¦‚ä½•å¼•ç”¨èµ„æº https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ProgrammingWithCPP/Assets/ReferencingAssets/

è™šå¹»å¼•æ“ 4 æä¾›äº†è®¸å¤šç§æœºåˆ¶æ¥æ§åˆ¶å¼•ç”¨èµ„æºçš„æ–¹å¼å¹¶é€šè¿‡æ‰©å±•å°†å…¶è£…å…¥å†…å­˜ã€‚

è¿™äº›å¼•ç”¨åˆ†ä¸ºä¸¤ç§åŸºæœ¬æ–¹å¼ï¼š

- ç¡¬æ€§å¼•ç”¨ï¼Œå³å¯¹è±¡ A å¼•ç”¨å¯¹è±¡ Bï¼Œå¹¶å¯¼è‡´å¯¹è±¡ B åœ¨å¯¹è±¡ A åŠ è½½æ—¶åŠ è½½ï¼›
- è½¯æ€§å¼•ç”¨ï¼Œå³å¯¹è±¡ A é€šè¿‡é—´æ¥æœºåˆ¶æ¥å¼•ç”¨å¯¹è±¡ Bï¼Œä¾‹å¦‚å­—ç¬¦ä¸²å½¢å¼çš„å¯¹è±¡è·¯å¾„ï¼Œåˆæˆ–è€…å±æ€§æ–¹å¼ç­‰ç­‰ã€‚
    - Native UClass çš„åŠ è½½è·¯å¾„æ ¼å¼ä¸º **/Script/MODULE.CLASSNAME**ï¼Œ ç±»å‹åè¦å»æ‰ Uã€A ç­‰å‰ç¼€ã€‚
    - Blueprint UClass çš„åŠ è½½è·¯å¾„æ ¼å¼ä¸º **/Engine|Game|PLUGINNAME/.../CLASSNAME.CLASSNAME_C**ï¼Œå¤šäº†åç¼€çš„ *_C*ã€‚

ä»¥ä¸‹æŒ‰è¿™ä¸‰ç§æ–¹æ³•è¿›è¡Œè¯´æ˜ï¼š

- Direct Property Reference
- Construction Time Reference
- Indirect Property Reference

ç›´æ¥å±æ€§å¼•ç”¨æ˜¯æœ€å¸¸è§çš„ç¡¬æ€§èµ„æºå¼•ç”¨æƒ…å†µï¼Œå¹¶é€šè¿‡ **UPROPERTY** å®å…¬å¼€ï¼Œå…è®¸è®¾è®¡äººå‘˜é€šè¿‡è“å›¾ç»§æ‰¿å¯¹åŸå‹æŒ‡å®šç‰¹å®šèµ„æºï¼Œæˆ–é€šè¿‡æ”¾åœ¨ç¯å¢ƒä¸­çš„å®ä¾‹æ¥æŒ‡å®šè¯¥èµ„æºã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç æ¥è‡ª StrategyGame åŒ…å«çš„ AStrategyBuildingï¼Œå®ƒå…è®¸è®¾è®¡äººå‘˜é€‰æ‹©å»ºé€ æŸç§ç±»å‹çš„å»ºç­‘æ—¶æ’­æ”¾çš„å£°éŸ³ã€‚

```C++
/** construction start sound stinger */
UPROPERTY(EditDefaultsOnly, Category=Building)
USoundCue* ConstructionStartStinger;
```

æ­¤å±æ€§åªèƒ½ä½œä¸ºå¯¹è±¡é»˜è®¤å±æ€§çš„ä¸€éƒ¨åˆ†è¿›è¡Œè®¾ç½®ï¼ˆç”± EditDefaultsOnly å…³é”®å­—æ§åˆ¶ï¼‰ã€‚è®¾è®¡äººå‘˜åˆ›å»ºæ‰©å±• AStrategyBuilding çš„æ–°è“å›¾ç±»ã€‚ç„¶åï¼Œå¯ä»¥ä¸ºè¯¥è“å›¾ä¿å­˜è®¾è®¡äººå‘˜æ‰€éœ€è¦çš„å£°éŸ³ã€‚æ¯å½“è®¾è®¡äººå‘˜æ‰€åˆ›å»ºçš„è¯¥è“å›¾åŠ è½½æ—¶ï¼Œè¿˜å°†è‡ªåŠ¨åŠ è½½è¯¥ UPROPERTY ä¸­å¼•ç”¨çš„å£°éŸ³ã€‚

æ„é€ æ—¶å¼•ç”¨ä¹Ÿæ˜¯å¸¸è§ç¡¬æ€§å¼•ç”¨æ–¹å¼ï¼Œå½“ç¨‹åºå‘˜çŸ¥é“éœ€è¦ä¸ºç»™å®šå±æ€§åŠ è½½çš„ç¡®åˆ‡èµ„æºï¼Œå¹¶åœ¨å¯¹è±¡çš„æ„é€ ä¸­è®¾ç½®è¯¥å±æ€§ã€‚è¿™é¡¹ä»»åŠ¡æ˜¯ä½¿ç”¨ç‰¹æ®Šçš„ **ConstructorHelpers** ç±»å®Œæˆçš„ï¼Œè¿™ä¸ªç±»åœ¨æ„é€ é˜¶æ®µæŸ¥æ‰¾æŸä¸ªå¯¹è±¡çš„å¯¹è±¡å’Œç±»ã€‚
ä»¥ä¸‹ HUD ç‰‡æ®µåŒæ ·æ¥è‡ª StrategyGameï¼Œå®ƒåœ¨å…¶æ¸²æŸ“è¿‡ç¨‹ä¸­æŒ‡æ´¾è¦ä½¿ç”¨çš„èµ„æºã€‚

```C++,
    /** gray health bar texture */

    UPROPERTY()

    class UTexture2D* BarFillTexture;

    AStrategyHUD::AStrategyHUD(const FObjectInitializer& ObjectInitializer) :
        Super(ObjectInitializer)
    {
        static ConstructorHelpers::FObjectFinder<UTexture2D> BarFillObj(TEXT("/Game/UI/HUD/BarFill"));

        ...

        BarFillTexture = BarFillObj.Object;

        ...

    }
```

åœ¨ä»¥ä¸Šæ„é€ å‡½æ•°ä¸­ï¼ŒConstructorHelpers ç±»å°†å°è¯•åœ¨å†…å­˜ä¸­æŸ¥æ‰¾è¯¥èµ„æºï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™è¿›è¡Œèµ„äº§åŠ è½½ã€‚è¯·æ³¨æ„ï¼Œä½¿ç”¨èµ„æºçš„å®Œæ•´è·¯å¾„æ¥æŒ‡å®šè¦åŠ è½½çš„å†…å®¹ã€‚å¦‚æœè¯¥èµ„æºä¸å­˜åœ¨æˆ–è€…ç”±äºå‡ºé”™è€Œæ— æ³•åŠ è½½ï¼Œé‚£ä¹ˆè¯¥å±æ€§å°†è®¾ç½®ä¸º nullptrã€‚å‘ç”Ÿè¿™ç§æƒ…å†µæ—¶ï¼Œå°è¯•è®¿é—®çº¹ç†çš„ä»£ç å°†å´©æºƒã€‚æœ€å¥½è¿›è¡Œå£°æ˜ï¼ŒæŒ‡å‡ºèµ„æºå·²æ­£ç¡®åŠ è½½ï¼ˆå¦‚æœåç»­ä»£ç å‡è®¾å¼•ç”¨æœ‰æ•ˆï¼‰ã€‚

UPROPERTY çš„å£°æ˜ä¸å‰é¢çš„ç¡¬æ€§å¼•ç”¨ç¤ºä¾‹ç›¸åŒã€‚å®ƒä»¬çš„å·¥ä½œæ–¹å¼ç›¸åŒï¼Œåªä¸è¿‡æ˜¯æœ€åˆçš„è®¾ç½®æ–¹å¼æœ‰æ‰€å·®åˆ«ã€‚æœ‰å…³ç¡¬æ€§å¼•ç”¨çš„ä¸€ä¸ªæ³¨æ„äº‹é¡¹æ˜¯ï¼Œå½“å¯¹è±¡åŠ è½½å¹¶å®ä¾‹åŒ–æ—¶ï¼Œè¿˜å°†åŠ è½½ä»¥ç¡¬æ€§æ–¹å¼å¼•ç”¨çš„èµ„æºã€‚æ‚¨å¿…é¡»ä»”ç»†åœ°è¿›è¡Œè€ƒè™‘ï¼Œå¦åˆ™å†…å­˜ä½¿ç”¨é‡ä¼šå› ä¸ºåŒæ—¶åŠ è½½è®¸å¤šèµ„æºè€Œè¿…é€Ÿå¢åŠ ã€‚


ConstructorHelpers æœ‰ä¸€ä¸ª `FObjectFinder` å’Œä¸€ä¸ª `FClassFinder` æ¥åŠ è½½èµ„æºï¼Œä½†æ˜¯å‰è€… CDO Constructor åªèƒ½åœ¨æ„é€ å‡½æ•°ä¸­ä½¿ç”¨ï¼Œå¦åˆ™ä¼šå‡ºé”™ã€‚

å…¶å®ƒæ¶‰åŠçš„ APIï¼š

- FindPackage
- LoadPackage
- FindObject<>() å’Œ LoadObject ç±»ä¼¼ï¼Œå†…éƒ¨è°ƒç”¨ StaticLoadObjectï¼›
- LoadClass å†…éƒ¨è°ƒç”¨ StaticLoadClassï¼›

å‚è€ƒæºä»£ç  UE_4.27\Engine\Source\Runtime\CoreUObject\Public\UObject\UObjectGlobals.h


é—´æ¥å±æ€§å¼•ç”¨æ–¹å¼ï¼Œå¯ä»¥æ§åˆ¶ä½•æ—¶åŠ è½½èµ„æºï¼Œä¸€ç§ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨ **TSoftObjectPtr**ã€‚å¯¹äºè®¾è®¡äººå‘˜ï¼Œé—´æ¥å±æ€§å¼•ç”¨çš„å·¥ä½œæ–¹å¼å°±åƒç›´æ¥å±æ€§å¼•ç”¨ä¸€æ ·ã€‚ä½†æ˜¯ï¼Œå±æ€§ä»¥å­—ç¬¦ä¸²å½¢å¼ä¸æ¨¡ç‰ˆä»£ç å­˜å‚¨åœ¨ä¸€èµ·ä»¥ä¾¿å®‰å…¨åœ°æ£€æŸ¥èµ„æºæ˜¯å¦å·²åŠ è½½ï¼Œè€Œä¸æ˜¯è¿›è¡Œç›´æ¥æŒ‡é’ˆå¼•ç”¨ã€‚ä½¿ç”¨ **IsPending()** æ–¹æ³•å¯æ£€æŸ¥èµ„æºæ˜¯å¦å·²å‡†å¤‡å¥½å¯ä¾›è®¿é—®ã€‚è¯·æ³¨æ„ï¼Œä½¿ç”¨ **TSoftObjectPtr** è¦æ±‚åœ¨æ‚¨æƒ³è¦ä½¿ç”¨èµ„æºæ—¶æ‰‹åŠ¨åŠ è½½è¯¥èµ„æºã€‚æ‚¨å¯ä½¿ç”¨æ¨¡æ¿åŒ– **LoadObject<>()** æ–¹æ³•ã€**StaticLoadObject()** æˆ– **FStreamingManager** æ¥åŠ è½½å¯¹è±¡ã€‚å‰ä¸¤ä¸ªæ–¹æ³•ä»¥åŒæ­¥æ–¹å¼åŠ è½½èµ„æºï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´å¸§é€Ÿç‡çªå¢ï¼Œå› æ­¤ï¼Œä»…å½“æ‚¨çŸ¥é“ä¸ä¼šå½±å“æ¸¸æˆæ—¶ï¼Œæ‰åº”ä½¿ç”¨è¿™äº›æ–¹æ³•ã€‚

```C++,
    UPROPERTY(EditDefaultsOnly, BlueprintReadWrite, Category=Building)
    TSoftObjectPtr<UStaticMesh> BaseMesh;

    UStaticMesh* GetLazyLoadedMesh()
    {
        if (BaseMesh.IsPending())
        {
            const FSoftObjectPath& AssetRef = BaseMesh.ToStringReference();
            BaseMesh = Cast<UStaticMesh>(Streamable.SynchronousLoad(AssetRef));
        }
        return BaseMesh.Get();
    }
```

ä»¥ä¸Šä»£ç ï¼Œ**TSoftObjectPtr** å°†å…¶ä½¿ç”¨çš„ UStaticMesh ç½‘æ ¼çš„åŠ è½½æ¨è¿Ÿåˆ°è¿è¡Œæ—¶è¿›è¡Œã€‚ä¼šè¿›è¡Œæ£€æŸ¥èµ„æºï¼Œä»¥ç¡®å®šå¯¹è±¡æ˜¯å¦å·²åŠ è½½ã€‚å¦‚æœå°šæœªåŠ è½½ï¼Œé‚£ä¹ˆå°†ä½¿ç”¨ **FStreamingManager** æ‰§è¡ŒåŒæ­¥åŠ è½½ã€‚ç„¶åï¼Œè¿”å› **TSoftObjectPtr** å†…çš„ UStaticMesh æŒ‡é’ˆç»™è°ƒç”¨è€…ã€‚

å¦‚æœæ‚¨å¸Œæœ›æ¨è¿ŸåŠ è½½ Uclassï¼Œè¯·ä½¿ç”¨ä¸ **TSoftObjectPtr** ç›¸åŒçš„æ–¹æ³•ï¼Œå¹¶æ›¿æ¢ç±»ç‰¹å®šç‰ˆæœ¬ TSoftClassPtr æ¨¡ç‰ˆç±»å‹ã€‚å…¶å·¥ä½œæ–¹å¼ä¸å¼•ç”¨ç‰¹å®šçš„èµ„æºç›¸åŒï¼Œä½†æ”¹ä¸ºå¼•ç”¨èµ„æºçš„ Uclassï¼Œè€Œä¸æ˜¯å¼•ç”¨æ¥å£ã€‚

ä»¥ä¸Šè¿™äº›ç¤ºä¾‹å…¨éƒ½åŸºäº UPROPERTYï¼Œä»¥ä¸‹æ˜¯é€šè¿‡æŸ¥æ‰¾/è£…å…¥çš„æ–¹å¼åŠ è½½å¯¹è±¡ã€‚åœ¨è¿è¡Œæ—¶æ„å»ºå­—ç¬¦ä¸²å¹¶ä½¿ç”¨è¯¥å­—ç¬¦ä¸²æ¥å¼•ç”¨å¯¹è±¡ï¼Œå¯ä½¿ç”¨ä¸¤ä¸ªé€‰é¡¹ï¼š

- å¦‚æœæ‚¨ä»…åœ¨ UObject å·²åŠ è½½æˆ–å·²åˆ›å»ºæ—¶æ‰ä½¿ç”¨å®ƒï¼Œé‚£ä¹ˆæ­£ç¡®çš„é€‰æ‹©æ˜¯ä½¿ç”¨ **FindObject<>()**ã€‚
- å¦‚æœæ‚¨å¸Œæœ›å¯¹è±¡æœªåŠ è½½æ—¶å°†å…¶åŠ è½½ï¼Œé‚£ä¹ˆæ­£ç¡®çš„é€‰æ‹©æ˜¯ä½¿ç”¨ **LoadObject<>()**ã€‚

è¯·æ³¨æ„ï¼ŒLoadObject<>() åœ¨å†…éƒ¨æ‰§è¡Œçš„æ“ä½œä¸ FindObject ç›¸åŒï¼Œå› æ­¤æ‚¨ä¸å¿…å…ˆå°è¯•æŸ¥æ‰¾å¯¹è±¡å†è¿›è¡ŒåŠ è½½ã€‚

ä»¥ä¸‹æ˜¯å„ä¸ªå‡½æ•°çš„ä¸€äº›ç”¨æ³•ç¤ºä¾‹ã€‚

```C++
AFunctionalTest* TestToRun = FindObject<AFunctionalTest>(TestsOuter, *TestName);
GridTexture = LoadObject<UTexture2D>(NULL, TEXT("/Engine/EngineMaterials/DefaultWhiteGrid.DefaultWhiteGrid"), NULL, LOAD_None, NULL);
```

åŠ è½½ UClass æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ LoadObject çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ã€‚è¿™æ— éæ˜¯åŠ è½½ç±»çš„ä¸€ç§è¾ƒç®€å•æ–¹æ³•ï¼Œå®ƒä¼šè‡ªåŠ¨éªŒè¯ç±»å‹ã€‚ä»¥ä¸‹ä»£ç ç‰‡æ®µå¯¹æ­¤ä½œäº†è¯´æ˜ã€‚

```C++
DefaultPreviewPawnClass = LoadClass<APawn>(NULL, *PreviewPawnName, NULL, LOAD_None, NULL);

// ç­‰åŒäºï¼š
DefaultPreviewPawnClass = LoadObject<UClass>(NULL, *PreviewPawnName, NULL, LOAD_None, NULL);

if (!DefaultPreviewPawnClass->IsChildOf(APawn::StaticClass()))
{
    DefaultPreviewPawnClass = nullptr;
}
```


## âš¡ Assets Registry èµ„æºæ³¨å†Œè¡¨
- Assets Registry https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ProgrammingWithCPP/Assets/Registry/

è¦æŒ‰ç±»å»ºç«‹èµ„æºåˆ—è¡¨ï¼Œåªéœ€åŠ è½½èµ„æºæ³¨å†Œè¡¨ï¼ˆAsset Registryï¼‰æ¨¡å—ç„¶åè°ƒç”¨ *Module.Get().GetAssetsByClass()* å³å¯ã€‚

```C++
FAssetRegistryModule& AssetRegistryModule = FModuleManager::LoadModuleChecked<FAssetRegistryModule>("AssetRegistry");
TArray<FAssetData> AssetData;
const UClass* Class = UStaticMesh::StaticClass();
AssetRegistryModule.Get().GetAssetsByClass(Class->GetFName(), AssetData);
```

ä»¥ä¸Šä»£ç å°†è¿”å›ä¸€ç³»åˆ— *FAssetData* å¯¹è±¡ï¼Œå®ƒä»¬æè¿°å·²åŠ è½½æˆ–æœªåŠ è½½çš„èµ„æºï¼Œè¿˜å®¹çº³æœ‰å…³èµ„æºçš„ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯åœ¨èµ„æºè¢«åŠ è½½å‰å°±å¯ä»¥ç¡®å®šã€‚

ä¸‹é¢æ˜¯å…¶æˆå‘˜åˆ—è¡¨å’Œè¯´æ˜ï¼š

- FName *ObjectPath* èµ„æºçš„å¯¹è±¡è·¯å¾„ï¼Œå½¢å¼æ˜¯ Package.GroupNames.AssetNameã€‚
- FName *PackageName* åŒ…å«è¯¥èµ„æºçš„åŒ…çš„åç§°ã€‚
- FName *PackagePath* åŒ…å«è¯¥èµ„æºçš„åŒ…çš„è·¯å¾„ã€‚
- FName *GroupNames* åŒ…å«è¯¥èµ„æºçš„ç»„åç§°çš„åˆ—è¡¨ï¼ˆä½¿ç”¨"."åˆ†éš”ï¼‰ã€‚å¦‚æœæ— ç»„ï¼Œåˆ™ä¸º NAME_Noneã€‚
- FName *AssetName* æ— åŒ…æˆ–ç»„çš„èµ„æºçš„åç§°ã€‚
- FName *AssetClass* èµ„æºçš„ç±»çš„åç§°ã€‚
- TMap<FName, FString> *TagsAndValues* æ ‡è®°ä¸º AssetRegistrySearchable çš„å±æ€§çš„å€¼æ˜ å°„ã€‚

ä½ ä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨ä¸‹åˆ—ä»»æ„ä¸€ä¸ªå‡½æ•°ï¼Œä½¿ç”¨å…¶ä»–æ¡ä»¶å»ºç«‹åˆ—è¡¨ï¼š

- *GetAssetsByPackageName()* è¿”å›æ¥è‡ªç‰¹å®šåŒ…çš„èµ„æºçš„åˆ—è¡¨ã€‚
- *GetAssetsByPath()* è¿”å›ç‰¹å®šè·¯å¾„ä¸­çš„èµ„æºçš„åˆ—è¡¨ã€‚
- *GetAssetByObjectPath()* è¿”å›å…·æœ‰ç‰¹å®šå¯¹è±¡è·¯å¾„çš„èµ„æºçš„åˆ—è¡¨ã€‚
- *GetAssetsByTagValues()* è¿”å›å…·æœ‰ç‰¹å®šæ ‡è®°å’Œå€¼ç»„åˆçš„èµ„æºçš„åˆ—è¡¨ã€‚
- *GetAllAssets()* è¿”å›æ‰€æœ‰èµ„æºçš„åˆ—è¡¨ã€‚æ­¤è¿‡ç¨‹å¯èƒ½è¾ƒæ…¢ã€‚

FAssetData å¯¹è±¡å…·æœ‰ä¸€ä¸ªåç§°ä¸º *GetAsset()* çš„å‡½æ•°ï¼Œå®ƒå°†è¿”å› FAssetData è¡¨ç¤ºçš„ UObject* ã€‚å¦‚æœéœ€è¦ï¼Œå®ƒå°†åŠ è½½èµ„æºç„¶åè¿”å›å®ƒã€‚

å¦‚æœä»…å¸Œæœ›æ£€æŸ¥èµ„æºæ˜¯å¦å·²åŠ è½½ï¼Œå¯ä½¿ç”¨ *IsAssetLoaded()*ã€‚

å¦‚æœéœ€è¦ä½¿ç”¨å¤šä¸ªæ¡ä»¶å»ºç«‹èµ„æºåˆ—è¡¨ï¼Œå¯ä»¥ä½¿ç”¨ *GetAssets()* å¹¶æä¾› *FARFilter* ç»“æ„ä½“ï¼Œå¦‚åˆ›å»ºè¿‡æ»¤å™¨éƒ¨åˆ†ä¸­æ‰€è¿°ã€‚

è¿‡æ»¤å™¨ç”±å¤šä¸ªæˆåˆ†ç»„æˆï¼š

- åŒ…åç§°ï¼ˆPackageNameï¼‰
- åŒ…è·¯å¾„ï¼ˆPackagePathï¼‰
- é›†åˆï¼ˆCollectionï¼‰
- ç±»ï¼ˆClassï¼‰
- æ ‡è®°/å€¼å¯¹ï¼ˆTags/Valueï¼‰

ä¸€ä¸ªæˆåˆ†å¯èƒ½å…·æœ‰å¤šä¸ªå…ƒç´ ã€‚è¦é€šè¿‡è¿‡æ»¤å™¨ï¼Œèµ„æºå¿…é¡»æ»¡è¶³æ‰€æœ‰æˆåˆ†ã€‚è¦æ»¡è¶³æˆåˆ†ï¼Œèµ„æºå¿…é¡»ä¸å…¶ä¸­çš„ä»»æ„å…ƒç´ åŒ¹é…ã€‚

ä¾‹å¦‚ï¼Œå­˜åœ¨ä¸€ä¸ªè·¯å¾„ä¸º*/Game/Meshes/BeachBall*çš„é™æ€ç½‘æ ¼ä½“èµ„æºï¼š

- å¦‚æœè¿‡æ»¤å™¨ä»…å«åŒ…è·¯å¾„ */Game/Meshes*ï¼Œèµ„æºå°†é€šè¿‡è¿‡æ»¤ï¼Œä»…å­˜åœ¨ä¸€ä¸ªå…·æœ‰ä¸€ä¸ªå…ƒç´ çš„æˆåˆ†ã€‚
- å¦‚æœè¿‡æ»¤å™¨å«åŒ…è·¯å¾„ */Game/Meshes* è¿˜æœ‰ *UParticleSystem* å’Œ *UStaticMesh* ç±»ï¼Œèµ„æºå°†é€šè¿‡è¿‡æ»¤ã€‚å› ä¸ºï¼ŒåŒ…è·¯å¾„åŒ¹é…ä¸” *BeachBall* å±äºé™æ€é£æ ¼èµ„æºã€‚å­˜åœ¨ä¸¤ä¸ªæˆåˆ†ï¼Œç¬¬ä¸€ä¸ªæˆåˆ†å…·æœ‰ä¸€ä¸ªå…ƒç´ ï¼Œç¬¬äºŒä¸ªæˆåˆ†å…·æœ‰ä¸¤ä¸ªå…ƒç´ å³ä¸¤ä¸ªç±»ã€‚
- å¦‚æœè¿‡æ»¤å™¨å«åŒ…è·¯å¾„ */Game/Meshes* å¹¶ä¸”ä»…å« *UParticleSystem* ç±»ï¼Œèµ„æºå°†æ— æ³•é€šè¿‡è¿‡æ»¤ã€‚
- å¦‚æœè¿‡æ»¤å™¨å«åŒ…è·¯å¾„ */Game/NotMeshes* å’Œ *UStaticMesh* ç±»ï¼Œèµ„æºå°†æ— æ³•é€šè¿‡è¿‡æ»¤ï¼Œå› ä¸ºåŒ…è·¯å¾„ä¸åŒ¹é…ã€‚

ä½¿ç”¨å…·æœ‰ä¸¤ä¸ªç»„ä»¶ï¼ˆç±»å’ŒåŒ…è·¯å¾„ï¼‰çš„è¿‡æ»¤å™¨çš„ä¸€ä¸ªç¤ºä¾‹ï¼š

```C++
FAssetRegistryModule& AssetRegistryModule = FModuleManager::LoadModuleChecked<FAssetRegistryModule>("AssetRegistry");
TArray<FAssetData> AssetData;
FARFilter Filter;
Filter.Classes.Add(UStaticMesh::StaticClass());
Filter.PackagePaths.Add("/Game/Meshes");
AssetRegistryModule.Get().GetAssets(Filter, AssetData);
```

ä»èµ„æºæ³¨å†Œè¡¨è¿”å›çš„ *FAssetData* å¯¹è±¡åŒ…å«åç§°å’Œç§°ä½œ TagsAndValues çš„å€¼æ˜ å°„ã€‚ å®ƒä»¬æ˜¯ *FAssetData* è¡¨ç¤ºçš„èµ„æºçš„å±æ€§åç§°å’Œå…³è”å€¼ã€‚ æ­¤ä¿¡æ¯æ˜¯åœ¨èµ„æºè¢«ä¿å­˜æ—¶æ”¶é›†çš„ï¼Œå­˜å‚¨åœ¨åŒ…å«èµ„æºçš„ UAsset æ–‡ä»¶çš„æ ‡å¤´ä¸­ã€‚ èµ„æºæ³¨å†Œè¡¨è¯»å–æ­¤æ ‡å¤´å¹¶ç›¸åº”åœ°å¡«å…… TagsAndValues æ˜ å°„ã€‚ èµ„æºæ³¨å†Œè¡¨ä»…æ”¶é›†ä½¿ç”¨ *AssetRegistrySearchable* æ ‡è®°æ ‡è®°çš„ UPROPERTY() å±æ€§ã€‚

ä¾‹å¦‚ï¼ˆæ¥è‡ª UTextureï¼‰ï¼š

```C++
/** å¯¹æ­¤çº¹ç†é‡‡æ ·æ—¶ä½¿ç”¨çš„çº¹ç†è¿‡æ»¤æ¨¡å¼ã€‚*/
UPROPERTY(Category=Texture, AssetRegistrySearchable)
TEnumAsByte<enum TextureFilter> Filter;
```

å°†æ­¤æ ‡è®°æ·»åŠ åˆ° UTexture çš„è¿‡æ»¤å™¨ï¼ˆFilterï¼‰å±æ€§åï¼Œä¹‹åä¿å­˜çš„æ‰€æœ‰ UTexture éƒ½å°†å…·æœ‰ä¸€ä¸ª Key ä¸º Filterã€å€¼æ˜¯è¡¨ç¤ºæšä¸¾å€¼çš„å­—ç¬¦ä¸²çš„å¯æŸ¥è¯¢ *FAssetData* æ¡ç›®ä¿ç•™åœ¨ TagsAndValues æ˜ å°„ä¸­ï¼ˆä¾‹å¦‚ï¼Œ"TF_Linear"ï¼‰çš„æ¡ç›®ã€‚

è¦ä½¿èµ„æºæ³¨å†Œè¡¨èƒ½å¤Ÿå‘ç°èµ„æºçš„å±æ€§ï¼Œå¿…é¡»é‡æ–°ä¿å­˜èµ„æºã€‚

å¦‚æœä½ å¸Œæœ›èµ„æºæ³¨å†Œè¡¨èƒ½å¤Ÿæœç´¢æœ¬èº«ä¸æ˜¯ UProperty çš„ä¿¡æ¯ï¼Œ èµ„æºçš„ç±»å¯ä»¥å®ç°ç»§æ‰¿è‡ª UObject çš„è™šå‡½æ•°*GetAssetRegistryTags()*ï¼Œä»¥æ‰‹åŠ¨å°†é”®/å€¼ å¯¹æ·»åŠ åˆ°*TagsAndValues*æ˜ å°„ã€‚

ä½¿ç”¨å¼‚æ­¥æ•°æ®æ”¶é›†æ—¶ï¼Œèµ„æºæ³¨å†Œè¡¨å¼‚æ­¥è¯»å– UAsset æ–‡ä»¶ï¼Œåœ¨è¯·æ±‚èµ„æºåˆ—è¡¨æ—¶ï¼Œ åˆ—è¡¨å¯èƒ½å¹¶éåŒ…å«æ‰€æœ‰èµ„æºçš„å®Œæ•´åˆ—è¡¨ã€‚å¦‚æœç¼–è¾‘å™¨ä»£ç éœ€è¦å®Œæ•´åˆ—è¡¨ï¼Œèµ„æºæ³¨å†Œè¡¨å¯æä¾›å§”æ‰˜å›è°ƒï¼Œæ¶µç›–èµ„æºè¢«å‘ç°/åˆ›å»ºã€é‡å‘½åæˆ–åˆ é™¤ç­‰æƒ…å†µã€‚ä¹Ÿå­˜åœ¨é€‚ç”¨äº èµ„æºæ³¨å†Œè¡¨å·²å®Œæˆåˆå§‹æœç´¢çš„æƒ…å†µçš„å§”æ‰˜ï¼Œå®ƒå¯¹äºå¾ˆå¤šç³»ç»Ÿéƒ½éå¸¸æœ‰ç”¨ã€‚

æ³¨å†Œè¿™äº›å§”æ‰˜çš„æ–¹æ³•æ˜¯ï¼ŒåŠ è½½èµ„æºæ³¨å†Œè¡¨ï¼ˆAsset Registryï¼‰æ¨¡å—ï¼Œç„¶åä½¿ç”¨ *IAssetRegistry* æ¥å£æä¾›çš„å‡½æ•°ï¼š

```C++,
    /** æ³¨å†Œ/å–æ¶ˆæ³¨å†Œï¼šé€‚ç”¨äºèµ„æºè¢«æ·»åŠ åˆ°æ³¨å†Œè¡¨ä¸­çš„æƒ…å†µçš„å›è°ƒ*/
    virtual FAssetAddedEvent& OnAssetAdded() = 0;

    /** æ³¨å†Œ/å–æ¶ˆæ³¨å†Œï¼šé€‚ç”¨äºèµ„æºè¢«ä»æ³¨å†Œè¡¨ä¸­åˆ é™¤çš„æƒ…å†µçš„å›è°ƒ*/
    virtual FAssetRemovedEvent& OnAssetRemoved() = 0;

    /** æ³¨å†Œ/å–æ¶ˆæ³¨å†Œï¼šé€‚ç”¨äºèµ„æºåœ¨æ³¨å†Œè¡¨ä¸­è¢«é‡å‘½åçš„æƒ…å†µçš„å›è°ƒ*/
    virtual FAssetRenamedEvent& OnAssetRenamed() = 0;

    /** æ³¨å†Œ/å–æ¶ˆæ³¨å†Œï¼šé€‚ç”¨äºèµ„æºæ³¨å†Œè¡¨åŠ è½½å®Œæ–‡ä»¶çš„æƒ…å†µçš„å›è°ƒ*/
    virtual FFilesLoadedEvent& OnFilesLoaded() = 0;

    /** æ³¨å†Œ/å–æ¶ˆæ³¨å†Œï¼šæ›´æ–°åå°æ–‡ä»¶åŠ è½½è¿›åº¦çš„å›è°ƒ*/
    virtual FFileLoadProgressUpdatedEvent& OnFileLoadProgressUpdated() = 0;

    /** å¦‚æœèµ„æºæ³¨å†Œè¡¨å½“å‰æ­£åœ¨åŠ è½½æ–‡ä»¶ï¼Œå°šæ— æ³•è¿”å›æœ‰å…³æ‰€æœ‰èµ„æºçš„ä¿¡æ¯æ—¶è¿”å› True*/
    virtual bool IsLoadingAssets() = 0;
```

ä¾‹å¦‚ï¼š

```C++,
    void FMyClass::FMyClass()
    {
        // åŠ è½½èµ„æºæ³¨å†Œè¡¨æ¨¡å—ï¼Œä»¥ä¾¦å¬æ›´æ–°
        FAssetRegistryModule& AssetRegistryModule = FModuleManager::LoadModuleChecked<FAssetRegistryModule>("AssetRegistry");
        AssetRegistryModule.Get().OnAssetAdded().AddRaw( this, &FMyClass::OnAssetAdded );
    }

    FMyClass::~FMyClass()
    {
        // åŠ è½½èµ„æºæ³¨å†Œè¡¨æ¨¡å—ï¼Œä»¥å°†å§”æ‰˜å–æ¶ˆæ³¨å†Œ
        FAssetRegistryModule& AssetRegistryModule = FModuleManager::LoadModuleChecked<FAssetRegistryModule>("AssetRegistry");
        AssetRegistryModule.Get().OnAssetAdded().RemoveAll( this );
    }

    void FMyClass::OnAssetAdded(const FAssetData& AssetData)
    {
        // èµ„æºæ³¨å†Œè¡¨å‘ç°æŸä¸ªèµ„æºã€‚
        // è¿™æ„å‘³ç€è¯¥èµ„æºåˆšè¢«åˆ›å»ºæˆ–åˆšåœ¨ç£ç›˜ä¸Šè¢«å‘ç°ã€‚
        // ç¡®ä¿æ­¤å‡½æ•°ä¸­çš„ä»£ç é€Ÿåº¦è¾ƒå¿«ï¼Œå¦åˆ™å®ƒå°†æ‹–æ…¢æ”¶é›†è¿‡ç¨‹ã€‚
    }
```

å¯åœ¨ commandlet ä¸­ä½¿ç”¨èµ„æºæ³¨å†Œè¡¨ï¼Œä½†æ˜¯è¿™æ · ä¼šåŒæ­¥æ”¶é›†ä¿¡æ¯ã€‚*LoadModule()* è°ƒç”¨å°†è¢«é˜»æ­¢ï¼Œç›´è‡³æ”¶é›†å®Œæˆã€‚

å¦‚æœä»£ç æœŸæœ›èµ„æºè¢«å¼‚æ­¥å‘ç°ï¼Œå¹¶ä¸”å…·æœ‰ Slate UI å‰ç«¯ï¼Œå®ƒåº” åŒ…å« SAssetDiscoveryIndicator æ§ä»¶ï¼Œä»¥å°†è¿›åº¦ä¼ è¾¾ç»™ç”¨æˆ·ã€‚



## âš¡ Assets AsyncLoading èµ„æºå¼‚æ­¥åŠ è½½
- å¼‚æ­¥èµ„æºåŠ è½½ https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ProgrammingWithCPP/Assets/AsyncLoading/
- èµ„æºæ³¨å†Œè¡¨ https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ProgrammingWithCPP/Assets/Registry

æŒ‰éœ€å¼•ç”¨å’ŒåŠ è½½æ•°æ®ï¼Œé€šå¸¸æœ‰ä¸¤ç§æ–¹æ³•ï¼š**FSoftObjectPaths** å’Œ **TSoftObjectPtr**ã€‚

åœ¨è“å›¾ä¸­è®¾ç½®ä¸€ä¸ª UObject æˆ–å­ç±»å¼•ç”¨æ—¶ï¼Œä¼šæ¶‰åŠ 4 ç§å¼•ç”¨ï¼š

- Object Reference å¯¹ä¸€ä¸ª UObject çš„ç¡¬å¼•ç”¨ï¼Œå³å…¶å¼•ç”¨çš„ç±»è¢«å®ä¾‹åŒ–ï¼Œè¢«å¼•ç”¨çš„èµ„æºä¹Ÿä¼šè¢«å®ä¾‹åŒ–ã€‚
- Class Reference å¯¹ä¸€ä¸ª UClass çš„å¼•ç”¨ã€‚
- Soft Object Referenceï¼Œç­‰ä»·äº C++ çš„ FSoftObjectPtrã€‚
- Soft Class Referenceï¼Œç­‰ä»·äº C++ çš„ TSoftClassPtrã€‚

ä»¥ä¸‹è¿™å‡ ä¸ªåŸºæœ¬ç±»å‹åå­—æœ‰ç‚¹æ··ï¼Œæ³¨æ„å‰ç¼€ F è¡¨ç¤ºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œå‰é¢ä¸¤ä¸ªæœ‰ Path åç¼€è¡¨ç¤ºå…¶æŒ‡è·¯åŠŸèƒ½ï¼š

- FSoftObjectPath ä½¿ç”¨å­—ç¬¦ä¸²å¼•ç”¨ä¸€ä¸ªå¯¹è±¡çš„ç»“æ„ä½“ï¼Œå†…éƒ¨ä½¿ç”¨ FName æŒ‡å‘é¡¶çº§èµ„äº§ï¼Œå¦‚**/package/path.assetname**ï¼Œè¿˜æœ‰ä¸€ä¸ªå¯é€‰å­å¯¹è±¡è·¯å¾„ã€‚MetaClass å…ƒæ•°æ®ç”¨å®ƒæ¥çº¦æŸ FProperty ç±»å‹ã€‚
- FSoftClassPath ç»§æ‰¿å‰è€…ï¼Œä½¿ç”¨å­—ç¬¦ä¸²å¼•ç”¨ä¸€ä¸ªç±»å‹ï¼Œå¯ä»¥ç”¨æ¥åˆ›å»ºç±»å‹çš„è½¯å¼•ç”¨ã€‚
- FSoftObjectPtr è½¯å¼•ç”¨æ™ºèƒ½ä¿æŒ UObject çš„å¼±å¼•ç”¨ï¼Œå¹¶ä¸”åŒ…å«è¿½è¸ªç£ç›˜èµ„æºçš„è·¯å¾„ä¿¡æ¯ã€‚
- TSoftObjectPtr æ˜¯æ³›å‹ç»“æ„ä½“ **FSoftObjectPtr** çš„æ¨¡æ¿åŒ–åŒ…è£…å™¨ï¼Œå¯ç”¨äº UPropertiesã€‚
- TSoftClassPtr æ˜¯å›´ç»• **FSoftObjectPtr** çš„æ¨¡æ¿åŒ–åŒ…è£…å™¨ï¼Œå…¶å·¥ä½œåŸç†ç±»ä¼¼äº TSubclassOfï¼Œå®ƒå¯ä»¥åœ¨è“å›¾å­ç±»çš„ UProperties ä¸­ä½¿ç”¨ã€‚

å½“è¢«å¼•ç”¨å¯¹è±¡åŠ è½½æˆ–å¸è½½æ—¶ï¼ŒFSoftObjectPtr å°†åœ¨æœ‰æ•ˆå’ŒæŒ‚èµ·ä¸¤ç§çŠ¶æ€ä¹‹é—´æ¥å›åˆ‡æ¢ã€‚å®ƒå¯¹å¯¹è±¡æ˜¯å¦è¢«åƒåœ¾æ”¶é›†æ²¡æœ‰å½±å“ï¼Œè¿™å¯¹äºæŒ‰éœ€å¼‚æ­¥åŠ è½½çš„èµ„äº§éå¸¸æœ‰ç”¨ã€‚

```js
UPROPERTY(Category = MyTest1, EditAnywhere) 
TSoftObjectPtr<UTexture2D> SourceTexture1; // è½¯å¼•ç”¨

UPROPERTY(Category = MyTest1, EditAnywhere) 
UTexture2D* SourceTexture2; // ç¡¬å¼•ç”¨
```



## âš¡ Assets Loading èµ„äº§åŠ è½½å‚è€ƒ
- Respawning a Player Character https://docs.unrealengine.com/4.27/en-US/InteractiveExperiences/HowTo/RespawnPlayer/
- GamePlay ç±»ä¸èµ„æº https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/GameplayArchitecture/Classes/

æç¤ºï¼šï¼Œå¯ä»¥åœ¨å†…å®¹æµè§ˆå™¨ä¸­ï¼Œä½¿ç”¨å¯¹è±¡çš„å³é”®èœå• Copy Reference è·å–èµ„äº§æ–‡ä»¶çš„å¼•ç”¨è·¯å¾„ã€‚ä½†æ˜¯æ³¨æ„ï¼Œç²˜è´´å¤åˆ¶çš„èµ„äº§å¼•ç”¨æ—¶ï¼Œè¯¥å¼•ç”¨åœ¨èµ„äº§çš„å¼•ç”¨è·¯å¾„ä¹‹å‰åŒ…å«èµ„äº§ç±»å‹åç§°ã€‚ä½ å°†çœ‹åˆ° *StaticMesh'/Game/Sphere.Sphere'*ï¼Œåˆæˆ–è€… *Material'/Engine/BasicShapes/BasicShapeMaterial.BasicShapeMaterial'*è¿™æ ·çš„ä¿¡æ¯ã€‚åœ¨ä»£ç ä¸­ä½¿ç”¨å¼•ç”¨è·¯å¾„æ—¶ï¼Œè¯·ç¡®ä¿ä»å¼•ç”¨è·¯å¾„ä¸­åˆ é™¤èµ„äº§çš„ç±»å‹åç§°ï¼Œä¾‹å¦‚ Materialï¼ŒåŒ…æ‹¬å•å¼•å·ä¹Ÿè¦æ¸…ç†ã€‚

ä½¿ç”¨è“å›¾åŠ è½½èµ„äº§ï¼Œå®é™…æ“ä½œä¸­éœ€è¦é€šè¿‡ä¸€ä¸ªéœ€è¦åŠ è½½çš„æ–‡ä»¶çš„åå­—è·å–åˆ°å¯¹åº”èµ„æºï¼š

- å¯ä»¥å…ˆé€šè¿‡ Get Asset Registry + Get Asset by Path è·å¾—åˆ° Assetsï¼Œåªéœ€è¦æŒ‡å®šèµ„äº§è·¯å¾„ï¼Œä¸éœ€è¦æŒ‡å®šèµ„äº§åç§°ï¼›
- å†é€šè¿‡ Asset æ•°æ®ç»“æ„å¯¹è±¡çš„ Get Full Name + Contains ç­›é€‰åŒ…å«æŒ‡å®šåç§°çš„ç›®æ ‡å†…å®¹ï¼›
- é…åˆ Get Classï¼ŒGet Asset è·å–åˆ° Array ä¸­çš„æ•°æ®ï¼Œå† Cast To è½¬æ¢ä¸ºç›®æ ‡ç±»å‹ï¼Œä¾‹å¦‚ StaticMesh æˆ–è€… Materialã€‚

å‚è€ƒï¼šAssetRegistry.h


ä¸ºæ›´å¯é çš„æ•°æ®ç±»å‹è®¾ç½®æ•°å€¼æ—¶ï¼ˆå°¤å…¶æ˜¯ç±»å¼•ç”¨ã€å‘½åå’Œèµ„æºå¼•ç”¨ï¼‰ï¼Œéœ€è¦åœ¨æ„é€ å‡½æ•°ä¸­å®šä¹‰å¹¶å®ä¾‹åŒ–ä¸€ä¸ª *ConstructorStatics* ç»“æ„ä½“ï¼Œä»¥ä¿å­˜æ‰€éœ€çš„è¯¸å¤šå±æ€§æ•°å€¼ã€‚*ConstructorStatics* ç»“æ„ä½“åœ¨æ„é€ å‡½æ•°é¦–æ¬¡è¿è¡Œæ—¶æ‰ä¼šè¢«åˆ›å»ºã€‚åœ¨éšåçš„è¿è¡Œä¸Šå®ƒåªä¼šå¤åˆ¶ä¸€ä¸ªæŒ‡é’ˆï¼Œä½¿å…¶å¤„ç†é€Ÿåº¦æå¿«ã€‚*ConstructorStatics* è¢«åˆ›å»ºæ—¶ï¼Œæ•°å€¼å°†è¢«æŒ‡å®šåˆ°ç»“æ„ä½“æˆå‘˜ï¼Œä»¥ä¾¿ç¨ååœ¨æ„å»ºå‡½æ•°ä¸ŠæŒ‡å®šæ•°å€¼åˆ°å®é™…å±æ€§æ—¶è¿›è¡Œè®¿é—®ã€‚

`ContructorHelpers` æ˜¯ ObjectBase.h ä¸­å®šä¹‰çš„ç‰¹æ®Šå‘½åç©ºé—´ï¼Œè¿™ä¸ªå‘½åç©ºé—´åŒ…å«ç”¨äºæ‰§è¡Œæ„å»ºå‡½æ•°ç‰¹å®šå¸¸è§„æ“ä½œçš„åŠ©æ‰‹æ¨¡æ¿ã€‚ä¾‹å¦‚ä¸ºèµ„æºæˆ–ç±»å¯»æ‰¾å¼•ç”¨ã€ä»¥åŠåˆ›å»ºå¹¶å¯»æ‰¾ç»„ä»¶çš„åŠ©æ‰‹æ¨¡æ¿ã€‚

ç†æƒ³çŠ¶æ€ä¸‹ï¼Œç±»ä¸­çš„èµ„æºå¼•ç”¨å¹¶ä¸å­˜åœ¨ã€‚ç¡¬ç¼–ç èµ„æºå¼•ç”¨å¾ˆè„†å¼±ï¼Œä¼˜é€‰æ–¹æ³•æ˜¯ä½¿ç”¨è“å›¾é…ç½®èµ„æºå±æ€§ã€‚ç„¶è€Œï¼Œä»ç„¶å®Œå…¨æ”¯æŒç¡¬ç¼–ç å¼•ç”¨ã€‚ä¸éœ€è¦åœ¨æ¯æ¬¡æ„é€ å¯¹è±¡æ—¶æœç´¢èµ„æºï¼Œå› æ­¤è¿™äº›æœç´¢åªæ‰§è¡Œä¸€æ¬¡ã€‚ä¸€ä¸ªé™æ€ç»“æ„ä½“å¯ç¡®ä¿åªæ‰§è¡Œä¸€æ¬¡èµ„æºæœç´¢ï¼š`ConstructorHelpers::FObjectFinder` é€šè¿‡ *StaticLoadObject* ä¸ºç‰¹å®šçš„ UObject å¯»æ‰¾å¼•ç”¨ã€‚å®ƒå¸¸ç”¨äºå¼•ç”¨å­˜å‚¨åœ¨å†…å®¹åŒ…ä¸­çš„èµ„æºã€‚å¦‚æœªæ‰¾åˆ°å¯¹è±¡ï¼Œ åˆ™æŠ¥å‘Šå¤±è´¥ã€‚

```C++,
    ATimelineTestActor::ATimelineTestActor()
    {
        // è¿›è¡Œä¸€æ¬¡æ€§åˆå§‹åŒ–çš„ç»“æ„
        struct FConstructorStatics
        {
            ConstructorHelpers::FObjectFinder<UStaticMesh> Object0;
            FConstructorStatics()
            :Object0(TEXT("StaticMesh'/Game/UT3/Pickups/Pickups/Health_Large/Mesh/S_Pickups_Base_Health_Large.S_Pickups_Base_Health_Large'"))
            {
            }
        };
        static FConstructorStatics ConstructorStatics;

        // å±æ€§åˆå§‹åŒ–
        StaticMesh = ConstructorStatics.Object0.Object;
    }
```

ç±»å¼•ç”¨ä½¿ç”¨ *ConstructorHelpers::FClassFinder* ä¸ºç‰¹å®šçš„ UClass å¯»æ‰¾å¼•ç”¨ã€‚å¦‚ç±»æœªæ‰¾åˆ°ï¼Œåˆ™æŠ¥å‘Šå¤±è´¥ã€‚

```C++,
    APylon::APylon(const class FObjectInitializer& ObjectInitializer)
    :Super(ObjectInitializer)
    {
        // è¿›è¡Œä¸€æ¬¡æ€§åˆå§‹åŒ–çš„ç»“æ„
        static FClassFinder<UNavigationMeshBase> ClassFinder(TEXT("class'Engine.NavigationMeshBase'"));
        if (ClassFinder.Succeeded())
        {
            NavMeshClass = ClassFinder.Class;
        }
        else
        {
            NavMeshClass = nullptr;
        }
    }
```

åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œå¯åªä½¿ç”¨ USomeClass::StaticClass()ï¼Œç»•å¼€å¤æ‚çš„å…¨éƒ¨ ClassFinderã€‚ä¾‹å¦‚ï¼Œåœ¨å¤šæ•°æƒ…å†µä¸‹å‡å¯ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š

```C++
NavMeshClass = UNavigationMeshBase::StaticClass();
```

å¯¹è·¨æ¨¡å—çš„å¼•ç”¨è€Œè¨€ï¼Œä½¿ç”¨ ClassFinder æ³•è¾ƒå¥½ã€‚


åŠ è½½å¹¶è®¾ç½®æè´¨ï¼š

```C++,
    // Find assets
    static ConstructorHelpers::FObjectFinder<UStaticMesh> ofMesh(TEXT("StaticMesh'/Game/StaticMeshes/Shape_Cube.Shape_Cube'"));
    static ConstructorHelpers::FObjectFinder<UMaterial> ofMat(TEXT("Material'/Game/Materials/M_Ray.M_Ray'"));

    m_pMesh = CreateDefaultSubobject<UStaticMeshComponent>(TEXT("Mesh"));
    m_pMesh->SetCollisionProfileName(TEXT("NoCollision"));

    if (ofMesh.Succeeded() &&
        ofMat.Succeeded())
    {
        m_pMesh->SetStaticMesh(ofMesh.Object);
        m_pMesh->SetRelativeLocation(FVector(0.0f, 0.0f, -50.0f));
        m_pParentMat = ofMat.Object;
    }
```

åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œå¯åªä½¿ç”¨ USomeClass::StaticClass()ï¼Œç»•å¼€å¤æ‚çš„å…¨éƒ¨ ClassFinderã€‚ä¾‹å¦‚ï¼Œåœ¨å¤šæ•°æƒ…å†µä¸‹å‡å¯ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š

```C++
NavMeshClass = UNavigationMeshBase::StaticClass();
```

å¯¹è·¨æ¨¡å—çš„å¼•ç”¨è€Œè¨€ï¼Œä½¿ç”¨ ClassFinder æ³•è¾ƒå¥½ã€‚

ä»¥ä¸‹ä»£ç ç‰‡æ®µç¤ºèŒƒä½¿ç”¨ LoadObject å’Œ  åŠ è½½é™æ€ç½‘ç»œèµ„äº§ï¼š

```C++,
    UStaticMeshComponent* VisualMesh;

    VisualMesh = CreateDefaultSubobject<UStaticMeshComponent>(TEXT("Mesh"));
    VisualMesh->SetupAttachment(RootComponent);

    UStaticMesh *mesh = LoadObject<UStaticMesh>(nullptr, TEXT("/Engine/StarterContent/Shapes/Shape_Cube"));
    if (mesh != nullptr) {
        VisualMesh->SetStaticMesh(mesh);
        VisualMesh->SetRelativeLocation(FVector(0.0f, 0.0f, 0.0f)); 
    }

    static ConstructorHelpers::FObjectFinder<UStaticMesh> 
    CubeVisualAsset(TEXT("/Engine/StarterContent/Shapes/Shape_Cube"));
    // "/Game/Engine Content/StarterContent/Shapes/Shape_Cube.Shape_Cube";

    if (CubeVisualAsset.Succeeded()) 
    { 
        VisualMesh->SetStaticMesh(CubeVisualAsset.Object); 
        VisualMesh->SetRelativeLocation(FVector(0.0f, 0.0f, 0.0f)); 
    }
```

ä»¥ä¸‹ä»£ç ç‰‡æ®µæ¼”ç¤ºå¦‚ä½•åŠ è½½è“å›¾ç±»ã€åŠ¨ç”»è“å›¾ã€éª¨éª¼è“å›¾ã€‚ä½¿ç”¨ç¬¬ä¸‰äººç§°æ¨¡æ¿åˆ›å»º C++ å·¥ç¨‹å’Œè“å›¾å·¥ç¨‹æœ‰äº›ç»“æ„å·®åˆ«ï¼Œå­˜æ”¾ç±»å¯¹è±¡çš„ç›®å½•åˆ†åˆ«æ˜¯ ThirdPersonCPP å’Œ FirstPersonBPï¼Œè™½æ ¼å¼è¿˜æ˜¯èµ„äº§æ–‡ä»¶ç±»å‹ï¼Œä½†å†…å®¹è‚¯å®šæ˜¯æœ‰å·®åˆ«çš„ã€‚

æ³¨æ„ï¼ŒåŠ è½½åŠ¨ç”»èµ„äº§æ—¶ï¼Œå› ä¸ºæ˜¯è“å›¾ç±»ï¼Œå¤šäº†åç¼€ ThirdPerson_AnimBP -> ThirdPerson_AnimBP_Cã€‚

```C++,
    ARespawnPlayerGameMode::ARespawnPlayerGameMode()
    {
        //å°†é»˜è®¤Pawnç±»è®¾ç½®ä¸ºå·²ç»˜åˆ¶è“å›¾çš„è§’è‰²
        static ConstructorHelpers::FClassFinder<APawn> 
            PlayerPawnBPClass(TEXT("/Game/ThirdPersonCPP/Blueprints/ThirdPersonCharacter"));
            // C:/Unreal Projects/TpCPP/Content/ThirdPersonCPP/Blueprints/ThirdPersonCharacter.uasset
            // PlayerPawnBPClass(TEXT("PawnBlueprint'/Game/FirstPersonBP/Blueprints/FirstPersonCharacter'"));
            // C:/Unreal Projects/Fp/Content/FirstPersonBP/Blueprints/FirstPersonCharacter.uasset
        if (PlayerPawnBPClass.Class != NULL)
        {
            DefaultPawnClass = PlayerPawnBPClass.Class;
        }
    }

    ARespawnPlayerCharacter::ARespawnPlayerCharacter()
    {
        // ...
        // æ³¨æ„ï¼šç½‘æ ¼ä½“ç»„ä»¶ä¸Šå¼•ç”¨çš„éª¨éª¼ç½‘æ ¼ä½“å’ŒåŠ¨ç”»è“å›¾ï¼ˆä»ACharacterç»§æ‰¿ï¼‰ 
        // æ˜¯åœ¨åä¸ºMyCharacterçš„æ¨å¯¼è“å›¾èµ„äº§ä¸­è®¾ç½®çš„ï¼ˆä»¥é¿å…åœ¨C++ä¸­ç›´æ¥å¼•ç”¨å†…å®¹ï¼‰
        // Note: The skeletal mesh and anim blueprint references on the Mesh component (inherited from Character) 
        // are set in the derived blueprint asset named MyCharacter (to avoid direct content references in C++)
        static ConstructorHelpers::FObjectFinder<USkeletalMesh>
            SkeletalMeshAsset(TEXT("SkeletalMesh'/Game/Mannequin/Character/Mesh/SK_Mannequin.SK_Mannequin'"));
            // C:/Unreal Projects/Tp/Content/Mannequin/Character/Mesh/SK_Mannequin.uasset
        GetMesh()->SetSkeletalMesh(SkeletalMeshAsset.Object);
        GetMesh()->SetRelativeLocation(FVector(0.0f, 0.0f, -97.0f));
        GetMesh()->SetRelativeRotation(FQuat(FRotator(0.0f, 270.0f, 0.0f)));
        static ConstructorHelpers::FObjectFinder<UAnimBlueprintGeneratedClass>
            AnimInstanceAsset(TEXT("AnimBlueprint'/Game/Mannequin/Animations/ThirdPerson_AnimBP.ThirdPerson_AnimBP_C'"));
            // C:/Unreal Projects/Tp/Content/Mannequin/Animations/ThirdPerson_AnimBP.uasset
        GetMesh()->SetAnimInstanceClass(AnimInstanceAsset.Object);
    }
```

## âš¡ Data Driven æ•°æ®é©±åŠ¨çš„æ¸¸æˆæ€§
- æ•°æ®é©±åŠ¨æ¸¸æˆæ€§å…ƒç´  https://docs.unrealengine.com/4.27/zh-CN/InteractiveExperiences/DataDriven/

åšè¿‡æ¸¸æˆçš„åº”è¯¥éƒ½æ¸…æ¥šï¼Œå¦‚æœæ¸¸æˆç¨å¾®æœ‰ç‚¹è§„æ¨¡ï¼Œé‚£ä¹ˆä½¿ç”¨æ•°æ®é©±åŠ¨æ¥åšæ¸¸æˆä¸€èˆ¬æ˜¯å¿…ä¸å¯å°‘çš„ä¸€æ­¥ï¼Œä¸€èˆ¬ä¹Ÿå°±æ˜¯ç­–åˆ’é€šè¿‡æœ¬è¡¨çš„æ–¹å¼æ¥è§£å†³ã€‚ä¸‹é¢æˆ‘ä»¬æ¥ç®€å•è¯´ä¸€ä¸‹ UE4 ä¸­å¦‚ä½•ä½¿ç”¨ DataTable æ¥å®ç°æ•°æ®é©±åŠ¨å¼€å‘ã€‚

é¡¾åæ€ä¹‰ï¼Œæ•°æ®è¡¨å°±æ˜¯ä»¥æœ‰æ„ä¹‰ä¸”æœ‰ç”¨çš„æ–¹å¼å°†å„ç§ç›¸å…³çš„æ•°æ®å½’ç±»çš„è¡¨æ ¼ï¼Œ å…¶ä¸­ï¼Œæ•°æ®å­—æ®µå¯ä»¥æ˜¯ä»»ä½•æœ‰æ•ˆçš„ UObject å±æ€§ï¼ŒåŒ…æ‹¬èµ„äº§å¼•ç”¨ã€‚åœ¨è®¾è®¡å¸ˆå°† CSV æ–‡ä»¶å¯¼å…¥æ•°æ®è¡¨å‰ï¼Œç¨‹åºå‘˜å¿…é¡»åˆ›å»ºè¡Œå®¹å™¨ä»¥æŒ‡ç¤ºå¼•æ“å¦‚ä½•è§£é‡Šæ•°æ®ã€‚ è¿™äº›æ•°æ®è¡¨åŒ…å«äº†åˆ—åï¼Œè¿™äº›åˆ—åå’ŒåŸºäºä»£ç çš„ UStruct ç»“æ„ä»¥åŠå®ƒçš„ï¼ˆå­ï¼‰å˜é‡ä¸€ä¸€å¯¹åº”ï¼Œ è¿™ä¸ª UStruct çš„ç»“æ„å¿…é¡»ç»§æ‰¿è‡ª FTableRowBase æ‰å¯ä»¥è¢«å¯¼å…¥å™¨è¾¨è¯†ã€‚



# ğŸŒŸ Physics ç‰©ç†ç³»ç»Ÿ
- Physics https://docs.unrealengine.com/4.27/zh-CN/InteractiveExperiences/Physics/

è™šå¹»å¼•æ“é»˜è®¤ä½¿ç”¨ PhysX æ¥é©±åŠ¨å®ƒçš„ç‰©ç†æ¨¡æ‹Ÿè®¡ç®—å¹¶æ‰§è¡Œæ‰€æœ‰çš„ç¢°æ’è®¡ç®—ã€‚ç‰©ç†å¼•æ“å­ç³»ç»Ÿæä¾›äº†æ‰§è¡Œå‡†ç¡®çš„ç¢°æ’æ£€æµ‹ä»¥åŠæ¨¡æ‹Ÿä¸–ç•Œä¸­å¯¹è±¡ä¹‹é—´çš„ç‰©ç†äº’åŠ¨çš„åŠŸèƒ½ã€‚

ä½¿ç”¨ NVIDIA APEX å·¥å…·ç»„åˆ›å»ºå’Œå¯¼å…¥å¯ç ´åç‰©ï¼Œè™šå¹»ç¼–è¾‘å™¨å¯å¯¼å…¥ .APX å’Œ .APB ä¸¤ç§ Nvidia PhysX APEX æ–‡ä»¶æ ¼å¼ã€‚å¸ƒæ–™å’Œå¯ç ´åç½‘æ ¼ä½“å‡å¯å¯¼å‡ºè¿™ä¸¤ç§æ–‡ä»¶ç±»å‹ï¼Œä½† Content Browser åªèƒ½å¯¼å…¥å¯ç ´åç½‘æ ¼ä½“ã€‚å¸ƒæ–™èµ„æºé¡»é€šè¿‡ Persona å¯¼å…¥ã€‚

## âš¡ Collision ç¢°æ’æ£€æµ‹
- Collision ç¢°æ’æ¦‚è¿° https://docs.unrealengine.com/4.27/zh-CN/InteractiveExperiences/Physics/Collision/Overview/
- ç¢°æ’å“åº”å‚è€ƒ https://docs.unrealengine.com/4.27/zh-CN/InteractiveExperiences/Physics/Collision/Reference/
- Collision Filtering By James Golding https://www.unrealengine.com/en-US/blog/collision-filtering
- Traces with Raycasts https://docs.unrealengine.com/4.27/en-US/InteractiveExperiences/Tracing/
- Unreal Engine Physics Essentials by Katax Emperore Devin Sherry

è™šå¹»å¼•æ“ 4 åœ¨è¿è¡Œæ—¶å¤„ç†ç¢°æ’å’Œå…‰çº¿æŠ•å°„çš„åŸºç¡€ç”±ä¸¤ç§å“åº”æ¨¡å‹å†³å®šï¼š

- Collision Responses ç¢°æ’å“åº”ï¼Œå†…ç½®é€šé“ç±»å‹ï¼šWorldStatic, WorldDynamic, Pawn, PhysicsBody, Vehicle, Destructibleï¼›
- Trace Responses è¿½è¸ªå“åº”ä½¿ç”¨å…‰çº¿æŠ•å°„è¿›è¡Œæ£€æµ‹ï¼Œå†…ç½®é€šé“ç±»å‹ï¼šVisibility, Cameraï¼›

è¿½è¸ªå“åº”æè¿°å¯¹è±¡åœ¨ä¸è·Ÿè¸ªäº¤äº’æ—¶åº”å¦‚ä½•ååº”ï¼Œå…‰çº¿æŠ•å°„è¿›è¡Œæ£€æµ‹ã€‚å¯¹è±¡å¯ä»¥é€‰æ‹©é˜»æ­¢ã€é‡å ç”šè‡³å¿½ç•¥æ¥è‡ªç‰¹å®šæºçš„è·Ÿè¸ªã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæœ‰ä¸¤ç§ä¸åŒçš„è·Ÿè¸ªå“åº”ï¼š

- Visibility å¯è§æ€§è·Ÿè¸ªï¼šæŒ‡å®šä»ä¸€ä¸ªä½ç½®åˆ°å¦ä¸€ä¸ªä½ç½®ã€‚
- Camera æ‘„å½±æœºè·Ÿè¸ªï¼šè¿™ä¸å¯è§æ€§è·Ÿè¸ªå“åº”ç›¸ä¼¼ï¼Œä½†åœ¨ä½¿ç”¨æ‘„å½±æœºçš„å…‰çº¿æŠ•å°„æ—¶åº”ä½¿ç”¨æ­¤å“åº”ã€‚

è¿½è¸ªå“åº”çš„åŸç†åŸºæœ¬ç›¸åŒï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯è¿½è¸ªï¼ˆå…‰çº¿æŠ•å°„ï¼‰æœ¬èº«å¯ä»¥å®šä¹‰ä¸ºä¸€ç§è¿½è¸ªå“åº”ç±»å‹ï¼Œå› æ­¤ Actor å¯ä»¥æ ¹æ®å…¶è¿½è¸ªå“åº”é˜»æŒ¡æˆ–å¿½ç•¥ã€‚

åœ¨ HMD è®¾å¤‡å¯ç”¨çš„æ¡ä»¶ä¸‹ï¼Œä½¿ç”¨ KismetSystemLibrary::LineTraceByChannel è¿›è¡Œå…‰çº¿ç¢°æ’è¿½è¸ªï¼Œå¹¶è¿”å›é¦–ä¸ªé˜»æŒ¡å‘½ä¸­ï¼Œåªè¿”å›å¯¹ç‰¹å®šè¿½è¸ªé€šé“å“åº”çš„å¯¹è±¡ã€‚

å¯¹äºä¸€ä¸ªæ¸¸æˆç³»ç»Ÿæ¥è¯´ï¼Œå¯¹è±¡æ•°é‡å¯ä»¥æ˜¯æå…¶åºå¤§çš„ã€‚ä½¿ç”¨å¯¹è±¡ç±»å‹é€šé“çš„ç›®çš„å°±æ˜¯è¿›è¡Œç›¸å…³æ€§åˆ†ç±»ï¼Œé¿å…å¤„ç†ä¸ç›¸å…³çš„å¯¹è±¡ã€‚

å‡è®¾ï¼Œæˆ‘ä»¬åœ¨æ¸¸æˆä¸­å®šä¹‰äº†ä¸¤ä¸ª Trace Channelï¼Œä¸€ä¸ªè§†çº¿é€šé“ï¼Œå¦ä¸€ä¸ªä¸ºæ­¦å™¨é€šé“ã€‚ä¸€å µç –å¢™å¯ä»¥åŒæ—¶é˜»æŒ¡è¿™ä¸¤ç§æƒ…å†µï¼ŒçŒæœ¨å¯ä»¥é˜»æŒ¡è§†çº¿ä½†ä¸èƒ½é˜»æŒ¡æ­¦å™¨ï¼Œé˜²å¼¹ç»ç’ƒå¯ä»¥é˜»æŒ¡æ­¦å™¨ä½†ä¸èƒ½é˜»æŒ¡è§†çº¿ã€‚åœ¨æ‰§è¡Œæ­¤ç±»æŸ¥è¯¢æ—¶ï¼ŒæŒ‡å®šä¸€ä¸ªè·Ÿè¸ªé€šé“ã€‚

è™½ç„¶ï¼Œå“åº”æ–¹å¼åªæœ‰ä¸‰ç§ï¼Œä½†æ˜¯ä¸¤ä¸ªå¯¹è±¡å³å°†äº¤å ï¼Œç¢°æ’æ£€æµ‹éœ€è¦ç¡®å®šå“ªäº›äº‹ä»¶ä¼šè¢«æ¿€å‘ï¼Ÿ

é¦–å…ˆè¦çŸ¥é“çš„æ˜¯ï¼Œå½“ä½ è¯´æŸç‰©åº”è¯¥ç¢°æ’æ—¶ï¼Œå¿…é¡»é€‰æ‹©æ˜¯å¦èƒ½ç©¿é€å®ƒã€‚å¦‚æœç –å¢™å°±åº”è¯¥é˜»æŒ¡ç©å®¶ï¼Œå¦‚æœ è§¦å‘å™¨å°†å’Œç©å®¶é‡å ï¼Œå¹¶å…è®¸ä»–ä»¬é€šè¿‡ã€‚ä¸¤è€…éƒ½ä¼šç”Ÿæˆç›¸åº”çš„äº‹ä»¶ï¼Œåˆ†åˆ«ä¸º Hit å‘½ä¸­å’Œ Overlap é‡å ï¼Œè¿™ä¸¤ä¸ªæ¦‚å¿µæ˜¯ä¸€ä¸ªé‡è¦çš„åŒºåˆ«ã€‚

å¤„ç†ä¸¤ä¸ªåŒæ—¶è¿åŠ¨çš„å¯¹è±¡çš„ç¢°æ’è¦å¤æ‚ç‚¹ï¼ŒUE4 ä¸­æ¯ä¸ªå¯¹è±¡éƒ½æœ‰è‡ªå·±çš„ Object Channel è®¾ç½®ï¼Œè¿˜æœ‰å“åº”å…¶å®ƒå„ç§ç±»å‹å¯¹è±¡çš„ Object Channels è®¾ç½®ã€‚å½“ä¸¤ä¸ªå¯¹è±¡äº¤å ï¼Œæœ€ç»ˆå¦‚ä½•å“åº”å–å†³äºä¸¤è€…çš„è®¾ç½®ã€‚

ä»¥çˆ†ç‚¸ä¸ºä¾‹å­ï¼Œå¸Œæœ›å¿«é€Ÿæ‰¾åˆ°æŸä¸ªåŠå¾„å†… Pawn æˆ– PhysicsBody ç±»å‹çš„æ‰€æœ‰å¯¹è±¡ã€‚æ‰§è¡Œæ­¤ç±»æŸ¥è¯¢æ—¶ï¼Œå¯ä»¥æŒ‡å®šå¤šä¸ªå¯¹è±¡é€šé“ã€‚

é‚£ä¹ˆå‚è€ƒä¸‹è¡¨ï¼Œç«–ç›´æ–¹å‘è¡¨ç¤º A å¯¹è±¡è®¾ç½®å¯¹ B å¯¹è±¡çš„å“åº”æ–¹å¼ï¼Œæ¨ªå‘è¡¨ç¤º B å¯¹è±¡å¯¹ A å¯¹è±¡è®¾ç½®çš„å“åº”æ–¹å¼ï¼š

    |         | Ignore | Overlap |  Block  |
    |---------|--------|---------|---------|
    | Ignore  | Ignore | Ignore  | Ignore  |
    | Overlap | Ignore | Overlap | Overlap |
    | Block   | Ignore | Overlap | Block   |

ä¸Šè¡¨å¯èƒ½è¿˜ä¸èƒ½æ¸…æ™°ï¼Œå¯ä»¥ç”¨å…·ä½“çš„å¯¹è±¡ç±»å‹é€šé“æ›¿æ¢ A å’Œ Bï¼Œæ„æ€æ˜¯ä¸€æ ·çš„ï¼Œå°±æ˜¯å½’å±äºä¸¤ä¸ªç±»å‹é€šé“çš„å¯¹è±¡åœ¨æ£€æµ‹ç¢°æ’æ—¶ï¼Œç»“æœå¦‚ä½•å“åº”ã€‚


```js
// è®¾ç½®æ˜¯å¦å¼€å¯ç‰©ç†æ¨¡æ‹Ÿ
Cube->SetSimulatePhysics(false);

// å¼€å¯ Generated Hit Event
Cube->SetNotifyRigidBodyCollision(true);

// å¼€å¯CCD Continuous collision detection (CCD) è¿ç»­å¼ç¢°æ’æ£€æµ‹
Cube->BodyInstance.SetUseCCD(true);

// å¼€å¯Generate Overlap Events
Cube->SetGenerateOverlapEvents(true);

// è®¾ç½®ç¢°æ’é¢„è®¾
Cube->SetCollisionProfileName(TEXT("OverlapAll"));
//Cube->SetCollisionResponseToAllChannels(ECR_Overlap);

// è®¾ç½®ç¢°æ’å“åº”è®¾ç½®
Cube->SetCollisionEnabled(ECollisionEnabled::QueryAndPhysics);

// ç»‘å®šå‡½æ•°
Cube->OnComponentBeginOverlap.AddDynamic(this, &ACollisionActor::OnOverlapBegin);

// ç»‘å®šå‡½æ•° ä½¿ç”¨å§”æ‰˜
FScriptDelegate OverlapEndDelegate;
OverlapEndDelegate.BindUFunction(this, TEXT("OnOverlapEnd"));
Cube->OnComponentBeginOverlap.Add(OverlapEndDelegate);

// ç»‘å®šç¢°æ’å‡½æ•°
Cube->OnComponentHit.AddDynamic(this, &ACollisionActor::OnHit);
```

å…³äºç¢°æ’çš„å¤„ç†æ–¹å¼ï¼Œéœ€è¦è®°ä½å‡ ç‚¹è§„åˆ™ï¼š

- è®¾ç½®ä¸º `Block` çš„ä¸¤ä¸ªï¼ˆæˆ–æ›´å¤šï¼‰Actor ä¹‹é—´è‡ªç„¶å‘ç”Ÿé˜»æŒ¡è¡Œä¸ºã€‚ä½†æ˜¯ï¼ŒEvent Hit éœ€è¦å¯ç”¨ Simulation Generates Hit Eventsï¼Œè¯¥åŠŸèƒ½åœ¨è“å›¾ã€å¯ç ´åç‰© Actorã€è§¦å‘å™¨ç­‰å¤„ä½¿ç”¨ã€‚
- å°† Actors è®¾ç½®ä¸º `Overlap` å°±åƒè®¾ç½®ä¸º `Ignore`ï¼Œå¦‚æœæ²¡æœ‰ Generate Overlap Eventsï¼Œåˆ™äºŒè€…åŸºæœ¬ç›¸åŒã€‚
- å¯¹äºå½¼æ­¤é˜»æŒ¡çš„ä¸¤ä¸ªæˆ–æ›´å¤šæ¨¡æ‹Ÿå¯¹è±¡ï¼Œå®ƒä»¬éƒ½éœ€è¦è®¾ç½®é˜»æŒ¡ç›¸åº”çš„å¯¹è±¡ç±»å‹ã€‚
- å¯¹äºä¸¤ä¸ªæˆ–æ›´å¤šæ¨¡æ‹Ÿå¯¹è±¡ï¼šå¦‚æœä¸€ä¸ªè®¾ç½®ä¸º `Overlap`ï¼Œå¦ä¸€ä¸ªè®¾ç½®ä¸º `Block`ï¼Œåˆ™å‘ç”Ÿé‡å ï¼Œè€Œä¸ä¼šå‘ç”Ÿé˜»æŒ¡ã€‚
- å³ä½¿ä¸€ä¸ªå¯¹è±¡ä¼š `Block` å¦ä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿ å¯ä»¥ ç”Ÿæˆé‡å äº‹ä»¶ï¼Œå°¤å…¶æ˜¯é«˜é€Ÿè¿è¡Œçš„å¯¹è±¡ã€‚
- ä¸å»ºè®®ä¸€ä¸ªå¯¹è±¡åŒæ—¶æ‹¥æœ‰ç¢°æ’å’Œé‡å äº‹ä»¶ï¼Œè™½ç„¶å¯ä»¥ï¼Œä½†éœ€è¦æ‰‹åŠ¨å¤„ç†çš„éƒ¨åˆ†å¤ªå¤šã€‚
- å¦‚æœä¸€ä¸ªå¯¹è±¡è®¾ç½®ä¸º `Ignore`ï¼Œå¦ä¸€ä¸ªè®¾ç½®ä¸º `Overlap`ï¼Œåˆ™ä¸ä¼šè§¦å‘é‡å äº‹ä»¶ã€‚

ä»¥æ­¦å™¨çš„å‘å°„ç‰©ä¸ºä¾‹ï¼Œç¢°æ’è®¾ç½®åŸåˆ™å°±æ˜¯åªå¯¹ä½œç”¨å¯¹è±¡è§¦å‘ Overlap äº‹ä»¶ï¼Œå…¶å®ƒå¯¹è±¡å¿½ç•¥ï¼Œæˆ–è€… Blockï¼Œè¿™æ ·å¯ä»¥æä¾›è¿è¡Œæ•ˆç‡ï¼Œå°½é‡é¿å…è¿‡å¤šçš„æ£€æµ‹è¿ç®—ã€‚

è™šå¹»å¼•æ“è‡ªå¸¦äº†æ•°ä¸ªé¢„è®¾ç¢°æ’é€šé“é…ç½®ï¼Œ(WorldStatic, WorldDynamic, Pawn, PhysicsBody, Vehicle, Destructible)ä¸è¿‡ï¼Œå¼•æ“ä¹Ÿæ”¯æŒæ¸¸æˆé¡¹ç›®ä½¿ç”¨è‡ªå®šä¹‰ 18 ä¸ªå¯¹è±¡ç±»å‹é€šé“ï¼Œæˆ–è€… 18 ä¸ªè¿½è¸ªé€šé“ç±»å‹ã€‚

åˆ›å»ºè‡ªå®šä¹‰ç¢°æ’é€šé“ï¼Œå¹¶åŠ è½½åˆ°å¯¹è±¡å®ä¾‹ä¸Šä½¿ç”¨ã€‚æ‰“å¼€é¡¹ç›®è®¾ç½® Project Settings -> Engine -> Collisionï¼Œå¯ä»¥å±•å¼€é¢„è®¾ Preset æŸ¥çœ‹ç°æœ‰çš„å„ç§å†…ç½®é€šé“çš„é…ç½®ã€‚åˆ—å¦‚ï¼Œ*OverlapAll* è®¾ç½®å¯¹æ‰€æœ‰å…¶å®ƒæ‰€æœ‰å¯¹è±¡é€šé“éƒ½è§¦å‘ Overlap äº‹ä»¶ï¼Œåªè¦ç¢°è§¦å¯¹è±¡ä¸æ˜¯è®¾ç½®ä¸º `Ignore` å“åº”æ–¹å¼ã€‚

æœ€æ¥è¿‘çš„å‘å°„ç‰©è®¾ç½®éœ€æ±‚é¢„è®¾å°±æ˜¯ *Ragdoll*ï¼Œå®ƒåªå¯¹ Pawn å¯¹è±¡å“åº” `Overlap` äº‹ä»¶ï¼Œå³å¯¹ç©å®¶è‡ªèº«æ˜¯å¯ä»¥ç©¿è¿‡ï¼Œå¯¹å…¶å®ƒæ‰€æœ‰å¯¹è±¡å“åº” `Block`ï¼Œå³é˜»æŒ¡ç»§ç»­è¿åŠ¨ï¼Œè§¦å‘ `Hit` äº‹ä»¶ã€‚

è‡ªå®šä¹‰é€šé“é…ç½®æœ‰ä¸¤ç§ï¼š

- Object Channels å¯¹è±¡é€šé“ï¼›
- Trace Channels è¿½è¸ªé€šé“ï¼›

æ–°å»ºå¯¹è±¡é€šé“ï¼Œå°†æ–°ç¢°æ’é€šé“å‘½åä¸º *Projectile*ï¼Œç¡®ä¿å°†é»˜è®¤å“åº”ï¼ˆDefault Responseï¼‰è®¾ç½®ä¸º Blockï¼Œç„¶åç‚¹å‡»æ¥å—è®¾ç½®ã€‚

åœ¨é¢„è®¾ï¼ˆPresetï¼‰ä¸­æ–°å»ºé…ç½®ï¼ŒåŒæ ·å°†æ–°é…ç½®æ–‡ä»¶å‘½åä¸º *Projectile*ï¼Œå„ä¸ªå¯¹è±¡é€šé“çš„ç¢°æ’é¢„è®¾ä¸º`Block`ï¼Œé™¤ Pawn é€šé“è®¾ç½®ä¸º `Overlap`ï¼Œç„¶åç‚¹å‡»æ¥å—å®Œæˆè®¾ç½®ã€‚æ­¤ç¢°æ’é…ç½®æ–‡ä»¶å°†å‘å°„ç‰©è®¾å®šä¸ºå°†è¢« WorldStatic, WorldDynamic, Pawn, PhysicsBody, Vehicle, Destructible ç­‰é€šé“çš„å¯¹è±¡é˜»æŒ¡ã€‚ä½†æ˜¯ï¼Œè®¾å®šå‘å°„ç‰©ä¸ Pawn é‡å ï¼Œè§¦å‘ Overlap äº‹ä»¶ã€‚

åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œåœ¨åé¢æ·»åŠ ä»¥ä¸‹ä»£ç ï¼Œä½¿ç”¨*SetCollisionProfileName* æ–¹æ³•åŠ è½½ç¢°æ’é…ç½®æ–‡ä»¶ã€‚

```C++
// ç”¨çƒä½“è¿›è¡Œç®€å•çš„ç¢°æ’å±•ç¤ºã€‚
CollisionComponent = CreateDefaultSubobject<USphereComponent>(TEXT("SphereComponent"));
// å°†çƒä½“çš„ç¢°æ’é…ç½®æ–‡ä»¶åç§°è®¾ç½®ä¸º"Projectile"ã€‚
CollisionComponent->BodyInstance.SetCollisionProfileName(TEXT("Projectile"));
// ç»„ä»¶å‡»ä¸­æŸç‰©æ—¶è°ƒç”¨çš„äº‹ä»¶ã€‚
CollisionComponent->OnComponentHit.AddDynamic(this, &AFPSProjectile::OnHit);
```

å¯¹äºæµ‹è¯•å…³å¡å’Œæ£€è§†åœºæ™¯ï¼š

- é»˜è®¤çš„ï¼Œåœ¨ç¼–è¾‘å™¨ä¸­çš„æ‘„åƒæœºæ˜¯ä¸€ä¸ª Pawnã€‚å› æ­¤å¯ä»¥è¢«è®¾ç½®ä¸ºé˜»æŒ¡ Pawn çš„ä»»ä½•å¯¹è±¡é˜»æŒ¡ã€‚
- åœ¨ç¼–è¾‘å™¨ä¸­æ¨¡æ‹Ÿæ‘„åƒæœºåœ¨å¤„ç†ä»»ä½•äº‹åŠ¡ä¹‹å‰ä¸æ˜¯ Pawnï¼Œå®ƒå¯ä»¥è‡ªç”±ç©¿è¿‡ä»»ä½•å¯¹è±¡ï¼Œä¸ä¼šé€ æˆä»»ä½•ç¢°æ’æˆ–é‡å äº‹ä»¶ã€‚

ç”¨ä¸€ä¸ª PhysicsBody çƒä½“ï¼Œå’Œä¸€ä¸ª WorldDynamic ç®±ä½“æ¨¡æ‹Ÿå¢™å£æ¥åšè¯´æ˜ï¼Œé€šè¿‡æ›´æ”¹å¦‚ä¸‹ç¢°æ’è®¾ç½®ï¼Œå¯ä»¥å¾—å‡ºå¤šç§è¡Œä¸ºï¼š

- ç¢°æ’ Collision
- ç¢°æ’å’Œæ¨¡æ‹Ÿç”Ÿæˆå‘½ä¸­äº‹ä»¶ Generates Hit Events
- é‡å å’Œå¿½ç•¥ Overlap & Ignore
- é‡å å’Œç”Ÿæˆé‡å äº‹ä»¶ Overlap & Generates Overlap Events

ä¸å¯ä»¥éšæ—¶è§¦å‘çš„ç¢°æ’ä¸åŒï¼Œé‡å äº‹ä»¶æ˜¯ ReceiveBeginOverlap å’Œ ReceiveEndOverlapï¼Œä»…åœ¨ç‰¹å®šæƒ…å†µä¸‹è§¦å‘ã€‚

ä¸ºäº†ä½¿é‡å å‘ç”Ÿï¼Œä¸¤ä¸ª Actor éƒ½éœ€è¦å¯ç”¨ Generate Overlap Eventsï¼Œè¿™æ˜¯ä¸ºæ•ˆæœè€ƒè™‘ã€‚å¦‚æœçƒä½“å’Œç®±ä½“éƒ½å¸Œæœ›åœ¨æˆ‘ä»¬ç§»åŠ¨çƒä½“æˆ–ç®±ä½“æ—¶å‘ç”Ÿé‡å ï¼Œåˆ™æ‰§è¡Œé‡å æŸ¥è¯¢ä»¥ç¡®è®¤æ˜¯å¦éœ€è¦è§¦å‘ä»»ä½•äº‹ä»¶ã€‚

å¦‚æœç®±ä½“ä¸å¸Œæœ›åœ¨ç§»åŠ¨æ—¶å‘ç”Ÿé‡å ï¼Œåˆ™ä¸æ‰§è¡Œé‡å æŸ¥è¯¢ã€‚ä½†ç°åœ¨ï¼Œå¯ä»¥ä¸çƒä½“é‡å ï¼Œå› æ­¤çƒä½“éœ€è¦ tick äº‹ä»¶ï¼Œå¹¶é€å¸§æ£€æŸ¥æ˜¯å¦æœ‰é‡å ä»¥é˜²æœ‰å¯¹è±¡ä¸å®ƒä»¬ç›¸æ’ã€‚

- PhysicsBody çƒä½“è®¾ç½®å¯¹ WorldDynamic Actorï¼ˆæ¯”å¦‚å¢™å£ï¼‰äº§ç”Ÿ `Overlap`ï¼Œå®ƒä¼šåœ¨å‘ç”Ÿé‡å æ—¶é’ˆå¯¹è‡ªå·±ç”Ÿæˆäº‹ä»¶ã€‚
- WorldDynamic å¢™å£è®¾ç½®å¯¹ PhysicsBody Actorï¼ˆè¿™æ˜¯çƒä½“çš„ç±»å‹ï¼‰äº§ç”Ÿ `Block`ã€‚

å¦‚ä¸Šæ‰€è¿°ï¼Œä¸¤ä¸ª Actor éƒ½éœ€è¦è®¾ç½®ä¸º `Block` å½¼æ­¤ç›¸åº”çš„å¯¹è±¡ç±»å‹æ‰ä¼šæœ‰ç¢°æ’ã€é˜»æŒ¡ã€‚ä½†æ˜¯ï¼Œè¿™é‡Œä¼šå‘ç”Ÿ `Overlap`ï¼Œå¹¶è§¦å‘çƒä½“å’Œç®±ä½“çš„äº‹ä»¶ã€‚

ä¸¤ä¸ªç‰©ç†å½¢ä½“çš„å¯¹è±¡ç±»å‹ Object Type å’Œç¢°æ’å“åº” Collision Responses éƒ½å¾ˆé‡è¦ï¼Œå®ƒä»¬å†³å®šäº†äº¤äº’äº‹ä»¶ä¼šä¸ä¼šå‘ç”Ÿã€‚

ä»¥ä¸‹æ˜¯ç‰©ç†å½¢ä½“ *BodyInstance* ä¸Šçš„ Collision å±æ€§ï¼š

Object Type è®¾ç½®å½“å‰å¯¹è±¡é€šé“ç±»å‹ï¼š

- `WorldStatic` åº”ç”¨äºä¸ç§»åŠ¨çš„ Actorï¼Œé™æ€ç½‘æ ¼ä½“æ˜¯æœ€å®¹æ˜“ç†è§£çš„ WorldStatic Actorã€‚
- `WorldDynamic` ç”¨äºå—åˆ° kinematic åŠ¨ç”»æˆ–ä»£ç çš„å½±å“è€Œç§»åŠ¨çš„ Actor ç±»å‹ã€‚ç”µæ¢¯å’Œé—¨æ˜¯ WorldDynamic Actor çš„å…¸å‹ä¾‹å­ã€‚
- `Pawn` ä»»ä½•ç”±ç©å®¶æ§åˆ¶çš„å®ä½“çš„å¯¹è±¡ç±»å‹ï¼Œç©å®¶è§’è‰²æ˜¯ Pawn Actor çš„å…¸å‹ä¾‹å­ã€‚
- `PhysicsBody` ç”±äºç‰©ç†æ¨¡æ‹Ÿè€Œç§»åŠ¨çš„ä»»æ„ Actorã€‚
- `Vehicle` æ­¤ä¸ºè½½å…·çš„é»˜è®¤ç±»å‹ã€‚
- `Destructible` æ­¤ä¸ºå¯ç ´åç‰©ç½‘æ ¼ä½“çš„é»˜è®¤ç±»å‹ã€‚

Collision Responses ç¢°æ’å“åº”è®¾ç½®éœ€è¦å¯¹ä»€ä¹ˆç±»å‹çš„å¯¹è±¡çš„å“åº”æ–¹å¼ï¼Œå¯ä»¥åˆ›å»ºå¤šä¸ªå“åº”é…ç½®ï¼Œåœ¨ Channel ä¸­å¡«å†™è¦å“åº”çš„ Object Typeï¼š

- Ignore æ— è®ºå¦ä¸€ä¸ªç‰©ç†å½¢ä½“çš„ Collision Responses å¦‚ä½•è®¾ç½®ï¼Œæ­¤ç‰©ç†å½¢ä½“éƒ½å°†å¿½ç•¥äº¤äº’äº‹ä»¶ã€‚
- Overlap æ­¤ç‰©ç†å½¢ä½“å°†å‘ç”Ÿé‡å äº‹ä»¶ï¼Œå¦‚æœå¦ä¸€ä¸ªæ˜¯è®¾ç½®ä¸º `Overlap` æˆ– `Block` çš„ç‰©ç†å½¢ä½“ã€‚
- Block æ­¤ç‰©ç†å½¢ä½“å°†å‘ç”Ÿæ’å‡»äº‹ä»¶ï¼Œå¦‚æœå¦ä¸€ä¸ªæ˜¯è®¾ç½®ä¸º `Block` çš„ç‰©ç†å½¢ä½“ã€‚

Object Responses è®¾ç½®å¯¹ä»€ä¹ˆå¯¹è±¡ç±»å‹è¿›è¡Œå“åº”ã€‚

Collision Enabled ç¢°æ’å¯ç”¨æ–¹å¼ï¼š

- NoCollision æ— ç¢°æ’å“åº”
- Query Only (No Physics Collision) åªä¼šè§¦å‘ Overlap äº‹ä»¶ï¼Œæ— åˆšä½“ç¢°æ’å“åº”
- Physics Only (No Query Collision) åªæœ‰åˆšä½“ç¢°æ’å“åº”ï¼Œä¸è§¦å‘ Overlap äº‹ä»¶
- Collision Enabled (Query and Physics ) åˆšä½“ç¢°æ’å“åº”å’Œ Overlap äº‹ä»¶éƒ½å¯ä»¥

Collision Presets ç¢°æ’é¢„è®¾å€¼ï¼Œä¹Ÿå¯ä»¥åœ¨ç›´æ¥å¡«å†™åˆ° Collision Profile Name ä¸­ï¼š

- Default ä½¿ç”¨å·²åœ¨é™æ€ç½‘æ ¼ä½“ç¼–è¾‘å™¨ä¸­åº”ç”¨ç»™é™æ€ç½‘æ ¼ä½“çš„è®¾ç½®ã€‚
- Custom... ä¸ºæ­¤å®ä¾‹è®¾ç½®æ‰€æœ‰è‡ªå®šä¹‰ç¢°æ’è®¾ç½®ã€‚
- NoCollision åœ¨é»˜è®¤æƒ…å†µä¸‹ `WorldStatic` ä¼šé˜»æŒ¡æ‰€æœ‰ Actor å¯¹è±¡ã€‚ã€‚
- BlockAll åœ¨é»˜è®¤æƒ…å†µä¸‹ `WorldStatic` ä¼šé˜»æŒ¡æ‰€æœ‰ Actor å¯¹è±¡ã€‚
- OverlapAll åœ¨é»˜è®¤æƒ…å†µä¸‹ `WorldStatic` ä¸æ‰€æœ‰ Actor å¯¹è±¡é‡å ã€‚
- BlockAllDynamic åœ¨é»˜è®¤æƒ…å†µä¸‹ `WorldDynamic` é˜»æŒ¡æ‰€æœ‰ Actor å¯¹è±¡ã€‚
- OverlapAllDynamic åœ¨é»˜è®¤æƒ…å†µä¸‹ `WorldDynamic` ä¸æ‰€æœ‰ Actor å¯¹è±¡é‡å ã€‚
- IngoreOnlyPawn `WorldDynamic` å¿½ç•¥ Pawn å’Œè½½å…·å¯¹è±¡ã€‚
- OverlapOnlyPawn `WorldDynamic` ä¸ Pawnã€æ‘„åƒæœºå’Œè½½å…·å¯¹è±¡é‡å ã€‚
- Pawn å¯ç”¨äºä»»æ„å¯æ“ä½œè§’è‰²æˆ– AI çš„èƒ¶å›Šä½“ï¼Œå¯¹å¤§å¤šæ•°å¯¹è±¡å“åº” `Block`ã€‚
- Spectator å¿½ç•¥æ‰€æœ‰å…¶ä»– Actor çš„ Pawn å¯¹è±¡ï¼Œå¯¹ `WorldStatic` å“åº”ä»¥ `Block`ã€‚
- CharacterMesh ç”¨äºè§’è‰²ç½‘æ ¼ä½“çš„ Pawn å¯¹è±¡ï¼Œ`Block` å¤§å¤šæ•°å…¶å®ƒå¯¹è±¡ã€‚
- PhysicsActor æ¨¡æ‹Ÿ Actorï¼Œ`Block` å¤§å¤šæ•°å…¶å®ƒå¯¹è±¡ã€‚
- Destructible å¯ç ´åç‰© Actorï¼Œ`Block` å¤§å¤šæ•°å…¶å®ƒå¯¹è±¡ã€‚
- InvisibleWall ä¸å¯è§çš„ `WorldStatic` å¯¹è±¡ï¼Œ`Block` å¤§å¤šæ•°å…¶å®ƒå¯¹è±¡ã€‚
- InvisibleWallDynamic ä¸å¯è§çš„ `WorldStatic` å¯¹è±¡ã€‚
- Trigger ç”¨äºè§¦å‘å™¨çš„ `WorldStatic` å¯¹è±¡ï¼Œè§¦å‘ Overlap äº‹ä»¶ã€‚
- Ragdoll æ¨¡æ‹Ÿéª¨æ¶ç½‘æ ¼ä½“ç»„ä»¶ï¼Œç±»ä¼¼ CharacterMeshã€‚
- Vehicle é˜»æŒ¡è½½å…·ã€`WorldStatic` å’Œ `WorldStatic` çš„è½½å…·å¯¹è±¡ï¼Œ`Block` å¤§å¤šæ•°å…¶å®ƒå¯¹è±¡ã€‚
- UI åœ¨é»˜è®¤æƒ…å†µä¸‹ä¸æ‰€æœ‰ Actor é‡å çš„ `WorldStatic` å¯¹è±¡ï¼Œç±»ä¼¼ Triggerã€‚

åœ¨ç¼–è¾‘ StaticMesh æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å·¥å…·æ  Collision -> Auto Convex Collision è‡ªåŠ¨å‡¸åŒ…ç¢°æ’å·¥å…·åˆ›å»ºä¸€ä¸ªè½®å»“ï¼Œæˆ–è€…ç§»é™¤ç¢°æ’è½®å»“ Remove Collisionã€‚åœ¨ Viewport ä¸­ä½¿ç”¨èœå• Show -> Collision æ˜¾ç¤ºç¢°æ’è½®å»“ï¼Œå¿«æ·é”®  Alt + Cã€‚

å¦å¤–ï¼Œé™¤äº†ä¸€äº›ç®€å•çš„ç¢°æ’æ£€æµ‹è½®å»“ï¼Œè¿˜æœ‰ä¸€ç³»åˆ— K-DOP ç®€å•ç¢°æ’ç”Ÿæˆå™¨ï¼Œè¿™æ˜¯åŒ…å›´ä½“çš„ä¸€ç§ï¼Œæ˜¯ K ç¦»æ•£å¯¼å‘å¤šé¢ä½“ï¼ˆK discrete oriented polytopeï¼‰ çš„ç¼©å†™ï¼ŒK æ˜¯è½´å¯¹é½å¹³é¢çš„æ•°å­—ã€‚å®ƒæŠ“å–è½´å¯¹é½çš„å¹³é¢ï¼Œå°†å…¶å°½åŠ›æ¨å‘ç¦»ç½‘æ ¼ä½“æœ€è¿‘çš„ä½ç½®ã€‚ç»“æœå½¢æ€ç”¨ä½œç¢°æ’å‡¸åŒ…ã€‚åœ¨ Static Mesh Editor ä¸­ï¼ŒK å¯ä¸ºï¼š

- 10 - æ–¹å—æœ‰ 4 æ¡è¾¹å½¢æˆæ–œè§’ - å¯é€‰æ‹© Xã€Y æˆ– Z è½´å¯¹é½çš„è¾¹ã€‚
- 18 - æ–¹å—ä¸­æ‰€æœ‰è¾¹å‡å½¢æˆæ–œè§’ã€‚
- 26 - æ–¹å—ä¸­æ‰€æœ‰è¾¹å’Œè§’å‡å½¢æˆæ–œè§’ã€‚

åœ¨æ¸¸æˆä¸­ï¼Œæœ‰å‡ ä¸ªæ§åˆ¶å°å‘½ä»¤å¯ç”¨äºè·å¾—å…³äºæ¸¸æˆä¸­ç¢°æ’çš„ä¿¡æ¯ï¼Œè¿è¡Œæ¸¸æˆï¼ŒæŒ‰åå‹¾å·/é‡éŸ³ç¬¦é”®å³ ~ æ‰€åœ¨æŒ‰é”®ï¼Œè°ƒå‡ºæ§åˆ¶å°è¾“å…¥æ¡†ï¼Œè¾“å…¥ä¸‹åˆ—å‘½ä»¤ï¼š

- show COLLISION - æ­¤å‘½ä»¤å°†ç”»å‡ºå…³å¡ä¸­ä½¿ç”¨çš„æ‰€æœ‰ç¢°æ’æ¨¡å‹å’Œé˜»æŒ¡ä½“ç§¯ã€‚
- stat game - æ­¤å‘½ä»¤ä¼šå‘ä½ æ˜¾ç¤ºå…³äºå„ç§ä¸åŒç¢°æ’æ‰€ç”¨æ—¶é—´çš„æœ‰ç”¨ç»Ÿè®¡ä¿¡æ¯ã€‚

OnComponentBeginOverlap äº‹ä»¶èŠ‚ç‚¹å„è¾“å‡ºç«¯å£ç”¨é€”å¦‚ä¸‹ï¼š

- OverlappedComponent å½“å‰è§¦å‘äº‹ä»¶çš„ç»„ä»¶ï¼›
- OtherActor ä¸å½“å‰ç»„ä»¶å‘ç”Ÿç¢°æ’çš„ Actor å¯¹è±¡ï¼›
- OtherComponent ä¸å½“å‰ç»„ä»¶å‘ç”Ÿç¢°æ’çš„ç»„ä»¶ï¼›
- OtherBodyIndex 
- bFromSweep 
- SweepResult è¿”å›ä¸€ä¸ª Hit Result ç»“æ„ä½“ï¼›


# ğŸŒŸ Blueprints è“å›¾
- è“å›¾å¯è§†åŒ–è„šæœ¬ https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/Blueprints/
- ä½¿ç”¨è“å›¾ç¼–å†™ç¼–è¾‘å™¨è„šæœ¬ https://docs.unrealengine.com/4.27/zh-CN/ProductionPipelines/ScriptingAndAutomation/Blueprints/
- C++ ä»£ç ä¸è“å›¾ https://docs.unrealengine.com/4.27/-CN/ProgrammingAndScripting/ClassCreation/CodeAndBlueprints/
- C++ ä¸è“å›¾æ€§èƒ½å¹³è¡¡ https://docs.unrealengine.com/4.27/zh-CN/Resources/SampleGames/ARPG/BalancingBlueprintAndCPP/
- Gameplay æ¶æ„ https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/GameplayArchitecture/Classes/
- Creating Blueprints and Editor UI https://learn.unrealengine.com/course/2436619/module/5328666
- è“å›¾å¯è§†åŒ–è„šæœ¬ä¸­çš„å˜é‡å’Œæ‰§è¡Œæµç¨‹ https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/Blueprints/Scripting/
- å‘è“å›¾å…¬å¼€æ¸¸æˆè¿›ç¨‹å…ƒç´  https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/Blueprints/TechnicalGuide/ExtendingBlueprints/
- ç±»åˆ›å»ºåŸºç¡€çŸ¥è¯† https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ClassCreation/
- è“å›¾æ¥å£å¿«é€Ÿå…¥é—¨ https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ActorCommunication/InterfaceQuickStart/
- Math Expression https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/Blueprints/UserGuide/MathNode/
- è“å›¾æµç¨‹æ§åˆ¶èŠ‚ç‚¹ https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/Blueprints/UserGuide/FlowControl/
- èŠ‚ç‚¹çš„è¿æ¥æ“ä½œ https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/Blueprints/BP_HowTo/ConnectingNodes/
- è“å›¾æ“ä½œé€ŸæŸ¥ https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/Blueprints/UserGuide/CheatSheet/

è™šå¹»å¼•æ“çš„å¯è§†åŒ–è„šæœ¬ç¼–ç¨‹ç³»ç»Ÿï¼Œå³è“å›¾åŠŸèƒ½æ˜¯ä¸€ç±»å®Œæ•´çš„æ¸¸æˆæ€§è„šæœ¬ç³»ç»Ÿï¼Œæ­¤ç³»ç»Ÿçš„åŸºç¡€æ¦‚å¿µæ˜¯ä½¿ç”¨åŸºäºèŠ‚ç‚¹çš„ç•Œé¢åœ¨è™šå¹»ç¼–è¾‘å™¨ä¸­åˆ›å»ºæ¸¸æˆæ€§å…ƒç´ ã€‚ä¸è¯¸å¤šå¸¸ç”¨è„šæœ¬è¯­è¨€ç›¸åŒï¼Œå…¶ç”¨äºå®šäºå¼•æ“ä¸­çš„å¯¹è±¡é©±åŠ¨ï¼ˆOOï¼‰ç±»æˆ–å¯¹è±¡ã€‚ä½¿ç”¨UE4åä¾¿çŸ¥ï¼Œä½¿ç”¨è“å›¾æ‰€å®šä¹‰çš„å¯¹è±¡é€šå¸¸è¢«ç›´æ¥ç§°ä¸º Blueprintã€‚

è“å›¾å¯ä»¥ä½¿ç”¨ç›´è§‚ã€åŸºäºèŠ‚ç‚¹çš„æ–¹å¼åˆ›å»ºé€»è¾‘ï¼Œæˆ–è€…è®¾ç½®ä¸€äº›å˜é‡æ•°æ®ã€‚é€šè¿‡å¯è§†åŒ–èŠ‚ç‚¹çš„å®šä¹‰å’Œè¿æ¥å°±å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰çš„Actorã€Eventã€å‡½æ•°ç­‰ç­‰ï¼Œå¿«é€Ÿçš„åš Gameplay è¿­ä»£ï¼Œä¸éœ€è¦å†™ä»»ä½•ä»£ç ã€‚

ç®€å•åœ°è®²ï¼Œè“å›¾æ˜¯åˆ›å»ºæ–°çš„ UClasses çš„ä¸€ç§æ–¹æ³•ï¼Œè¿™ç§æ–¹æ³•ä¸éœ€è¦ä¹¦å†™æˆ–ç¼–è¯‘ä»»ä½•ä»£ç ã€‚åˆ›å»ºä¸€ä¸ªè“å›¾æ—¶ï¼Œå¯ä»¥é€‰æ‹©ç»§æ‰¿åŸç”Ÿ C++ ç±»æˆ–è€…ç»§æ‰¿å¦ä¸€ä¸ªè“å›¾ç±»ã€‚ç„¶åï¼Œæ‚¨å¯ä»¥æ·»åŠ ã€æ’åˆ—åŠè‡ªå®šä¹‰ç»„ä»¶ï¼Œä½¿ç”¨å¯è§†åŒ–çš„è„šæœ¬è¯­è¨€å®ç°è‡ªå®šä¹‰çš„é€»è¾‘ï¼Œå¯¹äº‹ä»¶åŠäº¤äº’åšå‡ºååº”ï¼Œå®šä¹‰è‡ªå®šä¹‰å˜é‡ï¼Œå¤„ç†è¾“å…¥ï¼Œ åŠåˆ›å»ºä¸€ç§å®Œå…¨è‡ªå®šä¹‰çš„å¯¹è±¡ç±»å‹ã€‚

æ¯ä¸ªè“å›¾éƒ½å…·æœ‰ä¸€ä¸ª `Construction Script` å›¾è¡¨ï¼Œå®ƒçš„ä½œç”¨ç­‰ä»· C++ ä¸­çš„æ„é€ å‡½æ•°ï¼Œå½“åˆ›å»ºè“å›¾å¯¹è±¡å®ä¾‹æ—¶ä¼šè¿è¡Œå®ƒã€‚è¯¥è„šæœ¬å¯ä»¥åŠ¨æ€åœ°åŸºäºå¤šä¸ªå› ç´ æ„å»º Actor å®ä¾‹ï¼Œæ¯”å¦‚ï¼Œä¸€ä¸ªå¯ä»¥è‡ªåŠ¨è°ƒæ•´å¤§å°æ¥å¡«å……å»ºç­‘ç‰©é—´ç©ºéš™çš„ç¯±ç¬†ã€‚ä»è¿™ä¸ªè§’åº¦æ¥è¯´ï¼Œè“å›¾ä¹Ÿå¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„é¢„åˆ¶ç³»ç»Ÿã€‚

æŒæ¡ Gameplay æ„æ¶ä¸­çš„å„ç§ç±»çš„ C++ åŠŸèƒ½ç¼–ç¨‹ï¼Œå°†å¯ä»¥æ›´å¥½åœ°å¸®åŠ©ä½¿ç”¨è“å›¾ç¼–è¾‘å™¨è¿›è¡Œå¯è§†åŒ–è„šæœ¬å¼€å‘ã€‚

äº‹ä»¶æ˜¯ä»æ¸¸æˆæ€§ä»£ç ä¸­è°ƒç”¨çš„èŠ‚ç‚¹ï¼Œ åœ¨äº‹ä»¶å›¾è¡¨ï¼ˆEventGraphï¼‰ ä¸­å¼€å§‹æ‰§è¡Œä¸ªä½“ç½‘ç»œã€‚åœ¨è“å›¾ä¸­ï¼Œè¦æ‰§è¡Œçš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ˜¯ä¸€ä¸ªäº‹ä»¶ï¼Œç„¶åæ˜¯ä»å·¦è‡³å³é€šè¿‡ç™½è‰²æ‰§è¡Œçº¿çš„æ‰§è¡Œæµã€‚æ¸¸æˆè¿è¡Œæ—¶ï¼Œæ‚¨å¯ä»¥åœ¨ç¼–è¾‘å™¨ä¸­å¯è§†åŒ–æ‰§è¡Œæµï¼Œè¿™æœ‰åŠ©äºè°ƒè¯•ã€‚æ•°æ®è¿˜æµç»é‡‡ç”¨åŒ¹é…å˜é‡ç±»å‹çš„å½©è‰²å¯¼çº¿ã€‚å½“èŠ‚ç‚¹æ‰§è¡Œæ—¶ï¼Œå°†å¯¹è¾“å…¥å¼•è„šè¿›è¡Œè¯„ä¼°ï¼Œåå‘ä»å³è‡³å·¦è·Ÿè¸ªæ•°æ®çº¿ï¼Œç›´åˆ°è®¡ç®—å‡ºæœ€ç»ˆç»“æœå¹¶å°†å…¶æä¾›ç»™èŠ‚ç‚¹ã€‚

å¸¦æœ‰æ‰§è¡Œå¼•è„šï¼ˆéçº¯èŠ‚ç‚¹ï¼‰çš„èŠ‚ç‚¹åœ¨æ‰§è¡Œæ—¶å­˜å‚¨å…¶è¾“å‡ºå¼•è„šçš„å€¼ï¼Œè€Œä¸å¸¦æ‰§è¡Œå¼•è„šï¼ˆçº¯èŠ‚ç‚¹ï¼‰çš„èŠ‚ç‚¹åˆ™åœ¨æ¯æ¬¡ä¸å…¶è¾“å‡ºç›¸è¿çš„èŠ‚ç‚¹æ‰§è¡Œæ—¶é‡æ–°è®¡ç®—å…¶è¾“å‡ºã€‚

è“å›¾å¯ä»¥å«æœ‰è„šæœ¬ä»£ç ã€ç»„ä»¶ã€æˆ–åªæœ‰æ•°æ®ï¼Œä»…åŒ…å«æ•°æ®çš„è“å›¾ Data-Only Blueprint æ˜¯æŒ‡ä»…åŒ…å«ä»£ç (ä»¥èŠ‚ç‚¹å›¾è¡¨çš„å½¢å¼)ã€å˜é‡åŠä»å…¶çˆ¶ç±»ç»§æ‰¿çš„ç»„ä»¶
çš„ç±»è“å›¾ã€‚ä»…åŒ…å«æ•°æ®çš„è“å›¾å…è®¸æ‚¨è°ƒæ•´åŠä¿®æ”¹ç»§æ‰¿çš„å±æ€§ï¼Œä½†æ˜¯ä¸èƒ½æ·»åŠ æ–°å…ƒç´ ã€‚ ä»æœ¬è´¨ä¸Šè®²ï¼Œè¿™äº›è“å›¾æ˜¯åŸå‹çš„æ›¿ä»£ç‰©ï¼Œè®¾è®¡äººå‘˜å¯ä»¥ä½¿ç”¨å®ƒä»¬æ¥è°ƒæ•´å±æ€§æˆ–è€…è®¾ç½®å…·æœ‰å˜ç§çš„é¡¹ç›®ã€‚

Data-Only Blueprints åœ¨åˆå¹¶çš„å±æ€§ç¼–è¾‘å™¨ä¸­è¿›è¡Œç¼–è¾‘ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥è½¬æ¢ä¸ºå®Œæ•´çš„è“å›¾æ¥æ·»åŠ ä»£ç ã€å˜é‡æˆ–ç»„ä»¶ã€‚

è“å›¾æœ‰å¾ˆå¤šåŠŸèƒ½ï¼ŒåŒ…æ‹¬æ•°æ®èµ„æºé…ç½®ã€åˆ›å»º UI ç•Œé¢ç­‰ç­‰ï¼Œå¯ä»¥åŸºäºèŠ‚ç‚¹å’Œè¿çº¿ä½¿ç”¨å›¾å½¢åŒ–çš„æ–¹å¼åˆ›å»ºé€»è¾‘æµç¨‹ï¼Œä¸ç”¨å†™ C++ ä»£ç ã€‚è¿™æå¤§çš„æå‡äº†é¡¹ç›®çš„è¿­ä»£é€Ÿåº¦ï¼Œè€Œä¸”èƒ½è§£æ”¾ç¨‹åºå‘˜ç”Ÿäº§åŠ›ã€‚è€Œè“å›¾çš„å›¾å½¢åŒ–å˜æˆåŠŸèƒ½ä¸»è¦å°±æ˜¯ç”±å›¾å’ŒèŠ‚ç‚¹è¿™ä¸¤ä¸ªæ¦‚å¿µå®ç°çš„ã€‚

è“å›¾ä½œä¸ºè„šæœ¬è¯­è¨€çš„ä¸€ç§å¯è§†åŒ–ç¼–ç¨‹æ–¹æ³•ï¼Œå°±å…¶æœ¬èº«è€Œè¨€ï¼Œæ­¤ç³»ç»Ÿä¸æ ‡å‡†ä¹¦é¢è„šæœ¬è¯­è¨€æœ‰è®¸å¤šç»†å¾®å·®åˆ«ï¼Œä¾‹å¦‚æ•°æ®ç±»å‹åŒ–å˜é‡ã€æ•°ç»„ã€ç»“æ„ä½“ç­‰ç­‰ã€‚æ‰§è¡Œæµçš„å·¥ä½œæ–¹å¼ä¸åœ¨å…¸å‹è„šæœ¬è¯­è¨€ä¸­ä¸€æ ·ï¼Œä½†è“å›¾è¦æ±‚æ¯ä¸ªèŠ‚ç‚¹çš„æ˜¾å¼çº¿æ€§æ‰§è¡Œã€‚

æ·»åŠ èŠ‚ç‚¹åˆ°è“å›¾çš„æ–¹æ³•ï¼š

- ä» Components çª—å£å°†èŠ‚ç‚¹æ‹–æ”¾åˆ°å›¾è¡¨ä¸Šã€‚
- ä» My Blueprint çª—å£å°†èŠ‚ç‚¹æ‹–æ”¾åˆ°å›¾è¡¨ä¸Šã€‚
- å¤šæ•°æƒ…å†µä¸‹ï¼Œåœ¨è“å›¾å›¾è¡¨ä¸­é€šè¿‡å³é”®å¿«æ·èœå•å¯ä»¥æ”¾ç½®ä»»ä½•èŠ‚ç‚¹ã€‚
- ä¹Ÿå¯ä½¿ç”¨å¿«æ·é”®æ›¿ä»£å’Œä½¿ç”¨èŠ‚ç‚¹ï¼Œæå‡å·¥ä½œæ•ˆç‡ã€‚

çª—å£å³ä¸Šè§’æœ‰ä¸€ä¸ªåä¸º Context Sensitive çš„é€‰é¡¹ï¼Œå®ƒä¸ºé»˜è®¤å¼€å¯ï¼Œå•å‡»å³é”®å¹¶æœç´¢èŠ‚ç‚¹æ—¶ï¼Œä¼šå‡ºç°æ ¹æ®ä¸Šä¸‹æ–‡ç­›é€‰åçš„èŠ‚ç‚¹åˆ—è¡¨ã€‚

ä¸ºäº†æ›´æœ‰æ¡ç†çš„ç»„ç»‡èŠ‚ç‚¹ï¼Œå¯ä»¥é€‰æ‹©èŠ‚ç‚¹ï¼Œä½¿ç”¨å³é”®èœå• Create Comment from Select æˆ–æ·»åŠ  Comment Box èŠ‚ç‚¹ï¼Œæˆ–è€…ä½¿ç”¨å¿«æ·é”® C å°†å…¶å®ƒå¤šä¸ªèŠ‚ç‚¹ç»„ç»‡èµ·æ¥ï¼Œç›¸å½“ä¸€ä¸ªåˆ†ç»„ï¼Œç§»åŠ¨æ—¶ä¹Ÿå¯ä»¥ä¸€èµ·ã€‚

Noteï¼šå¯¹äºä¸€ä¸ªå˜é‡ï¼Œå¯ä»¥æ”¾ç½® Getter æˆ– Setter èŠ‚ç‚¹ï¼Œåˆ†åˆ«ç”¨äºè¯»ã€å†™æ“ä½œã€‚å·¦é”®æ‹–åŠ¨å˜é‡åˆ°è“å›¾ä¸­ Node çš„æ¥å— input / output ç«¯å£ï¼Œä¹Ÿå¯ä»¥è‡ªåŠ¨å˜æˆå˜é‡çš„ GET / SETã€‚

UE4 è“å›¾ä¸­çš„å¿«æ·é”®é»˜è®¤é…ç½®ï¼š

- Alt + é¼ æ ‡å·¦é”®æ‹–åŠ¨ My Blueprint ä¸€ä¸ªå˜é‡åˆ°è“å›¾ä¸­ï¼Œå°±æ˜¯æ”¾ç½® Setter èŠ‚ç‚¹ï¼›
- Ctrl + å·¦é”®æ‹–åŠ¨å˜é‡åˆ°è“å›¾ä¸­ï¼Œå°±æ˜¯æ”¾ç½® Getter èŠ‚ç‚¹ï¼›
- Ctrl + W å¤åˆ¶è“å›¾ä¸­é€‰ä¸­çš„èŠ‚ç‚¹ï¼›
- Ctrl + Shift + F åœ¨æ‰€æœ‰è“å›¾ä¸­æœç´¢ï¼›
- Ctrl + F å½“å‰è“å›¾ä¸­æœç´¢ï¼ˆFindï¼‰ï¼›
- Alt + å•å‡»ç«¯å£æ–­å¼€æ‰€æœ‰è¿æ¥ï¼›
- Ctrl + é¼ æ ‡å·¦é”®æ‹–æ‹½åˆ°å¼•è„šç§»åŠ¨æ‰€æœ‰è¿æ¥ï¼›
- æŒ‰ä½ S é”®åœ¨è“å›¾ä¸­ç‚¹å‡»é¼ æ ‡å·¦é”®å¿«é€Ÿç”Ÿæˆ Sequence èŠ‚ç‚¹ï¼›
- æŒ‰ä½ D é”®åœ¨è“å›¾ä¸­ç‚¹å‡»é¼ æ ‡å·¦é”®å¿«é€Ÿç”Ÿæˆ Delay èŠ‚ç‚¹ï¼›
- æŒ‰ä½ F é”®åœ¨è“å›¾ä¸­ç‚¹å‡»é¼ æ ‡å·¦é”®å¿«é€Ÿç”Ÿæˆ ForEachLoop èŠ‚ç‚¹ï¼›
- æŒ‰ä½ G é”®åœ¨è“å›¾ä¸­ç‚¹å‡»é¼ æ ‡å·¦é”®å¿«é€Ÿç”Ÿæˆ Gate èŠ‚ç‚¹ï¼›
- æŒ‰ä½ B é”®åœ¨è“å›¾ä¸­ç‚¹å‡»é¼ æ ‡å·¦é”®å¿«é€Ÿç”Ÿæˆ Branch èŠ‚ç‚¹ï¼›
- æŒ‰ä½ N é”®åœ¨è“å›¾ä¸­ç‚¹å‡»é¼ æ ‡å·¦é”®å¿«é€Ÿç”Ÿæˆ DoN èŠ‚ç‚¹ï¼›
- æŒ‰ä½ M é”®åœ¨è“å›¾ä¸­ç‚¹å‡»é¼ æ ‡å·¦é”®å¿«é€Ÿç”Ÿæˆ MultiGate èŠ‚ç‚¹ï¼›
- æŒ‰ä½ O é”®åœ¨è“å›¾ä¸­ç‚¹å‡»é¼ æ ‡å·¦é”®å¿«é€Ÿç”Ÿæˆ DoOnce èŠ‚ç‚¹ï¼›
- æŒ‰ä½ P é”®åœ¨è“å›¾ä¸­ç‚¹å‡»é¼ æ ‡å·¦é”®å¿«é€Ÿç”Ÿæˆ Add Selected Actor Reference èŠ‚ç‚¹ï¼›
- æŒ‰ä½ R é”®åœ¨è“å›¾ä¸­ç‚¹å‡»é¼ æ ‡å·¦é”®å¿«é€Ÿç”Ÿæˆ ReceiveBeginPlay å³ Event BeginPlay èŠ‚ç‚¹ï¼›

Gate èŠ‚ç‚¹ç”¨æ¥å¼€å¯æˆ–å…³é—­æ‰§è¡Œæµï¼Œå¦‚æœå½“å‰æ‰§è¡ŒæµçŠ¶æ€æ˜¯ Open åˆ™èƒ½æ­£å¸¸æ‰§è¡Œï¼Œå¦‚æœå½“å‰çŠ¶æ€æ˜¯ Close åˆ™é˜»æ–­å½“å‰æ‰§è¡Œã€‚Toggle æ˜¯ç”¨æ¥åè½¬ Open å’Œ Close çŠ¶æ€çš„ï¼ŒStart Closed æ ‡è®°é—¨çš„èµ·å§‹çŠ¶æ€ï¼Œè‹¥å‹¾é€‰äº†åˆ™æ ‡è®°èµ·å§‹çŠ¶æ€ä¸º Closedã€‚

Gate èŠ‚ç‚¹åªæœ‰ä¸€ä¸ªæ‰§è¡Œå‡ºå£ Exitï¼ŒMultiGate åˆ™æœ‰å¤šä¸ªæ‰§è¡Œå‡ºå£ã€‚å¯ä»¥è®¾ç½®ç¬¬ä¸€ä¸ªå‡ºå£çš„ç´¢å¼•æ˜¯å“ªä¸ªï¼Œä¹Ÿå¯ä»¥æŒ‡å®šæ˜¯å¦å¾ªç¯ï¼Œå¦‚æœä¸å¾ªç¯æ‰€æœ‰å‡ºå£éƒ½æ‰§è¡Œä¸€éåå°†ä¸å†æ‰§è¡Œï¼Œé™¤é Resetï¼Œè¿˜å¯ä»¥æŒ‡å®šè¿™äº›å‡ºå£ä¹‹é—´æ˜¯é¡ºåºæ‰§è¡Œè¿˜æ˜¯éšæœºæ‰§è¡Œï¼ŒSequence èŠ‚ç‚¹ä¸€èˆ¬ç”¨äºé¡ºåºæ‰§è¡Œä¸€ç³»åˆ—äº‹æƒ…ã€‚

è“å›¾å¸¸ç”¨æ“ä½œå¤‡å¿˜ï¼š

- *Mod* æ±‚ä½™æ“ä½œï¼Œéœ€è¦ä»è¾“å‡ºæ•°å€¼èŠ‚ç‚¹å¼•å‡ºï¼Œä¸èƒ½ç›´æ¥é€šè¿‡ % æœç´¢åˆ°ï¼›
- *Make Literal* å„ç§å¸¸é‡èŠ‚ç‚¹ï¼›
- *Make Array* æ•°ç»„èŠ‚ç‚¹ï¼›
- *Operators* å„ç§ç®—æœ¯è¿ç®—å’Œå…³ç³»è¿ç®—ç¬¦ï¼›
- *Select* å¤šå€¼é€‰æ‹©æ€§è¾“å‡ºèŠ‚ç‚¹ï¼›
- *Switch* å¤šåˆ†æ”¯é€‰æ‹©æ‰§è¡ŒèŠ‚ç‚¹ï¼›
- *Sequence* é€æ¬¡åˆ†æ”¯é€‰æ‹©æ‰§è¡Œï¼›
- *Math Expression* æ·»åŠ æ•°å­¦è¡¨è¾¾å¼ï¼Œå‘½åä¸º `(1+x)*sin(myVar)-2.4/rand()` å³å¯åˆ›å»ºæ•°å­¦ç®—å¼ï¼Œè€Œä¸ç”¨ç‹¬ä¸ªèŠ‚ç‚¹è®¾ç½®ã€‚
- å­—ç¬¦ä¸²å¤„ç†ä½¿ç”¨ Append æˆ– Join å‡½æ•°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Format Textï¼Œæ ¼å¼å­—ç¬¦ä¸²è®¾ç½®å‚è€ƒ *Hello {name}!*ã€‚
- *Teleport* æ˜¯å®ç° UE4 VR ç¬ç§»çš„åŠŸèƒ½ã€‚
- *For Each Loop* æšä¸¾æ•°ç»„ã€‚
- é™¤äº†ä½¿ç”¨ DoN å¾ªç¯ï¼ŒFor Loop æˆ– While Loop è¿™äº›å¾ªç¯èŠ‚ç‚¹ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ Custom Event å®ç°å¾ªç¯ã€‚
- ä½¿ç”¨ *Reroute* èŠ‚ç‚¹æ¥å›ºå®šå¼•çº¿ï¼Œä½¿ç”¨å›¾è¡¨æ›´æ•´æ´ã€‚
- è“å›¾èŠ‚ç‚¹çš„æ•°æ®ç±»å‹æ˜¾ç¤ºä¸º Wildcads è¡¨ç¤ºä¼šè‡ªåŠ¨åœ¨è¿æ¥æ—¶ç¡®å®šæ•°æ®ç±»å‹ï¼Œåœ¨æ–­å¼€è¿æ¥æ—¶å¯ä»¥æ‰‹åŠ¨æ”¹å˜ã€‚

ä»¥ä¸‹æ­¥éª¤ï¼Œç¤ºèŒƒå¦‚ä½¿ç”¨è“å›¾æ¥åˆ›å»ºæ¥å£åŠç±»å¯¹è±¡ï¼Œè€Œä¸ç”¨ç¼–å†™ C++ ä»£ç ï¼Œå®ç°åŠŸèƒ½ï¼šæŒ‰ä¸‹Bé”®ï¼ŒDogã€Cat æ‰“å°ç›¸åº”çš„å­—ç¬¦åˆ°å±å¹•ã€‚

- åœ¨ UE4 ä¸»ç•Œé¢ï¼Œåœ¨ Content Browser ä¸­ä¸€ç›®å½•ä¸‹æ–°å»ºè“å›¾æ¥å£ Blueprint -> Blueprint Interfaceï¼Œæ”¹åä¸º BPI_Barkingã€‚
- åŒæ ·ï¼Œæ–°å»ºè“å›¾ç±» Blueprint -> Blueprint Classï¼Œåˆ†åˆ«åˆ›å»º Dog å’Œ Cat ç±»ã€‚
- åŒå‡»æ‰“å¼€è“å›¾æ¥å£ï¼Œæ–°å»ºä¸€ä¸ªæ¥å£å‡½æ•°ï¼Œç‚¹å‡» Add New å³å¯ï¼Œå‡½æ•°åä¸º barkingã€‚
- ç„¶åï¼Œåœ¨æ·»åŠ è¿‡è¯¥æ¥å£çš„ç±»ä¸­å†™å®ç°ï¼Œå¹¶åœ¨åˆ«çš„åœ°æ–¹è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚
- æ‰“å¼€æ–°å»ºçš„ Dog æˆ– Cat è“å›¾ç±»ï¼ŒæŒ‡å®šä¸Šé¢åˆ›å»ºçš„è“å›¾æ¥å£ `Class Setting -> Interface -> BPI_Barking`ã€‚
- æŒ‡å®šè“å›¾ç±»å®ç°çš„æ¥å£åï¼Œé€šè¿‡ My Blueprint -> Interfaces åˆ—è¡¨å¯ä»¥çœ‹åˆ°å·²ç»æ·»åŠ äº†ç›¸åº”çš„æ¥å£ã€‚
- ä½¿ç”¨å³é”®èœå• `My Blueprint -> Interfaces -> Barking -> Implement event` è‡ªåŠ¨åœ¨ EventGraph åˆ›å»ºä¸€ä¸ª Event Barking èŠ‚ç‚¹ã€‚
- å®ç° barking åªéœ€è¦åœ¨è¾“å‡ºç«¯æ¥ä¸Šä¸€ä¸ª Print String èŠ‚ç‚¹ç”¨äºæ‰“å°æµ‹è¯•å†…å®¹ï¼ŒIn String èŠ‚ç‚¹ä¸æ¥è¾“å…¥ï¼Œå¡«å®šä»»æ„å†…å®¹å³å¯ï¼Œå¦‚ Hello Dog!ã€‚

è®¾ç½®å¥½è“å›¾ç±»å’Œæ¥å£çš„å®ç°ï¼Œæ¥ç€æ˜¯ä½¿ç”¨å®ƒä»¬ï¼Œåœ¨å…³å¡è“å›¾ä¸­è°ƒç”¨å·²å®ç°çš„æ¥å£å‡½æ•°ï¼š

- ä½¿ç”¨ Editor å·¥å…·æ æ‰“å¼€å½“å‰å…³å¡è“å›¾ï¼ŒBlueprints -> Open Level Blueprintï¼Œæ·»åŠ  Input -> KeyBoard Events é€‰æ‹©ä¸€ä¸ªæŒ‰é”®äº‹ä»¶ï¼Œå¦‚ Bã€‚
- å°†é”®ç›˜äº‹ä»¶çš„ Pressed ç«¯å£è¿æ¥åˆ° Barking BP æ¥å£çš„ barking æ–¹æ³•ã€‚
- å¦å¤–ï¼Œbarking æ–¹æ³•è¿˜æœ‰ä¸€ä¸ª Target ç«¯å£ï¼Œè¿™ä¸ªè¡¨ç¤ºè°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„å¯¹è±¡ï¼Œéœ€è¦æŒ‰ä»¥ä¸‹æ“ä½œè·å– Dog æˆ– Cat çš„å¯¹è±¡å¼•ç”¨ã€‚
- åªéœ€è¦å…ˆå°† Dog æˆ– Cat æ·»åŠ åˆ°å…³å¡ä¸Šï¼Œå³åˆ›å»º Actor å¯¹è±¡ï¼Œä¿æŒé€‰ä¸­çŠ¶æ€ï¼Œç„¶ååœ¨å…³å¡è“å›¾ä¸­ä½¿ç”¨å³é”® Create a Reference to Dog è·å–å¼•ç”¨ï¼Œå¹¶è¿æ¥åˆ° Target ç«¯å£ã€‚
- æ¨¡æ‹Ÿè¿è¡Œï¼ŒæŒ‰ä¸‹ Bï¼Œå¾—åˆ°ç›¸åº”çš„å†…å®¹è¾“å‡ºã€‚ç±»ä¼¼åœ°ï¼Œä½¿ç”¨ C æŒ‰é”®æ¥è°ƒç”¨ Cat::barking è€Œä¸ä½¿ç”¨æ¥å£æ–¹æ³•èŠ‚ç‚¹ã€‚

è“å›¾æ¥å£å¯ä»¥è¿›è¡Œä¸€å¯¹å¤šã€ç”šè‡³å¤šå¯¹å¤šçš„å¹¿æ’­ï¼Œä¸€å¤„è°ƒç”¨ï¼Œå¤šå¤„å“åº”ã€‚

å¦‚æœä½¿ç”¨æ¥å£èŠ‚ç‚¹æ¥è°ƒç”¨ Barking å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨ Select èŠ‚ç‚¹æ¥åš Dogã€Cat çš„é€‰æ‹©åˆ†æ”¯ï¼Œåªéœ€å®šä¹‰ä¸€ä¸ªå˜é‡åšä¸ºé€‰æ‹©çš„åºå·ã€‚è¿æ¥èŠ‚ç‚¹æ—¶éœ€è¦æ³¨æ„ï¼Œå…ˆè¿æ¥ Select çš„è¾“å‡ºç«¯åˆ°æ¥å£æ–¹æ³•çš„ Target ç«¯å£ï¼Œè¿™æ ·å°±å¯ä»¥ç¡®å®š Select èŠ‚ç‚¹çš„è¾“å…¥ä¹Ÿä¸ºå¯¹è±¡å¼•ç”¨ï¼Œè¿™é‡Œå†æ¥å…¥ Dog å’Œ Cat å°±ä¸ä¼šæœ‰é—®é¢˜ã€‚å¦‚æœå…ˆå°† Dog æˆ– Cat æ¥å…¥ Select èŠ‚ç‚¹ï¼Œé‚£ä¹ˆä¸¤ä¸ªè¾“å…¥ç«¯å£çš„ç±»å‹å°±ç¡®å®šä¸º Dog æˆ– Cat çš„å¯¹è±¡å¼•ç”¨ï¼Œåªèƒ½æ¥å…¥ä¸€ä¸ªå…·ä½“å¯¹è±¡å¼•ç”¨ã€‚æ‰€ä»¥ï¼Œéœ€è¦é¢å¤–è®¾ç½® Change Pin Type -> Object å³ UObject å¯¹è±¡å¼•ç”¨ã€‚

ç›´æ¥å°†è“å›¾ç±»ä»å†…å®¹æµè§ˆå™¨æ‹–åˆ°è“å›¾ç¼–è¾‘å™¨ï¼Œä¼šè‡ªåŠ¨åˆ›å»º AddChildActorComponent å‡½æ•°è°ƒç”¨èŠ‚ç‚¹ï¼Œè¿™è¡¨ç¤ºå°†è“å›¾ç±»å½“ä½œ ChildActor ç»„ä»¶æ·»åŠ åˆ°å…³å¡åœºæ™¯ä¸­ã€‚å› æ­¤ï¼Œè¦ä»è¿™ä¸ªèŠ‚ç‚¹çš„è¿”å›å€¼è·å–åŸæ¥çš„è“å›¾ç±»ï¼Œå°±éœ€è¦æ‰§è¡Œ ChildActorComponent ç»„ä»¶çš„ GetChildActor æ–¹æ³•ã€‚

è“å›¾æ”¯æŒ Macrosã€Functions å’Œ Events è¿˜æœ‰å˜é‡ï¼Œä»¥ä¸‹æ˜¯è¿™å‡ ä¸ªæ–¹å¼çš„åŠŸèƒ½ç»†èŠ‚å¯¹æ¯”ï¼š

    |                    |   Macros   | Functions | Events |
    |--------------------|------------|-----------|--------|
    | Input              | Yes        | Yes       | Yes    |
    | Output             | Yes        | Yes       | No     |
    | Exec I/O           | Any number | One       | One    |
    | Call by another BP | No         | Yes       | Yes    |
    | Delay              | Yes        | No        | Yes    |
    | Timeline           | No         | No        | Yes    |

å¦å¤–ï¼Œè“å›¾çš„ Event Dispatchers æ˜¯åŸºäºå§”æ‰˜å®ç°çš„ï¼Œå¯ä»¥é€šè¿‡å­¦ä¹  C++ ä¸­å§”æ‰˜ä½¿ç”¨æ¥ç†è§£äº‹ä»¶åˆ†å‘å™¨çš„ä½¿ç”¨ã€‚

éç¨‹åºå‘˜å®Œå…¨å¯ä»¥ä½¿ç”¨è“å›¾çš„åŸå› æ˜¯è“å›¾èŠ‚ç‚¹ åœ¨è™šæ‹Ÿæœºï¼ˆVMï¼‰ä¸­è¿è¡Œï¼Œè®©å®ƒä»¬èƒ½å¤Ÿè°ƒç”¨ C++ å‡½æ•°ã€‚ä½†å¼Šç«¯æ˜¯ï¼Œä¾èµ– VM å°†è“å›¾è½¬æ¢ä¸ºåŸç”Ÿ C++ ä»£ç éœ€è¦ä»˜å‡ºä¸€äº›ä»£ä»·ï¼Œ å°†è“å›¾ä»£ç è½¬æ¢ä¸ºåŸç”Ÿ C++ å‡½æ•°å¯èƒ½ä¼šæ‹–æ…¢æ¯ä¸€å¸§çš„æ¸¸æˆæ€§èƒ½ã€‚

å°½ç®¡ï¼Œè“å›¾åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œå¯ä»¥è¿›è¡Œé¡¹ç›®çš„å¿«é€Ÿè¿­ä»£å¼€å‘ï¼Œä½†æ˜¯å¯¹äºéœ€è¦å¤§é‡è¿ç®—çš„ç¨‹åºï¼Œå‡ºäºæ€§èƒ½è€ƒè™‘ï¼Œè“å›¾å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ã€‚ä¸ºäº†é™ä½é¡¹ç›®è¿è¡Œæ—¶ç‰ˆæœ¬ä¸­çš„è™šæ‹Ÿæœºå¼€é”€ï¼Œä½¿ç”¨ C++ å®ç°æ›´æ°å½“ã€‚

åœ¨ UE 4 ä¸­æä¸ªçš„è“å›¾åŸç”ŸåŒ–å·¥å…· Nativizing Blueprints å¯ä»¥å®ç°å°†è“å›¾è½¬æ¢ä¸º C++ å®ç°ï¼Œè™½ç„¶ä½ èƒ½å¤Ÿç”¨æ–‡æœ¬ç¼–è¾‘å™¨é˜…è¯»è½¬æ¢åçš„ C++ ä»£ç ï¼Œä½†ä½ ä¼šæ³¨æ„åˆ°ï¼Œè¯¥ä»£ç å¹¶æ²¡æœ‰è®¾è®¡ä¸ºå¯é‡ç”¨ï¼ˆæˆ–è€…ç”Ÿæˆä¸º"è¯»è€…å‹å¥½å‹"ï¼‰ã€‚æ³¨æ„ï¼Œè“å›¾åŸç”ŸåŒ–åœ¨æ–°ç‰ˆæœ¬ UE5EA ä¸­è¢«ç§»é™¤ã€‚

ä½ å¯ä»¥åœ¨å·¥ç¨‹ç›®å½• \Intermediate\Plugins\NativizedAssets ä¸­æ‰¾åˆ°è“å›¾çš„åŸç”ŸåŒ–ä»£ç ã€‚

é¦–æ¬¡åˆ›å»ºé¡¹ç›®æ—¶ï¼Œè“å›¾åŸç”ŸåŒ–é»˜è®¤æ˜¯ç¦ç”¨çš„ã€‚å¯ç”¨è“å›¾åŸç”ŸåŒ–è®¾ç½® Project Settings -> Packaging -> Blueprint ->Blueprint Nativization Methodï¼š

- Disabled é»˜è®¤å€¼ï¼Œä¸å¯ç”¨è“å›¾åŸç”ŸåŒ–ï¼›
- Inclusive å¯ç”¨åŸç”ŸåŒ–ï¼Œç„¶åå°†è“å›¾è®¾ç½®åŸç”ŸåŒ–ï¼Œæ‰“å¼€è“å›¾ç¼–è¾‘å™¨æ“ä½œï¼ŒClass Settings -> Details -> Packaging -> Nativizeã€‚
- Exclusive å¯ç”¨åŸç”ŸåŒ–ï¼Œæ’ä»–è“å›¾åŸç”ŸåŒ–æ–¹æ³•çƒ˜ç„™å’Œæ‰“åŒ…é¡¹ç›®ï¼Œå‘ç¡¬ä»¶èµ„æºæœ‰é™çš„è®¾å¤‡äº¤ä»˜å¤§é¡¹ç›®æ—¶ä½¿ç”¨ï¼›

ä¿å­˜å¹¶ç¼–è¯‘è“å›¾åï¼Œå°±å¯ä»¥çœ‹åˆ°å·¥ç¨‹è®¾ç½®ä¸­çš„ List of Blueprint assets to Nativize åˆ—è¡¨ä¸­å·²ç»åŒ…å«æŒ‡å®šåŸç”ŸåŒ–çš„è“å›¾ã€‚æ³¨æ„ï¼Œæ‰€æœ‰å—æ”¯æŒçš„ä¾èµ–é¡¹ä¹Ÿä¼šæ ‡è®°ä¸ºéœ€è¦åŸç”ŸåŒ–ï¼ŒåŒ…æ‹¬å®ƒå®ç°çš„æ¥å£ä¹Ÿä¼šè‡ªåŠ¨è®¾ä¸ºåŸç”ŸåŒ–ã€‚

é€‰æ‹© åŒ…å«ï¼ˆInclusiveï¼‰ åŸç”ŸåŒ–æ–¹æ³•åï¼Œåœ¨æ‰“åŒ…è¿‡ç¨‹ä¸­æ³¨æ„åŠ¡å¿…è¦æ³¨æ„çš„æ˜¯ï¼Œ è™šå¹»è‡ªåŠ¨åŒ–å·¥å…·ï¼ˆUATï¼‰å°†å¯¹ä»¥ä¸‹æ”¯æŒçš„è“å›¾èµ„æºè¿›è¡ŒåŸç”ŸåŒ–ï¼š

- è“å›¾ç±»
- è“å›¾å‡½æ•°åº“
- è“å›¾æ¥å£
- åŠ¨ç”»è“å›¾
- å°éƒ¨ä»¶è“å›¾
- ç”¨æˆ·å®šä¹‰çš„ç»“æ„
- ç”¨æˆ·å®šä¹‰çš„æšä¸¾å€¼

ç›®å‰ï¼Œå…³å¡è“å›¾å’Œè“å›¾å®ä¸å—è“å›¾åŸç”ŸåŒ–å·¥å…·çš„æ”¯æŒï¼Œä¸ä¼šè½¬æ¢ä¸ºåŸç”ŸC++ä»£ç ã€‚

é€‰æ‹©æ’ä»– Exclusive è“å›¾åŸç”ŸåŒ–æ–¹æ³•ä¸€äº›ä¼˜åŠ¿ï¼š

- é™åˆ¶å¯æ‰§è¡Œæ–‡ä»¶çš„æœ€ç»ˆå¤§å°ã€‚
- æœ‰æ•ˆé˜²æ­¢è½¬æ¢æœªä½¿ç”¨è“å›¾èµ„æºã€‚
- èƒ½å¤Ÿæ˜¾å¼é€‰æ‹©è¦è½¬æ¢çš„è“å›¾èµ„æºã€‚

ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœä½ çš„è“å›¾è¾ƒä¸ºå ç”¨è®¡ç®—èµ„æºï¼Œåˆ™å»ºè®®é€‰æ‹©æ’ä»–ï¼ˆExclusiveï¼‰è“å›¾åŸç”ŸåŒ–æ–¹æ³•ï¼ŒåŒ…æ‹¬ï¼ˆä½†ä¸é™äºï¼‰ï¼š

- æœ‰å¤§é‡èŠ‚ç‚¹çš„è“å›¾ã€‚
- éœ€è¦ä¼˜åŒ–å¾ªç¯çš„è“å›¾ã€‚
- æ‰§è¡Œå¤æ‚æ•°å­¦è¿ç®—çš„è“å›¾ã€‚


## âš¡ Class Creation - LightSwitch
- Class åˆ›å»ºæ–¹æ³• https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ClassCreation/

è“å›¾å’Œ C++ éƒ½å¯ä»¥åˆ›å»ºç±»ï¼Œå¹¶ä¸”ï¼Œå®ƒä»¬å¯ä»¥æ­é…ä½¿ç”¨ï¼Œä½¿ç”¨è“å›¾å¯ä»¥æ‰©å±• C++ ç±»å¹¶ä¿®æ”¹å…¶ä»£ç ã€‚

è¿™äº›ç¤ºä¾‹å±•ç¤ºäº†ï¼š

- å¦‚ä½•ä»…ä½¿ç”¨è“å›¾åˆ›å»ºå…‰æºå¼€å…³ç±»*LightSwitch_BPOnly*ï¼›
- ä»…ä½¿ç”¨ C++ ä»£ç åˆ›å»ºå…‰æºå¼€å…³ç±»*LightSwitchCodeOnly*ï¼›
- ä»¥åŠåŒæ—¶ä½¿ç”¨ C++ ä»£ç å’Œè“å›¾åˆ›å»ºæ–°å…‰æºå¼€å…³ç±»*LightSwitchBoth*ï¼Œå¹¶ä¸”åœ¨è“å›¾ä¸­è¦†ç›– C++ çš„ä»£ç é€»è¾‘ã€‚

ç›®æ ‡æ˜¯åˆ†åˆ«ä½¿ç”¨è¿™ä¸‰ç§å·¥ä½œæµç¨‹åˆ›å»ºå…·æœ‰ç›¸åŒå±æ€§å’Œè¡Œä¸ºçš„æ–°ç±»ï¼Œ ç„¶åå°†æ¯ä¸ªæ–°ç±»çš„ä¸€ä¸ªå®ä¾‹æ·»åŠ åˆ°å…³å¡ä¸­ï¼Œè¿™æ ·å…³å¡ä¸­å°±å…·æœ‰ä¸‰ä¸ªæ–°çš„å…‰æºå¼€å…³ Actorã€‚

å®ƒä»¬å„è‡ªåŒ…å«ä¸€ä¸ª *PointLightComponent* æ ¹ç»„ä»¶ï¼Œè¿˜æœ‰ä¸€ä¸ªå­ç»„ä»¶ *SphereComponent*ã€‚æ¯ä¸ªå…‰æºå¼€å…³ç±»éƒ½è¿˜åŒ…å«ä¸€ä¸ªåç§°ä¸º*DesiredIntensity*çš„å˜é‡ï¼Œç”¨äºè®¾ç½®å…‰çº¿çš„å¼ºåº¦ã€‚æœ€åï¼Œè¿™äº›ç±»çš„é»˜è®¤è¡Œä¸ºæ˜¯å½“ç©å®¶è¿›å…¥æˆ–ç¦»å¼€*SphereComponent*æ—¶ï¼Œ*PointLightComponent*çš„å¯è§†æ€§ä¼šåˆ‡æ¢ã€‚


## âš¡ LightSwitch BlueprintOnly
- https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ClassCreation/BlueprintOnly/

ä½¿ç”¨è“å›¾å¯è§†åŒ–è„šæœ¬ç³»ç»Ÿè®¾ç½®æ–°ç±»ï¼Œåˆ›å»ºæ–°è“å›¾ç±»åï¼Œä½ å¯ä»¥æ·»åŠ ç»„ä»¶ï¼Œå€ŸåŠ©å¯è§†åŒ–è„šæœ¬è®¾ç½®å‡½æ•°å’Œå…¶ä»–æ¸¸æˆæ€§æˆ–è®¾è®¡è¡Œä¸ºï¼ŒåŠè®¾ç½®ç±»å˜é‡çš„é»˜è®¤å€¼ã€‚ä»…ä½¿ç”¨è“å›¾è®¾ç½®çš„ç¤ºèŒƒç±»åä¸º *LightSwitch_BPOnly*ã€‚

é¦–å…ˆï¼Œè¦åˆ›å»ºè“å›¾ç±»å¹¶è¿›è¡Œè®¾ç½®ã€‚

åœ¨å†…å®¹æµè§ˆå™¨ä¸­ï¼Œä½¿ç”¨å³é”®èœå•æˆ– + ADD æŒ‰é’®ï¼Œæ‰§è¡Œ Blueprint -> Blueprint Class åˆ›å»º*LightSwitch_BPOnly*ç±»ï¼Œå¹¶é€‰æ‹© Actor ä½œä¸ºçˆ¶ç±»ã€‚

å‘è“å›¾ä¸­æ·»åŠ ç»„ä»¶çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼š

- é™æ€æ–¹å¼ï¼šåœ¨è“å›¾ç¼–è¾‘å™¨çš„*Components*é€‰é¡¹å¡ä¸­æ·»åŠ ï¼›
- åŠ¨æ€æ–¹å¼ï¼šåœ¨å›¾è¡¨ç¼–è¾‘å™¨ä¸­é€šè¿‡å¯è§†åŒ–è„šæœ¬æ·»åŠ ã€‚

ç”±äº*LightSwitch_BPOnly*ç±»å°†å§‹ç»ˆå…·æœ‰`PointLightComponent`å’Œ`SphereComponent`ï¼Œæˆ‘ä»¬åœ¨ Components é€‰é¡¹å¡ä¸­é™æ€åœ°æ·»åŠ äº†è¿™äº›ç»„ä»¶ã€‚

ä½¿ç”¨ Components é€‰é¡¹å¡æ·»åŠ `PointLightComponent`ï¼Œå°†å…¶å‘½åä¸º`PointLight1`ï¼Œä½œä¸ºæ ¹ç»„ä»¶ã€‚ç„¶åæ·»åŠ `SphereComponent`ï¼Œå°†å…¶å‘½åä¸º`Sphere1`ï¼Œé™„ç€åœ¨`PointLightComponent`ä¸Šã€‚ åœ¨è“å›¾ç¼–è¾‘å™¨ä¸­æ·»åŠ åˆ°ç±»ä¸Šçš„ç»„ä»¶å…·æœ‰æ·¡è“è‰²å›¾æ ‡ï¼Œè€Œä»çˆ¶ç±»ç»§æ‰¿çš„ç»„ä»¶åˆ™å…·æœ‰æ·±è“è‰²å›¾æ ‡ã€‚åœ¨æ–°ç‰ˆæœ¬ç¼–è¾‘å™¨ä¸­ï¼Œä½¿ç”¨ (Inherited) åç¼€è¡¨ç¤ºç»§æ‰¿è‡ªçˆ¶ç±»çš„å±æ€§ã€‚

åœ¨è“å›¾ç¼–è¾‘å™¨çš„ My Blueprint é€‰é¡¹å¡ä¸­ï¼Œä½ å¯ä»¥æ·»åŠ æ–°çš„å˜é‡ã€ å‡½æ•°å’Œå®ã€‚ä½ è¿˜å¯ä»¥è®¿é—®è“å›¾ç±»ä¸­åŒ…å«çš„æ‰€æœ‰å›¾è¡¨ ã€‚åœ¨å›¾è¡¨ä¸­ï¼ŒèŠ‚ç‚¹é€šè¿‡å¼•çº¿è¿æ¥åœ¨ä¸€èµ·ï¼Œä»¥åˆ›å»ºè®¾è®¡æ—¶åŠŸèƒ½å’Œæ¸¸æˆæ€§åŠŸèƒ½ï¼Œå®ƒä»¬å¯ç”±ç±»å˜é‡ã€æ¸¸æˆæ€§äº‹ä»¶ã€ ç”šè‡³*Actor*çš„å‘¨å›´ç¯å¢ƒé©±åŠ¨ã€‚

ä½¿ç”¨ My Blueprint é€‰é¡¹å¡å°†æµ®ç‚¹å˜é‡ *DesiredIntensity* æ·»åŠ åˆ°*LightSwitch_BPOnly*ç±»ã€‚My Blueprint é€‰é¡¹å¡ä¹Ÿä¼šæ˜¾ç¤ºåœ¨ Components çª—å£ä¸­æ·»åŠ çš„ç»„ä»¶ï¼Œè¿™æ ·ï¼Œéœ€è¦æ—¶å°±åœ¨å›¾è¡¨ä¸­è®¿é—®å®ƒä»¬ã€‚

æˆ‘ä»¬ä½¿ç”¨äº†ä¸¤ä¸ªå›¾è¡¨æ¥è®¾ç½®*LightSwitch_BPOnly*ç±»è¡Œä¸ºã€‚ç¬¬ä¸€ä¸ªå›¾è¡¨æ˜¯æ„é€ è„šæœ¬å‡½æ•°å›¾è¡¨*Construction Script*ï¼Œå®ƒåŒ…å« æ„é€ è„šæœ¬å‡½æ•°è¾“å…¥èŠ‚ç‚¹ã€‚ å½“æŸä¸ª Actor è¢«æ·»åŠ åˆ°å…³å¡æ—¶ï¼Œæˆ–æŸä¸ªç°æœ‰ Actor åœ¨å…³å¡ä¸­è¢«ç§»åŠ¨æ—¶ï¼Œæ­¤äº‹ä»¶å°†æ‰§è¡Œã€‚åœ¨ *LightSwitch_BPOnly* ç±»ä¸­ï¼Œæ„é€ è„šæœ¬äº‹ä»¶ä¸ *Set Intensity* èŠ‚ç‚¹ç›¸è¿æ¥ï¼Œè¿™æ ·ï¼Œå½“è¯¥ Actor è¢«æ·»åŠ åˆ°å…³å¡ä¸­æˆ–åœ¨å…³å¡ä¸­è¢«ç§»åŠ¨æ—¶ï¼Œ`PointLight1` çš„å¼ºåº¦ä¼šè¢«è®¾ç½®ä¸º *DesiredIntensity* çš„æ•°å€¼ã€‚

åœ¨ *LightSwitch_BPOnly* ç±»ä¸­è®¾ç½®çš„å¦ä¸€ä¸ªå›¾è¡¨æ˜¯äº‹ä»¶å›¾è¡¨*EventGraph*ã€‚åœ¨äº‹ä»¶å›¾è¡¨ä¸­ï¼Œæ‰§è¡Œä» *OnComponentBeginOverlap* å’Œ *OnComponentEndOverlap* ç­‰äº‹ä»¶å¼€å§‹ã€‚è¿™äº›äº‹ä»¶åœ¨å…³å¡ä¸­çš„æŸäº›å…¶ä»– Actor ä¸`SphereComponent`é‡å æˆ–ç¦»å¼€å®ƒæ—¶æ‰§è¡Œã€‚ä¸¤ä¸ªäº‹ä»¶éƒ½ä¸ åˆ‡æ¢å¯è§†æ€§ï¼ˆToggle Visibilityï¼‰èŠ‚ç‚¹ç›¸è¿æ¥ï¼Œè¿™æ ·ï¼Œå½“è¿™äº›äº‹ä»¶æ‰§è¡Œæ—¶ï¼Œ`PointLightComponent`çš„å¯è§†æ€§å°†è¢«åˆ‡æ¢ã€‚

å¦‚æœæ‰¾ä¸åˆ° Toggle Visibilityï¼Œåœ¨å³é”®å•å‡» èœå•ä¸­å–æ¶ˆé€‰ä¸­ Context Sensitiveï¼Œæˆ–å°è¯•åœ¨ Find a Node èœå•ä¸­æœç´¢å®ƒã€‚ä½ ä¹Ÿå¯ä»¥é€šè¿‡ä»ç‚¹å…‰æºå˜é‡èŠ‚ç‚¹ æ‹–å‡ºå¼•çº¿ï¼Œç„¶åæœç´¢"Toggle Visibility"çš„æ–¹æ³•å–å¾—ç›¸åŒçš„ç»“æœã€‚

å¦‚æœæ‰¾ä¸åˆ°`Sphere1`çš„*OnComponentEndOverlap*ï¼Œç¡®ä¿é€‰ä¸­è¯¥çƒä½“å˜é‡ï¼Œç„¶åä½¿ç”¨ä½äº Event -> Add Event ä¸­çš„èŠ‚ç‚¹ï¼Œ æˆ–è€…ä»å³é”®èœå•ä¸­ä¾æ¬¡è½¬è‡³ Add Event -> Collision -> OnComponentBeginOverlap / OnComponentEndOverlapã€‚æ–°ç‰ˆç¼–è¾‘å™¨ä¸­ï¼Œå¯ä»¥ç›´æ¥åœ¨ Components é¢æ¿ä¸Šï¼Œä½¿ç”¨ç»„ä»¶çš„å³é”®èœå•æ·»åŠ äº‹ä»¶èŠ‚ç‚¹ã€‚

åœ¨ *DesiredIntensity* å˜é‡çš„å˜é‡è®¾ç½®ä¸­ï¼Œå®ƒè¢«è®¾ç½®ä¸º *Instance Editable*ï¼Œå› æ­¤åœ¨è“å›¾ç¼–è¾‘å™¨çš„ Class Defaults ä¸­å®ƒå¯è§å¹¶ä¸”å¯è¢«ç¼–è¾‘ï¼Œæ³¨æ„è¦å…ˆç¼–è¯‘è“å›¾ä»¥æ›´æ–°çŠ¶æ€ã€‚è¿™ä¹Ÿæ„å‘³ç€å¯é’ˆå¯¹è¯¥ç±»çš„æ¯ä¸ªå®ä¾‹ä¿®æ”¹è¯¥å˜é‡ï¼Œä»¥ä½¿æ¯ä¸ª Actor éƒ½å¯ä»¥æ‹¥æœ‰å…¶è‡ªå·±çš„ *DesiredIntensity*ã€‚

å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹æ³•ä½¿ç”¨å…¶ä»–è“å›¾ç±»æ‰©å±•è“å›¾ç±»ï¼Œä½¿ç”¨å¼€å‘è€…å·¥å…· Class Viewer ä¸­ç±»æ—çš„ä¸‹æ‹‰æŒ‰é’®åˆ›å»ºæ–°è“å›¾ï¼Œæˆ–è€…ï¼Œåœ¨å†…å®¹æµè§ˆå™¨ä¸­ï¼Œä½¿ç”¨è“å›¾çš„å³é”®èœå•ï¼ŒCreate New Blueprint Based on Thisã€‚

åˆ°æ­¤ï¼Œæ‰€æœ‰æ“ä½œéƒ½æ˜¯é€šè¿‡è“å›¾ç¼–è¾‘å™¨å®Œæˆçš„ï¼Œåªæ˜¯å¯¹å„ç§èŠ‚ç‚¹çš„è¿æ¥å°±å®Œæˆäº†åŠŸèƒ½é€»è¾‘ã€‚



## âš¡ LightSwitch C++ Code Only
- https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ClassCreation/CodeOnly

ä½¿ç”¨ C++ ç±»å‘å¯¼åˆ›å»º *LightSwitchCodeOnly* ç±»ï¼Œä¸”é€‰æ‹© Actor ä½œä¸ºçˆ¶ç±»ï¼Œå› ä¸ºè¿™äº›ç±»çš„ä¸»è¦è¦æ±‚æ˜¯å®ƒä»¬å¯è¢«æ”¾ç½®åœ¨å…³å¡ä¸­ã€‚

å¤´æ–‡ä»¶ *LightSwitchCodeOnly.h* ä¸­åŒ…å«äº†è¯¥ç±»çš„å£°æ˜ã€‚ä½¿ç”¨ C++ ç±»å‘å¯¼åˆ›å»ºçš„ç±»å£°æ˜è‡ªåŠ¨é€šè¿‡ `UCLASS()` å®è¿›è¡Œå¤„ç†ï¼Œä½¿å¾—å¼•æ“æ„è¯†åˆ°è¿™ä¸ªç±»çš„å­˜åœ¨ï¼Œå¹¶ä¸”è¿˜å¯ä»¥åŒé”®ç›˜ä¿®é¥°ç¬¦ç»“åˆä½¿ç”¨æ¥åœ¨å¼•æ“ä¸­è®¾ç½®è¯¥ç±»çš„è¡Œä¸ºã€‚

ç±»å£°æ˜åŒ…å«å¾ˆå¤šå˜é‡ å’Œ/æˆ– å‡½æ•°å£°æ˜ã€‚ è¿™äº›å¯ä»¥é€šè¿‡ UPROPERTY() å’Œ UFUNCTION() å®åˆ†åˆ«è¿›è¡Œå¤„ç†ï¼Œè¿™äº›å®çš„åŠŸèƒ½å’Œ`UCLASS()` å®ç±»ä¼¼ã€‚
ç»„ä»¶ä¹Ÿå’Œ`UPROPERTY()`å®ä¸€èµ·è®¾ç½®ã€‚

å£°æ˜*PointLightComponent* å’Œ *SphereComponent*ï¼ŒäºŒè€…éƒ½è®¾ç½®ä¸º *VisibleAnywhere*ï¼Œè¿™æ„å‘³ç€å¯ä»¥åœ¨ Actor ç¼–è¾‘ç•Œé¢çš„ Details é€‰å¡ä¸­çœ‹åˆ°å®ƒä»¬çš„å±æ€§ã€‚

å¦å¤–ï¼Œç”±äºå¼•æ“ç‰ˆæœ¬çš„å‡çº§ï¼Œéœ€è¦å¼•å…¥ä¸åŒçš„å¤´æ–‡ä»¶ã€‚è€Œ*bVisible* æ”¹å˜ä¸ºç§æœ‰å±æ€§ï¼Œéœ€è¦é€šè¿‡*SetVisibleFlag*æ–¹æ³•è®¾ç½®ã€‚

```C++
// #include "CoreMinimal.h"
#include "Components/PointLightComponent.h"
#include "Components/SphereComponent.h"

// PointLight1->bVisible = true;
PointLight1->SetVisibleFlag(true);
```

å£°æ˜ `OnOverlapBegin` å’Œ`OnOverlapEnd`å‡½æ•°, å½“å¦ä¸€ä¸ª Actor è¿›å…¥æˆ–ç¦»å¼€ *SphereComponent* æ—¶å°†è°ƒç”¨è¯¥å‡½æ•°ã€‚å½“ä¸€ä¸ª Actor å’Œ SphereComponent ç›¸é‡å æˆ–è€…ç¦»å¼€é‡å åŒºæ—¶ï¼ŒæŒ‡å®š`OnOverlap`å‡½æ•°ä½œä¸ºå§”æ‰˜è¿›è¡Œè°ƒç”¨ã€‚è¿›å…¥æˆ–ç¦»å¼€å¯¹åº”çš„å§”æ‰˜æ˜¯*OnComponentBeginOverlap*å’Œ*OnComponentEndOverlap*ï¼Œè°ƒç”¨*AddDynamic*è¡¨ç¤ºæ³¨å†Œä¸€ä¸ª *OverlapAllDynamic* é…ç½®çš„äº‹ä»¶å“åº”æ–¹å¼ï¼Œå³åœ¨é»˜è®¤æƒ…å†µä¸‹ `WorldDynamic` ä¸æ‰€æœ‰ Actor å¯¹è±¡é‡å æ—¶éƒ½ä¼šæ‰§è¡Œé‡å äº‹ä»¶ã€‚é‡å äº‹ä»¶çš„è§¦å‘æ¡ä»¶å‚è€ƒ Collision ç¢°æ’æ£€æµ‹æœºåˆ¶ã€‚

ä¸€ä¸ªæ›´å¥½çš„æ”¹è¿›æ˜¯ï¼Œå¢åŠ ä¸€ä¸ªå¼€å…³å±æ€§ï¼Œé€šè¿‡ç¼–è¾‘å™¨æ¥æŒ‡å®šè¿™ä¸ªå¼€å…³ï¼Œå¹¶ä¸”å¼€å…³å¯ä»¥æ”¾ç½®åœ¨åœºæ™¯çš„ä»»ä½•åœ°å€ï¼Œè§¦å‘å¼€å…³æ‰æ‰§è¡Œå¼€ç¯æˆ–å…³ç¯ã€‚

å£°æ˜ *DesiredIntensity* å˜é‡ï¼Œå¹¶ä½¿ç”¨ `VisibleAnywhere` ä¿®é¥°ç¬¦è®¾ç½®è¯¥å±æ€§ä¸ºåœ¨ä»»ä½•åœ°æ–¹éƒ½å¯è§ã€‚ æ­¤å±æ€§å°†æ˜¾ç¤ºåœ¨ *LightSwitchCodeOnly* Actorçš„ Detailsï¼ˆè¯¦ç»†ä¿¡æ¯ï¼‰ é€‰å¡ä¸­çš„ Switch Variablesï¼ˆåˆ‡æ¢å˜é‡ï¼‰ ç±»ç›®ä¸­ã€‚ å¯¹äºä¸æ˜¯å­å¯¹è±¡çš„å˜é‡ï¼Œæ¯”å¦‚è¿™ä¸ªæµ®ç‚¹å€¼ï¼Œ`VisibleAnywhere` ä¿®é¥°ç¬¦å°†ä½¿å¾—è¯¥å˜é‡æ˜¾ç¤ºåœ¨è¯¦ç»†ä¿¡æ¯é€‰å¡ä¸­ã€‚ ä½ è¿˜å¯ä»¥ä½¿ç”¨ `EditAnywhere`ä¿®é¥°ç¬¦ï¼Œä½†æ˜¯ç”±äºæ­¤å˜é‡ä»…åœ¨æŠŠ Actor æ·»åŠ åˆ°å…³å¡ä¸­æ—¶ä½¿ç”¨ï¼Œæ‰€ä»¥ä¸éœ€è¦è®¾ç½®æˆä¸ºå¯ç¼–è¾‘çš„ã€‚

æºæ–‡ä»¶ä¸­å®šä¹‰ç±»å£°æ˜è¿‡çš„å‡½æ•°ï¼Œæ¯”å¦‚ï¼ŒLightSwitchCodeOnly.cpp ä¸­æœ‰ `OnOverlapBegin` å’Œ `OnOverlapEnd`å‡½æ•°çš„å®ç°ï¼Œè¯¥å‡½æ•°é€šè¿‡è°ƒç”¨`ToggleLight`æ¥åˆ‡æ¢*PointLightComponent*çš„å¯è§æ€§ï¼Œé€šå¸¸å…‰æºçš„`ToggleVisibility`æ–¹æ³•ã€‚

å¦‚æœè¿™æ˜¯ä½ æ·»åŠ åˆ°ç©ºç™½é¡¹ç›®çš„ç¬¬ä¸€ä¸ªä»£ç ç±»ï¼Œä½ éœ€è¦å…³é—­è™šå¹»ç¼–è¾‘å™¨ï¼Œåœ¨ Visual Studio æˆ– Xcode ä¸­ç¼–è¯‘é¡¹ç›®ï¼Œç„¶åæ‰“å¼€è™šå¹»ç¼–è¾‘å™¨å¹¶é‡æ–°æ‰“å¼€é¡¹ç›®ï¼Œä»¥ç¡®ä¿åˆ›å»ºäº†æ¸¸æˆæ¨¡å—å¹¶æ­£ç¡®è½½å…¥ã€‚ åŒæ—¶ï¼Œéœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œè¦ç¡®ä¿ Build Configuration å’Œä½ æ‰“å¼€è¯¥é¡¹ç›®ä½¿ç”¨çš„è™šå¹»ç¼–è¾‘å™¨å¯æ‰§è¡Œæ–‡ä»¶çš„ç‰ˆæœ¬ä¸€è‡´ã€‚

å¦‚æœä½ æ­£åœ¨æ·»åŠ ä»£ç åˆ°ç°å­˜çš„ C++ é¡¹ç›®ï¼Œä½ å¯ä»¥ä½¿ç”¨ Hot Reload åŠŸèƒ½æ¥ç¼–è¯‘è™šå¹»ç¼–è¾‘å™¨ä¸­çš„æ–°ä»£ç ã€‚

C++ ç±»æ—¢å¯ä»¥é€šè¿‡ C++ ç±»è¿›è¡Œæ‰©å±•ä¹Ÿå¯ä»¥é€šè¿‡ç±»è“å›¾è¿›è¡Œæ‰©å±•ã€‚åœ¨ C++ ç±»å‘å¯¼ä¸­åŠåœ¨ç±»è“å›¾åˆ›å»ºè¿‡ç¨‹ä¸­çš„ Pick Parent Class çª—å£çš„ Custom Classes éƒ¨åˆ†ä¸­é€‰ä¸­ Show All Classes å¤é€‰æ¡†ï¼Œä¾¿å¯ä»¥æ˜¾ç¤ºè¿™ä¸¤ç§æ‰©å±•é€‰é¡¹ã€‚

*LightSwitchCodeOnly*ä½äºç±»æŸ¥çœ‹å™¨ä¸­ï¼Œå¯ä»¥ä»é‚£é‡Œå°†å…¶æ‹–æ‹½åˆ°å…³å¡ä¸­ã€‚

æœ€ç»ˆçš„ C++ å®ç°çš„ *LightSwitchCodeOnly* æ–‡ä»¶å¦‚ä¸‹æ‰€ç¤ºï¼Œæ›¿æ¢`[PROJECTNAME]`ä¸ºç›¸åº”çš„å·¥ç¨‹åï¼š

```C++,
    // LightSwitchCodeOnly.h
    // Copyright 1998-2018 Epic Games, Inc. All Rights Reserved.

    #pragma once

    #include "GameFramework/Actor.h"
    #include "LightSwitchCodeOnly.generated.h"

    /**
     * 
     */
    UCLASS()
    class [PROJECTNAME]_API ALightSwitchCodeOnly : public AActor
    {
        GENERATED_BODY()
        public:
        /** ç‚¹å…‰æºç»„ä»¶ */
        UPROPERTY(VisibleAnywhere, Category = "Switch Components")
        class UPointLightComponent* PointLight1;

        /** çƒä½“ç»„ä»¶ */
        UPROPERTY(VisibleAnywhere, Category = "Switch Components")
        class USphereComponent* Sphere1;

        ALightSwitchCodeOnly();

        /** å½“æŸå¯¹è±¡è¿›å…¥çƒä½“ç»„ä»¶æ—¶è°ƒç”¨ */
        UFUNCTION()
        void OnOverlapBegin(class UPrimitiveComponent* OverlappedComp, class AActor* OtherActor, class UPrimitiveComponent* OtherComp, int32 OtherBodyIndex, bool bFromSweep, const FHitResult& SweepResult);

        /** å½“æŸå¯¹è±¡ç¦»å¼€çƒä½“ç»„ä»¶æ—¶è°ƒç”¨ */
        UFUNCTION()
        void OnOverlapEnd(class UPrimitiveComponent* OverlappedComp, class AActor* OtherActor, class UPrimitiveComponent* OtherComp, int32 OtherBodyIndex);

        /** åˆ‡æ¢å…‰ç…§ç»„ä»¶çš„å¯è§æ€§*/
        UFUNCTION()
        void ToggleLight();

        /** è¯¥å…‰ç…§çš„æ‰€éœ€å¼ºåº¦ */
        UPROPERTY(VisibleAnywhere, Category = "Switch Variables")
        float DesiredIntensity;

    };


    // LightSwitchCodeOnly.cpp
    // Copyright 1998-2018 Epic Games, Inc. All Rights Reserved.

    #include "BasicClasses.h"
    #include "LightSwitchCodeOnly.h"

    ALightSwitchCodeOnly::ALightSwitchCodeOnly()
    {
        DesiredIntensity = 3000.0f;

        PointLight1 = CreateDefaultSubobject<UPointLightComponent>(TEXT("PointLight1"));
        PointLight1->Intensity = DesiredIntensity;
        PointLight1->bVisible = true;
        RootComponent = PointLight1;

        Sphere1 = CreateDefaultSubobject<USphereComponent>(TEXT("Sphere1"));
        Sphere1->InitSphereRadius(250.0f);
        Sphere1->SetupAttachment(RootComponent);

        Sphere1->OnComponentBeginOverlap.AddDynamic(this, &ALightSwitchCodeOnly::OnOverlapBegin);       // å½“æ­¤ç»„ä»¶ä¸æŸå¯¹è±¡é‡å æ—¶ï¼Œè®¾ç½®é€šçŸ¥
        Sphere1->OnComponentEndOverlap.AddDynamic(this, &ALightSwitchCodeOnly::OnOverlapEnd);       // å½“æ­¤ç»„ä»¶ä¸æŸå¯¹è±¡é‡å æ—¶ï¼Œè®¾ç½®é€šçŸ¥

    }

    void ALightSwitchCodeOnly::OnOverlapBegin(class UPrimitiveComponent* OverlappedComp, class AActor* OtherActor, class UPrimitiveComponent* OtherComp, int32 OtherBodyIndex, bool bFromSweep, const FHitResult& SweepResult)
    {
        if (OtherActor && (OtherActor != this) && OtherComp)
        {
            ToggleLight();
        }
    }

    void ALightSwitchCodeOnly::OnOverlapEnd(class UPrimitiveComponent* OverlappedComp, class AActor* OtherActor, class UPrimitiveComponent* OtherComp, int32 OtherBodyIndex)
    {
        if (OtherActor && (OtherActor != this) && OtherComp)
        {
            ToggleLight();
        }
    }

    void ALightSwitchCodeOnly::ToggleLight()
    {
        PointLight1->ToggleVisibility();
    }
```

## âš¡ LightSwitch with both C++ & Blueprint
- https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ClassCreation/CodeAndBlueprints

åˆ©ç”¨è“å›¾å¯å»¶ä¼¸ C++ï¼Œç¨‹åºå‘˜å¯åœ¨ä»£ç ä¸­è®¾ç½®æ–°çš„ Gameplay ç±»ï¼Œå…³å¡è®¾è®¡å¸ˆå¯åˆ©ç”¨è“å›¾ç¼–è¯‘å’Œä¿®æ”¹æ­¤ç±»ä»£ç ã€‚æœ‰äº›è¯´æ˜ç¬¦å¯ä¿®æ”¹ C++ ç±»ä¸è“å›¾ç³»ç»Ÿçš„äº¤äº’æ–¹å¼ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†å°†åœ¨æœ¬èŒƒä¾‹ä¸­é«˜äº®æ˜¾ç¤ºã€‚

ç±»è®¾ç½®çš„ç¬¬ä¸€éƒ¨åˆ†ï¼šä½¿ç”¨ C++ ç±»å‘å¯¼åˆ›å»ºåä¸º *LightSwitchBoth* çš„ç±»ï¼Œå¤§å¤šæ•°ä»£ç ä¸çº¯ C++ å®ç°çš„èŒƒä¾‹ä¸­çš„ä»£ç ç±»ä¼¼ã€‚å¯ä½¿ç”¨è“å›¾å»¶å±• *LightSwitchCodeOnly* ç±»ï¼Œä½†æ˜¯è“å›¾å›¾è¡¨æ— æ³•è®¿é—®è¿™ä¸ªç±»ä¸­çš„ç»„ä»¶ã€å˜é‡å’Œå‡½æ•°ã€‚

æ­¤èŒƒä¾‹å°†è®²è§£ *UPROPERTY()* å’Œ *UFUNCTION()* è¯´æ˜ç¬¦ï¼Œé€šè¿‡åœ¨è¿™ä¸¤ä¸ªè¯´æ˜ç¬¦ä¸­æŒ‡å®šè¯´æ˜ç¬¦ï¼Œå°±å¯ä½¿ C++ å®ç°çš„*LightSwitchBoth*ä½œä¸ºæ´¾ç”Ÿè‡ªå…¶ä¸­çš„è“å›¾æ¨¡æ¿è¿›è¡Œè¿ä½œã€‚

é¦–å…ˆå‚è€ƒçº¯ C++ å…‰æºå¼€å…³èŒƒä¾‹ä¼šååˆ†æœ‰ç”¨ï¼Œå¯äº†è§£è®¾ç½®æ ‡å¤´æ–‡ä»¶å’Œæºæ–‡ä»¶æ¥åˆ›å»º LightSwitchComponentã€SphereComponentã€DesiredIntensity å˜é‡å’Œ OnOverlap å‡½æ•°çš„æ–¹æ³•ã€‚

æ­¤æ ‡å¤´æ–‡ä»¶æºè‡ªçº¯ C++ å…‰æºå¼€å…³èŒƒä¾‹ï¼Œä»¥æ·»åŠ ä»¥ä¸‹åŠŸèƒ½ï¼š

- *PointLightComponent*å’Œ*SphereComponent*ä¸º`BlueprintReadOnly`ï¼Œåœ¨è“å›¾ç¼–è¾‘å™¨çš„ My Blueprint é€‰é¡¹å¡çš„ Switch Components ç›®å½•ä¸­æ˜¾ç¤ºä½†ä¸å¯ç¼–è¾‘ï¼Œé€šè¿‡ *Category* è¯´æ˜ç¬¦äº§ç”Ÿç›®å½•ã€‚
- *DesiredIntensity*ä¸º`BlueprintReadWrite`ï¼Œç°ä¸º`EditAnywhere`ï¼Œè€Œé`VisibleAnywhere`ã€‚å°†åœ¨ My Blueprint é€‰é¡¹å¡çš„ Switch Variables ç›®å½•ä¸­æ˜¾ç¤ºã€‚

æœ€é‡è¦çš„æ˜¯*OnOverlapBegin*å’Œ*OnOverlapEnd*ç°ä¸º`BlueprintNativeEvents`ï¼Œå®ƒå‘Šè¯‰å¼•æ“è¿™æ˜¯ä¸€ä¸ªå¯ä»¥ç”±è“å›¾è¿›è¡Œè¦†ç›–å®ç°çš„ç±»å‡½æ•°ï¼Œå³é€šè¿‡è“å›¾ä¿®æ”¹ C++ ä»£ç ã€‚æˆ–è€…è¯´å¼•æ“é€šè¿‡ç»™ C++ å‡½æ•°åŠ åç¼€*_Implementation*ï¼Œå¹¶ä¸”æä¾›è‡ªå·±çš„ç”Ÿæˆä»£ç æ¥ä¸è“å›¾å®ç°çš„å‡½æ•°ç»‘å®šã€‚å¦‚æœè“å›¾æ²¡æœ‰æä¾›å®ç°ï¼Œé‚£ä¹ˆå¼•æ“å°±è°ƒç”¨ C++ çš„åŠ åç¼€ç‰ˆæœ¬å‡½æ•°ï¼Œä»è€Œå®ç° C++ ä»£ç çš„æ”¹å†™ã€‚å°†åœ¨ My Blueprint é€‰é¡¹å¡çš„ Switch Functions ç›®å½•ä¸­æ˜¾ç¤ºã€‚åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œåªéœ€è¦æä¾›åç¼€*_Implementation*ç‰ˆæœ¬çš„å‡½æ•°å®ç°å³å¯ï¼ŒåŸå‹ç”±å¼•æ“è‡ªåŠ¨å®ç°ã€‚

å½“ç„¶ï¼ŒC++ å®ç°çš„å¸¦åç¼€ç‰ˆæœ¬å‡½æ•°è¿˜å¯ä»¥æä¾›ç»™è“å›¾è¿›è¡Œè°ƒç”¨ï¼Œåªéœ€è¦åœ¨è¯´æ˜ `UFUNCTION()` æ—¶ä½¿ç”¨è¯´æ˜ç¬¦`BlueprintCallable`ã€‚

`UCLASS()` å®å«æœ‰ `Blueprintable` è¯´æ˜ç¬¦ã€‚*LightSwitchBoth*å¯è®¾ä¸ºè“å›¾ä¸”ç›´æ¥ç»§æ‰¿è‡ª Actorï¼Œè€Œå¯è®¾ä¸ºè“å›¾è¯´æ˜ç¬¦å·²ç»§æ‰¿ï¼Œå› æ­¤å…¶åœ¨æ­¤æƒ…å†µä¸‹å¹¶éå¿…éœ€ã€‚

æœ‰äº† `UPROPERTY()` å’Œ `UFUNCTION()` å®ä¸­çš„é™„åŠ è¯´æ˜ç¬¦åï¼Œ*LightSwitchBoth* ç±»çš„å®ç°ä»£ç åœ¨åé¢ä¸€èµ·å±•ç¤ºã€‚

ç¼–è¯‘æ­¤ç±»åï¼Œå°±å¯ä»¥å°†å…¶æ‰©å±•ä¸ºè“å›¾ç±»ã€‚æ“ä½œè·¯å¾„ï¼šContent Browser -> C++ Classesï¼Œä½¿ç”¨ç±»çš„å³é”®èœå• Create Blueprint Class Base on LightSwitchBothã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ*LightSwitchBoth*è¢«ç”¨ä½œè“å›¾çš„çˆ¶ç±»ï¼Œç„¶åæŒ‡å®šå‘½åä¸º *LightSwitchBoth_BP*ï¼Œå¹¶ä¿å­˜ã€‚

C++ ä¸­æ·»åŠ çš„*PointLightComponent*å’Œ*SphereComponent*åŒæ ·ä¼šåœ¨è“å›¾ç¼–è¾‘å™¨ä¸­çš„ *Components* é€‰é¡¹å¡ä¸­æ˜¾ç¤ºã€‚å…¶å›¾æ ‡ä¸ºæ·±è“è‰²ï¼Œè¡¨æ˜ä¸ºç»§æ‰¿è‡ªçˆ¶ç±»*LightSwitchBoth*çš„åŸç”Ÿç»„ä»¶ã€‚è€Œæ·»åŠ è‡³ *LightSwitchBoth_BP* è“å›¾çš„æ–°ç»„ä»¶å°†æ˜¾ç¤ºä¸ºæ·¡è“è‰²å›¾æ ‡ã€‚å…·ä½“å‚è€ƒåç§°åé¢æ‹¬å·çš„æç¤ºï¼Œ(Inherited) è¡¨ç¤ºç»§æ‰¿è‡ªçˆ¶ç±»ã€‚

è“å›¾ç¼–è¾‘å™¨ç»„ä»¶çš„ Components å’Œ My Blueprint é¢æ¿æ˜¯è“å›¾ç¼–è¾‘çš„æ ¸å¿ƒï¼Œåœ¨é¢æ¿å†…ï¼Œå¯æ·»åŠ æ–°çš„å˜é‡ã€å‡½æ•°å’Œå®ã€‚åŒæ—¶å¯å­˜å–è“å›¾å†…çš„æ‰€æœ‰å›¾è¡¨ï¼Œå›¾è¡¨ä¸­çš„èŠ‚ç‚¹äº’ç›¸è¿çº¿ï¼Œåˆ›å»ºç”±ç±»å˜é‡ã€Gameplay äº‹ä»¶ï¼Œç”šè‡³æ˜¯ Actor å‘¨å›´ç¯å¢ƒï¼Œç”¨å®ƒä»¬æ¥é©±åŠ¨è®¾è®¡æ—¶å’Œ Gameplay åŠŸèƒ½ã€‚

æˆ‘çš„è“å›¾ï¼ˆMy Blueprintï¼‰é€‰é¡¹å¡æ˜¾ç¤ºäº†æ·»åŠ åˆ° C++ ç±»*LightSwitchBoth*ä¸­çš„*PointLightComponent*å’Œ*SphereComponent*ã€‚è¿™æ˜¯å› ä¸ºæŒ‡å®šäº† `BlueprintReadOnly` è¯´æ˜ç¬¦äº§ç”Ÿçš„ã€‚åœ¨ My Blueprint ä¸­ç‚¹å‡»æ­¤ç±»ç»„ä»¶çš„èŠ‚ç‚¹å¹¶å°†å…¶æ‹–å…¥å›¾è¡¨ï¼Œå³å¯æ·»åŠ è‡³å›¾è¡¨ï¼Œåˆ›å»ºç›¸åº”çš„è“å›¾èŠ‚ç‚¹ã€‚ä¹‹åå¯å°†è¿™äº›èŠ‚ç‚¹ä¸ä¿®æ”¹å˜é‡å¯è§†åº¦æˆ–å…‰æºé¢œè‰²çš„å˜é‡ç›¸è¿æ¥ã€‚*DesiredIntensity* å˜é‡åŒæ ·åœ¨ My Blueprint é€‰é¡¹å¡ä¸­æ˜¾ç¤ºã€‚å…¶ä¸ºå˜é‡è€Œéç»„ä»¶ï¼Œå› æ­¤å¯ä½¿ç”¨ *BlueprintReadWrite* è¯´æ˜ç¬¦ã€‚è¿™æ„å‘³å¯åˆ›å»ºèŠ‚ç‚¹åœ¨è“å›¾å›¾è¡¨ä¸­åŒæ—¶è·å–å’Œèµ‹äºˆ *DesiredIntensity* çš„å€¼ã€‚

é»˜è®¤ä¸æ˜¾ç¤ºçˆ¶*LightSwitchBoth*ç±»çš„ç»„ä»¶å’Œå˜é‡ã€‚å‹¾é€‰ My Blueprint é€‰é¡¹å¡è®¾ç½®é€‰é¡¹ Show inherited variables å³å¯ä»¥æ˜¾ç¤ºç»§æ‰¿è‡ªçˆ¶ç±»çš„å˜é‡ã€‚

æœ‰ä¸¤ç§å›¾è¡¨ç”¨äºè®¾ç½®*LightSwitchBoth_BP*ç±»åœ¨åœºæ™¯ä¸­è¢«ç¼–è¾‘æ—¶çš„è¡Œä¸ºï¼š

- ç¬¬ä¸€ç§æ˜¯æ„é€ è„šæœ¬å›¾è¡¨ï¼Œ`Construction Script`ï¼Œå«æœ‰ä¸“ç”¨çš„æ„é€ è„šæœ¬äº‹ä»¶ã€‚
- ç¬¬äºŒç§æ˜¯ä½¿ç”¨ `EventGraph` äº‹ä»¶å›¾è¡¨ã€‚

Actor åœ¨å…³å¡ç¼–è¾‘å™¨ä¸­ç§»åŠ¨æˆ–ä¿®æ”¹*DesiredIntensity*æ—¶ï¼Œæ„é€ è„šæœ¬ä¼šè¢«æ‰§è¡Œã€‚ä½¿ç”¨æ„é€ è„šæœ¬æ„å‘³ç€å¯è½»æ˜“ä¿®æ”¹å…¬å¼€åˆ°è“å›¾çš„ Actor å˜é‡ï¼Œè¿˜èƒ½å¿«é€Ÿåœ°çœ‹åˆ°è¿™äº›å˜æ›´çš„æ•ˆæœã€‚è‹¥æœªè®¾ç½®æ„é€ è„šæœ¬ï¼Œæ–°çš„ *LightSwitchBoth_BP* å®ä¾‹å°†åªä½¿ç”¨*LightSwitchBoth*æ„é€ å‡½æ•°ã€‚

å¯ä»¥åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªè°ƒè¯•è¯­å¥ï¼Œå°†æ¶ˆæ¯æ‰“å°åœ¨å±å¹•çš„å·¦ä¸Šè§’ï¼š

```C++
if (GEngine != nullptr)
{
    GEngine->AddOnScreenDebugMessage(-1, 5.0, FColor::Yellow, TEXT("LightSwitchBoth constructor..."));
}
```

æ‰“å¼€ *LightSwitchBoth_BP* ç±»ä¸­çš„æ„é€ è„šæœ¬äº‹ä»¶å›¾è¡¨ï¼Œä» Components å°†*PointLight1*æ‹–åˆ°å›¾è¡¨ä¸Šåˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹ï¼Œç„¶åä»è¾“å‡ºç«¯å¼•å‡º Set Intensity èŠ‚ç‚¹ã€‚å› æ­¤å°† Actor æ·»åŠ è‡³å…³å¡ä¸­æˆ–åœ¨å…¶ä¸­ç§»åŠ¨æ—¶ï¼Œæˆ–æ˜¯ *DesiredIntensity* å‘ç”Ÿå˜æ›´æ—¶ï¼Œ*PointLightComponent*çš„äº®åº¦å°†æ›´æ–°ä¸ºç›¸åº”çš„å€¼ã€‚

æ¯”å¦‚ï¼Œæ ¹æ®é«˜åº¦æ¥æ”¹å˜ç¯å…‰äº®åº¦ï¼š

- åˆ›å»º self è‡ªèº«å¼•ç”¨èŠ‚ç‚¹ï¼›
- ä» self èŠ‚ç‚¹è¾“å‡ºç«¯å¼•å‡º Get Actor Location èŠ‚ç‚¹ï¼›
- å†ä» ActorLocation è¾“å‡ºç«¯å¼•å‡º Break Vector èŠ‚ç‚¹ï¼Œå°† Vector åˆ†è§£æˆ X/Y/Z ä¸‰ä¸ªåˆ†é‡ï¼›
- å¹¶ä½¿ç”¨ä¸€ä¸ª Multiply èŠ‚ç‚¹å°† Z ä¹˜ä¸Šä¸€ä¸ªæ¯”ä¾‹å€¼ï¼Œå¦‚ 50ï¼Œå†å°†ä¹˜ç§¯è¾“å‡ºè¿æ¥åˆ° Set Intensity èŠ‚ç‚¹çš„å¼ºåº¦è¾“å…¥ç«¯ã€‚

è®¾ç½®*LightSwitchBoth_BP*ç±»çš„å¦ä¸€ä¸ªå›¾è¡¨æ˜¯äº‹ä»¶å›¾è¡¨ï¼Œ*EventGraph* ä¸­çš„æ‰§è¡Œå°†ä»å„ç§äº‹ä»¶å¼€å§‹ã€‚å› æ­¤ï¼ŒC++ å®šä¹‰çš„ *OnOverlap* è¢«è°ƒç”¨æ—¶ï¼Œå¯¹åº”è“å›¾ä¸­çš„*OnOverlap*äº‹ä»¶å°†æ‰§è¡Œã€‚åœ¨*LightSwitchBoth*æºæ–‡ä»¶ä¸­è®¾ç½®å§”æ‰˜ï¼Œé€šè¿‡ *AddDynamic* æ–¹æ³•å‘ *OnComponentBeginOverlap* å’Œ *OnComponentEndOverlap*å§”æ‰˜äº†ä¸¤ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œä»¥ä¾¿ Actor è¿›å…¥æˆ–ç¦»å¼€*SphereComponent*æ—¶æ¿€å‘*OnOverlap*äº‹ä»¶ã€‚

è®¾ç½®è“å›¾èŠ‚ç‚¹ä»¥è¦†ç›– C++ ä»£ç é€»è¾‘ï¼š

- ç‚¹å‡» Functions é¢æ¿ä¸Šçš„ Override ä¸‹æ‹‰åˆ—è¡¨ï¼Œæˆ–è€…ä½¿ç”¨å³é”®èœå•ï¼ŒOverride Functions -> On BeginOverlap Event åˆ›å»ºäº‹ä»¶èŠ‚ç‚¹ã€‚
- å°†*OnOverlap* äº‹ä»¶èŠ‚ç‚¹ä¸ Set Light Color èŠ‚ç‚¹ç›¸è¿ï¼Œäº‹ä»¶æ‰§è¡Œæ—¶è®¾ç½®*PointLightComponent*çš„å…‰æºé¢œè‰²ä¸ºéšæœºé¢œè‰²ã€‚
- è¿™ä¸ªäº‹ä»¶ä¼šè¦†ç›– C++ æºæ–‡ä»¶ä¸­çš„ *OnOverlap_Implementation* åŠŸèƒ½ï¼Œå°†æ”¹å†™åŸæ¥ C++ ä¸­çš„*PointLightComponent*çš„é€»è¾‘ã€‚
- åˆ›å»ºä¸€ä¸ª Make LinearColor æˆ– Color èŠ‚ç‚¹ï¼ŒAlpha è®¾ç½®ä¸º 1.0ï¼ŒRGB ä¸‰ä¸ªåˆ†é‡ä½¿ç”¨ Random Float in Range ç”Ÿæˆéšæœºçš„ 0.0 ~ 1.0 ä¹‹é—´çš„å€¼ã€‚ä½¿ç”¨ Ctrl + W å¯ä»¥å¤åˆ¶èŠ‚ç‚¹ï¼Œä½¿ç”¨ Home èšé›†é€‰ä¸­çš„èŠ‚ç‚¹ã€‚

*LightSwitchBoth*æ ‡å¤´æ–‡ä»¶ä¸­çš„ *DesiredIntensity* å˜é‡è®¾ä¸º`EditAnywhere`ï¼Œå› æ­¤ï¼Œåœ¨è“å›¾ç¼–è¾‘å™¨çš„é»˜è®¤é¡¹ä¸­å¯è§ã€‚ç‚¹å‡» Class Defaults  æŒ‰é’®åœ¨ç»†èŠ‚é¢æ¿ä¸­æ˜¾ç¤ºç±»é»˜è®¤é¡¹åï¼Œå³å¯å¯¹å…¶è¿›è¡Œç¼–è¾‘ã€‚è¿™ä¹Ÿæ„å‘³ç€å¯ä¾æ®ç±»çš„å„å®ä¾‹ä¿®æ”¹å˜é‡ï¼Œä»¥ä¾¿å„ Actor å¯æ‹¥æœ‰å„è‡ªçš„*DesiredIntensity*ã€‚åŒæ ·ï¼Œä¸ºäº†åœ¨æ„é€ è„šæœ¬ä¸­è¯»å†™ï¼Œä½¿ç”¨`BlueprintReadWrite`ï¼Œå› æ­¤å¯¹å…¶è¿›è¡Œæ›´æ–°ä¹Ÿä¼šå¯¼è‡´æ„é€ è„šæœ¬å†æ¬¡æ‰§è¡Œã€‚

è“å›¾ç±»ä¹Ÿå¯ä»¥è¢«å»¶å±•æˆï¼Œä½¿ç”¨ç±»æŸ¥çœ‹å™¨(æ–°ç‰ˆå·²ç»ç§»é™¤æ­¤ç•Œé¢)ï¼ŒWindow -> Developer Tools -> Class Viewerï¼Œç±»æ—çš„ä¸‹æ‹‰æŒ‰é’®ï¼Œæˆ–æ˜¯ä½¿ç”¨è“å›¾ç±»å³é”®èœå• Create New Blueprint Based on Thisï¼Œæ–°å»ºè“å›¾ã€‚

è“å›¾ç±»*LightSwitchBoth_BP*ä½äºå†…å®¹æµè§ˆå™¨ä¸­ï¼Œå¯å°†å…¶ä»å…¶ä¸­æ‹–å…¥å…³å¡ã€‚è¯¥è“å›¾ç±»åŒæ ·ä½äºç±»æŸ¥çœ‹å™¨ä¸­ã€‚

```C++ï¼Œ
    // LightSwitchBoth.h
    // ç‰ˆæƒæ‰€æœ‰ 1998-2018 Epic Games, Inc. ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚

    #pragma once

    #include "GameFramework/Actor.h"
    #include "LightSwitchBoth.generated.h"

    /**
     * çº¯C++ä»£ç å®ç°çš„ï¼Œå¹¶ä¸”å¯ä»¥è¢«è“å›¾æ”¹å†™çš„ï¼ˆBlueprintNativeEventï¼‰è‡ªåŠ¨å…‰æºå¼€å…³
     */
    UCLASS()
    class [PROJECTNAME]_API ALightSwitchBoth : public AActor
    {
        GENERATED_BODY()
        public:
        /** ç‚¹å…‰æºç»„ä»¶ */
        UPROPERTY(VisibleAnywhere, BlueprintReadOnly, Category="Switch Components")
        class UPointLightComponent* PointLight1;

        /** çƒä½“ç»„ä»¶ */
        UPROPERTY(VisibleAnywhere, BlueprintReadOnly, Category="Switch Components")
        class USphereComponent* Sphere1;

        ALightSwitchBoth();

        /** å½“æŸå¯¹è±¡è¿›å…¥çƒä½“ç»„ä»¶æ—¶è°ƒç”¨ï¼ˆBlueprintNativeEventï¼‰å¯åœ¨è“å›¾ä¸­æ”¹å†™ */
        UFUNCTION(BlueprintNativeEvent, Category="Switch Functions")
        void OnOverlapBegin(class UPrimitiveComponent* OverlappedComp, class AActor* OtherActor, class UPrimitiveComponent* OtherComp, int32 OtherBodyIndex, bool bFromSweep, const FHitResult& SweepResult);

        void OnOverlapBegin_Implementation(class UPrimitiveComponent* OverlappedComp, class AActor* OtherActor, class UPrimitiveComponent* OtherComp, int32 OtherBodyIndex, bool bFromSweep, const FHitResult& SweepResult);

        /** å½“æŸå¯¹è±¡ç¦»å¼€çƒä½“ç»„ä»¶æ—¶è°ƒç”¨ï¼ˆBlueprintNativeEventï¼‰å¯åœ¨è“å›¾ä¸­æ”¹å†™ */
        UFUNCTION(BlueprintNativeEvent, Category="Switch Functions")
        void OnOverlapEnd(class UPrimitiveComponent* OverlappedComp, class AActor* OtherActor, class UPrimitiveComponent* OtherComp, int32 OtherBodyIndex);

        void OnOverlapEnd_Implementation(class UPrimitiveComponent* OverlappedComp, class AActor* OtherActor, class UPrimitiveComponent* OtherComp, int32 OtherBodyIndex);

        /** åˆ‡æ¢å…‰æºç»„ä»¶çš„å¯è§†æ€§*/
        UFUNCTION()
        void ToggleLight();

        /** å…‰æºçš„ç†æƒ³å¼ºåº¦ */
        UPROPERTY(EditAnywhere, BlueprintReadWrite, Category="Switch Variables")
        float DesiredIntensity;

    };


    // LightSwitchBoth.cpp
    // ç‰ˆæƒæ‰€æœ‰ 1998-2018 Epic Games, Inc. ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚

    #include "BasicClasses.h"
    #include "LightSwitchBoth.h"

    ALightSwitchBoth::ALightSwitchBoth()
    {

        DesiredIntensity = 3000.0f;

        PointLight1 = CreateDefaultSubobject<UPointLightComponent>(TEXT("PointLight1"));
        PointLight1->Intensity = DesiredIntensity;
        PointLight1->bVisible = true;
        RootComponent = PointLight1;

        Sphere1 = CreateDefaultSubobject<USphereComponent>(this, TEXT("Sphere1"));
        Sphere1->InitSphereRadius(250.0f);
        Sphere1->SetupAttachment(RootComponent);

        // è®¾ç½® Overlaps äº‹ä»¶å§”æ‰˜ï¼Œæ·»åŠ ç›¸åº”çš„å¤„ç†å‡½æ•°
        Sphere1->OnComponentBeginOverlap.AddDynamic(this, &ALightSwitchBoth::OnOverlapBegin);
        Sphere1->OnComponentEndOverlap.AddDynamic(this, &ALightSwitchBoth::OnOverlapEnd);
    }

    void ALightSwitchBoth::OnOverlapBegin_Implementation(UPrimitiveComponent* OverlappedComp, AActor* OtherActor, UPrimitiveComponent* OtherComp, int32 OtherBodyIndex, bool bFromSweep, const FHitResult& SweepResult)
    {
        if (OtherActor && (OtherActor != this) && OtherComp)
        {
            ToggleLight();
        }
    }

    void ALightSwitchBoth::OnOverlapEnd_Implementation(UPrimitiveComponent* OverlappedComp, AActor* OtherActor, UPrimitiveComponent* OtherComp, int32 OtherBodyIndex)
    {
        if (OtherActor && (OtherActor != this) && OtherComp)
        {
            ToggleLight();
        }
    }

    void ALightSwitchBoth::ToggleLight()
    {
        PointLight1->ToggleVisibility();
    }
```




## âš¡ Event Dispatchers
- Event Dispatchers https://docs.unrealengine.com/4.27/en-US/ProgrammingAndScripting/Blueprints/UserGuide/EventDispatcher/
- Actor é€šä¿¡ï¼šEventDispatcher https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ActorCommunication/EventDispatcherQuickStart/
- Delegates å§”æ‰˜ https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ProgrammingWithCPP/UnrealArchitecture/Delegates
- Blueprint Content Examples https://docs.unrealengine.com/4.27/zh-CN/Resources/ContentExamples/Blueprints

äº‹ä»¶å§”æ‰˜ï¼Œæ˜¯å¤šæ’­å§”æ‰˜çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ï¼Œå®ƒå¯ä»¥é€šè¿‡äº‹ä»¶åˆ†å‘å™¨ï¼ˆEvent Dispatcherï¼‰å°†äº‹ä»¶å¹¿æ’­ç»™ç»‘å®šåˆ°äº‹ä»¶å§”æ‰˜çš„å¯¹è±¡ã€‚

é€šè¿‡å°†ä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶ç»‘å®šåˆ° Event Dispatcherï¼Œæ‚¨å¯ä»¥åœ¨è°ƒç”¨äº‹ä»¶åˆ†å‘å™¨æ—¶è§¦å‘æ‰€æœ‰è¿™äº›äº‹ä»¶ã€‚è¿™äº›äº‹ä»¶å¯ä»¥ç»‘å®šåˆ°è“å›¾ç±»ä¸­ï¼Œä½†äº‹ä»¶åˆ†å‘å™¨ä¹Ÿå…è®¸åœ¨å…³å¡è“å›¾ä¸­è§¦å‘äº‹ä»¶ã€‚

åœ¨ My Blueprint é¢æ¿ä¸­ï¼Œå•å‡»äº‹ä»¶åˆ†å‘å™¨ç±»åˆ«ä¸Šçš„åŠ å·æŒ‰é’®åˆ›å»ºäº‹ä»¶åˆ†å‘å™¨ï¼Œè¯¥å­—æ®µæ˜¾ç¤ºåœ¨ My Blueprint é€‰é¡¹å¡ä¸­åˆ—è¡¨çš„æœ«å°¾ã€‚é€‰ä¸­äº‹ä»¶åˆ†å‘å™¨ï¼Œå¯åœ¨ Details é¢æ¿ä¸­ç¼–è¾‘å…¶å±æ€§ã€‚ä¸»è¦æ˜¯ä¸ºäº‹ä»¶åˆ†å‘å™¨è®¾ç½®æç¤ºæ–‡æœ¬å’Œç±»åˆ«ï¼Œå¹¶å¯æ·»åŠ è¾“å…¥ã€‚

ç‚¹å‡» Inputs å³ä¾§åŠ å·å‘äº‹ä»¶åˆ†å‘å™¨æ·»åŠ äº‹ä»¶åˆ†å‘å™¨å‚æ•°ï¼Œè¿™äº›å‚æ•°ä¼šåœ¨æ‰§è¡Œå§”æ‰˜æ—¶ï¼Œä¼ é€’ç»™æ¯ä¸€ä¸ªäº‹ä»¶å¤„ç†æ–¹ã€‚è¿™ä¸ä»…å…è®¸è“å›¾ç±»ä¸­çš„æ•°æ®æµï¼Œè¿˜å…è®¸è“å›¾ç±»ä¸å…³å¡è“å›¾ä¹‹é—´çš„æ•°æ®æµã€‚

å‘äº‹ä»¶åˆ†å‘ç¨‹åºæ·»åŠ è¾“å…¥çš„è¿‡ç¨‹ç±»ä¼¼äºå‘å‡½æ•°ã€è‡ªå®šä¹‰äº‹ä»¶å’Œå®æ·»åŠ è¾“å…¥å’Œè¾“å‡ºçš„å·¥ä½œæµç¨‹ã€‚å¦‚æœå’Œå¦ä¸€ä¸ªäº‹ä»¶å…·æœ‰ç›¸åŒçš„è¾“å…¥ï¼Œå¯ä»¥ä½¿ç”¨ Copy Signature from æ¥è‡ªåŠ¨æ·»åŠ å‚æ•°è®¾ç½®ã€‚

è®¾ç½®å¥½äº‹ä»¶å‚æ•°åï¼Œå°±å¯ä»¥åˆ›å»ºäº‹ä»¶åˆ†å‘å™¨çš„ Event èŠ‚ç‚¹ï¼Œé€šè¿‡å°†å…¶å³ä¸Šè§’çš„çº¢è‰²æ–¹å½¢å¼•è„šè¿æ¥åˆ° Bind Event èŠ‚ç‚¹ä¸Šçš„çº¢è‰²æ–¹å½¢ Event è¾“å…¥ç«¯ä¸Šï¼Œä»è€Œå®Œæˆäº‹ä»¶ç»‘å®šã€‚

åˆ›å»ºäº†äº‹ä»¶åˆ†å‘å™¨åï¼Œå¯ä»¥æ·»åŠ å’Œç§äº‹ä»¶åˆ†å‘å™¨æä¾›çš„èŠ‚ç‚¹ã€‚è™½ç„¶æ‚¨å¯ä»¥åŒå‡»æ‰“å¼€ My Blueprint åˆ—è¡¨ä¸­çš„äº‹ä»¶åˆ†å‘å™¨çš„å›¾è¡¨ï¼Œä½†æ˜¯å›¾è¡¨å¤„äºé”å®šçŠ¶æ€ï¼Œå› æ­¤æ— æ³•ç›´æ¥ä¿®æ”¹äº‹ä»¶åˆ†å‘å™¨ã€‚

å¯ä»¥æ‹–åŠ¨åˆ° EventGraphï¼Œåœ¨å¼•å‡ºèœå•ä¸­æä¾›äº†ä»¥ä¸‹èŠ‚ç‚¹ï¼š

- Call æ‰§è¡Œå§”æ‰˜çš„èŠ‚ç‚¹ï¼Œå®ƒå°†æ¿€æ´»å­˜å‚¨åœ¨äº‹ä»¶åˆ—è¡¨ä¸­çš„æ‰€æœ‰äº‹ä»¶ã€‚ï¼›
- Bind ç»‘å®šæŒ‡å®šäº‹ä»¶çš„èŠ‚ç‚¹ï¼›
- Unbind æ‰§è¡ŒæŒ‡å®šäº‹ä»¶è§£ç»‘çš„èŠ‚ç‚¹ï¼›
- Unbind All æ‰§è¡Œæ¸…é™¤å·²ç»‘å®šäº‹ä»¶çš„èŠ‚ç‚¹ï¼›
- Assign åˆ†é…äº‹ä»¶èŠ‚ç‚¹ç»™ Bind Event èŠ‚ç‚¹ï¼›
- Event äº‹ä»¶èŠ‚ç‚¹ï¼›

æ·»åŠ äº‹ä»¶åˆ†å‘å™¨çš„ Bind, Unbind èŠ‚ç‚¹ç”¨æ¥ç§»é™¤æˆ–æ·»åŠ åˆ°äº‹ä»¶åˆ†å‘å™¨çš„äº‹ä»¶åˆ—è¡¨ä¸­ã€‚Assign èŠ‚ç‚¹å¯ä»¥è‡ªåŠ¨åˆ›å»º Bind èŠ‚ç‚¹å’Œä¸€ä¸ªç›¸åº”çš„ Event èŠ‚ç‚¹ï¼Œå¹¶è¿æ¥åœ¨ä¸€èµ·ã€‚

å¦‚æœäº‹ä»¶åˆ†å‘å™¨æœªç»‘å®šä»»ä½•äº‹ä»¶ï¼Œå¯¹å…¶è¿›è¡Œè°ƒç”¨å°†æ²¡æœ‰ä»»ä½•æ•ˆæœã€‚æ¯ä¸ªäº‹ä»¶åˆ†å‘å™¨å‡ç»´æŠ¤ç€ä¸€ä¸ªäº‹ä»¶åˆ—è¡¨ï¼Œä½¿ç”¨ Bind Event èŠ‚ç‚¹å¯ä»¥å‘æ­¤åˆ—è¡¨ä¸­æ·»åŠ äº‹ä»¶ï¼Œä½¿ç”¨ Unbind Event èŠ‚ç‚¹å¯ä»¥ä»æ­¤åˆ—è¡¨ä¸­ç§»é™¤äº‹ä»¶ã€‚ æ­¤å¤–ï¼Œé€šè¿‡ Unbind All Events èŠ‚ç‚¹å¯ä»¥è§£é™¤å½“å‰ç»‘å®šåˆ°äº‹ä»¶åˆ†å‘å™¨ä¸Šçš„æ‰€æœ‰äº‹ä»¶ã€‚

Bind Event èŠ‚ç‚¹å¯ä»¥æ‰§è¡Œå¤šæ¬¡ï¼Œä½†æ¯ä¸ªäº‹ä»¶åªèƒ½ç»‘å®šä¸€æ¬¡ã€‚æ­¤å¤–ï¼Œè“å›¾ç±»å’Œå…³å¡è“å›¾ä¸­çš„äº‹ä»¶éƒ½å°†æ·»åŠ åˆ°ç›¸åŒçš„äº‹ä»¶åˆ—è¡¨ä¸­ï¼Œ å› æ­¤ Unbind All Events èŠ‚ç‚¹å°†è§£é™¤è“å›¾ç±»å’Œå…³å¡è“å›¾ä¸­çš„äº‹ä»¶ç»‘å®šã€‚

- åœ¨è“å›¾ç±»ä¸­æ‰§è¡Œ Unbind All Events èŠ‚ç‚¹åï¼Œå°†é’ˆå¯¹æ­¤ç±»çš„æ‰€æœ‰å®ä¾‹æ¥è§£é™¤è“å›¾ç±»å’Œå…³å¡è“å›¾ä¸­çš„äº‹ä»¶ç»‘å®šã€‚
- åœ¨å…³å¡è“å›¾ä¸­æ‰§è¡Œ Unbind All Events èŠ‚ç‚¹åï¼Œåªä¼šé’ˆå¯¹ Target è§£é™¤è“å›¾ç±»å’Œå…³å¡è“å›¾ä¸­çš„äº‹ä»¶ç»‘å®šã€‚

Event, Bind, å’Œ Unbind èŠ‚ç‚¹éƒ½å¯ä»¥æ·»åŠ åˆ°è“å›¾ç±»å’Œå…³å¡è“å›¾ä¸­ï¼Œé™¤äº†äº‹ä»¶èŠ‚ç‚¹ï¼Œå„ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ª Target è¾“å…¥ã€‚

åœ¨è“å›¾ç±»ä¸­ï¼ŒTarget è‡ªåŠ¨è®¾ç½®ä¸º Selfï¼Œè¿™æ„å‘³ç€äº‹ä»¶åˆ—è¡¨é’ˆå¯¹è¯¥è“å›¾ç±»å‘ç”Ÿäº†æ›´æ”¹ï¼Œå› æ­¤ï¼Œè¯¥ç±»çš„æ¯ä¸ªå®ä¾‹éƒ½ä¼šäº§ç”Ÿå˜åŒ–ã€‚

åœ¨å…³å¡è“å›¾ä¸­ï¼ŒTarget å¿…é¡»å…³è”åˆ°å¯¹å…³å¡ä¸­çš„ä¸€ä¸ªç±»å®ä¾‹çš„å¼•ç”¨ã€‚è¿™æ„å‘³ç€ï¼Œäº‹ä»¶åˆ—è¡¨å°†ä»…é’ˆå¯¹è¯¥ç±»çš„ç‰¹å®šå®ä¾‹è¿›è¡Œæ›´æ”¹ã€‚

ä½¿ç”¨ Call èŠ‚ç‚¹è°ƒç”¨ä¸€ä¸ª Event Dispatcherï¼Œä¼šè§¦å‘ç»‘å®šåˆ°è¯¥äº‹ä»¶åˆ†å‘å™¨çš„æ‰€æœ‰äº‹ä»¶ã€‚å¯¹äºæ¯ä¸ªäº‹ä»¶åˆ†å‘å™¨ï¼Œå¯ä»¥åº”ç”¨å¤šä¸ª Call èŠ‚ç‚¹ï¼Œæ—¢å¯ä»¥åœ¨è“å›¾ç±»ä¸­è°ƒç”¨äº‹ä»¶åˆ†å‘å™¨ä¹Ÿå¯ä»¥åœ¨å…³å¡è“å›¾ä¸­è¿›è¡Œè°ƒç”¨ã€‚ä¹Ÿå¯ä»¥é€šè¿‡å³é”®èœå•åˆ›å»º Call èŠ‚ç‚¹ï¼Œåœ¨å‡ºç°çš„åˆ—è¡¨ä¸­é€‰æ‹© Event Dispatcher ä¸‹çš„ Call äº‹ä»¶åˆ†å‘å™¨åç§°ã€‚ 

æŒ‰ EventDispatcher Actor é€šä¿¡ç¤ºèŒƒï¼Œæ€»ç»“ä¸€ä¸‹æ“ä½œæ­¥éª¤ï¼š

- åˆ›å»ºä¸€ä¸ª Actor è“å›¾ç±» `BP_Boss`ï¼Œç”¨ä¸€ä¸ª Cube ä¹Ÿå¯ä»¥æ¨¡æ‹Ÿï¼Œç”šè‡³ä¸éœ€è¦ Cube ä¹Ÿå¯ä»¥ï¼Œå…³é”®æ˜¯å®ƒè¦é€šè¿‡äº‹ä»¶åˆ†å‘å™¨å¹¿æ’­äº‹ä»¶ï¼›
- æ‰“å¼€ `BP_Boss` è“å›¾ç¼–è¾‘å™¨ï¼Œåœ¨ Viewport ä¸­ç‚¹å‡» Add Components æŒ‰é’®ï¼Œåœ¨ DefaultSceneRoot ä¸‹æ·»åŠ  Box Collision ç”¨äºç¢°æ’æ£€æµ‹ï¼Œäº§ç”Ÿç¢°æ’äº‹ä»¶ã€‚
- é€‰ä¸­ Box Collision ç»„ä»¶ï¼Œè®¾ç½® Details -> Rendering -> Hidden in Game checkboxï¼Œå–æ¶ˆé€‰ä¸­ä»¥åœ¨æ¸¸æˆä¸­æ˜¾ç¤ºç¢°æ’ç›’ä½“è½®å»“ã€‚
- ä½¿ç”¨å³é”®èœå•ä¸º Box Collision æ·»åŠ  OnComponentBeginOverlap äº‹ä»¶å¤„ç†èŠ‚ç‚¹ï¼Œå¯ä»¥çœ‹åˆ°ç›¸åº”çš„èŠ‚ç‚¹è¢«æ·»åŠ åˆ° Event Graphã€‚
- åœ¨æ­¤è“å›¾ç±»çš„ My Blueprint é¢æ¿ä¸­æ–°å¢ä¸€ä¸ª Event Dispatcher äº‹ä»¶åˆ†å‘å™¨ï¼Œå‘½åä¸º `OnBossDied`ï¼›
- ä¸º Event Dispatcher åˆ›å»º Call èŠ‚ç‚¹æ‰§è¡Œå§”æ‰˜çš„äº‹ä»¶ï¼Œåªéœ€è¦å°† `OnBossDied` æ‹–åŠ¨åˆ° Event Graphï¼Œç„¶åé€‰æ‹©æ·»åŠ  Call èŠ‚ç‚¹ã€‚
- å°†å‰é¢åˆ›å»ºçš„ Overlap äº‹ä»¶èŠ‚ç‚¹è¿æ¥åˆ° Call OnBossDied èŠ‚ç‚¹ï¼ŒTarget é»˜è®¤ä¸º Self å¼•ç”¨å³å¯ï¼Œå³åœ¨ Overlap äº‹ä»¶è§¦å‘æ—¶æ‰§è¡Œå§”æ‰˜ï¼Œæ‰§è¡Œæ‰€æœ‰ç»‘å®šçš„äº‹ä»¶ã€‚
- å°† `BP_Boss` è“å›¾æ‹–åŠ¨åˆ°å…³å¡ä¸­ã€‚

OnComponentBeginOverlap æ˜¯æŒ‡ä¸¤ä¸ªå¯¹è±¡è¾¹ç•Œç¢°æ’æ—¶è§¦å‘çš„äº‹ä»¶ï¼Œåœ¨åŒä¸€ä¸ªç»„ä»¶å†…éƒ¨çš„å¯¹è±¡ä¹Ÿå¯ä»¥å‘ç”Ÿï¼Œæ¯”å¦‚å½“ `BP_Boss` è¸©åˆ°é›·æ—¶è§¦å‘è¿™ä¸ªäº‹ä»¶ï¼Œç„¶åå°±ä¼šæ‰§è¡Œå§”æ‰˜åœ¨ Event Dispatcher çš„äº‹ä»¶ã€‚ç®€åŒ–èµ·è§ï¼Œ`BP_Boss` æ”¾ç½®çš„ Box Collision ç”¨æ¥äº§ç”Ÿ Overlap äº‹ä»¶ï¼Œå°†é€šè¿‡è¿™ä¸ªäº‹ä»¶æ¥æ‰§è¡Œå§”æ‰˜ï¼Œæ‰§è¡Œäº‹ä»¶åˆ†å‘å™¨ä¸Šç»‘å®šçš„äº‹ä»¶ã€‚ æ‰€ä»¥ `BP_Boss` å°±ç›¸å½“äºæ˜¯å¹¿æ’­ç«™ï¼Œç°åœ¨è¿˜ç¼ºä¸€äº›å¬ä¼—ã€‚

æ¥ä¸‹æ¥ï¼Œå°±è¦åˆ›å»ºè¦å“åº” Boss Died äº‹ä»¶çš„çš„ Actorï¼Œå¯ä»¥åˆ›å»ºä»»æ„å¤šä¸ªï¼Œåªè¦å°†äº‹ä»¶å¤„ç†å‡½æ•°ç»‘å®šåˆ° `BP_Boss` å¯¹è±¡çš„ `OnBossDied` äº‹ä»¶åˆ†å‘å™¨ä¸Šï¼Œè¿™ä¸ªè¿‡ç¨‹ç›¸å½“äºè¦æŠ¥åæ”¶å¬å¹¿æ’­ã€‚è¿™æ ·ï¼Œåœ¨æ‰§è¡Œå§”æ‰˜ï¼Œç»‘å®šå¥½çš„äº‹ä»¶å¤„ç†å‡½æ•°éƒ½å¯ä»¥å“åº” Boss Died äº‹ä»¶ã€‚

åˆ©ç”¨ Starter Content å†…å®¹åŒ… Particles å­ç›®å½•ä¸‹çš„ `P_Explosion` ç²’å­ç³»ç»Ÿå¯ä»¥åˆ›å»ºçˆ†ç‚¸æ•ˆæœï¼Œç°æˆæä¾›çš„è“å›¾ç±» `Blueprint_Effect_Explosion` å·²ç»å°†ç²’å­ç³»ç»Ÿå’Œå£°æ•ˆç»„ä»¶ç»„ç»‡åœ¨ä¸€èµ·ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼š

- é€šè¿‡å†…å®¹æµè§ˆå™¨æ“ä½œï¼Œå¤åˆ¶ä¸€ä»½ `Blueprint_Effect_Explosion` åˆ°æŒ‡å®šç›®å½•ï¼Œåªéœ€è¦æ‹–åŠ¨åˆ°æŒ‡å®šç›®å½•å³å¯ã€‚
- åœ¨è“å›¾ç¼–è¾‘å™¨æ‰“å¼€å‰¯æœ¬ï¼Œåœ¨ Components é¢æ¿ä¸­é€‰æ‹© `P_Explosion` ç»„ä»¶ï¼Œç„¶ååœ¨ç¦ç”¨è‡ªåŠ¨æ¿€æ´» Details -> Activation -> Auto Activateã€‚
- é’ˆå¯¹ Explosion Audio ç»„ä»¶é‡å¤æ‰§è¡Œä»¥ä¸Šæ­¥éª¤ï¼Œç¦ç”¨è‡ªåŠ¨æ¿€æ´»ç›®çš„æ˜¯ï¼Œåœ¨é€‚å½“æ—¶æœºé€šè¿‡ç»„ä»¶çš„ Activate å‡½æ•°æ¥æ¿€æ´»ç²’å­å’Œå£°éŸ³æ•ˆæœã€‚
- åœ¨é¢æ¿çš„ Variable éƒ¨åˆ†åˆ›å»ºä¸€ä¸ªå˜é‡ï¼Œç‚¹å‡» + æŒ‰é’®æ·»åŠ æ–°å˜é‡ï¼Œç”¨æ¥å¼•ç”¨ `BP_Boss` å¯¹è±¡ï¼Œå‘½åä¸º `BossReference`ã€‚
- åœ¨ Details é¢æ¿ä¸Šä¿®æ”¹ Variable Typeï¼ŒæŒ‡å®šä¸º Object Type ä¸‹çš„ `BP_Boss`ï¼Œå³å¯¹è±¡å¼•ç”¨ï¼ˆObject Referenceï¼‰ï¼Œå¹¶å‹¾é€‰ Instance Editable å¤é€‰æ¡†ã€‚
- åœ¨ Event Graph æ·»åŠ  Event BeginPlay äº‹ä»¶èŠ‚ç‚¹ï¼Œåœ¨è¿™ä¸ªäº‹ä»¶æµä¸­æ‰§è¡Œ `OnBossDied` äº‹ä»¶çš„ç»‘å®šã€‚
- æŒ‰ä¸‹ Ctrl å°†å˜é‡ `BossReference` æ‹–åŠ¨åˆ° Event Graphï¼Œå³åˆ›å»º Get BossReferenceã€‚
- å†ä» BossReference èŠ‚ç‚¹ä¸­æ‹–å‡ºä¸€æ¡å¼•çº¿ï¼Œå¹¶é€‰æ‹© Assign On Boss Diedï¼Œè¿™æ ·ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ–°çš„è‡ªå®šä¹‰äº‹ä»¶èŠ‚ç‚¹å’Œ Bind Event èŠ‚ç‚¹ã€‚
- å°†å‰é¢çš„ Event BeginPlay èŠ‚ç‚¹æ‰§è¡Œæµè¿æ¥åˆ° Bind Event to Boss Died èŠ‚ç‚¹ï¼Œä»¥å®ç°è‡ªå®šä¹‰äº‹ä»¶çš„ç»‘å®šã€‚
- å°† P_Explosion å’Œ Explosion Audio ç»„ä»¶æ‹–åŠ¨åˆ° Event Graphï¼Œå„è‡ªæ‹–å‡ºä¸€æ ¹å¼•çº¿ï¼Œç„¶ååˆ›å»ºå¹¶è¿æ¥åˆ° Set Activate èŠ‚ç‚¹ï¼Œç”¨äºæ¿€æ´»ç²’å­åŠ¨ç”»å’Œå£°éŸ³ã€‚
- éœ€è¦ç»™ Activate èŠ‚ç‚¹çš„ bNewActive ç«¯å£è¾“å…¥ä¸€ä¸ª True å€¼ï¼Œå¯ä»¥ä½¿ç”¨ Make Literal Bool èŠ‚ç‚¹åˆ›å»ºå¸ƒå°”å€¼ï¼ŒbReset å¯ä»¥ä¸ç®¡ã€‚
- æœ€åå°†è‡ªå®šä¹‰äº‹ä»¶çš„æ‰§è¡Œæµè¿æ¥åˆ° Set Activate èŠ‚ç‚¹ï¼Œè¿™æ ·å°±å¯ä»¥å“åº” `BP_Boss` å¯¹è±¡çš„ `OnBossDied` äº‹ä»¶åˆ†å‘å™¨çš„æ‰§è¡Œã€‚

æœ€åï¼Œæ˜¯è®¾ç½®å…³å¡ç”¨äºæµ‹è¯• Event Dispatcher æ‰§è¡Œæµç¨‹ã€‚

å°† BP_Boss Actor æ‹–åŠ¨åˆ°å…³å¡ä¸­ï¼Œå†å°†ä»»æ„æ•°é‡çš„ Blueprint_Effect_Explosion æ‹–åŠ¨åˆ°å…³å¡ä¸­ï¼Œå¹¶åœ¨ Details é¢æ¿è®¾ç½® `BossReference` å˜é‡å¼•ç”¨ BP_Bossã€‚

ç„¶åè¿è¡Œæµ‹è¯•ï¼Œé€šè¿‡æ“ä½œè§’è‰²è§¦å‘ BP_Boss å¯¹è±¡çš„ Overlap äº‹ä»¶ï¼Œè®© BP_Boss è§¦å‘å™¨æ¨¡æ‹Ÿ Boss åœ¨æ¸¸æˆä¸­çš„æ­»äº¡ã€‚

å¦å¤–ï¼Œå¦‚æœåœ¨å…³å¡ä¸­æ²¡æœ‰ä¸º `BossReference` æŒ‡å®šå¼•ç”¨ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œ Bind Event æ—¶å°±ä¼šäº§ç”Ÿå¼‚å¸¸ï¼Œå› ä¸ºæ²¡æœ‰åšç©ºå¼•ç”¨çš„åˆ¤æ–­ã€‚å¯ä»¥ä½¿ç”¨ Utilities æä¾›çš„ IsValid æ“ä½œæ¥è¿‡æ»¤ï¼Œä½¿ç”¨æœ‰é—®é¢˜æ ‡è®°çš„ IsValid èŠ‚ç‚¹ï¼Œå®ƒæä¾›äº† Is Valid å’Œ Is Not Valid ä¸¤ä¸ªæ‰§è¡Œæµã€‚

ä½¿ç”¨ Equal/NotEqual ä¹Ÿå¯ä»¥åˆ¤æ–­æ˜¯å¦ç©ºå¼•ç”¨ï¼Œåªéœ€è¦å°† A å’Œ B ç«¯å£ä¸­çš„æœŸä¸­ä¸€ä¸ªç•™ç©ºï¼Œä½†å®ƒä»¬æ²¡æœ‰æ‰§è¡Œæµç«¯å£ï¼Œéœ€è¦é…åˆ Branch èŠ‚ç‚¹ä½¿ç”¨ã€‚ 



## âš¡ Timeline Node
- Timelines https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/Blueprints/UserGuide/Timelines
- Actor é€šä¿¡ï¼šæ¥å£å¿«é€Ÿå…¥é—¨æŒ‡å—(Timeline) https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ActorCommunication/InterfaceQuickStart/
- Sequencer å¤šè½¨è¿¹ç¼–è¾‘å™¨ https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/Sequencer/Overview/

æ—¶é—´è½´èŠ‚ç‚¹ Timeline Nodes æ˜¯è“å›¾ä¸­çš„ç‰¹æ®ŠèŠ‚ç‚¹ï¼Œå…è®¸ä½ å¿«é€Ÿè®¾è®¡å‡ºåŸºäºæ—¶é—´çš„åŠ¨ç”»æ•ˆæœï¼Œå¹¶åœ¨æ—¶é—´è½´ä¸Šè®¾ç½®å…³é”®å¸§ï¼Œè§¦å‘ äº‹ä»¶ ï¼Œæˆ–è°ƒæ•´ æµ®ç‚¹æ•°ã€å‘é‡ æˆ– é¢œè‰²ã€‚

ä½ å¯ä»¥ç›´æ¥åœ¨è“å›¾ç¼–è¾‘å™¨ä¸­ç¼–è¾‘æ—¶é—´è½´ï¼Œåªéœ€åœ¨å›¾è¡¨ï¼ˆGraphï¼‰é€‰é¡¹å¡ä¸­æˆ–æˆ‘çš„è“å›¾ï¼ˆMy Blueprintï¼‰é€‰é¡¹å¡ä¸­åŒå‡»æ—¶é—´è½´ï¼ˆTimelineï¼‰ã€‚å®ƒä»¬ä¸»è¦ç”¨äºå¤„ç†ä¸€äº›ç®€å•çš„ã€éåŠ¨ç”»ä»»åŠ¡ï¼Œä¾‹å¦‚å¼€é—¨ã€æ”¹å˜å…‰æºæˆ–åœ¨åœºæ™¯ä¸­å¯¹ Actor æ‰§è¡Œå…¶ä»–åŸºäºç›¸å…³çš„æ“ä½œã€‚å®ƒä»¬ç±»ä¼¼äº Sequencer å…³å¡åºåˆ—ï¼Œå› ä¸ºå®ƒä»¬éƒ½å…è®¸ä½ åœ¨ä¸åŒå¸§ä¹‹é—´å¯¹æµ®ç‚¹ã€å‘é‡ã€é¢œè‰²çš„æ•°å€¼è¿›è¡Œæ’å€¼è¿ç®—ã€‚

Timeline ç”¨æ¥å®ç°ä¸€äº›å’Œæ—¶é—´ç›¸è”ç³»çš„åŠŸèƒ½ï¼Œä¾‹å¦‚åœ¨ä¸€æ®µæ—¶é—´å†…å®Œæˆä¸€ä¸ªåŠ¨ä½œï¼Œæ’­æ”¾ä¸€æ®µåŠ¨ç”»ï¼Œä¹Ÿå¯å€’æ”¾ï¼Œæˆ–è€…åªæ˜¯å•çº¯çš„å»¶è¿Ÿå‡½æ•°çš„æ‰§è¡Œæ—¶é—´ï¼Œå³è°ƒæ•´äº‹ä»¶çš„æ‰§è¡Œé¡ºåºã€‚åœ¨ UE4 çš„è“å›¾è‡ªå¸¦å‡½æ•°ä¸­æœ‰ä¸€ä¸ªå¾ˆå¥½ç”¨çš„å‡½æ•°å¯ä»¥å®Œç¾åœ°è§£å†³è¿™äº›éœ€æ±‚ï¼Œå®ƒå°±æ˜¯ Timelineã€‚

æ·»åŠ  Timeline èŠ‚ç‚¹ï¼Œå¹¶åŒå‡»æ‰“å¼€ç¼–è¾‘ç•Œé¢ï¼Œå°±æ˜¯ä¸€ä¸ªæ›²çº¿ç¼–è¾‘å™¨ï¼Œå·¦ä¸Šè§’çš„æŒ‰é’®åˆ†åˆ«å¯¹åº” 4 ç§æ—¶é—´è½¨è¿¹ï¼š

- Float Track æµ®ç‚¹å‹è½¨è¿¹ï¼Œç”¨äºè°ƒæ•´æ•°å€¼çš„å¤§å°ï¼Œæ¯”è¾ƒå¸¸è§çš„åŠŸèƒ½æ¯”å¦‚åˆ¶ä½œä¸€ä¸ªéšæ—¶é—´å˜åŒ–çš„æµ®ç‚¹æ•°å€¼æ›²çº¿ï¼Œä¾‹å¦‚ä¸€åè§’è‰²åœ¨å—ä¼¤çŠ¶æ€ä¸‹çš„ç”Ÿå‘½å€¼éšæ›²çº¿å‡å°‘ï¼›
- Vector Track å‘é‡è½¨è¿¹ï¼Œåˆ›å»ºçŸ¢é‡æ›²çº¿ï¼Œåˆ†åˆ«å¯ä»¥è®¾ç½® xï¼Œyï¼Œz ä¸‰ä¸ªåˆ†é‡çš„å¯¹åº”æ›²çº¿ã€‚
- Event Track äº‹ä»¶èŠ‚ç‚¹ï¼Œå…¶ä½œç”¨æ˜¯åœ¨æŒ‡å®šæ—¶é—´è§¦å‘åç»­å‡½æ•°ï¼Œæ¯ä¸ªå…³é”®å¸§ç›¸å½“äºä¸€ä¸ª Delay èŠ‚ç‚¹ã€‚æ‰€ä»¥ï¼Œå…³é”®å¸§ä¹‹é—´æ²¡æœ‰æ›²çº¿è¿æ¥ï¼ŒåŒæ—¶è¾“å‡ºç«¯å£æ˜¯ä¸€ä¸ª Exec æ‰§è¡Œæµã€‚
- Color Track ä½¿ç”¨é¢œè‰²æ›²çº¿ï¼Œæ ¹æ®å…³é”®å¸§è®¾ç½®çš„è‰²å½©äº§ç”Ÿè¿‡åº¦æ•ˆæœã€‚

è¾“å‡ºçš„ 0.0 ~ 1.0 çš„æµ®ç‚¹å€¼ï¼Œè¿˜å¯ä»¥å†ä½¿ç”¨ `Lerp Float` èŠ‚ç‚¹è¿›è¡Œæµ®ç‚¹æ’å€¼è¿ç®—ï¼Œå¯ä»¥å¾—åˆ°æŒ‡å®šä¸¤ä¸ªå€¼ä¹‹é—´æ’å€¼ã€‚

å¯æ·»åŠ å¤šä¸ªä¸åŒç±»å‹çš„ Trackï¼ŒèŠ‚ç‚¹ä¼šè‡ªåŠ¨åˆ›å»ºå¯¹åº”çš„æ•°æ®è¾“å‡ºç«¯å£ï¼Œæ”¾ç½®å®Œè½¨é“åï¼Œæ·»åŠ å…³é”®å¸§ä»¥å®šä¹‰æ‚¨çš„æ—¶é—´åŠ¨ç”»ã€‚

ç«¯å£åŠŸèƒ½è§£é‡Šï¼š

- Play æ­£å‘æ’­æ”¾æ—¶é—´è½´ï¼›
- Play from Start ä»å¤´å¼€å§‹æ‰§è¡Œï¼Œæ‰§è¡ŒæœŸé—´æ¡ä»¶æ”¹å˜ï¼Œé‡æ–°å¼€å§‹æ‰§è¡Œï¼›
- Stop åœæ­¢æ‰§è¡Œï¼Œæ‰§è¡ŒæœŸé—´æ¡ä»¶æ”¹å˜ï¼Œåœæ­¢æ‰§è¡Œï¼›
- Reverse åå‘æ‰§è¡Œï¼ŒæœŸé—´æ¡ä»¶æ”¹å˜ï¼Œä»ä¸­é—´æŸä¸€ä½ç½®ç«‹åˆ»åå‘æ‰§è¡Œï¼›
- Reverse from End äº‹ä»¶ä»æœ«å°¾åå‘æ‰§è¡Œï¼ŒæœŸé—´æ¡ä»¶æ”¹å˜ï¼Œå†ä»å°¾éƒ¨å¼€å§‹åå‘æ‰§è¡Œï¼›
- Set New Time æ›´æ”¹äº‹ä»¶çš„å¼€å§‹æ‰§è¡Œæ—¶é—´ï¼›
- New Time è®¾ç½®å‡½æ•°æ‰§è¡Œèµ·å§‹æ—¶é—´ç‚¹ï¼›
- Updata äº‹ä»¶åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­çš„åç»­æ‰§è¡Œæµï¼›
- Finished äº‹ä»¶åœ¨å®Œæˆåçš„æ‰§è¡Œæµï¼›
- Direction è¾“å‡ºæ’­æ”¾æ–¹å‘ï¼Œæ˜¯ä¸€ä¸ªæšä¸¾å€¼ï¼›

åˆ›å»ºæ—¶é—´è½´åï¼Œä¼šåœ¨ My Blueprint é€‰é¡¹å¡ä¸­åˆ›å»º Timeline å˜é‡ï¼Œç”¨äºè·å–æ—¶é—´è½´ç»„ä»¶çš„å¼•ç”¨ï¼Œåœ¨å¿…é¡»ä½¿ç”¨æ—¶é—´è½´èŠ‚ç‚¹çš„æ—¶å€™ï¼Œæ­¤æ³•å°¤ä¸ºæœ‰ç”¨ã€‚è¿™äº›èŠ‚ç‚¹çš„å­˜åœ¨æ˜¯ä¸ºäº†èƒ½å¤Ÿè®¿é—®æŸæ—¶é—´è½´çš„ç‰¹å®šåŠŸèƒ½ï¼Œä¾‹å¦‚å…¶æ’­æ”¾é€Ÿç‡ã€‚



# ğŸŒŸ Gameplay å…¥é—¨æŒ‡å—
- å¸¸è§ Actor ç±»å‹ https://docs.unrealengine.com/4.27/zh-CN/Basics/Actors/Types
- å¸¸è§ ActorComponent ç±»å‹ https://docs.unrealengine.com/4.27/zh-CN/Basics/Components/
- Gameplay å…¥é—¨æŒ‡å— https://docs.unrealengine.com/4.27/zh-CN/InteractiveExperiences/HowTo
- Blueprints Events https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/Blueprints/UserGuide/Events/
- AActor Hierarchy https://docs.unrealengine.com/4.27/en-US/API/Runtime/Engine/GameFramework/AActor/AActorHierarchy/
- UActorComponent Hierarchy https://docs.unrealengine.com/4.27/en-US/API/Runtime/Engine/Components/UActorComponent/UActorComponentHierarchy/
- Movement Components ç§»åŠ¨ç»„ä»¶ https://docs.unrealengine.com/4.27/zh-CN/Basics/Components/Movement/
- ã€ŠExploring in UE4ã€‹ç§»åŠ¨ç»„ä»¶è¯¦è§£[åŸç†åˆ†æ] https://zhuanlan.zhihu.com/p/34257208
- Pawn ç©å®¶å…·åŒ–å¯¹è±¡ https://docs.unrealengine.com/4.27/zh-CN/InteractiveExperiences/Framework/Pawn/
- Pawn çš„æ“çºµ https://docs.unrealengine.com/4.27/zh-CN/InteractiveExperiences/HowTo/PossessPawns/
- é‡ç”Ÿç©å®¶ https://docs.unrealengine.com/4.27/zh-CN/InteractiveExperiences/HowTo/RespawnPlayer/
- æ‘„åƒæœºä»£è¡¨ç©å®¶çš„è§†è§’ https://docs.unrealengine.com/4.27/zh-CN/InteractiveExperiences/Framework/Camera/
- Using Cameras https://docs.unrealengine.com/4.27/zh-CN/InteractiveExperiences/UsingCameras

Gameplay æ¡†æ¶æ˜¯ UE4 æ¸¸æˆæµç¨‹æ¡†æ¶ï¼Œå®˜æ–¹æä¾›çš„æ„æ¶ç»“æ„ç®€å•åœ°æ˜¾ç¤ºå„ç§å¯¹è±¡çš„ç»„ç»‡ï¼š

                        +-------------+
                        |    Game     |
                        |  GameMode   |
                        |  GameState  |
                        +------^------+
                               |
         Contains:  +----------+-----------+           +---------------+
       +----------- |    PlayerController  |           |  AIController |
       |            +----------+-----------+           +-------+-------+
       |                       |                               |
       |    +---------+        | Possess  +---------+  Possess |
       +--> |   HUD   |        +--------> |   Pawn  | <--------+
       |    +---------+                   +---------+
       |    +---------+
       +--> |  Input  |
       |    +---------+
       |    +------------------------+
       +--> |  PlayerCameraManager   |
            +------------------------+

[GamePlay Framework Class Relationships](https://docs.unrealengine.com/4.27/en-US/InteractiveExperiences/Framework/QuickReference/)

è¿™ä¸ªæ„æ¶å›¾å·²ç»è§£é‡Šäº†æ¸¸æˆçš„å·¥ä½œæµç¨‹ï¼š

- é¦–å…ˆï¼Œæ˜¯è¿è¡Œæ¸¸æˆçš„æœ€åˆæœŸçš„å·¥ä½œæ˜¯ GameMode å’Œ GameState å®Œæˆçš„ï¼Œä¸»è¦æ˜¯ GameModeï¼Œå®ƒç®¡ç†æ¸¸æˆå¦‚ä½•å¼€å§‹çš„åŸºæœ¬é€»è¾‘ï¼›
- å®Œæˆå‰æœŸçš„é…ç½®å·¥ä½œåï¼Œ

é€šè¿‡ Project Settings -> Project -> Maps & Modes å¯ä»¥ç»™é¡¹ç›®æŒ‡å®šä¸€ä¸ª GameMode å¯¹è±¡ï¼š

- Default GameMode æŒ‡å®šå·¥ç¨‹é»˜è®¤æ¸¸æˆæ¨¡å¼å¯¹è±¡ï¼›
- Game Startup Map æŒ‡å®šå¼€å§‹æ¸¸æˆæ—¶åŠ è½½çš„å…³å¡åœ°å›¾ï¼›
- Editor Startup Map æŒ‡å®šæ‰“å¼€ç¼–è¾‘å™¨æ—¶åŠ è½½çš„å…³å¡åœ°å›¾ï¼›

æ³¨æ„ï¼šé™¤äº†å¯ä»¥ä¸ºæ•´ä¸ªå·¥ç¨‹è®¾ç½®ä»¥å¤–ï¼Œè¿˜å¯ä»¥åœ¨æ¯ä¸ªå…³å¡è®¾ç½®ç‹¬æœ‰çš„ GameModeï¼Œæ“ä½œè·¯å¾„ï¼šWindow -> World Settings -> Game Modeã€‚

æ¯ä¸ªå…³å¡éƒ½æœ‰å¯¹åº”çš„æ¸¸æˆæ¨¡å¼ï¼Œä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬åˆ‡æ¢å…³å¡ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½ä¼šè¢«åˆå§‹åŒ–ã€‚

å°½ç®¡ï¼Œ*GameModeBase* ä¸­å®šä¹‰äº†å„ç§å¯ä»¥ä¾›è“å›¾ç¼–è¾‘çš„å±æ€§ï¼Œä½†æ˜¯é€šè¿‡ C++ ç»§æ‰¿åï¼Œå¹¶è®¾ç½®åœ¨å·¥ç¨‹ä¸­è®¾ç½®ï¼Œç”±äºè“å›¾æœºåˆ¶ï¼Œå¹¶ä¸èƒ½ç›´æ¥ä¿®æ”¹è¿™äº›å±æ€§ï¼Œéœ€è¦å°† C++ æ‰©å±•ä¸ºè“å›¾ç±»ï¼Œæ‰å¯ä»¥åœ¨ç¼–è¾‘å™¨ä¸­è®¾ç½®è¿™äº›å±æ€§ã€‚

```C++
/** The default pawn class used by players. */
UPROPERTY(EditAnywhere, BlueprintReadWrite, Category=Classes)
TSubclassOf<APawn> DefaultPawnClass;
```

GameMode åŸºæœ¬è®¾ç½®:

- Default Pawn Class æŒ‡å®šé»˜è®¤çš„æ¸¸æˆç©å®¶æ˜¯ä»€ä¹ˆç±»å‹çš„å¯¹è±¡ï¼Œåœ¨è¿›å…¥æ¸¸æˆæ—¶ï¼Œè¿™ç§å¯¹è±¡å°±ç”±ç©å®¶æ“çºµï¼Œå³è¢« PlayController æ“æ§ï¼›
- HUD Class æŒ‡å®š Head-up Display ç±»å‹ï¼Œå¼€å§‹æ¸¸æˆæ—¶ä¼šåŠ è½½å®ƒç”¨æ¥æ˜¾ç¤ºæ¸¸æˆä¸­çš„å¹³é¢ UI ç•Œé¢ï¼Œä¸»è¦ç”¨æ¥æ˜¾ç¤ºä¿¡æ¯ï¼Œå¦‚ç©å®¶çš„ç”Ÿå‘½å€¼ï¼›
- Player Controller Class ç©å®¶æ§åˆ¶å™¨ï¼Œè¿™æ˜¯æ¸¸æˆç¨‹åºæ§åˆ¶çš„æ ¸å¿ƒç±»ï¼Œæ¯”å¦‚ç”¨æˆ·è¾“å…¥å¦‚ä½•ä¼ é€’çš„ Pawn Class è¿™æ ·çš„å·¥ä½œå°±æ˜¯å®ƒå¤„ç†çš„ï¼›
- Game State Class æ¸¸æˆçŠ¶æ€ç±»ï¼Œè®°å½•æ•°æ®ç”¨ï¼Œå¦‚å¾—åˆ†ã€æ’è¡Œæ¦œç­‰ï¼Œä¿å­˜æ¸¸æˆè¿›åº¦æ—¶å°±éœ€è¦ä½¿ç”¨å®ƒï¼›
- Player State Class ç©å®¶çŠ¶æ€ç±»ï¼Œå’Œæ¸¸æˆçŠ¶æ€ç±»ç›¸ä¼¼ï¼Œè®°å½•ç©å®¶çŠ¶æ€ä¿¡æ¯ï¼›
- Spectator Class æ—è§‚è€…ç±»ï¼Œä¹Ÿå°±æ˜¯éç©å®¶è§’è‰² NPCï¼›

å¦‚æœæœªæŒ‡å®š HUD Class å’Œ Default Pawn Classï¼Œå¼€å§‹æ¸¸æˆæ—¶ï¼Œä¸ä¼šè‡ªåŠ¨åˆ›å»º HUD ç•Œé¢ï¼Œä¹Ÿä¸ä¼šåˆ›å»ºç©å®¶æ§åˆ¶çš„å¯¹è±¡ã€‚

å¯ä»¥ç›´æ¥å°† Pawn è§’è‰²æ·»åŠ åˆ°åœºæ™¯ï¼Œç„¶åè®¾ç½®å±æ€§ï¼Œå°†å…¶æŒ‡æ´¾ç»™ç©å®¶æ§åˆ¶ï¼šDetails -> Pwan -> Auto Possess Playerï¼Œå¦å¤–è¿˜å¯ä»¥æŒ‡æ´¾ç»™ AI æ§åˆ¶å™¨æ¥æ§åˆ¶ã€‚

ä½¿ç”¨å¼•æ“æä¾›çš„ AGameModeBaseï¼Œå°†ä½¿ç”¨ `DefaultPawn` ä½œä¸ºç©å®¶æ“çºµçš„å¯¹è±¡ï¼Œå®ƒåªå®ç°äº†æœ€åŸºæœ¬çš„ç©ºé—´ç§»åŠ¨èƒ½åŠ›ã€‚é…å¥—çš„ `DefaultPawnMovementComponent` ç§»åŠ¨é£æ ¼è¢«è®¾ç½®ä¸ºæ— é‡åŠ›å¹¶ä¸”å¯é£è¡Œã€‚é™¤äº†åŸæœ‰çš„ MovementComponent å˜é‡å¤–ï¼Œå®ƒè¿˜åŒ…æ‹¬ MaxSpeedã€Acceleration å’Œ Deceleration ç­‰æµ®ç‚¹å€¼ï¼Œå¯ä»¥åœ¨å­ç±»çš„è“å›¾ä¸­è®¿é—®ã€‚

é€šå¸¸ï¼Œéœ€è¦å®ç°è‡ªå·±çš„ç©å®¶è§’è‰²ï¼Œç›´æ¥ä½¿ç”¨ `Character` ç±»è¿›è¡Œæ‰©å±•æ˜¯ä¸ä¸é”™çš„é€‰æ‹©ï¼Œå®ƒå·²ç»å†…å«äº† `UCharacterMovementComponent`ï¼Œåªéœ€è¦æ ¹æ®ç”¨æˆ·è¾“å…¥å®ç°ç›¸åº”çš„åŠ¨ä½œã€‚å¦å¤–ï¼Œéœ€è¦æŒ‡å®šæ‘„åƒæœºæ¥äº§ç”Ÿéœ€è¦çš„ç”»é¢ã€‚å¦‚æœä¸è®¾ç½®æ‘„åƒæœºï¼Œå¼•æ“å°±ä¼šä»¥ Default Pawn å¯¹è±¡çš„ Face æ–¹å‘ä¸­çš„ç”»é¢æ¸²æŸ“åˆ°å±å¹•ä¸Šï¼Œå³ç¬¬ä¸€äººç§°è§’åº¦æä¾›ç”»é¢ã€‚ç§»åŠ¨ç»„ä»¶ `UMovementComponent` æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ—¨åœ¨èƒ½ä¸ºæ‰€å±çš„ Actorï¼ˆæˆ–è§’è‰²ï¼‰æä¾›åŸºæœ¬ç§»åŠ¨åŠŸèƒ½æ¥å£ã€‚

ç”»ä¸ªå›¾ç†æ¸…ä¸€ä¸‹å®ƒä»¬çš„æ—è°±ï¼ŒåŒæ—¶å¤ä¹ ä¸€ä¸‹ AC/SC/PC ä¸‰å¤§åŸºç¡€ç»„ä»¶ï¼š


                                   +=============+
                                   |   UObject   |
                                   +=============+                     +=====================+
                                         |                        +--> |   UAudioComponent   |
                               +=========v=========+              |    +=====================+
                               |  UActorComponent  |              |
                               +===================+              |    +=====================+
                                         |                        +--> |   UCameraComponent  |
                  +----------------------+----------+             |    +=====================+
                  |                                 |             |
    +=============v===============+       +=========v=========+   |    +=====================+
    |      UMovementComponent     |       |  USceneComponent  |---+--> | USpringArmComponent |
    +=============================+       +===================+   |    +=====================+
                  |                                               |
    +=============v===============+                               |    +======================+
    |     UNavMovementComponent   |                               +--> |  UPrimitiveComponent |
    +=============================+                                    +======================+
                  |                                                               |
    +=============v===============+                  +----------------------------+-----+
    |    UPawnMovementComponent   |                  |                                  |
    +=============================+    +=============v===============+    +=============v===============+
                  |                    |       UMeshComponent        |    |       UShapeComponent       |
    +=============v===============+    +=============================+    +=============================+
    | UCharacterMovementComponent |                  |                                  |
    +=============================+    +=============v===============+    +=============v===============+
                                       |    USkinnedMeshComponent    |    |      UCapsuleComponent      |
                                       +=============================+    +=============================+
                                                     |
                                       +=============v===============+
                                       |   USkeletalMeshComponent    |
                                       +=============================+

åˆ›å»ºè‡ªå·±çš„ç»„ä»¶æ—¶ï¼Œéœ€è¦äº†è§£ä¸‰å¤§åŸºç¡€ç»„ä»¶ï¼š

- `UActorComponent` æ‰€æœ‰ç»„ä»¶åŸºç±»ï¼Œæœ€é€‚ç”¨äº Actor çš„æŠ½è±¡è¡Œä¸ºï¼Œä¾‹å¦‚ç§»åŠ¨ã€ç‰©å“æ æˆ–å±æ€§ç®¡ç†ï¼Œä»¥åŠå…¶ä»–éç‰©ç†æ¦‚å¿µã€‚AC ç»„ä»¶ä¸å…·æœ‰åµŒå¥—èƒ½åŠ›ï¼Œæ²¡æœ‰å˜æ¢èƒ½åŠ›ï¼Œå³å®ƒä»¬åœ¨åœºæ™¯ä¸­ä¸å­˜åœ¨ä»»ä½•ç‰©ç†ä½ç½®æˆ–æ—‹è½¬ã€‚
- `USceneComponent` åœºæ™¯ç»„ä»¶ï¼ŒUActorComponent çš„å­ç±»ï¼Œæ”¯æŒåŸºäºä½ç½®çš„è¡Œä¸ºï¼Œè¿™ç±»è¡Œä¸ºä¸éœ€è¦å‡ ä½•è¡¨ç¤ºã€‚è¿™åŒ…æ‹¬å¼¹ç°§è‡‚ã€æ‘„åƒæœºã€ç‰©ç†åŠ›å’Œçº¦æŸï¼ˆä½†ä¸åŒ…æ‹¬ç‰©ç†å¯¹è±¡ï¼‰ï¼Œç”šè‡³éŸ³é¢‘ã€‚
- `UPrimitiveComponent` åŸºå…ƒç»„ä»¶ï¼ŒUSceneComponent çš„å­ç±»ï¼Œæ˜¯æ‹¥æœ‰å‡ ä½•è¡¨ç¤ºçš„åœºæ™¯ç»„ä»¶ï¼Œé€šå¸¸ç”¨äºæ¸²æŸ“è§†è§‰å…ƒç´ æˆ–ä¸ç‰©ç†å¯¹è±¡å‘ç”Ÿç¢°æ’æˆ–é‡å ã€‚è¿™åŒ…æ‹¬é™æ€æˆ–éª¨æ¶ç½‘æ ¼ä½“ã€Sprite æˆ–å…¬å‘Šæ¿ã€ç²’å­ç³»ç»Ÿä»¥åŠç›’ä½“ã€èƒ¶å›Šä½“å’Œçƒä½“ç¢°æ’ä½“ç§¯ã€‚

ç»å…¸çš„è§’è‰²å¯¹è±¡å…·æœ‰ä»¥ä¸‹å†…éƒ¨å±‚æ¬¡ç»“æ„ï¼Œæ ¹æ® Character.h å¤´æ–‡ä»¶ï¼Œå°½ç®¡å®ƒä»¬éƒ½æ˜¯ç§æœ‰æˆå‘˜ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡è“å›¾ç¼–è¾‘å™¨ç»™å®ƒä»¬å¢åŠ å­å¯¹è±¡ï¼š

- USkeletalMeshComponent* `Mesh`; åŸºæœ¬éª¨æ¶ç½‘æ ¼ç»„ä»¶ï¼Œç”¨äºç»„ç»‡å…·ä½“çš„å½¢è±¡æ¨¡å‹
- UCapsuleComponent* `CapsuleComponent`; èƒ¶å›Šç¢°æ’è½®å»“ï¼Œç”¨äºç¢°æ’æ£€æŸ¥å¹¶å¤„ç†ç›¸åº”äº‹ä»¶
- UArrowComponent* `ArrowComponent`; æ–¹å‘ç¤ºæ„ç®­å¤´ï¼Œä¸åœ¨æ¸¸æˆæ—¶æ¸²æŸ“
- UCharacterMovementComponent* `CharacterMovement`; è§’è‰²è¿åŠ¨ç»„ä»¶ï¼Œæä¾›è¿åŠ¨èƒ½åŠ›ï¼Œå¯åœ¨è“å›¾ç¼–è¾‘å™¨ä¸­æ–¹ä¾¿ä¿®æ”¹

```C++
// Character.h 
private:
    /** The main skeletal mesh associated with this Character (optional sub-object). */
    UPROPERTY(Category=Character, VisibleAnywhere, BlueprintReadOnly, meta=(AllowPrivateAccess = "true"))
    TObjectPtr<USkeletalMeshComponent> Mesh;

    /** Movement component used for movement logic in various movement modes (walking, falling, etc), containing relevant settings and functions to control movement. */
    UPROPERTY(Category=Character, VisibleAnywhere, BlueprintReadOnly, meta=(AllowPrivateAccess = "true"))
    TObjectPtr<UCharacterMovementComponent> CharacterMovement;

    /** The CapsuleComponent being used for movement collision (by CharacterMovement). Always treated as being vertically aligned in simple collision check functions. */
    UPROPERTY(Category=Character, VisibleAnywhere, BlueprintReadOnly, meta=(AllowPrivateAccess = "true"))
    TObjectPtr<UCapsuleComponent> CapsuleComponent;

#if WITH_EDITORONLY_DATA
    /** Component shown in the editor only to indicate character facing */
    UPROPERTY()
    TObjectPtr<UArrowComponent> ArrowComponent;
#endif
```

è€Œä½¿ç”¨ä¸­ï¼Œé€šå¸¸è¿˜ä¼šå¢åŠ è·Ÿéšç©å®¶èƒŒåæ‘„åƒæœºçš„å¼¹ç°§è‡‚ç»„ä»¶ `USpringArmComponent`ï¼Œåœ¨æ‘„åƒæœºå‘ç”Ÿç¢°æ’æ—¶è¿›è¡Œæœºä½è°ƒæ•´ï¼Œç»„åˆç©å®¶è·Ÿéšæ‘„åƒæœº `UCameraComponent`ï¼Œè¿™æ ·å°±å¯ä»¥å¾—åˆ°è·Ÿéšç©å®¶çš„ç¬¬ä¸‰äººç§°ç”»é¢ã€‚æ‘„åƒæœºæ•°é‡ä¸é™ï¼Œä¹Ÿå¯ä»¥æ”¾ä¸€ä¸ªä¸“ä¾› VR è®¾ç½®ä½¿ç”¨ï¼Œå½“è¿æ¥äº† VR HMD è¾“å…¥è®¾å¤‡å°±é€šè¿‡ `SetActive` æ–¹æ³•æ¿€æ´»å¹¶ä½¿ç”¨å®ƒã€‚

æ‰€è°“æ‘„åƒæœºï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªæŠ½è±¡ï¼Œç”¨è½¯ä»¶æ¨¡æ‹Ÿçš„ä¸–ç•Œä¸­ï¼Œéœ€è¦æœ‰ä¸€ä¸ªè§’åº¦æ¥çœ‹è™šæ‹Ÿå‡ºæ¥çš„ä¸–ç•Œï¼Œå°±æ˜¯æ¸²æŸ“åˆ°å±å¹•ä¸Šçš„ç”»é¢ã€‚åœ¨ä»€ä¹ˆä½ç½®ï¼Œä»€ä¹ˆè§’åº¦ï¼Œå¤šå¤§çš„ FOV ç­‰ç­‰éƒ½æ˜¯æ¨¡æ‹Ÿæˆåƒçš„æŠ€æœ¯å‚æ•°ã€‚æ‘„åƒæœºå°±æ˜¯æ¨¡æ‹Ÿçœ¼ç›çœ‹ä¸–ç•Œçš„è¿‡ç¨‹ï¼Œå®ƒæœ‰ä¸€ä¸ªè§†ç‚¹ POV - Point Of Viewï¼Œå¯ä»¥é€šè¿‡ ViewTarget ç›®æ ‡æ¥è·å–ï¼Œè¿™ä¸€åˆ‡å‚æ•°å†³å®šäº†å®ƒä¼šçœ‹åˆ°ä»€ä¹ˆã€‚

åœ¨æ¸¸æˆå¼€å‘ä¸­ï¼Œæ‘„åƒæœºçš„è§†è§’æœ‰å‡ ç§æ¨¡å¼ï¼Œæ³¨æ„ Face æœå‘ X è½´æ­£æ–¹å‘ï¼š

- ç¬¬ä¸€äººç§°è§†è§’ï¼Œå³æ¸¸æˆç©å®¶çœ‹åˆ°çš„ç”»é¢å°±ç›¸å½“çœŸå®ä¸–ç•Œä¸­çœ‹åˆ°çš„ç”»é¢ä¸€æ ·ï¼Œä½†çœ‹ä¸åˆ°æ‰€æ§åˆ¶å¯¹è±¡çš„å…¨æ ·ï¼Œæ¯”å¦‚çœ‹ä¸åˆ°è„¸éƒ¨ã€‚
- ç¬¬ä¸‰äººç§°è§†è§’ï¼Œç©å®¶å±å¹•ä¸Šçš„ç”»é¢å¯ä»¥çœ‹åˆ°è‡ªå·±æ§åˆ¶çš„è§’è‰²å¦‚ä½•è¿åŠ¨ï¼›
- å‰é¢ä¸¤ç§éƒ½æ˜¯è¿åŠ¨è§†è§’ï¼Œå½“ç„¶è¿˜å¯ä»¥ä½¿ç”¨å›ºå®šæœºä½è§†è§’ï¼Œè¿˜å¯ä»¥æœ‰ä¸€äº›ç»†å°å˜åŒ–çš„æ¨¡å¼ã€‚

æ‘„åƒæœºçš„ä½ç½®ã€è§’åº¦çš„è°ƒæ•´æ¶‰åŠçŸ©é˜µå˜æ¢æ“ä½œï¼ŒPlayerController å¯¹è±¡æä¾›è“å›¾æ–¹æ³• `SetViewTargetWithBlend` æ¥å¹³æ»‘åœ°åˆ‡æ¢æ‘„åƒæœºé•œå¤´æ–¹ä½ï¼Œæ³¨æ„ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸éœ€è¦æ·»åŠ æ‘„åƒæœºå¯¹è±¡ï¼Œå‚æ•° ViewTarget æ¥æ”¶ä¸€ä¸ª Actor è¢«ç”¨æ¥è·å–é•œå¤´è¦è°ƒæ•´çš„ä½ç½®å’Œè§’åº¦ã€‚å¦‚æœï¼ŒViewTarget æŒ‡å‘çš„è¿™ä¸ª Actor å†…éƒ¨åŒ…å«æ‘„åƒæœºï¼Œå°±ä¼˜å…ˆä½¿ç”¨æ‘„åƒæœºçš„æœºä½ï¼Œå¦åˆ™ä½¿ç”¨ Actor æœ¬èº«çš„ Face æœå‘æ¥è°ƒæ•´ã€‚é€šè¿‡ GetPlayerController è·å–æ§åˆ¶å™¨ï¼Œå¦‚æœåœºæ™¯å†…å·²ç»æœ‰ Pwan å¯ä»¥é€šè¿‡å®ä¾‹æ‰§è¡Œè¿™ä¸ªæ–¹æ³•ï¼Œå¦åˆ™å°±æ‰§è¡Œå…¨å±€æ–¹æ³•æ¥è·å–ç©å®¶æ§åˆ¶å™¨ã€‚

è¿‡åœºåŠ¨ç”»ä¸€èˆ¬æœ‰ä¸¤ç§åˆ‡å…¥æ–¹å¼ï¼šæ¸å˜å’Œèåˆï¼ˆFade & Blendï¼‰ï¼Œé•œå¤´èåˆåœ¨ Sequencer åŠ¨ç”»ä¸Šåº”ç”¨ç›¸å½“å¸¸è§ã€‚æ¸å˜æ˜¯ä¸€ç§ç¨ä¸ºç®€å•çš„é•œå¤´åˆ‡æ¢æ–¹æ³•ï¼Œå…ˆé»‘å±ã€ç™½å±æˆ–å…¶å®ƒçº¯è‰²ï¼Œç„¶åå°†ä¸‹ä¸€ä¸ªç”»é¢æ…¢æ…¢ä»çº¯è‰²è¿‡åº¦å‡ºæ¥ï¼Œæœ€åå®Œæˆä¸¤ä¸ªç”»é¢çš„å¯¹æ¥ã€‚

ç²—é²ç‚¹ï¼Œç›´æ¥åˆ‡æ¢ä¸è¿‡åº¦ã€‚æ¯”å¦‚éœ€è¦ä¸€ä¸ªå…¨å±€çš„æ‘„å½±æœºå¯¹åœºæ™¯è¿›è¡Œè§‚å¯Ÿçš„ç”»é¢ï¼Œè¿™å°±éœ€è¦é‡æ–°åˆ›å»ºä¸€ä¸ªæ‘„å½±æœºï¼Œå¹¶åœ¨è¿™ä¸¤ä¸ªæ‘„å½±æœºç›´æ¥åˆ‡æ¢ã€‚ä¸‹é¢çœ‹ä¸‹å¦‚ä½•å®ç°ã€‚åœ¨ APlayerController ç±»ä¸­ï¼Œæœ‰ä¸€ä¸ª `SetViewTarget` æ–¹æ³•ï¼Œå‚æ•°æ˜¯ä¸€ä¸ª AActor æŒ‡é’ˆï¼Œå°±æ˜¯å®ç°æ­¤åŠŸèƒ½çš„ï¼Œè¿™ä¸ªæ–¹æ³•ä¸æä¸ªè“å›¾è°ƒç”¨ã€‚

ViewTarget ç»“æ„åœ¨ PlayerCameraManager ä¸­å®šä¹‰ï¼Œè´Ÿè´£å‘å…¶æä¾›ç†æƒ³çš„è§†è§’(POV)ã€‚ViewTarget åŒ…å«æœ‰å…³ Actor ç›®æ ‡ã€Actor ç›®æ ‡çš„æ§åˆ¶å™¨ ï¼ˆç”¨äºéæœ¬åœ°æ§åˆ¶çš„ Pawnï¼‰ï¼Œä»¥åŠ PlayerState çš„ä¿¡æ¯ï¼ˆç”¨äºåœ¨è§‚çœ‹çš„åŒæ—¶è·ŸéšåŒä¸€ä¸ªç©å®¶å®Œæˆ Pawn è¿‡æ¸¡å’Œå…¶å®ƒå˜æ›´ï¼‰ã€‚æ‘„åƒæœºä¿¡æ¯ è¢«é€šè¿‡è§†è§’å±æ€§ä»¥ FMinimalViewInfo ç»“æ„çš„å½¢å¼ä¼ ç»™ PlayerCameraManagerã€‚è¯¥ç»“æ„åŒ…å«æ¥è‡ª `CameraComponent` çš„åŸºæœ¬æ‘„åƒæœºä¿¡æ¯ï¼ŒåŒ…æ‹¬ä½ç½®ã€è½¬åŠ¨ã€ æ”¾æ˜ æ¨¡å¼ï¼ˆé€è§†æˆ–æ­£äº¤ï¼‰ã€è§†åœºã€æŠ•å½±å®½åº¦ã€å®½é«˜æ¯”å’ŒåæœŸå¤„ç†æ•ˆæœã€‚è¿™äº›ä¿¡æ¯ä½¿ PlayerCameraManager èƒ½åœ¨ æ‘„åƒæœºç®¡ç†æœŸé—´æ··åˆä¸¤ç§æ‘„åƒæœºé•œå¤´ã€‚

PlayerCameraManager ä¸­çš„ UpdateViewTarget å‡½æ•°æŸ¥è¯¢ ViewTargetï¼Œå¹¶è¿”å›è¯¥ ViewTarget çš„è§†è§’ã€‚å¦‚æœä½ æœ‰å­ç±»åŒ–çš„ APlayerCameraManagerï¼Œå¹¶ä¸”æ²¡åœ¨æŸ¥çœ‹ CameraComponentï¼Œè¯¥å‡½æ•°ä¹Ÿç§°ä¸º BlueprintUpdateCameraã€‚

å¦‚æœåœºæ™¯å†…æ²¡æœ‰æ‘„åƒæœºï¼ŒUE4 ä¼šæä¾›é»˜è®¤çš„é•œå¤´ï¼Œå¦‚æœæ‘„åƒæœºæ˜¯åƒå‰é¢é‚£æ ·è®¾ç½®åœ¨ Pawn å¯¹è±¡å†…éƒ¨çš„ï¼Œå°±ä¼šå½“ä½œä¸“å±ä½¿ç”¨ã€‚åœ¨æ·»åŠ å°†æ‘„åƒæœºåˆ°åœºæ™¯åï¼Œå¯ä»¥ç›´æ¥å°†é•œå¤´æŒ‡å®šç»™ç©å®¶ï¼šDetails -> Auto Player Activationã€‚

å¯¹äºç©å®¶è§’è‰²ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨äººç‰©ç§»åŠ¨ç»„ä»¶ `UCharacterMovementComponent`ï¼Œå®ƒå…è®¸éç‰©ç†åˆšä½“ç±»çš„è§’è‰²ç§»åŠ¨ï¼ˆWalking, Falling, Jump, Swimming, Flyingï¼‰ã€‚ è¯¥ç»„ä»¶ä¸“ç”¨äº Charactersï¼Œæ— æ³•ç”±å…¶ä»–ç±»å®ç°ã€‚å½“ä½ åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ª Characters çš„è“å›¾å¯¹è±¡æ—¶ï¼ŒCharacterMovementComponent ä¼šè‡ªåŠ¨æ·»åŠ ï¼Œæ— éœ€ä½ æ‰‹åŠ¨æ·»åŠ ã€‚

è§’è‰²è¿åŠ¨ä¼˜ç»„ä»¶åŒ…å«ä¸€äº›å¯è®¾ç½®å±æ€§ï¼ŒåŒ…æ‹¬è§’è‰²è·Œè½å’Œè¡Œèµ°æ—¶çš„æ‘©æ“¦åŠ›ã€è§’è‰²é£è¡Œã€æ¸¸æ³³ã€ä»¥åŠè¡Œèµ°æ—¶çš„é€Ÿåº¦ã€æµ®åŠ›ã€é‡åŠ›ç³»æ•°ã€ä»¥åŠäººç‰©å¯æ–½åŠ åœ¨ç‰©ç†å¯¹è±¡ä¸Šçš„åŠ›ã€‚è¿˜åŒ…å«åŠ¨ç”»è‡ªå¸¦çš„ã€ä¸”å·²ç»è½¬æ¢æˆä¸–ç•Œç©ºé—´çš„æ ¹éª¨éª¼è¿åŠ¨å‚æ•°ï¼Œå¯ä¾›ç‰©ç†ç³»ç»Ÿä½¿ç”¨ã€‚æ­¤ç»„ä»¶ä¸ç‰©ç†ç³»ç»Ÿç´§å¯†ç›¸å…³ï¼Œåªæœ‰æ­£ç¡®çš„ç‰©ç†è§„åˆ™æ‰èƒ½ä¿è¯å®ƒä¸ä¼šç©¿å¢™è€Œè¿‡ã€‚

æ­¤å¤–ï¼Œè§’è‰²åŠ¨ä½œç»„ä»¶å…·æœ‰å¼ºå¤§çš„ç½‘ç»œ Gameplay é›†æˆåŠŸèƒ½ï¼Œå¹¶æä¾›æ¡†æ¶å¸®åŠ©å¼€å‘äººå‘˜åˆ›å»ºè‡ªå®šä¹‰çš„è”ç½‘åŠ¨ä½œã€‚

ç©å®¶å‡ºç”Ÿç‚¹æ”¾ç½®å’Œä¸€èˆ¬ Actor ä¸€æ ·ï¼Œäº†è§£ä»¥ä¸‹æŠ€å·§èƒ½ä½¿å¼€å‘è¿‡ç¨‹æ›´å®¹æ˜“ï¼š

- No Player Startï¼ˆæ— ç©å®¶å‡ºç”Ÿç‚¹ï¼‰ï¼š å¦‚å¼€å§‹æ¸¸æˆæ—¶ä¸–ç•Œåœºæ™¯ä¸­ä¸å­˜åœ¨ç©å®¶å‡ºç”Ÿç‚¹ï¼Œç©å®¶è§’è‰²åœ¨ä¸–ç•Œåœºæ™¯ä¸­å‡ºç°çš„åæ ‡å°†ä¸º 0,0,0ã€‚
- å¯ä»¥æ”¾ç½®å¤šä¸ªå®ä¾‹åœ¨å…³å¡ä¸­ï¼Œå¦‚æœæ˜¯å¤šäººæ¸¸æˆå°±å¯ä»¥é€‰æ‹©åœ¨å¤šä¸ªä½ç½®å‡ºåœºã€‚ä¹Ÿå¯ä»¥ä¸æ”¾ç½®ï¼Œæ¸¸æˆé€‰æ‹©é»˜è®¤ä½ç½®å‡ºåœºã€‚
- åœ¨ Viewport ä¸­ï¼Œä½¿ç”¨å³é”®èœå• Play From Here è®¾ç½®å‡ºåœºä½ç½®ï¼Œä¹Ÿå¯è®¾ç½®ä»¥ä»éç©å®¶å‡ºç”Ÿç‚¹çš„å…¶ä»–ä½ç½®å¼€å§‹æ¸¸æˆã€‚
- è¿˜å¯ä»¥è®¾ç½® Play Setting -> Spawn Player At... -> Default Player Start or Current  Camera Locationã€‚
- ç©å®¶å‡ºç”Ÿç‚¹å‡ºç°å°ºå¯¸é”™è¯¯ BadSize è¡¨ç¤ºç©ºé—´ä¸å¤Ÿå®¹çº³ï¼Œè°ƒæ•´ä¸€ä¸ªä½ç½®ï¼Œä¸è¦ä¸å…¶å®ƒå¯¹è±¡æœ‰äº¤å å³å¯ã€‚

ç”¨å…¸å‹çš„ç½‘çº¿å¯¹æˆ˜æ¸¸æˆçš„è¿æ¥è¿‡ç¨‹å¯ä»¥æ›´å¥½åœ°è§£é‡Š GameMode çš„ä½œç”¨ï¼Œä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š

- å®¢æˆ·ç«¯å‘é€è¿æ¥è¯·æ±‚ã€‚
- å¦‚æœæœåŠ¡å™¨æ¥å—è¿æ¥ï¼Œåˆ™å‘é€å½“å‰åœ°å›¾ã€‚
- æœåŠ¡å™¨ç­‰å¾…å®¢æˆ·ç«¯åŠ è½½æ­¤åœ°å›¾ã€‚
- åŠ è½½ä¹‹åï¼ŒæœåŠ¡å™¨å°†åœ¨æœ¬åœ°è°ƒç”¨ `AGameModeBase::PreLogin`ï¼Œè¿™æ—¶ GameMode æœ‰æœºä¼šæ‹’ç»è¿æ¥ã€‚
- å¦‚æœæ¥å—è¿æ¥ï¼ŒæœåŠ¡å™¨å°†è°ƒç”¨ `AGameModeBase::Login`ï¼Œè¿™é‡Œåˆ›å»ºä¸€ä¸ª `PlayerController` ç”¨äºåç»­å¤åˆ¶åˆ°æ–°è¿æ¥çš„å®¢æˆ·ç«¯ï¼Œåœ¨æˆåŠŸæ¥æ”¶åï¼Œä½œä¸ºä»£å®¢æˆ·ç«¯çš„ä¸´æ—¶ä½¿ç”¨ã€‚
- è°ƒç”¨ `APlayerController::BeginPlay`ï¼Œåº”å½“æ³¨æ„çš„æ˜¯ï¼Œåœ¨æ­¤ Actor ä¸Šè°ƒç”¨ RPC å‡½æ•°å°šå­˜åœ¨å®‰å…¨é£é™©ï¼Œåº”å½“ç­‰å¾… `PostLogin` è¢«è°ƒç”¨å®Œæˆã€‚
- æœ€åè°ƒç”¨ `AGameModeBase::PostLogin`ï¼Œç„¶åè®©æœåŠ¡å™¨åœ¨ `PlayerController` ä¸Šå¼€å§‹è°ƒç”¨ RPC å‡½æ•°ã€‚

ç”¨æˆ·è¾“å…¥ä¼šç»è¿‡ `PlayerInput` æ˜ å°„è½¬æ¢ Actor èƒ½å¤Ÿç†è§£å¹¶ä½¿ç”¨çš„æ•°æ®ï¼Œå†ä¼ é€’ç»™ `InputComponent`ï¼Œå†ç”±è¾“å…¥ç»„ä»¶å°†è¾“å…¥è½¬é€’ç»™ Actorï¼Œå¦‚ PlayerControllerï¼ŒLevel Blueprint æˆ– Pawn å¤„ç†ã€‚æ‰€ä»¥ï¼Œå¯ä»¥åœ¨è“å›¾ç¼–è¾‘å™¨ç¼–å†™äº‹ä»¶å¤„ç†ä»£ç ï¼Œç›´æ¥å¤„ç†åœ¨ Project Settings -> Engine -> Input å·¥ç¨‹è®¾ç½®çš„è¾“å…¥æ˜ å°„ `ActionMappings` ç¦»æ•£åŠ¨ä½œè¾“å…¥äº‹ä»¶æˆ–è€… `AxisMappings` è½´æ•°æ®è½®è¯¢äº‹ä»¶æ˜ å°„ã€‚

`PlayerController` æ­¤æ“ä½œå°†æŒ‡ç¤ºç©å®¶æ§åˆ¶å™¨è¦æ”¯é…å’Œæ§åˆ¶çš„ç›®æ ‡ Pawnã€‚`PlayerController` æ˜¯äººç±»ç©å®¶æ§åˆ¶ Pawn ä½¿ç”¨çš„ï¼Œè€Œ AIController åˆ™å¯¹ Pawn æ–½åŠ äººå·¥æ™ºèƒ½æ§åˆ¶æ•ˆæœã€‚æ§åˆ¶å™¨ç”¨ `OnPossess` å‡½æ•°æ§åˆ¶ Pawnï¼Œç”¨ `OnUnPossess` å‡½æ•°æ”¾å¼ƒæ§åˆ¶ Pawnã€‚è°ƒç”¨ Possess å‡½æ•°æ—¶ï¼Œè¯¥å‡½æ•°å°†è‡ªåŠ¨æ£€æŸ¥ Pawn å½“å‰æ˜¯å¦è¢«æ§åˆ¶å¹¶åœ¨è¯•å›¾æ”¯é…æ–°çš„ Pawn å‰å…ˆ UnPossess å®ƒã€‚è®© Pawn è¿›å…¥ä¸ç›´æ¥æ§åˆ¶å¯ç©äººç‰©çš„æ—è§‚è€…çŠ¶æ€ï¼Œå°±å¯ä»¥ä½¿ç”¨ UnPossess å‡½æ•°ã€‚

GameModeBase æˆ–å…¶å­ç±» GameMode è´Ÿè´£åœ¨ç©å®¶è§’è‰²åœ¨æ¸¸æˆè¿‡ç¨‹ä¸­è¢«é”€æ¯æ—¶é‡æ–°ç”Ÿæˆç©å®¶è§’è‰²ç±»ã€‚

é‡ç”Ÿç©å®¶ `RestartPlayer` æ˜¯ GameModeBase ç±»ä¸­çš„å®ç°çš„å…¶ä¸­ä¸€ä¸ªé‡ç”Ÿæ–¹æ³•ï¼Œå®ƒä¼šå°è¯•åœ¨ `FindPlayerStart` è¿”å›çš„ä½ç½®ä¸Šç”Ÿæˆ Pawn ç©å®¶å¯¹è±¡ã€‚å› ä¸ºè§’è‰²æ˜¯ç”± Controller æ§åˆ¶çš„ï¼Œæ‰€ä»¥å®ƒæ¥æ”¶ä¸€ä¸ª `AController` å¼•ç”¨ä½œä¸ºå‚æ•°ã€‚

- RestartPlayer
- RestartPlayerAtPlayerStart
- RestartPlayerAtTransform
- Spawning  é€šè¿‡ `UWorld::SpawnActor` ç”Ÿæˆï¼›
- Deferred Spawn é€šè¿‡ `UWorld::SpawnActorDeferred` å»¶æ—¶ç”Ÿæˆï¼›
- åœ¨è“å›¾ä¸­ä½¿ç”¨ Spawn Actor from Class

æºä»£ç å‚è€ƒï¼š

- UE_4.27\Engine\Source\Editor\UnrealEd\Classes\ActorFactories\ActorFactory.h
- UE_4.27\Engine\Source\Runtime\Engine\Classes\Engine\World.h

æ¸¸æˆä¸­ç©å®¶è¢«å‡»è´¥æˆ–è¢«æ€æ­»ï¼Œå¯ä»¥è°ƒç”¨ Destroy() æ¥æ¸…é™¤è§’è‰²ï¼Œç„¶åé€šè¿‡ GameModeBase å°†å®ƒé‡ç”Ÿã€‚

```C++
void ARespawnPlayerCharacter::CallRestartPlayer()
{
    AController* CortollerRef = GetController();
    Destroy();

    if (UWorld* World = GetWorld())
    {
        if (ARespawnPlayerGameMode* GameMode = Cast<ARespawnPlayerGameMode>(World->GetAuthGameMode()))
        {
            AController* CortollerRef = GetController();
            GameMode->RestartPlayer(CortollerRef);
        }
    }
}
```
ä»¥ä¸Šä»£ç åœ¨è“å›¾ä¸Šå®ç°å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œå› ä¸ºç›´æ¥åœ¨å¯¹è±¡å†…éƒ¨è°ƒç”¨äº† Destroy æ–¹æ³•è¿›è¡Œé”€æ¯è‡ªèº«ï¼Œå¹¶ä¸”åˆåœ¨åç»­æ‰§è¡Œå…¶å®ƒä»£ç ã€‚è¿™é€»è¾‘ä¸Šæœ‰é—®é¢˜ï¼Œå³ä½¿ç”¨ä½¿ç”¨ Timer æ‰§è¡Œä¹Ÿè¡Œä¸é€šï¼Œå› ä¸ºå®šæ—¶å™¨ä»»åŠ¡ä¹ŸåŒæ—¶è¢«é”€æ¯ã€‚å®˜æ–¹ä½¿ç”¨çš„æ˜¯ Event Dispatchers æ–¹å¼ï¼Œé”€æ¯å¯¹è±¡ä¹‹å‰ï¼Œå‘é€ä¿¡æ¯å‘ŠçŸ¥è¦æ‰§è¡Œé‡ç”Ÿå‡½æ•°çš„ä»£ç†æ–¹ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨å¯¹è±¡é”€æ¯åå®Œæˆé‡ç”Ÿã€‚

åœ¨è“å›¾ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ Get Game Mode èŠ‚ç‚¹è·å–æ¸¸æˆæ¨¡å¼å¯¹è±¡ï¼Œä¸å¿…ä½¿ç”¨ World å¯¹è±¡ã€‚

å¦‚æœç†è§£äº† Actor çš„ç”Ÿå‘½å‘¨æœŸï¼Œå°±å¯ä»¥ä½¿ç”¨ SpawnActor å…¨å±€æ–¹æ³•ç”Ÿæˆç©å®¶å¯¹è±¡ï¼Œå†è®©æ§åˆ¶å™¨ Possess å®ƒï¼Œè¿™æ˜¯æœ€ç›´æ¥çš„æ–¹æ³•ï¼š

```C++
SpawnedActor = GetWorld()->SpawnActor<AMyFirstActor>
(AMyFirstActor::StaticClass(), SpawnLocation);
```

åœ¨è“å›¾ä¸­ï¼Œéœ€è¦ä½¿ç”¨ SpawnActorFromClassã€SpawnActorForGameplayTaskï¼Œå±æ€§ Spawn Transform æŒ‡å®šä¸€ä¸ªä½ç½®è½¬æ¢çŸ©é˜µï¼Œå¯ä»¥å°†å…¶å®ƒå¯¹è±¡ä¸­çš„ Location ç»è¿‡ Math Conversions åº“ ToTransform è¿›è¡Œè½¬æ¢ã€‚å¦‚æœæ˜¯ C++ï¼ŒåŸºç¡€ç±» FTransform æ„é€ å™¨å¯ä»¥ç›´æ¥è½¬æ¢å¾—åˆ°ã€‚




## âš¡ GameMode & GameState
- Game Mode and Game State https://docs.unrealengine.com/4.27/en-US/InteractiveExperiences/Framework/GameMode/
- Game Mode å’Œ Game State https://docs.unrealengine.com/4.27/zh-CN/InteractiveExperiences/Framework/GameMode/

ä¸¤ä¸ªä¸»è¦ç±»è´Ÿè´£å¤„ç†è¿›è¡Œä¸­æ¸¸æˆçš„ç›¸å…³ä¿¡æ¯ï¼šGame Mode å’Œ Game Stateã€‚

å³ä½¿æœ€å¼€æ”¾çš„æ¸¸æˆä¹Ÿæ‹¥æœ‰åŸºç¡€è§„åˆ™ï¼Œè€Œè¿™äº›è§„åˆ™æ„æˆäº† Game Modeã€‚

åœ¨æœ€åŸºç¡€çš„å±‚é¢ä¸Šï¼Œè¿™äº›è§„åˆ™åŒ…æ‹¬ï¼š

- å‡ºç°çš„ç©å®¶å’Œè§‚ä¼—æ•°é‡ï¼Œä»¥åŠå…è®¸çš„ç©å®¶å’Œè§‚ä¼—æœ€å¤§æ•°é‡ã€‚
- ç©å®¶è¿›å…¥æ¸¸æˆçš„æ–¹å¼ï¼Œå¯åŒ…å«é€‰æ‹©ç”Ÿæˆåœ°ç‚¹å’Œå…¶ä»–ç”Ÿæˆ/é‡ç”Ÿæˆè¡Œä¸ºçš„è§„åˆ™ã€‚
- æ¸¸æˆæ˜¯å¦å¯ä»¥æš‚åœï¼Œä»¥åŠå¦‚ä½•å¤„ç†æ¸¸æˆæš‚åœã€‚
- å…³å¡ä¹‹é—´çš„è¿‡æ¸¡ï¼ŒåŒ…æ‹¬æ¸¸æˆæ˜¯å¦ä»¥åŠ¨ç”»æ¨¡å¼å¼€åœºã€‚

åŸºäºè§„åˆ™çš„äº‹ä»¶åœ¨æ¸¸æˆä¸­å‘ç”Ÿï¼Œéœ€è¦è¿›è¡Œè¿½è¸ªå¹¶å’Œæ‰€æœ‰ç©å®¶å…±äº«æ—¶ï¼Œä¿¡æ¯å°†é€šè¿‡ Game State è¿›è¡Œå­˜å‚¨å’ŒåŒæ­¥ã€‚

è¿™äº›ä¿¡æ¯åŒ…æ‹¬ï¼š

- æ¸¸æˆå·²è¿è¡Œçš„æ—¶é—´ï¼ˆåŒ…æ‹¬æœ¬åœ°ç©å®¶åŠ å…¥å‰çš„è¿è¡Œæ—¶é—´ï¼‰ã€‚
- æ¯ä¸ªä¸ªä½“ç©å®¶åŠ å…¥æ¸¸æˆçš„æ—¶é—´å’Œç©å®¶çš„å½“å‰çŠ¶æ€ã€‚
- å½“å‰ Game Mode çš„åŸºç±»ã€‚
- æ¸¸æˆæ˜¯å¦å·²å¼€å§‹ã€‚

ç‰¹å®šçš„åŸºç¡€ï¼ˆå¦‚è¿›è¡Œæ¸¸æˆæ‰€éœ€è¦çš„ç©å®¶æ•°é‡ï¼Œæˆ–ç©å®¶åŠ å…¥æ¸¸æˆçš„æ–¹æ³•ï¼‰åœ¨å¤šç§ç±»å‹çš„æ¸¸æˆä¸­å…·æœ‰å…±é€šæ€§ã€‚å¯æ ¹æ®å¼€å‘çš„ç‰¹å®šæ¸¸æˆè¿›è¡Œæ— ç©·æ— å°½çš„è§„åˆ™å˜åŒ–ã€‚æ— è®ºè§„åˆ™å¦‚ä½•ï¼ŒGame Modes çš„ä»»åŠ¡éƒ½æ˜¯å®šä¹‰å’Œå®ç°è§„åˆ™ã€‚

UE 4.14 ç‰ˆæœ¬ä¸­åŠ å…¥äº†ç®€æ´é«˜æ•ˆçš„ `AGameModeBase`ï¼Œæ˜¯æ–°ä»£ç é¡¹ç›®ä¸­åŒ…å«çš„å…¨æ–°é»˜è®¤æ¸¸æˆæ¨¡å¼ã€‚æ˜¯æ‰€æœ‰ Game Mode çš„åŸºç±»ï¼Œæ˜¯ç»å…¸çš„ `AGameMode` ç®€åŒ–ç‰ˆæœ¬ã€‚AGameMode æ˜¯ 4.14 ç‰ˆæœ¬ä¹‹å‰çš„åŸºç±»ï¼Œä»ç„¶ä¿ç•™ï¼ŒåŠŸèƒ½ å¦‚æ—§ï¼Œä½†ç°åœ¨æ˜¯ AGameModeBase çš„å­ç±»ã€‚ç”±äºå…¶æ¯”èµ›çŠ¶æ€æ¦‚å¿µçš„å®ç°ï¼ŒAGameMode æ›´é€‚ç”¨äºæ ‡å‡†æ¸¸æˆç±»å‹ï¼ˆå¦‚å¤šäººå°„å‡»æ¸¸æˆï¼‰ã€‚

æ‰€æœ‰ Game Mode å‡ä¸º AGameModeBase çš„å­ç±»ã€‚è€Œ AGameModeBase åŒ…å«å¤§é‡å¯è¦†ç›–çš„åŸºç¡€åŠŸèƒ½ï¼ŒGame Modes å½“å‰å¸¸ç”¨çš„åŸºç±»å°±åªæœ‰è¿™ä¸¤ä¸ªã€‚

AGameModeBase å‡½æ•°åŒ…æ‹¬ï¼š

- `InitGame` äº‹ä»¶åœ¨å…¶ä»–è„šæœ¬ä¹‹å‰è°ƒç”¨ï¼ˆåŒ…æ‹¬ PreInitializeComponentsï¼‰ï¼Œç”± AGameModeBasePreInitializeComponents
- `PreLogin` æ¥å—æˆ–æ‹’ç»å°è¯•åŠ å…¥æœåŠ¡å™¨çš„ç©å®¶ã€‚å¦‚å®ƒå°† ErrorMessage è®¾ä¸ºä¸€ä¸ªéç©ºå­—ç¬¦ä¸²ï¼Œä¼šå¯¼è‡´ Login å‡½æ•°å¤±è´¥ã€‚PreLogin åœ¨ Login å‰è°ƒç”¨ï¼ŒLogin è°ƒç”¨å‰å¯èƒ½éœ€è¦å¤§é‡æ—¶é—´ï¼ŒåŠ å…¥çš„ç©å®¶éœ€è¦ä¸‹è½½æ¸¸æˆå†…å®¹æ—¶å°¤å…¶å¦‚æ­¤ã€‚
- `PostLogin` æˆåŠŸç™»å½•åè°ƒç”¨ã€‚è¿™æ˜¯é¦–ä¸ªåœ¨ PlayerController ä¸Šå®‰å…¨è°ƒç”¨å¤åˆ¶å‡½æ•°ä¹‹å¤„ã€‚OnPostLogin å¯åœ¨è“å›¾ä¸­å®ç°ï¼Œä»¥æ·»åŠ é¢å¤–çš„é€»è¾‘ã€‚
- `HandleStartingNewPlayer` åœ¨ PostLogin åæˆ–æ— ç¼æ¸¸å†åè°ƒç”¨ï¼Œå¯åœ¨è“å›¾ä¸­è¦†ç›–ï¼Œä¿®æ”¹æ–°ç©å®¶èº«ä¸Šå‘ç”Ÿçš„äº‹ä»¶ã€‚å®ƒå°†é»˜è®¤åˆ›å»ºä¸€ä¸ªç©å®¶ pawnã€‚
- `RestartPlayer` è°ƒç”¨å¼€å§‹ç”Ÿæˆä¸€ä¸ªç©å®¶ pawnã€‚å¦‚éœ€è¦æŒ‡å®š Pawn ç”Ÿæˆçš„åœ°ç‚¹ï¼Œè¿˜å¯ä½¿ç”¨ RestartPlayerAtPlayerStart å’Œ RestartPlayerAtTransform å‡½æ•°ã€‚OnRestartPlayer å¯åœ¨è“å›¾ä¸­å®ç°ï¼Œåœ¨æ­¤å‡½æ•°å®Œæˆåæ·»åŠ é€»è¾‘ã€‚
- `SpawnDefaultPawnAtTransform` è¿™å®é™…ç”Ÿæˆç©å®¶ Pawnï¼Œå¯åœ¨è“å›¾ä¸­è¦†ç›–ã€‚
- `Logout` ç©å®¶ç¦»å¼€æ¸¸æˆæˆ–è¢«æ‘§æ¯æ—¶è°ƒç”¨ã€‚å¯å®ç° OnLogout æ‰§è¡Œè“å›¾é€»è¾‘ã€‚

å¯é’ˆå¯¹æ¸¸æˆæä¾›çš„æ¯ä¸ªæ¯”èµ›æ ¼å¼ã€ä»»åŠ¡ç±»å‹æˆ–ç‰¹æ®ŠåŒºåŸŸåˆ›å»º AGameModeBase çš„å­ç±»ã€‚ä¸€æ¬¾æ¸¸æˆå¯æ‹¥æœ‰ä»»æ„æ•°é‡çš„ Game Modeï¼Œå› æ­¤ä¹Ÿå¯æ‹¥æœ‰ä»»æ„æ•°é‡çš„ AGameModeBase ç±»å­ç±»ï¼›ç„¶è€Œï¼Œç»™å®šæ—¶é—´ä¸Šåªèƒ½ä½¿ç”¨ä¸€ä¸ª Game Modeã€‚æ¯æ¬¡å…³å¡è¿›è¡Œæ¸¸æˆå®ä¾‹åŒ–æ—¶ Game Mode Actor å°†é€šè¿‡ UGameEngine::LoadMap() å‡½æ•°è¿›è¡Œå®ä¾‹åŒ–ã€‚

Game Mode ä¸ä¼šå¤åˆ¶åˆ°åŠ å…¥å¤šäººæ¸¸æˆçš„è¿œç¨‹å®¢æˆ·ç«¯ï¼›å®ƒåªå­˜åœ¨äºæœåŠ¡å™¨ä¸Šï¼Œå› æ­¤æœ¬åœ°å®¢æˆ·ç«¯å¯çœ‹åˆ°ä¹‹å‰ä½¿ç”¨è¿‡çš„ç•™å­˜ Game Mode ç±»ï¼ˆæˆ–è“å›¾ï¼‰ï¼›ä½†æ— æ³•è®¿é—®å®é™…çš„å®ä¾‹å¹¶æ£€æŸ¥å…¶å˜é‡ï¼Œç¡®å®šæ¸¸æˆè¿›ç¨‹ä¸­å·²å‘ç”Ÿå“ªäº›å˜åŒ–ã€‚å¦‚ç©å®¶ç¡®å®éœ€è¦æ›´æ–°ä¸å½“å‰ Game Mode ç›¸å…³çš„ä¿¡æ¯ï¼Œå¯å°†ä¿¡æ¯ä¿å­˜åœ¨ä¸€ä¸ª AGameStateBase Actor ä¸Šï¼Œè½»æ¾ä¿æŒåŒæ­¥ã€‚AGameStateBase Actor éš Game Mode è€Œåˆ›å»ºï¼Œä¹‹åè¢«å¤åˆ¶åˆ°æ‰€æœ‰è¿œç¨‹å®¢æˆ·ç«¯ã€‚

AGameMode æ˜¯ AGameModeBase çš„å­ç±»ï¼Œæ‹¥æœ‰ä¸€äº›é¢å¤–çš„åŠŸèƒ½æ”¯æŒå¤šäººæ¸¸æˆå’Œæ—§è¡Œä¸ºã€‚æ‰€æœ‰æ–°å»ºé¡¹ç›®é»˜è®¤ä½¿ç”¨ AGameModeBaseã€‚å¦‚æœéœ€è¦æ­¤é¢å¤–è¡Œä¸ºï¼Œå¯åˆ‡æ¢åˆ°ä» AGameMode è¿›è¡Œç»§æ‰¿ã€‚å¦‚ä» AGameMode è¿›è¡Œç»§æ‰¿ï¼Œä¹Ÿå¯ä» AGameState ç»§æ‰¿æ¸¸æˆçŠ¶æ€ï¼ˆå…¶æ”¯æŒæ¯”èµ›çŠ¶æ€æœºï¼‰ã€‚

AGameMode åŒ…å«ä¸€ä¸ªè·Ÿè¸ªæ¯”èµ›çŠ¶æ€æˆ–æ•´ä½“æ¸¸æˆæµç¨‹çš„çŠ¶æ€æœºã€‚å¯ä½¿ç”¨ GetMatchState æˆ– HasMatchStartedã€IsMatchInProgress å’Œ HasMatchEnded ä¹‹ç±»çš„å°è£…å™¨æŸ¥è¯¢å½“å‰çš„çŠ¶æ€ã€‚ä»¥ä¸‹æ˜¯å¯èƒ½çš„æ¯”èµ›çŠ¶æ€ï¼š

```cpp
/** Possible state of the current match, where a match is all the gameplay that happens on a single map */
namespace MatchState
{
    extern ENGINE_API const FName EnteringMap;          // We are entering this map, actors are not yet ticking
    extern ENGINE_API const FName WaitingToStart;       // Actors are ticking, but the match has not yet started
    extern ENGINE_API const FName InProgress;           // Normal gameplay is occurring. Specific games will have their own state machine inside this state
    extern ENGINE_API const FName WaitingPostMatch;     // Match has ended so we aren't accepting new players, but actors are still ticking
    extern ENGINE_API const FName LeavingMap;           // We are transitioning out of the map to another location
    extern ENGINE_API const FName Aborted;              // Match has failed due to network issues or other problems, cannot continue
}
```

æ¸¸æˆçŠ¶æ€å°†å›ºå®šä¸º InProgressï¼Œå› ä¸ºè¿™æ˜¯è°ƒç”¨ BeginPlayã€actor å¼€å§‹ tick çš„çŠ¶æ€ã€‚ç„¶è€Œï¼Œä¸ªä½“æ¸¸æˆå¯èƒ½è¦†ç›–è¿™äº›çŠ¶æ€çš„è¡Œä¸ºï¼Œç”¨æ›´å¤æ‚çš„è§„åˆ™æ„å»ºä¸€ä¸ªå¤šäººæ¸¸æˆï¼Œå¦‚åœ¨ä¸€æ¬¾å¤šäººå°„å‡»æ¸¸æˆä¸­ç­‰å¾…å…¶ä»–ç©å®¶åŠ å…¥æ—¶å…è®¸ç©å®¶åœ¨å…³å¡ä¸­è‡ªç”±é£è¡Œã€‚

å¯åˆ›å»ºæ´¾ç”Ÿè‡ª Game Mode ç±»çš„è“å›¾ï¼Œå¹¶å°†å®ƒä»¬ç”¨ä½œé¡¹ç›®æˆ–å…³å¡çš„é»˜è®¤ Game Modeã€‚

æ´¾ç”Ÿè‡ª Game Mode çš„è“å›¾å¯è¿›è¡Œä»¥ä¸‹é»˜è®¤è®¾ç½®ï¼š

- Default Pawn Class æŒ‡å®šé»˜è®¤çš„æ¸¸æˆç©å®¶æ˜¯ä»€ä¹ˆç±»å‹çš„å¯¹è±¡ï¼Œåœ¨è¿›å…¥æ¸¸æˆæ—¶ï¼Œè¿™ç§å¯¹è±¡å°±ç”±ç©å®¶æ“çºµï¼Œå³è¢« PlayController æ“æ§ï¼›
- HUD Class æŒ‡å®š Head-up Display ç±»å‹ï¼Œå¼€å§‹æ¸¸æˆæ—¶ä¼šåŠ è½½å®ƒç”¨æ¥æ˜¾ç¤ºæ¸¸æˆä¸­çš„å¹³é¢ UI ç•Œé¢ï¼Œä¸»è¦ç”¨æ¥æ˜¾ç¤ºä¿¡æ¯ï¼Œå¦‚ç©å®¶çš„ç”Ÿå‘½å€¼ï¼›
- Player Controller Class ç©å®¶æ§åˆ¶å™¨ï¼Œè¿™æ˜¯æ¸¸æˆç¨‹åºæ§åˆ¶çš„æ ¸å¿ƒç±»ï¼Œæ¯”å¦‚ç”¨æˆ·è¾“å…¥å¦‚ä½•ä¼ é€’çš„ Pawn Class è¿™æ ·çš„å·¥ä½œå°±æ˜¯å®ƒå¤„ç†çš„ï¼›
- Game State Class æ¸¸æˆçŠ¶æ€ç±»ï¼Œè®°å½•æ•°æ®ç”¨ï¼Œå¦‚å¾—åˆ†ã€æ’è¡Œæ¦œç­‰ï¼Œä¿å­˜æ¸¸æˆè¿›åº¦æ—¶å°±éœ€è¦ä½¿ç”¨å®ƒï¼›
- Player State Class ç©å®¶çŠ¶æ€ç±»ï¼Œå’Œæ¸¸æˆçŠ¶æ€ç±»ç›¸ä¼¼ï¼Œè®°å½•ç©å®¶çŠ¶æ€ä¿¡æ¯ï¼›
- Spectator Class æ—è§‚è€…ç±»ï¼Œä¹Ÿå°±æ˜¯éç©å®¶è§’è‰² NPCï¼›

æ­¤å¤–ï¼ŒGame Mode çš„è“å›¾ååˆ†å®ç”¨ï¼Œå› ä¸ºå®ƒä»¬æ— éœ€è°ƒæ•´ä»£ç å³å¯å¯ç”¨å˜é‡è°ƒæ•´ã€‚å› æ­¤å¯ç”¨äºä½¿å•ä¸€ Game Mode é€‚ç”¨åˆ°å¤šä¸ªä¸åŒå…³å¡ï¼Œæ— éœ€ä½¿ç”¨ç¡¬ç¼–ç èµ„æºå¼•ç”¨æˆ–ä¸ºæ¯æ¬¡è°ƒæ•´è¯·æ±‚å·¥ç¨‹æ”¯æŒå’Œä»£ç ä¿®æ”¹ã€‚

Game State è´Ÿè´£å¯ç”¨å®¢æˆ·ç«¯ç›‘æ§æ¸¸æˆçŠ¶æ€ã€‚ä»æ¦‚å¿µä¸Šè€Œè¨€ï¼ŒGame State åº”è¯¥ç®¡ç†æ‰€æœ‰å·²è¿æ¥å®¢æˆ·ç«¯å·²çŸ¥çš„ä¿¡æ¯ï¼ˆç‰¹å®šäº Game Mode ä½†ä¸ç‰¹å®šäºä»»ä½•ä¸ªä½“ç©å®¶ï¼‰ã€‚å®ƒèƒ½å¤Ÿè¿½è¸ªæ¸¸æˆå±‚é¢çš„å±æ€§ï¼Œå¦‚å·²è¿æ¥ç©å®¶çš„åˆ—è¡¨ã€å¤ºæ——æ¸¸æˆä¸­çš„å›¢é˜Ÿå¾—åˆ†ã€å¼€æ”¾ä¸–ç•Œæ¸¸æˆä¸­å·²å®Œæˆçš„ä»»åŠ¡ï¼Œç­‰ç­‰ã€‚

Game State å¹¶éè¿½è¸ªç©å®¶ç‰¹æœ‰å†…å®¹ï¼ˆå¦‚å¤ºæ——æ¯”èµ›ä¸­ç‰¹å®šç©å®¶ä¸ºå›¢é˜Ÿè·å¾—çš„åˆ†æ•°ï¼‰çš„æœ€ä½³ä¹‹å¤„ï¼Œå› ä¸ºå®ƒä»¬ç”± Player State æ›´æ¸…æ™°åœ°å¤„ç†ã€‚æ•´ä½“è€Œè¨€ï¼ŒGameState åº”è¯¥è¿½è¸ªæ¸¸æˆè¿›ç¨‹ä¸­å˜åŒ–çš„å±æ€§ã€‚è¿™äº›å±æ€§ä¸æ‰€æœ‰äººçš†ç›¸å…³ï¼Œä¸”æ‰€æœ‰äººå¯è§ã€‚Game mode åªå­˜åœ¨äºæœåŠ¡å™¨ä¸Šï¼Œè€Œ Game State å­˜åœ¨äºæœåŠ¡å™¨ä¸Šä¸”ä¼šè¢«å¤åˆ¶åˆ°æ‰€æœ‰å®¢æˆ·ç«¯ï¼Œä¿æŒæ‰€æœ‰å·²è¿æ¥æœºå™¨çš„æ¸¸æˆè¿›ç¨‹æ›´æ–°ã€‚

AGameStateBase æ˜¯åŸºç¡€å®ç°ï¼Œå…¶éƒ¨åˆ†é»˜è®¤åŠŸèƒ½åŒ…æ‹¬ï¼š

- `GetServerWorldTimeSeconds` è¿™æ˜¯ UWorld å‡½æ•° GetTimeSeconds çš„æœåŠ¡å™¨ç‰ˆæœ¬ï¼Œå°†åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¸ŠåŒæ­¥ï¼Œå› æ­¤è¯¥æ—¶é—´å¯ç”¨äºå¤åˆ¶ï¼Œååˆ†å¯é ã€‚
- `PlayerArray` è¿™æ˜¯æ‰€æœ‰ APlayerState å¯¹è±¡çš„é˜µåˆ—ï¼Œå¯¹æ¸¸æˆä¸­æ‰€æœ‰ç©å®¶æ‰§è¡Œæ“ä½œæ—¶ååˆ†å®ç”¨ã€‚
- `HasBegunPlay` å¦‚ BeginPlay å‡½æ•°åœ¨æ¸¸æˆä¸­çš„ actor ä¸Šè°ƒç”¨ï¼Œåˆ™è¿”å› trueã€‚

AGameStateBase é€šå¸¸åœ¨ C++ æˆ–è“å›¾ä¸­å»¶å±•ï¼ŒåŒ…å«ç”¨äºä½¿æ¸¸æˆä¸­ç©å®¶çŸ¥æ™“å½“å‰æƒ…å†µçš„é¢å¤–å˜é‡å’Œå‡½æ•°ã€‚è¿›è¡Œçš„ç‰¹å®šä¿®æ”¹é€šå¸¸åŸºäº Game State çš„é…å¯¹ Game Modeã€‚Game Mode è‡ªèº«ä¹Ÿå¯å°†å…¶é»˜è®¤ Game State ç±»è¦†ç›–ä¸ºæ´¾ç”Ÿè‡ª AGameStateBase çš„ä»»æ„ C++ ç±»æˆ–è“å›¾ã€‚

GameSession æ˜¯åœ¨ç½‘ç»œè”æœºæ¸¸æˆä¸­åšç®¡ç†çš„ç±»ï¼Œå¹¶ä¸å­˜å‚¨æ•°æ®ã€‚åœ¨å•æœºæ¸¸æˆä¸­ï¼Œä¹Ÿå­˜åœ¨è¯¥ç±»å¯¹è±¡ç”¨æ¥åš LoginPlayerã€‚


## âš¡ Input & Interactive
- https://docs.unrealengine.com/4.27/zh-CN/InteractiveExperiences/Input/
- Gamepad Events https://docs.unrealengine.com/4.27/en-US/BlueprintAPI/Input/GamepadEvents/

Input Processing Procedure ç¤ºæ„å›¾ï¼š

    +============================+
    |       InputComponent       |             +============================+
    |            Checks    +-----+<----------- |    PlayerInput Mapping     |
    |                      |     |             +=============^==============+
    |  +===================V==+  |                           |              
    |  | Input-Enabled Actor  |->+----+        +============================+
    |  | (Most recent first)  |  |    |        | Hardware Input from Player |
    |  +======================+  |    |        | Keyboard, Touchpad, Mouse, |
    |             |              |    |        | Gamepad, Oculus and so on. |
    |  +==========V===========+  |    |        +============================+
    |  |   PlayerController   |->+----+
    |  +======================+  |    |
    |             |              |    |
    |  +==========V===========+  |    |
    |  |   Level Blueprint    |->+----+
    |  +======================+  |    |
    |             |              |    |
    |  +==========V===========+  |    |    +=============+
    |  |         Pawn         |->+----+--->|  Game Logic |
    |  +======================+  |         +=============+
    |                            |
    +============================+

Controller æ˜¯ä¸€ç§å¯ä»¥æ§åˆ¶ Pawn æˆ–å…¶æ´¾ç”Ÿç±»ï¼Œä¾‹å¦‚ Characterï¼Œä»è€Œæ§åˆ¶å…¶åŠ¨ä½œçš„éå®ä½“ Actorã€‚

`PlayerController` æ˜¯äººç±»ç©å®¶æ§åˆ¶ Pawn ä½¿ç”¨çš„ï¼Œè€Œ AIController åˆ™å¯¹ Pawn æ–½åŠ äººå·¥æ™ºèƒ½æ§åˆ¶æ•ˆæœã€‚æ§åˆ¶å™¨ç”¨ `OnPossess` å‡½æ•°æ§åˆ¶ Pawnï¼Œç”¨ `OnUnPossess` å‡½æ•°æ”¾å¼ƒæ§åˆ¶ Pawnã€‚è°ƒç”¨ Possess å‡½æ•°æ—¶ï¼Œè¯¥å‡½æ•°å°†è‡ªåŠ¨æ£€æŸ¥ Pawn å½“å‰æ˜¯å¦è¢«æ§åˆ¶å¹¶åœ¨è¯•å›¾æ”¯é…æ–°çš„ Pawn å‰å…ˆ UnPossess å®ƒã€‚è®© Pawn è¿›å…¥ä¸ç›´æ¥æ§åˆ¶å¯ç©äººç‰©çš„æ—è§‚è€…çŠ¶æ€ï¼Œå°±å¯ä»¥ä½¿ç”¨ UnPossess å‡½æ•°ã€‚

æ§åˆ¶å™¨ä¼šæ¥æ”¶å…¶æ§åˆ¶çš„ Pawn å¯¹è±¡æ‰€å‘ç”Ÿè¯¸å¤šäº‹ä»¶çš„é€šçŸ¥ï¼Œå› æ­¤ï¼Œæ§åˆ¶å™¨å¯å€Ÿæœºå®ç°å“åº”æ­¤äº‹ä»¶çš„è¡Œä¸ºï¼Œæ‹¦æˆªäº‹ä»¶å¹¶æ¥æ›¿ Pawn çš„é»˜è®¤è¡Œä¸ºã€‚ å¯ä»¥è®©æ§åˆ¶å™¨åœ¨ç»™å®šçš„ Pawn ä¹‹å‰è¿è¡Œï¼Œä»è€Œä»è€Œæœ€å¤§é™åº¦å‡å°‘è¾“å…¥å¤„ç†ä¸ Pawn ç§»åŠ¨ä¹‹é—´çš„å»¶è¿Ÿã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼Œæ§åˆ¶å™¨ä¸ Pawn æ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªæ§åˆ¶å™¨åœ¨ä»»ä½•ç»™å®šçš„æ—¶é—´åªæ§åˆ¶ä¸€ä¸ª Pawnã€‚è¿™å¯¹äºå¤§å¤šæ•° ç±»å‹çš„æ¸¸æˆéƒ½æ˜¯å¯ä»¥æ¥å—çš„ï¼Œä½†å¯¹äºæŸäº›ç±»å‹çš„æ¸¸æˆå¯èƒ½éœ€è¦è¿›è¡Œè°ƒæ•´ï¼Œå› ä¸ºå®æ—¶ç­–ç•¥å¯èƒ½éœ€è¦èƒ½å¤ŸåŒæ—¶æ§åˆ¶å¤šä¸ªå®ä½“ã€‚

é»˜è®¤å·¥ç¨‹è®¾ç½®ä¸­ï¼ŒProject Settings -> Engine -> Input -> Default Class è®¾ç½®äº† `PlayerInput` å’Œ `InputComponent` ç±»ä½œä¸ºæ ‡å‡†çš„è¾“å…¥å¤„ç†ç±»ã€‚å¯ä»¥æ›´æ”¹å®ƒï¼Œæ¯”å¦‚å°†é¡¹ç›®é…ç½®ä¸ºä½¿ç”¨ Enhanced Inputï¼Œå…ˆå¯ç”¨è¿™ä¸ªæ’ä»¶ï¼Œé‡å¯ç¼–è¾‘å™¨ï¼Œå†å°† Default Player Input class å’Œ Default Input Component Class æŒ‡å®šä¸º Enhanced Input æ’ä»¶æä¾›çš„å®ç°ã€‚

`InputComponent` æœ€å¸¸åº”ç”¨åœ¨ Pawn å’Œæ§åˆ¶å™¨ä¸­ï¼Œä½†å¦‚æœéœ€è¦ï¼Œä¹Ÿå¯ä»¥åœ¨å…¶ä»– Actor å’Œå…³å¡è„šæœ¬ä¸­ä½¿ç”¨ã€‚å®ƒå°†é¡¹ç›®ä¸­çš„è½´æ˜ å°„ AxisMapping å’Œæ“ä½œæ˜ å°„ ActionMapping é“¾æ¥åˆ°ä»¥ C++ ä»£ç æˆ–è“å›¾å›¾è¡¨å»ºç«‹çš„æ¸¸æˆæ“ä½œï¼ˆé€šå¸¸ä¸ºå‡½æ•°ï¼‰ã€‚

è¾“å…¥ç»„ä»¶å¯ä»¥ç»‘å®šçš„è¾“å…¥äº‹ä»¶ç±»å‹å¦‚ä¸‹ï¼š

```cpp
// UE_4.27\Engine\Source\Runtime\Engine\Classes\Components\InputComponent.h
TArray<FInputKeyBinding> KeyBindings;
TArray<FInputTouchBinding> TouchBindings;
TArray<FInputAxisBinding> AxisBindings;
TArray<FInputAxisKeyBinding> AxisKeyBindings;
TArray<FInputVectorAxisBinding> VectorAxisBindings;
TArray<FInputGestureBinding> GestureBindings;
```

è¾“å…¥ç»„ä»¶ç”¨äºæ‰§è¡Œè¾“å…¥å¤„ç†çš„ä¼˜å…ˆçº§å †æ ˆå¦‚ä¸‹ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ä¼˜å…ˆï¼‰ï¼š

- è®¾ç½® Accepts input å·²å¯ç”¨çš„ Actorï¼Œä»æœ€æ™šå¯ç”¨è€…åˆ°æœ€æ—©å¯ç”¨è€…ã€‚
- å¦‚æœä½ å¸Œæœ›æŸä¸ªç‰¹å®šçš„ Actor æ€»æ˜¯ç¬¬ä¸€ä¸ªè¢«è€ƒè™‘è¿›è¡Œè¾“å…¥å¤„ç†çš„ Actorï¼Œé‚£ä¹ˆä½ å¯ä»¥é‡æ–°å¯ç”¨å®ƒçš„ Accepts inputï¼Œå®ƒå°†è¢«ç§»åŠ¨åˆ°å †æ ˆçš„é¡¶éƒ¨ã€‚
- æ§åˆ¶å™¨ã€‚
- å…³å¡è„šæœ¬ã€‚
- Pawnã€‚

å¦‚æœä¸€ä¸ª InputComponent è·å¾—äº†è¾“å…¥ï¼Œé‚£ä¹ˆå®ƒåœ¨å †æ ˆçš„åç»§éƒ¨åˆ†å°†ä¸å†å¯ç”¨ã€‚

`PlayerInput` è´Ÿè´£å°†ç©å®¶çš„è¾“å…¥æ˜ å°„è½¬æ¢ä¸º Actorï¼Œå¦‚ PlayerController æˆ– Pawn èƒ½å¤Ÿç†è§£å¹¶ä½¿ç”¨çš„æ•°æ®ã€‚

PlayerInput ä¸­å®šä¹‰äº†ä¸¤ç§ç»“æ„ä½“ï¼š

- FInputActionKeyMapping å®šä¹‰äº†æ“ä½œæ˜ å°„ ActionMappingã€‚
- FInputAxisKeyMapping å®šä¹‰äº†è½´æ˜ å°„ AxisMappingã€‚

`ActionMappings` å°†ç¦»æ•£æŒ‰é’®æˆ–æŒ‰é”®æ˜ å°„åˆ°ä¸€ä¸ª"å‹å¥½çš„åç§°"ï¼Œè¯¥åç§°ç¨åå°†ä¸äº‹ä»¶é©±åŠ¨å‹è¡Œä¸ºç»‘å®šã€‚æœ€ç»ˆçš„æ•ˆæœæ˜¯ï¼ŒæŒ‰ä¸‹ï¼ˆå’Œ/æˆ–é‡Šæ”¾ï¼‰å•ä¸ªé”®ã€é¼ æ ‡æŒ‰é’®æˆ–é”®ç›˜æŒ‰é’®å°†ç›´æ¥è§¦å‘æŸä¸ªæ¸¸æˆè¡Œä¸ºï¼Œæ³¨æ„ä¸æ˜¯è¿ç»­è§¦å‘ã€‚

`AxisMappings` å°†é”®ç›˜ã€æ§åˆ¶å™¨æˆ–é¼ æ ‡è¾“å…¥æ˜ å°„åˆ°ä¸€ä¸ª"å‹å¥½çš„åç§°"ï¼Œè¯¥åç§°ç¨åå°†ç»‘å®šåˆ°è¿ç»­çš„æ¸¸æˆè¡Œä¸ºï¼Œä¾‹å¦‚ç§»åŠ¨ã€‚AxisMapping æ˜ å°„çš„è¾“å…¥ä¼šè¢«æŒç»­è½®è¯¢ï¼Œå³ä½¿å½“å®ƒä»¬åˆšåˆšæŠ¥å‘Šå®ƒä»¬çš„è¾“å…¥å€¼å½“å‰ä¸ºé›¶æ—¶ä¹Ÿæ˜¯å¦‚æ­¤ã€‚è¿™å¯å®ç°ç§»åŠ¨æˆ–å…¶ä»–æ¸¸æˆè¡Œä¸ºçš„å¹³ç¨³è¿‡æ¸¡ï¼Œè€Œä¸æ˜¯ ActionMapping é‚£æ ·ç¦»æ•£åœ°è¾“å…¥è§¦å‘æ¸¸æˆäº‹ä»¶ã€‚

æ˜ å°„ä¸­ä½¿ç”¨çš„ç¡¬ä»¶è¾“å…¥å®šä¹‰éƒ½æ˜¯åœ¨ InputCoreType ä¸­å»ºç«‹çš„ã€‚

å¯ä»¥åœ¨ UE4 å·¥ç¨‹é…ç½®ä¸­è®¾ç½®ç”¨æˆ·è¾“å…¥ä¸äº‹ä»¶çš„æ˜ å°„å…³ç³»ï¼ŒEdit -> Project Settings... -> Engine -> Inputã€‚

ä½¿ç”¨ C++ å®ç°æ˜ å°„ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ `UInputSettings` ç±»ä¸­çš„å‡½æ•°ï¼Œè¿™ä¸ªç±»ç”¨äºåŠ è½½å’Œä¿å­˜é…ç½®æ–‡ä»¶ä¸­çš„æ˜ å°„å…³ç³»ã€‚

å¯ä»¥åœ¨æ‰§è¡Œ ACharacter::SetupPlayerInputComponent é€»è¾‘ä¸­åµŒå…¥è¾“å…¥æ˜ å°„ï¼Œéƒ¨åˆ†å…³é”® API å‚è€ƒå¦‚ä¸‹ï¼š

```C++,
    void AddAxisMapping(const FInputAxisKeyMapping&amp; KeyMapping, bool bForceRebuildKeymaps = true);
    void RemoveAxisMapping(const FInputAxisKeyMapping& InKeyMapping, const bool bForceRebuildKeymaps)
    void AddActionMapping(const FInputActionKeyMapping&amp; KeyMapping, bool bForceRebuildKeymaps = true);
    void RemoveActionMapping(const FInputActionKeyMapping&amp; KeyMapping, bool bForceRebuildKeymaps = true);

    #include "GameFramework/PlayerInput.h"
    #include "GameFramework/InputSettings.h"

    FInputAxisKeyMapping AxisMap;
    AxisMap.AxisName = TEXT("MoveRight");
    AxisMap.Key = EKeys::E;

    FInputActionKeyMapping ActionMap;
    ActionMap.ActionName = TEXT("Jump");
    ActionMap.bAlt = true;
    ActionMap.Key = EKeys::G;
    //æ·»åŠ è½´å‘äº‹ä»¶ç»‘å®š æ³¨æ„æ­¤å‡½æ•°æœ‰é»˜è®¤å‚æ•°boolï¼Œå¦‚æœä¸ºfalseåˆ™ä¸‹æ¬¡å¯åŠ¨ç¨‹åºåº”ç”¨æ–°çš„æŒ‰é”®æ˜ å°„ï¼Œé»˜è®¤ä¸ºtrueç«‹å³ç”Ÿæ•ˆ
    UInputSettings::GetInputSettings()->AddAxisMapping(AxisMap);
    //ç§»é™¤ä¸€ä¸ªå·²ç»æ·»åŠ çš„æŒ‰é”®äº‹ä»¶
    UInputSettings::GetInputSettings()->RemoveActionMapping(ActionMap);
    UInputSettings::GetInputSettings()->SaveKeyMappings();
```

æ·»åŠ æ˜ å°„åï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨æ˜ å°„è®¾ç½®çš„å‹å¥½åç§°ä¸äº‹ä»¶å¤„ç†å‡½æ•°ç»‘å®šï¼š

```C++,
    void APlayerCharacter::SetupPlayerInputComponent(class UInputComponent* PlayerInputComponent)
    {
        check(PlayerInputComponent);
        PlayerInputComponent->BindAction("Jump", IE_Pressed, this, &ACharacter::Jump);
        PlayerInputComponent->BindAxis("MoveRight", this, &ARespawnPlayerCharacter::MoveRight);
    }
```

UE 4 çš„é…ç½®æ–‡ä»¶å¤šç§å¤šæ ·ï¼Œå…¶ç›®å½•ä¿¡æ¯å¯ä»¥é€šè¿‡ FPaths æä¾›çš„é™æ€æ–¹æ³•è·å–ï¼š

```C++
// UE_4.27\Engine\Source\Runtime\Core\Public\Misc\Paths.h
// UE_4.27\Engine\Source\Runtime\Engine\Private\Kismet\BlueprintPathsLibrary.cpp
// UE_4.27\Engine\Source\Programs\UnrealBuildTool\System\ConfigHierarchy.cs
FString PluginConfigDir = FPaths::GetPath(Plugin.FileName) / TEXT("Config/");
FString EngineConfigDir = FPaths::EngineConfigDir();
FString SourceConfigDir = FPaths::SourceConfigDir();
FString ProjectConfigDir = FPaths::ProjectConfigDir();
```


## âš¡ Enemy & AI
- AI https://docs.unrealengine.com/4.26/zh-CN/InteractiveExperiences/ArtificialIntelligence
- Reynolds, Craig W. "Steering behaviors for autonomous characters". Game developers conference. Vol. 1999. 1999.
- Steering Behaviors è¡Œä¸ºæ§åˆ¶ https://www.rharel.com/projects/steering-behaviors
- steering behaviors ç¤ºèŒƒè„šæœ¬ https://github.com/rharel/js-steering-behaviors
- [Amit è®² A* å¯»è·¯ç®—æ³•](https://blog.csdn.net/denghecsdn/article/details/78778769)
- [Amitâ€™s A* Pages](http://theory.stanford.edu/~amitp/GameProgramming/)
- è™šå¹»å¼•æ“4çš„AIç³»ç»Ÿ https://docs.unrealengine.com/4.27/zh-CN/InteractiveExperiences/ArtificialIntelligence/
- Navmesh - Content Examples https://docs.unrealengine.com/4.27/en-US/Resources/ContentExamples/NavMesh/

æåˆ°æ¸¸æˆ AI å°±ä¸å¾—ä¸è¯´ Pacman ç»å…¸åƒè±†äººæ¸¸æˆï¼Œä½œä¸ºç»å…¸æ¸¸æˆï¼Œå…¶æœ€æœ‰ç‰¹è‰²çš„éƒ¨åˆ†å°±æ˜¯å¸¦æœ‰ AI åŸå‹çš„å››ä¸ªå¹½çµå¯¹æ‰‹ï¼š

- çº¢è‰²çš„å¹½çµ Blinky ä»£è¡¨æ‰§ç€ï¼Œå®ƒä¼šä¸€ç›´è·Ÿç€ç©å®¶èµ°ï¼Œå¹¶ä¸”éšç€ç©å®¶åƒçš„è±†è¶Šå¤šç§»åŠ¨é€Ÿåº¦ä¼šå˜çš„è¶Šå¿«ã€‚
- ç²‰è‰²çš„å¹½çµ Clyde ä»£è¡¨é¢„çŸ¥ï¼Œå®ƒä¼šä»¥ç©å®¶è·¯å¾„çš„å‰æ–¹ä¸ºç›®çš„åœ°ï¼Œç»å¸¸ä¼šå›´å µç©å®¶ï¼Œå®˜æ–¹çš„åç§°å«åšâ€œåŸ‹ä¼è€…â€ã€‚
- é’è‰²çš„å¹½çµ Linky ä»£è¡¨å˜åŒ–ï¼Œå®ƒæœ‰æ—¶å€™ä¼šè¿½ç€ç©å®¶èµ°ï¼Œæœ‰æ—¶å€™åˆä¼šæå‰å µåœ¨ç©å®¶å¿…ç»çš„è·¯ä¸Šï¼Œå–„äºå˜åŒ–ã€‚
- é»„è‰²çš„å¹½çµ Pinky ä»£è¡¨éšæ„ï¼Œå®ƒçš„è¡ŒåŠ¨è·¯çº¿å®Œå…¨éšæœºï¼Œç”šè‡³å¤§å¤šæ•°æ—¶é—´å®ƒä¼šå®Œå…¨ä¸ç†ä¼šç©å®¶ï¼Œä¸€ä¸ªäººè‡ªå·±åœ¨åœ°å›¾ä¸Šæ¼«æ¸¸ã€‚

æ›´å¤šå‚è€ƒèµ„æºï¼š

- [https://www.googlepacman.net/](https://www.googlepacman.net/)
- [http://macek.github.io/google_pacman/](http://macek.github.io/google_pacman/)
- [https://passer-by.com/pacman/](https://passer-by.com/pacman/)

- [Play Online](https://jimboyeah.github.io/pacman/)
- [Pacman on Github](https://github.com/jimboyeah/demo/tree/pacman)

ç”¨æˆ·å¯ä»¥åŒæ—¶ä½¿ç”¨å¤šä¸ªç³»ç»Ÿï¼Œåœ¨è™šå¹»å¼•æ“ 4 é¡¹ç›®ä¸­åˆ›å»ºè§’è‰²æˆ–å…¶ä»–å®ä½“çš„ AIã€‚åœ¨é¡¹ç›®ä¸­åˆ›å»ºé«˜å¯ä¿¡åº¦ AI æ—¶ï¼Œä»åˆ†æ”¯ä¸ºä¸åŒå†³ç­–æˆ–è¡ŒåŠ¨çš„è¡Œä¸ºæ ‘ Behavior Treesï¼Œåˆ°é€šè¿‡ç¯å¢ƒæŸ¥è¯¢ç³»ç»Ÿï¼ˆEQSï¼‰è¿è¡ŒæŸ¥è¯¢æ¥è·å¾—ç¯å¢ƒä¿¡æ¯ï¼Œå†åˆ°ä½¿ç”¨ AI Perception æ„ŸçŸ¥ç³»ç»Ÿè·å–æ„Ÿå®˜ä¿¡æ¯ï¼ˆå¦‚è§†è§‰ã€å£°éŸ³æˆ–ä¼¤å®³ä¿¡æ¯ï¼‰ï¼Œæ‰€æœ‰è¿™äº›ç³»ç»Ÿéƒ½å‘æŒ¥ç€å…³é”®çš„ä½œç”¨ã€‚æ­¤å¤–ï¼Œæ‰€æœ‰è¿™äº›å·¥å…·éƒ½å¯ä»¥é€šè¿‡ AI Debugging å·¥å…·è¿›è¡Œè°ƒè¯•ï¼Œå¸®åŠ©ç”¨æˆ·äº†è§£ AI åœ¨ç‰¹å®šæ—¶é—´çš„æ€ç»´å’Œè¡Œä¸ºã€‚ 

åœ¨ UE4 ä¸­æ‰“é€  AI å’Œä½¿ç”¨è¿™äº›ç³»ç»Ÿæ—¶ï¼Œæ„å»ºæ€è·¯å¦‚ä¸‹ï¼š

- è¡Œä¸ºæ ‘å¤„ç†å†³ç­–è¿›ç¨‹ï¼›
- AI æ„ŸçŸ¥ç³»ç»Ÿå°†æºè‡ªç¯å¢ƒçš„åˆºæ¿€ï¼ˆä¾‹å¦‚æ„Ÿå®˜ä¿¡æ¯ï¼‰ä¼ è¾“åˆ°è¡Œä¸ºæ ‘ï¼›
- ç„¶å EQS å¤„ç†å…³äºç¯å¢ƒæœ¬èº«çš„æŸ¥è¯¢ã€‚

ä¸ºå……åˆ†åˆ©ç”¨ AI è°ƒè¯•å·¥å…·ï¼Œéœ€è¦åœ¨è¿è¡Œè¡Œä¸ºæ ‘ã€æˆ–æ‹¥æœ‰ä¸€ä¸ª AI æ„ŸçŸ¥ç»„ä»¶çš„å…³å¡ä¸­è®¾ç½®ä¸€ä¸ªå…·å¤‡ AI Controller çš„ Pawnã€‚å¦‚æœ AI æ­£åœ¨æ‰§è¡Œä¸€ä¸ª EQSï¼Œå…¶è¿è¡Œæ—¶å°†è¢«åæ˜ åˆ° AI è°ƒè¯•å·¥å…·ä¸­ã€‚åœ¨æ¸¸æˆè¿è¡Œæ—¶æŒ‰ä¸‹æ’‡å·ï¼ˆ'ï¼‰é”®å³å¯å¯ç”¨ AI è°ƒè¯•ï¼Œåˆ†å·ï¼ˆ;ï¼‰é”®æ‰“å¼€ Gameplay Debugeã€‚

é€šå¸¸ï¼Œæœ€åŸºæœ¬çš„ AI æ§åˆ¶èƒ½åŠ›æ˜¯ä¸€ä¸ªè§’è‰²çš„å¯»è·¯èƒ½åŠ›ï¼Œè€Œåœ¨ä¸€äº›ç±»å‹çš„æ¸¸æˆä¸­ï¼Œæ•Œäººæœ‰å›ºå®šçš„è¡Œä¸ºæ¨¡å¼è€Œä¸éœ€è¦è¿™éƒ¨åˆ†åŠŸèƒ½ã€‚

ç»å…¸å¯»è·¯ç®—æ³•æ˜¯ `Dijkstra` ç®—æ³•ï¼Œæ˜¯ç®—æ³•åç§°ä¹Ÿæ˜¯ä½œè€…åç§°ã€‚ç®—æ³•åŸºäºæ ¼å­ Gridï¼Œä¸€ä¸ªæ ¼å­å¯ä»¥å¾€å…«ä¸ªæ–¹å‘ç§»åŠ¨ï¼Œä½†æ˜¯æ•ˆç‡ä½ä¸‹ï¼ŒçœŸæ­£åœ¨é¡¹ç›®ä¸­å®ç”¨çš„æ˜¯ç»è¿‡ä¼˜åŒ–çš„ `A*` å¯»è·¯ç®—æ³•ã€‚ç›¸å¯¹äºè¿ªæ°æ–¯ç‰¹æ‹‰çš„ç®—æ³•ï¼Œä¸åŒç‚¹åœ¨äºï¼ŒåŠ äº†ä¸€ä¸ªå¯å‘ç³»æ•°ï¼Œæå¤§é™ä½äº†æœç´¢ç©ºé—´ï¼Œæé«˜ç®—æ³•æ•ˆç‡ï¼Œæ²¡æœ‰è¿™ä¸ªç®—æ³•ä¼°è®¡å¾ˆå¤šæ¸¸æˆçš„ NPC å¯»è·¯éƒ½è·‘ä¸åŠ¨ã€‚

åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œå¦‚æœå¯ä»¥é¢„å…ˆè®¡ç®—å‡ºæ¯ä¸ªèŠ‚ç‚¹åˆ°ç»ˆç‚¹çš„ç›´çº¿è·ç¦»ï¼Œåˆ™å¯ä»¥åˆ©ç”¨è¿™ä¸ªä¿¡æ¯æ›´å¿«çš„åˆ°è¾¾ç»ˆç‚¹ã€‚è™½ç„¶ï¼Œç»™å®šä¸€å¼ å¸¦æœ‰é˜»ç¢ç‰©çš„æ ¼å­åœ°å›¾ï¼Œäººè„‘å¯ä»¥ç¬é—´å°±é€šè¿‡çœ¼ç›è§‚å¯Ÿåˆ°çš„å›¾åƒå¾—åˆ°èµ·ç‚¹åˆ°ç›®æ ‡ç‚¹çš„æœ€ä½³è·¯å¾„ã€‚ä½†æ˜¯è®¡ç®—æœºéœ€è¦çš„æ˜¯æ•°æ®ï¼Œä¸ºäº†å¾—åˆ°è¿™ä¸ªæœ€ä½³æ•°æ®ï¼Œå°±éœ€è¦å¯¹å…¨éƒ¨è¾“å…¥çš„æ ¼å­è¿›è¡Œå¤„ç†ï¼Œè¿™å°±éœ€è¦ä¼˜åŒ–ç®—æ³•æ¥æé«˜å·¥ä½œæ•ˆç‡ã€‚

ä¸ Dijkstra ç®—æ³•ç±»ä¼¼ï¼Œä¹Ÿä½¿ç”¨ä¸€ä¸ªä¼˜å…ˆé˜Ÿåˆ—ï¼Œä½†æ­¤æ—¶ä»¥æ¯ä¸ªèŠ‚ç‚¹åˆ°è¾¾ç»ˆç‚¹çš„è·ç¦»ä½œä¸ºä¼˜å…ˆçº§ï¼Œæ¯æ¬¡å§‹ç»ˆé€‰å–åˆ°ç»ˆç‚¹ç§»åŠ¨ä»£ä»·æœ€å°ï¼ˆç¦»ç»ˆç‚¹æœ€è¿‘ï¼‰çš„èŠ‚ç‚¹ä½œä¸ºä¸‹ä¸€ä¸ªéå†çš„èŠ‚ç‚¹ï¼Œè¿™ç§ç®—æ³•ç§°ä¹‹ä¸º `Best First` BFS æœ€ä½³ä¼˜å…ˆç®—æ³•ï¼Œä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§æ·±åº¦ä¼˜å…ˆæˆ–è´ªå¿ƒç­–ç•¥çš„å¯»è·¯ç®—æ³•ã€‚

Dijkstra ç®—æ³•æ˜¯ä¸€ç§å¹¿åº¦ä¼˜å…ˆéå†çš„ç®—æ³•ï¼Œåœ¨æ²¡æœ‰éšœç¢çš„æƒ…å†µä¸‹å°±åƒæ³¢æµªæ‰©æ•£ä¸€æ ·å»æœç´¢ç›®æ ‡ã€‚è€Œæ”¹è‰¯çš„ Best First çš„é€Ÿåº¦å¾ˆå¿«ï¼Œä»¥æœ€é è¿‘ç›®æ ‡ç‚¹çš„ä¼˜å…ˆå»æ‰¾åˆ°è¾¾ç›®æ ‡ç‚¹çš„è·¯å¾„ã€‚

ä½†æ˜¯ï¼Œå½“é‡åˆ°éšœç¢æ—¶ï¼Œæœ€ä½³ä¼˜å…ˆç®—æ³•ä¸ä¸€å®šå¯ä»¥è·å–æœ€ä½³ç»“æœï¼Œå®ƒå¤§ä½“è¶‹åŠ¿ä¼šæ²¿ç€èµ·ç‚¹åˆ°ç»ˆç‚¹çš„ç›´çº¿ä¸ºå¯¹ç§°è½´ï¼Œå·¦å³æ¥å›å¯»ç‚¹ã€‚å°±ä½ çŸ¥é“å‰é¢æœ‰ä¸€æ¡æ¡¥å¯ä»¥è¿‡æ²³ï¼Œç»“æœç›´åˆ°æ¡¥å¤´å‘ç°å½“...å½“...å½“...åœ¨æ–½å·¥ï¼Œå°æ¡¥ä¸ç»™è¿‡äº†ï¼Œæœ€åè¿˜å¾—å›åˆ°ç å¤´æ­èˆ¹è¿‡æ¸¡ã€‚

å‡è®¾ï¼Œåœ¨èµ·ç‚¹å’Œç›®æ ‡ç‚¹ä¹‹é—´æœ‰ä¸€ä¸ªå·¨å¤§çš„å‡¹å£å½¢é˜»ç¢ç‰©ï¼Œä¸”å¼€å£å‘ç€èµ·ç‚¹ï¼Œé‚£ä¹ˆä»¥ä¸Šä¸¤ç§å¯»è·¯ç®—æ³•çš„ç»“æœå¯èƒ½æ˜¯ï¼š

-  `Dijkstra` ç®—æ³•æ‘¸ç´¢äº†å¤§é¢ç§¯åŒºåŸŸï¼Œå³ç»è¿‡å¤§é‡è¿ç®—ï¼Œå¹¶æœ€ç»ˆæ‰¾åˆ°ä¸€ä¸ªé¿å¼€äº†å‡¹å£å†…éƒ¨çš„æœ€ä½³è·¯å¾„ï¼›
-  `Best First` åˆ™å¿«é€Ÿæ‰¾åˆ°ä¸€æ¡ç›´æ¥å¾€å‡¹å£å†…éƒ¨èµ°ï¼Œå¹¶ä¸”é‡åˆ°é˜»ç¢åå†æŠ˜å›çš„ä¸€æ¡æ¯”è¾ƒé•¿çš„è·¯å¾„ï¼›

æ‰€ä»¥ï¼Œè¿™é‡Œå°±æœ‰ä¸€ä¸ªç®—æ³•æ€§èƒ½å’Œè·¯å¾„æœ€ä¼˜çš„å¹³è¡¡æ€§é—®é¢˜ï¼Œæ‰¾åˆ°ä¸€ç§æ—¢æœ‰æ•ˆç‡ï¼Œåˆèƒ½æ‰¾åˆ°æ·å¾„çš„ç®—æ³•æ˜¯æœ€ä½³ç­”æ¡ˆã€‚

åœ¨ `Dijkstra` ç®—æ³•å’Œ `Best First` ç®—æ³•çš„åŸºç¡€ä¸Šï¼Œ`A*` ç®—æ³•æä¾›çš„è§£å†³æ–¹æ³•æ˜¯æ ¹æ®èµ·ç‚¹åˆ°å‚è€ƒç‚¹çš„è·ç¦» + å‚è€ƒç‚¹åˆ°ç›®æ ‡ç‚¹çš„è·ç¦»ä¹‹å’Œæ¥å¯»è·¯ã€‚

å¯ä»¥ç”¨ f(n)=g(n)+h(n) è¡¨è¾¾ï¼Œå…¶ä¸­ï¼š

- f(n) æ˜¯èŠ‚ç‚¹ n çš„ç»¼åˆä¼˜å…ˆçº§ã€‚é€‰æ‹©ä¸‹ä¸€ä¸ªè¦éå†çš„èŠ‚ç‚¹æ—¶ï¼Œæ€»ä¼šé€‰å–ç»¼åˆä¼˜å…ˆçº§æœ€é«˜ï¼ˆå€¼æœ€å°ï¼‰çš„èŠ‚ç‚¹ã€‚
- g(n) æ˜¯èŠ‚ç‚¹ n è·ç¦»èµ·ç‚¹çš„ä»£ä»·ã€‚
- h(n) æ˜¯èŠ‚ç‚¹ n è·ç¦»ç»ˆç‚¹çš„é¢„è®¡ä»£ä»·ï¼Œè¿™ä¹Ÿå°±æ˜¯ `A*` ç®—æ³•çš„å¯å‘å‡½æ•° Heuristic Functionã€‚

è¿™æ˜¯è¿ªæ°æ–¯ç‰¹æ‹‰ç®—æ³•å’Œæœ€ä½³ä¼˜å…ˆç®—æ³•çš„ç»“åˆä½“ï¼Œå¯ä»¥åŠ ä¸ªæƒé‡å‚æ•° K æ¥è°ƒèŠ‚è¿™ä¸¤ç§ç®—æ³•çš„å½±å“ç¨‹åº¦

    f(n)= k * g(n) + (1-k) * h(n) ï¼› k å–å€¼ ä¸º [0,1]

- å½“ k=0 æ—¶ï¼Œf(n)= h(n) ï¼Œå°±å˜æˆäº†æœ€ä½³ä¼˜å…ˆç®—æ³•ï¼›
- å½“ k=1 æ—¶ï¼Œf(n)= g(n) ï¼Œå°±å˜æˆäº†è¿ªæ°æ–¯ç‰¹æ‹‰ç®—æ³•ï¼›
- å½“ k=0.5 æ—¶ï¼Œf(n)=g(n)+h(n) ï¼Œå°±å˜æˆ `A*` ç®—æ³•ï¼›

AI ç³»ç»Ÿçš„å¼•å…¥ï¼Œå¯ä»¥è§£å†³ Steering Behaviors è¡Œä¸ºæ§åˆ¶éœ€æ±‚ï¼Œè¿™æ˜¯ä½¿ç”¨åŠ¨åŠ›å­¦çš„æ•°æ®ç»“æ„ï¼ŒåŠ é€Ÿåº¦å’Œè§’é€Ÿåº¦å‚æ•°ç­‰æ¨¡æ‹ŸçœŸå®æœ‰ç”Ÿå‘½çš„æ´»åŠ¨ï¼Œå¦‚ï¼š

- æ•Œäººçš„æ¸¸èµ°è¡Œä¸º wandering behaviorï¼›
- Seeking åœ°å›¾æ¢ç´¢ï¼›
- Arriving åˆ°è¾¾æŒ‡å®šç‚¹ï¼›
- Pursuit åŒ…æŠ„å¯¹æ‰‹ï¼›
- Evade è§„é¿å¯¹æ‰‹ï¼›
- Flee è·³è·‘ï¼›
- Separate åˆ†æ•£è¡Œä¸ºï¼›
- Align é˜Ÿåˆ—è¡Œä¸ºï¼› 
- Patrol å·¡é€»è¡Œä¸ºï¼Œå¯ä»¥é€‚å½“è®¾ç½®å·¡é€»ç‚¹ PatrolPointã€‚

åœ¨ UE4 é¡¹ç›®ä¸­ï¼Œé€šè¿‡ Navigation System å®ç°ï¼š

- Navigation Mesh è®¾ç½® AI traversing ç©¿è¶ŠåŒºåŸŸï¼›
- Path Following é€šè¿‡ Path èŠ‚ç‚¹è®¾è®¡ AI ç©¿è¶Šè·¯çº¿ï¼›
- Behavior Tree è¡Œä¸ºæ ‘çš„è®¾ç½®å¯ä»¥æœ‰ç›®çš„åœ°åˆ›é€ æ›´åŠ å¤šæ ·åŒ–çš„ç©å®¶ä½“éªŒï¼Œæ¨¡æ‹Ÿæ›´çœŸå®çš„ NPC æ´»åŠ¨ï¼›
- Steering behaviors è¿åŠ¨è¡Œä¸ºæ§åˆ¶ï¼Œé€šè¿‡å®ƒæ¥è®¾ç½®ä¸€ä¸ªå…·æœ‰å„ç§è¡Œä¸ºçš„æœ‰é™çŠ¶æ€æœº Finite State Machines (FSM) ï¼›
- Sensory systems æ„ŸçŸ¥ç³»ç»Ÿå¯ä»¥æä¾›å…³é”®ç»†èŠ‚ï¼Œä¾‹å¦‚é™„è¿‘çš„æ’­æ”¾æœºã€å£°çº§ã€é™„è¿‘çš„è¦†ç›–èŒƒå›´ä»¥åŠè®¸å¤šå…¶ä»–å¯ä»¥æ”¹å˜è¿åŠ¨çš„ç¯å¢ƒå˜é‡ã€‚

å®˜æ–¹æ–‡æ¡£ Navmesh Content Examples æä¾›äº†ä¸‰ä¸ªç¤ºä¾‹ï¼š

- 1.1 Simple navigation around obstacles ç®€å•éšœç¢ç‰©å¯¼èˆªï¼Œæ¼”ç¤ºå¦‚ä½•è®© pawn é€šè¿‡ä¸€ç»„éšœç¢ç‰©ã€ç¿»è¿‡æ–œå¡æˆ–ä»çª—å°ä¸Šè·³ä¸‹æ¥ã€‚
- 1.2 Navigation using a Nav Link Proxy ä½¿ç”¨ `NavLinkProxy` è¿›è¡Œå¯¼èˆªï¼Œæ¼”ç¤ºè®© pawn å¯¼èˆªåˆ°æ–œå¡å¹¶è·³ä¸‹ã€‚
- 1.3 Navmesh rebuild after moving Actors æ¼”ç¤ºåœ¨ç¼–è¾‘å™¨ç§»åŠ¨ Actor åè‡ªåŠ¨é‡å»ºå¯»è·¯ç½‘æ ¼ä½“ã€‚

å¯¼èˆªç³»ç»Ÿé€šå¸¸ä¼šå°†äº‹æƒ…åˆ—ä¸ºç®€å•çŠ¶æ€ï¼Œå› ä¸ºå®ƒä¸éœ€è¦æ¥æ”¶å¤ªå¤šå¤–éƒ¨æ•°æ®ï¼Œå°±åƒä¸€ä¸ª Actor åœ¨å†°ä¸Šè¡Œèµ°æˆ–é€šè¿‡æŸæ²¹ï¼Œä½†æ˜¯å¯ä»¥éå¸¸æ–¹ä¾¿åœ°åœ¨ä¸‰ç»´ç©ºé—´ä¸­å¯¼èˆªåˆ°ä»»ä½•æƒ³è¦çš„ä½ç½®ã€‚

å½“å¦‚åŒ…å« Static Meshes çš„ actor åœ¨ç¼–è¾‘å™¨å†…ç§»åŠ¨æ—¶ï¼ŒNavMesh ä¼šè‡ªåŠ¨æ›´æ–°ã€‚ ç¤ºä¾‹ä¸­ï¼Œå¯ä»¥ç§»åŠ¨ Static Mesh å—å¹¶æ”¾ç½®å®ƒï¼Œä½¿å®ƒå……å½“ä¸¤ä¸ªæ–œå¡é—´éš™çš„æ¡¥æ¢ã€‚NavMesh å°†ä¼šåœ¨æ–°å½¢æˆçš„æ¡¥æ¢ä¸Šè‡ªåŠ¨æ›´æ–°å¹¶æ„å»ºï¼Œä½¿å¾—ä½ åœ¨ Play æˆ– Simulate æ—¶ï¼Œpawn å¯ä»¥é€šè¿‡å¯¼èˆªæ¥ç©¿è¶Šå®ƒã€‚

åœ¨ç¼–è¾‘å™¨ä¸­ï¼Œå°† `NavMeshBoundsVolume` æ”¾ç½®åœ¨å…³å¡ä¸­åï¼ŒæŒ‰ä¸‹ P é”®å°†æ˜¾ç¤º/éšè— NavMesh è¦†ç›–çš„åŒºåŸŸã€‚å¯ä»¥å…³é—­å…³å¡ç¼–è¾‘å™¨çš„ NavMesh è¦†ç›–åŒºåŸŸè‡ªåŠ¨æ›´æ–°åŠŸèƒ½ï¼Œæ“ä½œè·¯å¾„ï¼šEditor Settings -> Level Editor -> Miscellaneous -> Update Navigation Automaticallyã€‚

MaxEnemies  SpawnAIFromClass

    APawn* UAIBlueprintHelperLibrary::SpawnAIFromClass

    UE_4.27\Engine\Source\Runtime\AIModule\Private\Blueprint\AIBlueprintHelperLibrary.cpp:
    UE_4.27\Engine\Source\Developer\FunctionalTesting\Private\FunctionalAITest.cpp



## âš¡ Levels å…³å¡åœ°å›¾
- Level å…³å¡åœ°å›¾ https://docs.unrealengine.com/4.27/zh-CN/Basics/Levels/
- Level Blueprint https://docs.unrealengine.com/4.27/en-US/ProgrammingAndScripting/Blueprints/UserGuide/Types/LevelBlueprint/
- Level Designer Quick Start https://docs.unrealengine.com/4.27/en-US/BuildingWorlds/LDQuickStart/
- å…‰ç…§ä¸é˜´å½± https://docs.unrealengine.com/4.27/zh-CN/BuildingWorlds/LightingAndShadows/

åœ¨æ¸¸æˆä¸­ï¼Œç©å®¶çœ‹åˆ°çš„æ‰€æœ‰å¯¹è±¡ï¼Œäº¤äº’çš„æ‰€æœ‰å¯¹è±¡ï¼Œéƒ½ä¿å­˜åœ¨ä¸€ä¸ªä¸–ç•Œä¸­ã€‚è¿™ä¸ªä¸–ç•Œæˆ‘ä»¬ç§°ä¹‹ä¸º å…³å¡åœ°å›¾ï¼ˆLevelï¼‰ã€‚åœ¨è™šå¹»å¼•æ“ 4 ä¸­å…³å¡åŒ…å«é™æ€ç½‘æ ¼ä½“ï¼ˆStatic Meshï¼‰ã€ä½“ç§¯ï¼ˆVolumeï¼‰ã€å…‰æºï¼ˆLightï¼‰ã€è“å›¾ï¼ˆBlueprintï¼‰ç­‰å†…å®¹ã€‚

æ¯ä¸ªå…³å¡éƒ½æœ‰ä¸€ä¸ªé»˜è®¤çš„å…³å¡è“å›¾ Level Blueprintã€‚å®ƒå¾ˆç‰¹åˆ«ï¼Œä¸ä¸€èˆ¬çš„è“å›¾ä¸åŒï¼Œå®ƒæ˜¯ç®¡ç†æ•´ä¸ªåœ°å›¾çš„å…¨å±€äº‹ä»¶ï¼Œå¹¶ä¸” UE 4 ä¸å…è®¸è‡ªå·±åˆ›å»ºå…³å¡è“å›¾ã€‚

ä½¿ç”¨ File -> New Level èœå•ï¼Œå¼•æ“ä¼šæ‰“å¼€ä¸€ä¸ªæ–°å…³å¡å‘å¯¼çª—å£ï¼Œå…¶ä¸­åŒ…å«å¯ç”¨ä½œå…³å¡èµ·ç‚¹çš„å„ç§æ¨¡æ¿ï¼š

- Default åˆ›å»ºä¸€ä¸ªåŒ…å«æœ€åŸºæœ¬è®¾ç½®çš„å…³å¡ï¼ŒåŒ…æ‹¬ä¸€ä¸ªç©å®¶å‡ºç”Ÿç‚¹ã€ä¸€ä¸ªå¤©ç©ºç›’ï¼Œä»¥åŠå…³å¡æ­£å¸¸è¿è¡Œæ‰€éœ€çš„å…¶ä»– Actorã€‚
- TimeofDay æ–°å»ºä¸€ä¸ªèƒ½å¤Ÿè®©ä½ å®æ—¶è§‚å¯Ÿå¤§æ°”æ˜¼å¤œå˜åŒ–çš„å…³å¡ã€‚
- VR-Basic åˆ›å»ºä¸€ä¸ªåŒ…å«å¯äº¤äº’ Actor çš„ VR å…³å¡ï¼Œæœ‰åŠ©äºä½ ç†Ÿæ‚‰ VR ç¼–è¾‘å™¨æ“ä½œã€‚
- Blank æ–°å»ºä¸€ä¸ªå®Œå…¨ç©ºç™½çš„å…³å¡ï¼Œç›¸å½“äºåœ¨ Content Browser ä¸­ç›´æ¥åˆ›å»º Level Mapã€‚

ä¸€ä¸ª TimeofDay åœºæ™¯åŒ…å«ï¼š

- DirectionalLight å¹³è¡Œå…‰æºï¼Œè®¾ç½®ï¼šAtmosphere and Cloud -> `Atmosphere Sun Light` ä»¥åŠ `Cast Cloud Shadows`ï¼Œè¿™æ ·æ‰èƒ½ä½¿ç”¨ Ctrl + L å¿«æ·é”®è°ƒæ•´ç…§å°„è§’ï¼›
- SkyLight å¤§æ°”æ¼«åå°„å…‰ï¼Œè®¾ç½®ï¼šLight -> `Real Time Capture`, `Lower Hemisphere Is Solid Color`ï¼›Atomosphere and Cloud -> `Cloud Ambient Occlusion`ï¼›Mobility -> `Movable Light`ï¼›
- SkyAtmosphere å¤§æ°”ç¯å¢ƒæ¨¡æ‹Ÿç»„ä»¶ï¼Œé…åˆä½¿ç”¨äº†å¼•æ“æä¾›çš„ `M_SkyTimeOfDay` æè´¨çš„ç©¹é¡¶å½¢æˆä¸–ç•Œç¯å¢ƒï¼›
- SkyDomeMesh ç©¹é¡¶é™æ€ç½‘æ ¼ï¼Œæ¨¡æ‹Ÿé«˜å±‚äº‘ï¼Œé»˜è®¤é…ç½®ï¼šZ è½´ç§»åŠ¨ -7300000ï¼› X æ—‹è½¬ 90Â°ï¼Œç»½æ”¾(1000000, 150000, 1000000)ï¼›
- VolumetricClound ä½“ç§¯äº‘ç»„ä»¶ï¼Œæ¨¡æ‹Ÿä½ç©ºäº‘å±‚ï¼›

é™¤äº†ä»¥ä¸‹æ¨¡æ‹Ÿæ•´ä¸ªå¤©ç©ºç¯å¢ƒçš„å…³é”®ç»„ä»¶ï¼Œè¿˜æœ‰ä»¥ä¸‹å‡ ä¸ªåœºæ™¯è£…é¥°ï¼š

- Floor é™æ€ç½‘æ ¼ä½“åœ°æ¿ï¼›
- SM_MatPreviewMess é™æ€ç½‘æ ¼ä½“å±•ç¤ºï¼Œä¸€ä¸ªå¸¦åŸºåº§çš„ UE Logo çƒä½“ï¼›
- TextRenderActor æ–‡å­—æ¸²æŸ“ç»„ä»¶ï¼Œç»™ä¸€äº›æç¤ºæ€§æ–‡å­—ï¼›
- PlayerStart ç©å®¶å‡ºåœºç‚¹ï¼Œæ¸¸æˆå¼€å§‹æ—¶ï¼Œé»˜è®¤ä»¥å‡ºåœºç‚¹ç”Ÿæˆç©å®¶è§’è‰²ï¼›

TimeofDay å…³å¡ä¸­ï¼Œå¯ç”¨ DirectionalLight çš„ `Atmosphere Sun Light` é€‰é¡¹åï¼Œå°±å¯ä»¥é€šè¿‡ Ctrl + L + é¼ æ ‡ç§»åŠ¨è°ƒæ•´ DirectionLight ç…§å°„ç»ç»´åº¦ï¼Œåˆ†åˆ«å¯¹åº”å·¦å³ã€ä¸Šä¸‹ç§»åŠ¨ã€‚

å¦‚æœéœ€è¦åœ¨è“å›¾ä¸­ä½¿ç”¨`SetActorRotation`æˆ–`AddActorWorldRotation`ç­‰æ–¹æ³•åŠ¨æ€è°ƒæ•´ï¼Œå®ç°æ—¶å…‰æµé€çš„æ•ˆæœï¼Œå°±éœ€è¦å°† DirectionalLight è®¾ç½®ä¸º Movable å…‰æºã€‚é€šè¿‡æ—‹è½¬ç›´å°„å…‰æºæ¥å®ç°å…‰ç…§è§’åº¦çš„è°ƒæ•´ï¼ŒXY è½´è°ƒç”¨é«˜åº¦è§’ï¼ŒZ è½´è°ƒç”¨æ–¹ä½è§’ã€‚å¦‚æœï¼Œéœ€è¦æ¨¡æ‹Ÿå¤ªé˜³çš„ç§»åŠ¨ï¼Œè¿˜éœ€è¦æ·»åŠ  *BP_Sky_Sphere* å¯¹è±¡ï¼Œè®¾ç½® Details -> Default -> Directional Light Actor å¼•ç”¨å½“å‰çš„ç›´å°„å…‰æºï¼Œå¹¶è°ƒç”¨ *UpdateSunDirection* æ–¹æ³•æ›´æ–°å¤ªé˜³ä½ç½®ã€‚

å…³å¡æ˜¯å¯ä»¥åµŒå¥—çš„ï¼Œæ¸¸æˆä¸­çš„æ¯ä¸ªå…³å¡å§‹ç»ˆæœ‰ä¸€ä¸ªå›ºå®šå…³å¡ Persistent Level ä¹Ÿå«æŒä¹…å…³å¡ï¼Œè¿˜å¯ä»¥æœ‰å¤šä¸ªå­å…³å¡ã€‚è€Œå­å…³å¡å¯ä»¥é€šè¿‡å…³å¡æµé€ä½“ç§¯ Level Streaming Volumeã€è“å›¾æˆ– C++ ä»£ç åŠ¨æ€åœ°åœ¨æ¸¸æˆè¿›è¡Œæ—¶åŠ è½½ã€‚å­å…³å¡ä¹Ÿæ˜¯ä¸€ä¸ªæ ‡å‡†çš„ Levelï¼Œå½“å®ƒä½œä¸ºå­çº§é™„åŠ åˆ°å…¶å®ƒå…³å¡æ—¶ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªå­å…³å¡ï¼Œå¹¶ä¸”ä¸ Persistent Level ä¸­çš„å†…å®¹ä¸€èµ·æ„é€ å‡ºå®Œæ•´çš„å…³å¡åœ°å›¾ã€‚é€šè¿‡å…³å¡ç®¡ç†çª—å£ï¼Œå¯ä»¥ç‚¹å‡»åˆ—è¡¨ä¸­å³ä¾§çš„çœ¼ç›æŒ‰é’®æ¥é€‰æ‹©éšè—æˆ–æ˜¾ç¤ºå„ä¸ªå­å…³ä¸Šçš„å†…å®¹ã€‚

ä½¿ç”¨å…³å¡ç®¡ç†çª—å£ Window -> Levels å¯ä»¥å¯¹å½“å‰çš„å…³å¡è¿›å…¥å­å…³å¡è¿›è¡Œç®¡ç†ï¼Œæ“ä½œåŠŸèƒ½å¦‚ä¸‹ï¼š

- åˆ›å»ºå¹¶æ·»åŠ æ–°çš„å­å…³å¡ï¼Œåªéœ€è¦æ‰§è¡Œèœå• Levels -> Create Newï¼›
- æ·»åŠ å·²æœ‰å…³å¡ï¼Œåªéœ€è¦æ‰§è¡Œèœå• Levels -> Add Existingï¼›
- å°†å…³å¡çš„å¯¹è±¡æ‹†åˆ†åˆ°å­å…³å¡ï¼›
- åœ¨å…³å¡é—´è¿ç§» Actorï¼›

æ‹†åˆ†å…³å¡æ“ä½œï¼Œå…ˆåœ¨ Scene Outliner æˆ– Viewport ä¸­é€‰ä¸­ Actorsï¼Œå†æ‰§è¡Œ Levels -> Create New with Selected Actorsã€‚æ‰€æœ‰é€‰ä¸­çš„ Actor éƒ½ä¼šåœ¨åŸæœ‰å…³å¡ä¸­è¢«ç§»é™¤ï¼Œå¹¶è¢«æ·»åŠ åˆ°æ–°å…³ä¸­ã€‚æ–°å…³å¡å°†ä½œä¸ºå½“å‰æŒä¹…å…³å¡çš„ä¸€ä¸ªå­å…³å¡ï¼Œå¹¶è¢«è®¾ç½®ä¸ºå½“å‰å…³å¡ï¼Œä¾›ä½ åœ¨è§†å£ä¸­å¤„ç†ã€‚

ä½¿ç”¨ Levels çª—å£ï¼Œåœ¨å¤šä¸ªå…³å¡ä¸­å¤åˆ¶æˆ–ç§»åŠ¨ Actor å¾ˆæ–¹ä¾¿ï¼Œå…ˆåœ¨ Scene Outliner æˆ– Viewport ä¸­é€‰ä¸­è¦ç§»åŠ¨çš„ Actorã€‚ç„¶ååœ¨ Levels  çª—å£ä¸­ï¼Œæ‰§è¡Œå­å…³å¡å³é”®èœå• Move Selected Actors to Level å³å¯ã€‚

æ“ä½œå…³å¡åï¼Œè¯¥å…³å¡ä¼šè‡ªåŠ¨æˆä¸ºå½“å‰æ´»åŠ¨å…³å¡ï¼Œåœ¨ä½¿ç”¨ Levels èœå•æ—¶æ³¨æ„é€šè¿‡å³é”®è®¾ç½®å½“å‰æ´»åŠ¨å…³å¡ Levels -> Make Currentã€‚

åœ¨ Levels å…³å¡çª—å£ä¸­ï¼Œç‚¹å‡»å·¥å…·æ ä¸­çš„ Summons Level Details æŒ‰é’®æ‰“å¼€å…³å¡ç»†èŠ‚è®¾ç½®çª—å£ï¼Œå®ƒå…è®¸ä½ è®¿é—®å½“å‰å…³å¡çš„æ›´å¤šè®¾ç½®ã€‚ä¸»è¦æ˜¯ Level Streaming Volumes å…³å¡æµé€ä½“ç§¯åŠŸèƒ½è®¾ç½®ã€‚

å¯ä»¥è®¾ç½®å­å…³å¡çš„ Position å’Œ Rotationï¼Œç‚¹å‡» Viewport Edit å¯ä»¥ç›´æ¥åœ¨ä¸»ç•Œé¢çš„è§†å£ä¸­ç¼–è¾‘ã€‚

å¯ä»¥è®¾ç½®è°ƒè¯•ç”¨çš„ Level Colorï¼Œåœ¨ Levels çª—å£ä¸­ä¹Ÿå¯ä»¥è®¾ç½®ã€‚ä½¿ç”¨ Level Color åªéœ€è¦åˆ‡æ¢å…³å¡é¢œè‰²æ˜¾ç¤ºï¼Œè¯·ç‚¹å‡»è§†å£çª—å£èœå• Show -> Advanced -> Level Coloration å³å¯å¯Ÿçœ‹è°ƒè¯•æ•ˆæœã€‚

æŒä¹…å…³å¡æ²¡æœ‰é¢å¤–çš„ç»†èŠ‚ä¿¡æ¯ï¼Œé™¤äº†ä¸€ä¸ªç”¨äºåˆ‡æ¢åˆ°å…¶ä»–å…³å¡çš„èœå•ã€‚


æ¸¸æˆé€šå…³ï¼Œéœ€è¦åˆ‡æ¢åˆ°æ–°çš„å…³å¡ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨å…³å¡è“å›¾çš„ OpenLevel èŠ‚ç‚¹åŠ è½½æ–°çš„å…³å¡ã€‚

æ“ä½œæ­¥éª¤ï¼š

- åˆ›å»ºä¸€ä¸ª Level Mapï¼Œæ‰“å¼€å…³å¡è“å›¾ï¼Œæ–¹æ³•ï¼šTools -> Blueprints -> Open Level Blueprintï¼›
- åˆ›å»ºç›’ä½“è§¦å‘å™¨ï¼ŒPlace Actors -> Box Triggerï¼Œæ‹–æ”¾åˆ°åœ°å›¾éœ€è¦è§¦å‘äº‹ä»¶çš„ä½ç½®ï¼Œè°ƒæ•´ç›’ä½“å¤§å°ä»¥ä¾¿äºè§¦å‘ï¼›
- ç¼–è¾‘å…³å¡è“å›¾

åœ¨å…³å¡ä¸­é€‰ä¸­æ­¥éª¤2åˆ›å»ºçš„è§¦å‘å™¨ï¼Œç„¶ååœ¨å…³å¡è“å›¾ä¸­å³é”®é€‰æ‹©è§¦å‘å™¨äº‹ä»¶
è§¦å‘å™¨äº‹ä»¶
è§¦å‘å™¨äº‹ä»¶çš„è¾“å‡ºå¼•è„šè§¦å‘OpenLevelå‡½æ•°ï¼Œæœ€ç»ˆçš„å…³å¡è“å›¾å¦‚ä¸‹
å…³å¡è“å›¾
è¿è¡Œæ¸¸æˆï¼Œæ§åˆ¶è§’è‰²èµ°åˆ°ç¢°æ’å™¨ä½ç½®
è¿è¡Œæ¸¸æˆ
è§¦å‘å¹¶åˆ‡æ¢åˆ°æ–°çš„å…³å¡


## âš¡ Level Streaming
- Level Streaming å…³å¡æµé€ https://docs.unrealengine.com/4.27/zh-CN/BuildingWorlds/LevelStreaming/
- Level Streaming - Content Examples https://docs.unrealengine.com/4.27/en-US/Resources/ContentExamples/NavMesh/
- Volumes ä½“ç§¯å¯¹è±¡å‚è€ƒ https://docs.unrealengine.com/4.27/zh-CN/Basics/Actors/Volumes/  

æ‰€è°“å…³å¡æµé€ Level Streamingï¼Œå³æ˜¯ä¸€ç§å¤§å‹åœ°å›¾çš„æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯ã€‚å®ƒå¯ä»¥åœ¨æ¸¸æˆè¿‡ç¨‹ä¸­å°†åœ°å›¾æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­å¹¶åˆ‡æ¢åœ°å›¾ï¼Œæˆ–è€…ä»å†…å­˜ä¸­å¸è½½ã€‚ è¿™æ ·ä¸€æ¥ï¼Œåœºæ™¯ä¾¿èƒ½æ‹†åˆ†ä¸ºè¾ƒå°çš„åœ°å›¾å—ï¼Œå¹¶ä¸”åªæœ‰ç›¸å…³éƒ¨åˆ†æ‰ä¼šå ç”¨èµ„æºå¹¶è¢«æ¸²æŸ“ã€‚å…³å¡åˆ†å¸ƒåœ¨å¹³é¢ç½‘æ ¼ä¸­ï¼Œå¹¶åœ¨ç©å®¶é è¿‘æ—¶æµå…¥ã€‚æ­£ç¡®è®¾ç½®åï¼Œå¼€å‘è€…ä¾¿èƒ½åˆ›å»ºå¤§å‹ã€æ— ç¼è¡”æ¥çš„æ¸¸æˆåœºæ™¯ï¼Œè®©ç©å®¶ä»¿ä½›ç½®èº«äºå¤§ä¸–ç•Œä¹‹ä¸­ã€‚

ä¸–ç•Œåœºæ™¯æ„æˆ World Composition ç”¨äºåˆ›å»ºå¤§å‹åœºæ™¯çš„ç‰¹å®šå…³å¡æµé€å½¢å¼ã€‚å…¶ç›®çš„ä¹‹ä¸€æ˜¯é¿å…ä½¿ç”¨ æŒä¹…å…³å¡æ¥å­˜å‚¨æµé€ä¿¡æ¯ï¼Œå› ä¸ºè¿™ä¼šç»™å›¢é˜Ÿä¸­çš„å…³å¡è®¾è®¡å¸ˆåŒæ—¶å¤„ç†å…³å¡é€ æˆç“¶é¢ˆã€‚æŒä¹…å…³å¡ä¸å­˜å‚¨ä»»ä½•æµé€ä¿¡æ¯ï¼Œè€Œæ˜¯æ‰«ææ–‡ä»¶å¤¹ å¹¶å°†æ‰¾åˆ°çš„æ‰€æœ‰å…³å¡è§†ä¸ºæµé€å…³å¡ã€‚æ¯ä¸ªæµé€å…³å¡çš„ä¿¡æ¯å­˜å‚¨åœ¨åŒ…å¤´ä¸­ï¼Œæ‰€ä»¥ä¸ç”¨æŠŠå…³å¡åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œä¸–ç•Œåœºæ™¯æ„æˆå°±èƒ½è¯»å–è¿™äº›ä¿¡æ¯ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œé™¤ Persistent Level ä¹‹å¤–çš„æ‰€æœ‰å…³å¡å†…å®¹éƒ½ä¼šåœ¨ä¸–ç•Œåœºæ™¯æ„æˆä¸­å¸è½½ï¼Œä½†å¯ä»¥éšæ—¶æ‰‹åŠ¨åŠ è½½æˆ–å¸è½½ä¸–ç•Œåœºæ™¯çš„ä»»ä½•éƒ¨åˆ†ã€‚

World Composition ä¾èµ–äºä¸–ç•Œåœºæ™¯åŸç‚¹ç§»ä½åŠŸèƒ½ï¼Œåœ¨åŸºäºè·ç¦»çš„å…³å¡æµé€ä¸­ä½¿ç”¨æ—¶ï¼Œå¯ä»¥åˆ›å»ºå‡ºçš„ä¸–ç•Œåœºæ™¯ä¸å±€é™äºå¼•æ“ä¸­ç¡¬ç¼–ç çš„ `WORLD_MAX`å¸¸é‡å€¼ã€‚

æ¿€æ´» World Composition ç®¡ç†çš„ä¸–ç•Œåœºæ™¯ï¼Œæ“ä½œè·¯å¾„ï¼šTools -> World Settings -> World -> Enable World Compositionã€‚

å½“ç§»åŠ¨ä¸–ç•Œåœºæ™¯åŸç‚¹æ—¶ï¼Œä¼šå‘ä¸–ç•Œåœºæ™¯ä¸­æ³¨å†Œçš„æ‰€æœ‰ Actor æ·»åŠ åç§»çŸ¢é‡ã€‚Actor ä¸€ä¸ª ApplyWorldOffset å‡½æ•°ï¼Œå¯åœ¨å­ç±»ä¸­è¦†ç›–è¯¥å‡½æ•°ä»¥æ‰§è¡Œå…¶ä»–æ“ä½œã€‚å¦‚æœåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ AActor æ´¾ç”Ÿç±»å¹¶å°†ç»å¯¹ä½ç½®å€¼å­˜å‚¨åœ¨å…¶ä¸­ï¼Œåˆ™å¿…é¡»è¦†ç›– ApplyWorldOffset å‡½æ•°ï¼Œä»¥ä½¿å…¶é€‚ç”¨äºä¸–ç•Œåœºæ™¯åŸç‚¹æ›´æ”¹å¹¶å°†ç»å¯¹å€¼ç§»è‡³å…¶ä¸­ã€‚æ¸²æŸ“å’Œç‰©ç† Primitives ä¼šä¸æ¸¸æˆçº¿ç¨‹ä¸­çš„ Actor å¹¶è¡Œç§»ä½ã€‚

ç›®å‰ï¼Œå¤šäººæ¸¸æˆä¸æ”¯æŒä¸–ç•Œåœºæ™¯åŸç‚¹ç§»ä½ï¼Œç¦ç”¨ä¸–ç•Œåœºæ™¯åŸç‚¹ç§»ä½åŠŸèƒ½ï¼Œæ“ä½œè·¯å¾„ï¼šTools -> World Settings -> World (Advanced) -> Enable World Origin Rebasingã€‚

åœ¨ Levels å…³å¡çª—å£ä¸­ï¼Œç‚¹å‡»å·¥å…·æ ä¸­çš„ Summons Level Details æŒ‰é’®æ‰“å¼€å…³å¡ç»†èŠ‚è®¾ç½®çª—å£ï¼Œå®ƒå…è®¸ä½ è®¿é—®å½“å‰å…³å¡çš„ Level Streaming Volumes å…³å¡æµé€ä½“ç§¯åŠŸèƒ½è®¾ç½®ã€‚

å¦‚æœå…³å¡çš„æµé€ç±»å‹è¢«è®¾ä¸º Always Loadedï¼Œå®ƒå°†ä¸å›ºå®šå…³å¡ä¸€åŒåŠ è½½ï¼Œä¹Ÿå°†å’Œå›ºå®šå…³å¡åŒæ—¶å˜ä¸ºå¯è§çŠ¶æ€ã€‚å®ƒå°†æ— è§†æŒ‡å®šçš„æµé€ä½“ç§¯åŸŸï¼Œä»¥åŠæ¥è‡ªè“å›¾æˆ– C++ çš„æ‰€æœ‰åŠ è½½/å¸è½½è¯·æ±‚ã€‚

é€šè¿‡ Levels å³é”®èœå•è®¾ç½®æµé€ç±»å‹ï¼ŒChange Streaming Method: `Always Loaded` æˆ– `Blueprint`ã€‚

æµé€ç±»å‹è®¾ç½®ä¸º Blueprint æ˜¯åŠ¨æ€æµé€æ–¹æ³•ï¼Œæµé€å…³å¡å®é™…ä¸Šä¼šå—åˆ°å…³å¡æµé€ä½“ç§¯åŸŸã€è“å›¾æˆ– C++ ä»£ç çš„æ§åˆ¶ï¼Œè¿™äº›å…³å¡å¯è¢«åŠ¨æ€åŠ è½½æˆ–å¸è½½ã€‚

åŠ¨æ€æµé€å°±æ˜¯åŠ¨æ€åœ°åœ¨æ¸¸æˆè¿›è¡Œæ—¶åŠ è½½ï¼Œå¯é€‰æ–¹æ³•å¦‚ä¸‹ï¼š

- å…³å¡æµé€ä½“ç§¯ Level Streaming Volumeï¼›
- é€šè¿‡è“å›¾èŠ‚ç‚¹é…ç½®å…³ä¸ŠåŠ¨æ€æµé€ï¼›
- é€šè¿‡ç¼–å†™ C++ ä»£ç åŠ¨åŠ¨æ€æµé€ã€‚

UE 4 æœ‰å„ç§ç”¨é€”çš„ Volumes ä½“ç§¯å¯¹è±¡ï¼Œåœ¨ä»¥ä¸‹è¯´æ˜çš„å®˜æ–¹ç¤ºèŒƒä¸­å°±ä½¿ç”¨äº†å››ç§ä½“ç§¯å¯¹è±¡ï¼š

- Level Streaming Volume å…³å¡æµé€ä½“ç§¯ï¼Œè§¦å‘å…³å¡æµé€è¡Œä¸ºï¼›
- Precomputed Visibility Volume é¢„è®¡ç®—å¯è§†æ€§ä½“ç§¯ï¼Œç”¨äºæ€§èƒ½ä¼˜åŒ–ï¼Œæ ¹æ®å¯¹è±¡åœ¨åœºæ™¯ä¸­ä½ç½®çš„å¯è§†æ€§ï¼Œé€šè¿‡ç¦»çº¿å‰”é™¤æ–¹æ³•æ¥åŠ¨æ€å‰”é™¤å…³å¡ä¸­çš„å¯¹è±¡ã€‚
- Lightmass Importance Volume é‡è¦ä½“ç§¯å¯ä»¥ä¸ºåŒºåŸŸå†…å¯¹è±¡æä¾›æ›´ç²¾ç»†çš„å…¨å±€å…‰ç…§æ•ˆæœã€‚
- Post Process Volum åæœŸå¤„ç†ä½“ç§¯ï¼Œç»™æ‘„åƒæœºç”»é¢æ·»åŠ åæœŸå¤„ç†è®¾ç½®ã€‚

å®˜æ–¹ Content Examples æä¾›çš„ Level Streaming å…³å¡æµé€ç¤ºèŒƒåŠŸèƒ½åˆ†è§£ï¼š

- `Level_Streaming` æ˜¯ä¸»å…³å¡ï¼Œå®ƒå°†åŒ…å« StreamingLevels å­ç›®å½•ä¸‹çš„æ‰€ä»¥å…³å¡ä½œä¸º SubLevelã€‚
- `StreamingLevel_SKY` å’Œä¸»å…³å¡ä¸€æ ·ä½œä¸ºå›ºå®šå…³å¡ä½¿ç”¨ Persistent Levelï¼Œä¸»è¦æä¾›ä¸€ä¸ª SM_SkySphere ç”¨äºæ¨¡æ‹Ÿå¤©ç©ºï¼Œè¿˜æœ‰é€šè¿‡ Text Material æè´¨æä¾›æç¤ºæ€§æ–‡å­—ã€‚å¯ä»¥é€šè¿‡å³é”®èœå•ä¿®æ”¹æµé€æ–¹å¼ Change Streaming Method: `Always Loaded`ï¼›
- `StreamingLevel1` æµé€å…³å¡ï¼Œæ ‡è®°ä¸ºæ·±çº¢è‰²ï¼Œå› ä¸ºåœ¨å®ƒ Level Details å…³è”çš„æµé€åŒºåŸŸå¯¹è±¡ `LevelStreamingVolume1` è®¾ç½®äº† Streaming Usage: SVB Loading & Visibilityï¼Œè¿›å…¥æ¸¸æˆæ—¶ï¼Œåªè¦æ‘„åƒæœºè¿›å…¥è¿™ä¸ªåŒºåŸŸå°±ä¼šåŠ è½½å®ƒï¼›
- `StreamingLevel2` æµé€å…³å¡ï¼Œæ ‡è®°ä¸ºè“è‰²ï¼Œå› ä¸ºåœ¨å®ƒ Level Details å…³è”äº†ä¸‰ä¸ªæµé€åŒºåŸŸå¯¹è±¡ï¼š
    - `LevelStreamingVolume6` è®¾ç½®äº† Streaming Usage: SVB Loading & Not Visibilityï¼Œåˆ°è¾¾æ­¤åŒºåŸŸæ—¶åŠ è½½ä½†ä¸æ˜¾ç¤ºï¼›
    - `LevelStreamingVolume7` è®¾ç½®äº† Streaming Usage: SVB Loading & Visibilityï¼Œåˆ°è¾¾æ­¤åŒºåŸŸæ—¶åŠ è½½å¹¶ä¸”æ˜¾ç¤ºï¼›
    - `LevelStreamingVolume8` è®¾ç½®äº† Streaming Usage: SVB Visibility Blocking on Loadï¼Œåˆ°è¾¾æ­¤åŒºåŸŸæ—¶æ˜¾ç¤ºï¼›
    - `LevelStreamingVolume9` è®¾ç½®äº† Streaming Usage: SVB Visibility Blocking on Loadï¼Œåˆ°è¾¾æ­¤åŒºåŸŸæ—¶æ˜¾ç¤ºï¼›
- `StreamingLevel3` æµé€å…³å¡ï¼Œæ ‡è®°ä¸ºç»¿è‰²ï¼Œå› ä¸ºåœ¨å®ƒé€šè¿‡è“å›¾è„šæœ¬åŠ è½½ã€‚`TriggerBox1` å’Œ `TriggerBox5` éƒ½è®¾ç½®åœ¨ä¸»å…³å¡ï¼Œå¹¶ä¸”è®¾ç½®äº† Overlap äº‹ä»¶æ‰§è¡Œ LoadStreamLevel æ¥åŠ è½½ï¼Œä½¿ç”¨åœºæ™¯ä¸­ TriggerBox å¯¹è±¡çš„å³é”®èœå•å¯ä»¥å¿«é€Ÿè·³åˆ°è“å›¾çš„äº‹ä»¶èŠ‚ç‚¹ã€‚ä½†æ˜¯ï¼Œåœ¨ Level 4 å¾€å‰ä½ç½®è®¾ç½®çš„ `TriggerBox3` è§¦å‘ Overlap äº‹ä»¶é€šè¿‡ `UnloadStreamLevel` æ‰§è¡Œå¸è½½ã€‚
- `StreamingLevel4` æµé€å…³å¡ï¼Œæ ‡è®°ä¸ºç»¿è‰²ï¼Œå› ä¸ºåœ¨å®ƒé€šè¿‡è“å›¾è„šæœ¬åŠ è½½ã€‚Level 3 ä¸­çš„ `TriggerBox2` è®¾ç½®äº† Overlap äº‹ä»¶ä½¿ç”¨ LoadStreamLevel æ¥åŠ è½½å®ƒï¼Œå¹¶ä¸”è§¦å‘ Level 3 çš„è‡ªåŠ¨é—¨æ‰“å¼€ã€‚ä½¿ç”¨åœºæ™¯ä¸­ TriggerBox å¯¹è±¡çš„å³é”®èœå•å¯ä»¥å¿«é€Ÿè·³åˆ°è“å›¾çš„äº‹ä»¶èŠ‚ç‚¹ã€‚
- `StreamingLevel5` æµé€å…³å¡ï¼Œæ ‡è®°ä¸ºç»¿è‰²ï¼Œå› ä¸ºåœ¨å®ƒé€šè¿‡è“å›¾è„šæœ¬åŠ è½½ã€‚ä½¿ç”¨ Level 4 ä¸­çš„ `TriggerBox4` è§¦å‘è‡ªåŠ¨æ‰“å¼€æ—¶åŠ è½½ï¼Œå¹¶ä¸”åœ¨ CloseDoor äº‹ä»¶ä¸­æ‰§è¡Œ `UnloadStreamLevel` æ‰§è¡Œå¸è½½ã€‚
    - `LevelStreamingVolume10` è®¾ç½®äº† Streaming Usage: SVB Loadingï¼Œåˆ°è¾¾æ­¤åŒºåŸŸæ—¶é¢„åŠ è½½ï¼›
    - `LevelStreamingVolume11` è®¾ç½®äº† Streaming Usage: SVB Loading & Visibilityï¼Œåˆ°è¾¾æ­¤åŒºåŸŸæ—¶æ˜¾ç¤ºï¼›

Content Example å·¥ç¨‹è®¾ç½®çš„ BP_Double_Doors è“å›¾å¯¹è±¡æ˜¯ä¸€ä¸ªå¸¦æœ‰å¼€å…³åŠ¨ç”»æ•ˆæœçš„è‡ªåŠ¨é—¨ï¼ŒåŸºäº Timeline å®ç°åŠ¨ç”»ã€‚


## âš¡ World Partition
- ä¸–ç•Œåˆ†åŒºç³»ç»Ÿ World Partition https://docs.unrealengine.com/5.0/zh-CN/WorldFeatures/WorldPartition/

ä¸–ç•Œåˆ†åŒºï¼ˆWorld Partitionï¼‰æ˜¯ UE5EA ç”¨äºå¤„ç†å¤§å‹æµé€ä¸–ç•Œçš„ç³»ç»Ÿï¼Œç”¨äºæ›¿ä»£ World Compositionï¼Œæ—§åŠŸèƒ½å°†åœ¨æœªæ¥ç‰ˆæœ¬ä¸­ç§»é™¤ã€‚è¿™æ˜¯ä¸€ç§å…¨æ–°çš„æ•°æ®ç®¡ç†å’Œæµé€ç³»ç»Ÿï¼Œå¯ä»¥åœ¨ç¼–è¾‘å™¨ä¸­ä»¥åŠåœ¨è¿è¡Œæ—¶ä½¿ç”¨ã€‚ä½ å†ä¹Ÿä¸ç”¨å°†ä¸–ç•Œåˆ’åˆ†æˆæ— æ•°çš„å­å…³å¡æ¥ç®¡ç†æµé€ï¼Œä»è€Œå‡å°‘äº†ç¼–è¾‘å™¨ä¸­çš„æ•°æ®äº‰ç”¨ï¼ˆdata contentionï¼‰ã€‚

ä¸–ç•Œåˆ†åŒºç³»ç»Ÿçš„å·¥ä½œåŸç†æ˜¯å°†ä½ çš„åœºæ™¯ä¿å­˜åœ¨ä¸€æŒä¹…å…³å¡æ–‡ä»¶ä¸­ï¼Œå¹¶ä½¿ç”¨å¯é…ç½®çš„è¿è¡Œæ—¶ç½‘æ ¼å°†ç©ºé—´åˆ’åˆ†ä¸ºå¯æµé€çš„ç½‘æ ¼å•å…ƒã€‚

è¿™äº›å•å…ƒåœ¨è¿è¡Œæ—¶é€šè¿‡æµé€æºçš„å­˜åœ¨ï¼ˆå¦‚ç©å®¶ï¼‰æ¥åŠ è½½å’Œå¸è½½ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¼•æ“åªåŠ è½½ç©å®¶åœ¨ç‰¹å®šæ—¶é—´çœ‹åˆ°å¹¶ä¸ä¹‹äº’åŠ¨çš„å…³å¡éƒ¨åˆ†ã€‚

ä½¿ç”¨ä¸–ç•Œåˆ†åŒºåŠŸèƒ½åï¼Œä¸–ç•Œåœºæ™¯ä¼šä»¥å•ä¸ªæŒä¹…å…³å¡ï¼ˆpersistent levelï¼‰çš„å½¢å¼å­˜åœ¨ã€‚åœ¨ç¼–è¾‘å™¨ä¸­ï¼Œä¸–ç•Œåœºæ™¯ä»¥ç¼–è¾‘å™¨ç½‘æ ¼ä¸ºå‚ç…§è¿›è¡Œåˆ’åˆ†ï¼Œè€Œæ•°æ®ä¼šæ ¹æ®ä½ çš„éœ€æ±‚è¿›è¡Œå±€éƒ¨åŠ è½½ã€‚è¿™æ ·ä¸€æ¥ï¼Œä½ å°±èƒ½åŠ è½½é‚£äº›æœ¬éœ€è¦èŠ±å¾ˆé•¿åŠ è½½æ—¶é—´çš„å¤§å‹ä¸–ç•Œã€‚åœ¨çƒ˜ç„™åœºæ™¯æˆ–å¯åŠ¨ PIE åï¼Œåœºæ™¯ä¼šè¢«åˆ’åˆ†æˆå¤šä¸ªå•å…ƒï¼Œè€Œè¿™äº›å•å…ƒä¼šä½œä¸ºå…³å¡å•ç‹¬æµé€ã€‚

ä¸–ç•Œåˆ†åŒºç³»ç»Ÿï¼ˆWorld Partitionï¼‰æ˜¯ä¸€ç§å…¨æ–°çš„æ•°æ®ç®¡ç†ç³»ç»Ÿï¼Œå®ƒåŸºäºè·ç¦»è¿›è¡Œå…³å¡æµï¼Œèƒ½å¤Ÿä¸ºå¤§å‹å¼€æ”¾åœºæ™¯æä¾›ä¸€ä¸ªå®Œæ•´çš„ç®¡ç†æ–¹æ¡ˆã€‚è¯¥ç³»ç»Ÿå°†ä½ çš„åœºæ™¯ä¿å­˜åœ¨ä¸€ä¸ªè¢«åˆ’åˆ†æˆå¤šä¸ªç½‘æ ¼å•å…ƒçš„å•ä¸€æŒä¹…å…³å¡ä¸­ï¼Œæ¶ˆé™¤äº†ä¹‹å‰ç‰ˆæœ¬ä¸­éœ€è¦å°†å¤§å…³å¡åˆ’åˆ†æˆå¤šä¸ªå­å…³å¡çš„éœ€è¦ã€‚åŒæ—¶ï¼Œç³»ç»Ÿè¿˜ä¸ºä½ æä¾›ä¸€ä¸ªè‡ªåŠ¨æµé€ç³»ç»Ÿï¼Œèƒ½æ ¹æ®ä¸æµé€æºçš„è·ç¦»åŠ è½½å’Œå¸è½½è¿™äº›ç½‘æ ¼å•å…ƒã€‚

ä¸ºæ•´ä¸ªé¡¹ç›®å¯ç”¨ä¸–ç•Œåˆ†åŒºç³»ç»Ÿï¼šé¡¹ç›®è®¾ç½® -> å¼•æ“ -> ä¸–ç•Œåˆ†åŒº -> å¯ç”¨ä¸–ç•Œåˆ†åŒº Enable World Partitionã€‚æˆ–è€…å¯ä»¥å°†ç°æœ‰çš„åœºæ™¯è½¬æ¢ä¸ºä¸–ç•Œåˆ†åŒºç³»ç»Ÿï¼Œå¼•æ“æä¾› WorldPartitionConvert å‘½ä»¤å·¥å…·æ¥å®Œæˆã€‚è®¾ç½® Auto Cell Loading Max World Size å¯ä»¥å°†å°äºè¿™ä¸€å¤§å°çš„ç½‘æ ¼è‡ªåŠ¨åŠ è½½ã€‚

ä¸–ç•Œåˆ†åŒºç³»ç»Ÿç”¨åˆ°äº†ä»¥ä¸‹è¿™äº›ç³»ç»Ÿï¼š

- One File Per Actor ä¸€æ–‡ä»¶ä¸€Actorï¼Œæå‡å›¢é˜Ÿåä½œçš„çµæ´»æ€§ï¼›
- Data Layers æ•°æ®å±‚ï¼Œç”¨æ¥æ›¿æ¢æ—§ç‰ˆæœ¬çš„ Layers ç³»ç»Ÿï¼›
- Level Instancing å…³å¡å®ä¾‹åŒ–ï¼›
- Hierarchical LOD åˆ†å±‚ç»†èŠ‚çº§åˆ«ï¼›

ä¸–ç•Œåˆ†åŒºç³»ç»Ÿåˆ©ç”¨ç½‘æ ¼å°†ä½ çš„åœºæ™¯åˆ†éš”æˆå¯åœ¨è¿è¡ŒæœŸé—´åŠ¨æ€åŠ è½½å’Œå¸è½½çš„å•å…ƒã€‚ä½†æœ‰æ—¶å€™ï¼Œä½ ä¼šå¸Œæœ›ä¸€äº›ç›¸éš”è¾ƒè¿œä¸”æ— æ³•äº’åŠ¨çš„Actorä»ç„¶å¯è§ï¼Œæ¯”å¦‚è¿œæ–¹çš„å±±è„‰ã€æ ‘æœ¨å’Œæ‚¬å´–ã€‚

- HLOD å…³é—­ï¼Œåªæœ‰è¢«åŠ è½½çš„å•å…ƒæ ¼ä¸­çš„å†…å®¹ä¼šæ˜¾ç¤ºã€‚
- HLOD å¼€å¯ï¼Œå¸è½½å•å…ƒæ ¼ä¸­çš„å†…å®¹ä¼šè¢«æ›¿æ¢ä¸º HLODã€‚

ä¸–ç•Œåˆ†åŒº - åˆ†å±‚ç»†èŠ‚çº§åˆ«ï¼ˆHLODï¼‰ ç³»ç»Ÿä½¿ç”¨è‡ªå®šä¹‰HLODå±‚ç»„ç»‡å¤§é‡é™æ€ç½‘æ ¼ä½“Actorï¼Œç”Ÿæˆå•ä¸ªä»£ç†æ¨¡å‹å’Œæè´¨ã€‚æ­¤æŠ€æœ¯ç”¨äºä½¿æœªåŠ è½½çš„ä¸–ç•Œåˆ†åŒºç½‘æ ¼å•å…ƒå¯è§†åŒ–ï¼Œä»¥å‡å°‘æ¯å¸§çš„ç»˜å›¾è°ƒç”¨æ¬¡æ•°ï¼Œæé«˜æ€§èƒ½ï¼Œå°¤å…¶æ˜¯åœ¨ä½¿ç”¨å¤§å‹å¼€æ”¾ä¸–ç•Œçš„æƒ…å†µä¸‹ã€‚ç›®å‰ï¼Œåœ°å½¢å’Œæ°´åŸŸç»„ä»¶ç­‰ä¸–ç•Œç»„ä»¶ç›®å‰ä¸æ”¯æŒ HLOD Actorã€‚

åœ¨ç¼–è¾‘ä¸–ç•Œåœºæ™¯æ—¶ï¼ŒActor å¯ä»¥è¢«æ·»åŠ åˆ°ä»»ä½•ä½ç½®ï¼Œå¹¶èƒ½æ ¹æ®ç»†èŠ‚é¢æ¿ä¸­çš„ç½‘æ ¼æ”¾ç½® Grid Placement è®¾ç½®è¢«è‡ªåŠ¨åˆ†é…åˆ°æŸä¸ªç½‘æ ¼å•å…ƒä¸­ï¼š

- Bounds å°† Actor æ”¾ç½®åœ¨æ‰€æœ‰ä¸å…¶è¾¹ç•Œä½“ç§¯ï¼ˆbounds volumeï¼‰ç›¸äº¤çš„ç½‘æ ¼å•å…ƒä¸­ã€‚
- Location å°† Actor æ”¾ç½®åœ¨åŒ…å« Actor è¾¹ç•Œä½“ç§¯ä¸­å¿ƒç‚¹çš„ç½‘æ ¼å•å…ƒä¸­ã€‚
- Always Loaded å§‹ç»ˆåŠ è½½ Actorã€‚

ç”±äºé‡‡ç”¨"ä¸€Actorä¸€æ–‡ä»¶"ç³»ç»Ÿçš„ Actor ä¼šè¢«ä¿å­˜åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥ä¸éœ€è¦ä»ç‰ˆæœ¬æ§åˆ¶è½¯ä»¶ä¸­æ£€å‡ºå…³å¡æ–‡ä»¶ä»¥ä¾¿å¯¹åœºæ™¯ä¸­çš„ Actor è¿›è¡Œä¿®æ”¹ã€‚è¿™å°±ä¸ºå›¢é˜Ÿä¸­å…¶ä»–äººä½¿ç”¨å…³å¡æ–‡ä»¶æä¾›äº†ä¾¿åˆ©ã€‚

åœ¨è¿è¡Œæ—¶ï¼Œç½‘æ ¼å†…çš„ç½‘æ ¼å•å…ƒæµé€ç”±ä¸¤ä¸ªå› ç´ å†³å®šï¼š

- ç¬¬ä¸€ä¸ªæ˜¯æµé€æºåœ¨å…³å¡ä¸­çš„ä½ç½®ï¼Œæµé€æºæ‰€åœ¨çš„é£æ ¼å•å…ƒå°±ä¼šè¢«æµé€ã€‚
- ç¬¬äºŒä¸ªå› ç´ æ˜¯è¿è¡Œæ—¶ç½‘æ ¼æœ¬èº«çš„è®¾ç½®ï¼Œå®ƒå†³å®šæµé€æºå½±å“çš„èŒƒå›´ã€‚

æµé€æº Streaming sources æ˜¯ä¸€ç§ç»„ä»¶ï¼Œå®ƒä¼šåœ¨ä¸–ç•Œåœºæ™¯ä¸­å®šä¹‰ä¸€ä¸ªä½ç½®ï¼Œå¹¶è§¦å‘è¯¥ä½ç½®å‘¨å›´çš„å•å…ƒè¿›è¡ŒåŠ è½½ã€‚ç©å®¶å§‹ç»ˆæ˜¯ä¸€ç§æµé€æºï¼Œæµé€æºå¯ä»¥é€šè¿‡æµé€æºç»„ä»¶æ·»åŠ åˆ°åœºæ™¯ä¸­ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥åœ¨ç©å®¶å³å°†æŠµè¾¾çš„ä½ç½®æ”¾ç½®ä¸€ä¸ªæµé€æºç»„ä»¶ï¼Œè¿™æ ·å°±èƒ½åœ¨ä¼ é€ä½ç½®é™„è¿‘åŠ è½½å•å…ƒæ ¼ã€‚ä¸€æ—¦å•å…ƒæ ¼åŠ è½½å®Œæˆï¼Œç©å®¶å°±ä¼šä¼ é€åˆ°è¯¥åœ°ç‚¹ï¼Œè€Œæµé€æºç»„ä»¶ä¼šè¢«åœç”¨ã€‚ç”±äºç©å®¶ä¹‹å‰çš„ä½ç½®æ²¡æœ‰äº†æµé€æºï¼Œç›¸å…³å•å…ƒæ ¼å°±ä¼šè¢«å¸è½½ã€‚

è¿è¡Œæ—¶ç½‘æ ¼ï¼ˆRuntime gridï¼‰è®¾ç½®ï¼Œæ“ä½œè·¯å¾„ï¼šWorld Settings -> World Partition Setupï¼Œå±æ€§å¦‚ä¸‹ï¼š

- Enable World Partition ä¸ºå½“å‰å…³å¡å¯ç”¨ä¸–ç•Œåˆ†åŒºï¼Œå‹¾é€‰å‰éœ€è¦ä¿å­˜å…³å¡ï¼Œå¹¶ä¸”ä¸èƒ½æœ‰å­å…³å¡ã€‚
- Grid Name è¿è¡Œæ—¶ç½‘æ ¼çš„åç§°ã€‚
- Cell Size ç¡®å®šç”¨äºç”Ÿæˆæµé€å…³å¡çš„å•å…ƒæ ¼çš„å¤§å°ï¼Œæ³¨æ„é»˜è®¤ Unreal Unit å•ä½æ˜¯ cmã€‚
- Loading Range ç¡®å®šæµé€æºå‘¨å›´å¤šå°‘èŒƒå›´å†…çš„å•å…ƒæ ¼è¢«åŠ è½½ã€‚
- Debug Color å¯ç”¨é¢„è§ˆç½‘æ ¼æ—¶ç½‘æ ¼çº¿æ¡†çš„æ˜¾ç¤ºé¢œè‰²ã€‚
- Preview Grids åœ¨è§†å£ä¸­æ˜¾ç¤ºç½‘æ ¼çº¿ã€‚

ä¸ºäº†æ”¯æŒå¤§å‹åœºæ™¯çš„å¼€å‘ï¼Œæ‰€æœ‰ç½‘æ ¼å•å…ƒä¸€å¼€å§‹éƒ½å¤„äºå¸è½½ã€‚å…³å¡è¢«æ‰“å¼€åï¼Œç¼–è¾‘å™¨åªä¼šåŠ è½½é‚£äº›æŠŠ Grid Placement è®¾ç½®ä¸º Always Loaded  çš„ Actorï¼Œä¾‹å¦‚åœºæ™¯èƒŒæ™¯å’Œç®¡ç†å™¨ã€‚è¿™æ ·èƒ½æ–¹ä¾¿é‚£äº›ä¸å¯èƒ½åœ¨ç¼–è¾‘å™¨ä¸­åŠ è½½æ•´å¼ åœ°å›¾çš„å¤§å‹åœºæ™¯ã€‚

ä½ å¯ä»¥ä½¿ç”¨ Windows -> World Partition ä¸–ç•Œåˆ†åŒºçª—å£æ¥æ‰‹åŠ¨é€‰æ‹©è¦ä½¿ç”¨çš„ç½‘æ ¼å•å…ƒã€‚åœ¨çª—å£ä¸­ï¼Œç‚¹å‡»å¹¶æ‹–åŠ¨ç½‘æ ¼å•å…ƒæ¥é€‰ä¸­å®ƒä»¬ã€‚ç„¶åç‚¹å‡»å³é”®ï¼Œæ‰“å¼€ä¸Šä¸‹æ–‡èœå•ï¼ŒåŠ è½½å’Œå¸è½½è¿™äº›å•å…ƒã€‚


## âš¡ Level Streaming Volume

å…³å¡æµé€ä½“ç§¯åŸŸåŸç†ååˆ†ç®€å•ï¼šæµé€å…³å¡çš„åŠ è½½/å¸è½½è¯·æ±‚åŸºäºè§†ç‚¹æ˜¯å¦å¤„äºå…³å¡ç›¸å…³çš„å…³å¡æµé€ä½“ç§¯åŸŸä¸­è€Œå‘å‡ºã€‚

å…·ä½“è€Œè¨€ï¼Œå…³å¡æµé€ä½“ç§¯åŸŸå¯ä»¥ä¸¤ç§æ–¹å¼ä½¿ç”¨ï¼š

- åœ¨æ¸¸æˆä¸­ï¼Œç©å®¶è§†ç‚¹å¤„äºä½“ç§¯åŸŸä¸­æ—¶ï¼Œå…³å¡æµé€ä½“ç§¯åŸŸå°†ä½¿å…³å¡åŠ è½½ï¼›ç©å®¶è§†ç‚¹å¤„äºä½“ç§¯åŸŸå¤–æ—¶ï¼Œå…³å¡å°†å¸è½½ã€‚
- ç¼–è¾‘å™¨ä¸­ï¼Œå…³å¡æµé€ä½“ç§¯åŸŸå¯åŸºäºé€è§†è§†å£æ‘„åƒæœºçš„ä½ç½®è‡ªåŠ¨éšè—/å–æ¶ˆéšè—å…³å¡ï¼Œç”¨äºé¢„è§ˆå…³å¡æµé€ã€‚

åŸºäºä½“ç§¯åŸŸçš„å…³å¡æµé€æ˜“äºä½¿ç”¨ï¼Œä¸è¦æ±‚è„šæœ¬ç¼–å†™ï¼Œæ˜¯æ§åˆ¶å…³å¡æµé€çš„ç†æƒ³æ–¹å¼ã€‚æ­¤å¤–ï¼Œä¸åŸºäºè„šæœ¬çš„æµé€ç›¸æ¯”æ›´æ˜“äºç»´æŠ¤ï¼šåŠ è½½ç³»ç»Ÿçš„éœ€æ±‚å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè°ƒæ•´ä½“ç§¯åŸŸçš„å¤§å°å³å¯å¯¹å…³å¡åŠ è½½/å¸è½½è¡Œä¸ºè¿›è¡Œä¿®æ”¹ã€‚

å…ˆç»™å›ºå®šå…³å¡æ·»åŠ ä¸€ä¸ª Level Streaming Volume ç»„ä»¶ï¼ŒPlace Actor -> Level Streaming Volumeï¼Œå¹¶è°ƒæ•´åˆé€‚çš„ä½ç½®å’Œå¤§å°ã€‚å¢åŠ ä½“ç§¯å¯ä»¥è®©ç©å®¶æ›´æ—©è¿›å…¥è€Œå¯¼è‡´å…³è”å…³å¡æ›´æ—©åŠ è½½ï¼Œæ›´æ™šå¸è½½ï¼Œè€Œå‡å°‘ä½“ç§¯åˆ™ä¼šå¯¼è‡´æ›´æ™šåŠ è½½ï¼Œ æ›´æ—©å¸è½½ã€‚

åŠ è½½æµé€å…³å¡åï¼Œåˆ°æµé€å…³å¡çš„å¸è½½è¯·æ±‚ä¹‹é—´çš„æœ€å°æ—¶é—´é€šè¿‡ Min Time Between Volume Unload Requests æ¥è°ƒæ•´ï¼Œé»˜è®¤å¸è½½æ»åé‡ä¸º 2.0 ç§’ã€‚

ç„¶åï¼Œè¿›è¡Œé€šè¿‡ Details -> Level Streaming Volume é¢æ¿è°ƒæ•´å±æ€§æ¥è®¾ç½®å¤„ç†å…³å¡æµé€çš„æ–¹å¼ï¼š

- Streaming Levels æ˜¾ç¤ºéœ€è¦è¢«æµé€çš„å…³å¡ï¼Œé€šè¿‡ Window -> Levels -> Summons Level Details é¢æ¿æ·»åŠ è¦æµé€çš„å…³å¡ï¼›
- Editor Pre Vis Only ä»…é™ç¼–è¾‘å™¨é¢„å¯è§†åŒ–ï¼Œç¡®å®šæµé€ä½“ç§¯æ˜¯å¦ä»…ç”¨äºç¼–è¾‘å™¨æµé€å…³å¡é¢„å¯è§†åŒ–ã€‚
- Disabled æ˜¯å¦ç¦ç”¨ï¼Œå¦‚æœä¸ºçœŸï¼Œåˆ™æŒ‰æµé€ä½“ç§¯ä»£ç å¿½ç•¥æµé€ä½“ç§¯ã€‚æ­¤å¤–ä¹Ÿç”¨äºç¦ç”¨å…³å¡æµé€ä½“ç§¯è€Œä¸å°†å…¶ä¸å…³å¡åˆ†ç¦»ï¼Œæˆ–è€…ç”¨äºåœ¨è“å›¾å’Œä½“ç§¯æµé€ä¹‹é—´åˆ‡æ¢å…³å¡æµé€çš„æ§åˆ¶ã€‚
- Streaming Usage ç¡®å®šä½“ç§¯çš„ç”¨é€”å¦‚ä¸‹ï¼š
    - SVB Loading æ§åˆ¶æµé€å…³å¡åŠ è½½ï¼›
    - SVB Loading & Visibility æ§åˆ¶æµé€å…³å¡åŠ è½½å’Œå¯è§†æ€§ï¼›
    - SVB Visibility Blocking on Load æ§åˆ¶æµé€å…³å¡å¯è§†æ€§ï¼Œä½†é˜»æ­¢åŠ è½½ï¼›
    - SVB Blocking on Load æ§åˆ¶æµé€å…³å¡å¯è§†æ€§ï¼Œä½†é˜»æ­¢åŠ è½½ï¼›
    - SVB Loading Not Visibility æ§åˆ¶æµé€å…³å¡åŠ è½½ä½†ä¸å¯è§†æ€§ï¼›

è“å›¾å’Œ C++ éƒ½å¯ä»¥é€šè¿‡ bDisabled å±æ€§æ¥åˆ‡æ¢ Level Streaming Volume çš„ç¦ç”¨çŠ¶æ€ã€‚

åŸºäºä½“ç§¯çš„å…³å¡æµé€çš„å·¥ä½œè¯´æ˜ï¼Œæ¯ä¸ª Streaming Level éƒ½å¯ä»¥å…³è”ä¸€ç»„ Level Streaming Volumeã€‚æ¯ä¸€å¸§ä¸­ï¼Œå¼•æ“æ–¹æ³• `UWorld::ProcessLevelStreamingVolumes` ä¼šåœ¨æ¯ä¸€å…³å¡ä¸Šè¿­ä»£ï¼Œ å¹¶æ£€æŸ¥ç©å®¶çš„è§†ç‚¹æ˜¯å¦ä½äºä¸è¯¥å…³å¡ç›¸å…³çš„ä»»ä½• Level Streaming Volumeå†…ã€‚å¦‚æœè¯¥è§†ç‚¹åœ¨è‡³å°‘ä¸€ä¸ª Level Streaming Volume å†…ï¼Œåˆ™å‘å‡ºè¯·æ±‚ä»¥å¼€å§‹åŠ è½½è¯¥å…³å¡ã€‚å¦‚æœè¯¥è§†ç‚¹åœ¨æ‰€æœ‰ Level Streaming Volume ä¹‹å¤–ï¼Œå…³å¡å°†æ ‡è®°ä¸ºå¸è½½ã€‚

é‡è¦ç»†èŠ‚ä¿¡æ¯ï¼š

- æ‰€æœ‰ Level Streaming Volume ç»„ä»¶éƒ½å¿…é¡»å­˜åœ¨äºå›ºå®šå…³å¡ä¸­ï¼Œå¹¶ä¸”ï¼Œå­˜åœ¨äºå…¶ä»–å…³å¡å†…çš„ Level Streaming Volume ä¸å¯ç”¨äºå…³å¡æµé€ï¼Œå¹¶å°†åœ¨ æ£€æŸ¥åœ°å›¾é”™è¯¯æ—¶ç”Ÿæˆè­¦å‘Šã€‚
- å¦‚æœä¸€ä¸ªå…³å¡å…·æœ‰ä»»ä½•ä¸ä¹‹å…³è”çš„æµé€ä½“ç§¯ï¼Œåˆ™è¯¥å…³å¡çš„å…¶ä»–æµé€æ–¹æ³•å°†æ— æ³•æ­£ç¡®å·¥ä½œã€‚
- ä¸€ä¸ª Level Streaming Volume ç»„ä»¶å¯ä»¥å½±å“å¤šä¸ªå…³å¡ï¼Œç±»ä¼¼åœ°ï¼Œä¸€ä¸ªå…³å¡å¯ä»¥å—å¤šä¸ª Level Streaming Volume å½±å“ã€‚
- åŸºäºä½“ç§¯çš„æµé€å¯ç”¨äºåˆ†å‰²å±å¹•ï¼Œåœ¨å‘å‡ºä»»ä½•åŠ è½½/å¸è½½è¯·æ±‚ä¹‹å‰ï¼Œæ‰€æœ‰æœ¬åœ°ç©å®¶çš„è§†ç‚¹éƒ½å°†äºˆä»¥è€ƒè™‘ã€‚
- Level Streaming Volume çš„é€»è¾‘æ˜¯è¿½è¸ªä½¿ç”¨ä¸­æ‘„åƒæœºçš„ä½ç½®ã€‚å› æ­¤ï¼Œå¦‚æœæ‘„åƒæœºç¦»ç©å®¶ Pawn æˆ–è§’è‰²è¾ƒè¿œï¼Œå°±éœ€è¦ç›¸åº”åœ°è°ƒæ•´å…³å¡æµé€ä½“ç§¯çš„å¤§å°å’Œæ”¾ç½®ã€‚

è®¾ç½®æ“ä½œæ­¥éª¤å‚è€ƒï¼š

- åœ¨ Place Actors é¢æ¿ä¸­ï¼Œå°†ä¸€ä¸ª Volumes - Level Streaming Volume æ‹–å…¥å…³å¡ã€‚
- è°ƒæ•´å…¶å¤§å°ï¼Œä½¿å…³å¡æµé€ä½“ç§¯åŒ…å«æ•´ä¸ªè§’è‰²å¯è¡Œèµ°çš„åŒºåŸŸï¼Œå¹¶ä¸”å¿…éœ€åŒ…å«æ‘„åƒæœºï¼Œäº‹å®æ˜¯åªéœ€è¦æ‘„åƒæœºå¯ä»¥è¿›å…¥è¿™ä¸ªåŒºåŸŸå³å¯ã€‚
- æ‰“å¼€å…³å¡ç»†èŠ‚è®¾ç½®é¢æ¿ï¼ŒWindows -> Levels -> Summons Level Detailsã€‚
- ç‚¹å‡» Streaming Volumes æ—è¾¹çš„åŠ å·ï¼ˆ+ï¼‰æ–°æ·»åŠ ä¸€ä¸ªä½“ç§¯ï¼Œç„¶åä½¿ç”¨ä¸‹æ‹‰èœå•æˆ–æ»´ç®¡é€‰æ‹©å‰é¢åˆ›å»ºçš„å…³å¡æµé€ä½“ç§¯å¯¹è±¡ã€‚
- ç¡®ä¿ Initially Loaded å’Œ Initially Visible å¤é€‰æ¡†æœªå‹¾é€‰ï¼Œä¿è¯å…¶å¤„äºæœªåŠ è½½åŠä¸å¯è§çŠ¶æ€ï¼Œç„¶åå…³é—­ Level Details é¢æ¿ã€‚
- è¿”å›è§†å£ï¼Œé€‰æ‹© Level Streaming Volume å¯¹è±¡ï¼Œå¹¶åœ¨ Details é¢æ¿ä¸­è®¾ç½®ä½“ç§¯çš„ä»¥ä¸‹å±æ€§ï¼šå–æ¶ˆå‹¾é€‰ Editor Pre Vis Only å’Œ Disabledï¼›Streaming Usage åº”è¢«è®¾ä¸º SVB Visibility Blocking on Loadã€‚
- ä½¿ç”¨ Play in Editor æµ‹è¯•æµé€å…³å¡ã€‚



## âš¡ Level Streaming & Blueprint

ä½¿ç”¨è“å›¾æµé€å…³å¡å°±åƒä½¿ç”¨ C++ ä¸€æ ·è°ƒç”¨ç›¸åº”çš„æ–¹æ³•æ¥å®ç°å…³å¡çš„æµé€ã€‚

éœ€è¦åšçš„å°±æ˜¯ç”¨ä¸€ä¸ªå¯¹è±¡æ¥æ¨¡æ‹Ÿ Level Streaming Volumeï¼Œå¹¶è®©æŒ‡å®šè§’è‰²å¯¹è±¡ä¸ä¹‹è§¦å‘ä¸€ä¸ªäº‹ä»¶ï¼Œé€šå¸¸æ˜¯ Overlap äº‹ä»¶ï¼Œç„¶ååœ¨è¿™ä¸ªäº‹ä»¶å†…è°ƒç”¨ Load/Unload Stream Level è¿™æ ·çš„èŠ‚ç‚¹æ¥åŠ è½½æˆ–å¸è½½æµé€å…³å¡ã€‚é€šè¿‡è“å›¾è®¾ç½®æ–¹å¼ï¼Œä¸å¿…åƒ Level Streaming Volume é‚£æ ·ä¸€å®šè¦æ‘„åƒæœºä¸ä¹‹äº¤å ã€‚

ä»¥ä¸‹æ“ä½œæ­¥éª¤ä½¿ç”¨ `LevelStreamer` æ¥å……å½“ Level Streaming Volumeï¼Œå½“è§’è‰²ä¸ä¹‹å‘ç”Ÿ Overlap äº‹ä»¶æ—¶åŠ è½½éœ€è¦æµé€çš„å…³å¡ï¼š

- æ‰“å¼€ Content Browserï¼Œæ–°å»ºä¸€ä¸ª Actor è“å›¾ç±»ï¼Œå‘½åä¸º `LevelStreamer` å¹¶ä¿å­˜ã€‚
- åœ¨è“å›¾ç¼–è¾‘å™¨æ‰“å¼€ `LevelStreamer`ï¼Œåœ¨é¢æ¿ä¸­ä¸ºå…¶æ·»åŠ ç¢°æ’æ£€æµ‹ç»„ä»¶ Components -> Add Component -> Box Collisionã€‚
- ä¿æŒ Components æ ‡ç­¾ä¸­çš„ Box ç»„ä»¶å¤„äºé€‰æ‹©çŠ¶æ€ã€‚
- æ‰“å¼€è“å›¾çš„ EventGraphï¼Œå³é”®å‘¼å‡ºå¿«æ·èœå•ï¼Œè¾“å…¥ Begin Overlapï¼Œç„¶åé€‰æ‹© Add On Component Begin Overlap æ·»åŠ äº‹ä»¶èŠ‚ç‚¹ã€‚
- ç‚¹å‡»å¹¶ä» Other Actor å¼•è„šè¿å‡ºå¼•çº¿ï¼Œç„¶ååœ¨å¿«æ·èœå•çš„æœç´¢ä¸­è¾“å…¥"="ï¼Œé€‰æ‹© Equal (Object) èŠ‚ç‚¹ï¼Œç”¨äºæ£€æŸ¥ä¸ä¹‹ç¢°æ’çš„æ˜¯å¦ä¸º `LevelStreamer`ã€‚
- ç‚¹å‡» == èŠ‚ç‚¹çš„ç¬¬äºŒä¸ª Object å¼•è„šå¹¶è¿å‡ºå¼•çº¿ï¼Œç„¶ååœ¨å¿«æ·èœå•çš„æœç´¢ä¸­è¾“å…¥"character"ã€‚é€‰æ‹© `Get Player Character` æ¡ç›®æ·»åŠ èŠ‚ç‚¹ã€‚
- æŒ‰ä½ B é”®å¹¶åœ¨å›¾è¡¨ä¸­ç‚¹å‡»æ·»åŠ ä¸€ä¸ª Branch èŠ‚ç‚¹ï¼Œç„¶åå°† == èŠ‚ç‚¹çš„å¸ƒå°”å¼•è„šè¿æ¥åˆ° Branch èŠ‚ç‚¹çš„è¾“å…¥ã€‚
- å°† OnComponentBeginOverlap èŠ‚ç‚¹çš„æ‰§è¡Œè¾“å‡ºå¼•è„šå’Œ Branch èŠ‚ç‚¹çš„æ‰§è¡Œè¾“å…¥å¼•è„šç›¸è¿ã€‚
- åœ¨å›¾è¡¨ä¸­ å•å‡»å³é”®ï¼Œç„¶åè¾“å…¥"level"åœ¨å¿«æ·èœå•ä¸­è¿›è¡Œæœç´¢ï¼Œä»èœå•ä¸­é€‰æ‹© `Load Stream Level`ã€‚
- ä½¿ç”¨å³é”®èœå•å°† Level Name å¼•è„šæå‡ä¸ºå˜é‡ï¼Œå°†å˜é‡å‘½åä¸º `LevelToStream`ï¼Œåœ¨ Details é¢æ¿ä¸­å‹¾é€‰ `Instance Editable`ï¼Œå¹¶ç¼–è¯‘ä¿å­˜ã€‚
- åœ¨ Load Stream Level èŠ‚ç‚¹ä¸Šå°† `Make Visible After Load` å’Œ `Should Block on Load` å‹¾é€‰ä¸º trueã€‚
- å°† Branch èŠ‚ç‚¹çš„ True æ‰§è¡Œè¾“å‡ºå¼•è„šå’Œ Load Stream Level èŠ‚ç‚¹çš„è¾“å‡ºæ‰§è¡Œå¼•è„šè¿æ¥èµ·æ¥ã€‚
- å°† `LevelStreamer` è“å›¾æ”¾å…¥å…³å¡ï¼Œè°ƒæ•´å…¶æ”¾ç½®å’Œå¤§å°ï¼Œä¸è¢«æµé€çš„å…³å¡å†…å®¹ä½ç½®å¤§æ¦‚åŒ¹é…å³å¯ã€‚
- å‡å®š SunTemple_Streaming ä¸ºè¢«æµé€çš„å…³å¡ï¼Œå°†å…¶è®¾ç½®ç»™ `LevelStreamer` çš„ `LevelToStream` å˜é‡ã€‚

æœ€åï¼Œä½¿ç”¨ Play In Editor æµ‹è¯•æµé€å…³å¡ã€‚

ä½¿ç”¨è“å›¾å¸è½½å…³å¡éå¸¸ç›¸ä¼¼ï¼Œåªéœ€åœ¨äº‹ä»¶å¤„ç†ä¸­ä½¿ç”¨ Unload Stream Level èŠ‚ç‚¹ç»“æŸã€‚

éœ€è¦æ³¨æ„ï¼Œå¿…éœ€æ˜¯å½“å‰å…³å¡çš„å­å¡æ‰å¯ä»¥æµé€çš„å…³å¡ã€‚


## âš¡ Level Streaming & C++

åŸºäºè„šæœ¬çš„å…³å¡æµé€å¯ä»¥è®¾ç½®æ›´å¤æ‚çš„å…³å¡è½½å…¥å’Œå¸è½½è¡Œä¸ºï¼Œä¹Ÿå¯è®¾ç½®å…³å¡è½½å…¥å’Œå¸è½½çš„è“å›¾æˆ– C++ é€»è¾‘ã€‚å…³é”®å‡½æ•°ä¸º `UGameplayStatics` æä¾›çš„é™æ€æ–¹æ³• Load Stream Level å’Œ Unload Stream Levelï¼Œå¹¶æŒ‡å®šå…³å¡æŒ‰å‘½ååŠ è½½ã€‚

åœ¨ Load Stream Level å’Œ Unload Stream Level ä¹‹å¤–ï¼ŒGet Streaming Level å‡½æ•°å¯å®ç°æ›´ä¸ºåŠ¨æ€çš„æµé€è¡Œä¸ºã€‚åˆ©ç”¨å®ƒè®¿é—®å®é™…çš„å…³å¡æµé€å¯¹è±¡åï¼Œå³å¯ä¿®æ”¹å’ŒæŸ¥è¯¢å…¶çŠ¶æ€ã€‚ç»“åˆ Create Instance ä½¿ç”¨æ­¤å‡½æ•°ï¼Œä¹Ÿå¯åˆ›å»ºå¹¶æµå…¥ç‰¹å®šå…³å¡åˆ†æ®µçš„å‰¯æœ¬ã€‚å¯¹è¿™äº›å‰¯æœ¬åº”ç”¨å˜å½¢å’Œå‘é€å‚æ•°ï¼Œå³å¯åˆ›å»ºç¨‹åºåŒ–çš„ä¸–ç•Œåœºæ™¯ã€‚


å‚è€ƒå®˜æ–¹æ–‡æ¡£ä½¿ç”¨ C++ æµå…¥å…³å¡æä¾›çš„ LevelStreamerActor ç¤ºèŒƒï¼Œå¦‚ä¸‹ã€‚ä½¿ç”¨ä¸€ä¸ª UBoxComponent å……å½“å…³å¡æµé€ä½“ç§¯åŸŸï¼Œå½“ç©å®¶ä¸å®ƒè§¦ç¢°äº§ç”Ÿ Overlap äº‹ä»¶æ—¶æ‰§è¡Œå…³å¡æµé€ï¼Œåˆ†åˆ«åœ¨ BeginOverlap å’Œ EndOverlap äº‹ä»¶ä¸­æ‰§è¡Œæµå…¥å’Œæµå‡ºã€‚

è¿™æ ·ï¼Œç©å®¶è¿›å…¥æµé€ä½“ç§¯åŸŸæ—¶å°±ä¼šçœ‹åˆ°åœºæ™¯ä¸­åŠ è½½äº†å­å…³å¡çš„å†…å®¹ï¼Œç¦»å¼€æ—¶å†…å®¹åˆè¢«ç§»é™¤ã€‚

LevelStreamerActor.h å¦‚ä¸‹ï¼š

```C++,
    #pragma once

    #include "GameFramework/Actor.h"
    #include "LevelStreamerActor.generated.h"

    UCLASS()
    class LEVELS_API ALevelStreamerActor : public AActor
    {
        GENERATED_BODY()

    public: 
        // æ„é€ å™¨ä¸­è®¾ç½®è¯¥ actor å±æ€§çš„é»˜è®¤å€¼
        ALevelStreamerActor();

        // æ¯å¸§è°ƒç”¨
        virtual void Tick( float DeltaSeconds ) override;

    protected:

        // æ¸¸æˆå¼€å§‹æˆ–ç”Ÿæˆæ—¶è°ƒç”¨
        virtual void BeginPlay() override;

        UFUNCTION()
        void OverlapBegins(UPrimitiveComponent* OverlappedComponent, AActor* OtherActor, UPrimitiveComponent* OtherComp, int32 OtherBodyIndex, bool bFromSweep, const FHitResult & SweepResult);
        UFUNCTION()
        void OverlapEnds(UPrimitiveComponent* OverlappedComponent, AActor* OtherActor, UPrimitiveComponent* OtherComp, int32 OtherBodyIndex);

        UPROPERTY(EditAnywhere)
        FName LevelToLoad;

    private:
        // é‡å ä½“ç§¯åŸŸè§¦å‘å…³å¡æµé€
        UPROPERTY(VisibleAnywhere, BlueprintReadOnly, meta = (AllowPrivateAccess = "true"))
        UBoxComponent* OverlapVolume;

    };
```

LevelStreamerActor.cpp å¦‚ä¸‹ï¼š

```C++,
    #include "Levels.h"
    #include "Kismet/GameplayStatics.h"
    #include "LevelStreamerActor.h"

    // è®¾ç½®é»˜è®¤å€¼
    ALevelStreamerActor::ALevelStreamerActor()
    {
        // å°†æ­¤ actor è®¾ä¸ºæ¯å¸§è°ƒç”¨ Tick()ã€‚ä¸éœ€è¦æ—¶å¯å°†æ­¤å…³é—­ï¼Œä»¥æé«˜æ€§èƒ½ã€‚
        PrimaryActorTick.bCanEverTick = true;

        OverlapVolume = CreateDefaultSubobject<UBoxComponent>(TEXT("OverlapVolume"));
        RootComponent = OverlapVolume;

        OverlapVolume->OnComponentBeginOverlap.AddUniqueDynamic(this, &ALevelStreamerActor::OverlapBegins);
        OverlapVolume->OnComponentEndOverlap.AddUniqueDynamic(this, &ALevelStreamerActor::
    }
    // æ¸¸æˆå¼€å§‹æ—¶æˆ–ç”Ÿæˆæ—¶è°ƒç”¨
    void ALevelStreamerActor::BeginPlay()
    {
        Super::BeginPlay();

    }

    // æ¯å¸§è°ƒç”¨
    void ALevelStreamerActor::Tick( float DeltaTime )
    {
        Super::Tick( DeltaTime );

    }

    void ALevelStreamerActor::OverlapBegins(UPrimitiveComponent* OverlappedComponent, AActor* OtherActor, UPrimitiveComponent* OtherComp, int32 OtherBodyIndex, bool bFromSweep, const FHitResult & SweepResult)
    {
            ACharacter* MyCharacter = UGameplayStatics::GetPlayerCharacter(this, 0);
            if (OtherActor == MyCharacter && LevelToLoad != "")
            {
                FLatentActionInfo LatentInfo;
                UGameplayStatics::LoadStreamLevel(this, LevelToLoad, true, true, LatentInfo);
            }
    }

    void ALevelStreamerActor::OverlapEnds(UPrimitiveComponent* OverlappedComponent, AActor* OtherActor, UPrimitiveComponent* OtherComp, int32 OtherBodyIndex)
    {
            ACharacter* MyCharacter = UGameplayStatics::GetPlayerCharacter(this, 0);
            if (OtherActor == MyCharacter && LevelToLoad != "")
            {
                FLatentActionInfo LatentInfo;
                UGameplayStatics::UnloadStreamLevel(this, LevelToLoad, LatentInfo);
            }
    }
```


## âš¡ Subsystems ç¼–ç¨‹å­ç³»ç»Ÿ
- è™šå¹»å¼•æ“4ç¼–ç¨‹å­ç³»ç»Ÿ https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/Subsystems/
- ã€ŠInsideUE4ã€‹GamePlayæ¶æ„ï¼ˆåä¸€ï¼‰Subsystems https://zhuanlan.zhihu.com/p/158717151

è™šå¹»å¼•æ“ 4.22 GamePlay æ¶æ„ä¸­çš„å­ç³»ç»Ÿæ˜¯ç”Ÿå‘½å‘¨æœŸå—æ§çš„è‡ªåŠ¨å®ä¾‹åŒ–ç±»ã€‚è¿™äº›ç±»æä¾›äº†æ˜“ç”¨çš„æ‰©å±•ç‚¹ï¼Œç¨‹åºå‘˜å¯ç›´æ¥è·å¾—è¿™äº›å­ç³»ç»Ÿçš„è“å›¾å’Œ Python å…¬å¼€ï¼ŒåŒæ—¶é¿å…ç¹å¤çš„å¼•æ“ç±»ä¿®æ”¹æˆ–è¦†ç›–ã€‚

å½“å‰æ”¯æŒçš„å­ç³»ç»Ÿç”Ÿå‘½å‘¨æœŸåŒ…æ‹¬ï¼š

- *UEngineSubsystem* auto instanced and initialized systems that share the lifetime of the Engine
- *UEditorSubsystem* auto instanced and initialized systems that share the lifetime of the Editor.
- *UGameInstanceSubsystem* auto instanced and initialized systems that share the lifetime of the game instance.
- *ULocalPlayerSubsystem* auto instanced and initialized subsystem that share the lifetime of local players.
- *UWorldSubsystem* auto instanced and initialized systems that share the lifetime of a *UWorld*.

ä¸¾ä¾‹è€Œè¨€ï¼Œå¦‚æœåˆ›å»ºäº†ä¸€ä¸ªæ´¾ç”Ÿè‡ªæ¸¸æˆå®ä¾‹å­ç³»ç»ŸåŸºç±»çš„ç±»ï¼š

    class UMyGamesSubsystem : public UGameInstanceSubsystem

å°†å‡ºç°ä»¥ä¸‹ç»“æœï¼š

- åˆ›å»º *UGameInstance* ä¹‹åï¼Œè¿˜ä¼šåˆ›å»ºä¸€ä¸ªåä¸º *UMyGamesSubsystem* çš„å®ä¾‹ã€‚
- *UGameInstance* åˆå§‹åŒ–æ—¶ï¼Œå°†åœ¨å­ç³»ç»Ÿä¸Šè°ƒç”¨ *Initialize()*ã€‚
- *UGameInstance* å…³é—­æ—¶ï¼Œå°†åœ¨å­ç³»ç»Ÿä¸Šè°ƒç”¨ *Deinitialize()*ã€‚
- æ­¤æ—¶å°†æ”¾å¼ƒå¯¹å­ç³»ç»Ÿçš„å¼•ç”¨ï¼Œå¦‚æœä¸å†æœ‰å¯¹å­ç³»ç»Ÿçš„å¼•ç”¨ï¼Œåˆ™å…¶å°†è¢«åƒåœ¾å›æ”¶ã€‚

ä½¿ç”¨ç¼–ç¨‹å­ç³»ç»Ÿæœ‰ä»¥ä¸‹å‡ ä¸ªåŸå› ï¼š

- å­ç³»ç»Ÿå¯èŠ‚çœç¼–ç¨‹æ—¶é—´ã€‚
- å­ç³»ç»Ÿä½¿æ‚¨æ— éœ€è¦†ç›–å¼•æ“ç±»ã€‚
- å­ç³»ç»Ÿä½¿æ‚¨æ— éœ€å†å·²ç»å¾ˆå¤æ‚çš„ç±»ä¸Šæ·»åŠ æ›´å¤šAPIã€‚
- å­ç³»ç»Ÿä½¿æ‚¨èƒ½é€šè¿‡ç”¨æˆ·å‹å¥½çš„ç±»å‹åŒ–èŠ‚ç‚¹æ¥è®¿é—®è“å›¾ã€‚
- å­ç³»ç»Ÿå…è®¸è®¿é—®Pythonè„šæœ¬æ¥ç¼–å†™ç¼–è¾‘å™¨è„šæœ¬æˆ–ç¼–å†™æµ‹è¯•ä»£ç ã€‚
- å­ç³»ç»Ÿåœ¨ä»£ç åº“ä¸­æä¾›æ¨¡å—åŒ–å’Œä¸€è‡´æ€§ã€‚

å­ç³»ç»Ÿåœ¨åˆ›å»ºæ’ä»¶æ—¶å°¤ä¸ºå®ç”¨ã€‚æ‚¨ä¸éœ€è¦ä»£ç ç›¸å…³çš„è¯´æ˜å³å¯è®©æ’ä»¶å·¥ä½œã€‚ç”¨æˆ·åªéœ€å°†æ’ä»¶æ·»åŠ åˆ°æ¸¸æˆä¸­ï¼Œå°±å¯ä»¥ç¡®åˆ‡äº†è§£æ’ä»¶å°†åœ¨ä½•æ—¶è¢«å®ä¾‹åŒ–å’Œåˆå§‹åŒ–ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥ä¸“æ³¨äºUE4ä¸­æä¾›çš„APIå’ŒåŠŸèƒ½çš„ä½¿ç”¨æ–¹å¼ã€‚

å­ç³»ç»Ÿå°†è‡ªåŠ¨å…¬å¼€åˆ°è“å›¾ï¼Œæ™ºèƒ½èŠ‚ç‚¹ç†è§£æƒ…å¢ƒï¼Œä¸”ä¸éœ€è¦å¼ºåˆ¶è½¬æ¢ã€‚æ‚¨å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„ UFUNCTION() æ ‡è®°å’Œè§„åˆ™æ¥æ§åˆ¶è“å›¾å¯ä»¥ä½¿ç”¨å“ªäº›APIã€‚

å³é”®ç‚¹å‡»è“å›¾å›¾è¡¨æ¥æ˜¾ç¤ºå¿«æ·èœå•å¹¶æœç´¢"å­ç³»ç»Ÿ"ï¼Œå°†å‡ºç°å¯¹åº”çš„å­ç³»ç»Ÿå†…å®¹ã€‚è¿™é‡Œæœ‰æ¯ä¸ªä¸»è¦ç±»å‹çš„ç±»ç›®ï¼Œä»¥åŠæ¯ä¸ªç‰¹å®šå­ç³»ç»Ÿçš„å•ä¸ªæ¡ç›®ã€‚

å¦‚æœæ­£åœ¨ä½¿ç”¨ Pythonï¼Œåˆ™å¯ä»¥ç”¨å†…ç½®è®¿é—®å™¨æ¥è®¿é—®å­ç³»ç»Ÿï¼Œå¦‚ä¸‹æ–¹ç¤ºä¾‹æ‰€ç¤ºã€‚

```py
my_engine_subsystem = unreal.get_engine_subsystem(unreal.MyEngineSubsystem)
my_editor_subsystem = unreal.get_editor_subsystem(unreal.MyEditorSubsystem)
```
Python å½“å‰æ˜¯ä¸€ä¸ªå®éªŒæ€§åŠŸèƒ½ã€‚

å½“å¼•æ“å­ç³»ç»Ÿã€ç¼–è¾‘å™¨å­ç³»ç»Ÿç­‰æ¨¡å—åŠ è½½æ—¶ï¼Œå­ç³»ç»Ÿå°†åœ¨æ¨¡å—çš„ *Startup()* å‡½æ•°è¿”å›åæ‰§è¡Œ *Initialize()*ï¼Œå­ç³»ç»Ÿå°†åœ¨æ¨¡å—çš„ *Shutdown()* å‡½æ•°è¿”å›åæ‰§è¡Œ *Deinitialize()*ã€‚

è¿™äº›å­ç³»ç»Ÿé€šè¿‡ *GEngine* æˆ–*GEEditor*è¿™æ ·çš„å…¨å±€å˜é‡è®¿é—®ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

```C++,
    class UMyEngineSubsystem : public UEngineSubsystem { ... };
    class UMyEditorSubsystem : public UEditorSubsystem { ... };
    class UMyGameSubsystem   : public UGameInstanceSubsystem { ... };
    class UMyPlayerSubsystem : public ULocalPlayerSubsystem { ... };

    UMyEngineSubsystem* MySubsystem = GEngine->GetEngineSubsystem<UMyEngineSubsystem>();
    UMyEditorSubsystem* MySubsystem = GEditor->GetEditorSubsystem<UMyEditorSubsystem>();

    UGameInstance* GameInstance = ...;
    UMyGameSubsystem* MySubsystem = GameInstance->GetSubsystem<UMyGameSubsystem>();

    ULocalPlayer* LocalPlayer = ...;
    UMyPlayerSubsystem * MySubsystem = LocalPlayer->GetSubsystem<UMyPlayerSubsystem>();
```

åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œä¸ºæ¸¸æˆæ·»åŠ ä¸€ä¸ªç»Ÿè®¡æ•°æ®ç³»ç»Ÿï¼Œä»¥è·Ÿè¸ªæ”¶é›†èµ„æºçš„æ•°é‡ã€‚

æˆ‘ä»¬å¯ä»¥ä» *UGameInstance* æ´¾ç”Ÿï¼Œå¹¶åˆ›å»º *UMyGamesGameInstance*ï¼Œç„¶åä¸ºå…¶æ·»åŠ  *IncrementResourceStat()* å‡½æ•°ã€‚ç„¶è€Œæˆ‘ä»¬çŸ¥é“ï¼Œå›¢é˜Ÿæœ€ç»ˆå¸Œæœ›æ·»åŠ å…¶ä»–ç»Ÿè®¡æ•°æ®ä»¥åŠç»Ÿè®¡æ•°æ®èšåˆå™¨å’Œç»Ÿè®¡æ•°æ®çš„ä¿å­˜/åŠ è½½ç­‰ã€‚å› æ­¤ï¼Œæ‚¨å†³å®šå°†æ‰€æœ‰è¿™äº›å†…å®¹æ”¾å…¥ç±»ä¸­ï¼Œä¾‹å¦‚ *UMyGamesStatsSubsystem*ã€‚

åŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»º *UMyGamesGameInstance* å¹¶æ·»åŠ  *UMyGamesStatsSubsystem* ç±»å‹çš„æˆå‘˜ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥å‘å®ƒæ·»åŠ ä¸€ä¸ªå­˜å–å™¨ï¼Œå¹¶è¿æ¥Initializeå’ŒDeinitializeå‡½æ•°ã€‚ç„¶è€Œè¿™ä¼šå­˜åœ¨å‡ ä¸ªé—®é¢˜ã€‚

ä¸å­˜åœ¨ *UGameInstance* çš„æ¸¸æˆç‰¹å®šå¯¼æ•°ã€‚

*UMyGamesGameInstance* å­˜åœ¨ï¼Œä½†æ˜¯å®ƒå·²æ‹¥æœ‰å¤§é‡å‡½æ•°ï¼Œæ·»åŠ æ›´å¤šå‡½æ•°å¹¶ä¸ç†æƒ³ã€‚

åœ¨ä¸€ä¸ªè¶³å¤Ÿå¤æ‚çš„æ¸¸æˆä¸­ï¼Œä» *UGameInstance* è¿›è¡Œæ´¾ç”Ÿæœ‰å¾ˆå¤šå¥½å¤„ã€‚ç„¶è€Œå½“æ‚¨æ‹¥æœ‰å­ç³»ç»Ÿæ—¶ï¼Œä¾¿ä¸éœ€è¦ä½¿ç”¨å®ƒã€‚æœ€é‡è¦çš„æ˜¯ï¼Œè¾ƒä¹‹äºä½¿ç”¨å…¶ä»–æ–¹æ³•ï¼Œä½¿ç”¨å­ç³»ç»Ÿéœ€è¦ç¼–å†™çš„ä»£ç æ›´å°‘ã€‚

å› æ­¤ï¼Œæˆ‘ä»¬æœ€ç»ˆä½¿ç”¨çš„ä»£ç å°†æ˜¾ç¤ºåœ¨ä¸‹ä¾‹ä¸­ã€‚

```C++,
    UCLASS()
    class UMyGamesStatsSubsystem : public UGameInstanceSubsystem
    {
        GENERATED_BODY()
    public:
        // Begin USubsystem
        virtual void Initialize(FSubsystemCollectionBase& Collection) override;
        virtual void Deinitialize() override;
        // End USubsystem

        void IncrementResourceStat();
    private:
        // All my variables
    };
```



# ğŸŒŸ Content Examples æ¨¡æ¿å·¥ç¨‹åˆ†è§£
- Content Examples https://docs.unrealengine.com/4.27/en-US/Resources/ContentExamples/
- å†…å®¹ç¤ºä¾‹ https://docs.unrealengine.com/4.27/zh-CN/Resources/ContentExamples/

å®˜æ–¹æä¾›çš„å­¦ä¹ ç¤ºèŒƒèµ„æº Content Examples åŒ…å«å¤§é‡åŸºç¡€çš„çŸ¥è¯†ç‚¹ç¤ºèŒƒæ¡ˆä¾‹ï¼Œæ¯ä¸ªå…³å¡å°±æ˜¯ä¸€ä¸ªä¸»é¢˜æ•™å­¦å†…å®¹ã€‚è€Œè¿™ä¸ªç¤ºèŒƒé¡¹ç›®æœ¬èº«çš„ç»“æ„å°±æ˜¯ä¸€ä¸ªå€¼å¾—å­¦ä¹ çš„ä¸»é¢˜å†…å®¹ï¼Œå­¦ä¹ æˆç†Ÿçš„è™šå¹»å·¥ç¨‹çš„ç»„ç»‡å’Œå„ç§çŸ¥è¯†ç‚¹çš„ä½¿ç”¨ã€‚

å†…å®¹ç¤ºä¾‹ Content Examples æ˜¯å¾ˆå¥½çš„å­¦ä¹ é€”å¾„ï¼Œä½ å¯ä»¥åœ¨å…¶ä¸­å°†ç¤ºä¾‹èµ„äº§ä¸ç›¸å…³æ–‡æ¡£å¯¹ç…§æ£€ç´¢ï¼Œä»¥æ­¤åŠ æ·±å°è±¡ã€‚åœ¨å†…å®¹ç¤ºä¾‹é¡¹ç›®ä¸­ï¼Œæ¯æ¬¾ç¤ºä¾‹éƒ½æœ‰ä¸€ä¸ªå•ç‹¬çš„å…³å¡ã€‚è¯¥é¡¹ç›®å¯ä»¥ä» Epic Games Launcher çš„å­¦ä¹ é€‰é¡¹å¡ä¸‹è½½ï¼Œæœç´¢ Content Examples å°±ä¸‹è½½ä½¿ç”¨ï¼Œå†…å®¹å¤§æ¦‚ 4GBã€‚åœ¨å…³å¡ä¸­ç§»åŠ¨æ—¶ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ç³»åˆ—æ ‡æœ‰æ•°å­—çš„åº•åº§ï¼Œæ¯ä¸ªæ•°å­—ç¼–å·éƒ½ä»£è¡¨ç€ä¸€å¥—ç¤ºä¾‹èµ„äº§ã€‚ä½ å¯ä»¥ç‚¹å‡»ç›¸åº”çš„ç¼–å·å¹¶æŸ¥çœ‹å†…å®¹ç¤ºä¾‹æ–‡æ¡£ï¼Œäº†è§£è¯¥ç¤ºä¾‹æ˜¯å¦‚ä½•è¢«åˆ›å»ºçš„ã€‚

å¯ä»¥æ‰“å¼€ä»»æ„å†…å®¹ç¤ºä¾‹å…³å¡ï¼Œæ”¹åŠ¨æˆ–ç¼–è¾‘å®ƒä»¬ï¼Œåˆ¶ä½œå±äºä½ è‡ªå·±çš„ç‰ˆæœ¬ï¼Œå¹¶äº†è§£å®ƒä»¬çš„æ„æˆæ–¹å¼ã€‚

å…ˆäº†è§£ Content Example å·¥ç¨‹åŸºæœ¬çš„æ„ä»¶ï¼š

- BP_Double_Doors è“å›¾å¯¹è±¡æ˜¯ä¸€ä¸ªå¸¦æœ‰å¼€å…³åŠ¨ç”»æ•ˆæœçš„è‡ªåŠ¨é—¨ï¼ŒåŸºäº Timeline å®ç°åŠ¨ç”»ã€‚



# ğŸŒŸ Puzzle æ¨¡æ¿å·¥ç¨‹åˆ†è§£

ä»¥ Puzzle è“å›¾å·¥ç¨‹ä¸ºä¾‹ï¼Œè¿™ä¸ªæ‹¼å›¾æ¸¸æˆå®ç°äº†ç”¨æˆ·ç‚¹å‡»ä¸€ä¸ªæ£‹ç›˜æ ¼å­å°±è¿›è¡Œè®¡åˆ†çš„ç®€å•é€»è¾‘ï¼Œæ£‹ç›˜é€šè¿‡è“å›¾èŠ‚ç‚¹è‡ªåŠ¨å¤åˆ¶ç”Ÿæˆã€‚

ä¸»è¦å¯¹è±¡æ˜¯ä½äº PuzzleBP/Blueprints ç›®å½•ä¸‹çš„è“å›¾ï¼š

`PuzzleBlockGrid` æ ¼å­æ£‹ç›˜ï¼Œå±‚æ¬¡ç»“æ„åŒ…å« *DummyRoot* -> *ScoreText*ï¼Œä½¿ç”¨ TextRender ç»„ä»¶æ˜¾ç¤ºå­—ç¬¦ä¸²ä¿¡æ¯ã€‚

- å®ƒåœ¨ *BeginPlay* äº‹ä»¶ä¸­ï¼Œä½¿ç”¨ For Loop åˆå§‹åŒ–ç”Ÿæˆæ£‹ç›˜æ ¼å­ï¼Œå°ºå¯¸åœ¨ *Size* å˜é‡ä¸­æŒ‡å®šä¸º 3ï¼Œå³ 3 X 3 å¤§å°ã€‚
    - æ³¨æ„ For Loop çš„ Last Index ä½¿ç”¨åºå·åŸºäº 0 å¼€å§‹ï¼Œæ‰€ä»¥ Size ç»è¿‡ Multiply ä¹˜æ–¹è¿ç®—åï¼Œè¿˜è¦å‡ä¸€ã€‚
    - Loop Body åä½¿ç”¨ *SpawnActor* ç”Ÿæˆæ ¼å­å¯¹è±¡ PuzzleBlockï¼Œå¹¶å°† Owning Grid è®¾ç½® Self å³æ£‹ç›˜ä¾›æ ¼å­å¯¹è±¡å¼•ç”¨ã€‚
    - PuzzleBlock ç”Ÿæˆæ—¶çš„ä½ç½®æ ¹æ®è¡Œåˆ—ä»¥åŠ*BlockSpacing*å˜é‡ä¸­è®¾ç½®çš„é»˜è®¤é—´è· 400 åˆ†å¸ƒæ’åˆ—ã€‚
    - ä½¿ç”¨ Integer Modulo å¯¹å½“å‰åºå· Index % Size æ±‚ä½™å¾—åˆ°åˆ—ä½ç½®ï¼Œä¹˜ä¸Šé—´è·å³ä¸º X åæ ‡ã€‚
    - ä½¿ç”¨ Operators Divide å¯¹å½“å‰åºå· Index / Size æ±‚å•†å¾—åˆ°è¡Œä½ç½®ï¼Œä¹˜ä¸Šé—´è·å³ä¸º Y åæ ‡ã€‚
    - ä½¿ç”¨ Make Vector å°† X/Y åæ ‡ç”ŸæˆçŸ¢é‡ï¼Œå¹¶ä¸ GetActorLocation è·å¾—çš„æ£‹ç›˜ä½ç½®ç›¸åŠ ï¼›
    - ä½¿ç”¨ To Transform(Vector) å°†ä¸Šé¢å¾—åˆ°çš„å‘é‡è½¬æ¢æˆè½¬æ¢çŸ©é˜µè¾“å…¥ *SpawnActor* çš„ Spawn Transformã€‚
- è‡ªå®šä¹‰äº‹ä»¶ *AddScore* æ˜¯å¯ä»¥ç”±å¤–éƒ¨è°ƒç”¨çš„æ–¹æ³•ï¼Œæ ¼å­å¯¹è±¡ä¼šè°ƒç”¨å®ƒæ¥è®°å½•åˆ†æ•°ï¼Œå…¶å†…éƒ¨ä¸­å¤„ç†åˆ†æ•°çš„æ›´æ–°ä¸æ˜¾ç¤ºã€‚
    - ä½¿ç”¨ Add é€’å¢ *Score* å˜é‡çš„å€¼ï¼Œå¹¶ä½¿ç”¨ Set è¿›è¡Œè®¾ç½®ã€‚
    - ç»è¿‡ ToText(Integer) è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå¹¶ä½¿ç”¨ Format Text æ ¼å¼åŒ–ä¸º "Score:{Score}" æ ·å¼ã€‚
    - æ ¼å¼åŒ–åçš„å­—ç¬¦ä¸²ä¼ å…¥ ScoreText ç»„ä»¶çš„ SetText æ–¹æ³•è¿›è¡Œæ›´æ–°æ˜¾ç¤ºã€‚

`PuzzleBlock` å³æ£‹ç›˜ä¸­çš„æ ¼å­æ–¹å—ï¼Œå±‚æ¬¡ç»“æ„åŒ…å« *DummyRoot* -> *BlockMesh* -> *Box*ï¼Œå®ƒå¤„ç†ä¸‰ç±»äº‹ä»¶ï¼š

- ç”¨æˆ·ç‚¹å‡»äº‹ä»¶ï¼ŒåŒ…æ‹¬*HandleControllerClick*ï¼Œ*BeginInputTouch*ï¼Œ*OnClicked*ã€‚
    - ä½¿ç”¨ *IsActive* å˜é‡æ¥æ ‡è®°å½“å‰æ ¼å­æ˜¯ä¸æ˜¯å·²å¤„ç†è¿‡ï¼Œç‚¹å‡»è¿‡çš„æ ¼å­ä¸å†è¿›è¡Œå¤„ç†ã€‚
    - ä½¿ç”¨ Set èŠ‚ç‚¹å°†å…¶è®¾ç½®ä¸º Trueï¼Œå¹¶ç»“åˆ Branch æ¥å†³å®šæµç¨‹æ˜¯å¦ç»§ç»­ã€‚
    - ä½¿ç”¨ SetMaterial æ”¹å˜ *BlockMesh* çš„æè´¨ä¸º OrangeMaterialï¼Œ
    - è°ƒç”¨ *OwingGrid* å¼•ç”¨ PuzzleBlockGrid æä¾›çš„ AddScore() æ–¹æ³•å¢åŠ æ˜¾ç¤ºçš„åˆ†æ•°ã€‚
- è‡ªå®šä¹‰äº‹ä»¶ *HighlightOn* å’Œ *HighlightOff* ä¾› VR å¤´è½½è®¾å¤‡ä½¿ç”¨ï¼Œä½¿ç”¨*Highlighted?*å˜é‡æ ‡è®°æ˜¯å¦å¤„äºç„¦ç‚¹çŠ¶æ€ã€‚å¤„ç†é¼ æ ‡æ»‘è¿‡æ ¼å­ä¸Šé¢æ—¶ï¼Œä¸´æ—¶åˆ‡æ¢æ ¼å­æè´¨ä¸º BaseMaterial å’Œ BlueMaterialã€‚å·²ç»å¤„ç†è¿‡çš„ IsActive æ ‡è®°è¿‡çš„æ ¼å­ä¸è¿›è¡Œå“åº”ã€‚
- åœ¨ *BlockMesh* å¯¹è±¡ä¸Šå¯ç”¨ OnBeginCursorOver å’Œ OnEndCursorOver äº‹ä»¶ï¼Œé¼ æ ‡ç§»åŠ¨æ—¶å°±ä¼šæ»‘è¿‡çš„ç„¦ç‚¹å“åº”è¡Œä¸ºå’Œä¸Šé¢ä¸€æ ·ã€‚ 

é€»è¾‘æœ€å¤šçš„æ˜¯ `PuzzlePlayerCharater` ç©å®¶è§’è‰²å¯¹è±¡ï¼Œç»„ä»¶å±‚æ¬¡ç»“æ„åŒ…æ‹¬ï¼š

- Capsule Component(CollisionCylinder) ç¢°æ’æ£€æµ‹è½®å»“ï¼›
    - Arrow Component æœå‘æŒ‡ç¤ºç»„ä»¶ï¼›
    - Mesh (Skeletal Mesh) ç»„ä»¶ï¼Œä¸å«å†…å®¹ï¼›
    - VR_Camera ç”¨äº VR å¤´æˆ´è®¾å¤‡çš„æ‘„åƒæœºç»„ä»¶ï¼›
    - FP_Camera ç”¨äºç¬¬ä¸€äººç§°è§’åº¦çš„æ‘„åƒæœºç»„ä»¶ï¼›
- Character Movement ç»„ä»¶ï¼›

å®ƒä¸ºéœ€è¦ä¸º VR è®¾å¤‡å¤„ç†å¤šä¸ªäº‹ä»¶ï¼Œä½¿ç”¨äº† *UHeadMountedDisplayFunctionLibrary* å‡½æ•°åº“ï¼š

- *BeginPlay* åˆå§‹äº‹ä»¶ï¼Œæ ¹æ® IsHeadMountedDisplayEnabled æ–¹æ³•æ¥å†³å®šå¯ç”¨å“ªä¸ªæ‘„åƒæœºï¼Œå¹¶è°ƒç”¨ Camera ç»„ä»¶çš„ Active æ–¹æ³•æ¿€æ´»ã€‚
- *Tick* å¿ƒè·³äº‹ä»¶ï¼Œåœ¨ HMD è®¾å¤‡å¯ç”¨çš„æ¡ä»¶ä¸‹æ‰§è¡Œã€‚
    - ä½¿ç”¨ KismetSystemLibrary::LineTraceByChannel è¿›è¡Œå…‰çº¿ç¢°æ’è¿½è¸ªï¼Œå¹¶è¿”å›é¦–ä¸ªé˜»æŒ¡å‘½ä¸­ï¼Œåªè¿”å›å¯¹ç‰¹å®šè¿½è¸ªé€šé“å“åº”çš„å¯¹è±¡ã€‚
    - é…åˆæ‘„åƒæœºçš„ GetWorldLocationã€GetWorldRotationã€GetForwardVector æ¥äº§ç”Ÿå…‰çº¿çš„èµ·æ­¢å®šä½ç‚¹ã€‚
    - å¯¹è¾“å‡ºçš„ HitResult ä½¿ç”¨ Break Hit Result æ¥è·å– Hit Actor å³ç¢°æ’åˆ°çš„å¯¹è±¡ï¼Œå¹¶å°è¯•è½¬æ¢ä¸º Cast To PuzzleBlockã€‚
    - å¦‚æœè½¬æ¢æˆåŠŸï¼Œå°±ä¿å­˜åˆ° *CurrenBlockFocus* å˜é‡ä¾¿äºåç»§å¼•ç”¨ï¼Œå¹¶æ‰§è¡Œ `PuzzleBlock` çš„ *HighlightOn*ã€*HighlightOff* äº‹ä»¶ã€‚
- å¦å¤–ä¸¤ä¸ªè¾“å…¥æ˜ å°„äº‹ä»¶ï¼Œ*ResetVR* å’Œ *TriggerClick*
    - åœ¨å·¥ç¨‹è®¾ç½® Engine -> Input -> Action Mapping é…ç½®ä¸­ï¼Œæ·»åŠ äº† ResetVR å’Œ TriggerClickã€‚
    - *TriggerClick* äº‹ä»¶æ ¹æ® *CurrenBlockFocus* æ˜¯å¦æœ‰æ•ˆå¼•ç”¨æ£‹ç›˜æ ¼å­å¯¹è±¡ï¼Œæ¥å†³å®šæ˜¯å¦è°ƒç”¨å®ƒçš„ *HandleControllerClick* æ–¹æ³•ã€‚
    - *ResetVR* äº‹ä»¶å¤„ç†å¤´æˆ´è®¾å¤‡çš„é‡ç½®ï¼Œè°ƒç”¨ ResetOrientationAndPosition æ–¹æ³•ã€‚

`PuzzleGameMode` æ¸¸æˆæ¨¡å¼å¯¹è±¡ï¼Œå®ƒçš„è®¾ç½®å†³å®šäº†å¦‚ä½•å¼€å§‹æ¸¸æˆï¼ŒåŒå‡»æ‰“å¼€æ¸¸æˆæ¨¡å¼è“å›¾ï¼Œåœ¨ Details é¢æ¿ä¸­æ˜¾ç¤ºä»¥ä¸‹ä¸»è¦çš„è®¾ç½®ï¼š

- Default Pawn Class é»˜è®¤çš„ç©å®¶æ§åˆ¶è§’è‰²å¯¹è±¡ç±»å‹ï¼Œå¼€å§‹æ¸¸æˆæ—¶ï¼Œå¼•æ“ä¼šè‡ªåŠ¨ä¸ºç©å®¶åˆ›å»ºä¸€ä¸ªå®ä¾‹ã€‚
- Play Controller Class ç©å®¶æ§åˆ¶å™¨ç±»å‹ï¼Œè¿™ä¸ªç±»å†³å®šäº†å¦‚ä½•æ“çºµç©å®¶çš„è§’è‰²ã€‚è¿™ä¸ªæ¸¸æˆæ§åˆ¶å™¨æœ¬èº«ä¸åšä»€ä¹ˆç‰¹åˆ«çš„äº‹ã€‚åªæ˜¯ä¿®æ”¹ä¸€ä¸‹é»˜è®¤çš„é…ç½®ï¼Œä¸»è¦æ˜¯ Mouse Interface ä¸­çš„è®¾ç½®ï¼Œå¯ç”¨äº†ä»¥ä¸‹å„ç§æ¶‰åŠçš„é¼ æ ‡æˆ–è§¦æ‘¸æ¿äº‹ä»¶ï¼š
    - Show Mouse Cursor
    - Enable Click Events
    - Enable Touch Events
    - Enable Mouse Over Events
    - Enable Touch Over Events
    - Default Mouse Cursor å…‰æ ‡æ˜¾ç¤ºé£æ ¼

åœ¨ World Settings é¢æ¿ä¸­ï¼Œå¯ä»¥èƒ½å®Œ Lightmass Settings è®¾ç½®ç¯å¢ƒè‰²å’Œç¯å¢ƒè‰²å¼ºåº¦ç­‰å‚æ•°æ”¹å˜å…‰çº¿æ•ˆæœï¼ŒEnvironment Color/Intensityã€‚

PuzzleBP ç›®å½•ä¸‹è¿˜æœ‰ Maps ä¸­çš„å…³å¡åœ°å›¾ï¼Œå®ƒåªæ˜¯ç®€å•æ”¾ç½®äº†æ£‹ç›˜å’Œç©å®¶å¯¹è±¡å®ä¾‹ã€‚Tutorial å­ç›®å½•ä¸‹çš„æ˜¯æ•™ç¨‹ï¼Œè¿™äº›å¯¹è±¡æ˜¯é€šè¿‡å†…å®¹æµè§ˆå™¨åˆ›å»ºçš„ï¼Œå³é”®èœå• Miscellaneous -> Tutorial Blueprintï¼Œå®ƒå¯ä»¥æŒ‰æ­¥éª¤åœ°è§£æé¡¹ç›®çš„ç»“æ„ã€‚æ•™ç¨‹è“å›¾å¯¹è±¡ä¹Ÿæ˜¯æ¨¡å—çš„ä¸€ç§ï¼Œä¹Ÿéœ€è¦å®ç° IModuleInterface æ¥å£ï¼Œå‚è€ƒä»£ç  IntroTutorials.hï¼Œé˜…è¯» *StartupModule()* å’Œ *ShutdownModule()* å‡½æ•°çš„é€»è¾‘ã€‚

æ­¤å¤–ï¼Œè¿˜æœ‰ Puzzle/Meshes ç›®å½•ä¸‹çš„ç®€å•æ¨¡å‹å’Œæè´¨ï¼Œå°±ä¸€ä¸ªæ–¹å—å’Œå…¶å®ƒçº¯è‰²æè´¨ã€‚





# ğŸŒŸ UMG UI ç•Œé¢æ¡†æ¶
- Introduction to UIs in Unreal https://benui.ca/unreal/ui-introduction/
- http://jollymonsterstudio.com/2019/03/12/unreal-engine-c-fundamentals-ahud-uuserwidget-and-uwidgetanimation/
- https://docs.unrealengine.com/4.27/en-US/Resources/ContentExamples/Blueprints_HUD/1_1/

UMGï¼ˆUnreal Motion Graphicsï¼‰æ˜¯åŸºäº Slate UI å°è£…å¼€å‘çš„ GUIï¼Œå¯åœ¨ç¼–è¾‘è®¾è®¡ï¼Œæ”¯æŒè“å›¾ã€C++ è®¿é—®ã€‚

UMG åŸºäºåŸ Slate UI å¼€å‘å°è£…çš„ GUIï¼Œæä¾›äº†ç°æˆçš„å¸¸ç”¨ UI ç»„ä»¶ï¼Œè¿˜æ·»åŠ äº†å¾ˆå¤šäº‹ä»¶å’Œæ–¹æ³•å¹¶æ”¯æŒè“å›¾ç¼–è¾‘ã€‚Slate åˆ™æ˜¯å®Œå…¨ C++ ä»£ç åŒ–ï¼Œæ‰€æœ‰å¸ƒå±€å’Œç»„ä»¶åˆ›å»ºåªèƒ½ç”¨ C++ å®ç°ï¼Œå½“ç„¶ Slate æä¾›æ›´åº•å±‚çš„ç»„ä»¶çµæ´»åº¦è¦æ›´é«˜ï¼Œå¦‚ SSplitter ç­‰ï¼Œæ›´ä¾¿äºå¼€å‘å¤æ‚ UIã€‚

åŸºäº Slate æ¡†æ¶é€»è¾‘ï¼ŒUGM ä¹Ÿä½¿ç”¨æ§½ä½ Slot çš„æ¦‚å¿µï¼Œå³å¯ä»¥åµŒå¥—æ”¾ç½®å­å…ƒä»¶ã€‚

- ä¸å¯ä»¥åŒ…å«å­å±‚çš„å¯¹è±¡æœ‰ï¼š Image, TextBlock
- åªèƒ½åŒ…å«ä¸€ä¸ªå­å¯¹è±¡çš„æœ‰ï¼š UserWidget root, Border, NamedSlot
- å¯ä»¥åŒ…å«å¤šä¸ªå­å¯¹è±¡çš„æœ‰ï¼š CanvasPanel, Overlay, WidgetSwitcher, HorizontalBox, VerticalBox

å¸¸ç”¨å…ƒä»¶å¦‚ä¸‹ï¼š

- åŸºæœ¬å…ƒä»¶ï¼š Image, TextBlock, Button
- åŸºæœ¬å®¹å™¨ï¼š Overlay, Canvas, HorizontalBox, VerticalBox, UniformGrid
- è¾¹æ¡†å…ƒä»¶ï¼š Border
- è¡¥å……å…ƒä»¶ï¼š NamedSlot, RetainerBox

*UserWidget* æ˜¯æœ€åŸºæœ¬çš„å…ƒä»¶ï¼Œå®ƒå¯ä»¥åˆ›å»ºä»»ä½•å¯å¤ç”¨çš„ UI å¯¹è±¡ï¼š

- ä½¿ç”¨ `UserWidget` æ¥è‡ªå®šä¹‰åŒ…å«å…¶å®ƒæŒ‰é’®å®ä¾‹çš„æŒ‰é’®ï¼Œå¹¶ä¸”å«æœ‰ `TextBlock` ä½œä¸ºæ ‡ç­¾ï¼Œè¿˜æœ‰ `Image` ä½œä¸ºæŒ‰é’®å›¾æ ‡ã€‚
- ä½¿ç”¨ `Userwidget` æ¥åˆ¶ä½œ HP è¡€æ¡ï¼Œå†…å« `ProgressBar` é›¶ä»¶ï¼Œå¹¶ä¸”è®¾ç½®å…¶ç™¾åˆ†æ¯”å±æ€§ï¼Œè¿˜å¯ä»¥åŒ…å« `TextBlock` æ¥æ˜¾ç¤ºå…·ä½“æ•°å€¼ã€‚
- ä½¿ç”¨ `UserWidget` æ¥åˆ¶ä½œ Tooltipï¼Œå†…å« `Image` åšè£…é¥°ï¼Œè¿˜æœ‰ `NamedSlot` æ¥æ’å…¥å†…å®¹å…ƒä»¶ã€‚

é€šå¸¸é€šè¿‡å†…å®¹æµè§ˆå™¨çš„ User Interface -> Widget Blueprint åˆ›å»ºè“å›¾æ‰©å±•ç±»ã€‚



## âš¡ UMG ç»„ä»¶å±‚æ¬¡ç»“æ„
- Widget Type Reference https://docs.unrealengine.com/4.27/zh-CN/InteractiveExperiences/UMG/UserGuide/WidgetTypeReference/
- Widget Interaction Component https://docs.unrealengine.com/4.27/en-US/InteractiveExperiences/UMG/UserGuide/WidgetInteraction/
- Widget Component https://docs.unrealengine.com/4.27/en-US/Basics/Components/Widget/

UMG ä¸­å¸¸ç”¨çš„ UWidget æ§ä»¶ç±»å‹æœ‰å››ç§ï¼š

- Common
- Input
- Panel
- Miscellaneous

æ­¤å¤–ï¼Œè¿˜æœ‰ç”¨æˆ·æ§ä»¶ï¼Œä»å†…å®¹æµè§ˆå™¨ä¸­åˆ›å»ºçš„ User Interface -> Widget Blueprint æ˜¯åŸºäº UUserWidget åˆ›å»ºçš„ã€‚ç”¨æˆ·åˆ›å»ºçš„ã€å¯æ”¾åœ¨å¦ä¸€ä¸ªæ§ä»¶è“å›¾ä¸­çš„ æ§ä»¶è“å›¾ã€‚éå¸¸é€‚ç”¨äºåˆ›å»º UI å…ƒç´ "éƒ¨ä»¶"ä½œä¸ºä¸ªä½“æ§ä»¶è“å›¾ï¼Œç„¶åå°†å®ƒä»¬æ·»åŠ åˆ°ä¸€èµ·ï¼Œæ„é€ æ•´ä½“ UI å¸ƒå±€ã€‚

UMG ç»„ä»¶å±‚æ¬¡ç»“æ„å¦‚ä¸‹ï¼Œåº•å±‚ä¸»è¦æ˜¯æ˜¯ UVisual ç±»ä¸‹çš„ä¸¤ä¸ªåˆ†æ”¯ï¼Œå®ƒæœ¬èº«ä¸åšä»€ä¹ˆã€‚*UPanelSlot* ç”¨äºç»„ä»¶æ§½ä½é€»è¾‘ï¼Œ*UWidget* ç”¨äºå¯è§† UI ç»„ä»¶ï¼š

                        +=============+
                        |   UObject   |
                        +=============+
                               |
                        +======v======+
                        |   UVisual   |
                        +=============+
                               |
           +-------------------+-----------------+
           |                                     |
    +============+                         +=====v=====+
    | UPanelSlot |                         |  UWidget  |
    +============+                         +===========+
          |     +-------------------------+      |     +===================+            +===================+           +---------------------+
          +---> | UBackgroundBlurSlot     |      +---> | UPanelWidget      |----->+---> | UContentWidget    |---->+---> | UBackgroundBlur     |
          |     +-------------------------+      |     +===================+      |     +===================+     |     +---------------------+
          |     +-------------------------+      |     +-------------------+      |     +-------------------+     |     +---------------------+
          +---> | UBorderSlot             |      +---> | UComboBox         |      +---> | UGridPanel        |     +---> | UBorder             |
          |     +-------------------------+      |     +-------------------+      |     +-------------------+     |     +---------------------+
          |     +-------------------------+      |     +-------------------+      |     +-------------------+     |     +---------------------+
          +---> | UButtonSlot             |      +---> | UComboBoxString   |      +---> | UHorizontalBox    |     +---> | UButton             |
          |     +-------------------------+      |     +-------------------+      |     +-------------------+     |     +---------------------+
          |     +-------------------------+      |     +-------------------+      |     +-------------------+     |     +---------------------+
          +---> | UGridSlot               |      +---> | UEditableText     |      +---> | UOverlay          |     +---> | UCheckBox           |
          |     +-------------------------+      |     +-------------------+      |     +-------------------+     |     +---------------------+
          |     +-------------------------+      |     +-------------------+      |     +-------------------+     |     +---------------------+
          +---> | UHorizontalBoxSlot      |      +---> | UEditableTextBox  |      +---> | UScrollBox        |     +---> | UInvalidationBox    |
          |     +-------------------------+      |     +-------------------+      |     +-------------------+     |     +---------------------+
          |     +-------------------------+      |     +-------------------+      |     +-------------------+     |     +---------------------+
          +---> | UOverlaySlot            |      +---> | UExpandableArea   |      +---> | UUniformGridPanel |     +---> | UMenuAnchor         |
          |     +-------------------------+      |     +-------------------+      |     +-------------------+     |     +---------------------+
          |     +-------------------------+      |     +-------------------+      |     +-------------------+     |     +---------------------+
          +---> | USafeZoneSlot           |      +---> | UImage            |      +---> | UVerticalBox      |     +---> | UNamedSlot          |
          |     +-------------------------+      |     +-------------------+      |     +-------------------+     |     +---------------------+
          |     +-------------------------+      |     +-------------------+      |     +-------------------+     |     +---------------------+
          +---> | UScaleBoxSlot           |      +---> | UInputKeySelector |      +---> | UWidgetSwitcher   |     +---> | URetainerBox        |
          |     +-------------------------+      |     +-------------------+      |     +-------------------+     |     +---------------------+
          |     +-------------------------+      |     +-------------------+      |     +-------------------+     |     +---------------------+
          +---> | UScrollBoxSlot          |      +---> | UNativeWidgetHost |      +---> | UWrapBox          |     +---> | USafeZone           |
          |     +-------------------------+      |     +-------------------+            +-------------------+     |     +---------------------+
          |     +-------------------------+      |     +===================+            +===================+     |     +---------------------+
          +---> | USizeBoxSlot            |      +---> | UListViewBase     |----->----> | UListView         |     +---> | UScaleBox           |
          |     +-------------------------+      |     +===================+            +===================+     |     +---------------------+
          |     +-------------------------+      |     +-------------------+                      |               |     +---------------------+
          +---> | UVerticalBoxSlot        |      +---> | UProgressBar      |            +---------v---------+     +---> | USizeBox            |
          |     +-------------------------+      |     +-------------------+            | UTileView         |     |     +---------------------+
          |     +-------------------------+      |     +-------------------+            +-------------------+     |     +---------------------+
          +---> | UUniformGridSlot        |      +---> | UScrollBar        |            +-------------------+     +---> | UViewport           |
          |     +-------------------------+      |     +-------------------+            | UTreeView         |     |     +---------------------+
          |     +-------------------------+      |     +-------------------+            +-------------------+     |     +---------------------+
          +---> | UWidgetSwitcherSlot     |      +---> | USlider           |                                      +---> | UWindowTitleBarArea |
          |     +-------------------------+      |     +-------------------+                                            +---------------------+
          |     +-------------------------+      |     +-------------------+            +--------------------------+
          +---> | UWindowTitleBarAreaSlot |      +---> | UTextLayoutWidget |------+---> | UMultiLineEditableText   |
          |     +-------------------------+      |     +-------------------+      |     +--------------------------+
          |     +-------------------------+      |     +-------------------+      |     +--------------------------+
          +---> | UWrapBoxSlot            |      +---> | USpinBox          |      +---> | UMultiLineEditableTextBox|
                +-------------------------+      |     +-------------------+      |     +--------------------------+
                                                 |     +-------------------+      |     +--------------------------+
                                                 +---> | USpacer           |      +---> | URichTextBlock           |
                                                 |     +-------------------+      |     +--------------------------+
                                                 |     +-------------------+      |     +--------------------------+
                                                 +---> | UThrobber         |      +---> | UTextBlock               |
                                                 |     +-------------------+            +--------------------------+
                                                 |     +-------------------+
                                                 +---> | UCircularThrobber |
                                                 |     +-------------------+
                                                 |     +-------------+
                                                 +---> | UUserWidget |
                                                       +-------------+


*UMeshComponent* ç»§æ‰¿ 3D ç»„ä»¶ï¼Œä¸º 2D UI ç»„ä»¶ä¸‰è§’åŒ–æ¸²æŸ“æä¾›æ”¯æŒï¼Œè€Œ *UWidgetInteractionComponent* æä¾›äº¤äº’èƒ½åŠ›æ”¯æŒï¼š

                       +============+
                       |   UObject  |
                       +============+
                             |
                  +==========v==========+
                  |   UActorComponent   |
                  +=====================+
                             |
               +----------------------------+
               |                            |
    +==========v==========+       +=========v=========+
    | UPrimitiveComponent |       |  USceneComponent  |
    +=====================+       +===================+
               |                            |
    +==========v==========+  +==============v==============+
    |   UMeshComponent    |  | UWidgetInteractionComponent |
    +=====================+  +=============================+
               |
    +==========v==========+
    |  UWidgetComponent   |
    +=====================+

æ‰€ä»¥ï¼Œåœ¨ 3D åœºæ™¯ä¸­è¦ä½¿ç”¨ UWidget ç»„ä»¶ï¼Œå°±éœ€è¦é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªç»„ä»¶æ¥å®ç°ï¼Œä¸º Widget Component ç»„ä»¶çš„ Widget Class å±æ€§æŒ‡å®š UI ç»„ä»¶ç±»ã€‚



## âš¡ UserWidget UMG ç»„ä»¶ç»˜åˆ¶
- UMG è™šå¹»è¿åŠ¨å›¾å½¢ç•Œé¢ https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ProgrammingWithCPP/CPPTutorials/UMG/
- Unreal Motion Graphics UI Designer (UMG) https://docs.unrealengine.com/4.27/en-US/InteractiveExperiences/UMG/
- UMG UI Designer Quick Start Guide https://docs.unrealengine.com/4.27/en-US/InteractiveExperiences/UMG/QuickStart/

UMG é€šè¿‡å†…å®¹æµè§ˆå™¨çš„ User Interface æä¾›é€‰é¡¹ï¼š

- Font 
- State Brush
- State Widget Style
- Widget Blueprint åˆ›å»º UserWidget çš„è“å›¾æ‰©å±•ç±»ï¼Œç„¶åå¯ä»¥ä½¿ç”¨ç¼–è¾‘å™¨åˆ›å»º UI ç»„ä»¶ç•Œé¢ã€‚

åˆ›å»ºæ‰€æœ‰ç”¨æˆ·ç•Œé¢å…ƒç´ ï¼ˆHUDã€èœå•ç­‰ï¼‰å¹¶æ”¾ç½®åœ¨æ§ä»¶è“å›¾ä¸­ã€‚æ§ä»¶è“å›¾å…è®¸æ‚¨ä»¥å¯è§†åŒ–æ–¹å¼å¯¹ UI å…ƒç´ è¿›è¡Œå¸ƒå±€ï¼Œå¹¶ä¸ºè¿™äº›å…ƒç´ æä¾›è„šæœ¬åŒ–åŠŸèƒ½ã€‚

ä½¿ç”¨è“å›¾å‘å…³å¡æ·»åŠ  UMG WidgetBlueprintï¼š

- åˆ›å»º UI æ§ä»¶ï¼šContent Browser -> User Interface -> Widget Blueprintï¼Œå‘½åä¸º*MyWidget_BP*ï¼›
- åŒå‡»æ‰“å¼€ *MyWidget_BP*ï¼Œåœ¨ UI ç¼–è¾‘å™¨ä¸­è®¾è®¡å¥½éœ€è¦çš„ç•Œé¢å…ƒç´ ï¼Œæ¯”å¦‚æ·»åŠ ä¸€ä¸ªæŒ‰é’®ï¼›
- æ‰“å¼€å…³å¡è“å›¾ï¼Œæ·»åŠ  BeginPlay èŠ‚ç‚¹ï¼Œä»æ‰§è¡Œæµè¾“å‡ºç«¯å¼•å‡ºï¼Œåˆ›å»ºä¸€ä¸ª Create Widget èŠ‚ç‚¹ï¼Œå¹¶è®¾ç½® Class ç«¯å£ä¸º *MyWidget_BP*ï¼›
- å†ä» Return Value å³å·²ç»åˆ›å»ºçš„*MyWidget_BP*å®ä¾‹å¼•å‡ºä¸€ä¸ª Add To View èŠ‚ç‚¹ï¼Œå³è°ƒç”¨*AddToViewport*æ–¹æ³•å°† UI æ§ä»¶å®ä¾‹æ·»åŠ åˆ°å…³å¡ä¸­ã€‚
- å¯ä»¥ä½¿ç”¨ä¸€ä¸ªè“å›¾å˜é‡ï¼Œæ¯”å¦‚ *WidgetRef* å°†åˆ›å»ºå¥½çš„å®ä¾‹å¼•ç”¨èµ·æ¥ï¼Œä½¿ç”¨ Set WidgetRef èŠ‚ç‚¹ä¿å­˜å¼•ç”¨ï¼Œåç»§éœ€è¦åšæ•°æ®é©±åŠ¨æ˜¾ç¤ºï¼Œå°±ç”¨å¾—ä¸Šã€‚
- æ‹–å‡º Set èŠ‚ç‚¹çš„è¾“å‡ºå¼•è„šï¼Œå†æ·»åŠ  Add to Viewport èŠ‚ç‚¹ã€‚

è¿™äº›è®¾ç½®å°†åœ¨æ¸¸æˆå¯åŠ¨æ—¶åˆ›å»ºæˆ‘ä»¬çš„ HUD æ§ä»¶è“å›¾ï¼Œå¹¶å°†å…¶å­˜å‚¨ä¸ºä¸€ä¸ªå˜é‡ï¼Œä»¥ä¾¿ç¨åè®¿é—®ã€‚è¿™å¯¹äºä»¥åè°ƒç”¨å‡½æ•°æˆ–è®¾ç½® HUD çš„å±æ€§å¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³åœ¨æ¸¸æˆæš‚åœæ—¶éšè— HUDï¼Œå¯ä»¥é€šè¿‡è¯¥å˜é‡è®¿é—® HUDã€‚


åŒå‡» HUD æ§ä»¶è“å›¾ä»¥æ‰“å¼€æ§ä»¶è“å›¾ç¼–è¾‘å™¨ï¼ˆWidget Blueprint Editorï¼‰ï¼Œåœ¨æ§ä»¶è“å›¾ç¼–è¾‘å™¨ä¸­æä¾›äº† HUD çš„è§†è§‰æ•ˆæœå¸ƒå±€å’Œè„šæœ¬åŠŸèƒ½ã€‚åœ¨æ§ä»¶è“å›¾ç¼–è¾‘å™¨çš„å³ä¸Šè§’å¯ä»¥åˆ‡æ¢ Graph å’Œ Designer å·¥ä½œæ¨¡å¼åˆ‡æ¢ã€‚

ç°åœ¨ï¼Œåˆ‡æ¢åˆ° Graph ä¸­çš„ Event Construct èŠ‚ç‚¹ä¸‹ï¼Œå³é”®å•å‡»å¹¶æ·»åŠ  Get Player Character èŠ‚ç‚¹ï¼Œè·å–ç©å®¶å¯¹è±¡å¼•ç”¨å¹¶å­˜å‚¨åˆ°è“å›¾å˜é‡ã€‚UI ç•Œé¢éœ€è¦ä½¿ç”¨ç©å®¶çš„ä¿¡æ¯å°±éœ€è¦é€šè¿‡å®ƒæ¥è·å–æ•°æ®ï¼Œæ¯”å¦‚ç©å®¶è“å›¾ä¸­å®šä¹‰å¥½äº†å­å¼¹æ•°é‡ *Ammo* ç­‰å˜é‡ã€‚

æ‹–å‡ºè¿”å›å€¼ï¼ˆReturn Valueï¼‰å¼•è„šï¼Œå¹¶ç»è¿‡ Cast to èŠ‚ç‚¹è½¬æ¢ç±»å‹ï¼Œå‡å®šç©å®¶å¯¹è±¡çš„ç±»å‹ä¸º *FirstPersonCharacter*ã€‚æ‰§è¡Œæµä» Event Construct èŠ‚ç‚¹å¼•å…¥ã€‚

ç°åœ¨åˆ‡æ¢åˆ° Designer å·¥ä½œæ¨¡å¼ï¼Œç»™ UI ç•Œé¢æ·»åŠ ä¸€ä¸ª Text æ–‡æœ¬æ§ä»¶ï¼Œåœ¨ Details -> Content å±æ€§ä¸­ï¼Œä½¿ç”¨ä¸‹æ‹‰åˆ—è¡¨å¯ä»¥çœ‹åˆ°å·²ç»æœ‰*FirstPersonCharacter*çš„å±æ€§ä¾›ç»‘å®šä½¿ç”¨ï¼Œå¯ä»¥é€‰æ‹©å…¶æä¾›çš„ *Ammo* å˜é‡ã€‚ä¹Ÿå¯ä»¥ç‚¹å‡» Bind -> Create Binding æ¥åˆ›å»ºä¸€ä¸ªç»‘å®šå‡½æ•°ï¼Œé»˜è®¤æœ‰ Get Text å’Œ Return Node ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œå‰é¢ä¸€ä¸ªæ˜¯æ‰§è¡Œæµå…¥çš„èŠ‚ç‚¹ã€‚ç°åœ¨ï¼Œåªéœ€è¦ä½¿ç”¨å‰é¢ä¿å­˜åˆ°å˜é‡ä¸­çš„ç©å®¶å¼•ç”¨è¯»å–å…¶ *Ammo* å˜é‡çš„æ•°æ®ï¼Œå†è¿æ¥åˆ° Return Node å³å®Œæˆè®¾ç½®ã€‚è¿æ¥æ—¶å°†è‡ªåŠ¨ä¸ºæ‚¨åˆ›å»ºä¸€ä¸ªè½¬æ¢èŠ‚ç‚¹ To Text å°†æ•°å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚

å°±åƒä½¿ç”¨ Sub-Object Properties ç»‘å®šç›¸åŒç±»å‹çš„å±æ€§ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå·±çš„è‡ªå®šä¹‰ç»‘å®šã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å°†æ–‡æœ¬æ§ä»¶çš„ Text å±æ€§ç»‘å®šåˆ°ç©å®¶è§’è‰²è“å›¾ä¸­çš„ä¸€ä¸ªç±»å‹ä¸º Integer çš„å±æ€§ï¼Œä»¥æ˜¾ç¤ºå½“å‰å¼¹è¯ã€‚

å•å‡» Compile ç¼–è¯‘è“å›¾å¹¶ä¸”ä¿å­˜ï¼Œæ³¨æ„æ›´æ”¹ç©å®¶çš„è“å›¾åä¹Ÿè¦è¿›è¡Œç¼–è¯‘ï¼Œå¦åˆ™åœ¨ UI æ§ä»¶çš„è“å›¾ä¸­å¯ä»¥è·å–ä¸åˆ°ç›¸åº”çš„ä¿¡æ¯ã€‚

ç°åœ¨ï¼Œå¯ä»¥æŒ‰åŒæ ·çš„æ–¹æ³•å°†ç”Ÿå‘½å€¼ï¼ˆHealthï¼‰ã€èƒ½é‡ï¼ˆEnergyï¼‰å’Œå¼¹è¯ï¼ˆAmmoï¼‰å€¼éƒ½æ˜¾ç¤ºåœ¨çš„ HUD ä¸Šï¼Œå¹¶åæ˜ æˆ‘ä»¬è§’è‰²è“å›¾ä¸­çš„å½“å‰å€¼ã€‚

ç„¶åå•å‡» Play æŒ‰é’®ä»¥åœ¨ç¼–è¾‘å™¨ä¸­è¿è¡Œæµ‹è¯•ï¼Œçœ‹æ•°æ®æ˜¯ä¸æ˜¯å’Œæ˜¾ç¤ºçš„ä¸€è‡´ã€‚

æºä»£ç å‚è€ƒï¼š

- UMG/Public/Blueprint/UserWidget.h

åç»­å­¦ä¹  UMG çš„è®¾è®¡ï¼Œå¹¶ä¸”å¯ä»¥æŒ‰ä¸åŒçš„ä»»åŠ¡åˆ¶ä½œä¸åŒçš„ HUD ç•Œé¢ï¼Œé€šè¿‡è“å›¾æ¥åˆ‡æ¢æ˜¾ç¤ºã€‚


ä½¿ç”¨ SceneCaptureComponent2D å¯ä»¥å®ç°åœºæ™¯ä¸­çš„å›¾åƒæ•æ‰ï¼Œç»“åˆ HUD è¿˜å¯ä»¥æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œæ“ä½œå¦‚ä¸‹ï¼š

- åˆ›å»º Scene Capture 2Dï¼Œä» Place Actors é¢æ¿ä¸­æ‹–æ”¾åˆ°åœºæ™¯ä¸­ï¼Œè®¾ç½®å¥½é•œå¤´ã€‚
- åœ¨ Details -> Scene Capture é¢æ¿ä¸­è®¾ç½®`Texture Target`ï¼Œå°†æ‘„åƒæœºé‡‡é›†åˆ°çš„å›¾åƒè½¬å‚¨åˆ° `TextureRenderTarget` æˆ– `CanvasRenderTarget`ã€‚
- Primitive Render Mode æ¸²æŸ“æ¨¡å¼æŒ‡å®šä¸º Use ShowOnly Listã€‚
    - Render Scene Primitives(Legacy)ï¼Œä½¿ç”¨é»‘åå•æ•°ç»„(Hidden Actors) ï¼ŒæŒ‡å®šä¸è¢«æ‘„åƒæœºæ•æ‰çš„ Actorsã€‚
    - Render Scene Primitivesï¼ŒåŸºæœ¬å›¾å…ƒæ¸²æŸ“ï¼Œæ‘„åƒæœºæ•æ‰æ‰€æœ‰ Actorsã€‚
    - Use ShowOnly Listï¼Œä½¿ç”¨ç™½åå•æ•°ç»„(Show Only Actors)ï¼Œæ‘„åƒæœºåªæ•æ‰æŒ‡å®šçš„ Actorsã€‚
- CaptureSource è®¾ç½®ä¸º SceneColorï¼ˆHDRï¼‰in RGBï¼ŒInv Opacity in Aï¼Œå³é»˜è®¤ï¼Œç©ºé—´é¢œè‰²è¾“å‡ºä¸º RGBï¼Œé€æ˜åº¦è¾“å‡ºåˆ°è“å›¾ A ç«¯å£ã€‚
- é€šè¿‡ RenderTarget åˆ›å»ºæè´¨ï¼Œå¹¶è®¾ç½® `Texture Sample` è¾“å…¥èŠ‚ç‚¹çš„çº¹ç†ä¸ºä¸Šé¢è¾“å‡ºçš„ `TextureRenderTarget` æ–‡ä»¶ã€‚
- å°† RGB è¿æ¥åˆ°æè´¨è¾“å‡ºç«¯ Final Colorï¼Œå°† A è¾“å‡ºçš„ Alpha ä¿¡æ¯ï¼Œç»è¿‡ä¸€ä¸ª OneMinus èŠ‚ç‚¹å–åå†æ¥å…¥ Opacity Mask ç”¨äºè¿‡æ»¤èƒŒæ™¯ã€‚
- åˆ›å»º User Interface -> Widget Blueprintï¼Œä½¿ç”¨ Image ç»„ä»¶ï¼ŒæŒ‡å®š Appearance -> Brush -> Image ä¸ºä¸Šé¢å¾—åˆ°çš„æè´¨ã€‚

å¦‚æœè¦åŸºäº RenderTarget åˆ›å»ºæè´¨ï¼Œåˆ™è¦è®¾ç½®å±æ€§æè´¨å±æ€§ Material Domain -> Uer Interfaceï¼Œå¦‚æ­¤è¯¥æè´¨æ‰å¯ä»¥åœ¨ UI ä¸Šä½¿ç”¨ã€‚


## âš¡ UWidget & UUserWidget UMG ç»„ä»¶å¼€å‘
- Unreal UIs and C++: Slate https://benui.ca/unreal/ui-cpp-slate/
- Creating new UWidgets in C++ https://benui.ca/unreal/ui-cpp-uwidget/
- Creating a UserWidget in C++ https://benui.ca/unreal/ui-cpp-uuserwidget/

é€šè¿‡ C++ æ‰©å±• UUserWidget åˆ›å»ºè®¾è®¡è‰¯å¥½çš„ UMG Widget æˆ–å­ç±»ï¼Œå¯ä»¥æä¾›ä»£ç é‡ç”¨æ•ˆç‡ã€‚

æ¯”å¦‚ï¼Œå¸¦å›¾æ ‡çš„æŒ‰é’®ï¼Œåˆ°å¤„éƒ½éœ€è¦ç”¨åˆ°ï¼ŒUButton::RebuildWidget æ–¹æ³•æä¾›ç»™ä½¿ç”¨è€…ä¸€å®šçš„çµæ´»åº¦ï¼Œè®©ç”¨æˆ·å¯ä»¥ç»‘å®šè‡ªå·±çš„äº‹ä»¶å¤„ç†å‡½æ•°ã€‚

ä»¥ä¸‹ç¤ºèŒƒåœ¨ RebuildWidget() å‡½æ•°ä¸­åˆ›å»ºä¸€ä¸ª Slate æŒ‰é’®ç»„ä»¶ SButtonï¼š

```C++,
    TSharedRef<SWidget> UButton::RebuildWidget()
    {
        MyButton = SNew(SButton)
            .OnClicked(BIND_UOBJECT_DELEGATE(FOnClicked,
                SlateHandleClicked))
            .OnPressed(BIND_UOBJECT_DELEGATE(FSimpleDelegate,
                SlateHandlePressed))
            .OnReleased(BIND_UOBJECT_DELEGATE(FSimpleDelegate,
                SlateHandleReleased))
            .OnHovered_UObject(this, &ThisClass::SlateHandleHovered)
            .OnUnhovered_UObject(this, &ThisClass::SlateHandleUnhovered)
            .ButtonStyle(&WidgetStyle)
            .ClickMethod(ClickMethod)
            .TouchMethod(TouchMethod)
            .IsFocusable(IsFocusable)
            ;

        if ( GetChildrenCount() > 0 )
        {
            Cast<UButtonSlot>(GetContentSlot())
                ->BuildSlot(MyButton.ToSharedRef());
        }
        
        return MyButton.ToSharedRef();
    }
```

UOverlay ç»„ä»¶æ‰©å±•ç¤ºèŒƒï¼š

```C++,
    // ExampleOverlay.h
    UCLASS()
    class UExampleOverlay : public UOverlay
    {
        GENERATED_UCLASS_BODY()
    public:

    #if WITH_EDITOR
        virtual const FText GetPaletteCategory() override;
    #endif

    protected:
        // UWidget interface
        virtual TSharedRef<SWidget> RebuildWidget() override;
        // End of UWidget interface
    };


    // ExampleOverlay.cpp
    #define LOCTEXT_NAMESPACE "ExampleUMG"

    TSharedRef<SWidget> UExampleOverlay::RebuildWidget()
    {
        auto Result = Super::RebuildWidget();

        for (UPanelSlot* InSlot : Slots)
        {
            // Do something custom
        }

        return Result;
    }

    #if WITH_EDITOR
    const FText UExampleOverlay::GetPaletteCategory()
    {
        return LOCTEXT("ExampleUI", "ExampleOverlay");
    }
    #endif
```




# ğŸŒŸ Slate UI ç•Œé¢æ¡†æ¶
- Slate UI æ¡†æ¶ https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/Slate/

UE4 çš„ç¼–è¾‘å™¨æ˜¯åŸºäº Slate UI æ¡†æ¶åˆ›å»ºçš„ï¼ŒåŒ…æ‹¬ UE4 ç”¨äºæ¸¸æˆçš„ UMG ä¹Ÿæ˜¯ã€‚

ä½•æ—¶è¯¥ä½¿ç”¨ Slate UI è€Œä¸æ˜¯ UMG çš„ä¸€äº›æç¤ºï¼š

- åˆ›å»º Editor UI æ—¶ï¼Œå› ä¸º Slate æ›´åº•å±‚ï¼Œå¯å®šåˆ¶çš„çµæ´»åº¦æ›´é«˜ï¼Œé€‚åˆåƒå¥‡ç™¾æ€ªçš„ UI åŠŸèƒ½ã€‚
- éœ€è¦å®ç°å½“å‰ UMG ç»„ä»¶éƒ½ä¸æ”¯æŒçš„åŠŸèƒ½æ—¶ï¼Œä½¿ç”¨ Slate è€Œä¸æ˜¯ UMGã€‚

UE 4.22 å¼€å§‹ï¼Œå¯ä»¥ä½¿ç”¨ UMG + Blueprints ä¿®æ”¹è™šå¹»ç¼–è¾‘å™¨çš„ç”¨æˆ·ç•Œé¢ï¼Œä½¿ç”¨ Editor Utility Widgets æ¥æ·»åŠ æ–°çš„ UI å…ƒç´ ã€‚ç¼–è¾‘å™¨å·¥å…·æ§ä»¶åŸºäºè™šå¹»è¿åŠ¨å›¾å½¢ UMGï¼Œæ‰€ä»¥æ‚¨å¯ä»¥åƒåœ¨ä»»ä½•å…¶ä»– UMG æ§ä»¶è“å›¾ä¸­ä¸€æ ·è®¾ç½®è“å›¾ä¸­çš„æ§ä»¶ã€‚

è¿™äº›æ§ä»¶ä¸“é—¨ç”¨äºç¼–è¾‘å™¨ UIï¼Œå¯ä»¥ä½¿ç”¨å®ƒä»¬æ¥åˆ›å»ºè‡ªå®šä¹‰ç¼–è¾‘å™¨é€‰é¡¹å¡ã€‚ç„¶åï¼Œå¯ä»¥ä»çª—å£èœå•ä¸­é€‰æ‹©è¿™äº›è‡ªå®šä¹‰é€‰é¡¹å¡ï¼Œå°±åƒé€‰æ‹©ç°æœ‰çš„ç¼–è¾‘å™¨é€‰é¡¹å¡ä¸€æ ·ã€‚


Slate UI ç³»ç»Ÿéšç¼–è¾‘å™¨ã€å¼•æ“æºç ä¸€èµ·å¼€æºï¼ŒåŒ…æ‹¬å¼€å‘è€…å·¥å…· Window > Developer Tools > Widget Reflectorã€‚

è™šå¹»ç¼–è¾‘å™¨çš„ UI æ˜¯ä½¿ç”¨ Slate UI æ¡†æ¶ç¼–è¯‘çš„ï¼ŒWidget Reflector å·¥å…·è®©å¼€å‘äººå‘˜å¯ä»¥æ ‡è¯†è¦ç”¨äºä¸ºå·¥å…·é›†æ¸²æŸ“ä¸åŒæ§ä»¶çš„ Slate APIã€‚

æˆ–è€…é”®å…¥ Ctrl + Shift + W æˆ–åœ¨æ§åˆ¶å°ä¸­è¾“å…¥ WidgetReflector ä»¥æ‰“å¼€å·¥å…·ã€‚

Slate çš„åˆè¡·æ¥è‡ªå¯¹ç°æœ‰å¯ç”¨ UI è§£å†³æ–¹æ¡ˆçš„å®¡è§†ã€‚

åœ¨å¤šæ•°å·¥å…·åŒ…ä¸­ä»æ§ä»¶æ„å»º UI å·²ééš¾å¤„ã€‚è€Œéš¾å¤„åœ¨äºï¼š

- UI è®¾è®¡å’Œè¿­ä»£ã€‚
- æ§åˆ¶æ•°æ®æµï¼šé€šå¸¸è§†ä¸ºæ§ä»¶ï¼ˆè§†å›¾ï¼‰å’ŒåŸºå±‚æ•°æ®ï¼ˆæ¨¡å‹ï¼‰ä¹‹é—´çš„ç»‘å®šã€‚
- å­¦ä¹ æè¿° UI çš„å…¶ä»–è¯­è¨€ã€‚

IMGUI ç›´æ¥æ¨¡å¼å›¾å½¢ç”¨æˆ·ç•Œé¢ä¼˜ç‚¹ï¼š

- ç¨‹åºå‘˜å–œæ¬¢ UI æè¿°"æ¥è¿‘"ä»£ç ï¼Œæ˜“äºè·å–æ•°æ®ã€‚
- å¤±æ•ˆä¸ä¼šæˆä¸ºé—®é¢˜ï¼Œç›´æ¥è½®è¯¢æ•°æ®å³å¯ã€‚
- æ˜“äºç¨‹åºåŒ–æ„å»ºç•Œé¢ã€‚

IMGUI çš„ç¼ºç‚¹ï¼š

- æ·»åŠ åŠ¨ç”»å’Œè®¾è®¡è¾ƒéš¾ã€‚
- UI æè¿°ä¸ºå‘½ä»¤å¼ä»£ç ï¼Œå› æ­¤æ— æ³•å°†å…¶è®¾ä¸ºæ•°æ®é©±åŠ¨ã€‚

æ‰€éœ€çš„ Slate ç‰¹æ€§ï¼š

- æ˜“äºè®¿é—®æ¨¡å‹çš„ä»£ç å’Œæ•°æ®ã€‚
- æ”¯æŒç¨‹åºåŒ– UI ç”Ÿæˆã€‚
- UI æè¿°ä¸æ˜“å‡ºé”™ã€‚
- æ”¯æŒåŠ¨ç”»å’Œè®¾è®¡ã€‚

æ ¸å¿ƒåŸåˆ™æ—¨åœ¨è®¾è®¡å°½é‡æé«˜å¼€å‘æ•ˆç‡ï¼Œç¨‹åºå‘˜çš„æ—¶é—´å¾ˆå®è´µï¼Œè€Œ CPU å¿«é€Ÿä¸”å¼€é”€è¾ƒä½ã€‚

- é˜²æ­¢ä¸é€æ˜ç¼“å­˜å’Œé‡å¤çŠ¶æ€ã€‚ä»¥å¾€ï¼ŒUI ç¼“å­˜çŠ¶æ€å¹¶è¦æ±‚æ˜¾å¼å¤±æ•ˆã€‚Slate ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼ˆæŒ‰ä¼˜å…ˆåˆ°éä¼˜å…ˆæ’åˆ—ï¼‰ï¼š
    - è½®è¯¢
    - é€æ˜ç¼“å­˜
    - å¸¦ç²—ç²’åº¦å¤±æ•ˆçš„ä¸é€æ˜ç¼“å­˜
- UI ç»“æ„å˜åŒ–æ—¶ä¼˜å…ˆè½®è¯¢åˆ°é€šçŸ¥ã€‚ï¼ˆéœ€è¦é€šçŸ¥æ—¶ï¼Œä¼˜å…ˆç²—ç²’åº¦é€šçŸ¥åˆ°ç»†ç²’åº¦é€šçŸ¥ã€‚ï¼‰
- æ”¾ç½®åé¦ˆå¾ªç¯ã€‚ä¸¾ä¾‹è€Œè¨€ï¼Œæ‰€æœ‰å¸ƒå±€å‡ä»ç¨‹åºå‘˜è®¾ç½®è®¡ç®—ï¼Œä¸ä¼šä¾èµ–äºä¹‹å‰çš„å¸ƒå±€çŠ¶æ€ã€‚
    - UI çŠ¶æ€æˆä¸ºæ¨¡å‹æ˜¯å”¯ä¸€çš„ä¾‹å¤–ã€‚ä¾‹å¦‚æ»šåŠ¨æ¡å¯è§ UI çŠ¶æ€ã€‚
    - æ“ä½œç›®çš„æ˜¯é’ˆå¯¹æ­£ç¡®æ€§å’Œç¨‹åºå®Œæ•´æ€§ï¼Œè€Œéæ€§èƒ½ã€‚
- ä¸ºéœ€è¦å¤§é‡ä¸€æ¬¡æ€§æ“ä½œçš„å‡Œä¹± ad-hoc å¼ UI åšå¥½è®¡åˆ’ã€‚ç†è§£ä½¿ç”¨æƒ…å†µåï¼Œå°†å®ƒä»¬å½’çº³åˆ°ä¸€ä¸ªè¾ƒå¥½çš„ç³»ç»Ÿä¸­ã€‚

Slate æ˜¯ä¸€ä¸ª IMGUI å³æ—¶æ¨¡å¼çš„ UI æ¡†æ¶ï¼Œè¿™æ„å‘³ç€å®ƒä¼šåœ¨æ¯ä¸€å¸§ä¸­é‡æ–°ç»˜åˆ¶æ•´ä¸ª UIã€‚è¿™å¯¹äºå…·æœ‰ä¸°å¯Œçš„å›¾å½¢å’ŒåŠ¨ç”»çš„åŠ¨æ€æ¥å£éå¸¸æœ‰ç”¨ï¼Œä½† å½“ UI ä¸­æ— éœ€æ›´æ”¹ä»»ä½•å†…å®¹æ—¶ï¼Œä¼šå¯¼è‡´ä¸å¿…è¦çš„å¤„ç†å™¨ä½¿ç”¨ã€‚åœ¨ Slate ä¸­ä½¿ç”¨æ´»è·ƒå®šæ—¶å™¨ç³»ç»Ÿå…è®¸å®ƒåœ¨ æ— éœ€æ›´æ–° UI æ—¶è¿›å…¥ä¼‘çœ çŠ¶æ€ã€‚åœ¨ç¼–è¾‘å™¨ UI ä¸Šå·¥ä½œæ—¶åº”è¯¥ä½¿ç”¨æ´»è·ƒå®šæ—¶å™¨åŠŸèƒ½ï¼Œè€Œåœ¨ UI ä¸Šä½¿ç”¨å®æ—¶è§†å£è¿›è¡Œæ¸¸æˆå·¥ä½œæ—¶åˆ™ä¸åº”è¯¥ä½¿ç”¨è¯¥åŠŸèƒ½ã€‚

å¯¹äºç»™å®šå¸§ï¼ŒåŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶æ—¶ï¼ŒSlate å°±ä¼šä¼‘çœ ï¼š

- æ²¡æœ‰ç”¨æˆ·æ“ä½œï¼Œç”¨æˆ·æ“ä½œä¸ºä»»ä½•é¼ æ ‡ç§»åŠ¨ã€å•å‡»æˆ–æŒ‰é”®ã€‚
- æ— éœ€æ‰§è¡Œ Active Timers æ´»è·ƒå®šæ—¶å™¨


Slate æ§ä»¶å¯ä»¥ç”¨äºåœ¨æ¸¸æˆä¸­åˆ›å»ºå¹³å¤´æ˜¾ç¤ºä¿¡æ¯(HUD)æˆ–å…¶ä»–ç”¨æˆ·ç•Œé¢(UI)å…ƒç´ ï¼Œ æ¯”å¦‚èœå•ã€‚ä½ ä¸€èˆ¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨æ§ä»¶ï¼Œæ¯ä¸ªå®¹å™¨å¯ä»¥åŒ…å«å‡ ä¸ªå…¶ä»–ç±»å‹çš„æ§ä»¶ï¼Œ è¿™äº›æ§ä»¶è´Ÿè´£ç”¨æˆ·ç•Œé¢çš„ç‰¹å®šæ–¹é¢ã€‚

æ¯”å¦‚ï¼Œä½ å¯èƒ½å…·æœ‰ä¸€ä¸ªé’ˆå¯¹æ¸¸æˆ HUD çš„æ€»ä½“æ§ä»¶ï¼ŒåŒæ—¶å…·æœ‰é’ˆå¯¹ä¸»èœå•ã€ é€‰é¡¹èœå•ã€æš‚åœèœå•ã€è®°åˆ†æ¿ç­‰çš„å„ç§æ§ä»¶ã€‚æ¯ç§æ§ä»¶åˆå¯èƒ½ç”±å…¶ä»– è‡ªå®šä¹‰æ§ä»¶ã€æ ‡ç­¾ã€æ–‡æœ¬æ¡†ã€å›¾ç‰‡åŠå…¶ä»–ç±»å‹çš„å…ƒç´ æ„æˆã€‚

ç„¶åï¼Œå¯ä»¥æ ¹æ®æ¸¸æˆæƒ…å¢ƒæ·»åŠ æˆ–åˆ é™¤è¿™äº›å®¹å™¨æ§ä»¶ï¼š

- å½“æ¸¸æˆå¯åŠ¨æ—¶ï¼Œå°†æ·»åŠ ä¸»èœå•æ§ä»¶ã€‚
- å½“ä»–ä»¬é€‰æ‹©èœå•ä¸­çš„å…¶ä¸­ä¸€ä¸ªé€‰é¡¹æ—¶ - å¯èƒ½æ˜¯å¯åŠ¨æ¸¸æˆ - é‚£ä¹ˆä¸»èœå•æ§ä»¶å°†ä¼šè¢«åˆ é™¤ã€‚
- å¦‚æœç©å®¶åœ¨ä»»ä½•æ—¶å€™æš‚åœäº†æ¸¸æˆï¼Œé‚£ä¹ˆå°†ä¼šæ·»åŠ æš‚åœèœå•æ§ä»¶ã€‚
- å½“æ¸¸æˆç»§ç»­æ—¶ï¼Œå°†ä¼šåˆ é™¤æš‚åœèœå•æ§ä»¶ã€‚
- å½“ä¸ºç©å®¶åˆå§‹åŒ–äº† HUD æ—¶ï¼Œå°†ä¼šæ·»åŠ  HUD æ§ä»¶ã€‚

ä½¿ç”¨ Slate UI æ¡†æ¶ï¼Œå¿…é¡»æ­£ç¡®è®¾ç½®é¡¹ç›®ï¼Œä»¥ä¾¿å®ƒèƒ½è¯†åˆ«å‡ºæ¡†æ¶ã€‚æ·»åŠ  Slate.h å¤´æ–‡ä»¶å¹¶å¼•ç”¨æ¡†æ¶ä¸­çš„å„ç§å…ƒç´  ä»è€Œæ„å»º Slate UIã€‚

Slate æ¡†æ¶ä¿å­˜åœ¨è‹¥å¹²ä¸ªæ¨¡å—ä¸­ï¼Œå¿…é¡»åœ¨ `*.build.cs` æ–‡ä»¶ä¸­ä¸ºé¡¹ç›®è®¾ç½®è¿™äº›ä¾èµ–é¡¹ã€‚

ä»¥ä¸‹æ˜¯ä½ çš„é¡¹ç›®éœ€è¦è®¿é—®çš„æ¨¡å—åŠå…¶ä¾èµ–é¡¹ç±»å‹ï¼š

- InputCore å…¬æœ‰
- Slate ç§æœ‰
- SlateCore ç§æœ‰

è®¾ç½® Slate æ¨¡å—çš„ä¾èµ–é¡¹ï¼š

æ‰“å¼€ä½ çš„é¡¹ç›®çš„ build.cs æ–‡ä»¶ï¼Œä½äº Source ç›®å½•ä¸­ã€‚

æ·»åŠ  InputCore å…¬æœ‰ä¾èµ–é¡¹ï¼š

    PublicDependencyModuleNames.AddRange(new string[] { "Core", "CoreUObject", "Engine", "InputCore" });

ä»£ç ç±»é¡¹ç›®è¢«åˆ›å»ºæ—¶ï¼ŒInputCore æ¨¡å—ä¼šè¢«é»˜è®¤è®¾ç½®ä¸ºå…¬æœ‰ä¾èµ–é¡¹ã€‚

æ·»åŠ  Slate å’Œ SlateCore ç§æœ‰ä¾èµ–é¡¹ï¼š

    PrivateDependencyModuleNames.AddRange(new string[] { "Slate", "SlateCore" });


## âš¡ Slate ç»„ä»¶å¼€å‘
- Unreal UIs and C++: Slate https://benui.ca/unreal/ui-cpp-slate/
- Creating new UWidgets in C++ https://benui.ca/unreal/ui-cpp-uwidget/

å’Œå°è£… Slate UI å®ç°çš„ UMG UI ä¸åŒï¼ŒSlate UI æ¡†æ¶çš„è¯­æ³•æ›´ç‰¹åˆ«ï¼Œæˆ–è€…è¯´æ›´ä¸åƒ C++ ä»£ç ã€‚

ä»¥ä¸‹ç¤ºèŒƒå¦‚ä½•å®šä¹‰ä¸€ä¸ªå¸¦æœ‰å›¾æ ‡å’Œæ–‡æœ¬çš„æŒ‰é’®ï¼š

```C++
SNew( SButton )
+ SButton::Slot()
[
    SNew( SHorizontalBox )
    + SHorizontalBox::Slot()
        .VAlign( VAlign_Center )
        .HAlign( HAlign_Center )
    [
        SNew( SImage )
            .Image( MyIconBrush )
    ]
    + SHorizontalBox::Slot()
        .VAlign( VAlign_Center )
        .HAlign( HAlign_Fill )
    [
        SNew( STextBlock )
            .Text( FText::FromString( "Click me!" ) )
    ]
]
```

å¦‚ä½•å·²ç»äº†è§£å¦‚ä½•ç”¨ C++ æ‰©å±• UMG ç»„ä»¶ï¼Œè¿™äº›ä»£ç çœ‹èµ·æ¥ä¼šæœ‰ç‚¹çœ¼ç†Ÿï¼š

- æ³¨æ„ + å·è¿™ä¸ªè¿ç®—ç¬¦ï¼Œå®ƒè¡¨ç¤ºå°†ç»„ä»¶æ’åˆ—åœ¨ä¸€èµ·ã€‚
- *SButton* æ˜¯ Slate æ„æ¶ä¸­çš„æŒ‰é’®ç»„ä»¶ã€‚
- SButton::Slot() è¡¨ç¤ºä¸€ä¸ªå¯ä»¥æ”¾ç½®å…¶å®ƒç»„ä»¶çš„æ§½ä½ï¼Œå®ƒå«æœ‰å„ç§å‚æ•°ï¼Œå¯ä»¥åœ¨è“å›¾ç¼–è¾‘å™¨ä¸­æŸ¥çœ‹ã€‚
- *SHorizontalBox* æ˜¯æ°´å¹³å¸ƒå±€æ ¼å­ï¼Œç­‰ä»· UMG UHorizontalBoxã€‚

äº‹å®ä¸Šï¼ŒSButton ä¸ç­‰ä»· UButtonï¼Œä½†æ˜¯ UMG é€šè¿‡åŒ…è£… SButton æ¥å®ç° UButtonï¼š

```C++,
    class UButton : public UVisual
    {
    // ...
        /** Cached pointer to the underlying slate
            button owned by this UWidget */
        TSharedPtr<SButton> MyButton;
    };
```

æ‰©å±•ç°æœ‰çš„ Slate ç»„ä»¶ä½¿ç”¨çš„ C++ ä»£ç åˆä¸€çœ‹æ˜¯æœ‰ç‚¹æ€ªçš„ï¼Œå®ƒå’Œ UE å¼•æ“ä¸€æ ·ä½¿ç”¨äº†å¤šç§å®å®šä¹‰ã€‚

å­¦ä¹  Slate æœ€å¥½çš„æ–¹æ³•å°±æ˜¯ï¼Œå¤åˆ¶å’Œæ‰©å±•ç°æœ‰çš„å°éƒ¨ä»¶ã€‚ä¾‹å¦‚ï¼Œåˆ›å»ºä¸€ä¸ªæ”¯æŒå¤šä¸ªå›¾åƒçš„ SImageï¼Œè®©è¿™äº›å›¾åƒç›¸äº’å åŠ ã€‚

å» Unreal Engine å®‰è£…ç›®å½•æ‰“å¼€ SImage çš„æºä»£ç ï¼Œè¯•ç€é˜…è¯»ï¼ŒæŒæ§å…³é”®çš„ä¿¡æ¯ï¼š

```C++,
    SLATE_BEGIN_ARGS( SImage )
        : _Image( FCoreStyle::Get().GetDefaultBrush() )
        , _ColorAndOpacity( FLinearColor::White )
        , _FlipForRightToLeftFlowDirection( false )
        { }

        /** Image resource */
        SLATE_ATTRIBUTE(const FSlateBrush*, Image)

        /** Color and opacity */
        SLATE_ATTRIBUTE(FSlateColor, ColorAndOpacity)

        /** When specified, ignore the brushes size and report the DesiredSizeOverride as the desired image size. */
        SLATE_ATTRIBUTE(TOptional<FVector2D>, DesiredSizeOverride)

        /** Flips the image if the localization's flow direction is RightToLeft */
        SLATE_ARGUMENT( bool, FlipForRightToLeftFlowDirection )

        /** Invoked when the mouse is pressed in the widget. */
        SLATE_EVENT(FPointerEventHandler, OnMouseButtonDown)
    SLATE_END_ARGS()
```

- æ„é€ å™¨å¦‚ä½•åˆå§‹åŒ– Slate ç»„ä»¶ï¼›
- *SLATE_BEGIN_ARGS* å®è¡¨ç¤ºåç»­å¯ä»¥å¼€å§‹å®šä¹‰ç»„ä»¶å±æ€§ã€‚
- *OnPaint* ç»„å›¾å‡½æ•°å†³å®šäº†ç»„ä»¶å‘ˆç°ä»€ä¹ˆæ ·å­ã€‚

å°è¯•æ‰©å±•ä¸€ä¸ªç»„ä»¶ï¼Œå¯ä»¥é€‰æ‹©å„ç§ç°æœ‰çš„ç»„ä»¶ä½œä¸ºçˆ¶ç±»ï¼ŒSLeafWidgetã€SPanelï¼Œæˆ–è€… SCompoundWidget è¿™ä¸ªæœ€ä¸ºé€šå¸¸çš„ç»„ä»¶ã€‚

ä»¥ä¸‹æ˜¯ ExampleSlate.h ç¤ºèŒƒï¼š

```C++,
    #pragma once

    #include "CoreMinimal.h"

    class SExampleSlate : public SCompoundWidget
    {
        SLATE_BEGIN_ARGS(SStandardSlateWidget){}

        // See private declaration of OwnerHUD below.
        SLATE_ARGUMENT(TWeakObjectPtr<class AStandardHUD>, OwnerHUD)
     
        SLATE_END_ARGS()
     
    public:
      // Required
        void Construct(const FArguments& InArgs);

        // Begin SWidget interface
        void OnArrangeChildren(const FGeometry& AllottedGeometry, FArrangedChildren& ArrangedChildren) const override;
        virtual FReply OnMouseMove(const FGeometry& MyGeometry, const FPointerEvent& MouseEvent) override;
        virtual void Tick(const FGeometry& AllottedGeometry, const double InCurrentTime, const float InDeltaTime) override;
        // End SWidget interface

     
    private:
        TWeakObjectPtr<class AStandardHUD> OwnerHUD;
    };
```

åœ¨è¿™ä¸ªåˆ—å­ä¸­ï¼Œå¹¶ä¸èƒ½ç›´æ¥ä½“ç°ä½¿ç”¨ C++ æ‰©å±• Slate UI æ¯” UMG UI çš„å¼ºå¤§ä¹‹å¤„ã€‚ 

ç„¶è€Œï¼Œå¯¹äºåŸå§‹çš„ã€æ›´å¤æ‚çš„è¡Œä¸ºï¼Œä¸èƒ½åˆ†è§£ä¸ºç°æœ‰ Slate ç»„ä»¶çš„éœ€æ±‚ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ Slate ç»„ä»¶æ˜¯æ‚¨å”¯ä¸€çš„é€‰æ‹©ã€‚




## âš¡ SWidget ç±»å±‚æ¬¡ç»“æ„
- Slate åˆæ¢: Editor UI https://www.cnblogs.com/shiroe/p/14826787.html

SNew å’Œ SAssignNew

- SNew( SlateWidget )ï¼Œè¿”å›æ™ºèƒ½å¼•ç”¨ *TSharedRef*ï¼›
- SNew( SWeakWidget ).PossiblyNullContent()ï¼›
- SAssignNew( TSharedPtr<SlateWidget>ï¼ŒSlateWidgetï¼‰ï¼Œè¿”å›æ™ºèƒ½æŒ‡é’ˆ *TSharedPtr*ï¼›
- SAssignNew( SWidget, SWeakWidget).PossiblyNullContent()ï¼›

Slate æ¡†æ¶é€»è¾‘å±‚æ¨¡å— Slateã€SlateCoreï¼Œæ¸²æŸ“æ¨¡å— SlateRHIRendererã€‚UI åŸºç±»æ˜¯ *SWidget*ã€‚æ§½ä½ Slot å¯ä»¥æ”¾ç½® SWidgetã€‚


                                +=========+
                                | SWidget |
                                +=========+

                                     |
                  +------------------+-------------+---------------------------------------+
                  |                                |                                       |
            +=====v=====+                 +========v========+                       +======v======+
            |  SPanel   |                 | SCompoundWidget |                       | SLeafWidget |
            +===========+                 +=================+                       +=============+
                  |                                |                                       |
          +-------+-------+              +---------+---------+                +------------+
          |               |              |                   |                |
    +=====v=====+   +=====v====+    +====v====+       +======v======+     +===v====+
    | SBoxPanel |   | SOverlay |    | SWindow |       | SUserWidget |     | SImage |
    +===========+   +==========+    +=========+       +=============+     +========+
          |                                                                   |
          |  +==============+                                         +=======v=======+
          +--| SVerticalBox |                                         | SLayeredImage |
          |  +==============+                                         +===============+
          |  +==============+  
          +--| SVerticalBox |   
             +==============+

    +=======================+
    | FSlateApplicationBase |
    +=======================+
                |
      +=========v=========+
      | FSlateApplication |
      +===================+



## âš¡ Widget Adding/Removing

æ¸¸æˆè§†å£æ˜¯ `GameViewportClient` ç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚å½“å‰æ¸¸æˆè§†å£çš„å¼•ç”¨å¯ä»¥é€šè¿‡ `GameViewport` æˆå‘˜è·å¾—ï¼Œè¯¥æˆå‘˜å¯ä»¥é€šè¿‡ä½¿ç”¨åˆ°æ¸¸æˆå½“å‰ UEngine å®ä¾‹ çš„`GEngine` æŒ‡é’ˆè®¿é—®ã€‚

å› ä¸º GEngine å’Œ GameViewport éƒ½å¯ä»¥ä¸º NULL ï¼Œæ‰€ä»¥åœ¨ä½ å°è¯•è®¿é—®å®ƒä»¬æˆ–è€… å…¶ä»»ä½•æˆå‘˜æ—¶ï¼Œæ€»æ˜¯åº”è¯¥åˆ¤æ–­å®ƒä»¬çš„å€¼ã€‚

Slate æ§ä»¶é€šè¿‡å‘ GameViewportClient::AddViewportWidgetContent() ä¼ å…¥ä¸€ä¸ªæ§ä»¶çš„å…±äº«å¼•ç”¨ï¼Œç¡®åˆ‡åœ°è¯´æ˜¯ `TSharedref<SWidget>` æ¥æ·»åŠ åˆ°è§†å£ä¸­ã€‚è¯¥å‡½æ•°å–å…¥ä¸€ä¸ªæ§ä»¶å’Œ Z-Order å³å†³å®šæ–°æ§ä»¶çš„æ’åˆ—é¡ºåºï¼ŒZ æ’åºæ˜¯å¯é€‰çš„ï¼Œå…¶é»˜è®¤å€¼ä¸º 0ã€‚

åˆ°ä½ æƒ³æ·»åŠ åˆ°è§†å£ä¸­çš„æ§ä»¶çš„å¼•ç”¨å¯ä»¥å­˜å‚¨ä¸ºæŸä¸ªç±»çš„ä¸€ä¸ªæˆå‘˜ï¼Œæ¯”å¦‚ä½ çš„ HUDï¼Œ æˆ–è€…å¯ä»¥åœ¨è°ƒç”¨è¯¥å‡½æ•°æ—¶åˆ›å»ºåŠä¼ å…¥è¯¥æ§ä»¶ã€‚

ä¼ å…¥ä¸€ä¸ªå­˜å‚¨åœ¨æˆå‘˜å˜é‡ä¸­çš„æ§ä»¶å¼•ç”¨ TSharedPtrï¼š

```cpp
GEngine->GameViewport->AddViewportWidgetContent(
    SNew(MyWidgetPtr.ToSharedRef())
);
```

å½“å°†æ§ä»¶ä¼ å…¥åˆ° GameViewportClient::AddViewportWidgetContent() æ—¶ä½¿ç”¨ SNew() åˆ›å»ºè¯¥æ§ä»¶ï¼š

```cpp
GEngine->GameViewport->AddViewportWidgetContent(
    SNew(SWeakWidget)
    .PossiblyNullContent(MyWidgetClass)
); 
```

æˆ–è€…ä½¿ç”¨ SAssignNew() æ¥åˆ›å»ºæ§ä»¶ï¼Œå¹¶å°†å®ƒåˆ†é…ç»™ TSharedPtr æˆå‘˜ï¼Œç„¶åä¼ å…¥å®ƒï¼š

```cpp
GEngine->GameViewport->AddViewportWidgetContent(
    SAssignNew(MyWidgetPtr, SWeakWidget)
    .PossiblyNullContent(MyWidgetClass)
);
```

å¯ä»¥ä»è§†å£ä¸­å•ç‹¬åœ°åˆ é™¤ Slate æ§ä»¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨ RemoveAllViewportWidgets() åˆ é™¤æ‰€æœ‰æ§ä»¶ã€‚

```cpp
GEngine->GameViewport->RemoveAllViewportWidgets();
GEngine->GameViewport->RemoveViewportWidgetContent(
    SNew(MyWidgetPtr.ToSharedRef())
);
```



## âš¡ HUD & Slate UI ç»˜åˆ¶

æ„æ¶æä¾›çš„ç¤ºèŒƒå‚è€ƒä»£ç  UE_5.0EA\Engine\Source\Runtime\AppFramework\Private\Framework\Testing\SLayoutExample.cpp ...

ä½¿ç”¨è“å›¾æ‰©å±•åˆ›å»º GameModeBaseï¼Œå‘½åä¸º *MyGameMode_BP*ï¼Œå¹¶é…ç½®ä¸ºå½“å‰å…³å¡çš„ GameModeï¼š

- å…³å¡ World Setting->GameMode Override è®¾ç½®ä¸º MyGameMode_BP
- è®¾å®š HUDClass ä¸º AMyHUDï¼›

åˆ›å»º HUD æ´¾ç”Ÿç±»ï¼šAMyHUD

```C++,
    #pragma once
    #include "CoreMinimal.h"
    #include "GameFramework/HUD.h"
    #include "MyHUD.generated.h"
    UCLASS()
    class DESIGNPATTERNS_API AMyHUD : public AHUD
    {
        GENERATED_BODY()
    public:
        virtual void BeginPlay() override;

        void ShowMySlate();
        void RemoveMySlate();

        // ä½¿ç”¨ class å£°æ˜ï¼Œæ²¡æœ‰ include å¤´æ–‡ä»¶
        TSharedPtr<class SMyCompoundWidget> MyCompoundWidget;

        // æ·»åŠ è§†å£æ–¹æ³•ä¸‰
        TSharedPtr<SWidget> WidgetContainer;
    };

    #pragma once
    #include "MyHUD.h"
    #include "Kismet/GameplayStatics.h"
    #include "SMyCompoundWidget.h"
    #include "Widgets/SWeakWidget.h"

    void AMyHUD::BeginPlay()
    {
        Super::BeginPlay();
        ShowMySlate();
    }

    void AMyHUD::ShowMySlate()
    {
        if (GEngine && GEngine->GameViewport)
        {
            // ç¬¬äºŒä¸ªå‚æ•°ä¸º ZOrder,é»˜è®¤ä¸º 0
            //GEngine->GameViewport->AddViewportWidgetContent(SNew(SMyCompoundWidget), 0);
            //GEngine->GameViewport->AddViewportWidgetContent(SAssignNew(MyCompoundWidget, SMyCompoundWidget));
            
            MyCompoundWidget = SNew(SMyCompoundWidget).OwnerHUDArg(this);
            //SAssignNew(MyCompoundWidget, SMyCompoundWidget);

            // æ·»åŠ è§†å£æ–¹æ³•ä¸€ï¼Œå¯è¢«ç§»é™¤
            //GEngine->GameViewport->AddViewportWidgetContent(MyCompoundWidget.ToSharedRef());

            // æ·»åŠ è§†å£æ–¹æ³•äºŒï¼Œæ­¤å¤„æ— æ³•ç§»é™¤ï¼Œå› ä¸º weak widget
            //GEngine->GameViewport->AddViewportWidgetContent( SNew(SWeakWidget).PossiblyNullContent(MyCompoundWidget.ToSharedRef()), 0);
            
            // æ·»åŠ è§†å£æ–¹æ³•ä¸‰ï¼Œå¯è¢«ç§»é™¤
            GEngine->GameViewport->AddViewportWidgetContent(
                SAssignNew(WidgetContainer,SWeakWidget).PossiblyNullContent(MyCompoundWidget.ToSharedRef()), 0);

            // æ˜¾ç¤ºé¼ æ ‡åŠè®¾ç½®è¾“å…¥æ¨¡å¼
            APlayerController* PC = UGameplayStatics::GetPlayerController(GetWorld(), 0);
            if (PC)
            {
                PC->bShowMouseCursor = true;
                PC->SetInputMode(FInputModeUIOnly());
            }
        }
    }

    void AMyHUD::RemoveMySlate()
    {
        if (GEngine && GEngine->GameViewport && WidgetContainer.IsValid())
        {
            // ç§»é™¤æ·»åŠ è§†å£æ–¹æ³•ä¸€
            GEngine->GameViewport->RemoveViewportWidgetContent(MyCompoundWidget.ToSharedRef());
            
            // ç§»é™¤æ·»åŠ è§†å£æ–¹æ³•ä¸‰
            GEngine->GameViewport->RemoveViewportWidgetContent(WidgetContainer.ToSharedRef());
            
            // ç§»é™¤æ‰€æœ‰
            //GEngine->GameViewport->RemoveAllViewportWidgets();
            
            // æ˜¾ç¤ºé¼ æ ‡åŠè®¾ç½®è¾“å…¥æ¨¡å¼
            APlayerController* PC = UGameplayStatics::GetPlayerController(GetWorld(), 0);
            if (PC)
            {
                PC->bShowMouseCursor = false;
                PC->SetInputMode(FInputModeGameOnly());
            }
        }
    }
```

åˆ›å»º SCompoundWidget æ´¾ç”Ÿç±»ï¼šSMyCompoundWidget

```C++,
    #include "CoreMinimal.h"
    #include "Widgets/SCompoundWidget.h"
    #include "MyHUD.h"

    /**
     * 
     */
    class DESIGNPATTERNS_API SMyCompoundWidget : public SCompoundWidget
    {
    public:
        SLATE_BEGIN_ARGS(SMyCompoundWidget)
        {}
        // æ·»åŠ å‚æ•°
        SLATE_ARGUMENT(TWeakObjectPtr<AMyHUD>, OwnerHUDArg);
        SLATE_END_ARGS()

        /** Constructs this widget with InArgs */
        void Construct(const FArguments& InArgs);

        FReply OnPlayClicked() const;
        FReply OnQuitClicked() const;

    private:
        TWeakObjectPtr<AMyHUD> OwnerHUD;
    };

    #include "SMyCompoundWidget.h"
    #include "SlateOptMacros.h"
    #include "Widgets/Images/SImage.h"
    #include "MyHUD.h"
    #include "Kismet/KismetSystemLibrary.h"
    #include "Kismet/GameplayStatics.h"
    #include "Widgets/Layout/SBackgroundBlur.h"
    #define LOCTEXT_NAMESPACE "MyNamespace"

    BEGIN_SLATE_FUNCTION_BUILD_OPTIMIZATION
    void SMyCompoundWidget::Construct(const FArguments& InArgs)
    {
        // æ³¨æ„æ­¤å¤„å¸¦ä¸‹åˆ’çº¿
        OwnerHUD = InArgs._OwnerHUDArg;
        // æ–‡æœ¬å’ŒæŒ‰é’®é—´è·è®¾ç½®
        const FMargin ContentPadding = FMargin(500.0f, 300.0f);
        const FMargin ButtonPadding = FMargin(10.f);
        // æŒ‰é’®å’Œæ ‡é¢˜æ–‡æœ¬
        const FText TitleText = LOCTEXT("SlateTest", "Just a Slate Test");
        const FText PlayText = LOCTEXT("PlayGame", "Play");
        const FText QuitText = LOCTEXT("QuitGame", "Quit Game");
        //æŒ‰é’®å­—ä½“åŠå¤§å°è®¾ç½®
        FSlateFontInfo ButtonTextStyle = FCoreStyle::Get().GetFontStyle("EmbossedText");
        ButtonTextStyle.Size = 40.f;
        //æ ‡é¢˜å­—ä½“åŠå¤§å°è®¾ç½®
        FSlateFontInfo TitleTextStyle = ButtonTextStyle;
        TitleTextStyle.Size = 60.f;

        //æ‰€æœ‰UIæ§ä»¶éƒ½å†™åœ¨è¿™é‡Œ
        ChildSlot
            [
                SNew(SOverlay)
                + SOverlay::Slot()
                .HAlign(HAlign_Fill).VAlign(VAlign_Fill)
                [
                    SNew(SImage)    // èƒŒæ™¯ï¼ˆåŠé€æ˜é»‘ï¼‰
                    .ColorAndOpacity(FColor(0,0,0,127))             
                ]

                + SOverlay::Slot()
                .HAlign(HAlign_Fill).VAlign(VAlign_Fill)
                [
                    SNew(SBackgroundBlur) // é«˜æ–¯æ¨¡ç³Š
                    .BlurStrength(10.0f)
                ]

                + SOverlay::Slot()
                .HAlign(HAlign_Fill).VAlign(VAlign_Fill)
                .Padding(ContentPadding)
                [
                    SNew(SVerticalBox)

                    // Title Text
                    + SVerticalBox::Slot()
                    [
                        SNew(STextBlock)
                        .Font(TitleTextStyle)
                        .Text(TitleText)
                        .Justification(ETextJustify::Center)
                    ]

                    // Play Button
                    + SVerticalBox::Slot()
                    .Padding(ButtonPadding)
                    [
                        SNew(SButton)
                        .OnClicked(this, &SMyCompoundWidget::OnPlayClicked)
                        [
                            SNew(STextBlock)
                            .Font(ButtonTextStyle)
                            .Text(PlayText)
                            .Justification(ETextJustify::Center)
                        ]
                    ]

                    // Quit Button
                    + SVerticalBox::Slot()
                    .Padding(ButtonPadding)
                    [
                        SNew(SButton)
                        .OnClicked(this, &SMyCompoundWidget::OnQuitClicked)
                        [
                            SNew(STextBlock)
                            .Font(ButtonTextStyle)
                            .Text(QuitText)
                            .Justification(ETextJustify::Center)
                        ]
                    ]
                ]
            ];

        
    }

    FReply SMyCompoundWidget::OnPlayClicked() const
    {
        if (OwnerHUD.IsValid())
        {
            OwnerHUD->RemoveMySlate();
        }
        return FReply::Handled();
    }

    FReply SMyCompoundWidget::OnQuitClicked() const
    {
        if (OwnerHUD.IsValid())
        {
            OwnerHUD->PlayerOwner->ConsoleCommand("quit");  
        }
        return FReply::Handled();
    }

    END_SLATE_FUNCTION_BUILD_OPTIMIZATION

    #undef LOCTEXT_NAMESPACE
```



# ğŸŒŸ Performance & Profiling
- è°ƒæ•´å¼•æ“åŠŸèƒ½çš„çº§åˆ« https://docs.unrealengine.com/4.27/zh-CN/TestingAndOptimization/PerformanceAndProfiling/Options/
- ç¼©å‡æ¸¸æˆåŒ…å®¹é‡ https://docs.unrealengine.com/4.27/zh-CN/TestingAndOptimization/PerformanceAndProfiling/ReducingPackageSize/
- Packaging & Cooking https://docs.unrealengine.com/4.27/zh-CN/SharingAndReleasing/Deployment/
- å¯å»¶å±•æ€§å’Œå¼€å‘äººå‘˜ https://docs.unrealengine.com/4.27/zh-CN/TestingAndOptimization/PerformanceAndProfiling/Scalability/ScalabilityAndYou/
- Console Commands https://docs.unrealengine.com/udk/Two/ConsoleCommands.html
- Unreal Engine 4 Console Variables and Commands https://digilander.libero.it/ZioYuri78/
- æ€§èƒ½ä¸åˆ†ææ¦‚è¿° https://docs.unrealengine.com/4.27/zh-CN/TestingAndOptimization/PerformanceAndProfiling/Overview/
- å¯¹ç«‹ä½“æ¸²æŸ“è¿›è¡Œåˆ†æ https://docs.unrealengine.com/4.27/zh-CN/TestingAndOptimization/PerformanceAndProfiling/ProfilingStereoRendering/
- ç³»ç»Ÿè®¾ç½® https://docs.unrealengine.com/4.27/zh-CN/TestingAndOptimization/PerformanceAndProfiling/SystemSettings/

åœ¨åšæ¸¸æˆçš„è¿‡ç¨‹ä¸­ï¼Œæ€§èƒ½ æ˜¯ä¸ªæ— æ‰€ä¸åœ¨çš„è¯é¢˜ã€‚ä¸ºäº†åˆ›å»ºæ¢¦å¹»èˆ¬çš„ç”»é¢ï¼Œæˆ‘ä»¬éœ€è¦è‡³å°‘æ¸¸æˆå¸§æ•°è‡³å°‘è¾¾åˆ°æ¯ç§’ 15 å¸§ã€‚æ ¹æ®ä¸åŒçš„å¹³å°å’Œæ¸¸æˆç±»å‹ï¼Œè¿™ä¸ªå¸§æ•°å¯èƒ½æ˜¯ 30 æˆ–è€… 60ï¼Œç”šè‡³åœ¨æŸäº›æƒ…å†µä¸‹è¦æ±‚æ›´é«˜ã€‚

è™šå¹»å¼•æ“æä¾›äº†å¾ˆå¤šåŠŸèƒ½ï¼Œå®ƒä»¬ä¹Ÿæœ‰ä¸åŒçš„æ€§èƒ½ç‰¹æ€§ã€‚ä¸ºäº†è¾¾åˆ°æ€§èƒ½çš„è¦æ±‚ä¼šéœ€è¦å¯¹æ¸¸æˆç´ æå’Œä»£ç è¿›è¡Œä¼˜åŒ–ã€‚å› æ­¤éœ€è¦èƒ½å¤ŸçŸ¥é“æ€§èƒ½èŠ±è´¹åœ¨ä½•å¤„ã€‚è¿™ä¸€ç‚¹å¯ä»¥é€šè¿‡ä½¿ç”¨å¼•æ“çš„æ€§èƒ½åˆ†æå·¥å…·ã€‚ æ¯ä¸ªæ€§èƒ½é—®é¢˜éƒ½å¯èƒ½æ˜¯ä¸åŒçš„ï¼Œéœ€è¦å¯¹å½“å‰çš„ç¡¬ä»¶ã€è½¯ä»¶éƒ½æœ‰ä¸€å®šçš„äº†è§£ã€‚

æœ¬æŒ‡å—ä¸»è¦é˜è¿°æ¸²æŸ“ä¸»é¢˜ï¼Œå› ä¸ºè¿™æ˜¯å¯¹æ€§èƒ½è¦æ±‚æœ€é«˜çš„åŒºåŸŸã€‚æ·»åŠ æ›´å¤šå¯¹è±¡ã€æé«˜åˆ†è¾¨ç‡ã€æ·»åŠ ç…§æ˜ä»¥åŠæ”¹è¿›æè´¨éƒ½ä¼š å¯¹æ€§èƒ½äº§ç”Ÿå®è´¨å½±å“ã€‚å¹¸è¿çš„æ˜¯ï¼Œåœ¨æ¸²æŸ“ä¸­ï¼Œé€šå¸¸å¾ˆå®¹æ˜“æ¢å¤ä¸€å®šçš„æ€§èƒ½ã€‚è®¸å¤šæ¸²æŸ“åŠŸèƒ½å¯é€šè¿‡æ§åˆ¶å°å˜é‡è¿›è¡Œè°ƒæ•´ã€‚

æ‚¨å¯ä½¿ç”¨ç¼–è¾‘å™¨è¾“å‡ºæ—¥å¿—æˆ–æ¸¸æˆæ§åˆ¶å°æ¥å®Œæˆä¸‹åˆ—æ“ä½œï¼š

- è®¾ç½®æ§åˆ¶å°å˜é‡ (cvarname value)
- è·å–å½“å‰çŠ¶æ€ (cvarname)
- è·å–å˜é‡çš„å¸®åŠ© (cvarname ?)ã€‚

Stat å‘½ä»¤ï¼ˆä¾‹å¦‚ *stat unit* å’Œ *stat fps*ï¼‰å¯ä»¥ä¸ºæ‚¨æä¾›ä¸€äº›èµ·æ­¥æ•°å€¼ã€‚å‡†ç¡®çš„æ¦‚è¦åˆ†æåº”è¯¥ä»¥æ¯«ç§’ (ms) è€Œé æ¯ç§’å¸§æ•° (fps) ä¸ºå•ä½æ¥æ‰§è¡Œã€‚æ‚¨å¯åœ¨æ•°å€¼ä¹‹é—´è½»æ¾å®Œæˆè½¬æ¢ï¼Œä½†ä»¥ fps ä¸ºå•ä½è¿›è¡Œæµ‹é‡æ—¶ï¼Œç›¸å¯¹çš„æ”¹å–„æ²¡æœ‰å¤šå¤§æ„ä¹‰ã€‚åœ¨è®¨è®ºä¸ªåˆ«çš„åŠŸèƒ½æ—¶ï¼Œæˆ‘ä»¬çš„è®¨è®º æ˜¯ä»¥æ¯«ç§’ä¸ºå•ä½ï¼Œå› ä¸ºå®ƒä¸ä¼šæµ‹é‡å¸§ã€‚

å¦‚æœæ‚¨çœ‹åˆ° 30 fps (~33.3ms) æˆ– 60 fps (~16.6ms) çš„é™åˆ¶ï¼Œé‚£ä¹ˆå¯èƒ½å·²å¯ç”¨ VSyncã€‚ä¸ºäº†æ›´å‡†ç¡®åœ°è¿›è¡Œè®¡æ—¶ï¼Œæœ€å¥½åœ¨ä¸ä½¿ç”¨è¯¥åŠŸèƒ½çš„æƒ…å†µä¸‹è¿›è¡Œæ¦‚è¦åˆ†æã€‚

æ‚¨ä¸åº”æœŸæœ›åœ¨éå¸¸ç®€å•çš„åœºæ™¯ä¸‹å¯è·å¾—æé«˜çš„å¸§é€Ÿç‡ã€‚è®¸å¤šè®¾è®¡é€‰é¡¹æ”¯æŒå¤æ‚åœºæ™¯ï¼ˆä¾‹å¦‚ï¼Œå»¶è¿Ÿæ¸²æŸ“ï¼‰ï¼Œä½†ä»¥åŸºæœ¬æˆæœ¬è¾ƒé«˜ä¸ºä»£ä»·ã€‚æ‚¨è¿˜å¯èƒ½ä¼šé‡åˆ° é™åˆ¶å¸§é€Ÿç‡çš„å¯¹è±¡ã€‚æœ‰éœ€è¦æ—¶ï¼Œåº”è¯¥å¯¹æ­¤ç±»é€‰é¡¹ï¼ˆä¾‹å¦‚ï¼Œt.MaxFPS å’Œ r.VSyncï¼‰åŠ ä»¥è°ƒæ•´ã€‚

ç¡®å®šé™åˆ¶å› ç´ æ˜¯å‰ææ€§æ¡ä»¶ï¼Œä¼˜åŒ–é”™è¯¯çš„å› ç´ çº¯å±æµªè´¹æ—¶é—´ã€‚

ç°ä»£çš„ç¡¬ä»¶æœ‰è®¸å¤šå¹¶è¡Œè¿è¡Œçš„å•å…ƒï¼ˆä¾‹å¦‚ï¼ŒGPUï¼šå†…å­˜ã€ä¸‰è§’å½¢/é¡¶ç‚¹/åƒç´ å¤„ç†ç­‰ç­‰ï¼Œä»¥åŠ CPUï¼šå¤šä¸ª CPUã€å†…å­˜ç­‰ç­‰ï¼‰ã€‚é€šå¸¸ï¼Œè¿™äº›å•å…ƒéœ€è¦å½¼æ­¤ç­‰å¾…ã€‚ é¦–å…ˆï¼Œæ‚¨éœ€è¦ç¡®å®šé™åˆ¶å› ç´ ã€‚ä¼˜åŒ–è¯¥å› ç´ æœ‰å¯èƒ½æé«˜æ€§èƒ½ã€‚ä¼˜åŒ–é”™è¯¯çš„å› ç´ çº¯å±æµªè´¹æ—¶é—´ï¼Œå¹¶å¯èƒ½ä¼šå¼•å…¥æ–°çš„é”™è¯¯ï¼Œç”šè‡³ ä¼šå¯¼è‡´å…¶ä»–æƒ…å†µä¸‹çš„æ€§èƒ½ä¸‹é™ã€‚åœ¨æ”¹è¿›è¯¥åŒºåŸŸä¹‹åï¼Œé€šå¸¸æœ€å¥½å†æ¬¡è¿›è¡Œæ¦‚è¦åˆ†æï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šæ­ç¤ºä»¥å‰æœªæ˜¾ç°çš„æ–°æ€§èƒ½ç“¶é¢ˆã€‚

é¦–å…ˆï¼Œæ‚¨åº”æ£€æŸ¥å¸§é€Ÿç‡æ˜¯å¦å— CPU æˆ– GPU æˆæœ¬é™åˆ¶ã€‚ä¸€å¦‚æ—¢å¾€ï¼Œæ‚¨å¯è°ƒæ•´å·¥ä½œè´Ÿè½½ï¼ˆä¾‹å¦‚ï¼Œæ›´æ”¹åˆ†è¾¨ç‡ï¼‰å¹¶æŸ¥çœ‹æ•ˆæœã€‚ä»ä¸‹å›¾ä¸­ï¼Œæ‚¨å¯è½»æ¾äº†è§£ å¼•æ“çš„å†…ç½®åŠŸèƒ½ *stat unit* å‘½ä»¤æŸ¥çœ‹å„ç§æ—¶é—´æ¶ˆè€—ï¼ŒåŒ…æ‹¬ï¼š

- *Frame* å¸§æ—¶æ˜¯ç”Ÿæˆä¸€å¸§æ¸¸æˆå†…å®¹æ‰€èŠ±è´¹çš„æ€»æ—¶é—´ã€‚ç”±äº Game çº¿ç¨‹å’Œ Draw çº¿ç¨‹åœ¨å®Œæˆä¸€å¸§ä¹‹å‰ä¿æŒåŒæ­¥ï¼Œæ‰€ä»¥å¸§æ—¶å¾€å¾€æ¥è¿‘å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹ä¸­æ˜¾ç¤ºçš„æ—¶é—´ã€‚
- *Game* å¦‚æœå¸§æ—¶æ¥è¿‘ Game çº¿ç¨‹ä¸­æ˜¾ç¤ºçš„æ—¶é—´ï¼Œåˆ™æ¸¸æˆçš„æ€§èƒ½å¾ˆå¯èƒ½ä¼šå—åˆ° Game çº¿ç¨‹çš„é˜»ç¢ï¼ˆè´Ÿé¢å½±å“ï¼‰ã€‚
- *Draw* å¦‚æœå¸§æ—¶æ¥è¿‘ Draw çº¿ç¨‹ä¸­æ˜¾ç¤ºçš„æ—¶é—´ï¼Œåˆ™æ¸¸æˆçš„æ€§èƒ½å¾ˆå¯èƒ½ä¼šå—åˆ°æ¸²æŸ“çº¿ç¨‹çš„é˜»ç¢ã€‚
- *GPU* GPU æ—¶é—´ç”¨æ¥è¡¡é‡æ˜¾å¡æ¸²æŸ“åœºæ™¯éœ€è¦å¤šé•¿æ—¶é—´ã€‚ç”±äº GPU æ—¶é—´ä¼šè¢«åŒæ­¥åˆ°å¸§ä¸Šï¼Œæ‰€ä»¥å®ƒå¾ˆå¯èƒ½ä¸å¸§æ—¶ç›¸åŒã€‚
- *RHIT* é€šå¸¸ï¼ŒRHIçº¿ç¨‹æ—¶é—´ä¼šè¢«åŒæ­¥åˆ°å¸§ä¸Šï¼Œå› æ­¤å®ƒå¾ˆå¯èƒ½ä¸å¸§æ—¶ç›¸å·®æ— å‡ ã€‚
- *DynRes* å¦‚æœæ”¯æŒï¼ˆå¹¶å¯ç”¨ï¼‰ï¼ŒDynRes å°†æ˜¾ç¤ºä¸»è¦å±å¹•ç™¾åˆ†æ¯”å’Œæ¬¡è¦å±å¹•ç™¾åˆ†æ¯”ã€‚


å®é™…å¸§æ—¶é—´å—ä¸‹åˆ—ä¸‰é¡¹å› ç´ ä¸­çš„æŸä¸€é¡¹é™åˆ¶ï¼Œé™åˆ¶å› ç´ æ˜¯ä¸‰è€…ä¸­çš„æœ€å¤§è€…ï¼Œä¸ºäº†è·å¾—è¾ƒå°çš„å¸§ æ—¶é—´ï¼Œå¿…é¡»å¯¹å…¶ä¼˜åŒ–å·¥ä½œè´Ÿè½½ã€‚

- å¦‚æœ Game æ—¶é—´è¿‡é«˜ï¼Œå°±åº”è¯¥ä½¿ç”¨ Unreal Insights ç­‰æŠ½æ · CPU åˆ†æå™¨ã€‚
- å¦‚æœ GPU æ—¶é—´è¿‡é«˜ï¼Œä¼ ç»Ÿçš„ GPU åˆ†æ åˆ†ææ–¹æ³•é€šå¸¸ä¹Ÿé€‚ç”¨ã€‚
- å¦‚æœ Draw æ—¶é—´è¿‡é«˜ï¼Œå¯èƒ½éœ€è¦å‡å°‘ç»˜åˆ¶è°ƒç”¨è®¡æ•°ã€‚


å¼•æ“æ˜¾ç¤ºæ ‡å¿—å¯ç”¨æ¥åˆ‡æ¢è®¸å¤šæ¸²æŸ“åŠŸèƒ½ã€‚ç¼–è¾‘å™¨å°†åœ¨ä¸€ä¸ªæ–¹ä¾¿ä½¿ç”¨çš„äºŒç»´ UI ä¸­åˆ—å‡ºæ‰€æœ‰æ˜¾ç¤ºæ ‡å¿—ã€‚æ‚¨å¯å•å‡»å¤é€‰æ¡†ä»¥åˆ‡æ¢å¤šä¸ªå¤é€‰æ¡†ï¼Œè€Œæ— éœ€å…³é—­èœå•ã€‚

åœ¨æ¸¸æˆä¸­ï¼Œæ‚¨å¯ä½¿ç”¨ show å‘½ä»¤ã€‚ä½¿ç”¨ show å¯è·å–æ‰€æœ‰æ˜¾ç¤ºæ ‡å¿—åŠå…¶çŠ¶æ€çš„åˆ—è¡¨ã€‚ä½¿ç”¨ show showflagname å¯åˆ‡æ¢åŠŸèƒ½ã€‚è¯·æ³¨æ„ï¼Œæ­¤å‘½ä»¤ä»…åœ¨æ¸¸æˆè§†å£ä¸­æœ‰æ•ˆï¼Œå› æ­¤åœ¨ç¼–è¾‘å™¨ è§†å£ä¸­ï¼Œéœ€è¦ä½¿ç”¨ç¼–è¾‘å™¨ UIã€‚æ‚¨å¯åœ¨æ¸¸æˆä¸­æˆ–åœ¨ç¼–è¾‘å™¨ä¸­ä½¿ç”¨æ§åˆ¶å°å˜é‡ï¼ˆä¾‹å¦‚ showflag.Bloomï¼‰æ¥è¦†ç›–æ˜¾ç¤ºæ ‡å¿—å€¼ï¼Œä½†è¿™æ ·åšè¿˜ä¼šç¦ç”¨ UIã€‚

æŸäº›åŠŸèƒ½ä»ä¼šæ¶ˆè€—æ€§èƒ½ï¼Œå³ä½¿ä¸å†æ¸²æŸ“ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä¾‹å¦‚ï¼Œshow particles ä¼šéšè—ç²’å­ï¼Œä½†ä»éœ€è¦æ¨¡æ‹Ÿæ—¶é—´ ä»¥ä¾¿æ”¯æŒç¨åé‡æ–°å¯ç”¨è¿™äº›åŠŸèƒ½ã€‚æ§åˆ¶å°å˜é‡ fx.freezeparticlesimulation å…è®¸æ‚¨åŒæ—¶ç¦ç”¨æ›´æ–°éƒ¨åˆ†ï¼ˆä¹Ÿæœ‰ç¼–è¾‘å™¨ UIï¼‰ã€‚ å¦ä¸€ä¸ªå‘½ä»¤ï¼Œshow tessellationï¼Œå¯ç¦ç”¨ä¸‰è§’å½¢æ”¾å¤§ï¼Œä½†ä»ä½¿ç”¨é“ºåµŒç€è‰²å™¨ã€‚

è‰¯å¥½çš„æ¦‚è¦åˆ†æèµ·ç‚¹æ˜¯å¯¹é«˜çº§åˆ«åŠŸèƒ½è¿›è¡Œæ¦‚è¦åˆ†æï¼Œä¾‹å¦‚ *show StaticMeshes* æˆ– *show tessellation*ã€‚

æ‰€æœ‰æ˜¾ç¤ºæ ‡å¿—ä¹Ÿä½œä¸ºæ§åˆ¶å°å˜é‡å…¬å¼€ï¼Œä¾‹å¦‚ console show Bloom ä¸º showflag.Bloom 0ï¼Œæˆ–åœ¨é…ç½®æ–‡ä»¶ä¸­å…¬å¼€ï¼šshowflag.Bloom = 0 æ§åˆ¶å°å˜é‡éœ€è¦è¾ƒå¤šçš„é”®ç›˜è¾“å…¥ï¼Œä½†å®ƒä»¬è¿˜ä¼šè¦†ç›–ç¼–è¾‘å™¨ UI æ˜¾ç¤ºæ ‡å¿—ï¼Œå¹¶å¯åƒå…¶ä»–æ§åˆ¶å°å˜é‡ä¸€æ ·æ”¾å…¥é…ç½®æ–‡ä»¶ã€‚

å¯¹æ¦‚è¦åˆ†ææœ€æœ‰ç”¨çš„æ ‡å¿—å¦‚ä¸‹æ‰€ç¤ºï¼š

- ScreenSpaceReflections åˆ‡æ¢å±å¹•ç©ºé—´åå°„ï¼Œå¯èƒ½ä¼šäº§ç”Ÿå¤§é‡æ€§èƒ½æˆæœ¬ï¼Œä»…å½±å“åƒç´ ç›´è‡³ç‰¹å®šç²—ç³™åº¦ï¼ˆé€šè¿‡ r.SSR.MaxRoughness è¿›è¡Œè°ƒæ•´ï¼Œæˆ–åœ¨åå¤„ç†è®¾ç½®ä¸­è¿›è¡Œè°ƒæ•´ï¼‰ã€‚
- AmbientOcclusion å±å¹•ç©ºé—´ç¯å¢ƒå…‰é®è”½ï¼ˆå¯¹æŸäº›åœºæ™¯çš„ç›Šå¤„éå¸¸æœ‰é™ï¼Œå¯¹äºé™æ€å¯¹è±¡ï¼Œæ‚¨åœ¨å…‰ç…§ç³»ç»Ÿä¸­çƒ˜åŸ¹ AOï¼‰ã€‚
- AntiAliasing åˆ‡æ¢ä»»ä½•æŠ—é”¯é½¿æ•ˆæœï¼ˆTemporalAA å’Œ FXAAï¼‰ï¼Œä½¿ç”¨ TemporalAA å¯åˆ‡æ¢åˆ° FXAAï¼ˆé€Ÿåº¦æ›´å¿«ï¼Œè´¨é‡æ›´ä½ï¼‰ã€‚
- Bloom æ ¹æ®é•œå¤´å…‰æ–‘å’Œé«˜å…‰åŠŸèƒ½æ¥å½±å“å›¾åƒã€‚
- DeferredLighting åˆ‡æ¢æ‰€æœ‰å»¶è¿Ÿç…§æ˜å¤„ç†è¿‡ç¨‹ã€‚
- DirectionalLights PointLights SpotLights åˆ‡æ¢ä¸åŒçš„å…‰æºç±»å‹ï¼ˆå¯¹äºäº†è§£å„ç±»å…‰æºçš„æ•ˆæœåŠæ€§èƒ½å½±å“éå¸¸æœ‰ç”¨ï¼‰ã€‚
- DynamicShadows åˆ‡æ¢æ‰€æœ‰åŠ¨æ€é˜´å½±ï¼ˆé˜´å½±è´´å›¾æ¸²æŸ“å’Œé˜´å½±è¿‡æ»¤/æŠ•å°„ï¼‰ã€‚
- GlobalIllumination åˆ‡æ¢çƒ˜åŸ¹å¼ç…§æ˜ä¸åŠ¨æ€é—´æ¥ç…§æ˜ (LPV)ã€‚
- LightFunctions åˆ‡æ¢å…‰å‡½æ•°æ¸²æŸ“ã€‚
- PostProcessing åˆ‡æ¢æ‰€æœ‰åå¤„ç†è¿‡ç¨‹ã€‚
- ReflectionEnvironment åˆ‡æ¢åå°„ç¯å¢ƒå¤„ç†è¿‡ç¨‹ã€‚
- Refraction åˆ‡æ¢æŠ˜å°„å¤„ç†è¿‡ç¨‹ã€‚
- Rendering æ•´ä½“åˆ‡æ¢æ¸²æŸ“ã€‚
- Decals åˆ‡æ¢è´´èŠ±æ¸²æŸ“ã€‚
- Landscape Brushes StaticMeshes SkeletalMeshes Landscape åˆ‡æ¢æ‰€æ¸²æŸ“çš„å‡ ä½•ä½“ã€‚
- Translucency åˆ‡æ¢åŠé€æ˜æ¸²æŸ“ã€‚
- Tessellation åˆ‡æ¢é“ºåµŒï¼ˆä»è¿è¡Œé“ºåµŒç€è‰²å™¨ï¼Œä½†äº§ç”Ÿæ›´å¤šä¸‰è§’å½¢ï¼‰ã€‚
- IndirectLightingCache åˆ‡æ¢å…·æœ‰å·²å¤±æ•ˆçš„å…‰ç…§è´´å›¾çš„åŠ¨æ€å¯¹è±¡æˆ–é™æ€å¯¹è±¡æ˜¯å¦ä½¿ç”¨é—´æ¥ç…§æ˜ç¼“å­˜ã€‚
- Bounds æ˜¾ç¤ºç¼–è¾‘å™¨ä¸­é€‰æ‹©çš„å¯¹è±¡çš„ç•Œé™é‡ã€‚
- Visualize SSR å°†æ‰€æœ‰å—å±å¹•ç©ºé—´åå°„å½±å“çš„åƒç´ æ¸²æŸ“ä¸ºäº®æ©™è‰²ï¼ˆé€Ÿåº¦è¾ƒæ…¢ï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚


## âš¡ Profile CPU/GPU
- https://docs.unrealengine.com/4.27/zh-CN/TestingAndOptimization/PerformanceAndProfiling/GPU/
- https://docs.unrealengine.com/4.27/zh-CN/TestingAndOptimization/PerformanceAndProfiling/CPU/

å¦‚æ¸²æŸ“çº¿ç¨‹ä¸­å‡ºç° CPU å—é™ï¼ŒåŸå› å¯èƒ½æ˜¯ç»˜åˆ¶è°ƒç”¨è¿‡å¤šã€‚è¿™æ˜¯ä¸€ä¸ªå¸¸è§é—®é¢˜ï¼Œç¾æœ¯å¸ˆé€šå¸¸ä¼šå°†ç»˜åˆ¶è°ƒç”¨è¿›è¡Œç»„åˆï¼Œä»è€Œå‡å°‘æ¶ˆè€—ï¼ˆå¦‚ï¼šå°†å¤šä¸ªå¢™å£ç»„åˆä¸ºä¸€ä¸ªç½‘æ ¼ä½“ï¼‰ã€‚

å®é™…æ¶ˆè€—å­˜åœ¨äºå¤šä¸ªåŒºåŸŸä¸­ï¼š

- æ¸²æŸ“çº¿ç¨‹éœ€è¦å¤„ç†æ¯ä¸ªç‰©ä½“ï¼ˆå‰”é™¤ã€æè´¨è®¾ç½®ã€ç¯å…‰è®¾ç½®ã€ç¢°æ’ã€æ›´æ–°æ¶ˆè€—ç­‰ï¼‰ã€‚ æè´¨è¶Šå¤æ‚ï¼Œè®¾ç½®æ¶ˆè€—è¶Šé«˜ã€‚
- æ¸²æŸ“çº¿ç¨‹éœ€è¦å‡†å¤‡ GPU æŒ‡ä»¤ï¼Œä»¥ä¾¿ä¸ºæ¯ä¸ªç»˜åˆ¶è°ƒç”¨ï¼ˆå¸¸é‡ç¼“å†²ã€çº¹ç†ã€å®ä¾‹å±æ€§ã€ç€è‰²å™¨ï¼‰è®¾ç½®çŠ¶æ€ï¼Œå¹¶æ‰§è¡Œå®é™…çš„ API è°ƒç”¨ã€‚ åŸºç¡€é€šé“ç»˜åˆ¶è°ƒç”¨çš„æ¶ˆè€—é€šå¸¸æ¯”ä»…é™æ·±åº¦çš„ç»˜åˆ¶è°ƒç”¨æ›´é«˜ã€‚
- DirectX å°†éªŒè¯éƒ¨åˆ†æ•°æ®å¹¶å°†ä¿¡æ¯ä¼ é€’åˆ°æ˜¾å¡é©±åŠ¨ã€‚
- é©±åŠ¨ï¼ˆå¦‚ NVIDIAã€AMDã€Intel...ï¼‰å°†è¿›ä¸€æ­¥éªŒè¯å¹¶ä¸ºç¡¬ä»¶åˆ›å»ºæŒ‡ä»¤ç¼“å†²åŒºã€‚è¯¥éƒ¨åˆ†æœ‰æ—¶ä¼šåœ¨å¦ä¸€çº¿ç¨‹ä¸­åˆ†ç¦»ã€‚

ä½¿ç”¨ stats å‘½ä»¤æ˜¾ç¤ºç”± 3D ç½‘æ ¼ä½“å¼•èµ·çš„ç»˜åˆ¶è°ƒç”¨æ—¶å°†æ˜¾ç¤º Mesh Draw Calls - ç¾æœ¯å¸ˆå¯é€šè¿‡ä»¥ä¸‹æ–¹æ³•å‡å°‘æ­¤é¡¹çš„æ•°é‡ï¼š

- å‡å°‘ç‰©ä½“æ•°é‡ï¼ˆé™æ€/åŠ¨æ€ç½‘æ ¼ä½“ã€ç½‘æ ¼ä½“ç²’å­ï¼‰
- ç¼©çŸ­å¯è§†è·ç¦»ï¼ˆå¦‚ï¼šåœºæ™¯æ•æ‰ Actor æˆ–æ¯ä¸ªç‰©ä½“ä¸Šçš„è·ç¦»ï¼‰
- è°ƒæ•´ç”»é¢ï¼ˆå°†ç”»é¢æ‹‰å¾—æ›´è¿œã€ä½¿ç§»åŠ¨ç‰©ä½“ä¸åœ¨åŒä¸€ä¸ªç”»é¢ä¸­ï¼‰
- ä¸ä½¿ç”¨ SceneCaptureActorï¼ˆé¡»é‡æ–°æ¸²æŸ“åœºæ™¯ã€è°ƒä½å¸§ç‡ã€æˆ–åªåœ¨éœ€è¦æ—¶è¿›è¡Œæ›´æ–°ï¼‰
- ä¸ä½¿ç”¨åˆ†å±ï¼ˆåˆ†å±æ¯”å•å±çš„ CPU å—é™æ›´å¤§ï¼Œéœ€å¯¹å¯å»¶å±•æ€§è®¾ç½®è¿›è¡Œè‡ªå®šä¹‰æˆ–å°†å†…å®¹è®¾ä¸ºæ›´åŠ ä¸»åŠ¨ï¼‰
- å‡å°‘æ¯æ¬¡ç»˜åˆ¶è°ƒç”¨çš„å…ƒç´ ï¼ˆå°†æ¥å—æ›´å¤æ‚åƒç´ ç€è‰²å™¨çš„æè´¨è¿›è¡Œç»„åˆæˆ–å•çº¯åœ°å‡å°‘æè´¨æ•°é‡ï¼Œå°†çº¹ç†ç»„åˆä¸ºå°‘æ•°å‡ å—è¾ƒå¤§çš„çº¹ç† - åªåœ¨å‡å°‘æè´¨æ•°é‡æ—¶æ‰ä½¿ç”¨å…ƒç´ è¾ƒå°‘çš„ LOD æ¨¡å‹ï¼‰
- ç¦ç”¨ç½‘æ ¼ä½“ä¸Šè‡ªå®šä¹‰æ·±åº¦æˆ–é˜´å½±æŠ•å°„çš„åŠŸèƒ½
- å°†å…‰æºè®¾ä¸ºä¸æŠ•å°„é˜´å½±ï¼Œæˆ–æ‹¥æœ‰æ›´ç´§å‡‘çš„è¾¹ç•Œä½“ï¼ˆè§†é”¥ã€è¡°å‡åŠå¾„ï¼‰

åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œç¡¬ä»¶å®ä¾‹åŒ–ä¸å¤±ä¸ºä¸€ä¸ªé€‰æ‹©ï¼ˆç›¸åŒçš„ 3D æ¨¡å‹ã€ç›¸åŒçš„ç€è‰²å™¨ã€è¾ƒå°‘çš„å‚æ•°å˜åŒ–ã€éœ€ç¡¬ä»¶æ”¯æŒï¼‰ã€‚ç¡¬ä»¶å®ä¾‹åŒ–å¯æå¤§é™ä½æ¯æ¬¡ç»˜åˆ¶è°ƒç”¨çš„é©±åŠ¨è¿‡è½½ï¼Œä½†ä¼šä½¿çµæ´»æ€§å—é™ã€‚æˆ‘ä»¬å°†å…¶ç”¨äºç½‘æ ¼ä½“ç²’å­å’Œå®ä¾‹åŒ–æ¤ç‰©ã€‚

é«˜ç«¯ PC ä¸Šçš„å®éªŒè¯´æ˜æ¯å¸§å¯æ‹¥æœ‰æ•°åƒæ¬¡ç»˜åˆ¶è°ƒç”¨ï¼ˆDirectX11ã€OpenGLï¼‰ã€‚æ›´æ–°çš„ APIï¼ˆAMD Mantleã€DirectX12ï¼‰å°†å°è¯•è§£å†³é©±åŠ¨è¿‡è½½ï¼Œå¹¶å¯æ‰§è¡Œæ›´å¤§æ¬¡æ•°çš„ç»˜åˆ¶è°ƒç”¨ã€‚ åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šï¼Œç»˜åˆ¶è°ƒç”¨æ¬¡æ•°ä¸ºæ•°ç™¾æ¬¡ï¼ˆOpenGL ES2ã€OpenGL ES3ï¼‰ï¼Œä½†å³ä½¿å¦‚æ­¤ä»èƒ½æå¤§åœ°é™ä½é©±åŠ¨è¿‡è½½ï¼ˆApple Metalï¼‰ã€‚

å¦‚åœ¨æ¸¸æˆçº¿ç¨‹ä¸­ CPU å—é™ï¼Œéœ€è¦æ‰¾åˆ°å¼•èµ·æ­¤é—®é¢˜çš„æ¸¸æˆä»£ç ï¼ˆå¦‚è“å›¾ã€å…‰çº¿æŠ•å°„ã€ç‰©ç†ã€AIã€å†…å­˜åˆ†é…ï¼‰ã€‚

å¦‚ CPU æœªå—é™ï¼Œåˆ™ä¸º GPU å—é™ã€‚

GPU æœ‰è®¸å¤šå¹¶è¡Œå·¥ä½œçš„å•å…ƒï¼Œæ¡†æ¶çš„ä¸åŒéƒ¨åˆ†è¢«ä¸åŒçš„å•å…ƒç»‘å®šæ˜¯å¸¸è§ç°è±¡ã€‚ æ­£å› ä¸ºå¦‚æ­¤ï¼Œåœ¨å¯»æ‰¾ç“¶é¢ˆæ—¶ï¼Œäº†è§£ GPU æˆæœ¬çš„å»å‘ä»¥åŠ GPU ç“¶é¢ˆæ˜¯ä»€ä¹ˆå…·æœ‰é‡è¦æ„ä¹‰ã€‚

åœ¨ç¼–è¾‘å™¨ä¸­ä½¿ç”¨ ProfileGPUï¼ˆ*Ctrl + Shift + ,*ï¼‰å¿«é€Ÿäº†è§£ä¿¡æ¯ä»¥åŠå“ªéƒ¨åˆ†æ¯”è¾ƒæ…¢ã€‚

GPU æˆæœ¬çš„å»å‘

ProfileGPU å‘½ä»¤å…è®¸æ‚¨å¿«é€Ÿè¯†åˆ«å„ç§ä¼ é€’çš„ GPU æˆæœ¬ï¼Œæœ‰æ—¶ç”šè‡³å¯ä»¥å…·ä½“è‡³ç»˜åˆ¶è°ƒç”¨ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨åŸºäºé¼ æ ‡çš„UIæˆ–æ–‡æœ¬ç‰ˆæœ¬ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ r.ProfileGPU.ShowUI æ¥ç¦ç”¨ UIã€‚æ•°æ®åŸºäºGPUæ—¶é—´æˆ³ï¼Œ é€šå¸¸éå¸¸å‡†ç¡®ã€‚ç„¶è€ŒæŸäº›ä¼˜åŒ–ä¼šé™ä½æ•°å­—çš„å¯é æ€§ï¼Œå› æ­¤æœ€å¥½ä»¥æ‰¹åˆ¤æ€§çš„æ€åº¦å®¡è§†ä»»ä½•æ•°å­—ã€‚æˆ‘ä»¬å‘ç°ä¸€äº›é©±åŠ¨ç¨‹åº å€¾å‘äºåœ¨ä½¿ç”¨ç€è‰²å™¨å‡ ç§’é’Ÿåå¯¹ç€è‰²å™¨æˆæœ¬è¿›è¡Œä¼˜åŒ–ã€‚è¿™ç§æƒ…å†µå¯èƒ½ä¼šå¾ˆæ˜æ˜¾ï¼Œå› æ­¤ç­‰å¾…ä¸€æ®µæ—¶é—´æˆ–å†æµ‹é‡ä¸€æ¬¡ä»¥è·å¾—æ›´é«˜çš„ç½®ä¿¡åº¦å¯èƒ½æ˜¯æœ‰ç›Šçš„åšæ³•ã€‚

ä»€ä¹ˆæ˜¯GPUç“¶é¢ˆï¼Ÿ

é€šå¸¸ï¼Œæ€§èƒ½æˆæœ¬éšåƒç´ æ•°é‡çš„å¢åŠ è€Œå¢åŠ ã€‚è‹¥è¦æµ‹è¯•è¿™ä¸€ç‚¹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ *r.SetRes* æ”¹å˜æ¸²æŸ“åˆ†è¾¨ç‡æˆ–åœ¨ç¼–è¾‘å™¨ä¸­ç¼©æ”¾è§†å£ã€‚ è™½ç„¶ä½¿ç”¨ *r.ScreenPercentage* æ›´æ–¹ä¾¿ï¼Œä½†æ˜¯è¯·åˆ‡è®°ï¼Œä¸€æ—¦ä½¿ç”¨è¯¥ç‰¹æ€§ï¼Œå°±ä¼šå¢åŠ ä¸€äº›é¢å¤–çš„å¢é‡‡æ ·æˆæœ¬ã€‚

å¦‚æœæ‚¨çœ‹åˆ°ä¸€ä¸ªå¯æµ‹é‡çš„æ€§èƒ½å˜åŒ–ï¼Œé‚£ä¹ˆæ‚¨å°†å—åˆ°ä¸åƒç´ ç›¸å…³é¡¹çš„çº¦æŸã€‚é€šå¸¸ï¼Œå®ƒè¦ä¹ˆæ˜¯å†…å­˜å¸¦å®½ï¼ˆè¯»å†™ï¼‰ï¼Œè¦ä¹ˆæ˜¯æ•°å­¦é™åˆ¶ï¼ˆALUï¼‰ï¼Œä½†åœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œ æŸäº›ç‰¹å®šçš„å•å…ƒæ˜¯é¥±å’Œçš„ï¼ˆä¾‹å¦‚MRTå¯¼å‡ºï¼‰ã€‚å¦‚æœæ‚¨èƒ½å¤Ÿé™ä½ç›¸å…³é€šé“çš„å†…å­˜ï¼ˆæˆ–æ•°å­¦ï¼‰å¹¶æŸ¥çœ‹æ€§èƒ½å·®å¼‚ï¼Œæ‚¨å°±ä¼šçŸ¥é“å®ƒå—å†…å­˜å¸¦å®½ï¼ˆæˆ–ALUå•å…ƒï¼‰æ‰€é™åˆ¶ã€‚ å˜åŒ–ä¸å¿…å¦‚å‡ºä¸€è¾™ - æ¯•ç«Ÿè¿™åªæ˜¯ä¸€æ¬¡æµ‹è¯•ã€‚ç°åœ¨æ‚¨å·²æ„è¯†åˆ°æ‚¨å¿…é¡»é™ä½æˆæœ¬æ¥æé«˜æ€§èƒ½ã€‚

è™½ç„¶é˜´å½±è´´å›¾çš„åˆ†è¾¨ç‡ä¸å±å¹•åˆ†è¾¨ç‡ä¸æˆæ¯”ä¾‹ï¼ˆä½¿ç”¨ r.Shadow.MaxResolutionï¼‰ï¼Œä½†é™¤éæ‚¨æœ‰éå¸¸å¤§é¢ç§¯çš„é˜´å½±æŠ•å½±é®ç½©æˆ–åŠé€æ˜ææ–™ï¼Œ å¦åˆ™æ‚¨å°†ä¸å—åƒç´ ç€è‰²å™¨é™åˆ¶ã€‚é˜´å½±è´´å›¾æ¸²æŸ“é€šå¸¸å—é¡¶ç‚¹å¤„ç†æˆ–ä¸‰è§’å½¢å¤„ç†é™åˆ¶ï¼ˆåŸå› ï¼šå¯†é›†ç½‘æ ¼ä½“ã€æ— LODã€æ›²é¢ç»†åˆ†ã€ä½¿ç”¨ WorldPositionOffsetï¼‰ã€‚ é˜´å½±è´´å›¾æ¸²æŸ“æˆæœ¬ä¸ç¯å…‰çš„æ•°é‡ã€çº§è”/ç«‹æ–¹ä½“è´´å›¾çš„è¾¹æ•°ä»¥åŠå…‰æºè§†é”¥ä¸­æŠ•å½±å¯¹è±¡çš„æ•°é‡æˆæ¯”ä¾‹ã€‚è¿™æ˜¯ååˆ†å¸¸è§çš„ç“¶é¢ˆï¼Œ åªæœ‰æ›´å¤§çš„å†…å®¹æ›´æ”¹æ‰èƒ½é™ä½æˆæœ¬ã€‚

é«˜åº¦æ›²é¢ç»†åˆ†çš„ç½‘æ ¼ä½“ï¼ˆå…¶ä¸­çš„çº¿æ¡†æ˜¾ç¤ºä¸ºçº¯è‰²ï¼‰å¯èƒ½ä¼šå—åˆ°è¾ƒä½å››è¾¹å½¢åˆ©ç”¨ç‡çš„å›°æ‰°ã€‚è¿™æ˜¯ å› ä¸º GPU åœ¨2x2åƒç´ å—ä¸­å¤„ç†ä¸‰è§’å½¢ï¼Œç¨åä¼šæ‹’ç»ä¸‰è§’å½¢ä¹‹å¤–çš„åƒç´ ã€‚è¿™æ˜¯ mip æ˜ å°„è®¡ç®—æ‰€éœ€è¦çš„ã€‚å¯¹äºè¾ƒå¤§çš„ä¸‰è§’å½¢ï¼Œè¿™ä¸æ˜¯é—®é¢˜ï¼Œ ä½†å¦‚æœä¸‰è§’å½¢å¾ˆå°æˆ–å¾ˆé•¿ï¼Œæ€§èƒ½å¯èƒ½ä¼šå—åˆ°å½±å“ï¼Œå› ä¸ºè™½ç„¶å¤„ç†çš„åƒç´ å¾ˆå¤šï¼Œä½†å®é™…ä¸Šå…¶ä¸­åªæœ‰å¾ˆå°‘çš„åƒç´ å¯¹å›¾åƒä½œå‡ºè´¡çŒ®ã€‚å»¶è¿Ÿç€è‰²æ”¹å–„äº†è¿™ç§æƒ…å†µï¼Œ å› ä¸ºæˆ‘ä»¬å¾—åˆ°äº†å¾ˆå¥½çš„å››è¾¹å½¢ç…§æ˜åˆ©ç”¨ç‡ã€‚è¿™ä¸ªé—®é¢˜å°†ä¼šåœ¨åŸºæœ¬é€šé“æœŸé—´ç»§ç»­å­˜åœ¨ï¼Œæ‰€ä»¥å¤æ‚çš„æè´¨æ¸²æŸ“å¯èƒ½ä¼šç›¸å½“æ…¢ã€‚ è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•æ˜¯ä½¿ç”¨å¯†åº¦è¾ƒå°çš„ç½‘æ ¼ä½“ã€‚å¦‚æœæ˜¯ç»†èŠ‚å±‚çº§ç½‘æ ¼ä½“ï¼Œè¿™åªèƒ½åœ¨é—®é¢˜å‘ç”Ÿå¤„ï¼ˆåœ¨è¿œå¤„ï¼‰å®Œæˆã€‚

æ‚¨å¯è°ƒæ•´ *r.EarlyZPass* ä»¥æŸ¥çœ‹æ‚¨çš„åœºæ™¯æ˜¯å¦ä¼šå—ç›Šäºä¸€ä¸ªå®Œæ•´çš„æ—©æœŸZé€šé“ï¼ˆåŸºæœ¬é€šé“æœŸé—´æœ‰æ›´å¤šçš„ç»˜åˆ¶è°ƒç”¨å’Œæ›´å°‘çš„è¿‡åº¦ç»˜åˆ¶ï¼‰ã€‚

å¦‚æœæ›´æ”¹åˆ†è¾¨ç‡ä¸ä¼šäº§ç”Ÿå¤ªå¤§çš„å½±å“ï¼Œæ‚¨å¯èƒ½ä¼šå—åˆ°é¡¶ç‚¹å¤„ç†ï¼ˆé¡¶ç‚¹ç€è‰²å™¨æˆ–æ›²é¢ç»†åˆ†ï¼‰æˆæœ¬çš„é™åˆ¶ã€‚ é€šå¸¸ï¼Œæ‚¨å¿…é¡»æ›´æ”¹å†…å®¹æ¥éªŒè¯è¿™ä¸€ç‚¹ã€‚å…¸å‹çš„åŸå› åŒ…æ‹¬ï¼š

- é¡¶ç‚¹å¤ªå¤šã€‚ï¼ˆä½¿ç”¨ç»†èŠ‚å±‚çº§ç½‘æ ¼ä½“ï¼‰
- å¤æ‚çš„ä¸–ç•Œåœºæ™¯ä½ç½®åç§»/ä½ç§»æè´¨ä½¿ç”¨çº¹ç†ä¸ä¸è‰¯çš„MIPæ˜ å°„ã€‚ï¼ˆè°ƒæ•´æè´¨ï¼‰
- æ›²é¢ç»†åˆ†ï¼ˆå°½å¯èƒ½é¿å…ï¼Œè°ƒæ•´æ›²é¢ç»†åˆ†å› å­ - æœ€å¿«çš„æ–¹æ³•ï¼šæ˜¾ç¤ºæ›²é¢ç»†åˆ†ï¼Œæœ‰äº›ç¡¬ä»¶åœ¨æ›´å¤§çš„æ›²é¢ç»†åˆ†çº§åˆ«ä¸‹æ‰©å±•æ€§å¾ˆå·®ï¼‰
- è®¸å¤šUVæˆ–æ³•çº¿æ¥ç¼å¯¼è‡´æ›´å¤šçš„é¡¶ç‚¹ã€‚ï¼ˆçœ‹çœ‹å±•å¼€çš„UV - è®¸å¤šå²›çŠ¶åŒºéƒ½å¾ˆç³Ÿç³•ï¼Œå¹³å¦çš„é˜´å½±ç½‘æ ¼ä½“æ¯ä¸ªä¸‰è§’å½¢å…·æœ‰3ä¸ªé¡¶ç‚¹ï¼‰
- é¡¶ç‚¹å±æ€§å¤ªå¤šã€‚ï¼ˆé¢å¤–çš„UVé€šé“ï¼‰
- éªŒè¯é¡¶ç‚¹æ•°é‡æ˜¯å¦åˆç†ï¼Œä¸€äº›å¯¼å…¥å™¨ä»£ç å¯èƒ½æ²¡æœ‰ç„Šæ¥é¡¶ç‚¹ã€‚ï¼ˆåˆå¹¶å…·æœ‰ç›¸åŒä½ç½®ã€UVå’Œæ³•çº¿çš„é¡¶ç‚¹ï¼‰

åœ¨è¾ƒä¸ºå°‘è§çš„æƒ…å†µä¸‹ï¼Œæ‚¨ä¼šè¢«æŸäº›å…¶ä»–å› ç´ æ‰€çº¦æŸã€‚å®ƒä»¬å¯èƒ½æ˜¯ï¼š

- å¯¹è±¡æˆæœ¬ï¼ˆæ›´æœ‰å¯èƒ½æ˜¯CPUæˆæœ¬ï¼Œä½†ä¹Ÿå¯èƒ½æ˜¯ä¸€äº›GPUæˆæœ¬ï¼‰
- ä¸‰è§’å½¢è®¾ç½®æˆæœ¬ï¼ˆéå¸¸æ˜‚è´µçš„å¤šè¾¹å½¢ç½‘æ ¼ä½“ä¸ä¸€ä¸ªä¾¿å®œçš„é¡¶ç‚¹ç€è‰²å™¨ï¼Œä¾‹å¦‚é˜´å½±è´´å›¾é™æ€ç½‘æ ¼ä½“ï¼Œå¾ˆå°‘æ˜¯è¿™ä¸ªé—®é¢˜ï¼‰
- ä½¿ç”¨ç»†èŠ‚å±‚çº§(LOD)ç½‘æ ¼ä½“
- è§†å›¾æˆæœ¬ï¼ˆä¾‹å¦‚HZBé®æŒ¡å‰”é™¤ï¼‰
- åœºæ™¯æˆæœ¬ï¼ˆä¾‹å¦‚GPUç²’å­æ¨¡æ‹Ÿï¼‰


## âš¡ Unreal Insights
- Unreal Insights https://docs.unrealengine.com/4.27/zh-CN/TestingAndOptimization/PerformanceAndProfiling/UnrealInsights/

Unreal Insights å¯å¸®åŠ©å¼€å‘è€…è¯†åˆ«ç“¶é¢ˆï¼Œé€‚ç”¨äºä¼˜åŒ–æ€§èƒ½ã€‚ä»è¾ƒé«˜å±‚é¢çœ‹ï¼ŒUnreal Insights æ˜¯ä¸€æ¬¾é›†æˆäº†è™šå¹»å¼•æ“çš„ standalone åˆ†æç³»ç»Ÿï¼Œç”¨äºæ”¶é›†ã€åˆ†æå’Œæ˜¾ç¤ºå¼•æ“å‘å‡ºçš„æ•°æ®ã€‚é™¤å……åˆ†è¦†ç›–å¼•æ“çš„ç°æœ‰ç³»ç»Ÿå¤–ï¼Œåˆ©ç”¨ Unreal Insights è¿˜å¯è½»æ¾æ·»åŠ ç”¨æˆ·è‡ªèº«çš„åˆ†ææ•°æ®ã€‚æœ€åï¼Œè¯¥ç³»ç»Ÿæ‹¥æœ‰è¿œç¨‹æ•°æ®å½•åˆ¶åŠŸèƒ½ï¼Œå¯¹é¡¹ç›®æ‰§è¡Œçš„å½±å“éå¸¸ä½ã€‚

è™šå¹»å¼•æ“éšé™„çš„ Unreal Insights å·¥å…·ä½äº Engine/Binaries/Win64 ç›®å½•ä¸­ã€‚ä¸‹è½½å¹¶åœ¨æœ¬åœ°ç¼–è¯‘ UE4 æºç ç”¨æˆ·å¯ä½¿ç”¨ä»¥ä¸‹æ–¹å¼ç¼–è¯‘ï¼šåœ¨å¼€å‘æˆ–å‘å¸ƒæ¨¡å¼ä¸­æ„å»ºæ•´ä¸ª UE4 è§£å†³æ–¹æ¡ˆï¼›æˆ–ç›´æ¥ç¼–è¯‘"UnrealInsights"é¡¹ç›®ã€‚

Unreal InsightsåŒ…å«ç”¨äºä¼˜åŒ–ã€åˆ†æå’Œè°ƒè¯•ç½‘ç»œæµé‡çš„ Networking Insightsã€‚ç”¨æˆ·å¯ä»¥åˆ©ç”¨ä»¥ä¸‹åŠŸèƒ½è®°å½•è¿½è¸ªä¿¡æ¯ï¼Œä»¥æ˜¾ç¤ºç½‘ç»œè¡Œä¸ºï¼š

- æ¸¸æˆå®ä¾‹ï¼ˆGame Instanceï¼‰åŠŸèƒ½æŒ‰é’®ï¼Œç”¨äºåœ¨è®°å½•ç½‘ç»œä¼šè¯æœŸé—´æ˜¾ç¤ºå¯è§æœºå™¨
- è¿æ¥æ¨¡å¼ï¼ˆConnection Modeï¼‰åŠŸèƒ½æŒ‰é’®ï¼Œç”¨äºæ˜¾ç¤ºä¼ å‡ºæˆ–ä¼ å…¥çš„æ•°æ®
- æ•°æ®åŒ…æ¦‚è§ˆï¼ˆPacket Overviewï¼‰é¢æ¿ï¼Œç”¨äºæ˜¾ç¤ºæ¸¸æˆæœŸé—´ä¼ è¾“æˆ–æ¥æ”¶çš„æ•°æ®åŒ…æ—¶é—´è½´ï¼ˆå’Œå¤§å°ï¼‰
- æ•°æ®åŒ…å†…å®¹ï¼ˆPacket Contentï¼‰é¢æ¿ï¼Œç”¨äºæ˜¾ç¤ºæ•°æ®åŒ…å†…å®¹ï¼Œä¾‹å¦‚é‡å¤çš„å¯¹è±¡ã€å±æ€§å’Œè¿œç¨‹å‡½æ•°è°ƒç”¨
- ç½‘ç»œç»Ÿè®¡æ•°æ®ï¼ˆNet Statsï¼‰é¢æ¿ï¼Œç”¨äºæ˜¾ç¤ºé€‰å®šæ•°æ®åŒ…çš„è¿½è¸ªäº‹ä»¶ï¼ŒåŒ…æ‹¬æ•°æ®åŒ…æ€»å¤§å°ã€å¤§å°ä¸Šé™ã€ä»¥åŠæ’é™¤å¼æˆ–åŒ…å«å¼æ•°æ®åŒ…å¹³å‡å¤§å°ã€‚

ç¼–è¾‘å™¨æ‹¥æœ‰ Animation Insights æ’ä»¶ï¼Œå¯æ˜¾ç¤º gameplay çŠ¶æ€å’Œå®æ—¶åŠ¨ç”»è¡Œä¸ºã€‚ç”¨æˆ·å¯ä»¥ä½¿ç”¨ Animation Insights è®°å½•è¿½è¸ªä¿¡æ¯ï¼Œä½¿ç”¨ä»¥ä¸‹åŠŸèƒ½æ˜¾ç¤ºåŠ¨ç”»è¡Œä¸ºï¼š

- é€šé“è¿‡æ»¤ï¼Œé€‰æ‹©å†™è‡³è®°å½•æ•°æ®é›†çš„è¿½è¸ªæ•°æ®
- æºè¿‡æ»¤ï¼Œé€‰æ‹©è¾“å‡ºè¿½è¸ªæ•°æ®çš„gameplayå¯¹è±¡
- å§¿åŠ¿ã€æ›²çº¿ã€æ··åˆæƒé‡ã€åŠ¨ç”»å›¾è¡¨ã€è’™å¤ªå¥‡å’ŒåŠ¨ç”»é€šçŸ¥è½¨è¿¹
- åŒ…å«å®æ—¶æ›´æ–°çš„åŠ¨ç”»å›¾è¡¨åŸç†è§†å›¾ï¼Œç”¨äºæ›¿æ¢ showdebug animation ç³»ç»Ÿã€‚

Animation Insights æ‰©å±•äº†ç°æœ‰ showdebug animation åŠŸèƒ½ï¼ˆå…¶æ˜¾ç¤ºåŠ¨ç”»è¿è¡Œæ—¶å†…éƒ¨æ•°æ®ï¼‰ã€‚ä¿¡æ¯çš„æ˜¾ç¤ºå’Œåˆ†æè®©ç”¨æˆ·èƒ½å¤Ÿè¯†åˆ«åŠ¨ç”»æ•…éšœæˆ–bugåŸå› ã€‚

showdebug animation ç³»ç»Ÿä»…ä¼šåœ¨å±å¹•ä¸Šè¾“å‡ºæ–‡æœ¬ï¼Œå› æ­¤ showdebug animation ä¼šéšæ—¶é—´é™åˆ¶ç”¨æˆ·è¿½è¸ªåŠ¨ç”»é—®é¢˜çš„èƒ½åŠ›ã€‚Animation Insights å¯è®°å½•åŒ…å«åŠ¨ç”» bug çš„å¸§èŒƒå›´ï¼ŒåŒæ—¶åœ¨æŸ¥çœ‹æ•°æ®åˆ†è§£æ—¶æ‹–åŠ¨ï¼ˆæˆ–æ’­æ”¾ï¼‰è¿™äº›å¸§ã€‚

åœ¨ä¸ºåº”ç”¨ç¨‹åºå¼€å‘ç”¨æˆ·ç•Œé¢æ—¶ï¼ŒUI ç¨‹åºå‘˜å¯èƒ½ä¼šéš¾ä»¥æ‰¾åˆ°è§¦å‘ UI æ›´æ–°çš„æ›´æ”¹æºã€‚éšç€ UE4.26 çš„å‘å¸ƒï¼ŒSlate Insights æ’ä»¶æ‰©å±•äº† Unreal Insightsï¼Œä¸ºå¼€å‘äººå‘˜æä¾›äº†å¤šç§å·¥å…·æ¥è¯†åˆ«ç‰¹å®š Slate å’Œ UMG æ›´æ–°çš„æ ¹æœ¬åŸå› ï¼Œå¸®åŠ©ä»–ä»¬æé«˜ UI æ€§èƒ½ã€‚

åœ¨ä½¿ç”¨ Slate Insights æ’ä»¶æ—¶ï¼Œå¼€å‘äººå‘˜å¯ä»¥ä½¿ç”¨ Slate å¸§è§†å›¾ï¼ˆSlate Frame Viewï¼‰æ¥è·å–è¦é€å¸§ç»˜åˆ¶ã€ä½œåºŸæˆ–æ›´æ–°çš„æ§ä»¶åˆ—è¡¨ã€‚Slate Insights è®©å¼€å‘äººå‘˜å¯ä»¥è°ƒè¯•å’Œä¼˜åŒ–ä»–ä»¬çš„UIã€‚

è¦å¼€å§‹åœ¨ç¼–è¾‘å™¨ä¸­ä½¿ç”¨ Slate Insightsï¼Œå¯ä»¥ä»ç¼–è¾‘å™¨å†…éƒ¨æˆ–ä» uproject æ–‡ä»¶å¯ç”¨æ’ä»¶ã€‚è¦ä»ç¼–è¾‘å™¨å¯ç”¨ Slate Insights æ’ä»¶ï¼Œè¯·åœ¨ Editor -> Plugins -> Built-In > Slate Insights ä¸­æ‰¾åˆ°å®ƒã€‚


## âš¡ VisualLogger å¯è§†è®°å½•è®®
- https://docs.unrealengine.com/4.27/zh-CN/TestingAndOptimization/VisualLogger/

å¯è§†è®°å½•å™¨ æ˜¯ä¸€æ¬¾å¼ºå¤§çš„è°ƒè¯•å·¥å…·ï¼Œç”¨äºåˆ›å»ºå’Œå½•åˆ¶æ¸¸æˆè¿›ç¨‹çŠ¶æ€çš„å¯è§†æ˜¾ç¤ºï¼Œå¯åœ¨ç¼–è¾‘å™¨ä¸­æŸ¥çœ‹æ­¤æ•°æ®ã€‚å¼€å‘è€…èƒ½å¤Ÿåœ¨æ¸¸æˆä¼šè¯æœŸé—´å®æ—¶æŸ¥çœ‹è°ƒè¯•è¾“å‡ºï¼Œæˆ–ä¼šè¯ç»“æŸååœ¨ç¼–è¾‘å™¨ä¸­è¿›è¡ŒæŸ¥çœ‹ï¼Œåœ¨é¢å¯¹ä»…é ç”¨æˆ·æŠ¥å‘Šæˆ–æ¸¸æˆç”»é¢éš¾ä»¥è¿½è¸ªçš„æ¸¸æˆæ¼æ´æ—¶ï¼Œå¯è½»æ¾å¯¹å…¶è¿›è¡Œä¿®å¤ã€‚å¤„ç†ç½•è§çš„æˆ–è€…å¾ˆéš¾é‡ç°çš„æ¼æ´æ—¶ï¼Œè®°å½•ä¿¡æ¯ä»¥ä¾›åç»­æ£€æŸ¥çš„åŠŸèƒ½éå¸¸é‡è¦ã€‚ä¾‹å¦‚ï¼Œå•ä¸ªå¸§ä¸Šçš„æ¸¸æˆçŠ¶æ€å˜é‡å‘ç”Ÿæ”¹å˜å¯èƒ½ä¼šå¼•èµ·ä¸€æ¬¡æ„å¤–çš„AIè¡Œä¸ºï¼Œä½†é€šè¿‡è®°å½•æ•°æ®å’Œæ‹–è‡³æ¼æ´å‘ç”Ÿçš„å¸§æ•°ä¾¿å°±å¯åœ¨ä¹‹åç ”ç©¶è¯¥æ„å¤–ã€‚

è¦å¯åŠ¨å¯è§†è®°å½•å™¨ï¼Œä½¿ç”¨ Windows > Developer Tools > å¯è§†è®°å½•å™¨ ä¸­çš„èœå•å³å¯ã€‚åœ¨è™šå¹»å¼•æ“4.7ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œè¾“å…¥æ§åˆ¶å°å‘½ä»¤*VisLog*ã€‚å¦‚æ­£åœ¨ä½¿ç”¨ç¼–è¾‘å™¨ï¼Œå¯è§†è®°å½•å™¨è§†å£ä¾¿ä¼šæ‰“å¼€ã€‚


## âš¡ å†™ç»™ç¾æœ¯å¸ˆå’Œè®¾è®¡å¸ˆçš„æ€§èƒ½æŒ‡å—
https://docs.unrealengine.com/4.27/zh-CN/TestingAndOptimization/PerformanceAndProfiling/Guidelines/

æˆ‘ä»¬é’ˆå¯¹å†…å®¹åˆ¶ä½œå’Œå…³å¡è®¾è®¡åœ¨æ€§èƒ½ä¼˜åŒ–æ–¹é¢æœ‰ä¸€äº›é€šç”¨çš„æŒ‡å—ã€‚

å¯¹ç¾æœ¯è€Œè¨€

- æœ€å°åŒ–æ¯ä¸ªç‰©ä½“çš„å…ƒç´ æ•°é‡ã€‚
- å°†æ¨¡å‹åˆå¹¶ï¼Œå½¢æˆå•ä¸ªå…ƒç´ ä¸Šæœ‰ä¸€å®šæ•°é‡çš„ä¸‰è§’é¢ï¼ˆæ¯”å¦‚æ¯ä¸ªå…ƒç´  300+ ä¸ªä¸‰è§’é¢ï¼‰ã€‚
- ä¸é€æ˜çš„æè´¨æ€§èƒ½æœ€å¿«ï¼Œå› ä¸ºæœ‰æœ€ä½³çš„ ZBuffer è£å‰ªï¼Œè’™ç‰ˆä¼šç¨æ…¢ä¸€äº›ï¼ŒåŠé€æ˜åˆ™æœ€æ…¢ï¼Œå› ä¸ºæœ‰å¤šæ¬¡ç»˜åˆ¶çš„å¼€é”€ã€‚
- é™åˆ¶ UV seam çš„æ•°é‡å’Œ hard edges çš„æ•°é‡ï¼Œå› ä¸ºå®ƒä»¬ä¼šå¯¼è‡´ç¡¬ä»¶è®¡ç®—æ—¶æ›´å¤šçš„é¡¶ç‚¹æ•°æ®ã€‚åœ¨æœ€ç³Ÿçš„æƒ…å½¢ä¸‹ï¼Œä¸€äº›å¤–éƒ¨çš„å»ºæ¨¡è½¯ä»¶è®¡ç®—ä¸‹ï¼Œå…·æœ‰å¤§é‡å¤šè¾¹å½¢çš„æ¨¡å‹é‡‡ç”¨ hard edge å¯èƒ½ä¼šå¯¼è‡´ä¸‰å€äºé hard edge çš„é¡¶ç‚¹æ•°æ®ã€‚
- Skinned Mesh çš„é¡¶ç‚¹å¤„ç†é€šå¸¸éƒ½æ¯” Static Mesh çš„é¡¶ç‚¹å¤„ç†è¦æ±‚æ›´å¤šçš„æ€§èƒ½ã€‚
- å½“æ·»åŠ äº† Morph Target æˆ–è€…ä½¿ç”¨ WorldPositionOffset æ—¶ï¼Œé¡¶ç‚¹å¤„ç†éœ€è¦æ›´å¤šçš„æ€§èƒ½å¼€é”€ã€‚ç”±äºç¼“å­˜çš„åŸå› ï¼Œè´´å›¾çš„æŸ¥æ‰¾è¿‡ç¨‹ä¹Ÿä¼šæ›´æ…¢ã€‚
- æ›²é¢ç»†åˆ†è¦æ±‚å¾ˆå¤šé¢å¤–çš„æ€§èƒ½å¼€é”€ï¼Œåº”è¯¥å°½å¯èƒ½é¿å…ä½¿ç”¨ã€‚é¢„å…ˆç»†åˆ†å¥½çš„æ¨¡å‹é€šå¸¸ä¼šå¿«å¾—å¤šã€‚
- è¾ƒå¤§çš„æ¨¡å‹å¯ä»¥åˆ†ä¸ºå¤šä¸ªï¼Œä»¥è·å¾—æ›´å¥½çš„è£å‰ªä¼˜åŒ–ã€‚è¿™ä¸æ­¢å¯¹äºå¯è§æ€§çš„è£å‰ªï¼Œå…‰ç…§åˆ™åœ¨æ›´ç»†çš„ç²’åº¦ä¸Šè¢«å¤„ç†ã€‚
- è¶Šå°çš„è´´å›¾æ ¼å¼èƒ½å¸¦æ¥æ›´å¿«çš„æè´¨ï¼ˆæ¯”å¦‚ DXT1 æ˜¯æ¯åƒç´  4 bitï¼ˆå³ 4 bppï¼‰ï¼ŒDXT5 æ˜¯ 8 bppï¼Œè€Œ ARGB åˆ™æ˜¯ 32 bppï¼‰ã€‚
- è¶Šä½çš„è´´å›¾åˆ†è¾¨ç‡è¶Šå¿«ï¼ˆå½“æ”¾å¤§æ—¶ï¼‰ã€‚æœ‰æ—¶ä¹Ÿä¼šæ›´åŠ å¹³æ»‘ï¼Œå› ä¸ºåŒå‘çº¿æ€§è¿‡æ»¤å¯ä»¥åœ¨ shade å±‚é¢æ¯”å®é™…è´´å›¾å±•ç°å¾—åˆ°æ›´å¥½çš„æ•ˆæœã€‚
- è¾ƒå°‘ shader æŒ‡ä»¤æ•°çš„æè´¨åŠè´´å›¾èƒ½è¿è¡Œçš„æ›´å¿«ã€‚ä¼˜åŒ–æè´¨çš„è¯ï¼Œåº”ä½¿ç”¨æè´¨ç¼–è¾‘å™¨ä¸­çš„ statï¼Œä»¥åŠåœ¨ç¼–è¾‘å™¨çª—å£ä¸­ç”¨ Shader å¤æ‚åº¦çš„è§†å›¾æ¨¡å¼ã€‚
- å¦‚æœä¸€ä¸ªè´´å›¾å¯ä»¥åœ¨è¾ƒå°çš„æ¯”ä¾‹ä¸‹è¢«ç”¨åˆ°ï¼Œåº”ä¸€ç›´éƒ½ä¸ºå®ƒé‡‡ç”¨ mipmapsï¼Œå¯ä»¥é¿å…å› ä¸ºè´´å›¾ç¼“å­˜çš„æœªå‘½ä¸­å¯¼è‡´çš„æ€§èƒ½ä¸‹é™ã€‚
- æœ‰äº›æè´¨è¡¨è¾¾å¼ä¼šæ¯”å…¶ä»–æ›´èŠ±è´¹æ€§èƒ½ï¼ˆsin, pow, cos, divide, Noiseï¼‰ã€‚æœ€å¿«çš„å‡ ä¸ªè¡¨è¾¾å¼æ˜¯ï¼šmultiply, add, subtract, ä»¥åŠä½¿ç”¨ 0 å’Œ 1 çš„ clamp()ã€‚
- ç€è‰²æ¨¡å¼æœ¬èº«å…·æœ‰ä¸€å®šçš„æ€§èƒ½å¼€é”€ï¼šæ— å…‰æ¨¡å¼æœ€å¿«ï¼Œå…‰ç…§æ¨¡å¼åº”è¯¥åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ä½¿ç”¨ã€‚å…¶ä»–æ¨¡å¼éƒ½ä¼šè´¹ä¸€äº›ã€‚

å¯¹äºå…³å¡è®¾è®¡å¸ˆè€Œè¨€

- æ§åˆ¶å›ºå®šå…‰ç…§å’ŒåŠ¨æ€å…‰ç…§çš„æ•°é‡ã€‚
- åŒºåŸŸå…‰ç…§æºä¼šæ›´è´¹ä¸€äº›ï¼Œåº”å½“åœ¨å¯èƒ½çš„æƒ…å½¢ä¸‹é¿å…ä½¿ç”¨ã€‚
- æ ¹æ®è¾ƒå°çš„ç‰©ä½“æ¥è°ƒæ•´ç»˜åˆ¶è·ç¦»ï¼Œæ¥è¾¾åˆ°æ›´å¥½çš„è£å‰ªæ•ˆæœã€‚
- ç¡®è®¤ LOD æ˜¯è®¾ç½®åœ¨ä¸€ä¸ªæ¯”è¾ƒæ¿€è¿›çš„èŒƒå›´å˜åŒ–ä¸Šã€‚LOD çš„é¡¶ç‚¹æ•°é€šå¸¸åº”è¯¥æ˜¯ 2x çš„å˜åŒ–ã€‚è¦åšè¿™ä¸ªä¼˜åŒ–çš„æ—¶å€™ï¼ŒæŸ¥çœ‹çº¿æ¡†æ¨¡å¼ï¼Œä¸€æ•´å—åŒºåŸŸé¢œè‰²å°±è¯´æ˜å­˜åœ¨é—®é¢˜ã€‚ä½¿ç”¨æ•´åˆçš„ Simplygonï¼Œè¿™ä¸ªè¿‡ç¨‹å¾ˆå¿«çš„ã€‚
- å°½é‡å°†ç±»ä¼¼ä¿¡æ¯çš„å…‰æºåˆå¹¶ã€‚æ¯”å¦‚ï¼Œè½¦çš„å¤´ç¯å¯ä»¥ç”¨ä¸€ä¸ªå…‰æºä»¥åŠä¸€ä¸ªå…‰ç…§å‡½æ•°è®©å®ƒçœ‹èµ·æ¥æ˜¯ä¸¤ä¸ªç¯çš„æ•ˆæœã€‚
- é™æ€å…‰ç…§æœ€å¿«ï¼Œå›ºå®šå…‰ç…§ç¨æ…¢ä¸€äº›ï¼ŒåŠ¨æ€å…‰ç…§æœ€æ…¢ã€‚
- æŒ‰ç…§éœ€è¦ï¼Œå°½é‡é™åˆ¶å…‰ç…§çš„è¡°å‡åŠå¾„ä»¥åŠå…‰é”¥çš„è§’åº¦ã€‚
- åŠ¨æ€/å›ºå®šç‚¹å…‰æºæ˜¯æœ€è´¹çš„ã€‚æ–¹å‘å…‰æºè¦ç¨å¥½ä¸€äº›ï¼Œæœ€å¥½çš„æ˜¯èšå…‰ç¯å…‰æºã€‚é˜´å½±è´´å›¾ç”Ÿæˆçš„æ€§èƒ½å¼€é”€æ ¹æ®é€ æˆé˜´å½±çš„ç‰©ä½“çš„å…‰ç…§é”¥ä½“æœ‰å…³ã€‚
- å…‰ç…§å‡½æ•°å…·æœ‰é¢å¤–çš„æ€§èƒ½å¼€é”€ï¼ˆå®é™…å¼€é”€å–å†³äºæè´¨ï¼‰ï¼Œå¹¶èƒ½é˜²æ­¢ç¯å…‰è¢«æ¸²æŸ“æˆ Tiled Lightã€‚
- IES profiles å…·æœ‰é¢å¤–æ€§èƒ½å¼€é”€ï¼ˆæ¯”å…‰ç…§å‡½æ•°å¥½ä¸€äº›ï¼‰ï¼Œå¹¶èƒ½é˜²æ­¢ç¯å…‰è¢«æ¸²æŸ“æˆ Tiled Lightã€‚ä½†ä¸è¦åœ¨å¯ä»¥ç”¨èšå…‰ç¯å…‰é”¥å°±èƒ½å®Œæˆæ•ˆæœçš„æƒ…å½¢ä¸‹ï¼Œè¿˜ä½¿ç”¨ IESã€‚
- Billboardsï¼Œimposter meshesï¼Œæˆ– skybox textures éƒ½èƒ½ç”¨æ¥ä»£æ›¿å®é™…çš„å‡ ä½•ä½“ç‰©ä»¶å¹¶æœ‰æ•ˆçš„æé«˜æ€§èƒ½ã€‚
- å¥½çš„å…³å¡è®¾è®¡å¸ˆèƒ½å¤Ÿå°†é®è”½è£å‰ªçº³å…¥è€ƒè™‘ä¼˜åŒ–å…³å¡ï¼ˆæ·»åŠ ä¸€äº›é˜»æŒ¡è§†çº¿çš„ç‰©ä»¶æ¥æé«˜æ€§èƒ½ï¼‰ã€‚ä½¿ç”¨ r.VisualizeOccludedPrimitives å¯ä»¥ç›´æ¥æŸ¥çœ‹ã€‚
- é¿å…ä½¿ç”¨ Light Propagation Volumes æˆ–è€…é€šè¿‡ä½¿ç”¨ GIReplace æè´¨è¡¨è¾¾å¼æ¥é™åˆ¶å®ƒï¼Œæˆ–è€…åœ¨å¸¦éƒ¨åˆ†ç‰©ä»¶ä¸Šç¦ç”¨å®ƒã€‚
- åœ¨ä¸éœ€è¦çš„åœ°æ–¹åº”è¯¥å…³é—­é˜´å½±ç”Ÿæˆï¼Œä¸€ä¸ªä¸ªç‰©ä»¶çš„å…³é—­ï¼Œæˆ–è€…ä¸€ä¸ªä¸ªç¯å…‰æ¥å…³é—­ã€‚
- åœ¨ç¼–è¾‘å™¨ä¸­ä½¿ç”¨ ProfileGPUï¼ˆCtrl + Shift + ,ï¼‰å¿«é€Ÿäº†è§£ä¿¡æ¯ä»¥åŠå“ªéƒ¨åˆ†æ¯”è¾ƒæ…¢ã€‚
- è´´èŠ±çš„æ€§èƒ½å¼€é”€å’Œå®ƒä»¬è¦†ç›–çš„åƒç´ æ•°é‡æœ‰å…³ã€‚

## âš¡ Scalability æ€§èƒ½è°ƒæ•´
- https://docs.unrealengine.com/4.27/zh-CN/TestingAndOptimization/PerformanceAndProfiling/Scalability/

å¯å»¶å±•æ€§ï¼ˆ*Scalability*ï¼‰ä¸ä»…ä»…æ˜¯æŒ‡å›¾å½¢è®¾ç½®æ–¹é¢ï¼Œè¿˜æ¶‰åŠåˆ°é€‰æ‹©ç›®æ ‡å¹³å°åŠé€‰æ‹©é€‚åˆè¯¥å¹³å°çš„ç¾æœ¯æ•ˆæœã€æ¸¸æˆå¯ç©æ€§ã€éŸ³æ•ˆã€äººå·¥æ™ºèƒ½åŠä»»ä½•å…¶ä»–å­ç³»ç»Ÿã€‚å¯¹äºä¸»æœºå¹³å°æ¥è¯´ï¼Œå› ä¸ºå¹³å°æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥è¿™æ›´ç®€å•ä¸€äº›ã€‚ä½†æ˜¯ï¼Œå¯¹äºç”±å¤šä¸ªä¸åŒè®¾å¤‡æ„æˆçš„PCå¹³å°æ¥è¯´ï¼Œä»…é’ˆå¯¹ä¸€ç§å•ç‹¬çš„ç¡¬ä»¶è§„æ ¼è¿›è¡Œåˆ¶ä½œæ˜¯ä¸å¯èƒ½çš„ã€‚

è¿™å°±æ˜¯å¯å»¶å±•æ€§é€‰é¡¹å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ï¼Œä½†å³ä¾¿åœ¨ä¸ªä½“å¼€å‘äººå‘˜éœ€è¦è°ƒæ•´è¿™äº›é€‰é¡¹ä¹‹å‰ï¼Œä»–ä»¬è¿˜æ˜¯å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼Œæ¥ç¡®ä¿ä»–ä»¬æ‰€åˆ¶ä½œçš„åº”ç”¨ç¨‹åºå¯ä»¥åœ¨ä»–ä»¬é€‰æ‹©çš„æœ€ä½é…ç½®è§„æ ¼ä¸Šè¿è¡Œã€‚

ä¸åŒçš„æœºå™¨å¯ä»¥å…·æœ‰ä¸åŒçš„ æ€§èƒ½/å†…å­˜/è´¨é‡ ç‰¹æ€§ï¼Œæ¯”å¦‚ï¼š

- ç¡¬ç›˜ å¤§å°/å»¶è¿Ÿæ—¶é—´/å¸¦å®½
- ä¸»å†…å­˜ å¤§å°/å»¶è¿Ÿæ—¶é—´/å¸¦å®½ï¼Œè¿è¡Œ 32 ä½ç¨‹åºè€Œä¸æ˜¯ 64 ä½å¯ä»¥è¿›ä¸€æ­¥é™åˆ¶è¯¥é¡¹è¦æ±‚ã€‚
- CPU (ä¸€ä¸ªæˆ–å¤šä¸ªä¸»å¤„ç†å™¨ã€è¶…çº¿ç¨‹ã€SSE åŠŸèƒ½ã€åˆ†æ”¯é¢„æµ‹)
- GPU (å†…å­˜ã€å¤šä¸ª GPUã€å¸¦å®½ã€åŠŸèƒ½ã€å…±äº«å†…å­˜)
- åˆ†è¾¨ç‡ï¼ˆç°åœ¨çš„ç¬”è®°æœ¬å…·æœ‰é«˜åˆ†è¾¨ç‡æ˜¾ç¤ºå™¨ï¼Œä½†å´ä»…å…·æœ‰è¾ƒæ…¢çš„ GPUï¼‰

ä¸€èˆ¬ï¼Œå›¾å½¢æ˜¯æœ€å®¹æ˜“è°ƒæ•´çš„ï¼Œä¸éœ€å¤ªå¤šåœ°å½±å“æ¸¸æˆæ€§ã€‚ç©å®¶ä¸€èˆ¬æ¥å—å¯å»¶å±•æ€§è¿™ä¸ªæ¦‚å¿µï¼Œä½†æ˜¯ä»…æœ‰å°‘æ•°ç©å®¶ä¼šä¸»åŠ¨åœ°è·³è½¬åˆ°è¿™äº›é€‰é¡¹èœå•å¹¶è¿›è¡Œé€‚å½“åœ°è°ƒæ•´ã€‚é€‰é¡¹å±å¹•é€šå¸¸å……æ–¥ç€å¤§é‡çš„é€‰é¡¹å’Œå“äººçš„åç§°ã€‚å½“ç„¶ï¼Œè¿˜ä¸ºç©å®¶æä¾›äº†å¾ˆå¤šé€‰é¡¹ï¼Œä¾›ä»–ä»¬åšå‡ºå¾ˆå¤šä¸»è§‚çš„ã€æŠ˜ä¸­çš„é€‰æ‹©ï¼š

- å¸§æ•°
- åˆ†è¾¨ç‡
- å›¾åƒè´¨é‡
- è¿åŠ¨æ¨¡ç³Š
- è´´å›¾ç»†èŠ‚
- é—ªçƒï¼ˆæŠ—é”¯é½¿ï¼‰
- ç”µæ± å¯¿å‘½

è¦åœ¨ç¼–è¾‘å™¨ä¸­è®¿é—®å¯å»¶å±•æ€§è®¾ç½®ï¼Œå¯ä½¿ç”¨å·¥å…·æ ä¸­çš„ Settings èœå•ã€‚å¼•æ“å¯å»¶å±•æ€§è®¾ç½®ï¼ˆEngine Scalability Settingsï¼‰ åŒ…å« BaseScalability.ini æ–‡ä»¶ä¸­å®šä¹‰çš„æœ€å¸¸ç”¨è®¾ç½®ï¼Œè€Œ æè´¨è´¨é‡çº§åˆ«ï¼ˆMaterial Quality Levelï¼‰è®¾ç½®å…¨å±€æè´¨è´¨é‡è®¾ç½®ã€‚

å·¥å…·æ è®¾ç½® Settings -> Engine Scalability Settingsã€‚

æè´¨å¯ä»¥ä½¿ç”¨ Quality Switch æè´¨è¡¨è¾¾å¼è“å›¾èŠ‚ç‚¹æ¥ç¦ç”¨å¯¹æœ€ç»ˆæ•ˆæœå½±å“è¾ƒå°çš„é«˜æˆæœ¬æè´¨éƒ¨åˆ†ã€‚è¦æŸ¥çœ‹è¯¥è¡¨è¾¾å¼æ•ˆæœï¼Œéœ€è¦åˆ‡æ¢åˆ° Low Quality æ¨¡å¼ã€‚

æ— è®ºæè´¨è´¨é‡çº§åˆ« Material Quality Level è®¾ç½®ä¸ºä½è¿˜æ˜¯é«˜ï¼Œå®ƒéƒ½èƒ½å†³å®šé’ˆå¯¹è¯¥æè´¨è¦è¯„ä¼°å“ªäº›è¡¨è¾¾å¼ï¼ˆä½æˆ–é«˜å¼•è„šï¼‰ã€‚å¦‚æœé«˜å’Œ/æˆ–ä½æ²¡æœ‰è¾“å…¥ï¼Œåˆ™é»˜è®¤å¼•è„šå°†æ›¿ä»£é«˜æˆ–ä½ã€‚è®¾ç½®ä¸ºé«˜æ—¶ï¼Œè¯¥æè´¨åŒ…å«2ä¸ªåˆç†çš„é«˜æˆæœ¬æŸæ—å™ªç‚¹è¿ç®—ã€‚

éª¨æ¶ç½‘æ ¼ä½“å¯ä»¥æœ‰é™æ€ç»†èŠ‚å±‚æ¬¡æ¨¡å‹ï¼Œé€šè¿‡æ§åˆ¶å°å˜é‡ r.SkeletalMeshLODBiasï¼Œå¯ä»¥å…¨å±€è®© LOD å±‚æ¬¡æœ‰åå·®ã€‚

å¯ä»¥ä½¿ç”¨æ§åˆ¶å°å‘½ä»¤è®¿é—®å’Œè®¾ç½®ç›¸å…³å˜é‡ï¼Œä½¿ç”¨åå¼•å·æŒ‰é”®æ‰“å¼€æ§åˆ¶å°ï¼Œç›´æ¥åœ¨æ§åˆ¶å°å˜é‡åæŒ‡å®šä¸€ä¸ªå€¼å°±å¯ä»¥è®¾ç½®ï¼š

- r.ScreenPercentage åˆ†è¾¨ç‡ç¼©æ”¾ï¼Œä½¿ç”¨ 10-100 ä¹‹é—´çš„å€¼ï¼Œ-1 ç­‰åŒäº 100%ã€‚
- r.ViewDistanceScale è§†å›¾è·ç¦»ç³»æ•°ï¼Œå¯ä»¥å¯¹ç¦»è§‚å¯Ÿè€…å¤§äºä¸€å®šè·ç¦»çš„å¯¹è±¡å‰”é™¤ï¼Œ1.0ï¼ˆé»˜è®¤å€¼ï¼‰
- r.PostProcessAAQuality æŠ—é”¯é½¿çº§åˆ« 0 ~ 6ï¼Œ0:low, 1:med, 2:high, 3:epic, 4:cinematic, default: 3ã€‚
- r.DetailMode ä¸‰ä¸ªçº§åˆ«ï¼Œ0 ä¸ºä½ç»†èŠ‚æ¨¡å¼ï¼Œ1 ä¸ºä¸­ç­‰ç»†èŠ‚æ¨¡å¼ï¼Œ2 è¡¨ç¤ºé«˜ç»†èŠ‚æ¨¡å¼ï¼Œæ˜¾ç¤ºæ‰€æœ‰ç»†èŠ‚ã€‚
- sg.PostProcessQuality åæœŸå¤„ç†ï¼Œ0:low, 1:med, 2:high, 3:epic, 4:cinematic, default: 3
- sg.ShadowQuality é˜´å½±è´¨é‡ï¼Œ0:low, 1:med, 2:high, 3:epic, 4:cinematic, default: 3
- sg.TextureQuality çº¹ç†è´¨é‡ï¼Œ0:low, 1:med, 2:high, 3:epic, 4:cinematic, default: 3
- sg.EffectsQuality ç‰¹æ•ˆè´¨é‡ï¼Œ0:low, 1:med, 2:high, 3:epic, 4:cinematic, default: 3
- sg.FoliageQuality æ¤è¢«è´¨é‡ï¼Œ0:low, 1:med, 2:high, 3:epic, 4:cinematic, default: 3

æ¯ä¸ª Actor éƒ½æœ‰ä¸€ä¸ªç»†èŠ‚æ¨¡å¼å±æ€§ Details -> Rendering -> Detail Modeï¼Œæœ¬è´¨ä¸Šè¯¥è®¾ç½®å®šä¹‰çš„æ˜¯Actoræ¸²æŸ“çš„æœ€ä½ç»†èŠ‚å±‚æ¬¡ã€‚

ä¹Ÿå¯ä»¥åœ¨è“å›¾ä¸­ï¼Œä½¿ç”¨ Execute Console Command èŠ‚ç‚¹æ‰§è¡Œå‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨ Append èŠ‚ç‚¹æ„é€ å‘½ä»¤å­—ç¬¦ä¸²ã€‚

## âš¡ Profiler å·¥å…·
- https://docs.unrealengine.com/4.27/zh-CN/TestingAndOptimization/PerformanceAndProfiling/Profiler

åˆ†æå·¥å…·ï¼ˆProfilerï¼‰æ˜¯å¯¹è™šå¹»å¼•æ“ 3 ä¸­çš„ StatsViewer å·¥å…·çš„æ›¿ä»£ï¼Œå®ƒæ”¶é›†å¹¶è·Ÿè¸ªæ¸¸æˆæ•°æ®ï¼Œç›‘æ§æ¸¸æˆæ€§èƒ½ã€‚æ­¤æ•°æ®å¯ç”¨äºç¡®å®šæ¸¸æˆä¸­æ•…éšœå’Œé€Ÿåº¦å‡æ…¢çš„åŸå› ã€‚

å¦‚ä½ å¯¹æ€§èƒ½è°ƒè¯•äº†è§£ä¸å¤šï¼Œè¯·å…ˆæŸ¥é˜… æ€§èƒ½åŠåˆ†æ æ–‡æ¡£ï¼Œå…¶ä¸­åŒ…å«çš„æŠ€å·§å°†æŒ‡å¯¼ä½ å¯¹æ¸¸æˆæ€§èƒ½è¿›è¡Œç›‘æ§ã€‚

å¯ç”¨åˆ†æå·¥å…·å¹¶æ”¶é›†æ•°æ®çš„æ–¹æ³•æœ‰å³æ—¶è¿æ¥å’ŒåŠ è½½ä¹‹å‰é‡‡é›†çš„æ•°æ®ä¸¤ç§ï¼š

- ä½¿ç”¨å‚æ•° -\messaging è¿è¡Œæ¸¸æˆï¼ˆå¦‚ï¼šUE4Editor-Win64-Debug.exe -messagingï¼‰ã€‚
- ä½¿ç”¨å‚æ•° -\messaging è¿è¡Œ UFEï¼ˆå¦‚ï¼šUnrealFrontend-Win64-Debug.exe -messagingï¼‰ã€‚
- æŒ‰ä¸‹ Profiler æ ‡ç­¾å·¥å…·æ ä¸Šçš„ Load æŒ‰é’®å¹¶é€‰æ‹©ä¸€ä¸ª .ue4stats æ–‡ä»¶ã€‚
- å°†æ¥è‡ªæµè§ˆå™¨æˆ–å…¶ä»–æ–‡ä»¶ç®¡ç†å™¨çš„ stats æ–‡ä»¶æ”¾å…¥ Profiler çª—å£ã€‚

ä¹Ÿå¯ä»å¼•æ“å®‰è£…ç›®å½•ä¸‹ Binaries æ–‡ä»¶å¤¹è¿è¡Œå•ç‹¬çš„ UnrealFrontEnd.exeï¼Œä»¥ä¾¿è®¿é—® Session FrontEnd å’Œ Profiler æ ‡ç­¾ã€‚

Profiler å·¥å…·çª—å£å’Œ UI ç»„ä»¶ï¼š

- Connected Session å’Œ Session Information çª—å£ - ç”¨ä½œè·å– stats æ•°æ®çš„ä¼šè¯ã€‚
- Main Toolbar çª—å£ - åŒ…å«åŸºç¡€æ•´ä½“åŠŸèƒ½ã€‚
- Data Graph Full  çª—å£ - åŒ…å« stats å›¾åƒå±•ç¤ºçš„å…¨è²Œã€‚
- Data Graph çª—å£ - stats å›¾åƒå±•ç¤ºã€‚
- Filter and Presets å’Œ é¢„è®¾ çª—å£ - åŒ…å«æ‰€æœ‰ stats å’Œç¾¤ç»„ï¼ˆç”¨æˆ·å¯å¯¹è¿™äº› stats å’Œç¾¤ç»„è¿›è¡Œè¿‡æ»¤å’Œæ’åºï¼‰ã€‚
- Event Graph  çª—å£ - ä»¥äº‹ä»¶å›¾è¡¨æ˜¾ç¤ºæ‰€é€‰å¸§ã€‚


# ğŸŒŸ Animations åŠ¨ç”»
- The Animator's Survival Kit Animated åŠ¨ç”»å¸ˆæ±‚ç”Ÿæ‰‹å†Œ
- Unreal Engine + Substance Designer + Blender è¥¿éƒ¨å°é•‡ https://www.bilibili.com/video/BV1JP4y187Bz
- UE5 - Learn to Create Professional Cinematics https://www.bilibili.com/video/BV1Sf4y1873i?p=10
- åŠ¨ç”»ç³»ç»Ÿæ¦‚è¿° https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/Overview/
- spine-ue4 http://zh.esotericsoftware.com/spine-ue4
- Spine Examples https://github.com/EsotericSoftware/spine-runtimes/tree/4.0/examples
- Spine User Guide http://esotericsoftware.com/spine-user-guide
- DragonBonesPro https://dragonbones.github.io/en/index.html
- Spine é›¶åŸºç¡€æ•™ç¨‹ å¾…æœº/èµ°/è·‘åŠ¨ç”» https://www.bilibili.com/video/BV1eZ4y1P7ec
- Spine æ¼”ç¤ºè¿ªå£«å°¼åŠ¨ç”»åäºŒåŸåˆ™ https://www.bilibili.com/video/BV1Nz4y127sM
- Rhubarb Lip Sync for Spine https://github.com/DanielSWolf/rhubarb-lip-sync
- [PhotoshopToSpine.jsx](https://github.com/EsotericSoftware/spine-scripts)


ç®€å•äº†è§£ä¸€ä¸‹åŠ¨ç”»ç³»ç»Ÿï¼Œæ‰€æœ‰æ¸¸æˆåŠ¨ç”»æŠ€æœ¯çš„å‰èº«æ˜¯ä¼ ç»ŸåŠ¨ç”» Traditional animation æˆ–æ‰‹ç»˜åŠ¨ç”»ï¼Œæœ€æ—©æœŸçš„å¡é€šåŠ¨ç”»ã€‚è¿™ç§åŠ¨ç”»çš„åŠ¨æ„Ÿç”±è¿ç»­å¿«é€Ÿæ˜¾ç¤ºä¸€ä¸²é™æ­¢å›¾ç‰‡æ‰€äº§ç”Ÿï¼Œè¿™äº›å›¾ç‰‡ç§°ä¸ºå¸§ frameã€‚è€Œç›¸åº”çš„ç”µå­ç‰ˆå°±æ˜¯ Sprite Animationï¼Œå°†å…·æœ‰åŠ¨ä½œè¿ç»­æ€§çš„å¤šå¼ å›¾ç‰‡ä¾æ¬¡å±•ç¤ºå°±æ˜¯åŠ¨ç”»ï¼ŒPaper2D ä¸­æä¾›çš„ Flipbook å°±æ˜¯è¿™ç§æŠ€æœ¯ã€‚

ç”µå­åŠ¨ç”»çš„ä¸‹ä¸€ä¸ªé˜¶æ®µå°±æ˜¯åˆšä½“ç»“æ„åŠ¨ç”» Rigid Hierarcical Animationï¼Œå°±åƒæ˜¯çš®å½±æˆï¼Œå°†ä¸€ä¸ªæ•´ä½“å½¢è±¡æŒ‰å…³èŠ‚ç»“æ„æ‹†æˆå°å—ï¼Œç„¶åç»™å„ä¸ªå°å—å•ç‹¬åˆ¶ä½œè¿åŠ¨æ•ˆæœå†ç»„è£…åœ¨ä¸€èµ·ï¼Œè¿™ç§æ–¹æ³•çš„å¥½å¤„æ˜¯å¯ä»¥ç”¨ç¨‹åºå®ç°æ§åˆ¶ï¼Œä½†æ˜¯æ¥åˆéƒ¨ä¼šæœ‰è¿æ¥ä¸é¡ºç•…çš„å›¾åƒã€‚

æ¥ä¸‹æ¥çš„è’™çš®åŠ¨ç”»æŠ€æœ¯è§£å†³äº†åˆšä½“ç»“æ„åŠ¨ç”»çš„ç¼ºç‚¹ï¼Œå®ƒä¸ç”¨è¿›è¡Œæ‹†è§£è¿‡ç¨‹ï¼Œè€Œæ˜¯é€šè¿‡æ•°å­¦ä¸Šçš„å˜æ¢ï¼Œä½¿ç”¨ä¸€ä¸ªè’™çš®çŸ©é˜µæ¥å½¢æˆè¿ç»­çš„è¿åŠ¨å›¾åƒï¼ŒåŸå›¾å°±åƒçš®è‚¤ä¸€æ ·æŒ‰å˜æ¢çŸ©é˜µè¿›è¡Œæ‹‰ä¼¸æˆ–å‹ç¼©ã€‚è¿™ç§æ–¹æ³•ä½¿ç”¨äº†éª¨éª¼å’Œå…³èŠ‚çš„æ¦‚å¿µï¼Œè’™çš®å¦‚ä½•æ‹‰ä¼¸ï¼Œå–å–å†³äºéª¨éª¼å’Œå…³èŠ‚çš„è®¾ç½®ã€‚

ç°ä»£çš„åŠ¨ç”»æŠ€æœ¯è¶Šæ¥è¶Šæ·±å…¥ï¼Œå·²ç»å¯ä»¥åšåˆ°æ¨¡æ‹Ÿäººè„¸çš„è‚Œè‚‰è¿åŠ¨ï¼Œå¯ä»¥ç»™æ¨¡å‹ç›´æ¥æ‘†å§¿åŠ¿ï¼Œå¹¶æŒ‰åŠ¨ç”»åºåˆ—æ’­æ”¾å‡ºæ¥ã€‚åˆ©ç”¨æ’å€¼æŠ€æœ¯ï¼Œç»“åˆå…³é”® Posesï¼Œå¯ä»¥è‡ªåŠ¨ç”Ÿæˆè¡¥é—´åŠ¨ç”»ã€‚

å¸¸ç”¨çš„æŠ€æœ¯è¿˜æœ‰å…³èŠ‚è‡ªåŠ¨ï¼ŒIKï¼ˆInverse Kinematicsï¼‰åå‘è¿åŠ¨å­¦ï¼Œæ˜¯æŒ‡åœ¨ä¸€ä¸ªç›¸äº’è¿ç»“çš„åŠ¨åŠ›é“¾ä¸­ï¼Œç§»åŠ¨æŸä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼Œå…¶ä»–èŠ‚ç‚¹çš„å‚æ•°ä¼šè‡ªåŠ¨è®¡ç®—ä»¥è¾¾åˆ°æœŸæœ›çš„ä½ç½®ã€‚ç®€è€Œè¨€ä¹‹ï¼ŒIK æ˜¯ç»™æŸä¸ªéª¨éª¼ç›´æ¥è®¾ç½®ä¸€ä¸ªç›®æ ‡ä½ç½®ï¼Œæ¯”å¦‚å°†ä¸¤æ‰‹å›ºå®šåœ¨ä¸€å¤„ï¼Œèº«ä½“å…¶å®ƒéƒ¨ä½çš„çŠ¶æ€é€šè¿‡åå‘è§£ç®—å¾—åˆ°åˆé€‚çš„æ—‹è½¬å’Œä½ç½®ã€‚FKï¼ˆForward Kinematicsï¼‰ï¼Œæ­£å‘è¿åŠ¨å­¦ï¼Œåˆ™æ˜¯æŒ‰é¡ºåºè®¾ç½®æ¯ä¸ªéª¨éª¼çš„ä½ç½®ä¸æ—‹è½¬ã€‚

é€šè¿‡ 3D å»ºæ¨¡å¾—åˆ° Static Meshï¼Œç„¶åå†ä½¿ç”¨éª¨éª¼æ¥æ§åˆ¶é™æ€é£æ ¼æ¨¡å‹å¾—åˆ° Skeletal Mesh éª¨éª¼æ¨¡å‹ï¼Œé€šä¿—æ¥è¯´å°±æ˜¯ç»‘å®šéª¨éª¼åçš„ç½‘æ ¼ä½“ã€‚ç„¶åå†ç»è¿‡æ¨¡å‹çš„æè´¨å¤„ç†ï¼Œç›¸å½“äºè’™çš®ï¼Œæœ€åå°±å¾—åˆ°åœ¨æ¸¸æˆä¸­èƒ½å¤Ÿçœ‹åˆ°çš„è§’è‰²çš„è‚‰èº«ã€‚

ç°ä»£çš„åŠ¨ç”»è½¯ä»¶è¿˜æä¾›å…¶å®ƒç”Ÿäº§åŠ›å·¥å…·ï¼ŒåƒåŠ¨ä½œæ•æ‰ã€é¢éƒ¨è¡¨æƒ…æ•æ‰ç­‰ç­‰ï¼Œå¯ä»¥å¤§å¤§èŠ‚çœåœ¨æ¨¡å‹åŠ¨ä½œä¸Šé¢çš„å·¥ä½œï¼Œå¹¶ä¸”æä¾›æ›´çœŸå®çš„åŠ¨ç”»æ•ˆæœã€‚


Spine æ˜¯éå¸¸ä¸“ä¸šçš„ 2D éª¨éª¼åŠ¨ç”»åˆ¶ä½œè½¯ä»¶ï¼Œå¯ä»¥å¯¼å‡º GIF/PNG/APNG/PSD/JPEG ç­‰å›¾åƒï¼Œæˆ–è€… AVI/MOV è§†é¢‘ã€‚æ¯ä¸€ä¸ª Spine å·¥ç¨‹éƒ½æ˜¯ä»¥éª¨æ¶ä¸ºä¸­å¿ƒï¼Œä»¥åŠ¨ç”»äº§å‡ºï¼Œä»¥å„ç§çº¦æŸã€çš®è‚¤ã€äº‹ä»¶å›¾ç‰‡ã€éŸ³é¢‘ä¸ºè¾…åŠ©å†…å®¹ç»„ç»‡çš„ã€‚èŠ‚ç‚¹æ ‘æ˜¾ç¤ºå„ç§å’Œéª¨æ¶ç›¸å…³çš„èµ„æºï¼Œæ¯ä¸ªå·¥ç¨‹ä¸­å¯ä»¥è®¾ç½®å¤šå¹…éª¨æ¶ï¼Œæ¯å¹…éª¨æ¶ä¸Šå¯ä»¥è®¾ç½®å¤šä¸ªåŠ¨ç”»ã€‚

Spine å¯ä»¥å°†éª¨æ¶åŠ¨ç”»æ•°æ®å¯¼å‡ºä¸º JSON æˆ– *.skel* äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç„¶åç”± Spine è¿è¡Œåº“åŠ è½½ï¼Œå¹¶åƒåœ¨ Spine ä¸­ä¸€æ ·æ˜¾ç¤ºåœ¨å„ç§åº”ç”¨ç¨‹åºä¸­æ’­æ”¾åŠ¨ç”»ã€‚äºŒè¿›åˆ¶æ•°æ®æ¯” JSON å°å¾—å¤šï¼Œåœ¨è¿è¡Œæ—¶è§£æéå¸¸å¿«ã€‚

Spine å¯ä»¥å°†å›¾ç‰‡æ‰“åŒ…åˆ°çº¹ç†å›¾é›†æˆ–ç½‘æ ¼(ç²¾çµè¡¨å•)ä¸­ï¼Œä»¥ä¾¿åœ¨è¿è¡Œæ—¶æ›´é«˜æ•ˆåœ°æ¸²æŸ“ã€‚Spine çš„çº¹ç†æ‰“åŒ…å™¨æ˜¯ä¸€ä¸ªé€šç”¨å·¥å…·ã€‚è™½ç„¶å®ƒå¯ä»¥ç”¨äºä½ çš„ Spine éª¨æ¶ï¼Œä½†ä¹Ÿå¯ä»¥å•ç‹¬è¿è¡Œä»¥æ‰“åŒ…ä½ çš„åº”ç”¨ç¨‹åºçš„æ‰€æœ‰å›¾ç‰‡ã€‚

åœ¨å¤§å¤šæ•°å›¾å½¢ API ä¸­ï¼Œå¦‚ OpenGLï¼Œç»‘å®šä¸€ä¸ªçº¹ç†ä¼šå®Œæˆä¸€äº›ç»˜å›¾ï¼Œç»‘å®šå¦ä¸€ä¸ªçº¹ç†ä¼šå®Œæˆæ›´å¤šç»˜å›¾ï¼Œä»¥æ­¤ç±»æ¨ã€‚ç»‘å®šçº¹ç†çš„æˆæœ¬ç›¸å¯¹è¾ƒé«˜ã€‚å› æ­¤ç†æƒ³çš„åšæ³•æ˜¯åœ¨è¾ƒå¤§çš„å›¾ç‰‡ä¸Šå­˜å‚¨è®¸å¤šè¾ƒå°çš„å›¾ç‰‡ï¼Œä¸€æ¬¡è¿‡ç»‘å®šè¾ƒå¤§çš„çº¹ç†ï¼Œç„¶åå¤šæ¬¡ç»˜åˆ¶å…¶å„ä¸ªéƒ¨åˆ†ã€‚Spine å¯ä»¥æœ‰æ•ˆåœ°å°†è®¸å¤šè¾ƒå°çš„å›¾ç‰‡æ‰“åŒ…æˆè¾ƒå¤§çš„å›¾ç‰‡ï¼Œä»è€Œå½¢æˆæ‰€è°“çš„â€œçº¹ç†å›¾é›†â€ã€‚

çº¹ç†å›¾é›†ç”±ä¸€ä¸ªæ–‡ä»¶æ‰©å±•åä¸º *.atlas* çš„æ–‡æœ¬æ–‡ä»¶å’Œä¸€ä¸ªæˆ–å¤šä¸ªç§°ä¸ºå›¾é›†é¡µé¢å›¾ç‰‡çš„æ–‡ä»¶ç»„æˆã€‚å›¾é›†æ–‡ä»¶æè¿°æ¯ä¸ªæ‰“åŒ…çš„è¾ƒå°å›¾ç‰‡åœ¨é¡µé¢å›¾ç‰‡ä¸­çš„ä½ç½®ï¼Œç§°ä¸ºå›¾é›†åŒºåŸŸï¼Œè¿™äº›åŒºåŸŸåœ¨å›¾é›†æ–‡ä»¶ä¸­æŒ‰åç§°å¼•ç”¨ã€‚

Sping ä¸ºäº†ç®€åŒ–ç¨‹åºï¼Œåªæ”¯æŒä¸€åˆ°äºŒä¸ªéª¨éª¼çš„ IK çº¦æŸï¼Œå¯ä»¥ä½¿ç”¨å¤šä¸ª IK çº¦æŸå®ç°å¤šçº§éª¨éª¼çš„ IKã€‚å’Œéª¨éª¼çš„å˜æ¢çº¦æŸæˆ–è·¯å¾„çº¦æŸä¸€æ ·ï¼Œè¿™äº›çº¦æŸå™¨æ˜¯éª¨éª¼åŠ¨ç”»çš„å¸¸ç”¨æŠ€æœ¯ã€‚IK çº¦æŸä¸­ï¼ŒåŠ¨ç”»å¸ˆå¯ä»¥é€šè¿‡æ‘†å¸ƒ Target æŒ‡å®šçš„å¯¹è±¡ä½ç½®æ¥è®© IK ç¨‹åºè‡ªè¡Œè®¡ç®—çˆ¶å­éª¨éª¼é“¾çš„ä½ç½®ã€‚è€Œå˜æ¢çº¦æŸä¸­ï¼ŒTarget æŒ‡å®šçš„éª¨éª¼ç›¸å½“æ§åˆ¶å™¨ï¼Œå®ƒçš„ä½ç½®ç­‰ä¿¡æ¯å†³å®šäº†å˜æ¢çº¦æŸä¸­å…³è”éª¨éª¼çŠ¶æ€ã€‚

çº¦æŸé¡ºåºå¾ˆé‡è¦ï¼å¦‚æœåœ¨åº”ç”¨ IK åå¦ä¸€ä¸ªçº¦æŸç§»åŠ¨ç›®æ ‡ï¼Œåˆ™éª¨éª¼ä¸ä¼šæŒ‡å‘è¯¥ IK ç›®æ ‡ï¼Œå¯æ‹–åŠ¨çº¦æŸæ›´æ”¹å®ƒä»¬çš„åº”ç”¨é¡ºåºã€‚

å˜æ¢çº¦æŸå¯å°†éª¨éª¼çš„ä¸–ç•Œæ—‹è½¬ã€å¹³ç§»ã€ç¼©æ”¾å’Œ/æˆ–å‰ªåˆ‡(å…¶å˜æ¢)å¤åˆ¶åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªå…¶ä»–éª¨éª¼ï¼Œå¯¹é«˜çº§è£…é…æœ‰è®¸å¤šå·§å¦™çš„ç”¨é€”ã€‚æœ€ç®€å•çš„æ–¹æ³•æ˜¯ç§»åŠ¨ä¸€ä¸ªéª¨éª¼ï¼Œç„¶åè®©å…¶ä»–éª¨éª¼ä¹Ÿç§»åŠ¨ã€‚å®ƒå¯ç”¨äºæ¨¡æ‹Ÿæœ‰ä¸åŒçˆ¶å¯¹è±¡çš„éª¨éª¼ï¼Œä¾‹å¦‚æ‘˜ä¸‹å¸½å­ã€è£…å¤‡æ­¦å™¨æˆ–æŠ›å‡ºç‰©ä½“ã€‚

åœ¨å˜æ¢çº¦æŸé¢æ¿ä¸­ï¼Œå¯ä»¥è®¾ç½®åç§»é‡ï¼Œç„¶åé€šè¿‡æ··åˆæŒ‡å®šçš„ç™¾åˆ†æ¯”ï¼Œå°†åç§»é‡ä¸æ··çº¦æŸç›®æ ‡çš„æŒ‡å®šå˜æ¢å€¼è¿›è¡Œæ··åˆã€‚æ··åˆé‡æŒ‡å®šçš„ç™¾åˆ†æ¯”å¯ä»¥æ˜¯è´Ÿå€¼ï¼Œè¡¨ç¤ºæŒ‰æ¯”ä¾‹åå‘å åŠ ã€‚å˜æ¢çº¦æŸæä¾›äº†ä¸¤ä¸ªåæ ‡é€‰é¡¹ Local & Relativeï¼Œå¯ä»¥è®¾ç½®å˜æ¢æ“ä½œæ˜¯æŒ‰æœ¬åœ°åæ ‡ã€ç›¸å¯¹å€¼è¿›è¡Œå˜æ¢ï¼Œè¿™æ ·å°±å¯ä»¥ç»™å—çº¦æŸéª¨éª¼è®¾ç½®åˆå§‹å€¼ã€‚

åœ¨è°ƒæ•´å—çº¦æŸéª¨éª¼æ—¶ï¼Œå¯ä»¥æ‰“å¼€ Compensate é¢æ¿ä¸­çš„å›¾ç‰‡å¼€å…³ï¼Œè¿™æ ·å›¾ç‰‡é™„ä»¶ä¸ä¼šå—çˆ¶çº§éª¨éª¼å½±å“ï¼ŒåŒæ ·ä¹Ÿä¸å—ç›´æ¥æ§åˆ¶ç½‘æ ¼çš„éª¨éª¼å½±å“ã€‚

é€šè¿‡è¿™äº›çº¦æŸå·¥å…·ï¼Œå¯ä»¥ä½¿ç”¨å°‘é‡çš„éª¨éª¼æ¥æ§åˆ¶å¤§é‡çš„éª¨éª¼ï¼Œä»¥å®ç°å¤æ‚çš„åŠ¨ç”»æ•ˆæœã€‚ä¾‹å¦‚ï¼Œ2.5D å¤´éƒ¨è£…é…ï¼Œé€šè¿‡æ§åˆ¶å™¨çš„æ—‹è½¬ï¼Œæ¥æ§åˆ¶çœ¼ç›ã€è€³æœµã€é¼»å­ã€è½®å»“éƒ¨åˆ†å…³è”çš„éª¨éª¼ï¼Œå¯ä»¥éå¸¸çœŸå®åœ°æ¨¡æ‹Ÿå‡º 3D æ•ˆæœã€‚

å®˜æ–¹çš„å˜å½¢äººé¡¹ç›® stretchyman æ¼”ç¤ºé€šè¿‡ä½¿ç”¨ IKã€è·¯å¾„å’Œæƒé‡æ¥åˆ›å»ºå¯ä¼¸ç¼©çš„å››è‚¢ï¼Œå…ˆé€šè¿‡è·¯å¾„çº¦æŸä¸€ç»„åŒçº§çš„éª¨éª¼ï¼Œè¿™ç»„éª¨éª¼ç»‘äº†ç½‘æ ¼æƒé‡ï¼Œç„¶åå†ä½¿ç”¨ IK çº¦æŸçš„éª¨éª¼æ¥æ§åˆ¶é…ç½®äº†æƒé‡çš„è·¯å¾„ï¼Œè¿™æ ·ä½¿ç”¨ç®€å•çš„æ§åˆ¶æ¥ç®€åŒ–åŠ¨ç”»è¿‡ç¨‹ã€‚


æ’æ§½ Slot æ˜¯ä¸€ä¸ªæ”¾ç½®å’Œå„ç§é™„ä»¶å†…å®¹çš„å®¹å™¨ï¼Œä¾‹å¦‚å›¾ç‰‡ï¼Œå›¾ç‰‡é™„ä»¶è¿˜å¯ä»¥è½¬æ¢ä¸ºç½‘æ ¼é™„ä»¶ï¼Œå¹¶ä¸”ç»‘å®šéª¨éª¼åˆ°ç½‘æ ¼ï¼Œå†é€šè¿‡æ§åˆ¶éª¨éª¼æ¥å®ç°é™„ä»¶çš„å„ç§å˜æ¢æ•ˆæœã€‚æ’æ§½å¯ä»¥è®¾ç½®å¡«å……é¢œè‰²ï¼Œä»¥å½±å“é™„ä»¶çš„åŸè²Œã€‚è¿˜æœ‰è´å¡å°”æ›²çº¿è·¯å¾„ã€Bounding Box ç­‰ç­‰é™„ä»¶ï¼Œå®ƒä»¬çš„æ§åˆ¶ç‚¹ä¹Ÿå¯ä»¥ç»‘å®šéª¨éª¼è¿›è¡Œæ§åˆ¶ã€‚

Slot ä¸­å¤šå¼ å›¾åˆ‡æ¢çš„æ–¹å¼ä¹Ÿæ˜¯åœ†å½¢åŒæ­¥åŠ¨ç”»çš„å®ç°æ–¹å¼ï¼Œåƒ Moho æˆ– OpenToonz ç­‰è½¯ä»¶å°±æ˜¯ç±»ä¼¼çš„åŸç†ã€‚ä½¿ç”¨ Rhubarb Lip Sync å¯ä»¥è¯†åˆ«éŸ³é¢‘æ–‡ä»¶ä¸­çš„è¯­éŸ³å£å½¢ä¿¡æ¯ï¼Œå¹¶ç”Ÿæˆç›¸åº”çš„é…ç½®æ•°æ®ä¾›åŠ¨ç”»è½¯ä»¶ä½¿ç”¨ã€‚


å„ç§åŠŸèƒ½é™„ä»¶ç±»å‹å¦‚ä¸‹ï¼š

- å›¾ç‰‡é™„ä»¶ Region Attachmentsï¼šæ”¾ç½®å›¾ç‰‡ï¼Œé€šè¿‡æ‹–åŠ¨å›¾ç‰‡åˆ°éª¨éª¼ä¸­åˆ›å»ºï¼Œæˆ–è€…å¯¼å…¥ï¼›
- ç½‘æ ¼é™„ä»¶ Mesh Attachmentsï¼šå°†å›¾ç‰‡é™„ä»¶è£…å…¥ç½‘æ ¼é™„ä»¶ï¼Œå†å°†éª¨éª¼ç»‘å®šç½‘ç»œæƒé‡è¿›è¡Œæ§åˆ¶ï¼›
- è¾¹ç•Œæ¡†é™„ä»¶ Bounding Boxï¼šä¸€ä¸ªå¤šè¾¹å½¢ï¼Œç”¨äºè¿è¡Œæ—¶ç¨‹åºä¸­è¿›è¡Œç‰©ç†ç¢°æ’æ£€æµ‹ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œæƒé‡æ§åˆ¶å˜å½¢ã€‚
- å‰ªè£é™„ä»¶ Clipping Attachmentsï¼šå¯¹å›¾åƒè¿›è¡Œè£å‰ªï¼Œåªæ˜¾ç¤ºæ›²çº¿æ ‡è®°å†…çš„å›¾åƒï¼›
- è·¯å¾„é™„ä»¶ Path Attachmentsï¼šä½¿ç”¨è´å¡å°”æ›²çº¿ä½œä¸ºéª¨éª¼çš„è¿åŠ¨çº¦æŸè·¯å¾„ï¼›
- ç‚¹é™„ä»¶ Point Attachmentsï¼šç‚¹æ˜¯ç©ºé—´ä¸­å…·æœ‰æ—‹è½¬å’Œä½ç½®å±æ€§çš„ç‚¹ï¼Œå¯ç”¨äºäº§ç”Ÿç²’å­æˆ–ä»»ä½•æ¶‰åŠä½ç½®å’Œ/æˆ–æ—‹è½¬çš„å…¶ä»–ä¸œè¥¿ã€‚

å®˜æ–¹è¿è¡Œæ—¶ä»£ç åº“æä¾›å®Œæ•´ç¤ºä¾‹ï¼Œå¯ä»¥ç›´æ¥å…‹éš†ä¸‹è½½ï¼š

```sh
>git clone git@github.com:EsotericSoftware/spine-runtimes
>git clone -b 4.0 --single-branch git@github.com:EsotericSoftware/spine-runtimes

>git init
>git remote add origin git@github.com:EsotericSoftware/spine-runtimes
#git pull <repository> <branch>
>git pull origin 4.0
>git remote show origin
* remote origin
  Fetch URL: git@github.com:EsotericSoftware/spine-runtimes
  Push  URL: git@github.com:EsotericSoftware/spine-runtimes
  HEAD branch: 4.0
  Remote branches:
    3.5              new (next fetch will store in remotes/origin)
    3.6              new (next fetch will store in remotes/origin)
    3.7              new (next fetch will store in remotes/origin)
    3.7-c            new (next fetch will store in remotes/origin)
    3.8              new (next fetch will store in remotes/origin)
    4.0              new (next fetch will store in remotes/origin)
    4.1-beta         new (next fetch will store in remotes/origin)
    4.1-beta-physics new (next fetch will store in remotes/origin)
    cocos2dx-v4      new (next fetch will store in remotes/origin)
    spine-godot      new (next fetch will store in remotes/origin)
    ts-modules       new (next fetch will store in remotes/origin)
```

Spine ç•Œé¢ä¸­çš„å…³é”®å¸§å›¾æ ‡ä¸åŒé¢œè‰²å«ä¹‰ï¼š

- ğŸ— ç»¿è‰²é’¥åŒ™ï¼šå½“å‰èŠ‚ç‚¹æœ‰è®¾ç½®å…³é”®å¸§ï¼›
- ğŸ— çº¢è‰²é’¥åŒ™ï¼šå½“å‰å¸§æ˜¯èŠ‚ç‚¹çš„å…³é”®å¸§ï¼›
- ğŸ— æ©™è‰²é’¥åŒ™ï¼šå½“å‰å¸§çš„å…³é”®å¸§æ•°æ®æ²¡æœ‰ä¿å­˜ï¼›


äº‹ä»¶å…³é”®å¸§æ˜¯ä¸€ä¸ªæ–¹ä¾¿ç”¨äºç¼–ç¨‹å¤„ç†äº‹ä»¶è§¦å‘æœºåˆ¶ï¼Œåˆ—å¦‚åˆ›å»ºä¸€ä¸ª Attack äº‹ä»¶ï¼Œåœ¨æ’­æ”¾æ”»å‡»åŠ¨ç”»åŒæ—¶åœ¨æ—¶é—´è½´ä¸Šçš„åˆé€‚å¸§ä½ç½®å¯ç”¨ Attack äº‹ä»¶ï¼Œé€šè¿‡èŠ‚ç‚¹æ ‘ä¸­äº‹ä»¶èŠ‚ç‚¹å·¦ä¾§çš„é’¥åŒ™æ ‡è®°åˆ›å»ºäº‹ä»¶å…³é”®å¸§ã€‚è¿™æ ·æ¯æ¬¡æ’­æ”¾æ”»å‡»åŠ¨ç”»æ—¶ï¼Œè¿è¡Œæ—¶å¤„ç†ç¨‹åºéƒ½å¯ä»¥æ£€æµ‹å¹¶å¯¹äº‹ä»¶è¿›è¡Œå¤„ç†ã€‚

äº‹ä»¶å…³é”®å¸§ä¹Ÿå¯ä»¥ç”¨æ¥è§¦å‘å£°éŸ³æ’­æ”¾åŠ¨ç”»ï¼ŒSpine è¿˜ä¼šåœ¨äº‹ä»¶è§¦å‘æ—¶æ˜¾ç¤ºäº‹ä»¶åç§°ä»¥æç¤ºåŠ¨ç”»å¸ˆç›®å‰è§¦å‘äº†ä»€ä¹ˆäº‹ä»¶ã€‚

ä»¥ä¸‹ä»£ç ç‰‡æ®µç¤ºèŒƒå¦‚ä½•é€šè¿‡ Spine è¿è¡Œæ—¶å¯¹äº‹ä»¶è¿›è¡Œç¼–ç¨‹ï¼š

```C++,
    AnimationState state = ...
    state.addListener (new AnimationStateAdapter() {
        public void event (int trakIndex, Event event) {
            if (event.name == "Attack")
                Audio.play(event.name + event.intValue + ".wav");
        }
    })

    TrackEntry entry = state.setAnimation(0, "run", true);
    entry.setListener (new AnimationStateAdapter() {
        public void event (int trakIndex, Event event) {
            if (event.name == "audio")
                Audio.play(event.stringValue);
        }
    })
```


Spine çš„çš®è‚¤åŠŸèƒ½å¯ä½¿ç”¨ä¸åŒçš„é™„ä»¶é›†ï¼Œä»è€Œå®ç°éª¨æ¶åŠ¨ç”»çš„é‡å¤åˆ©ç”¨ã€‚çš®è‚¤å¯ä»¥ç”¨äºç®€å•çš„æœè£…åˆ‡æ¢ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å°†è®¸å¤šä¸åŒçš„éƒ¨ä»¶ç»„åˆæˆå®Œæ•´çš„è§’è‰²ã€‚

å‚è€ƒå®˜æ–¹æä¾›çš„ç¤ºä¾‹ï¼Œgoblins æˆ– mix-and-matchï¼Œåé¢è¿™ä¸ªç¤ºä¾‹æ›´å¤æ‚ï¼Œä¸»è¦æ˜¯ä¸ºå„ä¸ªéƒ¨åˆ†å•ç‹¬è®¾ç½®äº†çš®è‚¤é…ç½®ï¼ŒåŒæ—¶ä½¿ç”¨äº†é£æ ¼æƒé‡ç»‘å®šã€‚è¿™æ ·å°±å¯ä»¥é€‰æ‹©æ˜¾ç¤ºè§’è‰²çš„æŸäº›éƒ¨ä½è¿›è¡ŒåŠ¨ç”»å±•ç¤ºï¼Œå¦‚è¡£æœéƒ¨åˆ†ï¼Œæˆ–è€…å…¶å®ƒé…é¥°å•ç‹¬æ˜¾ç¤ºã€‚

çš®è‚¤ç”±ä»…å½“çš®è‚¤å¯è§æ—¶æ‰å¤„äºæ´»åŠ¨çŠ¶æ€çš„é™„ä»¶ã€éª¨éª¼å’Œçº¦æŸç»„æˆã€‚ä½¿ç”¨çš®è‚¤è§†å›¾ï¼Œéª¨æ¶å¯ä»¥åŒæ—¶æ˜¾ç¤ºå¤šä¸ªçš®è‚¤ã€‚å¯ä»¥å°†éª¨éª¼å’Œçº¦æŸæ·»åŠ åˆ°çš®è‚¤ï¼Œå®ƒä»¬åªæœ‰åœ¨çš®è‚¤å¯è§çŠ¶æ€ä¸‹æ‰ç”Ÿæ•ˆã€‚éª¨éª¼æˆ–çº¦æŸæ·»åŠ åˆ°çš®è‚¤åï¼Œåœ¨èŠ‚ç‚¹æ ‘ä¸­å°±ä¼šæ˜¾ç¤ºä¸€ä¸ªè¡£æœå›¾æ ‡åœ¨å³ä¾§ã€‚çš®è‚¤å ä½ç¬¦çš„å›¾æ ‡æ›´å½¢è±¡ï¼Œæ˜¯ä¸€ä¸ªè¡£æ¶å›¾æ ‡ã€‚

çš®è‚¤çš„å…³é”®æ˜¯éª¨éª¼ä¸Šåˆ›å»ºçš„çš®è‚¤å ä½ç¬¦ *Skin Placeholder*ï¼Œå®ƒæ˜¯ä¸€ç§é™„ä»¶ï¼Œä¸ä»»ä½•å…¶ä»–é™„ä»¶ä¸€æ ·ä½äºå±‚çº§æ ‘ä¸­çš„æ’æ§½ä¸‹ã€‚ä½†æ˜¯ï¼Œå®ƒæ˜¾ç¤ºå‡ºæ¥çš„åªæ˜¯å®é™…ä½¿ç”¨çš„é™„ä»¶ï¼Œè¿™äº›é™„ä»¶æ¥è‡ªå½“å‰å¯è§çš„çš®è‚¤ã€‚

åŠ¨ç”»å¯ä»¥åƒæ˜¾ç¤ºå’Œéšè—é™„ä»¶ä¸€æ ·æ˜¾ç¤ºå’Œéšè—çš®è‚¤å ä½ç¬¦ï¼Œæ–¹æ³•æ˜¯è®¾ç½®æ’æ§½é™„ä»¶çš„å…³é”®å¸§ã€‚è¿™æ ·ï¼ŒåŠ¨ç”»å°±ä¸å†å±€é™äºæ˜¾ç¤ºå’Œéšè—ç‰¹å®šé™„ä»¶ã€‚è€Œé€šè¿‡æ˜¾ç¤ºå’Œéšè—çš®è‚¤å ä½ç¬¦ï¼Œå®é™…æ˜¾ç¤ºçš„é™„ä»¶åˆ™æ¥è‡ªå¯è§çš„çš®è‚¤ï¼Œä»è€Œä½¿åŠ¨ç”»èƒ½å¤Ÿä¸ä»»ä½•çš®è‚¤ä¸€èµ·ä½¿ç”¨ã€‚

åœ¨éª¨éª¼ä¸­åˆ›å»ºåœ¨å‘½åçš®è‚¤å ä½ç¬¦æ—¶ï¼Œåç§°ä¸éœ€è¦æŒ‡æ˜å®ƒç”¨äºå“ªä¸ªçš®è‚¤ï¼Œè€Œåº”è¯¥æ ¹æ®é™„ä»¶ä»£è¡¨çš„åç§°å¯¹å…¶è¿›è¡Œå‘½åã€‚

ä¾‹å¦‚ï¼Œä¸ºå¤´éƒ¨åˆ›å»ºäº† *red* å’Œ *blue* ä¸¤ä¸ªçš®è‚¤ï¼Œåˆ™ *head* å°†æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å¤´éƒ¨çš®è‚¤å ä½ç¬¦åç§°ï¼Œè€Œä¸æ˜¯ red head æˆ– blue headã€‚åœ¨åˆ›å»ºçš®è‚¤å ä½ç¬¦æ—¶å¯ä»¥å‹¾é€‰é‡å‘½åé™„ä»¶ Rename attachments è¿™æ ·ä¼šåœ¨æ¯ä¸ªè¢«å¤åˆ¶çš„é™„ä»¶å‰åŠ ä¸Šçš®è‚¤åç§°ã€‚ä¾‹å¦‚ï¼Œred/head ä»£è¡¨ red çš®è‚¤çš„å¤´éƒ¨ï¼Œåœ¨å°†æ¯ä¸ªçš®è‚¤çš„å›¾ç‰‡ç»„ç»‡åˆ°å­æ–‡ä»¶å¤¹ä¸­æ—¶å¾ˆæœ‰ç”¨ã€‚

çš®è‚¤å¯ä»¥æœ‰ä¸€ä¸ªé™„ä»¶(æˆ–æ— é™„ä»¶)ï¼Œåˆ›å»ºçš®è‚¤åä¿æŒçš®è‚¤è®¾ç½®ä¸ºå½“å‰æ´»åŠ¨çŠ¶æ€ï¼Œå³èŠ‚ç‚¹æ ‘å·¦ä¾§çš„å¯è§†çŠ¶æ€å¤„äºæ¿€æ´»çŠ¶æ€ï¼Œç„¶åå°†å›¾ç‰‡æ‹–åŠ¨åˆ°éª¨éª¼ä¸‹çš„çš®è‚¤å ä½ç¬¦ä¸­ã€‚è®¾ç½®å¥½å„ä¸ªçš®è‚¤çš„é™„ä½“åï¼Œå°±å¯ä»¥é€šè¿‡ Skins èŠ‚ç‚¹ä¸‹çš„çš®è‚¤æ¥åˆ‡æ¢é™„ä»¶çš„æ˜¾ç¤ºï¼Œæˆ–è€…éª¨éª¼ã€çº¦æŸçš„æœ‰æ•ˆçŠ¶æ€ã€‚

å°†é™„ä»¶æ‹–åˆ°çš®è‚¤å ä½ç¬¦ä¸‹çš„é™„ä»¶è¿›è¡Œæ›¿æ¢ï¼Œè€Œä¸æ˜¯æ‹–åˆ°çš®è‚¤å ä½ç¬¦ï¼Œåˆ™å¯ä»¥ä¿ç•™ç°æœ‰é™„ä»¶çš„å˜æ¢ã€‚å¦‚æœæ‹–åˆ°çš®è‚¤ç‚¹ä½ç¬¦ä¸‹ï¼Œåˆ™æ´»åŠ¨çš®è‚¤çš„çš®è‚¤å ä½ç¬¦ä»¥å‰çš„ä»»ä½•é™„ä»¶éƒ½å°†è¢«åˆ é™¤ã€‚

è¦æ¸…é™¤çš®è‚¤å ä½ç¬¦çš„é™„ä»¶ï¼Œè¯·å°†å…¶åˆ é™¤æˆ–æ‹–åŠ¨åˆ°å…¶ä»–ä½ç½®ã€‚

åˆ›å»ºçš®è‚¤å ä½ç¬¦å¹¶é€ä¸ªç§»åŠ¨ç°æœ‰é™„ä»¶éå¸¸ç¹çï¼Œæ›´æœ‰æ•ˆåœ°æ‰§è¡Œæ˜¯ä½¿ç”¨å±‚çº§æ ‘ç­›é€‰å™¨éšè—éª¨éª¼å’Œæ’æ§½ï¼Œä»¥ä¾¿åªæ˜¾ç¤ºé™„ä»¶ã€‚è¿™æ ·å°±å¯ä»¥æ–¹ä¾¿é€‰æ‹©è®¸å¤šé™„ä»¶ï¼Œæ¥ä¸‹æ¥ï¼Œåˆ›å»ºçš®è‚¤æˆ–ç¡®ä¿çš®è‚¤ä¸ºæ´»åŠ¨çŠ¶æ€ï¼Œç„¶åé€‰æ‹©ä½ çš„é™„ä»¶å¹¶é€‰æ‹©æ–°å»º... çš®è‚¤å ä½ç¬¦ã€‚è¿™å°†ä¸ºä½¿ç”¨ç›¸åŒåç§°çš„æ¯ä¸ªé™„ä»¶åˆ›å»ºä¸€ä¸ªçš®è‚¤å ä½ç¬¦ï¼Œå¹¶ä¸”é™„ä»¶å°†ç§»åŠ¨åˆ°æ´»åŠ¨çš®è‚¤çš„çš®è‚¤å ä½ç¬¦ä¸‹ã€‚

é€šå¸¸æ•´å¥—çš®è‚¤å›¾ç‰‡éœ€è¦å•ç‹¬çš„ç›®å½•è¿›è¡Œç®¡ç†ï¼Œä½¿ç”¨æŸ¥æ‰¾æ›¿æ¢åŠŸèƒ½å¯ä»¥å¯¹æ•´ä¸ªé¡¹ç›®ï¼Œæˆ–é€‰ä¸­çš„èŠ‚ç‚¹ï¼Œæˆ–å½“å‰çš®è‚¤ä½¿ç”¨çš„é™„ä»¶è·¯å¾„è¿›è¡Œæ‰¹é‡æ›¿æ¢ã€‚

Spine ä¸º Adobe Photoshop å¯¼å‡ºå›¾å±‚æä¾›äº†è„šæœ¬ PhotoshopToSpine.jsxï¼Œå¯ä»¥å‘½åå›¾å±‚æ¥æŒ‡å®šå›¾å±‚çš„ç”¨é€”ã€‚ä½œä¸ºçš®è‚¤çš„å›¾å±‚å‘½åè§„åˆ™ *[skin]name*ï¼Œæ–¹æ‹¬å·æ ‡è®°å¯ä»¥æ”¾åœ¨å›¾å±‚åç§°çš„ä»»æ„ä½ç½®ï¼Œå¦‚ `head [slot]` or `[slot] head`ï¼Œå…¶å®ƒæ”¯æŒçš„ GroupTag å‚è€ƒè„šæœ¬ä»£ç ç‰‡æ®µï¼š

```js
function isValidGroupTag (tag) {
    switch (tag) {
    case "bone":
    case "slot":
    case "skin":
    case "merge":
    case "folder":
    case "ignore":
        return true;
    }
    if (startsWith(tag, "path:")) return true;
    return false;
}
```

**Group names:**

* `[bone]`  Slot and bone layers in the group are placed under a bone, named after the group. The bone is created at the center of a visible attachment.
* `[slot]`  Layers in the group are placed in a slot, named after the group.
* `[skin]` Layers in the group are placed in a skin, named after the group. Skin images are output in a subfolder for the skin.
* `[merge]` Layers in the group are merged and a single image is output, named after the group.
* `[folder]` Layers in the group will be output in a subfolder. Folder groups can be nested.
* `[ignore]` Layers in the group and any child groups will not be output.

**Layer names:**

* `[ignore]` The layer will not be output.
* `[path:name]` Specifies the image file name, which can be different from the attachment name. Whitespace trimming is required. Can be used on a group with `[merge]`.


å’Œæ”¶è´¹çš„ Spine ä¸åŒï¼ŒDragonBones å®Œå…¨å…è´¹çš„éª¨éª¼åŠ¨ç”»è½¯ä»¶ï¼Œä¹Ÿå¯ä»¥ç®—æ˜¯ Spine å¯¼å‡ºçš„åŠ¨ç”»æ•°æ®æ–‡ä»¶ï¼Œè¢«å„ç§ 2D æ¸¸æˆå¼•æ“å¹¿æ³›é‡‡ç”¨ã€‚æ—§ç‰ˆ DragonBones ä¸æ”¯æŒç›´æ¥è¯»å– skel æ–‡ä»¶ï¼Œå› æ­¤éœ€è¦è½¬æ¢å™¨ã€‚


2D éª¨éª¼åŠ¨ç”»ä¸­çš„å¸¸ç”¨æœ¯è¯­ï¼š

- *éª¨æ¶*ï¼šéª¨æ¶Armature,æ˜¯2Déª¨éª¼åŠ¨ç”»ä¸­æœ€å¸¸ç”¨çš„åè¯ï¼Œä¸€èˆ¬æŒ‡çš„æ˜¯ç”±å¾ˆå¤šéª¨éª¼ç»„æˆçš„ä¸€ä¸ªæ•´ä½“ã€‚DragonBonesä¸­åŒæ—¶ä»£è¡¨ä¸€ä¸ªå¯ä»¥åŒ…å«åŠ¨ç”»çš„è§’è‰²ã€‚

- *éª¨éª¼*ï¼ˆéª¨å¤´ï¼‰ï¼šéª¨æ ¼æˆ–éª¨å¤´Bone,æ˜¯éª¨éª¼åŠ¨ç½‘ä¸­ç»„æˆéª¨æ¶çš„æœ€é‡è¦çš„ä¸€ä¸ªåŸºç¡€å•å…ƒã€‚éª¨å¤´è‡ªèº«ä¸èƒ½æ‹†è§£ï¼Œåœ¨éª¨æ¶ä¸­å¯ä»¥è¿›è¡Œç›¸å¯¹çš„å¹³ç§»ã€æ—‹è½¬ã€ç¼©æ”¾ã€è¿åŠ¨ï¼Œç»„åˆèµ·æ¥å°±å½¢æˆäº†éª¨æ ¼åŠ¨ç”»ã€‚å¦å¤–éª¨éª¼ä¹‹é—´å¯ä»¥æœ‰çˆ¶å­å…³ç³»ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨é»˜è®¤æ­£å‘åŠ¨åŠ›å­¦çš„æƒ…å†µä¸‹ï¼Œçˆ¶éª¨éª¼è¿åŠ¨ä¼šå¸¦åŠ¨å­éª¨éª¼ä¸€èµ·è¿åŠ¨ã€æ¯”å¦‚ä¸€ä¸ªäººç‰©ä¸¾èµ·å¤§è‡‚ï¼Œé‚£å°è‡‚ä½œä¸ºå¤§è‡‚çš„å­éª¨éª¼ï¼Œä¹Ÿä¼šéšä¹‹è¢«æŠ¬èµ·ã€‚

- *æ’æ§½*ï¼šæ’æ§½æ˜¯éª¨éª¼åŠ¨ç”»ä¸­æ˜¾ç¤ºå›¾ç‰‡çš„å®¹å™¨ï¼Œéš¶å±äºéª¨éª¼ã€‚æ¯ä¸ªæ’æ§½å¯ä»¥åŒ…å«å¤šå¼ å›¾ç‰‡ï¼Œä½†æ˜¯åŒä¸€æ—¶é—´åªæ˜¾ç¤ºä¸€å¼ å›¾ç‰‡ã€‚æ¯ä¸ªéª¨æ ¼å¯ä»¥åŒ…å«å¤šä¸ªæ’æ§½ã€‚æ’æ§½é“¾æ¥äº†éª¨éª¼è¿™ä¸ªåŠ¨ç”»é€»è¾‘å•å…ƒå’Œå›¾ç‰‡è¿™ä¸ªåŠ¨ç”»æ˜¾ç¤ºå•å…ƒï¼Œç»„æˆäº†éª¨éª¼-æ’æ§½-å›¾ç‰‡ï¼Œè¿™ä¸ªDragonBoneséª¨éª¼åŠ¨ç”»ä¸­çš„åŸºæœ¬éª¨éª¼ç»“æ„ã€‚

- *å›¾ç‰‡*(çº¹ç†)ï¼šå›¾ç‰‡å°±æ˜¯æ˜¾ç¤ºå›¾åƒçš„å…ƒç´ ï¼Œåœ¨2Déª¨éª¼ç³»ç»Ÿä¸­ï¼Œå›¾ç‰‡å’Œçº¹ç†çš„æ„ä¹‰åŒºåˆ«ä¸å¤§ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿå¯ä»¥å«çº¹ç†ã€‚

- *çº¹ç†é›†*ï¼šçº¹ç†é›†æ˜¯å°†å›¾ç‰‡æ‰“åŒ…ä¹‹åç»„æˆçš„å¤§å›¾ï¼Œæ–¹ä¾¿èµ„æºæ•´åˆä¼ æ’­å’Œåœ¨æ¸¸æˆä¸­åŠ è½½ï¼Œä½¿ç”¨ç¡¬ä»¶åŠ é€Ÿå¼•æ“æˆ–è€…Egret Runtime çš„è¯ï¼Œçº¹ç†é›†èƒ½å¤§å¹…åº¦æé«˜æ¸²æŸ“æ•ˆç‡ã€‚æ‰€ä»¥DragonBonesé»˜è®¤æä¾›çš„å¯¼å…¥èµ„æºçš„æ¥å£å°±æ˜¯ç”¨çº¹ç†é›†ã€‚

- *åŠ¨ç”»è¡¥é—´*ï¼šä¸€èˆ¬è®¾è®¡å¸ˆåœ¨åšéª¨éª¼åŠ¨ç”»çš„æ—¶å€™ï¼Œå¹¶ä¸éœ€è¦åœ¨æ¯å¸§éƒ½ä¸ºè§’è‰²æ‘†åŠ¨ä½œï¼Œè€Œåªæ˜¯åœ¨ä¸€äº›å…³é”®çš„åœ°æ–¹(å…³é”®å¸§)æ‘†å‡ºå…³é”®çš„åŠ¨ä½œï¼Œå…³é”®åŠ¨ä½œä¹‹é—´å…¨éƒ¨ç”±ç¨‹åºç”Ÿæˆçš„è¡¥é—´ä»£æ›¿ï¼Œè¿™å°±æ˜¯åŠ¨ç”»è¡¥é—´ã€‚åŠ¨ç”»è¡¥é—´å¯ä»¥æ˜¯çº¿æ€§çš„ä¹Ÿå¯ä»¥æ˜¯éçº¿æ€§çš„ã€‚çº¿æ€§è¡¥é—´æ„å‘³ç€è¡¥é—´ä¸Šçš„å…ƒä»¶æ˜¯åŒ€é€Ÿå˜æ¢çš„(å¹³ç§»ã€æ—‹è½¬ã€ç¼©æ”¾)ã€‚éçº¿æ€§è¡¥é—´èˆ¬ç”±å„ç§æ›²çº¿è¡¨ç¤ºï¼ŒDragonBones ä¸­é»˜è®¤ä½¿ç”¨è´å¡å°”æ›²çº¿è¡¨ç¤ºéçº¿æ€§è¡¥é—´ã€‚

- *åŠ¨ç”»è¿‡æ¸¡*ï¼šåŠ¨ç”»è¿‡æ¸¡æ˜¯æŒ‡ä»ä¸€ä¸ªåŠ¨ç”»åˆ‡æ¢åˆ°å¦ä¸€ä¸€ä¸ªåŠ¨ç”»æ—¶ï¼Œäº§ç”Ÿçš„è¿‡æ¸¡æ•ˆæœã€‚DragonBonesæä¾›äº†åŠ¨ç”»åŠ¨é¢åˆ‡æ¢æ—¶çš„è¿‡æ¸¡æ•ˆæœåŠŸèƒ½ï¼Œåªè¦è®¾ç½®ä¸€ä¸ªè¿‡æ¸¡æ—¶é—´ï¼Œå°±èƒ½è‡ªåŠ¨ç”Ÿæˆå¹³æ»‘çš„è¿‡æ¸¡æ•ˆæœã€‚

- *åŠ¨ç”»èåˆ*ï¼šåŠ¨é¢èåˆæä¾›äº†ä¸€ä¸ªè§’è‰²åŒæ—¶æ’­æ”¾å¤šä¸ªåŠ¨ç”»çš„åŠŸèƒ½ã€‚è¿™ä¸ªåŠŸèƒ½ä¸€èˆ¬ä¼šåœ¨ä¸¤ç§æƒ…å†µä¸‹ä½¿ç”¨ã€‚ç¬¬1ç§æ˜¯å¦‚ä¸€ä¸ªäººç‰©è§’è‰²åŠ¨ç”»æ¯”è¾ƒå¤æ‚ï¼Œå¯èƒ½éœ€è¦ä¸ŠåŠèº«å’Œä¸‹åŠèº«åˆ†åˆ«åšåŠ¨ç”»è®¾è®¡ï¼Œç„¶åå¯ä»¥ä»»æ„ç»„åˆã€‚ç¬¬2ç§æ˜¯å¦‚éœ€è¦ä¸ªè§’è‰²åœ¨è·‘æ­¥çš„åŒæ—¶ä¸­å¼¹ï¼Œèº«ä½“åä»°ï¼Œä¹Ÿå°±æ˜¯åŒæ—¶æ’æ”¾è·‘æ­¥å’Œä¸­å¼¹çš„åŠ¨ç”»ã€‚åŠ¨ç”»èåˆçš„åŠŸèƒ½é€šè¿‡ç»™ä¸åŒçš„åŠ¨ç”»è®¾ç½®æƒå€¼ï¼Œç»™ä¸åŒçš„éª¨è·¯å¢åŠ åŠ¨ç”»é®ç½©æ¥å®ç°è¿™ä¸¤ç§éœ€æ±‚ã€‚éœ€è¦æ³¨æ„çš„æ˜¯DragonBonesåªæœ‰æ™®é€šæ¨¡å¼æä¾›äº†åŠ¨ç”»èåˆçš„åŠŸèƒ½ï¼Œæé€Ÿæ¨¡å¼æ˜¯ä¸æä¾›è¿™ä¸ªåŠŸèƒ½çš„ã€‚

- *æ­£å‘åŠ¨åŠ›å­¦*(FK)å’Œ*åå‘åŠ¨åŠ›å­¦*(IK)ï¼šåœ¨éª¨éª¼åŠ¨ç”»ä¸­ï¼Œä¸€èˆ¬æ¥è®²ï¼Œå­éª¨éª¼çš„è¿åŠ¨ä¼šå—åˆ°çˆ¶éª¨éª¼çš„å½±å“ï¼Œä¾‹å¦‚å¤§è‡‚æ—‹è½¬ï¼Œå°è‡‚ä¹Ÿä¼šè·Ÿéšæ—‹è½¬ï¼Œè¿™å«ä½œæ­£å‘åŠ¨åŠ›å­¦ï¼Œä¹Ÿå°±æ˜¯çˆ¶äº²å½±å“å­©å­ã€‚å½“ç„¶ç°å®ä¸–ç•Œä¹Ÿå­˜åœ¨åè¿‡æ¥çš„æƒ…å†µï¼Œä¾‹å¦‚æœ‰å…¥æ‰“ä½ ä¸€æ‹³ï¼Œä½ ç”¨å°è‡‚å»é˜»æŒ¡ï¼Œé‚£å°è‡‚å—åŠ›è¿åŠ¨çš„åŒæ—¶ä¹Ÿä¼šå¸¦åŠ¨å¤§è‡‚ä¸€åŒåšå—åŠ›è¿åŠ¨ï¼Œè¿™å«ä½œåå‘åŠ¨åŠ›å­¦ã€‚åœ¨DragonBonesä¸­æ§åˆ¶éª¨è·¯è°ƒèŠ‚åŠ¨ä½œçš„æ—¶å€™ï¼Œä¸€èˆ¬æƒ…å†µéª¨éª¼æ˜¯ç¬¦åˆæ­£å‘åŠ¨åŠ›å­¦è§„å¾‹çš„ï¼Œä¹Ÿå°±æ˜¯è°ƒèŠ‚çˆ¶éª¨éª¼ï¼Œå­éª¨éª¼ä¹Ÿä¼šå—å½±å“ã€‚å¦‚æœå¸Œæœ›é€šè¿‡åå‘åŠ¨åŠ›å­¦è°ƒèŠ‚åŠ¨ç”»ï¼Œå¯ä»¥é€‰é€‰æ‹©ç›¸åº”çš„IKå·¥å…·æ¥å®ç°ã€‚


UE4 çš„åŠ¨ç”»ç³»ç»Ÿä¸»è¦åˆ†ä¸ºä¸¤å¤§ç³»ç»Ÿï¼š

- Sequence Animation åŸºäºåºåˆ—çš„åŠ¨ç”»ç³»ç»Ÿã€‚
- Skeletal Mesh Animation åŸºäºéª¨éª¼çš„åŠ¨ç”»ç³»ç»Ÿã€‚

å¦å¤–ï¼Œåœ¨ 2D Sprite Animation åŠ¨ç”»ç³»ç»Ÿçš„æ”¯æŒä¸Šï¼Œæä¾›äº† Paper2D äºŒç»´æ¸¸æˆç³»ç»Ÿã€‚

éª¨éª¼æ¨¡å‹ä¸»è¦åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š

- æ¨¡å‹çš„é¡¶ã€çº¿ã€é¢ä¿¡æ¯ï¼›
- é¡¶ç‚¹çš„éª¨éª¼è’™çš®æƒé‡ï¼›
- æ¨¡å‹çš„æè´¨ä¿¡æ¯ï¼›
- æ¨¡å‹ LOD ä¿¡æ¯ï¼›
- æ‰€å±éª¨æ¶ï¼›
- Morph Target ä¿¡æ¯ï¼›
- Physics Asset è®¾ç½®ä¿¡æ¯ï¼›
- å¸ƒæ–™ç³»ç»Ÿç›¸å…³è®¾ç½®ï¼›

åŠ¨ç”»åºåˆ—ï¼ˆAnimation Sequenceï¼‰ä¹Ÿä¼šç”¨äºè®°å½•éª¨éª¼è¿åŠ¨çŠ¶æ€ï¼Œä¹Ÿæ˜¯è®©éª¨éª¼åŠ¨åŠ¨èµ·æ¥çš„å…³é”®ä¹‹ä¸€ï¼Œå…¶ä¸»è¦åŒ…å«äº†ä¸€ä¸‹ä¿¡æ¯ï¼š

- åŠ¨ç”»å…³é”®å¸§ä¿¡æ¯ï¼›
- åŒ…å«è¿åŠ¨çš„éª¨éª¼ä¿¡æ¯ï¼›
- æ¯å¸§éª¨éª¼çš„ Transform ä¿¡æ¯ï¼ŒåŒ…å«æ—‹è½¬ã€ä½ç§»å’Œç¼©æ”¾ï¼›
- åŠ¨ç”»é€šçŸ¥ä¿¡æ¯ï¼Œè®°å½•è§¦å‘é€šçŸ¥çš„ç±»å‹å’Œæ—¶é—´ï¼›
- åŠ¨ç”»æ›²çº¿ä¿¡æ¯ï¼Œè®°å½•éšæ—¶é—´è½´å˜åŒ–çš„æ›²çº¿ä¿¡æ¯ï¼›
- å…¶ä»–åŸºç¡€ä¿¡æ¯ï¼ŒåŒ…æ‹¬å åŠ åŠ¨ç”»è®¾ç½®ã€æ ¹éª¨éª¼ä½ç§»è®¾ç½®ç­‰ä¿¡æ¯ï¼›

é€šè¿‡ Content Browser å³é”®èœå•å¯ä»¥åˆ›å»ºçš„ Animation å¯¹è±¡ï¼š

- Aim Offset
- Aim Offset 1D
- Animation Bluprint åŠ¨ç”»è“å›¾ï¼›
- Animation Composite åŠ¨ç”»åˆæˆå™¨ï¼Œå°†å¤šä¸ªåŠ¨ç”»ç»„åˆåœ¨ä¸€èµ·å°†å®ƒä»¬ä½œä¸ºå•ä¸ªå•å…ƒè¿›è¡Œå¤„ç†çš„æ–¹æ³•ï¼›
- Animation Layer Interface
- Animation Montage åŠ¨ç”»è’™å¤ªå¥‡ï¼›
- Animation Sharing Setup
- Blend Space
- Blend Space 1D
- Bone Compression Settings
- Camera Animation Sequence è‡ªå¸¦ Cine Camera Actor çš„åŠ¨ç”»åºåˆ—ï¼›
- Curve Compression Settings
- Level Sequence å…³å¡åºåˆ—ï¼Œé»˜è®¤ä¸å«ä»»ä½•è½¨è¿¹ï¼›
- Paper Flipbook é€å¸§æ’­æ”¾çš„ Sprite Animation åŠ¨ç”»å¯¹è±¡ã€‚
- Pose Asset
- Template Sequence åºåˆ—æ¨¡æ¿ï¼›

`Aim Offset` ç„å‡†åç§»æ˜¯ä¸€ç§èµ„æºï¼Œå®ƒå­˜å‚¨äº†ä¸€ç³»åˆ—å¯æ··åˆçš„å§¿åŠ¿ï¼Œä»¥å¸®åŠ©è§’è‰²ç„å‡†æ­¦å™¨ã€‚ åœ¨åŠ¨ç”»è¿‡ç¨‹ä¸­ï¼Œç„å‡†åç§»çš„ç»“æœä¸å…¶ä»–åŠ¨ä½œï¼ˆå¦‚å¥”è·‘ã€è¡Œèµ°ã€è·³è·ƒç­‰ï¼‰æ··åˆåœ¨ä¸€èµ·ï¼Œä½¿è§’è‰²ä»å„ä¸ªæ–¹å‘ä¸Šçœ‹èµ·æ¥éƒ½å¾ˆå¹³æ»‘ã€‚

ç„å‡†åç§»èƒŒåçš„å…³é”®æ¦‚å¿µæ˜¯ï¼Œå®ƒä»¬è¢«è®¾è®¡æˆä¸ç°æœ‰åŠ¨ç”»è¿›è¡Œé¢å¤–æ··åˆã€‚å› æ­¤ï¼Œæ‰“ä¸ªæ¯”æ–¹ï¼Œå¦‚æœæ‚¨ä½¿ç”¨ç„å‡†åç§»æ¥è®©è§’è‰²ç„å‡†ä¸€ä¸ªæ­¦å™¨ï¼Œæ‚¨ä¼šæƒ³è¦ç¡®ä¿è§’è‰²ä¸Šçš„å…¶ä»–è¿åŠ¨ä¸ä¼šå¦¨ç¢é‚£ä¸ªé™„åŠ è¿åŠ¨ã€‚æ¢å¥è¯è¯´ï¼Œæ‚¨çš„å¥”è·‘ã€ç«™ç«‹ã€è·³è·ƒç­‰æ“ä½œåº”è¯¥å…·æœ‰ç›¸å¯¹åˆšæ€§çš„æ‰‹è‡‚ï¼Œè¿™æ ·å®ƒä»¬å°±å¯ä»¥é€šè¿‡ç„å‡†åç§»è¿›è¡Œé¢å¤–çš„æ§åˆ¶ã€‚

åœ¨å¾ˆå¤šæ–¹é¢ï¼Œç„å‡†åç§»å°±åƒä¸€ä¸ªæ··åˆç©ºé—´ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨æ··åˆç©ºé—´ä¹‹å‰ï¼Œæœ€å¥½å…ˆå¯¹å®ƒä»¬æœ‰ä¸€ä¸ªé€å½»çš„äº†è§£ã€‚

`Animation Blueprint` åŠ¨ç”»è“å›¾ä¸»è¦è´Ÿè´£åŠ¨ç”»çš„æ··åˆé©±åŠ¨é€»è¾‘ä»¥åŠåå¤„ç†çš„ç›¸å…³å·¥ä½œã€‚ä¸€èˆ¬å¤§éƒ¨åˆ†åŠ¨ç”»ç¨‹åºçš„å·¥ä½œå°±æ˜¯åœ¨è¿™é‡Œå®Œæˆã€‚åŠ¨ç”»è“å›¾ä¸­å¯ä»¥æ­å»ºåŠ¨ç”»çŠ¶æ€æœºä»¥åŠåŠ¨ç”»åå¤„ç†é€»è¾‘ï¼Œä¾‹å¦‚ IKã€å åŠ åŠ¨ç”»ç­‰ã€‚

`Animation Montage` åŠ¨ç”»è’™å¤ªå¥‡ï¼Œå¯¹åŠ¨ç”»åºåˆ—ç­‰èµ„æºçš„æ‰©å……ï¼Œå¯ä»¥æ–¹ä¾¿çš„ä½¿ç”¨è“å›¾ã€ä»£ç æ§åˆ¶åŠ¨ç”»èµ„æºçš„æ’­æ”¾ï¼Œå¹¶ä¸”å¯ä»¥æ–¹ä¾¿çš„å®ç°æ ¹éª¨éª¼åŠ¨ç”»å’ŒåŠ¨ç”»æ’­æ”¾ç»“æŸåçš„å›è°ƒã€‚

`Animation Sequence` åŠ¨ç”»åºåˆ—æ˜¯ç”¨æ¥è®°å½•éª¨éª¼è¿åŠ¨çŠ¶æ€çš„èµ„æºï¼Œä¹Ÿæ˜¯è®©åŠ¨ç”»åŠ¨èµ·æ¥çš„å…³é”®ä¹‹ä¸€ã€‚æ¯ä¸ªåŠ¨ç”»åºåˆ—èµ„æºä¸“é—¨é’ˆå¯¹ä¸€ä¸ªç‰¹å®š éª¨æ¶ï¼Œä¸”åªèƒ½åœ¨è¯¥éª¨æ¶ä¸Šæ’­æ”¾ã€‚æ¢è¨€ä¹‹ï¼Œä¸ºäº†èƒ½åœ¨å¤šä¸ªéª¨æ¶ç½‘æ ¼ä½“ä¹‹é—´å…±äº«åŠ¨ç”»ï¼Œæ¯ä¸ªç½‘æ ¼ä½“å¿…é¡»ä½¿ç”¨ç›¸åŒçš„éª¨æ¶èµ„æºã€‚

åŠ¨ç”»ç¼–è¾‘å™¨æä¾›é¢„è§ˆå’Œç¼–è¾‘å•ä¸ªåŠ¨ç”»åºåˆ—èµ„æºçš„åŠŸèƒ½ã€‚å¯ä»¥è®¾ç½®åŒ…æ‹¬å‹ç¼©æ¨¡å¼åœ¨å†…çš„åŠ¨ç”»åºåˆ—å±æ€§ï¼Œä¹Ÿå¯ä»¥æ·»åŠ åŠ¨ç”»é€šçŸ¥äº‹ä»¶ï¼ˆä¹Ÿç§°ä¸ºé€šçŸ¥ï¼‰ä»¥ä¾¿æ ¹æ®åŠ¨ç”»è§¦å‘æ‘„åƒæœºæ•ˆæœã€ç²’å­æ•ˆæœã€å£°éŸ³ï¼Œç­‰ç­‰ã€‚

åŠ¨ç”»é€šçŸ¥ï¼ˆ`AnimNotifies`ï¼‰ä¸ºåŠ¨ç”»ç¨‹åºå‘˜æä¾›äº†ä¸€ç§æ–¹å¼ï¼Œä»¥ä¾¿è®¾ç½®äº‹ä»¶åœ¨ åŠ¨ç”»åºåˆ— ä¸­çš„ç‰¹å®šç‚¹ä¸Šå‘ç”Ÿã€‚é€šçŸ¥å¸¸ç”¨äºåœ¨è¡Œèµ°æˆ–è·‘æ­¥åŠ¨ç”»ä¸­æ·»åŠ è„šæ­¥å£°ä¹‹ç±»çš„æ•ˆæœï¼Œæˆ–åœ¨åŠ¨ç”»ä¸­ç”Ÿæˆç²’å­ç³»ç»Ÿã€‚å®ƒä»¬ç”¨é€”å¹¿æ³›ï¼Œç³»ç»Ÿå¯éšè‡ªå®šä¹‰é€šçŸ¥ç±»å‹è¿›è¡Œå»¶å±•ï¼Œä»¥æ»¡è¶³å„ç§æ¸¸æˆçš„éœ€æ±‚ã€‚

åŠ¨ç”»æ›²çº¿ï¼ˆ`Animation Curves`ï¼‰ æä¾›ä¸€ç§åœ¨åŠ¨ç”»æ’­æ”¾æ—¶æ›´æ”¹æè´¨å‚æ•°å€¼æˆ–å˜å½¢ç›®æ ‡å€¼çš„æ–¹æ³•ã€‚å®ƒä»¬çš„å·¥ä½œæµè¦æ±‚æ‚¨æŒ‡å®šè¦ä¿®æ”¹çš„èµ„æºï¼ˆæè´¨æˆ–å˜å½¢ç›®æ ‡ï¼‰ï¼Œç›¸åº”åœ°å‘½åæ›²çº¿ï¼Œç„¶ååœ¨åŠ¨ç”»çš„æŒç»­æ—¶é—´å†…è°ƒæ•´å…³é”®å¸§å€¼ã€‚

æ··åˆç©ºé—´ï¼ˆ`Blend Space`ï¼‰ æ˜¯å¯ä»¥åœ¨åŠ¨ç”»å›¾ï¼ˆAnimGraphï¼‰ ä¸­é‡‡æ ·çš„ç‰¹æ®Šèµ„æºï¼Œ å…è®¸æ ¹æ®ä¸¤ä¸ªè¾“å…¥çš„å€¼æ··åˆåŠ¨ç”»ã€‚è¦æ ¹æ®ä¸€ä¸ªè¾“å…¥åœ¨ä¸¤ä¸ªåŠ¨ç”»ä¹‹é—´å®ç°ç®€å•æ··åˆï¼Œ å¯ä»¥ä½¿ç”¨åŠ¨ç”»è“å›¾ä¸­æä¾›çš„ä¸€ä¸ªæ ‡å‡† æ··åˆèŠ‚ç‚¹ã€‚æ··åˆç©ºé—´æä¾›çš„æ–¹æ³•æ˜¯æ ¹æ®å¤šä¸ªå€¼ï¼ˆç›®å‰ä»…é™äºä¸¤ä¸ªï¼‰ åœ¨å¤šä¸ªåŠ¨ç”»ä¹‹é—´è¿›è¡Œæ›´å¤æ‚çš„æ··åˆã€‚

æ··åˆç©ºé—´çš„ç›®çš„æ˜¯é¿å…åˆ›å»ºå•ä¸ªç¡¬ç¼–ç èŠ‚ç‚¹ æ¥æ ¹æ®ç‰¹å®šå±æ€§æˆ–æ¡ä»¶æ‰§è¡Œæ··åˆã€‚é€šè¿‡å…è®¸åŠ¨ç”»å¸ˆæˆ–ç¨‹åºå‘˜æŒ‡å®šè¾“å…¥ã€åŠ¨ç”» ä»¥åŠå¦‚ä½•ä½¿ç”¨è¾“å…¥æ¥æ··åˆåŠ¨ç”»ï¼Œå‡ ä¹å¯ä»¥ä½¿ç”¨é€šç”¨ æ··åˆç©ºé—´æ‰§è¡Œä»»ä¸€ç±»å‹çš„æ··åˆã€‚

Live Link é€šç”¨æ¥å£æ˜¯ UE4 çš„ä¸€ä¸ªåŸºç¡€æ’ä»¶ï¼ŒåŸºäº Live Link å¯ä»¥å’Œå¤–æ¥è®¾å¤‡å®ç°è¯¸å¦‚è™šæ‹Ÿåˆ¶ç‰‡ Virtual Productionã€åŠ¨ä½œæ•æ‰ Motion Capture ç­‰ç°ä»£åŒ–çš„ç”Ÿäº§å·¥å…·ã€‚æ¯”å¦‚ï¼Œ`Virtual Camera` å°±åˆ©ç”¨äº†è‹¹æœæ‰‹æœºï¼Œæ¥è™šæ‹Ÿå®ç°æ‘„åƒæœºçš„æ‹æ‘„ã€‚è¿˜å¯ä»¥ä¸å…¶å®ƒæ”¯æŒ Live Link çš„è½¯ä»¶ååŒï¼Œæ¯”å¦‚ Mayaã€‚

ä½¿ç”¨é•œå¤´è¯•æ‹å½•åˆ¶å™¨ï¼ˆ`Take Recorder`ï¼‰æ’ä»¶ï¼Œèƒ½å¿«é€Ÿè¿­ä»£å½•åˆ¶æ€§èƒ½å¹¶å¿«é€ŸæŸ¥çœ‹ä¹‹å‰è™šæ‹Ÿåˆ¶é€ å·¥ä½œæµçš„é•œå¤´ã€‚ å¯è½»æ¾å½•åˆ¶ä¸å…³å¡è§’è‰²å…³è”çš„åŠ¨ä½œæ•æ‰ä¸­çš„åŠ¨ç”»åŠæœªæ¥æ’­æ”¾çš„ Live Link å®é™…æ•°æ®ã€‚é€šè¿‡å½•åˆ¶é•œå¤´å¹¶å°†å…¶æ·»åŠ åˆ° Sequencerï¼Œå¯è½»æ¾é€‚åº”å„ç§å¤§å°å’Œæ•°é‡çš„é•œå¤´åˆ¶ä½œã€‚

ç¡®ä¿å¯ç”¨é•œå¤´è¯•æ‹å½•åˆ¶å™¨æ’ä»¶ï¼šå¯¼èˆªåˆ° Edit -> Pluginsï¼Œå¹¶æœç´¢é•œå¤´è¯•æ‹å½•åˆ¶å™¨å³å¯å®Œæˆæ“ä½œã€‚é€šè¿‡èœå• Window -> Take Recorder æ‰“å¼€ã€‚



## âš¡ Paper2D äºŒç»´æ¸¸æˆç³»ç»Ÿ
- è“å›¾ä¸­çš„Flipbookç»„ä»¶ https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/Paper2D/Flipbooks/Components/Blueprints/
- è®¾ç½® 2D è§’è‰²çš„åŠ¨ç”»çŠ¶æ€æœº https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/Paper2D/HowTo/Animation/
- Paper 2D Import Options https://docs.unrealengine.com/4.27/en-US/AnimatingObjects/Paper2D/Importing/
- Paper 2D Sprites https://docs.unrealengine.com/4.27/en-US/AnimatingObjects/Paper2D/Sprites/
- Paper 2D ç»„ä»¶ https://docs.unrealengine.com/4.27/zh-CN/Basics/Components/Paper2D/
- Components ç»„ä»¶ https://docs.unrealengine.com/4.27/zh-CN/Basics/Components
- Paper 2D å›¾å—é›†/å›¾å—åœ°å›¾ https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/Paper2D/TileMaps/
- Paper 2D Content Examples https://docs.unrealengine.com/4.27/en-US/Resources/ContentExamples/Paper2D/

Paper2D æ˜¯ UE4 æä¾›çš„åŸºäºç²¾çµçš„ 2D æ¸¸æˆç³»ç»Ÿï¼Œå¯ä»¥ç”¨äºæ„å»º 2D å’Œ 2D/3D æ··åˆæ¸¸æˆã€‚

åœ¨ 2D æ¸¸æˆä¸­ï¼ŒåŸºäºåŠ¨ç”»å¸§æ¥åˆ›å»ºè¿åŠ¨è§’è‰²å½¢è±¡æ˜¯å¸¸ç”¨æŠ€æœ¯ã€‚ä½¿ç”¨ UE4 è‡ªå¸¦çš„ 2D Side Scroller å³ 2D æ¨ªå·è½´æ¸¸æˆå·¥ç¨‹æ¨¡æ¿å°±è‡ªå¸¦äº† Flipbook çš„ç¤ºèŒƒå†…å®¹ï¼ŒåŒ…æ‹¬ 2DCharacter_IdleAnimAtlas å’Œ 2DCharacter_RunAnimAtlas.TGA ä¸¤å¼ åŠ¨ç”»å¸§å›¾ç‰‡ï¼Œå¯ä»¥å°†å®ƒä»¬ä»å·¥ç¨‹ä¸­å¯¼å‡ºï¼šå³é”®èœå• Asset Actions -> Exportã€‚ä¹Ÿå¯ä»¥ä¸Š Game Art 2D ç½‘ç«™ä¸Šæ‰¾å›¾ç‰‡èµ„æºã€‚

ç›®å‰ Paper2D çš„åŠ¨ç”»ç³»ç»Ÿæ˜¯åŸºäºå¸§åŠ¨ç”»çš„ï¼Œç¤¾åŒºè®¨è®ºä¸­è™½ç„¶æœ‰åŠ å…¥ 2D éª¨éª¼åŠ¨ç”»ç³»ç»Ÿçš„è®¨è®ºï¼Œä½†æ˜¯ç›®å‰çš„æ­£å¼å¼•æ“ç‰ˆæœ¬ä¸­å¹¶æ²¡æœ‰è¿™æ ·çš„åŠŸèƒ½ã€‚

Paper2D æä¾›äº†å››ç§ Components å¯¹è±¡ï¼Œå¯ä»¥åœ¨å†…å®¹æµè§ˆå™¨ä¸­æ·»åŠ ï¼š

- Sprite ç²¾çµ
- Flipbook å¸§åŠ¨ç”»
- Tile Set
- Tile Map

### âœ’ PaperSprite

`Sprite` æ˜¯å¸§åŠ¨ç”»çš„åŸºæœ¬ç»„ç»‡å•ä½ï¼Œå®ƒæ¥æºäºå¯¹ Texture å³åŠ¨ç”»å¸§å›¾ç‰‡çš„è£å‰ªï¼Œå½¢æˆåŠ¨ç”»çš„ä¸€ä¸ªå¸§ç²¾çµå¹¶æœ€ç»ˆç”¨äº FlipBook åŠ¨ç”»æ’­æ”¾ã€‚åŒæ—¶ UE4 æ”¯æŒå¯¼å…¥ Texture Packer å’Œ Adobe Flash CS6 ç”Ÿæˆçš„å¸§åŠ¨ç”»ã€‚

ç²¾çµçš„é»˜è®¤æè´¨æ˜¯ Paper2D ç³»ç»Ÿæä¾›çš„ MaskedUnlitSpriteMaterial æè´¨ï¼Œå®ƒå¯ä»¥å°† Texture é€æ˜åŒºè¿‡æ»¤æ‰ï¼Œå¦‚æœéœ€è¦åè½¬è¿‡æ»¤ä½¿ç”¨ MaskedLitSpriteMaterialã€‚

Sprite å±æ€§å‚è€ƒï¼š

- Source Texture å½“å‰ç²¾çµæ‰€ä½¿ç”¨çš„ 2D å›¾åƒ
- Source UV è£å‰ªçš„èµ·å§‹ç‚¹åœ¨åŸå›¾å½¢ä¸Šçš„åç¦»ï¼Œåƒç´ å•ä½
- Source Dimension ä»èµ·ç‚¹å¼€å§‹è£å‰ªæŒ‡å®šçš„åƒç´ å¤§å°ï¼Œå’Œå‰é¢ä¸€ç»„è®¾ç½®å°±å¯ä»¥å°†åŠ¨ç”»å¸§ä¸­çš„ä¸€ä¸ªçŠ¶æ€å›¾ç‰‡è£å‰ªå‡ºæ¥ã€‚
- Default Material ç²¾çµçš„é»˜è®¤æè´¨ï¼Œè¿™ä¸ªæè´¨å±æ€§å¯ä»¥è¢« Flipbook çš„è®¾ç½®è¦†ç›–ã€‚
- Additional Textures ä¸ºç²¾çµæä¾›é¢å¤–çš„è´´å›¾ï¼Œå½“å‰æ–‡æ¡£ä¸­æ²¡æœ‰ç»™å‡ºæè¿°ã€‚
- Pixels per unit è®¾ç½®åƒç´ ä¸å¼•æ“å†…éƒ¨å•ä½ä¹‹é—´çš„ç¼©æ”¾æ¯”ä¾‹ï¼Œç”¨äºè°ƒæ•´ç²¾çµåœ¨ UE ä¸–ç•Œä¸­çš„å¤§å°ã€‚åœ¨ Paper2D çš„æ’ä»¶è®¾ç½®ä¸­æœ‰å…¨å±€è®¾å®šï¼Œä¹Ÿå¯ä»¥å¯¹æ¯ä¸ªç²¾çµè¿›è¡ŒæŒ‡å®šã€‚
- Pivot Mode ä¸­å¿ƒç‚¹ä½ç½®ã€‚è®¾ç½®ä¸º Custom çš„è¯å¯ä»¥è¿›è¡Œç²¾ç»†çš„è®¾ç½®ã€‚
- Sockets å’Œ 3D åŠ¨ç”»ä¸­çš„ Sockets åŠŸèƒ½æ—¶ç±»ä¼¼çš„ï¼Œæä¾›ä¸€ä¸ªæ§½å£æ¥æ”¾ç½®è£…é¥°ç‰©ä»¶ã€‚
- Collision ç²¾çµç¢°æ’ç³»ç»Ÿè®¾ç½®ï¼Œå¯ä»¥é€‰æ‹©æ— ç¢°æ’æˆ–è€…3Dã€‚

å¾€ Sprite æ·»åŠ æ’æ§½è£…é¥°ç‰©ï¼Œå¯ä»¥ç”Ÿæˆç²’å­ç‰¹æ•ˆï¼Œå¦‚èº«ä¸Šç€ç«çš„è§’è‰²ï¼Œæˆ–å°†ä¸€æŠŠæ­¦å™¨ï¼ˆå¦‚ä¸€æŠŠæªæˆ–ä¸€æŠŠå‰‘ï¼‰é™„åŠ åˆ°è§’è‰²æ‰‹ä¸Šï¼Œæˆ–ç”Ÿæˆä»»æ„æ•°é‡çš„å„ç§ç‰©å“å¹¶é™„åŠ åˆ° Sprite çš„æ’æ§½ã€‚æ·»åŠ æ’æ§½åï¼Œé€šè¿‡è“å›¾è®¿é—® Sprite æ’æ§½ï¼Œå¹¶è®¾ç½®å°†å…¶å®ƒ Sprite ç»„ä»¶é™„åŠ åˆ°æ’æ§½ä¸Šã€‚å¯ä»¥ä½¿ç”¨ Property Matrix åŒæ—¶å¯¹æ‰€æœ‰ sprite è¿›è¡Œä¿®æ”¹ï¼ŒèŠ‚çº¦æ—¶é—´ã€‚

é€šè¿‡è“å›¾è®¿é—® Sprite æ’æ§½ï¼š

- åœ¨äººç‰©è§’è‰²è“å›¾çš„ My Blueprint çª—å£ä¸­ç‚¹å‡»çœ¼ç›å›¾æ ‡å’Œ Show Inherited Variablesã€‚
- å°†è§’è‰²çš„ Character ä¸­çš„ Sprite ç»„ä»¶æ‹–å…¥åˆ°è“å›¾ã€‚
- åœ¨ `Event Begin Play` èŠ‚ç‚¹çš„å¼•å‡ºè¿çº¿åæ·»åŠ ä¸€ä¸ª `Spawn Actor from Class` èŠ‚ç‚¹ï¼ˆè®¾ä¸ºæ‰€éœ€çš„ Actor ç±»ï¼‰ã€‚
- æ·»åŠ  `Make Transform` èŠ‚ç‚¹å¹¶åº”ç”¨åˆ° Spawn Transform ç«¯ï¼Œåœ¨ Return Value çš„å¼•å‡ºè¿çº¿åä½¿ç”¨ä¸€ä¸ª `Attach To` èŠ‚ç‚¹ã€‚
- å°† Sprite ç»„ä»¶ä½œä¸º In Parent æ¥å…¥ï¼Œåœ¨ In Socket Name è¾“å…¥é€‰æ‹©åˆ›å»ºå¥½çš„æ’æ§½ã€‚
- ç¼–è¯‘å¹¶åœ¨ç¼–è¾‘å™¨ä¸­è¿›è¡Œæ¸¸æˆï¼Œç”Ÿæˆçš„ Actor ç±»å°†åœ¨æ’æ§½ä½ç½®ç”Ÿæˆå¹¶æˆåŠŸé™„åŠ ã€‚

å¯æ·»åŠ ä¸€ä¸ªæ’æ§½åˆ°ä¸€ä¸ª Spriteï¼Œå¹¶åœ¨æ’æ§½ä¸­é™„åŠ ä»»æ„æ•°é‡çš„ä¸åŒå†…å®¹ã€‚Sprite æ˜¯å¦ä¸º Flipbook çš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯å¦å·²è®¾ç½®åŠ¨ç”»ï¼Œä»¥åŠæ’æ§½ä¸­çš„å†…å®¹å‡å®Œå…¨å–å†³äºæ‚¨çš„é€‰æ‹©ã€‚


Paper2D ä¸­å¯ä»¥é€‰æ‹©çš„ç¢°æ’ä½¿ç”¨çš„å¼•æ“å†…é€šç”¨çš„ PhysXï¼Œä»¥å‰çš„ 2D ç¢°æ’ä½¿ç”¨çš„æ˜¯ Box2Dï¼Œä¹Ÿåªèƒ½æ”¯æŒ Win32 å’Œ Win64 ä¸¤ä¸ªå¹³å°ï¼Œè¦ä½¿ç”¨é¢å¤–çš„åŠŸèƒ½è¿˜è¦åœ¨é¡¹ç›®è®¾ç½®ä¸­æ‰“å¼€ Enable 2DPhysics å¼€å…³ã€‚

å¯¹äº 2D ç³»ç»Ÿï¼ŒSprite å¯¹è±¡å¯ä»¥åº”ç”¨ç‰©ç†ç³»ç»Ÿï¼ŒåŠç‰©ç†çº¦æŸã€‚ç‰©ç†å¯¹è±¡éœ€è¦å¯¹ä¸–ç•Œåœºæ™¯å’Œç©å®¶äº¤äº’ä½œå‡ºååº”ï¼Œç„¶è€Œéœ€è¦å°†å…¶é™åˆ¶åœ¨å…³å¡å†…ï¼Œä½¿ç”¨çº¦æŸå¯ä»¥é˜²æ­¢å…¶åœ¨ç‰¹å®šçš„è½´ä¸Šæ—‹è½¬ã€‚

åœ¨å…³å¡ä¸­é€‰æ‹©éœ€è¦åº”ç”¨ç‰©ç†çš„ Spriteï¼Œåœ¨ Details é¢æ¿ä¸­ï¼Œç‚¹å‡» Physics ä¸‹çš„ Simulate Physics é€‰é¡¹ï¼Œå±•å¼€ Constraints å¹¶è®¾ç½®ï¼š

- Lock Positionï¼ˆå¯¹æ¨ªå·è½´æ¸¸æˆè€Œè¨€ï¼Œé€šå¸¸é”å®šåˆ° Y è½´ï¼‰ã€‚
- Lock Rotationï¼ˆå¯¹æ¨ªå·è½´æ¸¸æˆè€Œè¨€ï¼Œé€šå¸¸é”å®šåˆ° X è½´ï¼‰ã€‚

Paper2D çš„åæ ‡ç³»ç»Ÿï¼ŒX è½´å‘å³ï¼ŒY è½´å‘å‚ç›´å±å¹•å‘å¤–ï¼ŒZ è½´å‘ä¸Šï¼Œåˆ†åˆ«ç”¨çº¢ã€é»„ã€è“ä¸‰ç§è‰²è¡¨ç¤ºï¼Œé”å®šä¸€ä¸ªè½´å‘ï¼Œå°±è¡¨ç¤ºä¸èƒ½åœ¨è¿™ä¸ªè½´ä¸Šç§»åŠ¨ï¼Œæˆ–è€…ä¸èƒ½ä»¥è¿™ä¸ªè½´ä¸ºä¸­å¿ƒè¿›è¡Œæ—‹è½¬ã€‚

ç¢°æ’æ£€æµ‹çš„è¾¹ç•Œæœ‰å‡ ä¸ªä¸åŒçš„æ–¹å¼ï¼Œè¶Šç®€å•è§„åˆ™çš„è¾¹ç•Œè¿ç®—è¶Šå¿«é€Ÿï¼š

- Source Bounding Box æºè¾¹ç•Œæ¡†å¼ï¼Œåœ¨ Sprite ä¸Šä½¿ç”¨æºå›¾å½¢çš„è¾¹ç•Œæ¡†ã€‚
- Tight Bounding Box ä¸¥æ ¼è¾¹ç•Œæ¡†å¼ï¼Œå°† sprite çš„å…¨é€æ˜åŒºåŸŸæ’é™¤åœ¨å¤–ï¼Œå¤šæ•°æƒ…å†µä¸‹è¿™ç§æ–¹å¼èƒ½ç”Ÿæˆæ›´ä½³çš„ç¢°æ’æ•ˆæœã€‚
- Shrink Wrapped æ”¶ç¼©åŒ…è£¹å¼ï¼ˆå®éªŒæ€§ï¼‰ç”ŸæˆåŒ¹é… Sprite ä¸é€æ˜åŒºåŸŸçš„å¤æ‚å‡ ä½•ä½“ï¼Œæ•ˆæœæœ€çœŸå®ï¼Œä½†é¢å¤–çš„å‡ ä½•ä½“å¯èƒ½å¯¹è¿è¡Œæ€§èƒ½äº§ç”Ÿå½±å“ã€‚
- Fully Custom è‡ªå®šä¹‰å¼,å¯æŒ‡å®šè§†å£ä¸­äº’åŠ¨ä½¿ç”¨çš„å‡ ä½•ä½“ã€‚
- Diced æ–¹å—å¼ï¼Œç”±å¤šä¸ªå°æ–¹å—ç»„åˆï¼ŒåŒ…æ‹¬æœ€ç»ˆå‡ ä½•ä½“ä¸­ä»…ä¸ºéç©ºçš„å°æ–¹å—ã€‚

ä½¿ç”¨ä¸Šçš„å»ºè®®æ˜¯ä½¿ç”¨é»˜è®¤çš„ç®€å•å›¾å½¢è¿›è¡Œç¢°æ’ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨ç²¾ç»†çš„ç¢°æ’çš„è¯å¯ä»¥ä½¿ç”¨ Sockets æ¥å¤–æŒ‚ç¢°æ’ä½“æ¥è¿›è¡Œç¢°æ’æ£€æµ‹ï¼Œé€å¸§è¿›è¡Œç²¾ç»†çš„ç¢°æ’æ£€æµ‹æ˜¯ç›¸å½“æ¶ˆè€—ç³»ç»Ÿè¿ç®—åŠ›çš„ã€‚

æ¸²æŸ“åŒºåŸŸè°ƒæ•´åŠŸèƒ½æ›´é‡è¦çš„æ˜¯å¯¹æ¸²æŸ“åŒºåŸŸè¿›è¡Œè°ƒæ•´ï¼Œå°†æœ‰çš„ç²¾çµä¸­å¤šä½™çš„ç©ºç™½éƒ¨åˆ†æ’é™¤åˆ°æ¸²æŸ“ä¹‹å¤–çš„è¯ï¼Œå¯ä»¥å¾ˆå¥½çš„é™ä½æ¸²æŸ“å‹åŠ›ã€‚

`PaperSpriteComponent` è´Ÿè´£å¤„ç† UPaperSprite å®ä¾‹çš„æ¸²æŸ“å’Œç¢°æ’ã€‚ å½“ä½ å°† Sprite èµ„äº§ä»å†…å®¹æµè§ˆå™¨æ‹–åˆ°è“å›¾ï¼Œè¯¥ç»„ä»¶å°±ä¼šè‡ªåŠ¨åˆ›å»ºï¼›æˆ–è€…ï¼Œå½“ä½ å°†æŸäº› Actor æ‹–å…¥å…³å¡ä¸­æ—¶ï¼Œè¯¥ç»„ä»¶ä¼šåŒ…å«åœ¨å…¶ä¸­ã€‚

è¿™ç±»ç»„ä»¶çš„ä¸€ç§ç”¨é€”å°±æ˜¯å……å½“æ­å»ºå…³å¡çš„ Spriteï¼Œæ¯”å¦‚ï¼Œå²©æ¶æˆ–å¹³å°ã€æ¢¯å­å’Œæ–œå¡ç­‰ã€‚å°†è¿™äº› Sprite èµ„äº§æ”¾ç½®åœ¨å…³å¡ä¸­å°†åˆ›å»ºä¸€ä¸ª PaperSpriteActorï¼Œè¯¥ Actor ä½¿ç”¨çš„ PaperSpriteComponent å®ä¾‹åŸºäºé€‰å®š Sprite èµ„äº§ç”Ÿæˆã€‚

### âœ’ FlipBook

`FlipBook` æ˜¯å¸§åŠ¨ç”»çš„ç®¡ç†ç±»ï¼Œå°† Sprite ç»„ç»‡æˆåŠ¨ç”»è¿›è¡Œæ’­æ”¾ï¼Œåªéœ€è¦å°†åˆ›å»ºå¥½çš„ Sprite å¯¹è±¡æ·»åŠ åˆ° FlipBook ç»„ä»¶çš„ Frame ä¸­ï¼Œè®¾ç½®å¥½æ’­æ”¾å¸§ç‡å°±å¯ä»¥åœ¨è“å›¾ä¸­ä½¿ç”¨ã€‚

åˆ›å»º Sprite æ—¶ï¼Œå…ˆå¯¼å…¥åŸå§‹åŠ¨ç”»å¸§å›¾ç‰‡ï¼Œå†é€šè¿‡ Sprite ç¼–è¾‘å™¨ç¼–è¾‘æ–°å»ºçš„ç²¾çµå¯¹è±¡ï¼Œå°† Source Texture æŒ‡å®šä¸ºåˆšå¯¼å…¥çš„å›¾ç‰‡ã€‚åœ¨ç¼–è¾‘å™¨çš„å³ä¸Šè§’ï¼Œæœ‰ä¸€ä¸ªå››æ£µå°æ ‘çš„å›¾æ ‡ï¼Œå³ Edit the sprite source regionï¼Œç‚¹å‡»åå¯ä»¥ä½¿ç”¨ Extract Sprites åŠŸèƒ½å°†æ‰€æœ‰å¸§å›¾åƒæå–ä¸ºç›¸åº”çš„ Spriteï¼ŒåŠŸèƒ½ä½äºå·¦ä¸Šè§’çš„æ ¼å­å›¾æ ‡ã€‚å¯¹äºè§„æ•´çš„å›¾åƒï¼Œä½¿ç”¨ Grid æå–æ¨¡å¼ï¼Œå¹¶å°† Cell çš„å®½é«˜è®¾ç½®ä¸ºé€‚å½“å¤§å°å³å¯ã€‚

å°†å¤šä¸ª Sprite æ‹–å…¥ Flipbook çš„ Frame åˆ—è¡¨ï¼Œå³ç¼–è¾‘å™¨çš„åº•éƒ¨æ ¼å­ä¸Šï¼Œå¯ä»¥å¿«é€Ÿåˆ›å»ºåŠ¨ç”»å¸§ã€‚æˆ–è€…ï¼Œç›´æ¥é€‰æ‹©æ‰€æœ‰ Spriteï¼Œä½¿ç”¨å³é”®èœå•çš„ Create Flipbook åˆ›å»ºã€‚ 

å±æ€§å¦‚ä¸‹ï¼š

- Frames Per Seconds æ¯ç§’å¸§ç‡ï¼Œå€¼è¶Šå¤§è¿åŠ¨è¶Šå¿«ï¼›
- Default Material åŠ¨ç”»å¸§ä½¿ç”¨çš„æè´¨ï¼›
- Key Frames ä¸­å­˜å‚¨çš„æ˜¯æ¯ä¸€ä¸ªç”¨åˆ°çš„å…³é”®å¸§çš„ç²¾çµçš„å±æ€§ï¼Œå¯ä»¥è°ƒæ•´çš„ç›®å‰åªæœ‰ Frame Runï¼Œä¸ºå¸§çš„æŒç»­å¸§æ•°ï¼›
- Collision Source ä¸ºç¢°æ’æ¨¡å¼é€‰æ‹©ï¼Œå¯ä»¥é€‰æ‹©å…³é—­ç¢°æ’ã€é€å¸§ç¢°æ’æˆ–è€…ä½¿ç”¨ç¬¬ä¸€å¸§è¿›è¡Œç¢°æ’ã€‚

å®é™…è¿ç”¨ä¸­æ›´åŠ é‡è¦çš„æ˜¯ FlipBookï¼Œè¿™ä¸ªè“å›¾ç±»æä¾›äº†å¾ˆå¤šæ–¹ä¾¿çš„å¯¹ Flipbook è¿›è¡Œæ“ä½œçš„æ¥å£ã€‚è®¾ç½® 2D è§’è‰²çš„åŠ¨ç”»çŠ¶æ€æœºï¼Œå¯ä»¥ä½¿è§’è‰²åŸºäºå®šä¹‰çš„æ¡ä»¶åœ¨ä¸åŒ Flipbook åŠ¨ç”»ä¹‹é—´åˆ‡æ¢ã€‚

`PaperFlipbookComponent` å¯ä»¥åœ¨ 3D ç©ºé—´ä¸­ä»»æ„æ”¾ç½®ã€é™„åŠ åˆ°å…¶ä»–ç»„ä»¶ä¸Šæˆ–è‡ªèº«é™„å¸¦å…¶ä»–ç»„ä»¶ã€‚ ä½ å¯ä»¥ä¸ºæ¯ä¸ªå®ä¾‹æŒ‡å®šä¸€ä¸ªè‡ªå®šä¹‰é¢œè‰²ï¼›è¯¥é¢œè‰²ä¼šè¢«ä¼ é€’ç»™ Flipbook æè´¨ä½œä¸ºé¡¶ç‚¹é¢œè‰²å‚æ•°ã€‚ä½ ä¹Ÿå¯ä»¥ä¸ºå®ƒä»¬æŒ‡å®šä¸€ä¸ªè‡ªå®šä¹‰æè´¨ï¼Œç”¨äºæ›¿ä»£ SourceFlipbook ä¸­å®šä¹‰çš„é»˜è®¤æè´¨ã€‚

ä½¿ç”¨è„šæœ¬ï¼Œä½ å¯é€šè¿‡è°ƒç”¨ SetFlipbook å‡½æ•°æ›´æ”¹å½“å‰ SourceFlipbook èµ„äº§ï¼Œä½†æ˜¯ï¼Œè¯·æ³¨æ„ä»…å½“ Mobility å±æ€§è®¾ä¸ºå¯ç§»åŠ¨ï¼ˆæˆ–åœ¨ Actor æ„å»ºè¿‡ç¨‹ä¸­è°ƒç”¨è¯¥å‡½æ•°ï¼‰æ—¶ï¼Œä¸Šè¿°æ“ä½œæ‰æœ‰æ•ˆã€‚ ä½ ä¹Ÿå¯ä½¿ç”¨ç»„ä»¶ä¸Šçš„å„ç§å…¶ä»–æ–¹å¼æ¥æ§åˆ¶æ’­æ”¾é€Ÿåº¦ã€æ’­æ”¾æ–¹å‘ä»¥åŠå¾ªç¯ç­‰ã€‚

### âœ’ TileSet & TileMap

æ˜¯ç“¦ç‰‡åœ°å›¾åŠŸèƒ½ï¼ŒåŸç†å°±æ˜¯åˆ©ç”¨ä¸€å°å—å›¾ç‰‡ Tile æ‹¼æ¥ç»„æˆä¸€ä¸ªå¤§åœ°å›¾ã€‚TileSet æŒ‡å®šåŒ…å«å¤šä¸ª Tile çš„ Texture å›¾ç‰‡èµ„æºï¼Œå¹¶è®¾ç½®å¥½æ¯ä¸ª Tile å æ®çš„åƒç´ å¤§å°ã€‚ç„¶åå°† TileSet ä½œä¸ºç»˜å›¾è‰²å½©ä¸€æ ·ç»˜åˆ¶åˆ° TileMap çš„å›¾å±‚ä¸Šï¼Œå¾—åˆ°åœ°å›¾ï¼Œç»˜åˆ¶æ—¶æŒ‡å®š Active Tile Setã€‚TileMap ä¹Ÿéœ€è¦è®¾ç½®æ¯ä¸ª Tile çš„å¤§å°ï¼Œå’Œæ•´ä¸ª Map çš„å¤§å°ï¼Œå³å®¹çº³ Tile æ•°é‡ã€‚

Tile æœ¬èº«çš„ç¢°æ’åœ¨ TileSet ä¸­è¿›è¡Œè®¾ç½®å’Œè°ƒæ•´ï¼Œåœ¨ TileMap ä¸­ä¹Ÿæœ‰å¼€å…³è¿›è¡Œç¢°æ’ç±»å‹çš„é€‰æ‹©ï¼ŒSprite Collisionã€‚

æœ‰ä¸€ä¸ªå±æ€§éœ€è¦æ³¨æ„ï¼ŒSepration Per Layerï¼Œè¿™ä¸ªå±æ€§æ˜¯ç”¨äºè°ƒæ•´æ¯ä¸€å±‚åœ°å›¾ä¹‹é—´çš„è·ç¦»çš„ï¼Œåœ¨å¤šå±‚åœ°å›¾ä¸­ï¼Œç›¸å½“äºé€šå¸¸çš„ Z-Order è®¾ç½®çš„ä½ç½®ï¼Œå¯ä»¥ä¸ºä¸€äº›åœ°å›¾ç‰¹æ•ˆæä¾›å¸®åŠ©ã€‚


### âœ’ 2D Side Scroller æ¨¡æ¿å·¥ç¨‹åˆ†è§£
- Content Examples https://docs.unrealengine.com/4.27/en-US/Resources/ContentExamples/

UE4 è‡ªå¸¦çš„ 2D Side Scroller å³ 2D æ¨ªå·è½´æ¸¸æˆå·¥ç¨‹æ¨¡æ¿ï¼ŒåŸºäº Paper2D åŠ¨ç”»å¸§æ¥åˆ›å»ºè¿åŠ¨è§’è‰²å½¢è±¡æ˜¯å¸¸ç”¨æŠ€æœ¯ã€‚ä½¿ç”¨äº† Flipbook çš„ç¤ºèŒƒå†…å®¹ï¼ŒåŒ…æ‹¬ 2DCharacter_IdleAnimAtlas å’Œ 2DCharacter_RunAnimAtlas.TGA ä¸¤å¼ åŠ¨ç”»å¸§å›¾ç‰‡ï¼Œå¯ä»¥å°†å®ƒä»¬ä»å·¥ç¨‹ä¸­å¯¼å‡ºï¼šå³é”®èœå• Asset Actions -> Exportã€‚ä¹Ÿå¯ä»¥ä¸Š Game Art 2D ç½‘ç«™ä¸Šæ‰¾å›¾ç‰‡èµ„æºã€‚

åˆ†è§£ä¸€ä¸‹ 2D Side Scroller æ¨¡æ¿é¡¹ç›®ï¼Œ2DSideScroller ç›®å½•ä¸‹ä¸»è¦æ˜¯åŒ…å«äº† Textures ç›®å½•ä¸‹çš„åŠ¨ç”»å¸§å›¾ç‰‡ï¼Œå’Œ Sprites ç›®å½•ä¸‹å’Œä¸ªåŠ¨ç”»å¸§å¯¹åº”çš„ç²¾çµå¯¹è±¡ã€‚

æœ€ä¸»è¦æ˜¯ 2DSideScrollerBP ç›®å½•ä¸‹çš„è“å›¾å¯¹è±¡ï¼ŒMaps/2DSideScrollerExampleMap æ˜¯ä¸€ä¸ªé»˜è®¤å…³å¡åœ°å›¾ï¼Œæ‰“å¼€é¡¹ç›®åï¼Œè§†å›¾çœ‹åˆ°çš„åœºæ™¯å°±æ˜¯å®ƒã€‚è¿™ä¸ªå…³å¡ä¸Šè®¾ç½®äº†ç®€å•çš„åœºæ™¯ï¼Œå¯ä»¥åœ¨ World Outline çª—å£ä¸­çœ‹åˆ°ï¼ŒLedges åˆ†ç»„ä¸‹æœ‰å‡ ä¸ªå›ºå®šçš„å¹³å°æŒ¡æ¿ï¼ŒåŒ…æ‹¬åœºæ™¯ä¸¤è¾¹çš„è¾¹ç•Œé™åˆ¶ LeftEdgeã€RightEdgeï¼Œè¿˜æœ‰èƒŒæ™¯ï¼Œå®ƒä»¬éƒ½æ˜¯ `PaperSprite` ç±»å‹ï¼Œåœ¨ Details å¯ä»¥çœ‹åˆ° Collision è®¾ç½®äº† Can Character Step Up Onï¼Œå¯ä»¥ç«™åœ¨è¿™ä¸ªå¯¹è±¡ä¸Šé¢è€Œä¸ä¼šæ‰ä¸‹æ¥ã€‚æ³¨æ„ Collsion Presets è®¾ç½®äº† PhysicsActorï¼Œè¿™è¡¨ç¤ºè§’è‰²å¯¹è±¡åœ¨æ¨¡æ‹Ÿçš„ç‰©ç†ä¸–ç•Œä¸­ï¼Œå¦‚æœæ²¡æœ‰ç›¸åº”çš„ç¢°æ’è®¾ç½®ï¼Œç‰©ç†å¯¹è±¡å°±ä¸ä¼šè¾¹ç•Œæ¥è§¦æ—¶äº§ç”Ÿçš„æ•ˆæœã€‚

Enable Gravity é»˜è®¤æ‰“å¼€è¡¨ç¤ºå—é‡åŠ›ï¼Œä½† Simulate Physics æ²¡æœ‰ï¼Œæ‰€ä»¥é‡åŠ›æ¨¡æ‹Ÿå¹¶æ²¡æœ‰ç”Ÿæ•ˆï¼Œç‰©ä»¶ä¹Ÿä¸ä¼šæœ‰ä¸‹å è·Œè½çš„æ•ˆæœã€‚åœ¨æ‰“å¼€ç‰©ç†æ¨¡æ‹Ÿçš„æƒ…å†µä¸‹ï¼Œå³ä½¿æ²¡æœ‰é‡åŠ›ï¼Œå…¶å®ƒç‰©ç†å¯¹è±¡è¸©è¸ä¹Ÿä¼šæœ‰ä½œç”¨ã€‚

åœºæ™¯ä¸­è¿˜æœ‰ä¸€ä¸ªäººç‰©è§’è‰²ï¼Œå¯¹åº”å†…å®¹æµè§ˆå™¨çš„ Blueprints/2DSideScrollerCharacterï¼Œè¿™ä¸ªè“å›¾å¯¹è±¡çš„è®¾ç½®æ‰æ˜¯é‡ç‚¹ï¼Œæ•´ä¸ªç¤ºèŒƒå·¥ç¨‹çš„é€»è¾‘åŸºæœ¬éƒ½æ˜¯å®ƒç¼–æ’çš„ã€‚

åœ¨é€‰ä¸­è“å›¾å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç‚¹å‡» Details é¢æ¿ä¸Šçš„ Edit Blueprint æŒ‰é’®æ‰“å¼€è“å›¾ç¼–è¾‘å™¨ï¼Œå¯ä»¥çœ‹åˆ° 2DSideScrollerCharacter è“å›¾å¯¹è±¡çš„å±‚æ¬¡ç»“æ„ï¼Œå¹¶å¯ä»¥åœ¨è“å›¾çš„ Viewport ä¸­ç¼–è¾‘è¿™äº›å¯¹è±¡ï¼š

    +-- 2DSideScrollerCharacter(Blueprint å¯¹è±¡)
        +-- CapsuleComponent(Inherited) ç”¨äºç¢°æ’æ£€æµ‹çš„èƒ¶å›Šå‡ ä½•ä½“ 
        |   +-- ArrowComponent(Inherited) ç®­å¤´ç»„ä»¶æ˜¯ç®€å•çš„å½¢çŠ¶ï¼Œè¡¨ç¤ºå¯¹è±¡çš„æœå‘ï¼Œç®­å¤´ä¸ä¼šåœ¨å®é™…æ¸¸æˆä¸­æ˜¾ç¤º
        |   +-- Sprite(Inherited) è§’è‰² Flipbook åŠ¨ç”»ç»„ä»¶
        |   +-- CameraBoom(Spring Arm Component) å¼¹ç°§æ‰‹è‡‚ç»„ä»¶
        |       +-- SideViewCameraComponent(Camera Component) å¯¹è§’è‰²è¿›è¡Œæ‘„åƒ
        +-- CharacterMovement(Inherited) è¿åŠ¨ç»„ä»¶è®©è§’è‰²å…·æœ‰è¿åŠ¨èƒ½åŠ› 

SpringArmComponent ä½¿å…¶å­é¡¹å»¶é•¿å›ºå®šè·ç¦»ï¼Œç„¶ååœ¨å‘ç”Ÿç¢°æ’æ—¶æ”¶å›ï¼Œå’Œ CameraComponent ä¸€èµ·ä½¿ç”¨ï¼Œå¯ä»¥æä¾›ä¸€ä¸ªç¬¬ä¸‰äººç§°è§†è§’ï¼Œåˆ‡æ¢æ‘„åƒæœºä½¿ç”¨ SetViewTargetWithBlendã€‚

æ‰“å¼€è“å›¾å¯¹è±¡çš„ EventGraphï¼Œé‡Œé¢ä¸»è¦å¤„ç†äº†ç”¨æˆ·è¾“å…¥æ—¶å¯¹åº”çš„å“åº”é€»è¾‘ï¼Œå¦‚è·³è·ƒã€ç§»åŠ¨ç­‰ï¼Œè¿˜æœ‰å¼•æ“å› ä¸ºçš„äº‹ä»¶ BeginPlay å’Œ Tickã€‚æ­¤å¤–è¿˜æœ‰è‡ªå®šä¹‰çš„åŠ¨ç”»æ›´æ–° UpdateAnimation äº‹ä»¶ï¼Œè¿™ä¸ªäº‹ä»¶ç”± Event Tick è°ƒç”¨ï¼Œæ ¹æ®çŠ¶æ€æ¥è°ƒç”¨ SetFlipbook å‡½æ•°æ›´æ”¹è§’è‰²åŠ¨ç”»ã€‚

`UpdateAnimation` äº‹ä»¶çš„è“å›¾é€»è¾‘ï¼š

- é¦–å…ˆï¼Œç”± Event Tick è°ƒç”¨ï¼Œå³ Event Tick èŠ‚ç‚¹çš„æ‰§è¡Œæµæ¥å…¥åˆ° Call Function UpdateAnimation èŠ‚ç‚¹çš„æ‰§è¡Œæµè¾“å…¥ç«¯ï¼›
- è°ƒç”¨ Actor å¯¹è±¡çš„ GetVelocity() å¾—åˆ°ç§»åŠ¨é€Ÿåº¦å€¼ï¼›
- ç»è¿‡ Math Library çš„ VectorLength() å¤„ç†å¾—åˆ°å‘é‡é•¿åº¦ï¼Œæ³¨æ„æ˜¯å‘é‡çš„æ¨¡ï¼Œå¹¶ç»è¿‡ä¸€ä¸ªæµ®ç‚¹å€¼æ¯”è¾ƒï¼Œä½¿ç”¨ `Float Greater` èŠ‚ç‚¹ï¼Œçœ‹æ˜¯å¦å¤§äº 0 å³æœ‰ç§»åŠ¨ï¼› 
- ä½¿ç”¨ä¸€ä¸ª Select åˆ†æ”¯é€‰æ‹©èŠ‚ç‚¹ï¼ŒåŒ¹é…å‰é¢çš„å¾—åˆ°çš„å¸ƒå°”å€¼ï¼Œå¹¶æŒ‰å¸ƒå°”å€¼è¾“å…¥ RunningAnimation æˆ– IdleAnimationï¼›
- å°† Select åˆ†æ”¯èŠ‚ç‚¹è¾“å‡ºçš„ Flipbook å¯¹è±¡è¾“å…¥åˆ° SetFlipbook å‡½æ•°èŠ‚ç‚¹çš„ NewFlipbook å‚æ•°ç«¯å£ï¼›
- SetFlipbook çš„ Target ç«¯å£æ˜¯ä¸€ä¸ª Flipbook å¼•ç”¨ï¼Œè¿™é‡Œå°±æ˜¯è“å›¾å¯¹è±¡ä¸­çš„ Spriteï¼Œé€šè¿‡ GetSprite() è·å–å¼•ç”¨ï¼›

UpdateAnimation äº‹ä»¶å¤„ç†èµ°å®Œæµç¨‹åï¼Œè“å›¾å¯¹è±¡çš„ Sprite å°±ä¼šè®¾ç½®æ­£ç¡®çš„ä¸€ä¸ª Flipbook åŠ¨ç”»ï¼Œå¦‚æœæ˜¯ RunningAnimation åˆ™è¿˜è¦åœ¨ Tick æµç¨‹ä¸­å¤„ç†å·¦å³æ–¹å‘ï¼Œåªéœ€è¦æ²¿ Z è½´å³ç«–ç›´æ–¹å‘ç¿»è½¬ 180Â° å³å¯ã€‚

`Event Tick` äº‹ä»¶çš„è“å›¾é€»è¾‘ï¼š

- ç”± UE4 å¼•æ“è§¦å‘ Event Tick äº‹ä»¶çš„å¤„ç†ï¼›
- æ‰§è¡Œæµç¨‹è¿›å…¥è‡ªå®šä¹‰çš„ UpdateAnimation äº‹ä»¶å¤„ç†ï¼Œå¹¶è®¾ç½®å¥½ Sprite å¯¹è±¡ï¼›
- å¦ä¸€è¾¹ï¼Œé€šè¿‡ GetMovementComponent() è·å–ç§»åŠ¨ç»„ä»¶ï¼Œè·å–å…¶ Velocity å±æ€§ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å°† CharacterMovement ç»„ä»¶æ‹–æ”¾åˆ° EventGraphï¼›
- æ³¨æ„ï¼Œå› ä¸ºæ˜¯ç§»åŠ¨ç»„ç»‡çš„å±æ€§ï¼Œæ‰€ä»¥æ·»åŠ èŠ‚ç‚¹æ—¶ï¼Œé€‰æ‹© Movement Component çš„ GetVelocity()ï¼Œå¯ä»¥å…³é—­ Context Sensitive é€‰é¡¹ä»¥æ£€ç´¢å®Œæ•´çš„èŠ‚ç‚¹åˆ—è¡¨ï¼›
- ä½¿ç”¨ `Break Vector` èŠ‚ç‚¹ä» Velocity å‘é‡ä¸­åˆ†ç¦»å‡º X è½´ä¸Šçš„åˆ†é‡ï¼›
- å°† X åˆ†é‡é€šè¿‡ `CompareFloat` èŠ‚ç‚¹ä¸ 0.0 è¿›è¡Œæ¯”è¾ƒï¼Œå¾—åˆ° 3 ç§ç»“æœï¼Œå¯¹åº”ä¸‰ä¸ªå­æµç¨‹ï¼›
- å°äºæˆ–å¤§äº 0.0 çš„ä¸¤ç§æƒ…å†µè¡¨ç¤ºå‘å·¦ã€å‘å³æœ‰ç§»åŠ¨ï¼Œé‚£ä¹ˆå°±æ ¹æ®ç§»åŠ¨æ–¹å‘ï¼Œæ‰§è¡Œ SetControllerRotation()ï¼Œéœ€è¦åšç¿»è½¬çš„ä¸€ä¸ªæµç¨‹è¾“å…¥ä¸€ä¸ª `MakeRotator` å¹¶é…ç½® Z å€¼ 180ï¼Œè¿™æ · Flipbook çš„è§’è‰²åŠ¨ç”»æ–¹å‘å°±æ­£ç¡®äº†ï¼›
- å¯¹äºç­‰äº 0.0 çš„æƒ…å†µï¼Œåªéœ€è¦æ’­æ”¾ IdleAnimationï¼Œæ ¹æ®è“å›¾å˜é‡ bisMovingRight æ¥åˆ¤æ–­è§’è‰²æœ€åæ˜¯å¾€ä»€ä¹ˆæ–¹å‘ç§»åŠ¨ï¼Œé…åˆ `Branch` èŠ‚ç‚¹åšæ¡ä»¶åˆ†æ”¯ï¼Œä½¿ç”¨åŒæ ·çš„æ§åˆ¶å™¨ç¿»è½¬æ“ä½œã€‚
- ä½¿ç”¨ Pawn GetController() æ¥è·å–è§’è‰²çš„æ§åˆ¶å™¨å¯¹è±¡ï¼›

`Axis Events MoveRight` äº‹ä»¶å¤„ç†å³è¿åŠ¨å¤„ç†é€»è¾‘ï¼š

- ç”±å¼•æ“æ¥æ”¶åˆ°ç”¨æˆ·è¾“å…¥ï¼Œå¹¶æ‰§è¡Œ MoveRight äº‹ä»¶ï¼Œå¾—åˆ° AxisValue æµ®ç‚¹å€¼ï¼›
- ä½¿ç”¨ Branch èŠ‚ç‚¹åšæµè¡Œæ‰§è¡Œï¼›
    - ä½¿ç”¨ Float Greater åˆ¤æ–­ï¼ŒAxisValue å¤§äº 0.0 å°±æ‰§è¡Œ Set bisMovingRight èŠ‚ç‚¹ï¼Œå°†å˜é‡è®¾ç½®ä¸º true å€¼ï¼Œè¡¨ç¤ºå‘å³ç§»åŠ¨äº†ï¼›
    - å¦åˆ™ï¼Œä½¿ç”¨ Float Less èŠ‚ç‚¹ï¼Œä¹Ÿå¯ä»¥ç”¨ float < float æ‰¾åˆ°ï¼Œåˆ¤æ–­ AxisValue å°äº 0.0 å°±æ‰§è¡Œ Set bisMovingRight å°†å˜é‡è®¾ç½® false å€¼ï¼›
- æœ€åï¼Œæ‰§è¡Œ Pawn çš„ AddMovementInput å‡½æ•°ï¼ŒWorldDirection ä½¿ç”¨å•ä½å‘é‡ (1,0,0)ï¼ŒAxisValue ä½œä¸º ScaleValue ä¸å•ä½å‘é‡è¿ç®—ï¼Œå¾—åˆ°ç§»åŠ¨çš„å‘é‡ï¼›

Pawn è¿˜æœ‰å…¶å®ƒç±»ä¼¼çš„å åŠ è¾“å…¥å€¼çš„å‡½æ•° *AddControllerPitchInput*ã€*AddControllerRollInput*ã€*AddControllerYawInput*ï¼Œæ³¨æ„ AController æœ¬èº«æ˜¯ AActor çš„å­ç±»ã€‚

è·³è·ƒäº‹ä»¶å¤„ç†é€»è¾‘ä¸­ä½¿ç”¨äº†ä¸¤ä¸ªäº‹ä»¶ï¼š

- `Action Events Jump` å¼•æ“é»˜è®¤çš„è·³è·ƒäº‹ä»¶ï¼Œå¦‚æŒ‰ç©ºæ ¼ã€å‘ä¸Šç®­å¤´ï¼›
- `Input Touch` è§¦å±è¾“å…¥ï¼Œè§¦æ‘¸æ—¶å°±ä¼šè·³è·ƒï¼Œç¦»å±å°±åœæ­¢è·³è·ƒåŠ¨ä½œï¼›
- ä¸¤ä¸ªäº‹ä»¶çš„ Pressed æ‰§è¡Œæµç¨‹éƒ½ä¼šè°ƒç”¨è§’è‰²çš„ Jump å‡½æ•°ï¼›
- ä¸¤ä¸ªäº‹ä»¶çš„ Released æ‰§è¡Œæµç¨‹éƒ½ä¼šè°ƒç”¨è§’è‰²çš„ StopJumping å‡½æ•°ï¼›

ä¹Ÿå¯ä»¥ç›´æ¥è®¾ç½®ä¸€ä¸ª Keyboard Events J äº‹ä»¶æ¥è§¦å‘è·³è·ƒåŠ¨ä½œï¼Œä½†æ˜¯è¿™æ ·ç¡¬ç¼–ç ä¸æ˜¯å¾ˆå¥½ã€‚

UE4 çš„å·¥ç¨‹é…ç½®ä¸­ï¼Œé»˜è®¤è®¾ç½®äº†ç”¨æˆ·è¾“å…¥çš„äº‹ä»¶æ˜ å°„å…³ç³»ï¼š

- Action Mappings é…ç½®ä¸­å°† Wã€UPã€SpaceBarã€Gamepad Face Button Bottom å³æ‰‹æŸ„çš„ A æŒ‰é’®æ˜ å°„ä¸º Jump äº‹ä»¶ï¼›
- Axis Mappings é…ç½®ä¸­å°† Aã€Dã€Leftã€Rightã€Gamepad Left Thumbstick X-Axis å³æ‰‹æŸ„çš„å·¦æ‘‡æ†çš„å·¦å³æ–¹å‘æ˜ å°„ä¸ºç§»åŠ¨äº‹ä»¶ï¼›

ç›¸å½“äºä½¿ç”¨ C++ ä»£ç çš„ BindAxis å’Œ BindAction æ–¹æ³•ç»‘å®šäº‹ä»¶ä¸è°ƒç”¨å‡½æ•°ï¼š

```cpp
void AMyPawn::SetupPlayerInputComponent(UInputComponent* PlayerInputComponent)
{
    Super::SetupPlayerInputComponent(PlayerInputComponent);
    // ç§»åŠ¨è½´äº‹ä»¶é€å¸§ååº”ï¼Œå¹¶æä¾› AxisValue å€¼ã€‚
    PlayerInputComponent->BindAxis("MoveRight", this, &AMyPawn::move);
    // åŠ¨ä½œäº‹ä»¶åªåœ¨æŒ‰ä¸‹æˆ–æ¾å¼€æŒ‰é”®æ—¶åšå‡ºå“åº”ã€‚
    PlayerInputComponent->BindAction("Jump",IE_Pressed,this,&AMyCharacter::jump);
}
```

ç»‘å®šæ˜¯é€šè¿‡å§”æ‰˜ Delegate æ³›å‹ç±»å‹å®‰å…¨å®ç°çš„ï¼Œå‚è€ƒ `InputComponent` ç±»å®ç°ã€‚

æ¶‰åŠå¯¹è±¡çš„æºä»£ç ä½äº Paper2D æ’ä»¶å’Œ Engine\Source\Runtime\Engine\Classes\GameFramework\Actor.h

åœ°å›¾ä¸­æœ‰ä¸€ä¸ª PlayerStart å¯¹è±¡ï¼Œè¡¨ç¤ºæ¸¸æˆç©å®¶çš„å‡ºåœºä½ç½®ã€‚

å¦ä¸€ä¸ªé‡è¦çš„å¯¹è±¡æ˜¯ 2DSideScrollerGameModeï¼Œå®ƒæ˜¯ä¸€ä¸ª Data-Only Blueprint Classï¼Œåªæ˜¯å•çº¯ç»§æ‰¿ AGameBase åŸºç±»ã€‚å·¥ç¨‹æ¨¡æ¿åªåˆ›å»ºè¿™ä¸ªå¯ä½¿ç”¨ç®€å•äººç‰©çš„ GameMode å¯¹è±¡ï¼Œå¹¶è®©å®ƒä½¿ç”¨äººç‰©è§’è‰²ï¼Œåœ¨ Default Pawn Class å±æ€§æŒ‡å®š 2DSideScrollerCharacterï¼Œè¿™æ ·å¼€å§‹æ¸¸æˆæ—¶ï¼Œå¼•æ“å°±ä¼šå°†å…¶å®ä¾‹åŒ–ä½œä¸ºç©å®¶æ“æ§çš„è§’è‰²ã€‚

- åœ¨ Content Browser ä¸­ï¼Œå•å‡» New æŒ‰é’®ï¼Œç„¶åå•å‡» Blueprint Classs é€‰é¡¹ã€‚
- åœ¨å¼¹å‡ºçš„çª—å£å†…å•å‡» Game Mode æŒ‰é’®ï¼Œä»¥å®ƒä¸ºçˆ¶ç±»ã€‚
- å‘½ååæ‰“å¼€ GameMode è“å›¾å¹¶å•å‡» Defaults é€‰é¡¹å¡ã€‚
- åœ¨ Defaults é€‰é¡¹å¡çš„ Classes éƒ¨åˆ†ï¼Œå•å‡» Default Pawn Class ä¸‹æ‹‰èœå•å¹¶é€‰æ‹©æ–°äººç‰©ã€‚
- Compile å¹¶ Saveï¼Œç„¶åå…³é—­è“å›¾ã€‚
- åœ¨ä¸»ç¼–è¾‘å™¨çª—å£ä¸­ï¼Œå•å‡»èœå•æ ä¸Šçš„ Edit æŒ‰é’®å¹¶é€‰æ‹© Project Settingsã€‚
- ç°åœ¨ï¼Œæˆ‘ä»¬è¦è®©æˆ‘ä»¬çš„é¡¹ç›®ä½¿ç”¨æ–°å»ºçš„ GameModeã€‚
- åœ¨ Project Settings ä¸­ï¼Œå•å‡» Maps & Modes é€‰é¡¹ã€‚
- åœ¨ Maps & Modes çš„ Default Modes éƒ¨åˆ†ï¼Œå•å‡» Default GameMode ä¸‹æ‹‰èœå•å¹¶é€‰æ‹©ä½ çš„ GameModeã€‚

æœ€åï¼Œæ¸¸æˆçš„è¿›è¡Œè¿˜éœ€è¦ä¸€ä¸ªåœºæ‰€ï¼Œå³ Level Map ä¸­è®¾è®¡çš„åœºæ™¯ï¼Œé¡¹ç›®æä¾›çš„æ˜¯ 2DSideScrollerExampleMapï¼Œè¿˜æœ‰ç›¸åº”çš„ MapBuildData å³åœ°å›¾æ³¨å†Œæ•°æ®ã€‚ 

é€šè¿‡ Project Settings -> Project -> Maps & Modes å¯ä»¥ç»™é¡¹ç›®æŒ‡å®šä¸€ä¸ª GameMode å¯¹è±¡ï¼š

- Default GameMode æŒ‡å®šå·¥ç¨‹é»˜è®¤æ¸¸æˆæ¨¡å¼å¯¹è±¡ï¼›
- Game Startup Map æŒ‡å®šå¼€å§‹æ¸¸æˆæ—¶åŠ è½½çš„å…³å¡åœ°å›¾ï¼›
- Editor Startup Map æŒ‡å®šæ‰“å¼€ç¼–è¾‘å™¨æ—¶åŠ è½½çš„å…³å¡åœ°å›¾ï¼›

æ¯ä¸ªå…³å¡éƒ½æœ‰ä¸€ä¸ªé»˜è®¤çš„å…³å¡è“å›¾ Level Blueprintã€‚å®ƒå¾ˆç‰¹åˆ«ï¼Œä¸ä¸€èˆ¬çš„è“å›¾ä¸åŒï¼Œå®ƒæ˜¯ç®¡ç†æ•´ä¸ªåœ°å›¾çš„å…¨å±€äº‹ä»¶ï¼Œå¹¶ä¸” UE 4 ä¸å…è®¸è‡ªå·±åˆ›å»ºå…³å¡è“å›¾ã€‚

å¦å¤–ï¼Œåœºæ™¯å†…å®¹å·²ç»å°† Pawn è§’è‰²æ·»åŠ åˆ°åœºæ™¯ï¼Œå¹¶ä¸”å°†å…¶æŒ‡æ´¾ç»™ç¬¬ä¸€ä¸ªç©å®¶æ§åˆ¶ï¼šDetails -> Pwan -> Auto Possess Playerï¼Œå¦å¤–è¿˜å¯ä»¥æŒ‡æ´¾ç»™ AI æ§åˆ¶å™¨æ¥æ§åˆ¶ã€‚

æ­¤å·¥ç¨‹æ¨¡æ¿ä¸­çš„å…³å¡è“å›¾å¹¶æ²¡æœ‰è®¾ç½®ä»€ä¹ˆåŠŸèƒ½ï¼Œåªæ˜¯å¸ƒç½®äº†åœºæ™¯å†…å®¹çš„ä¸€äº›è·³å°å’Œé˜»æŒ¡ç‰©ã€‚

è¿™ä¹Ÿæ˜¯ä¸€ä¸ªç®€å•çš„åŠŸèƒ½ç¤ºèŒƒï¼Œç¼ºå°‘å®Œæ•´æ¸¸æˆçš„å…¶å®ƒåŠŸèƒ½ï¼Œæ¯”å¦‚ä¸æ•Œäººçš„ææ€ï¼Œæ­¦å™¨ï¼Œå…³å¡çš„è½¬æ¢ï¼Œå„ç§ä¸Š NPC è§’è‰²çš„è®¾ç½®ç­‰ç­‰ã€‚

ä¸‹ä¸€æ­¥ï¼Œé€šè¿‡å®˜æ–¹æ–‡æ¡£å­¦ä¹ å…¶å®ƒå…³é”®å†…å®¹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å®˜æ–¹æä¾›çš„å­¦ä¹ ç¤ºèŒƒèµ„æºï¼Œå¦‚ Content Examples å°±åŒ…å«å¤§é‡åŸºç¡€çš„çŸ¥è¯†ç‚¹ç¤ºèŒƒæ¡ˆä¾‹ã€‚


## âš¡ Sequencer & Matinee è¿‡åœºåŠ¨ç”»
- Sequencer è¿‡åœºåŠ¨ç”» https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/Sequencer/
- Matinee è¿‡åœºåŠ¨ç”» https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/Matinee/
- æ¸¸æˆå¼•æ“æ¶æ„ Game Engine Architecture by Jason Gregoryï¼Œè¯‘è€… å¶åŠ²å³°
- Sequencerå¿«é€Ÿå…¥é—¨ https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/Sequencer/QuickStart/
- Sequencer å¿«æ·æ“ä½œé€ŸæŸ¥è¡¨ https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/Sequencer/CheatSheet/

è™šå¹»å¼•æ“æ‹¥æœ‰å¼ºå¤§çš„è¿‡åœºåŠ¨ç”»å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ä½ åˆ›å»ºåŠ¨ç”»åŠè¿‡åœºåŠ¨ç”»åºåˆ—ã€‚ä½ å¯ä»¥å¼•å¯¼æ‘„åƒæœºåœ¨å…³å¡ä¸­ç©¿æ¢­é£è¡Œï¼Œä¹Ÿå¯ä»¥ä¸ºå…‰æºæ·»åŠ åŠ¨ç”»ã€ç§»åŠ¨å¯¹è±¡ã€ä¸ºè§’è‰²æ·»åŠ åŠ¨ç”»ã€æ¸²æŸ“è¾“å‡ºåºåˆ—ç­‰ã€‚è¿™äº›å·¥ä½œæµçš„æ ¸å¿ƒæ˜¯ `Sequencer` åºåˆ—ç¼–è¾‘å™¨ï¼Œè¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„éçº¿æ€§ç¼–è¾‘å·¥å…·ã€‚åœ¨è™šå¹»å¼•æ“ä¸­åˆ›å»ºè¿‡åœºåŠ¨ç”»å†…å®¹æ—¶ï¼Œåºåˆ—ç¼–è¾‘å™¨å°±æ˜¯æœ€ä¸»è¦çš„å·¥å…·ã€‚

åˆ©ç”¨åºåˆ—å½•åˆ¶å™¨ Sequence Recorderï¼Œæ‚¨å¯ä»¥åœ¨å…³å¡ç¼–è¾‘æˆ–æ¸¸æˆè¿›ç¨‹æœŸé—´é‡‡é›†æŒ‡å®šçš„ Actorï¼Œå¦å­˜ä¸ºä¸€ä¸ªæ–°çš„å…³å¡åºåˆ—ï¼Œè¿˜å¯ä»¥åœ¨ Sequencer å†…è¿›è¡Œç¼–è¾‘ã€‚è¿™å¯¹äºå¿«é€Ÿé‡‡é›†åœºæ™¯çš„å†…å®¹éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºæ‚¨å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¯æ“ä½œè§’è‰²ï¼Œåœ¨æ¸¸æˆè¿›ç¨‹ä¸­æ‰§è¡Œä¸€äº›æ“ä½œï¼ŒåŒæ—¶ä½¿ç”¨åºåˆ—å½•åˆ¶å™¨è¿›è¡Œå½•åˆ¶ï¼Œç„¶åå°†è¿™äº›æ•°æ®è¾“å…¥åˆ° Sequencer ä¸­ï¼Œå›´ç»•è¿™äº›æ•°æ®åˆ›å»ºä¸€ä¸ªè¿‡åœºåŠ¨ç”»ã€‚

Sequencer ç¼–è¾‘å™¨ä½¿ç”¨æˆ·èƒ½å¤Ÿç”¨ä¸“ä¸šçš„å¤šè½¨è¿¹ç¼–è¾‘å™¨åˆ›å»ºæ¸¸æˆå†…è¿‡åœºåŠ¨ç”»ã€‚é€šè¿‡åˆ›å»º Level Sequences å’Œæ·»åŠ  Tracksï¼Œç”¨æˆ·å¯ä»¥å®šä¹‰å„ä¸ªè½¨è¿¹çš„ç»„æˆï¼Œè¿™æ ·å°†ç¡®å®šåœºæ™¯çš„å†…å®¹ã€‚

è½¨è¿¹å¯ä»¥åµŒå…¥å¤šå±‚ï¼Œä½†æ¯å±‚å¯ä»¥ä½¿ç”¨çš„è½¨è¿¹ç±»å‹å—åˆ°ä¸Šä¸€å±‚è½¨è¿¹ç±»å‹çº¦æŸï¼Œé¡¶çº§çš„è½¨è¿¹å‚è€ƒï¼š

- Audio Trackï¼ŒéŸ³é¢‘è½¨è¿¹ç”¨äºåŒ…æ‹¬éŸ³ä¹æˆ–éŸ³æ•ˆï¼›
- Shots Track å¤šé•œå¤´ç»„ç»‡è½¨è¿¹é•œå¤´ç»„ä»¶è½¨ï¼Œåœ¨ä¸€ä¸ªåºåˆ—ä¸­ç»„ç»‡å…¶å®ƒåºåˆ—æä¾›çš„åŠ¨ç”»é•œå¤´ï¼Œå¯ä»¥æ–¹ä¾¿è¿›è¡Œå¤šåºåˆ—ç¼–è¾‘ï¼›
- Camera Cuts Track æ‘„åƒæœºç»„ä»¶è½¨è¿¹ï¼Œåœ¨åŒä¸€ä¸ªåºåˆ—ä¸­ç»„ä»¶å¤šä¸ªæ‘„åƒæœºçš„é•œå¤´ï¼›
- Event Track æ’­æ”¾è¿‡åœºåŠ¨ç”»æ—¶è§¦å‘äº‹ä»¶æ¥å¯åŠ¨éƒ¨åˆ†è„šæœ¬åŠŸèƒ½ï¼Œæœ‰ Trigger å’Œ Repeater ä¸¤ç§ç±»å‹ï¼Œå‰ä¸€ç§å¯ä»¥è®¾ç½®å…³é”®å¸§æ¥è§¦å‘äº‹ä»¶ã€‚

å…¶å®ƒäºŒçº§è½¨è¿¹ç±»å‹å‚è€ƒï¼š

- Animation Trackï¼Œç”¨äº Skeletal Mesh å¯¹è±¡è£…å…¥è§’è‰²åŠ¨ç”» Animation Skeletal Meshï¼›
- Transformation Trackï¼Œè®°å½•åœºæ™¯ä¸­çš„å¯¹è±¡çš„ç§»åŠ¨ã€æ—‹è½¬ç­‰ï¼›
- Camera Shake Track é•œå¤´æ™ƒåŠ¨æ•ˆæœï¼›
- Camera Animation é•œå¤´åŠ¨ç”»ï¼›
- Attach
- Patch å°†å¯¹è±¡ç»‘å®šåˆ°è·¯å¾„å¯¹è±¡ï¼Œå¦‚ Camera Rig Rail æ‘„åƒæœºè½¨é“ã€‚

åˆ©ç”¨äº‹ä»¶è½¨è¿¹ï¼Œå¯å°†è¿‡åœºåŠ¨ç”»ä¸­è¦è°ƒç”¨äº‹ä»¶çš„æŒ‡å®šå¸§è®¾ä¸ºå…³é”®å¸§ã€‚æ¯”å¦‚æ‰“å¼€æˆ–äº§ç”Ÿç²’å­æ•ˆæœï¼Œå¹¶ä»¥æŸç§æ–¹å¼å½±å“ç©å®¶ã€‚æ— éœ€è®¿é—®è“å›¾ï¼Œå³å¯é€šè¿‡ Sequencer è½¨è¿¹æ·»åŠ äº‹ä»¶ã€‚å¯å‘å¯¹è±¡æ·»åŠ å¤šä¸ªäº‹ä»¶ï¼Œä¹Ÿå¯å‘å•ä¸ªäº‹ä»¶æ·»åŠ å¤šä¸ªå¯¹è±¡ç»‘å®šã€‚è‹¥æ‰“å¼€è“å›¾ï¼Œè¿˜å¯å‘ä¸€ä¸ªäº‹ä»¶æ·»åŠ å¤šä¸ªå‚æ•°ã€‚

### âœ’ Sequencer Shortcut å¿«æ·æ“ä½œ

Sequencer Editor å¿«æ·é”®ï¼š

- Enter åœ¨æ‰€é€‰è½¨é“çš„å½“å‰æ—¶é—´ä½ç½®è®¾ç½®ä¸€ä¸ªé”®ã€‚
- Space æ’­æ”¾æˆ–æš‚åœæ‰€é€‰åºåˆ—çš„æ’­æ”¾ï¼›
- Ctrl + G è½¬åˆ°åºåˆ—ä¸­è®¾å®šçš„æ—¶é—´/å¸§ã€‚
- Home é‡ç½®è½¨è¿¹åŒºçš„ç¼©æ”¾/è§†å›¾èŒƒå›´ã€‚
- - å’Œ = ä»¥ 10% ä¸ºå¢é‡ç¼©æ”¾è§†å›¾èŒƒå›´ã€‚
- , å’Œ . åœ¨è®¾ç½®çš„å…³é”®å¸§ä¹‹é—´å‰åç§»åŠ¨ã€‚
- Down æ’­æ”¾æ‰€é€‰åºåˆ—ã€‚
- Up è¿”å›åˆ°æ‰€æŒ‡å®šæ’­æ”¾èŒƒå›´çš„å¼€å§‹ä½ç½®ã€‚
- Left åœ¨å½“å‰åºåˆ—ä¸­é€å¸§å›é€€ã€‚
- Right åœ¨å½“å‰åºåˆ—ä¸­é€å¸§å‰è¿›ã€‚
- [ æˆ– ] é™åˆ¶æ’­æ”¾èŒƒå›´ï¼›
- I æˆ– O è®¾ç½®é€‰åŒºèµ·æ­¢ç‚¹ï¼›

åœ¨å…³å¡ä¸­é€‰æ‹© Actor åï¼Œé€‰ä¸­è½¨é“åæŒ‰ä»¥ä¸‹å¿«æ·é”®å¯åœ¨å½“å‰æ—¶é—´ä½ç½®æ·»åŠ å…³é”®å¸§ã€‚

- S æ·»åŠ ä¸€æ¡è½¬æ¢å­è½¨é“ï¼ˆå¦‚æœå°šä¸å­˜åœ¨è¯¥å­è½¨é“ï¼‰ï¼Œå¹¶æ·»åŠ å¯¹åº”ä½ç½®ã€æ—‹è½¬å’Œæ¯”ä¾‹çš„é”®ã€‚
- Shift + W æ·»åŠ ä¸€æ¡è½¬æ¢å­è½¨é“ï¼ˆå¦‚æœå°šä¸å­˜åœ¨è¯¥å­è½¨é“ï¼‰ï¼Œå¹¶åªæ·»åŠ å¯¹åº”ä½ç½®çš„é”®ã€‚
- Shift + E æ·»åŠ ä¸€æ¡è½¬æ¢å­è½¨é“ï¼ˆå¦‚æœå°šä¸å­˜åœ¨è¯¥å­è½¨é“ï¼‰ï¼Œå¹¶åªæ·»åŠ å¯¹åº”æ—‹è½¬çš„é”®ã€‚
- Shift + R æ·»åŠ ä¸€æ¡è½¬æ¢å­è½¨é“ï¼ˆå¦‚æœå°šä¸å­˜åœ¨è¯¥å­è½¨é“ï¼‰ï¼Œå¹¶åªæ·»åŠ å¯¹åº”æ¯”ä¾‹çš„é”®ã€‚

ä½¿ç”¨ä¸‹åˆ—æ•°å­—é”®æ¥è®¾ç½®æ‰€é€‰é”®çš„å…³é”®å¸§æ’å€¼æ–¹æ³•ï¼Œæ³¨æ„å›¾æ ‡å˜åŒ–å¯¹åº”ä¸åŒçš„æ’å€¼æ–¹å¼ï¼š

- 1 å°†æ‰€é€‰é”®è®¾ç½®ä¸ºä½¿ç”¨è‡ªåŠ¨åˆ‡çº¿ã€‚
- 2 å°†æ‰€é€‰é”®è®¾ç½®ä¸ºä½¿ç”¨ç”¨æˆ·å®šä¹‰çš„åˆ‡çº¿ã€‚
- 3 å°†æ‰€é€‰é”®è®¾ç½®ä¸ºä½¿ç”¨é—´æ–­åˆ‡çº¿ã€‚
- 4 å°†æ‰€é€‰é”®è®¾ç½®ä¸ºä½¿ç”¨çº¿æ€§åˆ‡çº¿ã€‚
- 5 å°†æ‰€é€‰é”®è®¾ç½®ä¸ºä½¿ç”¨å¸¸é‡åˆ‡çº¿ã€‚

åœ¨è½¨è¿¹åŒºä¸­é€‰æ‹©æŸä¸ªç‰‡æ®µï¼ˆéŸ³é¢‘æˆ–åŠ¨ç”»èµ„äº§ä»¥åŠæ‘„åƒæœºï¼Œç­‰ç­‰ï¼‰ä¹‹åï¼Œå¯ä½¿ç”¨ä¸‹åˆ—å‘½ä»¤è¿›è¡Œç¼–è¾‘ã€‚

- Ctrl + / åœ¨å½“å‰æ—¶é—´ä½ç½®åˆ†å‰²å½“å‰ç‰‡æ®µã€‚
- Ctrl + , ä¿®å‰ªæ‰å½“å‰ç‰‡æ®µä¸­ä½äºå½“å‰æ—¶é—´ä½ç½®å·¦ä¾§çš„éƒ¨åˆ†ã€‚
- Ctrl + . ä¿®å‰ªæ‰å½“å‰ç‰‡æ®µä¸­ä½äºå½“å‰æ—¶é—´ä½ç½®å³ä¾§çš„éƒ¨åˆ†ã€‚

è½¨é“ç»„ç»‡

- Ctrl + O æ‰€é€‰è½¨é“çš„å±•å¼€/æŠ˜å å¼€å…³ã€‚
- Shift + O æ‰€é€‰è½¨é“åŠå…¶å­è½¨é“çš„å±•å¼€/æŠ˜å å¼€å…³ã€‚

æ‰“å¼€å…³å¡åºåˆ—åï¼ŒæŒ‰ä½ä»¥ä¸‹ç»„åˆé”®å°†å¯¹è±¡ä» Place Actors é¢æ¿æˆ–å†…å®¹æµè§ˆå™¨æ‹–åˆ°è§†å£æ—¶ï¼Œä¼šå°†è¿™äº›å¯¹è±¡è‡ªåŠ¨æ·»åŠ åˆ° Sequencerã€‚

- Ctrl + æ‹–åŠ¨èµ„äº§åˆ°è§†å£ï¼Œè¿™ä¼šå°†å¯¹è±¡è‡ªåŠ¨æ·»åŠ åˆ° Sequencerã€‚
- Shift + æ‹–åŠ¨èµ„äº§åˆ°è§†å£ï¼Œè¿™ä¼šå°†å¯¹è±¡ä½œä¸º Spawnable å¯å†ç”Ÿå¯¹è±¡è‡ªåŠ¨æ·»åŠ åˆ° Sequencerã€‚

åœ¨ Matinee ä¸­ï¼Œè¿‡åœºåŠ¨ç”»ä¸­çš„æ‰€æœ‰å†…å®¹éƒ½å¿…é¡»å­˜åœ¨äºå…³å¡ä¸­ï¼Œå¹¶è¢« Matinee å æœ‰ï¼Œä»¥ä¾¿è·å¾—æ¯ä¸ª Actor çš„æ§åˆ¶æƒå’Œå‘ Actor æä¾›æŒ‡ä»¤ã€‚ å®ƒå­˜åœ¨äº Sequencer ä¸­ï¼Œä½†ä¹Ÿæœ‰ä¸€ä¸ª å¯ç”Ÿæˆç‰©ï¼ˆSpawnablesï¼‰ æ¦‚å¿µï¼Œå³ä½ å¯ä»¥å°† Actor è½¬æ¢ä¸º Sequencer ä¸éœ€è¦å æœ‰ã€è€Œæ˜¯åœ¨éœ€è¦æ—¶äº§ç”Ÿçš„å¯¹è±¡ã€‚ å¦‚æœä½ æœ‰è¦åœ¨å¤šä¸ªå…³å¡ä¸­å¤ç”¨çš„å†…å®¹è¿™å°†å¾ˆæœ‰ç”¨ï¼Œå› ä¸º Actor ä¸å†ä¸å…³å¡ç»‘å®šï¼Œè€Œæ˜¯ä¸å…³å¡åºåˆ—ç»‘å®šã€‚

Viewport å¿«æ·é”®ï¼š

- Shift + C å°†æ´»åŠ¨è§†å£åˆ‡æ¢åˆ°è¿‡åœºåŠ¨ç”»è§†å£æŸ¥çœ‹æ¨¡å¼ Cinematic Viewportã€‚
- Shift + D å°†æ´»åŠ¨è§†å£åˆ‡æ¢åˆ°é»˜è®¤è§†å£æŸ¥çœ‹æ¨¡å¼ Default Viewportã€‚
- Ctrl + Shift + T åˆ‡æ¢æ´»åŠ¨è§†å£ä¸­å·¥å…·æ çš„æ˜¾ç¤ºã€‚
- G è¿›å…¥æ¸¸æˆè§†å›¾ï¼ˆéšè—æ‰€æœ‰ç¼–è¾‘å™¨å›¾æ ‡ï¼‰ã€‚

### âœ’ Sequences è¿‡åœºåŠ¨ç”»

åˆ›å»ºå…³å¡åºåˆ—æ“ä½œï¼šContent Browser -> Animations -> Level Sequenceï¼Œç„¶åå†å°†å…¶æ”¾ç½®åˆ°å…³å¡ä¸­ã€‚

é€šè¿‡èœå• Window -> Cinematics -> Sequencer æ‰“å¼€è¿‡åœºåŠ¨ç”»å’Œåºåˆ—ç¼–è¾‘å™¨ã€‚
 
åœ¨è¯¦ç»†ä¿¡æ¯ï¼ˆDetailsï¼‰é¢æ¿ä¸­ï¼Œä½ å¯ä»¥å®šä¹‰ Level Sequence æ˜¯å¦å°†åœ¨å…³å¡å¼€å§‹æ—¶è‡ªåŠ¨æ’­æ”¾ï¼Œåºåˆ—æ˜¯å¦åº”å¾ªç¯ï¼Œåºåˆ—çš„æ’­æ”¾é€Ÿç‡ï¼ˆPlay Rate for the Sequenceï¼‰å’Œå…¶ä»–è®¾ç½®ã€‚

ä¸ Matinee ä¸åŒï¼ŒLevel Sequence æ˜¯è‡ªåŒ…å«èµ„æºï¼Œä½ å¯ä»¥å°†ä¸€ä¸ªå…³å¡åºåˆ—åµŒå…¥åˆ°å¦ä¸€ä¸ªå…³å¡åºåˆ—ä¸­ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥åˆ›å»ºå…·æœ‰åŠ¨ç”»è§’è‰²å’Œæ‘„åƒæœºçš„å…³å¡åºåˆ—ä½œä¸ºä¸€ä¸ªåœºæ™¯ï¼Œè€Œè¯¥åœºæ™¯æ˜¯æ›´å¤§çš„è¿‡åœºåŠ¨ç”»åºåˆ—çš„ä¸€éƒ¨åˆ†ã€‚

åˆ›å»ºå…³å¡åºåˆ—åï¼ŒåŒå‡»å®ƒä»¥æ‰“å¼€ Sequencer Editorï¼Œè¿™æ ·ä½ ä¾¿å¯ä»¥å¼€å§‹åˆ›å»ºä½ çš„è¿‡åœºåŠ¨ç”»ã€‚

å¯¹äºä¸€ä¸ªæ–°å»ºçš„ç©ºå…³å¡åºåˆ—ï¼Œè¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯æ·»åŠ ä¸€ä¸ªè½¨è¿¹ï¼ˆ`Track`ï¼‰ï¼Œæ³¨æ„ï¼ŒTrack æ˜¯å¯ä»¥åµŒå¥—çš„ï¼š

- Track çš„ç±»å‹å†³å®šå®ƒå¯ä»¥è®°å½•ä»€ä¹ˆæ•°æ®ï¼Œå…³è”çš„ç±»å‹å†³å®šäº†è½¨è¿¹çš„å…³é”®å¸§æ•°æ®å¦‚ä½•ä½œç”¨äºåœºæ™¯ä¸­çš„å¯¹è±¡ï¼›
- æ¯”å¦‚ï¼Œ*Audio Track* å¯ä»¥åœ¨å…³é”®å¸§ä¸­è®°å½•å½“ä¸‹çš„ Pitch éŸ³è°ƒå’Œ Volume éŸ³é‡ç­‰ä¿¡æ¯ã€‚
- Material Parameter Collection Track å¯ä»¥è®°å½•æè´¨çš„å‚æ•°å˜åŒ–ã€‚
- Camera Cut Track ç”¨äºåœ¨ Sequencer ä¸­å¤šä¸ªæ‘„åƒæœºç”»é¢çš„åˆ‡æ¢ï¼Œä½¿ç”¨ + å·ä»¥åœ¨è½¨é“ä¸Šæ·»åŠ é•œå¤´ç‰‡æ®µã€‚
- Shot Track ç”¨äºåˆ‡æ¢ç¼–è¾‘å¤šä¸ª LevelSequenceï¼Œç›¸åŒåç§°ä¸åŒç¼–å·çš„é•œå¤´ä¼šè¢«è¯†åˆ«ä¸ºå‰¯é•œå¤´ï¼ˆTakeï¼‰ï¼Œæ–¹ä¾¿åœ¨ç‰‡æ®µä¸Šåˆ‡æ¢ã€‚
- Subsecene Track ç”¨äºåµŒå¥—ç¼–è¾‘å¤šä¸ª LevelSequence ä¹‹é—´çš„æ··åˆã€‚

ä» + Track æŒ‰é’®çš„ä¸‹æ‹‰èœå• Actor To Sequencer å°†å·²åœ¨å…³å¡ä¸­çš„ä»»ä½• Actor æ·»åŠ åˆ° Sequencerï¼Œç„¶åå¯ä»¥ç»™å®ƒä»¬æ·»åŠ å±æ€§è½¨è¿¹ï¼Œæ¯”å¦‚ Transform Track æ¥è®°å½•å¯¹è±¡çš„ä½ç½®ï¼Œæ¯”å¦‚æ‘„åƒæœºçš„é•œå¤´æ§åˆ¶ã€‚

è®¾ç½®è§†å£é€‰é¡¹ Viewport Options -> Allow Cinematic Control å…è®¸è¿‡åœºåŠ¨ç”»æ§åˆ¶ã€‚è®¾ç½®è§†å›¾æ¨¡å¼ View Mode -> Cinematic Viewport åˆ‡æ¢ä¸ºè¿‡åœºåŠ¨ç”»è§†å£ï¼Œè¿™ä¼šå°†é€‰å®šçš„è§†å£è½¬ä¸ºè¿‡åœºåŠ¨ç”»è§†å£ï¼Œç„¶åå¯ä»¥åœ¨ Sequencer Editor ä¸­çš„æ‘„åƒæœºè½¨è¿¹ä¸­æ¿€æ´»è¦æ’­æ”¾çš„é•œå¤´ç”»é¢ã€‚

ç‚¹å‡»åœ¨æ‘„åƒæœºè½¨è¿¹å³ä¾§çš„æ‘„åƒæœºå›¾æ ‡æŒ‰é’®ï¼Œå°†è§†å£é”å®šåˆ°æ‘„åƒæœºï¼ˆLock Viewport to Cameraï¼‰ï¼Œå†æ¬¡ç‚¹å‡»å°±è§£é”æ‘„åƒæœºã€‚å¤„äºé”å®šçš„æ‘„åƒæœºå°±æ˜¯è¿›å…¥äº† Pilot æ¨¡å¼ï¼ŒCtrl + Shift + Pï¼Œå¯ä»¥ä½¿ç”¨ WASD åŠ é¼ æ ‡ç‚¹è¿›è¡Œé•œå¤´è°ƒæ•´ã€‚

Sequencer åŒ…å«å¼ºå¤§çš„æ‘„åƒæœºå·¥å…·ï¼Œå¯æ–¹ä¾¿ä½ ä½¿ç”¨è™šå¹»å¼•æ“åˆ¶ä½œç”µå½±ã€‚åœ¨å¯¹è±¡æ”¾ç½®é¢æ¿ Place Actors -> Cinematic ä¸‹æœ‰ä¸‰ä¸ªå’Œæ‘„åƒæœºåŠ¨ç”»æœ‰å…³çš„ Actorï¼Œå®ƒä»¬å¯ä»¥æ§åˆ¶é•œå¤´è¿åŠ¨ï¼š

- Camera Rig Crane æ‘„åƒæœºåŠè‡‚ï¼Œå‡é™å™¨ç»‘å®šï¼Œæ˜¯æ‹ç”µå½±çš„å¸¸ç”¨å·¥å…·ã€‚
- Camera Rig Rail é•œå¤´å¯¼è½¨è½¦ç»‘å®šï¼Œæ‘„åƒæœºå¹³ç§»æ¨è½¦ã€‚
- Cine Camera Actor ç”µå½±ä¸“ç”¨æ‘„åƒæœºã€‚

é€šè¿‡ Place Actors -> Cinematic é€‰é¡¹å¡ï¼Œå°†ä¸€ä¸ªæ‘„åƒæœºå¯¼è½¨ï¼ˆCamera Rig Railï¼‰èµ„äº§æ‹–åŠ¨åˆ°å…³å¡ä¸­ã€‚åœ¨å…³å¡ä¸­é€‰æ‹© CameraRigRailï¼Œç„¶åé€‰æ‹©ä¸¤ç«¯çš„æ§åˆ¶ç‚¹ï¼Œé€šè¿‡ç§»åŠ¨ã€æ—‹è½¬æ¥æ”¹å˜è½¨é“å½¢çŠ¶ã€‚æ§åˆ¶ç‚¹å¯ä»¥å¤åˆ¶ï¼Œä¿æŒæ§åˆ¶ç‚¹é€‰ä¸­çš„æƒ…å†µä¸‹ï¼ŒæŒ‰ä½ Alt ç„¶åæ‹–åŠ¨å³å¯ä»¥å¤åˆ¶å‡ºå¦ä¸€ä¸ªç‚¹ã€‚å¤šæ¬¡ç«¯ç‚¹å¤åˆ¶ï¼Œå°±å¯ä»¥è°ƒæ•´å‡ºä»»æ„çš„è½¨é“ï¼Œæ¯”å¦‚å‘¨å›´å½¢æˆä¸€ä¸ªå¹³æ»‘çš„ç¯å½¢ã€‚

ä½¿ç”¨æ‘„åƒæœºå¯¼è½¨çš„ç›®çš„å°±æ˜¯è®©æ‘„åƒæœºæ²¿ç€è½¨é“ç§»åŠ¨ï¼Œåœ¨é¢æ¿ä¸­è®¾ç½® Details -> Current Position on Rail è®¾ç½® 0.0 ~ 1.0 çš„å€¼è¡¨ç¤ºè½¨é“çš„èµ·ç‚¹åˆ°ç»ˆç‚¹ã€‚é€šè¿‡å…¨å±€å¤§çº²ï¼ˆWorld Outlinerï¼‰ï¼Œå°† CineCameraActor æ‹–æ”¾åˆ° CameraRig_Rail ä¸Šå°±å¯ä»¥è¿æ¥å®ƒï¼Œä½¿ç”¨ç”µå½±æ‘„åƒæœºæ²¿ç€è½¨é“è¿è¡Œã€‚åŒæ ·ï¼ŒCamera Rig Crane æ‘„åƒæœºåŠè‡‚ä¹Ÿå¯ä»¥å’Œ Camera Rig Rail ç›¸äº’å½¢æˆå­çº§è¢«æ§çš„å…³ç³»ã€‚æˆ–è€…åœ¨ Viewport ä¸­ä½¿ç”¨å³é”®èœå• `Attach To` å°†å…¶æ·»åŠ åˆ°åŠè‡‚çš„å­çº§ã€‚

æ‘„åƒæœºåŠè‡‚è®¾ç½®éº»çƒ¦ç‚¹ï¼Œå…¶å¯¹è±¡æœ¬èº«åˆ†åŸºåº§å’ŒåŠè‡‚ä¸¤éƒ¨åˆ†ï¼ŒåŒå‡»åŠè‡‚æ­Œè¯å¯¹å…¶å•ç‹¬è¿›è¡Œç§»åŠ¨ã€ç¼©æ”¾æ“ä½œï¼Œä½†æ˜¯æ—‹è½¬æ“ä½œéœ€è¦é€šè¿‡ Details é¢æ¿æ¥è®¾ç½®ã€‚å› ä¸ºå…¶å†…éƒ¨æœ‰éª¨æ¶æ§åˆ¶ CraneYawControl & CranePitchControlã€‚

Details -> Crane Controls é¢æ¿ä¸­è®¾ç½®ï¼š

- Crane Pitch åŠè‡‚ä¿¯ä»°è§’åº¦ï¼›
- Crane Yaw åå‘è§’åº¦ï¼›
- Crane Arm Length åŠè‡‚é•¿åº¦ï¼›

åŒæ ·ï¼Œåœ¨ Sequencer Editor ä¸­ï¼Œä¹Ÿéœ€è¦ä¸ºåŠè‡‚è½¨è¿¹æ·»åŠ ç›¸åº”çš„å±æ€§è½¨é“ã€‚


ç”µå½±æ‘„åƒæœºå°†æ˜¯åœ¨ Sequencer ä¸­ä½¿ç”¨çš„ä¸»è¦ç”µå½±æ‘„åƒæœºå¯¹è±¡ï¼Œå®ƒåŒ…å«ç”¨äºæ¨¡æ‹ŸçœŸå®ä¸–ç•Œæ‘„åƒæœºé•œå¤´å’Œæœºèº«çš„å„ç§å±æ€§ã€‚ä½ å¯ä»¥æ§åˆ¶ç„¦è·ã€é•œå¤´è®¾ç½®ã€å…‰åœˆã€é¢œè‰²åˆ†çº§ï¼Œä»¥åŠå„ç§å…¶ä»–åæœŸå¤„ç†æ•ˆæœã€‚

å‘åœºæ™¯ä¸­æ·»åŠ ç”µå½±æ‘„åƒæœºï¼Œä¿æŒé€‰ä¸­ CineCameraActor çš„æƒ…å†µä¸‹ï¼ŒæŒ‰ S ä¸ºå½“å‰ Transform è½¨è¿¹æ·»åŠ ä¸€ä¸ªå…³é”®å¸§ã€‚æ­¤æ“ä½œè®© Sequencer çŸ¥é“æ‘„åƒæœºçš„èµ·å§‹ä½ç½®å’Œç§»åŠ¨èµ·ç‚¹ï¼Œå°†æ—¶é—´è½´ç§»åŠ¨åˆ°å…³å¡åºåˆ—çš„ç»“å°¾ï¼Œå¹¶è°ƒæ•´æ‘„åƒæœºï¼Œç„¶åæŒ‰ S åœ¨æ‰€éœ€ä½ç½®æ·»åŠ ä¸€ä¸ªå…³é”®å¸§ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬çš„åœºæ™¯ä¸­å°±æœ‰äº†ä¸€äº›æ‘„åƒæœºè¿åŠ¨ã€‚

åœ¨ CineCameraActor çš„ Details -> Current Camera Settings é¢æ¿ä¸­ï¼Œè®¾ç½®ï¼š

- Look at Tracking Settings éƒ¨åˆ†ï¼š
    - Enable Look at Tracking - é€‰å–æ­¤é€‰é¡¹å¯ä»¥è®©æ‘„åƒæœºè·Ÿè¸ª Actorï¼Œå³é•œå¤´å§‹ç»ˆçœ‹å‘æŸä¸€è§’è‰²ã€‚
    - Draw Debug Look at Tracking Position - æ˜¾ç¤ºè°ƒè¯•è§‚çœ‹è·Ÿè¸ªä½ç½®ï¼Œé€‰å–æ­¤é€‰é¡¹å¯ä»¥è®©æˆ‘ä»¬çœ‹åˆ°æ‘„åƒæœºæ­£åœ¨è§‚çœ‹çš„ä½ç½®ã€‚
    - Actor to Track - æŒ‡å®šè¦è·Ÿè¸ªçš„å¯¹è±¡ï¼Œæ¯”å¦‚å°†æ­¤é¡¹è®¾ç½®ä¸ºåœºæ™¯å†…çš„ Characterï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›åœ¨é•œå¤´ä¸­è·Ÿè¸ªæ­¤è§’è‰²ã€‚
    - Relative Offset - ç›¸å¯¹åç§»ï¼Œå°† Z è®¾ç½®ä¸º 60 ä»¥å°†è·Ÿè¸ªä½ç½®ä»é»˜è®¤è·Ÿè¸ªä½ç½®ç¨ç¨æé«˜ã€‚
    - Look at Tracking Interp Speed è®¾ç½®é•œå¤´è·Ÿè¸ªæ—¶çš„å“åº”é€Ÿåº¦ã€‚
- Lens Settings éƒ¨åˆ†ï¼Œå°†æœ€å°ç„¦è·ï¼ˆMin Focal Lengthï¼‰è®¾ç½®ä¸º 50.0mmï¼Œæœ€å¤§ç„¦è·ï¼ˆMax Focal Lengthï¼‰è®¾ç½®ä¸º 1000.0mmã€‚æœ€å°/æœ€å¤§ç„¦è·è®¾ç½®å°†å½±å“æˆ‘ä»¬å¯ä»¥åº”ç”¨ç„¦è·çš„èŒƒå›´ï¼Œç¨åæˆ‘ä»¬å°±å°†ä»¥æ¯«ç±³ä¸ºå•ä½è®¾ç½®ç„¦è·ã€‚
- Focus Settings éƒ¨åˆ†ï¼Œè®¾ç½® Focus Method ä¸º Trackingã€‚Actor to Track æ—è¾¹æ»´ç®¡ç”¨æ¥é€‰æ‹©å…³å¡ä¸­çš„è§’è‰²ï¼Œç„¦ç‚¹å§‹ç»ˆè·Ÿè¸ªæˆ‘ä»¬é€‰æ‹©çš„ Actorã€‚


è¿˜å¯ä»¥ç»™æ‘„åƒæœºåˆ›å»ºé•œå¤´æŠ–åŠ¨æ•ˆæœï¼Œé¦–å…ˆéœ€è¦åˆ›å»ºæŒ¯åŠ¨æºç»„ä»¶ï¼Œæ·»åŠ æ™ƒåŠ¨æºï¼Œä» Place Actos ä¸­æœç´¢ Camera Shake Sourceï¼Œå¹¶æ‹–åŠ¨åˆ°å…³å¡ä¸Šã€‚ç„¶åä½¿ç”¨è“å›¾æ‰©å±• CameraShake > MatineeCameraShake ä¸¤è€…ä¹‹ä¸€ï¼Œå¾—åˆ°æ‘„åƒæœºæ™ƒèµ„äº§è“å›¾ï¼Œç„¶ååœ¨ Sequencerã€è“å›¾å’Œæ‘„åƒæœºæ™ƒåŠ¨æºä¸­æ’­æ”¾å®ƒä»¬ã€‚

- ä» Sequencer æ’­æ”¾ï¼Œåªéœ€è¦ç»™ç”µå½±æ‘„åƒæœºè½¨é“ä¸Šå¢åŠ  Camera Shake æ‘„åƒæœºæ™ƒåŠ¨è½¨é“ï¼Œå¹¶ä»èœå•ä¸­é€‰æ‹©æ‘„åƒæœºæ™ƒèµ„äº§è“å›¾ã€‚
- ä»è“å›¾æ’­æ”¾ï¼Œä½¿ç”¨ Start Camera Shake èŠ‚ç‚¹ï¼Œä»è“å›¾æ’­æ”¾æ™ƒåŠ¨ã€‚è¯¥èŠ‚ç‚¹åŒ…å«ç”¨äºæŒ‡å®šæ™ƒåŠ¨ã€æ¯”ä¾‹å’Œæ’­æ”¾ç©ºé—´çš„å‚æ•°ã€‚

æ‘„åƒæœºæ™ƒåŠ¨æºä¼šåŸºäºæ‘„åƒæœºä¸æŸä¸ªä½ç½®çš„æ¥è¿‘ç¨‹åº¦æ¥è§¦å‘æ‘„åƒæœºæ™ƒåŠ¨ï¼Œå®ƒè¿˜åŒ…å«æ§åˆ¶æ™ƒåŠ¨å½±å“çš„å¤§å°å’ŒåŠå¾„ã€‚ä½ å¯ä»¥å°†å…¶æ·»åŠ ä¸ºå…³å¡çš„ Actorï¼Œæˆ–åœ¨è“å›¾ä¸­æ·»åŠ ä¸ºç»„ä»¶ã€‚

åŒå‡»æ‰“å¼€æ‘„åƒæœºæ™ƒåŠ¨è“å›¾èµ„äº§çš„ç¼–è¾‘å™¨ï¼Œå¯ä»¥åœ¨ Class Defaults è®¾ç½®ä¸­çœ‹åˆ° Camera Shake Pattern æ‹¥æœ‰ä»¥ä¸‹åŸºæœ¬ç»†èŠ‚ï¼š

- Single Instance å‹¾é€‰ä»…å…è®¸æ’­æ”¾æ­¤æ™ƒåŠ¨çš„å•ä¸ªå®ä¾‹ä¸€æ¬¡ã€‚éšåå°è¯•æ’­æ”¾æ­¤æ™ƒåŠ¨å°†é‡æ–°å¯åŠ¨å®ƒï¼Œè€Œä¸æ˜¯é¢å¤–åˆ†å±‚ã€‚
- Root Shake Pattern æ ¹æ™ƒåŠ¨æ¨¡å¼è®¾ç½®è¦ä½¿ç”¨çš„æ™ƒåŠ¨ç±»å‹ï¼Œæ™ƒåŠ¨æ¨¡å¼æ§åˆ¶æ‘„åƒæœºæ™ƒåŠ¨çš„å½¢çŠ¶å’Œè¡Œä¸ºã€‚
    - Perlin Noise æŸæ—å™ªå£°æ¨¡å¼ï¼Œé€šè¿‡åŸºäºæŒ‡å®šçš„æŒ¯å¹…å’Œé¢‘ç‡å¯¹éšæœºç‚¹è¿›è¡Œé‡‡æ ·ï¼Œå¯ä»¥ç”Ÿæˆéšæ—¶é—´å˜åŒ–çš„ Perlin å™ªå£°ã€‚
    - Sinusoidal Wave æ­£å¼¦æ³¢æ™ƒåŠ¨æ¨¡å¼ï¼Œä½¿ç”¨æ‹¥æœ‰å¹³æ»‘å‘¨æœŸæŒ¯è¡çš„è¿ç»­æ³¢ç”Ÿæˆéšæ—¶é—´å˜åŒ–çš„å™ªå£°ã€‚é€šå¸¸ï¼Œæ³¢å™ªå£°å¯¹äºè¾ƒä½å¼ºåº¦çš„æ™ƒåŠ¨éå¸¸æœ‰ç”¨ï¼Œå¦‚æ‘‡æ‘†çš„èˆ¹æˆ–æ¢¦å¹»èˆ¬çš„æ¼‚æµæ•ˆæœã€‚
    - Sequence Shake åºåˆ—æ™ƒåŠ¨æ¨¡å¼ï¼Œä½¿ç”¨æ‘„åƒæœºåŠ¨ç”»åºåˆ—ä¸­åŒ…å«çš„æ‘„åƒæœºåŠ¨ç”»ç”Ÿæˆæ™ƒåŠ¨ã€‚å¦‚æœå¸Œæœ›å®Œå…¨æ§åˆ¶æ‘„åƒæœºæ™ƒåŠ¨çš„æ ·å¼å’Œè¡Œä¸ºï¼Œåºåˆ—å™ªå£°ä¼šéå¸¸å®ç”¨ã€‚
    - Matinee Camera Shake è¿‡åœºæ‘„åƒæœºæ™ƒåŠ¨
    - Composite åˆæˆæ™ƒåŠ¨å¯é€šè¿‡æ·»åŠ å­æ¨¡å¼ï¼Œå°† Perlinã€æ­£ç»Ÿæ³¢å’Œåºåˆ—å¼æ™ƒåŠ¨ç»„åˆåˆ°ä¸€ä¸ªå±‚ç³»ç»Ÿä¸­ï¼Œåˆ›å»ºåŒ…å«æ¥è‡ªæ¯ç§æ™ƒåŠ¨ç±»å‹çš„å…ƒç´ çš„æ›´å¤šå…ƒçš„æ™ƒåŠ¨ã€‚

ç„¶åç»™ `Location`ã€`Rotation`ã€`FOV` çš„å„ä¸ªåˆ†é‡è®¾ç½®æŒ¯å¹…å’Œé¢‘ç‡ï¼Œå¹¶ä¸”å¯ä»¥ç»™å®ƒä»¬è®¾ç½®å€é¢‘å™¨å°†å„ä¸ªåˆ†é‡æ•ˆæœç»Ÿä¸€æ”¾å¤§ã€‚åœ¨ Timing ä¸­è®¾ç½®ä½œç”¨æ—¶é—´ï¼Œ`Duration` è®¾ç½®å°äºæˆ–ç­‰äº 0 è¡¨ç¤ºæ™ƒåŠ¨ä¸€ç›´æœ‰æ•ˆï¼Œæ··åˆè¾“å…¥/è¾“å‡ºæ—¶é—´ æ§åˆ¶æ™ƒåŠ¨å¼€å§‹å’Œç»“æŸæ—¶çš„çº¿æ€§æ··åˆé•¿åº¦ï¼Œ0 å€¼è¡¨ç¤ºä¸ä¼šå‘ç”Ÿæ··åˆã€‚ã€‚ 


åœ¨ Sequencer ä¸­è¿›è¡Œæ“ä½œæ—¶ï¼Œç”¨æˆ·å¯ä¿®æ”¹ Actor çŠ¶æ€ï¼Œå¹¶åœ¨è¿‡åœºåŠ¨ç”»ç»“æŸåå°†çŠ¶æ€ä¿ç•™ã€‚ä¸¾ä¾‹è€Œè¨€ï¼Œåˆ›å»ºä¸€ä¸ªè¿‡åœºåŠ¨ç”»ï¼Œè§’è‰²è§£é”å¹¶æ‰“å¼€ä¸€æ‰‡é—¨ï¼Œä¹‹åè¿™æ‰‡é—¨ä»ç„¶ä¿æŒæ‰“å¼€çŠ¶æ€ã€‚ç„¶è€Œåœ¨å½±ç‰‡åˆ¶ä½œç¯å¢ƒä¸­ï¼Œç”¨æˆ·å¯èƒ½éœ€è¦åœ¨é•œå¤´ä¸­è®¾ç½®åŠ¨ç”»æ•°å€¼ï¼Œä½¿å…¶åŠæ—¶è¿”å›è®¾ç½®åŠ¨ç”»ä¹‹å‰çš„çŠ¶æ€ï¼Œé¿å…æ¸—å…¥åˆ°ä¸‹ä¸ªé•œå¤´ä¸­ã€‚ç”¨æˆ·å¯é€šè¿‡ `When Finished` å±æ€§ä»¥æ¯ä¸ªè½¨é“ä¸ºåŸºç¡€æ¥ç¡®å®šè½¨é“åº”è¿”å›è®¾ç½®åŠ¨ç”»ä¹‹å‰çš„çŠ¶æ€ï¼Œæˆ–åœ¨åºåˆ—æ’­æ”¾å®Œæˆåä¿ç•™ä¿®æ”¹ã€‚åºåˆ—ä¸­è®¾ç½® `Keep State` æ˜¯æœ¬åœ°æ•ˆæœï¼ŒLevel Sequence è¿˜æœ‰ä¸€ä¸ªå…¨å±€é€‰é¡¹åœ¨ Details é¢æ¿ä¸­ï¼Œ`Restore State` é€‰é¡¹å°†åœ¨å…³å¡åºåˆ—åœæ­¢æ’­æ”¾æ—¶ä¿å­˜æ‰€æœ‰çŠ¶æ€ã€‚å¦‚è¦åœ¨åºåˆ—å®Œå…¨ç»“æŸåä¿æŒè½¨é“çš„çŠ¶æ€ï¼Œåˆ™éœ€è¦å°†åŠ¨ç”»åºåˆ—è®¾ä¸º Keep Stateï¼Œä¸” Level Sequence æ²¡æœ‰å‹¾é€‰ Restore Stateï¼Œå¦åˆ™å…¨å±€å€¼å°†è¦†ç›–æœ¬åœ°è®¾ç½®ã€‚


Matinee åŠ¨ç”»å·¥å…·å¯å¯¹ Actor å±æ€§è®¾ç½®éšæ—¶é—´å˜åŒ–åŠ¨ç”»ï¼Œä»¥åˆ›å»ºåŠ¨æ€æ¸¸æˆè¿›ç¨‹æˆ–æ¸¸æˆä¸­è¿‡åœºåŠ¨ç”»åºåˆ—ã€‚è¯¥ç³»ç»ŸåŸºäºå¯¹ä¸“ç”¨åŠ¨ç”»è½¨è¿¹çš„ä½¿ç”¨ï¼Œå¯åœ¨è¯¥è½¨è¿¹ä¸Šæ”¾ç½®å…³é”®å¸§æ¥è®¾ç½®å…³å¡ä¸­ Actor çš„éƒ¨åˆ†å±æ€§å€¼ã€‚Matinee ç¼–è¾‘å™¨ä¸ç”¨äºè§†é¢‘ç¼–è¾‘çš„éçº¿æ€§ç¼–è¾‘å™¨ç±»ä¼¼ï¼Œä½¿å…¶ä¸ºä¸“ä¸šè§†é¢‘åˆ¶ä½œè€…æ‰€ç†ŸçŸ¥ã€‚

è™šå¹»å¼•æ“ 4.24 æ— æ³•å†é€šè¿‡è¿‡åœºåŠ¨ç”»ï¼ˆCinematicsï¼‰èœå•å’Œç»†èŠ‚é¢æ¿è®¿é—® Matinee ç¼–è¾‘å™¨ï¼Œåç»­ç‰ˆæœ¬å°†ä¼šç§»é™¤è¿™ä¸€åŠŸèƒ½ã€‚

åœ¨åˆ›å»ºå¥½è¿‡åœºåŠ¨ç”»ä¹‹åï¼Œç”šæˆ–åœ¨åˆ¶ä½œè¿‡ç¨‹ä¸­ä½œä¸ºæ—¥å¸¸å®¡æ ¸å·¥ä½œçš„ä¸€éƒ¨åˆ†ï¼Œä½ å¯èƒ½æƒ³è¦å°†å…¶æ¸²æŸ“æˆå¯ä¸å…¶ä»–äººå…±äº«çš„ç”µå½±æ–‡ä»¶ã€‚é€šè¿‡ Sequencer ä¸­çš„å·¥å…·æ ï¼Œæ¸²æŸ“å½±ç‰‡ï¼ˆ`Render Movie`ï¼‰é€‰é¡¹ä½¿ä½ èƒ½å¤Ÿé€šè¿‡å¯ç”¨å¤§éƒ¨åˆ†åª’ä½“æ’­æ”¾å™¨æ’­æ”¾çš„ AVI æ–‡ä»¶ä¸å…¶ä»–äººå…±äº«ç”µå½±ã€‚

åœ¨æ¸²æŸ“ç”µå½±è®¾ç½®çª—å£ï¼Œå¯ä»¥è®¾ç½®è¾“å‡ºå›¾ç‰‡æˆ– AVI è§†é¢‘æ ¼å¼ï¼Œå•å‡» Capture Movie æŒ‰é’®ä»¥å¼€å§‹è®°å½•åœºæ™¯çš„é‡‡é›†è¿‡ç¨‹ã€‚æ³¨æ„é€‰æ‹©è¾“å‡ºç›®å½•ï¼Œå¦‚æœæ²¡æœ‰å†™å…¥æƒé™ä¼šæç¤º Read Only Output Directoryã€‚è¾“å‡º AVI ä¼šå’ŒéŸ³é¢‘åˆ†ç¦»ï¼Œå¯ä»¥ä½¿ç”¨ FFMPEG å·¥å…·è¿›è¡Œåˆå¹¶ï¼Œä½†æ˜¯å¤„ç† AVI ç¼–ç å¥½åƒæœ‰é—®é¢˜ï¼Œä¸èƒ½å¾—åˆ°æ­£ç¡®è¾“å‡ºã€‚å¯ä»¥ä½¿ç”¨ Blender æä¾›çš„ Video Sequencer è¿›è¡ŒåæœŸå¤„ç†åˆæˆã€‚

æ¸²æŸ“è¿‡åœºåŠ¨ç”»æ—¶ï¼Œåœ¨ Burn In Options è®¾ç½®å¤–å¯èƒ½è¿˜éœ€è¦æä¾›é¢å¤–ä¿¡æ¯æˆ–åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ—¶é—´ã€é•œå¤´å’Œå¸§ä¿¡æ¯ã€‚é€šè¿‡ è™šå¹»åŠ¨æ€å›¾å½¢å’Œè“å›¾å¯è§†åŒ–è„šæœ¬ å³å¯åˆ›å»ºè‡ªå®šä¹‰çƒ§å…¥å’Œè¦†å±‚åŠŸèƒ½ã€‚

è¿˜å¯ä»¥ä½¿ç”¨ Movie Render Queue æ’ä»¶ã€‚

åœ¨ Content Browser ä¸Šå•å‡»å³é”®åˆ›å»ºä¸€ä¸ª *LevelSequenceBurnInInitSettings* ç±»å‹çš„è“å›¾ç±»ï¼Œé€šè¿‡å®ƒå¯ä»¥åˆ¶å®šæ¸²æŸ“ç”µå½±æ—¶çš„çƒ§å…¥å†…å®¹ï¼Œä¾‹å¦‚æ–‡å­—ã€‚åœ¨ Content Browser ä¸­ç‚¹å‡» View Options -> Show Engine Contentã€‚è¿›è¡Œæ­¤æ“ä½œåå³å¯æŸ¥çœ‹å’Œä½¿ç”¨éšå¼•æ“å†…å®¹æä¾›çš„å­—ä½“é€‰é¡¹ã€‚

*Level Sequence* æ˜¯è¿‡åœºåŠ¨ç”»åœºæ™¯çš„å®¹å™¨ï¼Œå¿…é¡»åˆ›å»ºå®ƒæ‰èƒ½ä½¿ç”¨åºåˆ—ç¼–è¾‘å™¨ï¼ˆ*Sequencer Editor*ï¼‰ï¼Œè¿™ä¸¤ä¸ªæ¦‚å¿µè¦åŒºåˆ«ï¼Œå¦åˆ™æ‰“å¼€åºåˆ—ç¼–è¾‘å™¨æ—¶çœ‹ä¸åˆ°æœ‰ç”¨çš„å†…å®¹ã€‚Master Sequence ä¹Ÿå°±æ˜¯åŒ…å«å…¶å®ƒåºåˆ—ï¼Œä½œä¸ºä¸€ä¸ªä¸»è¦åºåˆ—æ¥ä½¿ç”¨è€Œå·²ã€‚

åœ¨ä½¿ç”¨åºåˆ—ç¼–è¾‘å™¨å‰ï¼Œå…ˆè®¾ç½®åˆé€‚çš„è§†å£å¸ƒå±€ï¼ŒViewport 
å¯¹äºåˆ›å»ºå¥½è¿‡åœºåŠ¨ç”»åºåˆ—ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ Instance Data å¯¹åœºæ™¯ä¸­çš„ Actor åº”ç”¨åŠ¨æ€å˜å½¢æ•°æ®ï¼ˆDynamic Transformsï¼‰ï¼Œä½†éœ€è¦å°†æ•´ä¸ªåœºæ™¯ç§»åˆ°å…³å¡ä¸­çš„æ–°ä½ç½®ã€‚

ä¾‹å¦‚ï¼Œè§’è‰²çš„è¡Œèµ°åºåˆ—åŠ¨ç”»å·²ç»åˆ¶ä½œå¥½ï¼Œä½†æ˜¯æ–°çš„è¿åŠ¨èµ·ç‚¹åŠè·¯çº¿éœ€è¦åç§»ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨å®ä¾‹æ•°æ®æ¥åº”ç”¨å˜å½¢ï¼š

- å…³å¡ä¸­ä»»æ„æ”¾ç½®ä¸€ä¸ª Empty Actorï¼Œå®ƒåªç”¨æ¥æä¾›ä½ç½®ã€æ—‹è½¬ç­‰ä¿¡æ¯ã€‚ 
- å°†åºåˆ—æ”¾ç½®åˆ°å…³å¡ä¸­ï¼Œè®¾ç½® Details -> Playbackï¼Œå¯ç”¨è‡ªåŠ¨æ’­æ”¾ï¼ˆAuto Playï¼‰ã€æ— é™å¾ªç¯ï¼ˆLoop Indefinitelyï¼‰ã€‚
- è®¾ç½® Details -> Instance Dataï¼Œå‹¾é€‰è¦†ç›–å®ä¾‹æ•°æ®ï¼ˆOverride Instance Dataï¼‰ï¼Œå¹¶é€‰æ‹©å‰é¢æ”¾ç½®çš„ Empty Actor ä½œä¸º Transform Origin Actorã€‚
- å˜å½¢åŸç‚¹å¯¹è±¡ï¼ˆTransform Origin Actorï¼‰è¢«åºåˆ—ç”¨ä½œæ–°åŸç‚¹å‚è€ƒï¼Œè®©åºåˆ—çš„è¿åŠ¨å˜å½¢ç›¸å¯¹äºæŒ‡å®šçš„åŸç‚¹å‚è€ƒè¿›è¡Œã€‚ 

ä¸ºäº†è·å¾—æœ€ä½³ç»“æœï¼Œéœ€è¦è®© Empty Actor çš„å˜å½¢å…ˆå½’é›¶ï¼Œç„¶åå†åœ¨ Sequencer ä¸­ä¸ºå…¶æ·»åŠ å…³é”®å¸§ã€‚å¦‚æœä¸ºå˜å½¢æ•°æ®æ·»åŠ å…³é”®å¸§ï¼Œè€Œå®ƒå¹¶ä¸æ˜¯é›¶ï¼Œåˆ™åœ¨å…³å¡ä¸­ç§»åŠ¨ Transform Origin Actor æ—¶ä¼šåº”ç”¨åç§»å€¼ã€‚ 
-> Viewport Options -> Layout ä¸‹é€‰æ‹©è§†å£å¸ƒå±€ï¼Œæ¯”å¦‚å‚ç›´çš„ä¸¤ä¸ªçª—æ ¼ï¼ˆVertical Two Panesï¼‰ã€‚

å¦å¤–ï¼Œæ¯ä¸ªåºåˆ—é€šå¸¸åªè®¾ç½®ä¸€ä¸ªé•œå¤´ï¼Œè¿™æ ·å¯ä»¥ä¿æŒåºåˆ—çš„ç®€æ´æ€§ï¼Œå½“ç„¶ï¼Œåœ¨åŒä¸€ä¸ªåºåˆ—å¯ä»¥ä¹Ÿå¯ä»¥åˆ©ç”¨ `Shots Track` æˆ–è€… `Camera Cuts` æ¥ç»„ç»‡å¤šä¸ªé•œå¤´ã€‚å¤šé•œå¤´è¿‡åœºåŠ¨ç”»ï¼Œå¯ä»¥ä»å–æ™¯èœå•ï¼ˆTake Menuï¼‰ä¸­ä½¿ç”¨ä¸åŒçš„å–æ™¯ï¼ˆTakesï¼‰ã€‚é•œå¤´çš„ç»„ç»‡ï¼Œåªæ˜¯ Sequencer åŠŸèƒ½çš„ä¸€å°éƒ¨åˆ†ï¼Œä½†å®ƒå½°æ˜¾äº†è¯¥å·¥å…·çš„ä¸€äº›æ ¸å¿ƒæ–¹é¢ï¼Œä½ å¯ä»¥ä½¿ç”¨å®ƒä»¬æ¥åˆ›å»ºåœºæ™¯ã€‚


### âœ’ Sequence æ··åˆåŠ¨ç”»è“å›¾
- https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/Sequencer/HowTo/GameplayAnimBlending/
- https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/Sequencer/HowTo/BlendingAnimBPs/

è¦å°† Sequencer ä¸­æŒ‡å®šçš„åŠ¨ç”»ä¸è§’è‰²åŠ¨ç”»è“å›¾ä¸­å®šä¹‰çš„åŠ¨ç”»ç›¸æ··åˆï¼Œå¯ä»¥ä½¿ç”¨ Sequencer ä¸­çš„åŠ¨ç”»è½¨é“çš„æ’æ§½ï¼ˆSlotï¼‰èŠ‚ç‚¹å’Œæƒé‡ï¼ˆWeightï¼‰å±æ€§æ¥å®Œæˆã€‚ 

åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä»åŠ¨ç”»è“å›¾è·å–é—²æ•£å§¿åŠ¿ï¼Œå¹¶å°†å®ƒæ··åˆåˆ° Sequencer ä¸­å®šä¹‰çš„å¥”è·‘åŠ¨ç”»ä¸­ã€‚ 

è§’è‰²é¦–å…ˆä¸ºé—²æ•£å§¿æ€ï¼ˆè¿™æ˜¯åŠ¨ç”»è“å›¾ä¸­çš„çŠ¶æ€ï¼‰ï¼Œç„¶åå°†æ··åˆåˆ°æˆ‘ä»¬åœ¨å…³å¡åºåˆ—ä¸­æŒ‡å®šçš„åŠ¨ç”»ï¼ˆå¥”è·‘ï¼‰ï¼Œæœ€åæ¢å¤ä¸ºé—²æ•£å§¿æ€ã€‚ 

åœ¨æœ¬æ“ä½œæŒ‡å—ä¸­ï¼Œæˆ‘ä»¬ç°åœ¨ä½¿ç”¨ è“å›¾ç¬¬ä¸‰äººç§°æ¨¡æ¿ é¡¹ç›®ã€‚

æ“ä½œæ­¥éª¤ï¼š

- åœ¨ Content/Mannequin/Character/Mesh æ–‡ä»¶å¤¹ä¸­ï¼Œå³é”®å•å‡» *SK_Mannequin* å¹¶åˆ›å»ºåŠ¨ç”»è“å›¾ï¼ˆAnim Blueprintï¼‰ã€‚
- åŒå‡»æ‰“å¼€åŠ¨ç”»è“å›¾ï¼Œå¹¶æ‹–å…¥ *ThirdPersonIdle* åŠ¨ç”»åºåˆ—ï¼Œè¿æ¥åˆ°æ’æ§½ï¼ˆSlotï¼‰èŠ‚ç‚¹ï¼Œå†è¿æ¥åˆ°ï¼ˆFinal Animation Poseï¼‰ èŠ‚ç‚¹ã€‚ 
- è¯·æ³¨æ„ï¼Œæ’æ§½ï¼ˆSlotï¼‰çš„é»˜è®¤åç§°æ˜¯ *DefaultSlot*ï¼Œè¿™æ˜¯åœ¨å…³å¡åºåˆ—ä¸­å¼•ç”¨çš„åç§°ã€‚ 
- å°†ï¼ˆAnim Blueprintï¼‰æ‹–åˆ°å…³å¡ï¼Œç„¶åä»ä¸»å·¥å…·æ ä¸­ï¼Œé€šè¿‡èœå•æ·»åŠ å…³å¡åºåˆ— Cinematics -> Add Level Sequenceã€‚
- å‘åºåˆ—æ·»åŠ åŠ¨ç”»è“å›¾ï¼Œç„¶åæ·»åŠ /å¾ªç¯ *ThirdPersonRun* åŠ¨ç”»æ¥å¡«å……åºåˆ—ã€‚
- å±•å¼€åŠ¨ç”»è½¨é“ï¼Œç„¶åè®¾ç½®æƒé‡å€¼ä¸º 0.0 å¹¶å‘åºåˆ—æ·»åŠ ä¸€ä¸ªé”®ï¼ŒAnimation -> Weightã€‚ 
- é€šè¿‡å°†æƒé‡è®¾ç½®ä¸º 0.0ï¼Œè¡¨ç¤ºåœ¨å¢å¤§æƒé‡å€¼ä¹‹å‰ä¸ä½¿ç”¨è¯¥åŠ¨ç”»çš„ä»»ä½•éƒ¨åˆ†ã€‚ 
- ä¸ºæƒé‡å±æ€§æ·»åŠ ä¸€ä¸ªé”®ï¼Œå€¼ä¸º 1.0ï¼Œä½äºå¸§ 75 å¤„ï¼Œå†æ·»åŠ å¦ä¸€ä¸ªé”®ï¼Œå€¼ä¸º 0.0ï¼Œä½äºå¸§ 150 å¤„ã€‚
- è¿™å°†ä» 0.0 æ··åˆåˆ° 1.0ï¼ˆåŠ¨ç”»çš„å®Œæ•´æ•ˆæœï¼‰ï¼Œç„¶åå†å›åˆ° 0.0ã€‚ 
- é€šè¿‡å³é”®æ·»åŠ çš„ä¸‰ä¸ªé”®ï¼ŒThirdPersonRun Track -> Properties ä¸‹é¢ï¼Œæ³¨æ„ æ’æ§½åç§°ï¼ˆSlot Nameï¼‰ å’Œæˆ‘ä»¬ é”®ï¼ˆKeysï¼‰ã€‚
- æ’æ§½åç§°å¿…é¡»äº’ç›¸åŒ¹é…ï¼Œè¿™æ · Sequencer æ‰èƒ½çŸ¥é“ä½ æ‰€æŒ‡ä»£çš„æ˜¯å“ªä¸ªæ’æ§½ï¼Œå¹¶ä¼ é€’æƒé‡å€¼ã€‚ 
- è®¾ç½®å…³å¡åºåˆ—ä¸ºæ— é™å¾ªç¯æ’­æ”¾ï¼ŒDetails -> Auto Play -> Loop -> Loop Indefinitelyã€‚
- åœ¨ç¼–è¾‘å™¨ä¸­è¿è¡Œæµ‹è¯•ï¼Œä»ä¸»å·¥å…·æ ç‚¹å‡»ï¼ˆPlay in the Editorï¼‰ã€‚


åœ¨åˆ›å»ºè¿‡åœºåŠ¨ç”»åºåˆ—æ—¶ï¼Œä½ å¯èƒ½å¸Œæœ›å°†ç°æœ‰çš„æ¸¸æˆè¿›ç¨‹åŠ¨ç”»ä¸åŒ…å«åœ¨å…³å¡åºåˆ—ä¸­çš„åŠ¨ç”»æ··åˆåœ¨ä¸€èµ·ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå¯æ“ä½œçš„è§’è‰²åœ¨æ¸¸æˆè¿‡ç¨‹ä¸­èµ°åˆ°ä¸€æ‰‡é—¨å‰ï¼Œä½ æƒ³è¦ Sequencer æ˜¾ç¤ºè¯¥è§’è‰²çš„åŠ¨ç”»å¹¶æ‰“å¼€è¿™æ‰‡é—¨ã€‚æˆ–è€…ç©å®¶åœ¨ç¬¬ä¸‰äººç§°å°„å‡»æ¸¸æˆä¸­æ§åˆ¶ä»–ä»¬çš„è§’è‰²ç»•è¿‡ä¸€ä¸ªæ­»è§’ï¼Œè€Œä½ æƒ³è¦æ··å…¥ä¸€ä¸ªæ­»äº¡çš„è¿‡åœºåŠ¨ç”»åºåˆ—ã€‚é€šè¿‡ä½¿ç”¨ Sequencerã€è“å›¾å’ŒåŠ¨ç”»è“å›¾çš„ç»„åˆï¼Œä½ å¯ä»¥å°†ä½ çš„è§’è‰²æ‰€å¤„çš„ä»»ä½•æ¸¸æˆå§¿åŠ¿ä¸ Sequencer å®šä¹‰çš„ æ’æ§½ï¼ˆSlotï¼‰åŠ¨ç”»æ··åˆåœ¨ä¸€èµ·ã€‚

é¦–å…ˆï¼Œéœ€è¦åœ¨å…³å¡åºåˆ—çš„åŠ¨ç”»è½¨è¿¹ï¼ˆAnimation Trackï¼‰ï¼Œé€šè¿‡å…³é”®å¸§å³é”®èœå•å°†å®Œæˆæ—¶ï¼ˆWhen Finishedï¼‰å±æ€§æ›´æ”¹ä¸ºä¿æŒçŠ¶æ€ï¼ˆKeep Stateï¼‰ã€‚è¿™å°†ä½¿æˆ‘ä»¬èƒ½å¤Ÿåœ¨å…³å¡åºåˆ—ç»“æŸæ—¶ä¿å­˜åŠ¨ç”»çŠ¶æ€ã€‚

å¦å¤–ï¼Œè¯·æ³¨æ„ä¸‹é¢çªå‡ºæ˜¾ç¤ºçš„ æ’æ§½åç§°ï¼ˆSlot Nameï¼‰å±æ€§ã€‚

å½“åŠ¨ç”»è“å›¾æ§åˆ¶ä¸€ä¸ªéª¨æ¶ç½‘æ ¼ä½“æ—¶ï¼ŒSequencer åœ¨è¯¥è“å›¾ä¸­çš„æ’æ§½ä¸Šæ’­æ”¾åŠ¨ç”»ï¼Œå¹¶å¯é€šè¿‡æ’æ§½åç§°ï¼ˆSlot Nameï¼‰å±æ€§è¿›è¡Œæ§åˆ¶ã€‚ç„¶ååŠ¨ç”»è“å›¾å¯ä»¥æ··åˆæ’æ§½åŠ¨ç”»å’Œä»»ä½•æ¸¸æˆé€»è¾‘é©±åŠ¨çš„åŠ¨ç”»ï¼ˆä½ çš„è§’è‰²æ°å¥½åœ¨è¯¥åŠ¨ç”»ä¸­ï¼‰ã€‚

åç»­è®¾ç½®åŠ¨ç”»è“å›¾å’Œè§’è‰²è“å›¾ï¼Œä»¥æ··åˆå„ä¸ªæ¸¸æˆåŠ¨ç”»ã€‚

åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å°†è®¾ç½®åŠ¨ç”»è“å›¾ï¼Œä»¥ä¾¿èƒ½å¤Ÿè·å–æˆ‘ä»¬çš„æ¸¸æˆè¿›ç¨‹å§¿åŠ¿ï¼Œå¹¶æ··åˆåˆ°æˆ‘ä»¬çš„å…³å¡åºåˆ—æ‰€å®šä¹‰çš„æŸä¸ªæ’æ§½åŠ¨ç”»ä¸­ã€‚

- åœ¨å†…å®¹æµè§ˆå™¨ï¼ˆContent Browserï¼‰æ‰¾åˆ°å¹¶æ‰“å¼€åŠ¨ç”»è“å›¾ï¼Œæ‰“å¼€ï¼ˆMy Blueprintï¼‰çª—å£ä¸­çš„åŠ¨ç”»å›¾è¡¨ï¼ˆAnimGraphï¼‰ã€‚
- åœ¨ç°æœ‰ Locomotion çŠ¶æ€æœºçš„åŠ¨ç”»å›¾è¡¨ï¼ˆAnimGraphï¼‰ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªï¼ˆNew Save cached poseï¼‰å¹¶ç§°å…¶ä¸º *lococache*ã€‚
- ä½¿ç”¨ *lococache* ä¸¤æ¬¡ï¼Œå¹¶å°†å…¶ä¸­ä¸€ä¸ªè¿æ¥åˆ°æä¾›ï¼ˆFinal Animation Poseï¼‰ çš„ Blend èŠ‚ç‚¹çš„ A å¼•è„šã€‚
- å¦ä¸€ä¸ª *lococache*ï¼Œä½¿ç”¨ä¸€ä¸ª Slot èŠ‚ç‚¹å¹¶å°†å…¶è¿æ¥åˆ°è¯¥ Blend èŠ‚ç‚¹çš„ B å¼•è„šï¼Œç„¶åå³é”®å•å‡» Alpha å’Œ æå‡åˆ°å˜é‡ï¼ˆPromote to Variableï¼‰ï¼Œå¹¶ç§°å…¶ä¸º Blend Interpã€‚
- åœ¨å†…å®¹æµè§ˆå™¨ä¸­ï¼Œæ‰“å¼€ Ue4ASP_Character è“å›¾å¹¶å°† è¹²ä¼ï¼ˆCrouchingï¼‰ éƒ¨åˆ†æ›¿æ¢ä¸ºä»¥ä¸‹å›¾è¡¨ã€‚

ä¸Šæ–‡ä¸­ï¼Œæˆ‘ä»¬å°† InputAction Crouch èŠ‚ç‚¹æ›¿æ¢ä¸º C é”®ç›˜äº‹ä»¶å’Œä¸€ä¸ª Flip Flop èŠ‚ç‚¹ï¼Œä»¥åˆ‡æ¢è¹²ä¼çŠ¶æ€ã€‚

è¯¥è“å›¾æœ€åˆæ˜¯ä¸ºå¦ä¸€ä¸ªé¡¹ç›®åˆ›å»ºçš„ï¼Œå…¶ä¸­åŒ…å«è¹²ä¼çš„è¾“å…¥ç»‘å®šï¼Œè€Œæˆ‘ä»¬çš„æ¨¡æ¿é¡¹ç›®ä¸åŒ…å«è¯¥è¾“å…¥ç»‘å®šã€‚é€šè¿‡å°†InputAction Crouchæ›¿æ¢ä¸ºæ ‡å‡†çš„Cé”®ç›˜äº‹ä»¶ï¼Œæˆ‘ä»¬å°†æ¶ˆé™¤è“å›¾è­¦å‘Šæ¶ˆæ¯ï¼Œå¹¶ä½¿æˆ‘ä»¬èƒ½å¤ŸæŒ‰ä¸‹Cé”®ä»¥åœ¨è¹²ä¼å’Œéè¹²ä¼çŠ¶æ€ä¹‹é—´åˆ‡æ¢ã€‚

åˆ›å»ºä¸€ä¸ªåä¸º DefaultSlotInterp çš„æ–° Float å˜é‡ï¼Œå¹¶å°† å¯ç¼–è¾‘å®ä¾‹ï¼ˆInstance Editableï¼‰ å’Œ å‘è¿‡åœºåŠ¨ç”»å…¬å¼€ï¼ˆExpose to Cinematicsï¼‰ è®¾ç½®ä¸º Trueã€‚

æˆ‘ä»¬å°†åœ¨Sequencerä¸­ä½¿ç”¨è¯¥å˜é‡è¿›è¡Œæ··åˆï¼Œå¹¶å°†å€¼ä¼ é€’ç»™ç”¨äºå¤„ç†å®é™…æ··åˆçš„åŠ¨ç”»è“å›¾å˜é‡ Blend Interpã€‚

åœ¨ ç»†èŠ‚ï¼ˆDetailsï¼‰ é¢æ¿ä¸­åˆ›å»ºä¸€ä¸ªåä¸º SetDefaultSlotInterp çš„æ–°å‡½æ•°ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªåä¸º Interpï¼Œç±»å‹ä¸º æµ®ç‚¹ï¼ˆFloatï¼‰ çš„ è¾“å…¥ï¼ˆInputï¼‰ã€‚

é€šè¿‡åˆ›å»ºä¸€ä¸ªåä¸º Set (Property Value Name) çš„å‡½æ•°ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª Proxy å‡½æ•°ï¼Œå½“ç›¸å…³å±æ€§å€¼å‘ç”Ÿæ›´æ”¹æ—¶ï¼ŒSequencerå°†è°ƒç”¨è¯¥å‡½æ•°ã€‚è¯¥å‡½æ•°ä»…åœ¨å±æ€§å€¼å‘ç”Ÿæ›´æ”¹æ—¶æ‰è°ƒç”¨ï¼Œå¹¶ä¸”æ¯”ä½¿ç”¨ æ—¶é’Ÿäº‹ä»¶ï¼ˆEven Tickï¼‰ æˆ–æŸä¸ª è‡ªå®šä¹‰äº‹ä»¶ï¼ˆCustom Eventï¼‰ å’Œ æ—¶é—´è½´ï¼ˆTimelineï¼‰ æ›´èƒ½æœ‰æ•ˆåœ°åæ˜  DefaultSlotInterp å±æ€§å€¼ä¸­çš„å˜åŒ–ã€‚

ä» ç»„ä»¶ï¼ˆComponentsï¼‰ çª—å£ä¸­ï¼Œæ‹–å…¥ ç½‘æ ¼ä½“ï¼ˆMeshï¼‰ å¹¶ä½¿ç”¨ è·å–åŠ¨ç”»å®ä¾‹ï¼ˆGet Anim Instanceï¼‰ å’Œ è½¬æ¢ä¸ºUE4ASP_HeroTPP_AnimBlueprintï¼ˆCast to UE4ASP_HeroTPP_AnimBlueprintï¼‰ã€‚

ç¦»å¼€ As UE4ASP Hero TPP Anim Blueprint èŠ‚ç‚¹ï¼Œä½¿ç”¨ Set Blend Interp èŠ‚ç‚¹å¹¶å°† Interp å€¼ä¼ é€’åˆ° Blend Interp è¾“å…¥ã€‚

å½“æˆ‘ä»¬çš„ DefaultSlotInterp å€¼é€šè¿‡Sequencerè¿›è¡Œæ›´æ”¹æ—¶ï¼Œå°†è°ƒç”¨ SetDefaultSlotInterp ä»£ç†å‡½æ•°ï¼Œå¹¶å°†æµ®ç‚¹å€¼ä¼ é€’ç»™åŠ¨ç”»è“å›¾çš„ Blend Interp å€¼ï¼Œè¯¥å€¼å°†å½±å“å§¿åŠ¿çš„æ··åˆã€‚

åœ¨ä¸‹ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å°†æ·»åŠ  é»˜è®¤æ’æ§½æ’å€¼ï¼ˆDefault Slot Interpï¼‰ å±æ€§åˆ°æˆ‘ä»¬çš„å…³å¡åºåˆ—ä¸­ï¼Œä»¥ä¾¿æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶åŠ¨ç”»è“å›¾ä¸­çš„ æ··åˆæ’å€¼ï¼ˆBlend Interpï¼‰ã€‚æˆ‘ä»¬è¿˜å°†åœ¨å…³å¡ä¸­æ·»åŠ ä¸€ä¸ªè§¦å‘æ¡†ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ¿€æ´»å…³å¡åºåˆ—å¹¶åœ¨ç©å®¶è¿›å…¥è§¦å‘æ¡†ä½“ç§¯æ—¶æ’­æ”¾å®ƒã€‚




### âœ’ Sequence ç›¸å…³å†…å®¹
- æ¨¡æ¿åºåˆ— https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/Sequencer/Overview/TemplateSequences/
- æ··åˆGameplayå’ŒSequenceråŠ¨ç”» https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/Sequencer/HowTo/GameplayAnimBlending/
- Sequencer æ··åˆåŠ¨ç”»è“å›¾ https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/Sequencer/HowTo/BlendingAnimBPs/

åœ¨è“å›¾ä¸­ä½¿ç”¨ Sequenceï¼Œå¯ä»¥åœ¨é€‰ä¸­çŠ¶æ€ä¸‹ï¼Œé€šè¿‡è“å›¾å›¾è¡¨çš„å³é”®èœå•åˆ›å»ºå®ä¾‹ Create Reference to SquenceXXXã€‚

ç„¶åï¼Œä»åºåˆ—å®ä¾‹å¯ä»¥å¼•å‡º Sequence Player å±æ€§ï¼Œé€šè¿‡å®ƒå¯ä»¥æ‰§è¡Œ `Play`ã€`PlayReverse`ã€`Stop` ç­‰ç­‰åŠ¨ç”»æ’­æ”¾ç›¸å…³åŠ¨ä½œï¼Œ`StopAtCurrentTime` ä¼šåœ¨æœ¬è½®æ’­æ”¾ç»“å°¾æ—¶åœæ­¢ï¼Œå¦å¤–ï¼Œ`PlayLooping` å¯ä»¥è®¾ç½®å¾ªç¯æ’­æ”¾ï¼Œæ— é™å¾ªç¯æŒ‡å®šæ¬¡æ•°ä¸º -1ã€‚å¦‚æœå¸Œæœ›æŒ‡å®šåºåˆ—ä½ç½®è¿›è¡Œæ’­æ”¾ï¼Œä½¿ç”¨ Set Playback Position èŠ‚ç‚¹ï¼Œè®©åºåˆ—ä»å¤´å¼€å§‹æ’­æ”¾ï¼Œæ’­æ”¾ä½ç½®è®¾ä¸º 0 æˆ–åºåˆ—çš„å¼€å¤´ã€‚

åˆ›å»ºæ¸¸æˆè¿›ç¨‹è¿‡åœºåŠ¨ç”»æ—¶ï¼Œæœ‰æ—¶éœ€è¦åœ¨ Sequencer ä¸­å¯¹è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆçš„å¯¹è±¡è®¾ç½®åŠ¨ç”»ã€‚ ä¸¾ä¾‹è€Œè¨€ï¼Œç”¨æˆ·å¯åˆ›å»ºä¸€ä¸ªå¸¦åŠ¨ç”»çš„å¯¹è±¡ï¼Œä½¿å…¶åœ¨ Sequencer ä¸­æ²¿è·¯å¾„ç§»åŠ¨ï¼Œè€Œè¯¥å¯¹è±¡å¯ç”±ç©å®¶ï¼ˆç©å®¶åœ¨æ¸¸æˆè¿›ç¨‹ä¸­ç”Ÿæˆï¼‰è¿›è¡Œå®šä¹‰ã€‚ åœ¨è“å›¾å¯è§†åŒ–è„šæœ¬çš„ååŠ©ä¸‹ï¼Œç”¨æˆ·å¯ä½¿ç”¨ *Get Sequence Bindings* èŠ‚ç‚¹ä»å…³å¡åºåˆ—å…¬å¼€ç»‘å®šè¾¨è¯†ç¬¦ï¼Œå¹¶ä½¿ç”¨è‡ªæœ‰è®¾ç½®è¦†ç›–è¿™äº›ç»‘å®šã€‚

åºåˆ—ç»‘å®šç›¸å…³æ“ä½œï¼š

- *Add Binding* æ·»åŠ ç»‘å®šã€‚
- *Remove Binding* ç§»é™¤ç»‘å®šï¼Œä»æŒ‡å®šçš„ç»‘å®šç§»é™¤æŒ‡å®šçš„actorã€‚
- *Reset Binding* é‡è®¾ç»‘å®šï¼Œå°†æŒ‡å®šçš„ç»‘å®šé‡è®¾å›é»˜è®¤è®¾ç½®ã€‚
- *Reset Bindings* é‡è®¾å¤šé¡¹ç»‘å®šï¼Œå°†æ‰€æœ‰è¦†ç›–çš„ç»‘å®šé‡è®¾å›é»˜è®¤è®¾ç½®ã€‚
- *Set Binding* è®¾ç½®ç»‘å®šï¼Œç”¨æŒ‡å®šçš„actorè¦†ç›–æŒ‡å®šçš„ç»‘å®šã€‚

`Templates Sequence`æ¨¡æ¿åºåˆ—å¯ä»¥å°† Sequencer ä¸­åˆ›å»ºçš„åŠ¨ç”»æ•°æ®å¤ç”¨äºï¼ˆç›¸åŒæˆ–ç»§æ‰¿çš„ï¼‰å…¼å®¹ç±»çš„ Actorã€‚å°±åƒ Animation Sequence åŠ¨ç”»åºåˆ—å¯ä»¥åœ¨å…¼å®¹éª¨éª¼ç½‘æ ¼ä½“ä¸Šæ’­æ”¾é‚£æ ·ï¼Œæ¨¡æ¿åºåˆ—åŠ¨ç”»ä¹Ÿå¯ä»¥åœ¨å…¼å®¹ Actor ä¸Šæ’­æ”¾ã€‚

ä½ å¯ä»¥åˆ›å»ºè¦é‡å¤ä½¿ç”¨çš„ç‰¹å®šè½¨é“æˆ–æ•´ä¸ªåºåˆ—ï¼Œå¹¶å°†å…¶å…³è”è‡³ç‰¹å®šå¯¹è±¡ç»‘å®šï¼Œç±»ä¼¼äºå¦‚ä½•åœ¨ä»»ä½•å…¼å®¹çš„éª¨æ¶ç½‘æ ¼ä½“ä¸Šæ’­æ”¾éª¨éª¼åŠ¨ç”»ã€‚æ­¤å¤–ï¼Œå¯ä»¥åƒä»»ä½•å…¶ä»–åºåˆ—ä¸€æ ·æ§åˆ¶å’Œç¼–è¾‘æ¨¡æ¿åºåˆ—ã€‚

åœ¨ UE4 ç‰ˆæœ¬ä¸Šï¼Œåˆ›å»ºæ¨¡æ¿åºåˆ—æ—¶ä¼šå…ˆè¿›è¡Œ Pick Root Object Binding Classï¼Œè€Œåœ¨ UE5 ç‰ˆæœ¬ä¸Šï¼Œåœ¨åˆ›å»ºåå†æ‰“å¼€æ¨¡æ¿åºåˆ—ç¼–è¾‘ç•Œé¢ï¼Œç‚¹å‡»å·¥å…·æ çš„é”é“¾å›¾æ ‡è¿›è¡Œç»‘å®šè®¾ç½®ã€‚

æ¨¡æ¿åºåˆ—å¸¸ç”¨äºåˆ›å»ºæ¨¡æ¿æ‘„åƒæœºåŠ¨ç”»ï¼ŒCamera Animation Sequence é€šå¸¸å’Œ Templates Sequence é…åˆä½¿ç”¨ã€‚


æ¨¡æ¿åºåˆ—è¦æ±‚ä½ å°† Actor ç»‘å®šä¸º *Spawnables*ï¼Œä»¥ä¾¿åˆ¶ä½œåŠ¨ç”»ã€‚å¯ä»¥ä»å†…å®¹æµè§ˆå™¨æˆ– Place Actors é¢æ¿æ‹–æ”¾ Actorï¼Œå°†å…¶ç»‘å®šæˆ–é‡æ–°ç»‘å®šåˆ°æ¨¡æ¿åºåˆ—ï¼Œå¹¶ä¸”å¯ä»¥çœ‹åˆ°æœ‰é—ªç”µå›¾æ ‡ã€‚æ³¨æ„ï¼Œä½ åªèƒ½å°†å•ä¸ª Actor æ·»åŠ åˆ°ä¸€ä¸ªæ¨¡æ¿åºåˆ—ï¼Œå› ä¸ºæ·»åŠ ä¸åŒç±»å‹ä¼šæ›´æ”¹å½“å‰ç»‘å®šã€‚

ç›´æ¥ä» World Outline æ‹–æ”¾ Actor åˆ° Template Sequence ä¼šæ˜¾ç¤ºçº¢è‰²çŠ¶æ€ï¼Œå¹¶ä¸”ä¸å¯ä»¥è®¾ç½®ä¸º Spawnablesã€‚

æ ¹æ®éœ€è¦ï¼Œè®¾ç½®å…³é”®å¸§çš„æ•°æ®æ··åˆæ–¹å¼ï¼Œé€šè¿‡å…³é”®å¸§å³é”®èœå•æ“ä½œï¼Œè®¾ç½®æ··åˆç±»å‹ï¼ˆBlend Typeï¼‰ï¼š

- é™„åŠ ï¼ˆAdditiveï¼‰å°†å…³é”®å¸§çš„æ•°æ®å˜åŒ–å åŠ åˆ°åœºæ™¯ä¸­çš„å¯¹è±¡å±æ€§å€¼ã€‚
- ç›¸å¯¹ï¼ˆRelativeï¼‰å°†å…³é”®å¸§çš„æ•°æ®å˜åŒ–ç›¸å¯¹äºåœºæ™¯ä¸­çš„å¯¹è±¡å±æ€§å€¼è¿›è¡Œå˜åŒ–ã€‚
- ç»å¯¹ï¼ˆAbsoluteï¼‰å°†å…³é”®å·¾çš„æ•°æ®å˜åŒ–ä½œä¸ºåœºæ™¯ä¸­çš„å¯¹è±¡çš„å±æ€§ç»å¯¹å€¼ã€‚
- ä»åŸºç¡€é™„åŠ ï¼ˆAdditive from Baseï¼‰ã€‚

åº”ç”¨æ¨¡æ¿åºåˆ—åŠ¨ç”»ï¼š

- é¦–å…ˆï¼ŒActor çš„ç±»å¿…é¡»åŒ¹é…æ¨¡æ¿åºåˆ—ç»‘å®šåˆ°çš„ç±»ã€‚
- åœ¨å…³å¡åºåˆ—ä¸­ï¼Œç‚¹å‡»ï¼ˆ+ Trackï¼‰æŒ‰é’®ï¼Œç„¶åé€‰æ‹©ä½ çš„æ¨¡æ¿åºåˆ—èµ„äº§ã€‚
- 
æ¨¡æ¿åºåˆ—è½¨é“

ä½ å¯ä»¥å°†æ¨¡æ¿åºåˆ—åŠ¨ç”»åº”ç”¨äºç›¸åŒç±»çš„Actorã€‚å¦‚æœæ¨¡æ¿æ˜¯é™„åŠ çš„ï¼ŒåŠ¨ç”»å°†ä»¥é™„åŠ æ–¹å¼åº”ç”¨äºActorçš„å½“å‰ä½ç½®ã€‚

é€šè¿‡è“å›¾ä½¿ç”¨æ¨¡æ¿åºåˆ—ï¼šCreate Template Sequence Player 

- åœ¨è“å›¾ä¸­ï¼Œæ·»åŠ  Create Template Sequence Player è“å›¾èŠ‚ç‚¹ï¼Œåœ¨è¿è¡Œæ—¶å°†æ¨¡æ¿åºåˆ—åº”ç”¨äº Actorã€‚æ·»åŠ åï¼Œä»èŠ‚ç‚¹ä¸Šçš„ä¸‹æ‹‰èœå•é€‰æ‹©ä½ çš„æ¨¡æ¿åºåˆ—èµ„äº§ã€‚
- ä» Template Sequence Player èŠ‚ç‚¹è°ƒç”¨ Set Bindingï¼Œå°†ï¼ˆOut Actorï¼‰è¿æ¥åˆ°ç›®æ ‡ï¼ˆTargetï¼‰å¼•è„šã€‚
- å°†ä½ è¦å‘å…¶åº”ç”¨æ¨¡æ¿åºåˆ—åŠ¨ç”»çš„ Actor çš„å¼•ç”¨è¿æ¥åˆ° Set Binding èŠ‚ç‚¹çš„ Actor å¼•è„šã€‚
- æœ€åï¼Œæ·»åŠ  Play èŠ‚ç‚¹å¹¶ä» Create Template Sequence Player èŠ‚ç‚¹çš„ è¿”å›å€¼ï¼ˆReturn Valueï¼‰å¼•è„šè¿æ¥ã€‚



åŠ¨ç”»è“å›¾ `Animation Blueprint` å¯ä»¥å’Œ Sequencer è¿›è¡ŒåŠ¨ç”»æ··åˆï¼Œä½¿ç”¨ Sequencer ä¸­çš„åŠ¨ç”»è½¨é“çš„æ’æ§½ï¼ˆSlotï¼‰èŠ‚ç‚¹å’Œæƒé‡ï¼ˆWeightï¼‰å±æ€§æ¥å®Œæˆã€‚ 

åŠ¨ç”»æ··åˆå¯ä»¥å°†ä¸¤ä¸ªåŠ¨ä½œçš„èåˆï¼Œæ¯”å¦‚ä»åŠ¨ç”»è“å›¾è·å–é—²æ•£å§¿åŠ¿ï¼Œå¹¶å°†å®ƒæ··åˆåˆ° Sequencer ä¸­å®šä¹‰çš„å¥”è·‘åŠ¨ç”»ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ Third Person Shooter è“å›¾æ¨¡æ¿æä¾›çš„ç´ æï¼š

- é¦–å…ˆï¼Œä¸º Mannequin/Character/Mesh/SK_Mannequin éª¨éª¼å¯¹è±¡åˆ›å»ºåŠ¨ç”»è“å›¾ï¼ˆAnim Blueprintï¼‰ã€‚
- åœ¨åŠ¨ç”»è“å›¾ï¼ˆAnim Blueprintï¼‰ä¸­ï¼Œæ‹–å…¥ ThirdPersonIdleï¼Œå¹¶è¿æ¥åˆ°ï¼ˆSlotï¼‰èŠ‚ç‚¹ï¼Œç„¶åè¿æ¥åˆ°ï¼ˆFinal Animation Poseï¼‰ èŠ‚ç‚¹ã€‚ 
- è¯·æ³¨æ„ï¼Œæ’æ§½ï¼ˆSlotï¼‰çš„é»˜è®¤åç§°æ˜¯ *DefaultSlot*ï¼Œè¿™æ˜¯æˆ‘ä»¬å°†åœ¨å…³å¡åºåˆ—ä¸­å¼•ç”¨çš„åç§°ã€‚

å°† åŠ¨ç”»è“å›¾ï¼ˆAnim Blueprintï¼‰ æ‹–åˆ°å…³å¡ï¼Œç„¶åä»ä¸»å·¥å…·æ ä¸­ï¼Œé€‰æ‹© è¿‡åœºåŠ¨ç”»ï¼ˆCinematicsï¼‰ å¹¶é€‰æ‹© æ·»åŠ å…³å¡åºåˆ—ï¼ˆAdd Level Sequenceï¼‰ã€‚

ç»™å…³å¡åºåˆ—æŒ‡å®šä»»æ„åç§°å’Œä¿å­˜ä½ç½®ã€‚ 

å‘åºåˆ—æ·»åŠ  åŠ¨ç”»è“å›¾ï¼ˆAnim Blueprintï¼‰ è§’è‰²ï¼Œç„¶åæ·»åŠ /å¾ªç¯ ThirdPersonRun åŠ¨ç”»æ¥å¡«å……åºåˆ—ã€‚ 

å±•å¼€åŠ¨ç”»è½¨é“ï¼Œç„¶åå°† æƒé‡ï¼ˆWeightï¼‰ å€¼æ›´æ”¹ä¸º 0.0 å¹¶å‘åºåˆ—æ·»åŠ ä¸€ä¸ªé”®ã€‚ 

é€šè¿‡å°†æƒé‡è®¾ç½®ä¸º0.0ï¼Œæˆ‘ä»¬è¡¨ç¤ºåœ¨å¢å¤§æƒé‡å€¼ä¹‹å‰ä¸ä½¿ç”¨è¯¥åŠ¨ç”»çš„ä»»ä½•éƒ¨åˆ†ã€‚ 

ä¸º æƒé‡ï¼ˆWeightï¼‰ æ·»åŠ ä¸€ä¸ªé”®ï¼Œå€¼ä¸º 1.0ï¼Œä½äºå¸§ 75 å¤„ï¼Œå†æ·»åŠ å¦ä¸€ä¸ªé”®ï¼Œå€¼ä¸º 0.0ï¼Œä½äºå¸§ 150 å¤„ã€‚

è¿™å°†ä»0.0æ··åˆåˆ°1.0ï¼ˆåŠ¨ç”»çš„å®Œæ•´æ•ˆæœï¼‰ï¼Œç„¶åå†å›åˆ°0.0ã€‚ 

å³é”®å•å‡» ThirdPersonRun è½¨é“ï¼Œç„¶ååœ¨ å±æ€§ï¼ˆPropertiesï¼‰ ä¸‹é¢ï¼Œæ³¨æ„ æ’æ§½åç§°ï¼ˆSlot Nameï¼‰ å’Œæˆ‘ä»¬æ·»åŠ çš„ä¸‰ä¸ª é”®ï¼ˆKeysï¼‰ã€‚

æ’æ§½åç§°æ˜¯æŒ‡ä»£åŠ¨ç”»è“å›¾ä¸­æ·»åŠ çš„æ’æ§½èŠ‚ç‚¹çš„åç§°ã€‚è¿™äº›åç§°å¿…é¡»ç›¸åŒ¹é…ï¼Œè¿™æ ·Sequenceræ‰èƒ½çŸ¥é“ä½ æ‰€æŒ‡ä»£çš„æ˜¯å“ªä¸ªæ’æ§½ï¼Œå¹¶ä¼ é€’æƒé‡å€¼ã€‚ 

é€‰æ‹©å…³å¡åºåˆ—ï¼Œç„¶ååœ¨ ç»†èŠ‚ï¼ˆDetailsï¼‰ é¢æ¿ä¸­ï¼Œå¯ç”¨ è‡ªåŠ¨æ’­æ”¾ï¼ˆAuto Playï¼‰ å¹¶å°† å¾ªç¯ï¼ˆLoopï¼‰ è®¾ç½®ä¸º æ— é™å¾ªç¯ï¼ˆLoop Indefinitelyï¼‰ã€‚

ä»ä¸»å·¥å…·æ ï¼Œé€‰æ‹©"åœ¨ç¼–è¾‘å™¨ä¸­è¿è¡Œ"ï¼ˆPlay in the Editorï¼‰ã€‚


è™½ç„¶æˆ‘ä»¬çš„ç¤ºä¾‹ä½¿ç”¨é—²æ•£åŠ¨ç”»ä½œä¸ºæœ€ç»ˆåŠ¨ç”»å§¿åŠ¿ï¼Œä½†ä½¿ç”¨è¿™ç§æ–¹æ³•å¯ä»¥ç”Ÿæˆæ•´ä¸ªçŠ¶æ€æœºï¼Œä»¥æ ¹æ®ä»»æ„æ•°é‡çš„ç³»æ•°åœ¨åŠ¨ç”»è“å›¾ä¸­äº§ç”Ÿæœ€ç»ˆåŠ¨ç”»å§¿åŠ¿ï¼Œç„¶åæ··å…¥å…³å¡åºåˆ—ä¸­å®šä¹‰åŠ¨ç”»ã€‚ 

ä¸¾ä¾‹è€Œè¨€ï¼ŒNPCå¯ä»¥å®šä¹‰ä¸€äº›é€»è¾‘æ¥æ§åˆ¶å®ƒä»¬æ‰€å¤„çš„å§¿åŠ¿ï¼Œç©å®¶å¯ä»¥æ¥è¿‘è¯¥NPCï¼Œä»è€Œè§¦å‘ä¸€ä¸ªå‰§æƒ…ç”»é¢ï¼Œä½ å¯ä»¥ç”¨Sequencerä¸­å®šä¹‰çš„åŠ¨ç”»æ¥è¦†ç›–åŠ¨ç”»é€»è¾‘ã€‚


é€šå¸¸ï¼Œå¦‚æœä½ åœ¨åˆ›å»ºåŒ…å«äº†è§’è‰²ã€åŠ¨ç‰©ã€ç”Ÿç‰©æˆ–æ²¿ç€è¿™äº›ä¼šåŠ¨ç”»åŒ–å¹¶ç§»åŠ¨ä¹‹çº¿æ¡çš„ä»»ä½•ä¸œè¥¿çš„è¿‡åœºåŠ¨ç”»ï¼Œåˆ™ä½ å°†è·å¾—ä¸€ä¸ªç›¸å…³çš„éª¨æ¶ç½‘æ ¼ä½“ï¼Œå¹¶éœ€è¦å°†å…¶æ·»åŠ åˆ°Sequencerã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæ”¾åœ¨å…³å¡ï¼ˆLevelï¼‰ä¸­çš„ç†Šçš„éª¨æ¶ç½‘æ ¼ä½“ï¼ˆSkeletal Meshï¼‰ï¼ˆè§ä¸‹å›¾ï¼‰ã€‚é€‰æ‹©è¿™å¤´ç†Šåï¼Œæˆ‘ä»¬å¯ä»¥å•å‡»Sequencerä¸­çš„ è½¨è¿¹ï¼ˆTrackï¼‰ æŒ‰é’®ï¼Œå¹¶é€‰æ‹© Actorè‡³Sequencerï¼ˆActor To Sequencerï¼‰ï¼Œä»¥ä¾¿æˆ‘ä»¬åœ¨Sequencerç¼–è¾‘å™¨ï¼ˆSequencer Editorï¼‰ä¸­æ·»åŠ å¹¶æ§åˆ¶å®ƒã€‚

ä¸€æ—¦æ·»åŠ äº†éª¨æ¶ç½‘æ ¼ä½“ï¼ˆSkeletal Meshï¼‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ·»åŠ  å­è½¨è¿¹ï¼ˆSub-tracksï¼‰ ä»¥å½±å“è¯¥éª¨æ¶ç½‘æ ¼ä½“ï¼ˆSkeletal Meshï¼‰ã€‚


## âš¡ Skeletal Mesh Animation åŸºäºéª¨éª¼çš„åŠ¨ç”»ç³»ç»Ÿ
- éª¨æ¶ç½‘æ ¼ä½“åŠ¨ç”»ç³»ç»Ÿ https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/
- åŠ¨ç”»ç³»ç»Ÿæ¦‚è¿° https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/Overview/
- éª¨æ¶èµ„æº https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/Skeleton/
- https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/ControlRig/

è™šå¹»å¼•æ“ 4 åŠ¨ç”»ç³»ç»Ÿç”±å¤šä¸ªåŠ¨ç”»å·¥å…·å’Œç¼–è¾‘å™¨æ„æˆï¼Œå…¶å°†åŸºäºéª¨æ¶çš„å˜å½¢ä¸åŸºäºå˜å½¢çš„é¡¶ç‚¹å˜å½¢ç›¸ç»“åˆï¼Œä»è€Œæ„å»ºå‡ºå¤æ‚çš„åŠ¨ç”»ã€‚ è¯¥ç³»ç»Ÿå¯ä»¥ç”¨äºæ’­æ”¾å’Œæ··åˆé¢„å…ˆå‡†å¤‡å¥½çš„ `Animation Sequence` åŠ¨ç”»åºåˆ—è®©åŸºæœ¬ç©å®¶è¿åŠ¨æ˜¾å¾—æ›´åŠ çœŸå®ï¼Œåˆ›å»ºè‡ªå®šä¹‰ç‰¹æ®ŠåŠ¨ä½œï¼Œå¦‚ä¼¸ç¼©å°é˜¶ å’Œå¢™å£ï¼ˆä½¿ç”¨åŠ¨ç”»è’™å¤ªå¥‡ `Animation Montage`ï¼‰ï¼Œé€šè¿‡å˜å½¢ç›®æ ‡ åº”ç”¨ä¼¤å®³æ•ˆæœæˆ–é¢éƒ¨è¡¨æƒ…ï¼Œä½¿ç”¨éª¨æ¶æ§åˆ¶ `Skeletal Controls` ç›´æ¥æ§åˆ¶éª¨éª¼å˜å½¢ï¼Œæˆ–åˆ›å»ºåŸºäºé€»è¾‘çš„çŠ¶æ€æœº `State Machines` æ¥ç¡®å®šè§’è‰²åœ¨æŒ‡å®šæƒ…å¢ƒä¸‹åº”è¯¥ä½¿ç”¨å“ªä¸ªåŠ¨ç”»ã€‚

åŸºæœ¬æ¦‚å¿µäº†è§£ï¼š

åŸºäºéª¨éª¼åŠ¨ç”»ç³»ç»Ÿä¸­ï¼Œæœ€é‡è¦çš„åŸºæœ¬æ¦‚å¿µå°±æ˜¯`Skeleton`éª¨æ¶ï¼Œå®ƒæ˜¯éª¨éª¼ä½ç½®å’Œæ—‹è½¬çš„å±‚çº§ç»“æ„ï¼Œç”¨äºä½¿*Skeleton Mesh*éª¨æ¶ç½‘æ ¼ä½“å˜å½¢ã€‚åœ¨ UE4 ä¸­ï¼Œéª¨æ¶æ˜¯ä»å…¶è‡ªå·±èµ„æºä¸­çš„éª¨æ¶ç½‘æ ¼ä½“åˆ†ç¦»å‡ºæ¥çš„ã€‚è¿™æ„å‘³ç€ï¼ŒåŠ¨ç”»å°†åº”ç”¨äºéª¨æ¶ï¼Œè€Œä¸æ˜¯éª¨æ¶ç½‘æ ¼ä½“ã€‚é€šè¿‡ä½¿ç”¨ç›¸åŒçš„éª¨æ¶ï¼Œå¤šä¸ªéª¨æ¶ç½‘æ ¼ä½“å¯ä»¥å…±äº«åŠ¨ç”»ã€‚

`Animation Sequence`åŠ¨ç”»åºåˆ—æ˜¯å¯åœ¨éª¨æ¶ç½‘æ ¼ä½“ä¸Šæ’­æ”¾çš„å•ä¸ªåŠ¨ç”»èµ„æºã€‚è¿™äº›åºåˆ—åŒ…å«å„ä¸ªå…³é”®å¸§ï¼Œè€Œå…³é”®å¸§åˆè§„å®šäº†éª¨éª¼åœ¨ç‰¹å®šæ—¶é—´ç‚¹çš„ä½ç½®ã€æ—‹è½¬å’Œæ¯”ä¾‹ã€‚ä¾æ¬¡å›æ”¾è¿™äº›å…³é”®å¸§ï¼ˆç›¸äº’åˆæˆï¼‰å¯ä»¥é¡ºåˆ©å®ç°éª¨æ¶ç½‘æ ¼ä½“ä¸­çš„éª¨éª¼åŠ¨ç”»ã€‚

`Animation Notifications`åŠ¨ç”»é€šçŸ¥ä¸ºåŠ¨ç”»ç¨‹åºå‘˜æä¾›äº†ä¸€ç§æ–¹å¼ï¼Œä»¥ä¾¿è®¾ç½®äº‹ä»¶åœ¨ åŠ¨ç”»åºåˆ— ä¸­çš„ç‰¹å®šç‚¹ä¸Šå‘ç”Ÿã€‚é€šçŸ¥å¸¸ç”¨äºåœ¨è¡Œèµ°æˆ–è·‘æ­¥åŠ¨ç”»ä¸­æ·»åŠ è„šæ­¥å£°ä¹‹ç±»çš„æ•ˆæœï¼Œæˆ–åœ¨åŠ¨ç”»ä¸­ç”Ÿæˆç²’å­ç³»ç»Ÿã€‚å®ƒä»¬ç”¨é€”å¹¿æ³›ï¼Œç³»ç»Ÿå¯éšè‡ªå®šä¹‰é€šçŸ¥ç±»å‹è¿›è¡Œå»¶å±•ï¼Œä»¥æ»¡è¶³å„ç§æ¸¸æˆçš„éœ€æ±‚ã€‚

`Animation Blueprint`åŠ¨ç”»è“å›¾æ˜¯ä¸“ç”¨è“å›¾ï¼Œå®ƒæ§åˆ¶éª¨æ¶ç½‘æ ¼ä½“çš„åŠ¨ç”»ã€‚ ä½ å¯åœ¨åŠ¨ç”»è“å›¾ç¼–è¾‘å™¨ä¸­ç¼–è¾‘åŠ¨ç”»è“å›¾å›¾è¡¨ï¼Œæ‰§è¡ŒåŠ¨ç”»æ··åˆï¼Œç›´æ¥æ§åˆ¶éª¨æ¶çš„éª¨éª¼ï¼Œæˆ–è®¾ç½®æœ€ç»ˆå°†å®šä¹‰æ¯ä¸€å¸§è¦ä½¿ç”¨çš„éª¨æ¶ç½‘æ ¼ä½“çš„æœ€ç»ˆåŠ¨ç”»å§¿åŠ¿çš„é€»è¾‘ã€‚

`Blend Space`æ··åˆç©ºé—´æ˜¯å¯ä»¥åœ¨åŠ¨ç”»å›¾ï¼ˆ`AnimGraph`ï¼‰ ä¸­é‡‡æ ·çš„ç‰¹æ®Šèµ„æºï¼Œ å…è®¸æ ¹æ®ä¸¤ä¸ªè¾“å…¥çš„å€¼æ··åˆåŠ¨ç”»ã€‚è¦æ ¹æ®ä¸€ä¸ªè¾“å…¥åœ¨ä¸¤ä¸ªåŠ¨ç”»ä¹‹é—´å®ç°ç®€å•æ··åˆï¼Œ å¯ä»¥ä½¿ç”¨åŠ¨ç”»è“å›¾ä¸­æä¾›çš„ä¸€ä¸ªæ ‡å‡† æ··åˆèŠ‚ç‚¹ã€‚æ··åˆç©ºé—´æä¾›çš„æ–¹æ³•æ˜¯æ ¹æ®å¤šä¸ªå€¼ï¼ˆç›®å‰ä»…é™äºä¸¤ä¸ªï¼‰åœ¨å¤šä¸ªåŠ¨ç”»ä¹‹é—´è¿›è¡Œæ›´å¤æ‚çš„æ··åˆã€‚é€šè¿‡æŒ‡å®šè¾“å…¥ã€åŠ¨ç”»ä»¥åŠå¦‚ä½•ä½¿ç”¨è¾“å…¥æ¥æ··åˆåŠ¨ç”»ï¼Œå‡ ä¹å¯ä»¥ä½¿ç”¨é€šç”¨ æ··åˆç©ºé—´æ‰§è¡Œä»»ä¸€ç±»å‹çš„æ··åˆã€‚

`Animation Montage`åŠ¨ç”»è’™å¤ªå¥‡ç®€ç§°"è’™å¤ªå¥‡"ï¼Œæ”¯æŒä¸»è¦ä¸åœ¨è“å›¾å¯è§†åŒ–è„šæœ¬ä¸­æˆ–é€šè¿‡ä»£ç å…¬å¼€åŠ¨ç”»æ§ä»¶ç›¸å…³çš„å„ç§åŠ¨ç”»æ•ˆæœã€‚å®ƒä»¬ä¹Ÿå¯ç”¨äºåˆ›å»ºå„ç§åŠ¨ç”»æ•ˆæœï¼ŒåŒ…æ‹¬åŠ¨ç”»çš„æ™ºèƒ½å¾ªç¯ï¼ŒåŸºäºé€»è¾‘çš„åŠ¨ç”»åˆ‡æ¢ï¼Œç­‰ç­‰ã€‚

è’™å¤ªå¥‡æ˜¯ç”µå½±è¡Œä¸šæœ¯è¯­ï¼Œä¹Ÿæ˜¯å‰ªè¾‘æ‰‹æ³•ï¼Œå°±æ˜¯å°†ä¸åŒçš„ç”»é¢ï¼Œä¸åŒçš„å£°éŸ³ç»„åˆåœ¨ä¸€èµ·ã€‚ä¸åŒçš„é•œå¤´ç»„æ¥åœ¨ä¸€èµ·ä¼šè®©å•ä¸ªé•œå¤´äº§ç”Ÿæ–°çš„å«ä¹‰ï¼Œè¿›è€Œå½±å“äº†è§‚ä¼—çš„ç†è§£ã€‚

`Skeletal Controls`éª¨æ¶æ§åˆ¶å¯å¯¹éª¨æ¶èµ„æºä¸­çš„éª¨éª¼è¿›è¡Œç›´æ¥æ§åˆ¶ã€‚å®ƒä»¬å¯ç”¨äºåœ¨åŠ¨ç”»è“å›¾ä¸­è¿›è¡Œæ§åˆ¶ä¸€ä¸ªå•ç‹¬éª¨éª¼ã€åˆ›å»º IK é“¾ç­‰æ“ä½œã€‚å¯å¯¹ä¸‹æ–¹çš„éª¨æ¶è¿›è¡Œç›´æ¥æ§åˆ¶åï¼Œä¾¿èƒ½åˆ›å»ºè¿‡ç¨‹åŒ–ã€åŠ¨æ€é©±åŠ¨çš„åŠ¨ç”»ã€‚ä¸€ä¸ªéª¨éª¼çš„å˜å½¢ Transform å¯ç”¨äºé©±åŠ¨å¦ä¸€æ ¹éª¨éª¼ï¼Œæˆ–åœ¨æ’­æ”¾è¡Œèµ°åŠ¨ç”»æ—¶ä½¿è§’è‰²çš„è„šä¸åœ°é¢è´´åˆã€‚ ä»»æ„ç±»å‹çš„ä¿®æ”¹å‡å¯ç”¨äºè°ƒæ•´ã€æˆ–å®Œå…¨è¦†ç›–åŠ¨ç”»åºåˆ—æ‰€åº”ç”¨çš„éª¨éª¼å˜å½¢ã€‚

`State Machines`çŠ¶æ€æœºé€šè¿‡å›¾å½¢åŒ–æ–¹å¼å°†éª¨æ¶ç½‘æ ¼ä½“çš„åŠ¨ç”»æ‹†åˆ†ä¸ºä¸€ç³»åˆ—çŠ¶æ€ã€‚ç„¶åæŒ‰ç…§è½¬æ¢è§„åˆ™ç®¡ç†è¿™äº›çŠ¶æ€ï¼Œè½¬æ¢è§„åˆ™å¯æ§åˆ¶ä»ä¸€ä¸ªçŠ¶æ€æ··åˆåˆ°å¦ä¸€ä¸ªçŠ¶æ€ã€‚çŠ¶æ€æœºå¤§å¤§ç®€åŒ–äº†éª¨æ¶ç½‘æ ¼ä½“åŠ¨ç”»çš„è®¾è®¡æµç¨‹ï¼Œå¯ä»¥åˆ›å»ºä¸€å¼ æ§åˆ¶å›¾æ¥è½»æ¾æ§åˆ¶å„ä¸ªè§’è‰²åœ¨å„åŠ¨ç”»ä¹‹é—´è¿åŠ¨æ–¹å¼ï¼Œæ— éœ€åˆ›å»ºå¤æ‚çš„è“å›¾ç½‘ã€‚

å®ƒä»¬ä¹Ÿç®€åŒ–äº†åŠ¨ç”»å›¾çš„æ„æƒ³è¿‡ç¨‹ã€‚åœ¨è®¾è®¡åŠ¨ç”»æ—¶ï¼Œä½ å¯ä»¥å…ˆä»æ„æ€æ‰€éœ€è¦çš„çŠ¶æ€åŠè§’è‰²å¦‚ä½•ä»ä¸€ä¸ªçŠ¶æ€å˜æ¢åˆ°å¦ä¸€ä¸ªçŠ¶æ€å¼€å§‹ã€‚æœ€ç®€å•çš„ä¸€ç§æ„æ€æ–¹æ³•å°±æ˜¯ï¼ŒæŠŠè§’è‰²çš„æ‰€æœ‰åŠ¨ç”»åˆ†è§£ä¸ºä¸€ä¸ªæ˜“è¯»çš„æµç¨‹å›¾è¡¨ã€‚ä½ å¯ä»¥åœ¨å›¾ä¸­çœ‹åˆ°éª¨æ¶ç½‘æ ¼ä½“çš„çŠ¶æ€åœ¨å…¶ä¸­çš„ç§»åŠ¨èµ°åŠ¿ã€‚

æ¯”å¦‚ï¼Œå½“ä¸€ä¸ªè§’è‰²ä¸åŠ¨æ—¶ï¼Œå®ƒå¯èƒ½å¤„äº"ç©ºé—²"çŠ¶æ€ã€‚ä¸€æ—¦è§’è‰²çš„é€Ÿåº¦è¶…è¿‡æŸä¸ªç‰¹å®šçš„å€¼ï¼Œè§’è‰²å°±å¯ä»¥æ··åˆåˆ°å¦ä¸€ä¸ª"ç§»åŠ¨"çŠ¶æ€ã€‚è¿˜å¯ä»¥æœ‰å¾ˆå¤šç§å…¶ä»–çŠ¶æ€ï¼Œæ¯”å¦‚ä¸‹é™ã€è·³è·ƒã€è¹²ä¸‹ã€ç–¾è·‘ç­‰ã€‚é€šè¿‡ä½¿ç”¨çŠ¶æ€æœºï¼ŒåŠ¨ç”»å¸ˆå’Œç¾æœ¯å¸ˆå¯ä»¥å¿«é€Ÿåœ°æŸ¥çœ‹å…¶åŠ¨ç”»ç½‘ç»œçš„æ•°æ®æµåŠ¨æƒ…å†µã€‚

é€šè¿‡ åŠ¨ç”»æ··åˆæ¨¡å¼ï¼Œä½ å¯ä»¥æ§åˆ¶ç½‘æ ¼åœ¨ä» çŠ¶æ€æœºå™¨ ä¸­çš„ä¸€ç§çŠ¶æ€è¿‡æ¸¡åˆ°å¦ä¸€ç§çŠ¶æ€æ—¶æ··åˆä¸åŒå§¿åŠ¿çš„æ–¹å¼ã€‚ åœ¨çŠ¶æ€æœºå™¨çš„ è¿‡æ¸¡è§„åˆ™ï¼ˆTransition Ruleï¼‰çš„ æ··åˆè®¾ç½®ï¼ˆBlend Settingsï¼‰ä¸­ï¼Œä½ å¯ä»¥é€‰æ‹©è®¾ç½®å„ç§ä¸åŒçš„æ··åˆæ¨¡å¼ã€‚

å¯ä»¥é€‰æ‹©è®¸å¤šä¸åŒçš„æ··åˆåŠŸèƒ½ï¼šçº¿æ€§ã€ä¸‰æ¬¡ã€ä¸‰æ¬¡å„å°”å¯†ã€æ­£å¼¦ã€äºŒæ¬¡ã€åœ†å¼§ã€æŒ‡æ•°å’Œå®šåˆ¶ã€‚ å¯¹äºå¤§å¤šæ•°ç±»å‹ï¼Œä½ è¿˜å¯ä»¥åˆ†åˆ«æ§åˆ¶å¯¹æ›²çº¿è¿›è¡Œç¼“ å…¥ è¿˜æ˜¯ç¼“ å‡º å¤„ç†ã€‚


åŒæ­¥ç»„ Sync Group ä½¿ç›¸å…³çš„åŠ¨ç”»ç›¸äº’ä¿æŒåŒæ­¥ï¼Œå³ä½¿å®ƒä»¬é•¿åº¦ä¸ä¸€ä¹Ÿä¸ä¾‹å¤–ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥åˆ¶ä½œè¦æ··åˆåœ¨ä¸€èµ·çš„è¡Œèµ°å¾ªç¯å’Œè·‘æ­¥å¾ªç¯ï¼Œä½¿è§’è‰²èƒ½å¤Ÿæµç•…åœ°åŠ é€Ÿæˆ–å‡é€Ÿã€‚ä½†æ˜¯ï¼ŒåŒä¸€ä¸ªè§’è‰²çš„è¡Œèµ°å¾ªç¯é€šå¸¸ä¼šæ˜æ˜¾æ¯”è·‘æ­¥å¾ªç¯é•¿ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç›´æ¥å°†ä¸¤è€…æ··åˆä¼šäº§ç”Ÿä¸è‡ªç„¶çš„ç»“æœï¼Œæ¯”å¦‚è„šéƒ¨åŠ¨ç”»åˆ‡æ¢æ—¶ä¼šæœ‰å¾ˆéš¾çœ‹çš„"èŠ‚æ‹"åŠ¨ä½œã€‚

åŒæ­¥ç»„è§£å†³è¿™ä¸ªé—®é¢˜çš„åŠæ³•æ˜¯å°†ä¸€ä¸ªä¸»è¦åŠ¨ç”»èŠ‚ç‚¹æŒ‡å®šä¸º é¢†å¯¼è€…ï¼Œå¹¶è°ƒæ•´æ‰€æœ‰ç›¸å…³åŠ¨ç”»çš„é•¿åº¦ï¼Œä½¿å…¶ä¸é¢†å¯¼è€…çš„é•¿åº¦åŒ¹é…ã€‚é€šå¸¸é¢†å¯¼è€…å°±æ˜¯å…·æœ‰æœ€å¤§æ··åˆæƒé‡çš„èŠ‚ç‚¹ã€‚éšç€æƒé‡æ··åˆï¼Œè·Ÿéšè€…çš„æƒé‡è¶…è¿‡é¢†å¯¼è€…çš„æƒé‡ï¼Œè·Ÿéšè€…å°±ä¼šæˆä¸ºé¢†å¯¼è€…ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä¸¤ç§åŠ¨ç”»å¯ä»¥æµç•…åœ°ç›¸äº’é…åˆï¼Œæä¾›ä»ä¸€ç§åŠ¨ä½œåˆ°å¦ä¸€ç§åŠ¨ä½œçš„æ— ç¼è½¬æ¢ã€‚

ä½†æ˜¯è¯·æ³¨æ„ï¼Œç”±äºåŠ¨ç”»çš„æ—¶é•¿æ”¹å˜ï¼Œéœ€è¦è€ƒè™‘æŸäº›åŠ¨ç”»æ–¹é¢çš„å› ç´ ã€‚ä»¥è¡Œèµ°å¾ªç¯å’Œè·‘æ­¥å¾ªç¯çš„æ··åˆä¸ºä¾‹ï¼Œä¸¤ç§åŠ¨ç”»éƒ½åº”è¯¥åœ¨åŒä¸€åªè„šä¸Šå¼€å§‹å’Œç»“æŸã€‚åŠæ—©å»ºç«‹è¿™äº›æ ‡å‡†å°†æœ‰åŠ©äºä½¿æ‰€æœ‰åŠ¨ç”»çš„æ··åˆéš¾åº¦å¤§å¤§é™ä½ï¼


### âœ’ Skeleton & Animation éª¨æ¶ä¸åŠ¨ç”»
- åŠ¨ç”»åºåˆ— https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/Sequences/
- åŠ¨ç”»è“å›¾ https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/AnimBlueprints/
- åŠ¨ç”»æ“ä½œæŒ‡å— https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/AnimHowTo
- åŠ¨ç”»å§¿åŠ¿èµ„æº https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/AnimPose
- åŠ¨ç”»çŠ¶æ€æœº https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/StateMachines/
- https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/ProgrammingWithCPP/CPPTutorials/FirstPersonShooter


åœ¨å¤šæ•° 3D åº”ç”¨ç¨‹åºä¸­ï¼Œéª¨æ¶é€šå¸¸æ˜¯ä¸€ä¸ªæ•°å­—å±‚çº§æ¶æ„ï¼Œç”¨äºå®šä¹‰è§’è‰²ä¸­çš„éª¨éª¼æˆ–å…³èŠ‚ï¼Œå¹¶ä»¥è¯¸å¤šæ–¹å¼æ¨¡ä»¿çœŸå®çš„ç”Ÿç‰©éª¨æ¶ã€‚ åœ¨è™šå¹»å¼•æ“4ä¸­ï¼Œä¸€ä¸ªé‡è¦çš„åŒºåˆ«æ˜¯éª¨æ¶èµ„æºå°† å…³è”åŠ¨ç”»æ•°æ®ï¼Œè€Œå¹¶éåªæ˜¯éª¨æ¶ç½‘æ ¼ä½“ä¸­çš„éª¨éª¼å±‚çº§ã€‚ åœ¨ UE4 ä¸­ï¼Œéª¨æ¶èµ„æºå°†æŠŠéª¨éª¼ï¼ˆå…³èŠ‚ï¼‰æ•°æ®å…³è”åˆ°åŠ¨ç”»è½¨è¿¹ï¼Œä»è€Œé©±åŠ¨åŠ¨ç”»ã€‚

éª¨æ¶èµ„æºçš„å¦ä¸€ä¸ªé‡è¦æ–¹é¢ï¼šå¦‚æœéª¨æ¶ç½‘æ ¼ä½“å…±äº«åŒä¸€ä¸ªéª¨æ¶èµ„æºï¼ˆå–å†³äºæ»¡è¶³çš„åŸºæœ¬è§„åˆ™ï¼‰ï¼Œåˆ™å¯å…±äº«åŠ¨ç”»æ•°æ®ï¼Œå³ä½¿å±‚çº§ä¸å®Œå…¨åŒ¹é…ä¹Ÿèƒ½å…±äº«ã€‚èƒ½å¤Ÿåœ¨éª¨æ¶ç½‘æ ¼ä½“ä¹‹é—´å…±äº«éª¨æ¶èµ„æºåï¼Œå³å¯åœ¨å¤šä¸ªè§’è‰²ä¹‹é—´å…±äº«åŠ¨ç”»ï¼Œç”šè‡³å…±äº«æ•´ä¸ªåŠ¨ç”»è“å›¾ï¼Œå®šä¹‰è§’è‰²çš„åŠ¨ç”»é€»è¾‘ã€‚

é™¤é©±åŠ¨åŠ¨ç”»å¤–ï¼Œéª¨æ¶èµ„æºè¿˜è´Ÿè´£ï¼š

- åŠ¨ç”»é‡å®šä½ï¼Œä¾¿äºè°ƒæ•´æ¯”ä¾‹ä¸åŒçš„è§’è‰²çš„åŠ¨ç”»ã€‚
- åˆ›å»ºå’Œä¿å­˜æ’æ§½ï¼Œä»¥ä¾¿å°†å†…å®¹é™„åŠ åˆ°è§’è‰²ã€‚
- ä¿å­˜åŠ¨ç”»é€šçŸ¥ï¼Œä»¥ä¾¿å°†æ•ˆæœï¼ˆä¾‹å¦‚è„šæ­¥å£°ã€ç²’å­ç³»ç»Ÿï¼Œç”šè‡³è§¦å‘å…¶ä»–ä»£ç çš„è‡ªå®šä¹‰äº‹ä»¶ï¼‰æ·»åŠ åˆ°åŠ¨ç”»ã€‚
- ä¿å­˜åŠ¨ç”»æ›²çº¿ï¼ˆå¯ç”¨äºé©±åŠ¨æè´¨å‚æ•°æˆ–å˜å½¢ç›®æ ‡ï¼‰å’Œæ§½å‘½åï¼ˆå¯ç”¨äºæ’­æ”¾è§’è‰²çš„åŠ¨ç”»è’™å¤ªå¥‡ï¼‰ã€‚

åœ¨ UE4 ä¸­åˆ›å»ºéª¨æ¶èµ„æºçš„ä¸»è¦æ–¹å¼æ˜¯å¯¼å…¥éª¨æ¶ç½‘æ ¼ä½“ï¼Œå¦‚å°† FBX å¯¼å…¥é€‰é¡¹çª—å£ä¸­çš„éª¨æ¶ï¼ˆSkeletonï¼‰ åŸŸç•™ç©ºï¼Œåˆ™åŸºäºæ­£åœ¨å¯¼å…¥çš„éª¨æ¶ç½‘æ ¼ä½“è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªéª¨æ¶èµ„æºã€‚å¯ä»¥ä½¿ç”¨ Blender è¿™æ ·çš„å…è´¹å·¥å…·åˆ¶ä½œæ¨¡å‹ä»¥åŠéª¨éª¼çš„ç»‘å®šå’ŒåŠ¨ç”»è°ƒæ•´ã€‚åŠ¨ç”»çŠ¶æ€çš„è°ƒæ•´æ˜¯ç»†èŠ‚çš„å·¥å…·ï¼ŒåŠ¨ç”»è°ƒæ•´ä¸åˆ°ä½å°±çœ‹ä¸åˆ°çœŸå®çš„åŠ¨ç”»æ•ˆæœã€‚åŸå§‹çš„åŠ¨ç”»æ˜¯ç›´æ¥ä½¿ç”¨é¼ æ ‡é€ä¸ªå…³é”®å¸§æ¥è°ƒæ•´éª¨éª¼çš„ä½ç½®ã€æ—‹è½¬ï¼Œå¦‚æœæœ‰èµ„é‡‘æŠ•å…¥ï¼Œå¯ä»¥é€‰æ‹©æ›´å…ˆè¿›çš„åŠ¨ä½œæ•æ‰è®¾å¤‡æ¥åšåŠ¨ç”»ï¼Œè¿™æ ·åˆ¶ä½œå‡ºæ¥çš„åŠ¨ç”»é€¼çœŸæµç•…ã€‚

åœ¨éª¨æ¶ç½‘æ ¼ä½“çš„ FBX å¯¼å…¥è¿›ç¨‹ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ Skeleton ä¸‹æ‹‰èœå•æ¥é€‰æ‹©ä¸€ä¸ªéª¨æ¶èµ„æºä¸æ­£åœ¨å¯¼å…¥çš„ç½‘æ ¼ä½“è¿›è¡Œå…³è”ã€‚

å¯¼å…¥å¼•æ“çš„æ¯ä¸ªéª¨æ¶ç½‘æ ¼ä½“æˆ–åŠ¨ç”»éƒ½éœ€è¦ä¸€ä¸ªå…³è”çš„éª¨æ¶èµ„æºã€‚ åœ¨ FBX å¯¼å…¥æ—¶å¯ä»¥ä½¿ç”¨ç°æœ‰çš„éª¨æ¶èµ„æºï¼ˆå…·ä½“å–å†³äºæ‰€æ»¡è¶³çš„å…±äº«éª¨æ¶èµ„æºï¼‰ï¼Œæ— éœ€å•ç‹¬åˆ›å»ºéª¨æ¶ã€‚ éª¨æ¶çš„åˆå§‹æ¯”ä¾‹ç”±å…¶æ‰€åˆ›å»ºçš„åŸå§‹éª¨æ¶ç½‘æ ¼ä½“è€Œå®šä¹‰ï¼Œé‡å®šå‘åŠ¨ç”»æ—¶åŠ¡å¿…è€ƒè™‘åˆ°è¿™ç‚¹ã€‚

åˆ›å»ºéª¨æ¶çš„å¦ä¸€ç§æ–¹æ³•æ˜¯é€šè¿‡å³é”®å¿«æ·èœå•ä»å†…éƒ¨ç½‘æ ¼ä½“åˆ›å»ºéª¨æ¶ã€‚æ­¤æ–¹æ³•å¯ä»¥ç”¨å¼•æ“ä¸­ç°æœ‰çš„ç½‘æ ¼ä½“æ¥æ–°å»ºä¸€ä¸ªéª¨æ¶ã€‚å¦‚æœè¯¥ç½‘æ ¼ä½“æœ‰å…³è”çš„å…¶ä»–éª¨æ¶ï¼Œå…¶åªä¼šé‡æ–°å…³è”åˆ°æ–°éª¨æ¶ï¼Œç„¶åæ‰€æœ‰åŠ¨ç”»éƒ½å°†å…³è”åˆ°æ–°éª¨æ¶ã€‚

åœ¨è™šå¹»å•†åŸä¸­æä¾›äº†ä¸€å¥—å¥³æ€§è§’è‰²åŠ¨ç”» Military Style Mannequinsï¼Œå¯ä¾›å…è´¹ä½¿ç”¨ã€‚

éª¨æ¶èµ„æºçš„ä¸€ä¸ªé‡è¦ç‰¹æ€§æ˜¯å•ä¸ªçš„éª¨æ¶èµ„æºå¯ä»¥ç”±å¤šä¸ªéª¨æ¶ç½‘æ ¼ä½“ä½¿ç”¨ã€‚ æ¯ä¸ªéª¨æ¶ä¸­çš„éª¨éª¼å±‚çº§æ— éœ€å®Œå…¨ä¸€è‡´ã€‚ä½†å…¶éœ€è¦æ‹¥æœ‰ç›¸åŒçš„æ•´ä½“ç»“æ„ã€‚ æœ€é‡è¦çš„æ˜¯ä¸€ä¸ªéª¨æ¶ç½‘æ ¼ä½“åˆ°å¦ä¸€ä¸ªçš„éª¨éª¼å±‚çº§ä¸èƒ½è¢«æ”¹å˜ã€‚ è¿™æ„å‘³ç€éª¨éª¼å‘½åå’Œéª¨éª¼çš„æ’åºå¿…é¡»ä¸€è‡´ã€‚

ä¸¾ä¾‹è€Œè¨€ï¼Œä¸€ä¸ªèº¯å¹²æ‹¥æœ‰ 3 æ ¹éª¨éª¼ï¼Œå‘½ååŠè¿æ¥å…³ç³»ä¸º 1 -> 2 -> 3ã€‚

å¦‚æœæœ‰ç¬¬äºŒä¸ªéœ€è¦ä½¿ç”¨ç›¸åŒéª¨æ¶èµ„æºçš„éª¨æ¶ç½‘æ ¼ä½“ï¼Œåˆ™éœ€è¦ä¿è¯è¿™äº›éª¨éª¼çš„å‘½åå’Œæ’åºç›¸åŒã€‚ ç„¶è€Œå¯ä»¥æ·»åŠ å±‚çº§å¤–éƒ¨çš„éª¨éª¼ï¼Œä¸å«è¿™äº›é¢å¤–éª¨éª¼çš„è§’è‰²ä¸ä¼šä½¿ç”¨æ­¤æ•°æ®ã€‚ä¾‹å¦‚ï¼Œæ–°å±‚çº§åº”å¯ä»¥ä¸º  1 -> 2 -> 3 -> 4ã€‚

ä½†æ˜¯ï¼Œä¸ºä¸¤ä¸ªéª¨æ¶ç½‘æ ¼ä½“ä½¿ç”¨ç›¸åŒçš„éª¨æ¶èµ„æºï¼Œå°±ä¸èƒ½å¯¹å±‚çº§è¿›è¡Œé‡æ–°æ’åºæˆ–é‡å‘½åéª¨éª¼ã€‚ä¸¾ä¾‹è€Œè¨€ï¼Œè¿™å¹¶éæœ‰æ•ˆ 1 -> 3 -> 2ã€‚åœ¨æ­¤å®ä¾‹ä¸­ï¼Œç¬¬äºŒä¸ªéª¨æ¶ç½‘æ ¼ä½“ä½¿ç”¨äº†ä¸€ä¸ªä¸åŒçš„éª¨éª¼å±‚çº§ï¼Œéœ€è¦ä¸€ä¸ªæ–°çš„éª¨æ¶èµ„æºã€‚

å› ä¸ºæ·»åŠ å±‚çº§å¤–å›´çš„éª¨éª¼ä¸ºæœ‰æ•ˆæ“ä½œï¼Œæ‰€ä»¥å¯ä»¥è½»æ¾åœ¨æ‹¥æœ‰é¢å¤–éƒ¨åˆ†çš„éª¨æ¶ç½‘æ ¼ä½“ä¹‹é—´é‡å¤ä½¿ç”¨éª¨æ¶èµ„æºã€‚ä¸¾ä¾‹è€Œè¨€ï¼Œéœ€è¦åœ¨3ä¸ªä¸åŒä½†ç›¸ä¼¼çš„è§’è‰²ç±»å‹ä¹‹é—´å…±äº«åŠ¨ç”»ï¼Œè¿™ä¸‰è€…å‡æ‹¥æœ‰ç›¸åŒçš„éª¨éª¼ç»“æ„ï¼ˆå’Œç›¸åŒçš„éª¨éª¼å‘½åï¼‰ï¼Œä½†å­˜åœ¨ä¸€äº›å…³é”®å·®å¼‚ï¼š

- ä¸€ä¸ªç”·æ€§äººç±»ï¼ˆä¸¾ä¾‹è€Œè¨€ï¼Œè¿™å°±æ˜¯æ‚¨çš„åŸºç¡€è§’è‰²ï¼‰
- ä¸€ä¸ªå¥³æ€§äººç±»ï¼Œæ‹¥æœ‰é©¬å°¾è¾«éª¨éª¼
- ä¸€ä¸ªæ‹¥æœ‰å››è‚¢çš„ç±»äººè§’è‰²

å¯ä»¥å°†åŒä¸€ä¸ªéª¨æ¶èµ„æºç”¨äºæ‰€æœ‰è¿™äº›è§’è‰²ï¼Œç»“æœæ˜¯éª¨æ¶èµ„æºå°†åŒ…å«æ‰€æœ‰3ç§ç±»å‹çš„å…³èŠ‚å±‚çº§ä¿¡æ¯ã€‚åŠ¨ç”»å°†ä½¿ç”¨éª¨æ¶èµ„æºæ¥ç¡®å®šåº”ç”¨åˆ°æ¯æ ¹éª¨éª¼çš„æ—‹è½¬ã€‚å› ä¸ºéª¨æ¶ç½‘æ ¼ä½“ä¸ºè®¾è®¡åˆ¶ä½œï¼Œå› æ­¤å…¶åŸºç¡€éª¨éª¼å±‚çº§å‡ç›¸åŒï¼ŒåŠ¨ç”»å°†åœ¨å®ƒä»¬ä¹‹é—´å®Œç¾å…¼å®¹ã€‚å”¯ä¸€çš„å·®å¼‚æ˜¯å¯èƒ½éœ€è¦ä¸€äº›ç‰¹æ®ŠåŠ¨ç”»æ¥é©±åŠ¨è¿™äº›è§’è‰²ä¸Šå¤šå‡ºçš„èº¯å¹²æˆ–é©¬å°¾è¾«ã€‚

æœªåŒ…å«åœ¨éª¨æ¶ç½‘æ ¼ä½“ä¸­çš„éª¨éª¼æ¥æ”¶åˆ°åŠ¨ç”»æ•°æ®æ—¶ï¼ˆä¾‹å¦‚é©¬å°¾è¾«åŠ¨ç”»è¢«ç”¨äºä½¿ç”¨ç›¸åŒéª¨æ¶èµ„æºçš„è§’è‰²ï¼Œä½†æ­¤è§’è‰²ä¸å¸¦é©¬å°¾è¾«ï¼‰ï¼Œè¯¥åŠ¨ç”»æ•°æ®å°†è¢«å¿½ç•¥ã€‚


æŒ‰ç»„ç»‡ç»“æ„ï¼Œ`Skeleton` ç»„åˆ *Static Mesh* å¾—åˆ° *Skeleton Mesh*ï¼Œæ·»åŠ ä¸ŠåŠ¨ç”»æ•°æ®åå¾—åˆ° *Animation Sequence*ã€‚éª¨æ¶å¯ä»¥é€šè¿‡ *Skeleton Mesh* åˆ›å»ºï¼Œä¹Ÿå¯ä»¥æ˜ å°„åˆ°å¦ä¸€ä¸ªéª¨æ¶ Retarget to Another Skeletonï¼Œè€Œéª¨æ¶ç½‘æ ¼ä¹Ÿå¯ä»¥é‡æ–°åˆ†é…ä¸€å‰¯éª¨æ¶ï¼Œé€šè¿‡å†…å®¹æµè§ˆå™¨å³é”®èœå•æ“ä½œ Skeleton -> Assign Skeletonã€‚

UE4 ä¸­çš„åŠ¨ç”»å¯ä»¥ç®€å•ç†è§£ä¸º Animation Sequence è®°å½•çš„åŠ¨ç”»å…³é”®å¸§æ•°æ®ï¼Œè€ŒåŠ¨ç”»è“å›¾å°±æ˜¯å°†è¿™äº›åŠ¨ç”»æ•°æ®ï¼Œä»¥çŠ¶æ€æœºçš„å½¢å¼ç»„ç»‡èµ·æ¥ã€‚é€šè¿‡åŠ¨ç”»è“å›¾è¿›è¡ŒçŠ¶æ€æœºç®¡ç†ï¼Œå°†å„ç§`Animation Sequence`åŠ¨ç”»åºåˆ—æŒ‰çŠ¶æ€ç»„ç»‡åˆ°ä¸€èµ·ï¼Œåœ¨ä»€ä¹ˆçŠ¶æ€å°±æ’­æ”¾ä»€ä¹ˆåŠ¨ç”»ã€‚

æ¸¸æˆè§’è‰² Character å¯¹è±¡çš„ Mesh å±æ€§æä¾›äº†è®¾ç½®ï¼Œç”¨æ¥å…³è” *Skeletal Mesh*ã€‚è§’è‰²è“å›¾ä¸­å¯ä»¥ç¼–å†™å„ç§è¾“å…¥ä¸è¡Œä¸ºï¼Œè¡Œä¸ºè¿›ä¸€æ­¥è§¦å‘åŠ¨ç”»æ’­æ”¾ã€‚åœ¨è“å›¾ä¸­ï¼Œç½‘æ ¼å¯¹è±¡å¯ä»¥ç›´æ¥è°ƒç”¨ *PlayAnimation* æ’­æ”¾æŒ‡å®šçš„åŠ¨ç”»èµ„äº§ã€‚ä½†æ˜¯ç›´æ¥æ’­æ”¾åŠ¨ç”»è¿˜éœ€è¦è€ƒè™‘å…¶å®ƒçŠ¶æ€çš„åŠ¨ç”»å¦‚ä½•æµç•…åœ°æ··åˆåœ¨ä¸€èµ·ï¼Œè€ŒåŠ¨ç”»è“å›¾å°±æ˜¯é€šè¿‡ä¸€ä¸ªåŠ¨ç”»çŠ¶æ€æœºæ¥è§£å†³è§’è‰²æ‰€æœ‰ç›¸å…³çŠ¶æ€çš„åŠ¨ç”»å¦‚ä½•åœ¨å„ç§çŠ¶æ€ä¸‹çš„æµç•…åˆ‡æ¢ã€‚

åœ¨å†…å®¹æµè§ˆå™¨åˆ›å»ºåŠ¨ç”»è“å›¾ï¼ŒAnimation -> Animation Blueprintï¼Œé€‰æ‹© *AnimInstance* ä½œä¸ºçˆ¶ç±»ï¼Œå¹¶é€‰æ‹©ä¸€ä¸ªç›®æ ‡éª¨æ¶ã€‚

åŠ¨ç”»è“å›¾`Animation Blueprint`å’Œå…¶å®ƒç±»å‹çš„è“å›¾ç›¸ä¼¼ï¼Œä¹Ÿæœ‰ EventGraph å›¾è¡¨ã€‚ä½†æœ€å¤§çš„ä¸€ä¸ªå·®åˆ«å°±æ˜¯åŠ¨ç”»è“å›¾çš„çŠ¶æ€æœºï¼Œå¢åŠ äº† *Animation Graphs*ï¼Œåœ¨ My Blueprint é¢æ¿åŒå‡»æ‰“å¼€ AnimGraph å°±å¯ä»¥çœ‹åˆ° *Output Pose* èŠ‚ç‚¹ï¼Œå®ƒè¡¨ç¤ºåŠ¨ç”»è“å›¾çš„è¾“å…¥åŠ¨ä½œã€‚è€ŒçŠ¶æ€æœºå°±æ˜¯åœ¨ä¸åŒçŠ¶æ€ä¸­åˆ‡æ¢è¾“å‡ºçš„åŠ¨ä½œåŠ¨ç”»ï¼Œå¯¹äºæ–°å»ºçš„åŠ¨ç”»è“å›¾ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ª *State Machine* å¹¶å¯¹å…¶è¿›è¡ŒçŠ¶æ€ç®¡ç†ï¼Œå¹¶å°†çŠ¶æ€æœºçš„ Animation Pose è¾“å‡ºè¿æ¥åˆ° Output Pose èŠ‚ç‚¹ã€‚

æ–°å»ºçš„çŠ¶æ€æœºå†…éƒ¨åªæœ‰ä¸€ä¸ª Entry èŠ‚ç‚¹ï¼Œå®ƒè¡¨ç¤ºçŠ¶æ€æœºçš„å…¥å£ï¼ŒçŠ¶å¤ªæœºå¤„ç†ä»€ä¹ˆçŠ¶æ€ï¼Œå°±ä¼šè¾“å‡ºå¯¹åº”çŠ¶æ€èŠ‚ç‚¹çš„åŠ¨ä½œã€‚åœ¨ My Blueprint -> Animation Graphs é¢æ¿ä¸­å¯ä»¥çœ‹åˆ°çŠ¶æ€æœºçš„çŠ¶æ€ã€çŠ¶æ€è½¬æ¢è§„åˆ™ï¼Œåˆ†åˆ«ä½¿ç”¨ä¸¤ä¸ªåŠåœ†ã€ä¸¤ä¸ªæ–¹å‘ç›¸åçš„ç®­å¤´è¡¨ç¤ºã€‚

çŠ¶æ€æœºçš„ä¸»è¦æ„æˆéƒ¨åˆ†æœ‰äºŒï¼šå„ç§çŠ¶æ€çš„ç½‘ç»œã€ä»¥åŠå®šä¹‰çŠ¶æ€è½¬å…¥è½¬å‡ºçš„è§„åˆ™ã€‚æ¯ç§çŠ¶æ€å’Œæ¯æ¡è§„åˆ™è®¾ç½®éƒ½æ˜¯å…¶è‡ªèº«æµ“ç¼©çš„è“å›¾ ç½‘ç»œã€‚çŠ¶æ€è‡ªèº«ä¸å¸¦å¼•è„šï¼Œä¹Ÿæ²¡æœ‰è¾“å…¥çš„å¼•è„šï¼Œä»å…¶å¤–éƒ¨è¾¹ç•Œæ‹–åŠ¨å¼•çº¿å³å¯è¿æ¥çŠ¶æ€æˆ–åˆ›å»ºæ–°çŠ¶æ€ã€‚

çŠ¶æ€çš„ä½œç”¨æ˜¯äº§ç”Ÿæœ€ç»ˆåŠ¨ç”»æˆ–å§¿åŠ¿ï¼Œå¯ä»¥æ˜¯å•ä¸ªåŠ¨ç”»åºåˆ—ã€æ··åˆç©ºé—´æˆ–ä»»æ„ç±»å‹çš„ç½‘ç»œï¼Œåªè¦äº§ç”Ÿçš„æ˜¯æœ€ç»ˆåŠ¨ç”»æˆ–å§¿åŠ¿å³å¯ã€‚

æ¯ä¸ªçŠ¶æ€å†…éƒ¨åŸºæœ¬éƒ½æœ‰ä¸€ä¸ª Output Animation Pose èŠ‚ç‚¹ï¼Œå®ƒè¾“å‡ºå½“å‰çŠ¶æ€çš„è§’è‰²åŠ¨ç”»ã€‚æ‰€ä»¥ï¼Œå¯ä»¥ç†è§£ä¸ºæ¯ä¸ªçŠ¶æ€å°±æ˜¯åœ¨æ’­æ”¾ä¸€ä¸ªåŠ¨ç”»èµ„äº§ã€‚ç›´æ¥ä»åŠ¨ç”»è“å›¾ç¼–è¾‘å™¨çš„ Asset Browser å°†åŠ¨ç”»èµ„äº§æ‹–æ”¾åˆ°çŠ¶æ€å›¾è¡¨ä¸­ï¼Œå°±ä¼šè‡ªåŠ¨åˆ›å»º Animation Play æˆ– Blendspace Player èŠ‚ç‚¹ï¼Œå°†å…¶è¿æ¥åˆ° Output Animation Pose å³å¯ã€‚

å®šä¹‰çŠ¶æ€åï¼Œéœ€è¦æ§åˆ¶éª¨æ¶ç½‘æ ¼ä½“å¦‚ä½•ä»ä¸€ä¸ªçŠ¶æ€è½¬æ¢åˆ°å¦ä¸€ä¸ªçŠ¶æ€ï¼Œè¿™ä¾¿æ˜¯éœ€è¦ç”¨åˆ°è½¬æ¢è§„åˆ™ï¼Œè½¬æ¢è§„åˆ™æ²¿è¿æ¥çŠ¶æ€çš„å¼•çº¿è‡ªåŠ¨åˆ›å»ºã€‚è½¬æ¢è§„åˆ™å¯å¯¹å˜é‡å€¼æ‰§è¡Œä»»æ„æ•°é‡çš„æ£€æŸ¥å’Œæµ‹è¯•ï¼Œç›®çš„æ˜¯è¾“å‡ºä¸€ä¸ª True/False å€¼ï¼Œä»¥å†³å®šåŠ¨ç”»æ˜¯å¦èƒ½é€šè¿‡è½¬æ¢ã€‚

åœ¨åŠ¨ç”»å›¾è¡¨ä¸­ï¼Œä¹Ÿå°±æ˜¯çŠ¶æ€æœºç®¡ç†å›¾è¡¨å¯ä»¥æ·»åŠ ä¸‰ç§èŠ‚ç‚¹ï¼š

- Comment æ³¨è§£èŠ‚ç‚¹ï¼›
- Conduits å¯¼ç®¡æ˜¯æ›´é«˜çº§çš„å…±äº«è½¬æ¢èµ„æºï¼Œå’Œ 1 å¯¹ 1 å…³ç³»çš„è½¬æ¢è§„åˆ™ä¸åŒï¼Œå¯¼ç®¡å¯ä»¥æ˜¯ 1 å¯¹å¤šã€å¤šå¯¹ 1ï¼Œæˆ–å¤šå¯¹å¤šå…³ç³»ï¼›
- State çŠ¶æ€ï¼Œè¡¨ç¤ºçŠ¶æ€æœºä¸­çš„ä¸€ä¸ªçŠ¶æ€ç®¡ç†å¯¹è±¡ï¼ŒåŒå‡»æ‰“å¼€ä¸€ä¸ªçŠ¶æ€å›¾è¡¨ï¼Œå¯ä»¥æ·»åŠ å„ç§èŠ‚ç‚¹æ¥åˆ¤æ–­æ˜¯å¦å¯ä»¥è¿›å…¥æ­¤çŠ¶æ€ï¼›

è½¬æ¢è§„åˆ™ä¼šæ²¿ç€è¿æ¥çŠ¶æ€å’Œå¯¼ç®¡çš„å¼•çº¿è‡ªåŠ¨åˆ›å»ºï¼Œä»å›¾å½¢ä¸Šçœ‹ï¼Œè½¬æ¢è§„åˆ™æ˜¾ç¤ºä¸ºå¾ªç¯æ–¹å‘å°å›¾æ ‡ã€‚è¿™æ„å‘³ç€ï¼Œåœ¨çŠ¶æ€èŠ‚ç‚¹è¾¹æ¡†æ‹–å‡ºå¼•çº¿åˆ°å›¾è¡¨ç©ºä½ç½®æ¥åˆ›å»ºçŠ¶æ€æˆ–å¯¼ç®¡æ—¶ï¼Œå°†è‡ªåŠ¨é’ˆå¯¹è¯¥å¼•çº¿åˆ›å»ºè½¬æ¢è§„åˆ™ã€‚

åŒå‡»è½¬æ¢è§„åˆ™çº¿ä¸Šçš„å›¾æ ‡æ‰“å¼€æ–°å›¾è¡¨ï¼Œå…è®¸æ‚¨å®šä¹‰è½¬æ¢çš„æˆåŠŸæˆ–å¤±è´¥æ¡ä»¶ã€‚


çŠ¶æ€æœºéœ€è¦æ ¹æ®æ¡ä»¶è¿›è¡ŒçŠ¶æ€å˜åŒ–ï¼Œå¸¸ç”¨çš„æ–¹æ³•å°±æ˜¯æ·»åŠ çŠ¶æ€æœºè¿‡æ¸¡å˜é‡ï¼Œæ“ä½œæ­¥éª¤ï¼š

- åœ¨ï¼ˆMy Blueprintï¼‰ é€‰é¡¹å¡ä¸­ï¼Œç‚¹å‡»ï¼ˆAdd Newï¼‰ æŒ‰é’®ï¼Œå¹¶é€‰æ‹© å˜é‡ï¼ˆVariableï¼‰ã€‚
- å°†è¯¥å˜é‡è®¾ç½®ä¸º å¸ƒå°”ï¼ˆBooleanï¼‰ï¼Œå¹¶å°†å…¶å‘½åä¸º"IsRunning"ã€‚
- é‡å¤å‰é¢çš„æ“ä½œåˆ›å»ºå¦ä¸€ä¸ªå˜é‡ï¼Œå°†è¯¥å˜é‡è®¾ç½®ä¸º å¸ƒå°”å‹ï¼ˆBooleanï¼‰ï¼Œå¹¶å°†å…¶å‘½åä¸º"IsFalling"ã€‚

ç°åœ¨æ·»åŠ äº†ä¸¤ä¸ªåŠ¨ç”»è¿‡æ¸¡å˜é‡ï¼Œç”¨äºé©±åŠ¨åŠ¨ç”»çš„çŠ¶æ€æœºã€‚æ¥ä¸‹æ¥å°±æ˜¯è·å–è§’è‰²çŠ¶æ€ï¼Œå¹¶è®¾ç½®åŠ¨ç”»è“å›¾çš„çŠ¶æ€å˜é‡ï¼š

- åŒå‡» My Blueprint -> EventGraphï¼Œæ‰“å¼€äº‹ä»¶å›¾è¡¨ã€‚
- é€šè¿‡å›¾è¡¨å³é”®ä¸Šä¸‹æ–‡èœå•æ·»åŠ  *Event Blueprint Update Animation* åŠ¨ç”»æ›´æ–°äº‹ä»¶ï¼Œç”¨æ¥æ›´æ–°çŠ¶æ€å˜é‡ï¼Œä¸æ¸¸æˆçŠ¶æ€åŒæ­¥ã€‚
- å†åˆ›å»ºä¸€ä¸ª *Try Get Pawn Owner* èŠ‚ç‚¹ï¼Œç”¨æ¥è·å–ç©å®¶è§’è‰²ï¼Œå¹¶åˆ›å»º *Cast to Character* è¿›è¡Œç±»å‹è½¬æ¢ã€‚
- å°† Event Blueprint Update Animation æ‰§è¡Œæµä¸²è¿èµ·æ¥ã€‚
- ä» *As Character* è¾“å‡ºå¼•è„šè¿å‡ºå¼•çº¿ï¼Œå¹¶è¿æ¥åˆ° *Get Character Movement* èŠ‚ç‚¹ã€‚
- ä» *Character Movement* è¾“å‡ºå¼•è„šè¿å‡ºå¼•çº¿ï¼Œå¹¶é€‰æ‹© *Get Movement Mode* ä»¥è·å–è§’è‰²è¿åŠ¨æ¨¡å¼ã€‚

å¼•æ“æä¾›çš„è§’è‰²è¿åŠ¨æ¨¡å¼å®šä¹‰ EMovementModeï¼š

```C++
// UE_5.0EA\Engine\Source\Runtime\Engine\Classes\Engine\EngineTypes.h
/** Movement modes for Characters. */
UENUM(BlueprintType)
enum EMovementMode
{
    /** None (movement is disabled). */
    MOVE_None       UMETA(DisplayName="None"),

    /** Walking on a surface. */
    MOVE_Walking    UMETA(DisplayName="Walking"),

    /** 
     * Simplified walking on navigation data (e.g. navmesh). 
     * If GetGenerateOverlapEvents() is true, then we will perform sweeps with each navmesh move.
     * If GetGenerateOverlapEvents() is false then movement is cheaper but characters can overlap other objects without some extra process to repel/resolve their collisions.
     */
    MOVE_NavWalking UMETA(DisplayName="Navmesh Walking"),

    /** Falling under the effects of gravity, such as after jumping or walking off the edge of a surface. */
    MOVE_Falling    UMETA(DisplayName="Falling"),

    /** Swimming through a fluid volume, under the effects of gravity and buoyancy. */
    MOVE_Swimming   UMETA(DisplayName="Swimming"),

    /** Flying, ignoring the effects of gravity. Affected by the current physics volume's fluid friction. */
    MOVE_Flying     UMETA(DisplayName="Flying"),

    /** User-defined custom movement mode, including many possible sub-modes. */
    MOVE_Custom     UMETA(DisplayName="Custom"),

    MOVE_MAX        UMETA(Hidden),
};
```

é€šè¿‡ Character æä¾›çš„ API è·å–è§’è‰²è¿åŠ¨æ¨¡å¼æ˜¯ç®¡ç†åŠ¨ç”»è“å›¾çŠ¶æ€éå¸¸åŸºç¡€çš„ä¸€ä¸ªæ­¥éª¤ï¼Œæœ‰äº†è¿åŠ¨æ¨¡å¼ä¿¡æ¯å°±å¯ä»¥æ ¹æ®è¿™ä¸ªæ¨¡å¼æ¥è®¾ç½®çŠ¶æ€ï¼š

- ä» Movement Mode è¾“å‡ºå¼•è„šè¿å‡ºå¼•çº¿ï¼Œè¿æ¥ *Equal (Enum)*ï¼Œå¹¶é€‰æ‹©ç›¸åº”è¿åŠ¨æ¨¡å¼ã€‚
- ç¡®å®šè§’è‰²æ˜¯å¦åœ¨ä¸‹é™çŠ¶æ€ï¼Œå°±é€‰æ‹© Equal (Enum) èŠ‚ç‚¹çš„æ¨¡å¼ä¸ºï¼ˆFallingï¼‰ã€‚
- æŒ‰ä½ Alt é”®å°† My Blueprint -> IsFalling çŠ¶æ€å˜é‡æ‹–åŠ¨åˆ°å›¾è¡¨ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥åˆ›å»ºä¸€ä¸ª *Set Is Falling* èŠ‚ç‚¹ã€‚
- å¹¶å°† Equal (Enum) èŠ‚ç‚¹çš„è¾“å‡ºå¸ƒå°”æ•°æ®å¼•è„šè¿æ¥åˆ° Set Is Falling èŠ‚ç‚¹çš„è¾“å…¥å¸ƒå°”æ•°æ®å¼•è„šã€‚

EMovementMode å¹¶æ²¡æœ‰æä¾› Running çŠ¶æ€ï¼Œè¦ç¡®å®šè§’è‰²æ˜¯å¦åœ¨å¥”è·‘çŠ¶æ€ï¼Œåªéœ€è¦åˆ¤æ–­è§’è‰²çš„è¿åŠ¨é€Ÿåº¦å°±å¯ä»¥å®ç°ã€‚

å¦‚æœè§’è‰²ä¸æ˜¯ç«™ç«‹ä¸åŠ¨ï¼Œå…¶é€Ÿåº¦å‘é‡çš„é•¿åº¦å°†å¤§äºé›¶ï¼š

- ä» Cast To Character èŠ‚ç‚¹çš„ As Character å¼•è„šå†æ¬¡è¿å‡ºå¼•çº¿ï¼Œè¿æ¥ *Get Velocity* èŠ‚ç‚¹ã€‚
- å› æ­¤ï¼Œä» *Return Value* å‘é‡è¾“å‡ºå¼•è„šè¿å‡ºå¼•çº¿ï¼Œå¹¶é€‰æ‹© *Vector Length* ä»¥å°†è¯¥èŠ‚ç‚¹æ·»åŠ åˆ°å›¾è¡¨ã€‚
- ä» Return Value æµ®ç‚¹è¾“å‡ºå¼•è„šè¿å‡ºå¼•çº¿ï¼Œå¹¶é€‰æ‹© *> (float)* èŠ‚ç‚¹ï¼Œè¿›è¡Œæµ®ç‚¹æ•°å€¼å¤§å°æ¯”è¾ƒã€‚
- æŒ‰ä½ Alt é”®å°† My Blueprint -> IsRunning çŠ¶æ€å˜é‡æ‹–åˆ°å›¾è¡¨ä¸­ï¼Œåˆ›å»ºä¸€ä¸ª *Set Is Running* èŠ‚ç‚¹ã€‚
- å°† *> (float)* èŠ‚ç‚¹çš„è¾“å‡ºå¸ƒå°”å¼•è„šè¿æ¥åˆ° Set Is Running èŠ‚ç‚¹çš„è¾“å…¥å¸ƒå°”å¼•è„šã€‚

æ³¨æ„æ‰§è¡Œæµè¦ä¸²è¿èµ·æ¥ï¼Œä»¥ä¿è¯å„ä¸ªèŠ‚ç‚¹è¢«æ‰§è¡Œåˆ°ã€‚

å‚è€ƒ UE4 ç¬¬ä¸‰äººç§°å°„å‡»æ¸¸æˆæ¨¡æ¿ä¸­æä¾›çš„ *ThirdPerson_AnimBP* çš„äº‹ä»¶æ‰§è¡Œæµç¨‹ï¼š

    Event Blueprint Update Animation
        -> TryGet PawnOwner -> ?IsValid
            -> Get MovementComponent -> IsFalling -> Set IsInAir 
            -> Get Velocity -> VectorLength -> Set Speed

EventGraph å›¾è¡¨ä¸­å°±åšäº†ä¸€ä»¶äº‹ï¼šè®¾ç½®çŠ¶æ€å˜é‡ï¼ŒåŒ…æ‹¬ IsInAir å’Œ Speed ä¸¤ä¸ªçŠ¶æ€å˜é‡ã€‚

æ‰“å¼€ç¬¬ä¸‰äººç§°æ¨¡æ¿çš„ *ThirdPerson_AnimBP* åŠ¨ç”»è“å›¾ï¼Œè¿™å·²ç»è®¾ç½®å¥½ç©ºé—²ã€èµ°ã€è·‘ã€è·³ç­‰åŠ¨ç”»çš„çŠ¶æ€æ˜¯å¦‚ä½•è¿‡åº¦çš„ï¼š

- é¦–å…ˆï¼ŒçŠ¶æ€æœºæ‰§è¡Œè¿›å…¥ Idle æˆ– Run çŠ¶æ€ï¼Œ

å››ä¸ªåŠ¨ä½œå¯¹åº”çš„åŠ¨ç”»æ–‡ä»¶å¦‚ä¸‹ï¼Œå…¶ä¸­è·³è¿™ä¸ªåŠ¨ä½œåˆåˆ’åˆ†ä¸ºèµ·è·³ã€ç©ºä¸­çŠ¶æ€ã€ç»“æŸè·³è·ƒä¸‰ä¸ªçŠ¶æ€çš„åŠ¨ç”»ï¼š

- ThirdPersonIdle
- ThirdPersonJump_End
- ThirdPersonJump_Loop
- ThirdPersonJump_Start
- ThirdPersonRun
- ThirdPersonWalk


åœ¨ UE4 æä¾›çš„ç¬¬ä¸‰äººç§°å°„å‡»æ¸¸æˆæ¨¡æ¿ä¸­ï¼Œ*ThirdPersonCharacter* è§’è‰²è“å›¾ä¸­çš„åŠ¨ä½œè¾“å…¥ä»¥åŠè§¦å‘äº‹ä»¶åŒ…æ‹¬ï¼š

- InputAxis Turn -> Pawn -> AddControllerYawInput å·¦å³åè½¬åŠ¨ä½œï¼›
- InputAxis LookUp -> Pawn -> AddControllerPitchInput ä¸Šä¸‹ä¿¯ä»°åŠ¨ä½œï¼›
- InputAction Jump(Pressed) -> Pawn -> Jump è·³è·ƒåŠ¨ä½œï¼›
- InputAction Jump(Released) -> Pawn -> StopJumping åœæ­¢è·³è·ƒåŠ¨ä½œï¼›
- InputAxis MoveForward -> Pawn -> AddMovementInput å‰åç§»åŠ¨ï¼›
- InputAxis MoveRight -> Pawn -> AddMovementInput å·¦å³ç§»åŠ¨ï¼›

ä»¥ä¸Šæ˜¯é¼ æ ‡é”®ç›˜è¾“å…¥ï¼Œå¦å¤–è¿˜åŒ…å« Touch å’Œ Gamepad è¾“å…¥çš„å¤„ç†ï¼Œæ‘‡æ†è¾“å…¥çš„æ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿé‡ï¼Œä½¿ç”¨äº† *BaseTurnRate* å’Œ *BaseLookUpRate* æ¥æ§åˆ¶æ•æ„Ÿåº¦ã€‚ä¸ç¡¬ä»¶çš„è¾“å…¥ AxisValue å’Œå¼•æ“çš„æ—¶é—´å·® *GetWorldDeltaSeconds* ä¸‰ä¸ªé‡ç›¸ä¹˜å¾—åˆ°æœ€ç»ˆçš„è¾“å…¥å€¼ã€‚

è§’è‰²çš„å‰åç§»åŠ¨å’Œå·¦å³ç§»åŠ¨éƒ½æ‰§è¡Œ *AddMovementInput*ï¼Œç§»åŠ¨çš„æ–¹å‘è¾“å…¥çš„ *WorldDirction* æ¥æ§åˆ¶ã€‚å‘é‡æ¥æºï¼šGetControlRotation -> BreakRotator(Yaw) -> MakeRotator -> GetForwardVector/GetRightVectorã€‚



### âœ’ Mixamo å·¥å…·ä¸åŠ¨ç”»å¤ç”¨
- Nonlinear Animation using Mixamo (Blender) https://www.bilibili.com/video/BV1h5411J7UC?p=3
- Mixamo add-on for Blender Creating Control Rig https://substance3d.adobe.com/plugins/mixamo-in-blender/
- Mixamo add-on for Blender éƒ¨åˆ†æ¨¡å‹åŠ¨ç”»æ–‡ä»¶ https://pan.baidu.com/s/1aoQLtHfQ6jAnP4Yl3atgRA#æå–ç :1234
- https://minapecheux.com/website/2021/09/26/renaming-mixamo-rigs-with-blenders-python-api/
- åŠ¨ç”»é‡å®šä½ https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/AnimationRetargeting/
- é‡å®šå‘ç®¡ç†å™¨ https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/Persona/BasePoseManager/
- ä½¿ç”¨é‡å®šä½åçš„åŠ¨ç”» https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/AnimHowTo/Retargeting/

Adobe å¼€å‘äº† Mixamoï¼Œå®ƒå¯ä»¥è®©è§’è‰²åŠ¨èµ·æ¥ï¼Œç”¨äºæ¸¸æˆã€ç”µå½±ç­‰ï¼ŒåŒæ—¶æ¯” Blender è‡ªå¸¦çš„ Rigify æ’ä»¶æ›´è‡ªåŠ¨åŒ–ã€‚

Mixamo åŸºäº Web æä¾›ä¸‰ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼š

- ä¸‹è½½è§’è‰²æ¨¡å‹ï¼›
- ä¸‹è½½è§’è‰²åŠ¨ç”»ï¼›
- è‡ªåŠ¨ç»‘å®šéª¨éª¼ï¼›

ç½‘ç«™æä¾›ä¸Šç™¾ä¸ªç¤ºèŒƒæ¨¡å‹ä»¥åŠä¸Šåƒå¥—åŠ¨ç”»ç¤ºèŒƒï¼Œå®åœ¨æ˜¯å­¦ä¹ åŠ¨ç”»å§¿æ€çš„å¥½ææ–™ã€‚ä¹Ÿå¯ä»¥è‡ªè¡Œä¸Šä¼ äººç‰©çš„é™æ€æ¨¡å‹ï¼ˆæ²¡ç»‘å®šéª¨éª¼ï¼Œä¹Ÿæ²¡åŠ¨ç”»ï¼‰ï¼Œå°±èƒ½ç”¨åˆ° Mixamo å¼ºå¤§çš„è‡ªåŠ¨ç»‘å®šåŠŸèƒ½ã€‚


å¯¼å‡ºä¸‹è½½ Mixamo æ¨¡å‹åŠåŠ¨ç”»æ—¶ï¼Œä¸€èˆ¬åªéœ€è¦è®¾ç½® Formatï¼Œä¸€èˆ¬ä¸º FBX Binary å³å¯ã€‚Pose é€‰é¡¹ä¸€èˆ¬ä¸ç”¨è®¾ç½®ï¼Œé™¤éä½ ä¸æƒ³è¦æ¨¡å‹è’™çš®ï¼Œåªæƒ³è¦åŠ¨ç”»ï¼Œå¯ä»¥é€‰æ‹©é‡Œé¢çš„ Without Skin æˆ– No Character éƒ½æ˜¯ä¸€æ ·çš„æ„æ€ï¼Œå³ä¸å« Static Meshã€‚

åœ¨é€‰æ‹© Character åï¼Œåªè¦æ²¡æœ‰ç‚¹å‡» Animations åˆ—è¡¨ä¸­çš„åŠ¨ç”»ï¼Œæ­¤æ—¶å°±å¯ä»¥ä¸‹è½½è§’è‰²çš„ T-Pose å§¿æ€æ¨¡å‹ï¼Œæœ‰äº†è¿™ä¸ªæ¨¡å‹åï¼Œå†ä¸‹è½½å…¶å®ƒåŠ¨ç”»æ—¶ï¼Œå°±ä¸è¦å¸¦æ¨¡å‹ã€‚

åœ¨ UE4 ä¸­å¯¼å…¥æ²¡æœ‰è’™çš®çš„åŠ¨ç”»æ—¶ï¼Œä¼šå‡ºé”™ï¼Œæç¤º FBX å¯¼å‡ºæ’ä»¶å¯ç”¨ Export Smoothing Groupã€‚å¹¶ä¸”ï¼Œå¯¼å…¥åªå«åŠ¨ç”»ï¼Œä¸å«è’™çš®çš„ FBX æ–‡ä»¶æ—¶ï¼Œéœ€è¦æŒ‡å®š Mesh -> Skeletonï¼Œè¿™æ ·åŠ¨ç”»æ•°æ®æ‰èƒ½æœ‰æ•ˆåœ°ä½œç”¨äºéª¨æ¶å¯¹è±¡ã€‚å¯¼å…¥åŠ¨ç”»æ¨¡å‹æ—¶ï¼Œæ¸…é™¤æ‰ Mesh -> Skeletonï¼Œè®¾ç½®ä¸º Noneï¼Œè¿™æ ·å°±ä¼šè‡ªåŠ¨åˆ›å»ºå…³è¿çš„éª¨æ¶ã€‚

æ³¨æ„ï¼Œéª¨æ¶ç»“æ„ä¸€è‡´æ‰ä¼šæ­£ç¡®å¤ç”¨åŠ¨ç”»ï¼Œxbot å’Œ ybot ä½¿ç”¨çš„æ˜¯ç›¸åŒçš„éª¨æ¶ç»“æ„ï¼Œå®ƒä»¬çš„åŠ¨ç”»æ˜¯å¯ä»¥äº’ç”¨çš„ã€‚ä½†æ˜¯åƒ Mousey è¿™æ ·çš„æ¨¡å‹ï¼Œéª¨æ¶ç»“æ„ä¸åŒï¼Œæ‰€ä»¥ä¸èƒ½æ··ç”¨åŠ¨ç”»ã€‚

åœ¨ Blender ä¸Šä½¿ç”¨å¯¼å‡ºçš„åŠ¨ç”»æ¨¡å‹ï¼Œåªéœ€è¦è®¾ç½® Parent å…³ç³»å°±å¯ä»¥å°†æ¨¡å‹ç»‘å®šåˆ°éª¨æ¶ä¸Šã€‚æ“ä½œæ–¹æ³•ï¼šå…ˆé€‰æ‹©æ¨¡å‹ï¼Œå†é€‰æ‹©éª¨æ¶ï¼ŒæŒ‰ Ctrl-P å¼¹å‡º Parent è®¾ç½®èœå•ï¼Œé€‰æ‹© Armature Deform å…¶ä¸­ä¸€é¡¹å³å¯ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸‹è½½åˆ°çš„æ¨¡å¼éª¨æ¶ä½¿ç”¨äº† 90Â° X è½´çš„æ—‹è½¬ï¼Œå¹¶ä¸”è®¾ç½®äº† 0.01 å€çš„ç»½æ”¾ã€‚å¦‚æœï¼Œåœ¨å¯¹è±¡æ¨¡å¼ä¸‹æ‰§è¡Œ Alt-P ç›´æ¥å°†æ¨¡å‹ä»éª¨æ¶ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œå°†ä¼šæ”¾å¤§ 100 å€ã€‚æ‰€ä»¥ï¼Œè¦å…ˆå¯¹ Armature å¯¹åƒåº”ç”¨ç¼©æ”¾ Object -> Apply -> Scaleï¼ŒCtrl-Aï¼Œå°†ç¼©æ”¾å€¼å½’æ•´ä¸º 1ã€‚å¦‚æœå‡ºç°å¯¹è±¡åŸç‚¹æœ‰åç§»ï¼Œå¯ä»¥ç‰©ä½“æ¨¡å¼å’Œç¼–è¾‘æ¨¡å¼ä¸‹é€šè¿‡èœå•è®¾ç½®ç‰©ä½“åŸç‚¹ï¼ŒObject â€£ Set Originï¼Œé€šè¿‡ 3D æ¸¸æ ‡ç§»åŠ¨å¯¹è±¡åŸç‚¹ã€‚

ç”¨ Blender æ‰“å¼€ FBX æ–‡ä»¶å¯ä»¥çœ‹åˆ° X Bot æ¨¡å‹çš„éª¨æ¶ç»“æ„ä¸ Rigify çš„ Human (Meta-rig) éª¨æ¶ä¸åŒã€‚X Bot å’Œ Y Bot ä¸€æ ·ï¼Œä¸ºäº†ç®€åŒ–åŠ¨ç”»å§¿æ€è°ƒæ•´ï¼Œè‚¢ä½“å„ä¸ªéƒ¨åˆ†æ˜¯åˆ†ç¦»çš„ï¼Œå¹¶ä¸”ä½¿ç”¨åœ†çƒå‹çš„å…³èŠ‚éš”ç¦»ï¼Œåœ¨ Blender ä¸­å¯ä»¥å¾ˆæ–¹ä¾¿åœ°é€šè¿‡ Ctrl-L é€‰æ‹©åŒå±ä¸€ä¸ªè‚¢ä½“éƒ¨åˆ†çš„è¿æ¥é¡¶ç‚¹ï¼Œç»“åˆ Select Sharp Edges é€‰æ‹©å¤§äº 36Â° çš„é”åº¦å°±å¯ä»¥ç­›é€‰åˆ†ç¦»ã€‚

å¤§æ¦‚ç»“æ„å¦‚ä¸‹ï¼Œéª¨éª¼åç§°å‰ç¼€ mixamorig: å°±çœç•¥ä¸å†™äº†ï¼š

    +- Armature
       +- Animation 
       +- Pose 
       +- Armature 
       |  +- Hips
       |  |  +- Spine
       |  |  |  +- Spine1
       |  |  |     +- Spine2
       |  |  |        +- Neck
       |  |  |        |  +- Head
       |  |  |        |     +- LeftEye + RightEye
       |  |  |        +- LeftShoulder
       |  |  |        |  +- LeftArm 
       |  |  |        |     +- LeftForeArm 
       |  |  |        |        +- LeftHand 
       |  |  |        |           +- LeftHandThumb 1 ~ 3 
       |  |  |        |           +- LeftHandIndex 1 ~ 3 
       |  |  |        |           +- LeftHandMiddle 1 ~ 3 
       |  |  |        |           +- LeftHandRing 1 ~ 3 
       |  |  |        |           +- LeftHandPinky 1 ~ 3 
       |  |  |        +- RightShoulder
       |  |  |           +- RightArm 
       |  |  |              +- RightForeArm 
       |  |  |                 +- RightHand 
       |  |  |                    +- RightHandThumb 1 ~ 3 
       |  |  |                    +- RightHandIndex 1 ~ 3 
       |  |  |                    +- RightHandMiddle 1 ~ 3 
       |  |  |                    +- RightHandRing 1 ~ 3 
       |  |  |                    +- RightHandPinky 1 ~ 3 
       |  |  +- LeftUpLeg â€”> LeftLeg -> LeftFoot -> ToeBase
       |  |  +- RightUpLeg â€”> RightLeg -> RightFoot -> ToeBase
       +- Alpha_Joints 
       +- Alpha_Surface 

ä¸åŒæ¨¡å‹çš„ç½‘æ ¼ä½“ä¸åŒï¼ŒX Bot æ¨¡å‹çš„ç½‘æ ¼ä½“ä¸º Beta_Joints å’Œ Beta_Surfaceï¼ŒY Bot æ¨¡å‹çš„ç½‘æ ¼ä½“ä¸º Alpha_Joints å’Œ Alpha_Surfaceã€‚

å¦‚æœå†æ¬¡å¯¼å‡º FBXï¼Œå†å¯¼å…¥ UE4ï¼Œå°±ä¼šå‡ºç°åŠ¨ç”»æ˜¯èººåœ¨åœ°ä¸Šçš„ï¼Œå› ä¸º Armature æŒ‰ X è½´æ—‹è½¬äº† 90Â°ï¼Œéœ€è¦æ‰§è¡Œ Ctrl-A åº”ç”¨æ—‹è½¬ï¼Œå°†æ•°å€¼å½’ç½®ä¸º 0Â° æ—‹è½¬å†å¯¼å‡ºã€‚æˆ–è€…åœ¨ UE4 å¯¼å…¥æ—¶ï¼Œè®¾ç½® Transform -> Import Rotation æŒ‰ X è½´æ—‹è½¬ 90Â°ï¼Œä½†è¿™æ ·ä¼šä½¿ç”¨éª¨æ¶è¶´åœ¨åœ°é¢ä¸Šã€‚å¦å¤–ï¼ŒBlender æ–‡ä»¶å†…å¯èƒ½ä¿å­˜æœ‰å·²ç»åˆ é™¤æ‰ä¸å†ä½¿ç”¨çš„åŠ¨ç”»ï¼Œä½†æœªæ‰§è¡Œæ¸…ç† File -> Clean Up -> Recursive Unused Data-Blocksï¼Œåœ¨å¯¼å‡ºæ—¶ï¼Œå°±ä¼šå‡ºç°å¤šä½™çš„åŠ¨ç”»ã€‚

åœ¨ Blender ä¸­ä½¿ç”¨ Nonlinear Animation ç¼–è¾‘å™¨æ¥ä¸²è¿å¤šä¸ªåŠ¨ç”»ï¼š

- å¯¼å…¥ä¸‹è½½å¥½çš„ Mixamo åŠ¨ç”»ï¼›
- æ‰“å¼€ Nonlinear Animation ç¼–è¾‘å™¨ï¼›
- é€‰æ‹©åŠ¨ç”»æ–‡ä»¶å¯¹åº”çš„å¯¹è±¡ï¼Œå¹¶ä¸”åœ¨ NLA ç¼–è¾‘å™¨ä¸­ç›¸åº”çš„è½¨é“ä¼šé«˜äº®ä¸ºç™½è‰²ï¼›
- ç‚¹å‡»è½¨é“åç§°å³ä¾§çš„ Push Down Action å°†å…³é”®å¸§åŠ¨ç”»è½¬æ¢ä¸ºåŠ¨ç”»ç‰‡æ®µï¼›
- ä¸ºäº†æ–¹ä¾¿åç»­æ“ä½œï¼Œå¯ä»¥å…ˆé‡å‘½åè½¨é“å†è½¬æ¢ï¼›
- é€‰æ‹©è¦ç”¨æ¥æ‹¼æ¥åŠ¨ç”»å¯¹è±¡çš„éª¨æ¶ï¼Œå¹¶åœ¨ NLA ç¼–è¾‘å™¨ä¸­é€šè¿‡èœå•æ·»åŠ å·²ç»è½¬æ¢å¥½çš„åŠ¨ç”»ç‰‡æ®µï¼ŒAdd -> Add Action Stripï¼›
- é€‚å½“è°ƒæ•´åŠ¨ç”»ç‰‡æ®µçš„ä½ç½®ã€æ—¶é—´ç»½æ”¾ç­‰ç­‰å³å¯ï¼›

ä¸‹è½½åŠ¨ç”»æ–‡ä»¶å’Œ X Botã€Y Bot æ¨¡å‹çš„ T-Pose å§¿æ€åï¼Œæˆ‘è¯•äº† Blender 2.83 2.93 3.0 ç­‰ç‰ˆæœ¬çš„ Nonlinear Animation éçº¿åŠ¨ç”»ç¼–è¾‘ï¼Œè¯•å›¾å°†å¤šä¸ªåŠ¨ç”»ä¸²è¿èµ·æ¥ã€‚ä½†éƒ½ä¸è¡Œï¼Œä¸èƒ½å°†å¤šä¸ªåŠ¨ç”»åœ¨ X Bot æˆ– Y Bot æ¨¡å‹ä¸Šæ’­æ”¾ï¼Œè™½ç„¶å¯ä»¥å°† Action Strip æ”¾åˆ°è½¨é“ä¸Šï¼Œä½†æ²¡æœ‰åŠ¨ç”»ï¼Œå¹¶ä¸”ä¹Ÿæ²¡æœ‰æç¤ºç±»ä¼¼ä»¥ä¸‹çš„é”™è¯¯ä¿¡æ¯ï¼Œè¯´æ˜éª¨éª¼å’ŒåŠ¨ç”»æ˜¯åŒ¹é…çš„ï¼Œé—®é¢˜å…·ä½“åŸå› ä¸æ¸…æ¥šã€‚

æ¢ç§å¤„ç†åŠæ³•ï¼Œå°±æ˜¯å°† T-Pose æ¨¡å‹ä¸­çš„ç½‘æ ¼ä½“ç»‘å®šåˆ°åŠ¨ç”»å¯¹åº”çš„éª¨æ¶ä¸Šï¼Œé€šè¿‡ç½‘æ ¼ä½“å¯¹è±¡å±æ€§é¢æ¿æ“ä½œè®¾ç½®ï¼š

- Object Properties -> Parent è®¾ç½®ä¸ºä¸‹è½½å¥½å¹¶å¯¼å…¥çš„åŠ¨ç”»æ¨¡å‹æ–‡ä»¶å¯¹åº”çš„å¯¹è±¡ï¼ŒParent Type ä¿æŒè®¾ç½® Object å³å¯ï¼›
- Modifier Properties -> Armature -> Object åŒä¸Šï¼Œè®¾ç½®ä¸ºä¸‹è½½å¥½å¹¶å¯¼å…¥çš„åŠ¨ç”»æ¨¡å‹æ–‡ä»¶å¯¹åº”çš„å¯¹è±¡ï¼ŒBind To Vertex Groupsï¼›

> Action 'Cartwheel' does not specify what data-blocks it can be used on (try setting the 'ID Root Type' setting from the data-blocks editor for this action to avoid future problems)

ä»¥ä¸Šä¿¡æ¯æ„æ€æ˜¯ Cartwheel å³æ‰“ç¿»è½¦è¿™ä¸ªåŠ¨ç”»ç‰‡æ–­æœªæŒ‡å®šå¯ä»¥ä½¿ç”¨ä»€ä¹ˆæ ·çš„æ•°æ®å—ï¼Œå¯ä»¥å°è¯•é€šè¿‡ Data-blocks ç¼–è¾‘å™¨è®¾ç½®è¿™ä¸ªåŠ¨ç”»ç‰‡æ®µçš„ ID Root Typeã€‚å¯èƒ½æ˜¯éª¨æ¶ä¸åŠ¨ç”»ä¸åŒ¹é…ï¼Œéœ€è¦ä½¿ç”¨åŒä¸€è§’è‰²çš„åŠ¨ç”»ã€‚

å¦å¤–ï¼Œå¯¹äºä½¿ç”¨äº† Root Motion çš„åŠ¨ç”»ï¼Œå³å› è§’è‰²åŠ¨ä½œå¯¼è‡´éœ€è¦ç§»åˆ°æ¨¡å‹ä½ç½®ï¼Œå¦‚æœè¦æ‹¼æ¥å°±éœ€è¦å¤„ç†å‰åä¸¤ä¸ªåŠ¨ç”»çš„æ¨¡å‹ä½ç½®ã€‚å› ä¸ºï¼Œç°æˆçš„æ¨¡å‹åŠ¨ç”»éƒ½æ˜¯åŸºäºåŸç‚¹è¿›è¡Œçš„ï¼Œå½“ä¸€ä¸ªä½¿ç”¨ Root Motion çš„åŠ¨ç”»æ’­æ”¾åˆ°ç»“æŸæ—¶ï¼Œæ¨¡å‹å·²ç»åç§»åŸç‚¹ã€‚æ‰€ä»¥ï¼Œå½“ä¸‹ä¸€ä¸ªåŠ¨ç”»è·Ÿç€æ’­æ”¾æ—¶ï¼Œåˆç¬æ—¶å›åˆ°äº†åŸç‚¹ï¼Œè¿™é‡Œå°±æœ‰ä¸€ä¸ªä½ç§»å·®è¦å¤„ç†å¥½æ‰èƒ½å°†ä¸¤ä¸ªåŠ¨ç”»æ— ç¼æ‹¼æ¥èµ·æ¥ã€‚

ä¸€ä¸ªæ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªè¿‡åº¦åŠ¨ç”»ç‰‡æ–­ï¼Œå¹¶å°†ä½ç½®åç§»è®¾ç½®å¥½ï¼Œç„¶åå°†è¿™ä¸ªåç§»å€¼å¢åŠ åˆ°ä¸‹ä¸€ä¸ªåŠ¨ç”»ã€‚Nonlinear Animation é€šè¿‡ä¾§æ å·¥å…·é¢æ¿çš„ Strip -> Active Strip -> Action Blending çš„æ··åˆæ¨¡å¼ä¸º Add å®ç°ã€‚å› ä¸ºè¦ä½¿ç”¨åŠ¨ä½œæ··åˆï¼Œæ‰€ä»¥è¿‡åº¦ç”¨çš„åŠ¨ç”»éœ€è¦æ”¾åœ¨ä¸Šå±‚è½¨é“ï¼Œè€Œè¢«æ··åˆçš„åŠ¨ç”»æ”¾åœ¨ä¸‹é¢ã€‚


Mixamo Auto-Rigging è‡ªåŠ¨ç»‘å®šåŠŸèƒ½åªéœ€ç»™ä½ ä¸Šä¼ çš„æ¨¡å¼æŒ‡å®š Chinã€Wristsã€Elbowsã€Kneesã€Groin ç­‰å…³é”®éƒ¨ä½å³å¯è‡ªåŠ¨ç»™æ¨¡å‹ç»‘å®šéª¨éª¼ï¼Œå¹¶ç”Ÿæˆç¤ºèŒƒåŠ¨ç”»ã€‚å°½ç®¡æä¾›çš„éª¨æ¶ç»“æ„æ¯”è¾ƒç²¾ç®€ï¼Œä½†æ˜¯ç»‘å®šåæä¾›çš„æ§åˆ¶å™¨å¾ˆå®Œå–„ï¼Œæä¾›å››è‚¢çš„ IK åå‘è§£ç®—çº¦æŸï¼Œå¤´éƒ¨ã€é¢ˆéƒ¨ã€èƒ¸éƒ¨ã€è…°éƒ¨ã€èº¯å¹²ã€è…¿éƒ¨å¯çµæ´»æ§åˆ¶ã€‚

Mixamo è‡ªåŠ¨ç»‘å®šç³»ç»Ÿä»…é€‚ç”¨äºäººå½¢è§’è‰²ï¼Œå¹¶å…·æœ‰ä¸€äº›ç‰¹å®šè¦æ±‚ï¼š

- ç¡®ä¿è§’è‰²æ˜¯ç±»äººå½¢è§’è‰²ï¼Œå¤´éƒ¨ã€èº«ä½“ã€æ‰‹è‡‚å’Œè…¿éƒ¨åŒºåŸŸå¯æ˜æ˜¾åŒºåˆ†ï¼Œæœ€å¥½æ˜¯ T-pose ä¸”æ‰‹æŒ‡è¦å‰å¼€ã€‚å¦‚æœè§’è‰²å½¢å˜è¿‡å¤§ï¼Œåˆ™è‡ªåŠ¨ç»‘å®šç³»ç»Ÿå¯èƒ½æ— æ³•æ­£å¸¸å·¥ä½œã€‚
- ç¡®ä¿è§’è‰²æ²¡æœ‰å¤šä½™çš„é™„å±ç‰©æˆ–é“å…·ã€‚ä¾‹å¦‚ï¼Œå…¶ä»–è‚¢ä½“ã€ç¿…è†€ã€å°¾å·´ã€å¤§å‹å¤´å‘å’Œè¡£ç‰©ç­‰ã€‚
- ç¡®ä¿è§’è‰²å¤„äºé»˜è®¤å§¿åŠ¿æˆ–è‡ªç„¶å§¿åŠ¿ã€‚å¦‚æœè§’è‰²éå¸¸ä¸å¯¹ç§°æˆ–åœ¨ç»‘å®šä¹‹å‰å·²æ‘†å¥½å§¿åŠ¿ï¼Œåˆ™è‡ªåŠ¨ç»‘å®šå¯èƒ½ä¸èµ·ä½œç”¨ã€‚
- ç¡®ä¿æ–‡ä»¶ä¸­æ²¡æœ‰å…¶ä»–å†…å®¹ã€‚å¦‚å…¶ä»–è¾…åŠ©å¯¹è±¡ã€ç›¸æœºæˆ–åœºæ™¯å¯¹è±¡ä¼šå¯¼è‡´è‡ªåŠ¨ç»‘å®šä¸èµ·ä½œç”¨ã€‚
- ç¡®ä¿ä»»ä½•éƒ¨ä»¶ä¹‹é—´æ²¡æœ‰ç©ºéš™ã€‚ä¾‹å¦‚ï¼Œè‡ªåŠ¨ç»‘å®šä¸é€‚ç”¨äºå¤´éƒ¨ä¸èº«ä½“åˆ†ç¦»çš„æƒ…å†µã€‚
- ç¡®ä¿è§’è‰²åœ¨åœºæ™¯ä¸­å±…ä¸­ã€‚å°†è§’è‰²è®¾ç½®ä¸ºä¸–ç•Œçš„ï¼ˆ0,0,0ï¼‰æ—¶ï¼Œè‡ªåŠ¨ç»‘å®šæ•ˆæœæœ€ä½³ã€‚è¿™æ ·å¯ä»¥é˜²æ­¢ç”±äºå•ä½å·®å¼‚è€Œå‘ç”ŸåŠ¨ç”»åç§»ã€‚
- ç¡®ä¿è§’è‰²ç½‘æ ¼çš„è´¨é‡ï¼ˆå¸ƒçº¿è‰¯å¥½ä¸”æ— é”™è¯¯ï¼‰ã€‚è‡ªåŠ¨ç»‘å®šåœ¨ç½‘æ ¼è´¨é‡é«˜çš„è§’è‰²ä¸Šæ‰§è¡Œæ›´å¯é ï¼Œå¹¶æä¾›æ›´é«˜è´¨é‡çš„åŠ¨ç”»ã€‚

ç›®å‰æä¾› Skeleton LOD é€‰é¡¹æœ‰å››ä¸ªï¼Œå³éª¨æ¶ç²¾ç»†åº¦ï¼š

- Standard Skeleton (65)
- 3 Chain Fingers (49)
- 2 Chain Fingers (41)
- No Fingers (25)

å¦‚æœä½¿ç”¨ Mixamo for Blender æ’ä»¶è¿›è¡Œéª¨æ¶ç»‘å®šï¼Œåˆ™éœ€è¦æ³¨æ„ï¼Œéª¨éª¼å‘½åè¦ä½¿ç”¨ Blender ä¹ æƒ¯ã€‚å¦‚æœç›´æ¥ä½¿ç”¨ Mixamo ä¸Šä¸‹è½½åˆ°çš„æ¨¡å‹ï¼Œå…¶éª¨éª¼åç§°å°±éœ€è¦ä¿®æ”¹ä¸€ä¸‹ï¼Œå¦åˆ™ç»‘å®šæ—¶ add_leg("Left") ä¼šå‡ºç°é”™è¯¯ã€‚åˆ—å¦‚ï¼Œéª¨éª¼å‘½ *mixamorig:LeftArm* å°±è¦æ”¹å˜ä¸º *Arm.L* è¿™æ ·çš„æ ¼å¼ã€‚å› ä¸º Blender ä½¿ç”¨ `.L` å’Œ `.R` è¿™æ ·çš„åç¼€ã€‚å…¶å®ï¼Œåªè¦å°† Mixamo Rig å‰ç¼€éƒ¨åˆ†åˆ é™¤å³å¯ï¼ŒåŒ…æ‹¬åˆ†å·ã€‚

æœ‰æ•ˆåˆ†éš”ç¬¦å·åŒ…æ‹¬ï¼š

- (nothing): handLeft â€“> handRight
- (underscore): hand_L â€“> hand_R
- (dot): hand.l â€“> hand.r
- (dash): hand-l â€“> hand-r
- (space): hand LEFT â€“> hand RIGHT

Blender æœ¬èº«å°±å¯ä»¥æ‰¹é‡é‡å‘½åï¼Œå¦‚æœé‡å‘½åçš„è§„åˆ™ä¸æ˜¯ç‰¹åˆ«å¤æ‚ï¼Œå®Œå…¨æ— é¡»ä½¿ç”¨ä¸Šè¿°æ’ä»¶ã€‚å¿«æ·é”® Ctrl-F2 è°ƒå‡ºæ‰¹é‡é‡å‘½åé¢æ¿ Edit -> Batch Rename... å¹¶ä¸”æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ã€‚æ³¨æ„ï¼Œé‡å‘½åæ—¶ï¼Œè¦æŒ‡å®šç±»å‹ä¸º Bonesï¼Œä¸æ˜¯ Armatures ä¹Ÿä¸æ˜¯ Objectsã€‚

ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¯ä»¥å¾ˆå®¹æ˜“å°†æ‰€æœ‰éª¨éª¼åç§°æ‰¹é‡æ”¹æ­£ï¼Œåˆ—å¦‚ `mixamorig:Right(.*)` æ›¿æ¢ä¸º `\1_R`ï¼Œå°±å¯ä»¥å¯ä»¥å°†å³ä¾§æ‰€æœ‰éª¨éª¼çš„åå­—æ”¹æˆ `_R` åç¼€ï¼Œå¹¶ä¸”åˆ æ‰ Mixamo Rig å‰ç¼€ã€‚æ³¨æ„è¦å°† Batch Rename é¢æ¿ä¸­çš„ Find å’Œ Replace å³ä¾§çš„ * ç‚¹äº®æ‰æ˜¯æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ï¼Œ`\1` è¡¨ç¤ºå°†æ­£åˆ™è¡¨è¾¾å¼ä¸­ç¬¬ä¸€å¯¹åœ†æ‹¬å·åŒ¹é…åˆ°çš„å†…å®¹ã€‚æ¯”å¦‚ï¼Œå¯ä»¥å°† `(Right|Left)(.*)` æ›¿æ¢ä¸º `\2_\1`ï¼Œè¿™æ ·å°±ç›´æ¥å°†å·¦å³å‰ç¼€æ”¹ä¸ºåç¼€ã€‚

æ›¿æ¢é”™äº†ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œå¯ä»¥æ’¤æ¶ˆï¼Œä½†æ˜¯å…³è”çš„é¡¶ç‚¹ç»„å‘½åä¹Ÿè¦ç¡®è®¤ä¸€å¹¶å¤„ç†åˆ°ä½ï¼Œæ‰€ä»¥å°½é‡ä¸è¦å‡ºé”™ã€‚åœ¨éª¨æ¶ç¼–è¾‘æ¨¡å¼ä¸‹ï¼Œé€‰ä¸­æ‰€æœ‰éª¨éª¼å†è¿›è¡Œæ“ä½œã€‚

ä¹Ÿå¯ä»¥ä½¿ç”¨ Mixamo Rig Renamer æ’ä»¶ï¼Œå®ƒä¼šå¤„ç†ï¼š

- éª¨éª¼æ”¹ååŠ åç¼€ .L/.R ç­‰ï¼›
- ä¿®æ”¹ç›¸åº”çš„åŠ¨ç”»æ›²çº¿æ•°æ®ï¼›
- é‡æ–°åˆ†é…åŠ¨ç”»æ•°æ®ç»™ç›¸åº”çš„éª¨éª¼ï¼›

éƒ¨åˆ†è½¯ä»¶ï¼Œå¦‚ Maya ä½¿ç”¨ FBX å¯¼å‡ºæ ¼å¼ä¸­ï¼Œå­˜åœ¨å…³èŠ‚è€Œä¸æ˜¯éª¨éª¼ã€‚å…³èŠ‚ Joints ç­‰æ•ˆä¸€ä¸ªåæ ‡ç‚¹ï¼Œæœ‰ä½ç½®ã€æ–¹å‘ã€å¤§å°ï¼Œä½†æ²¡æœ‰é•¿åº¦ã€‚Blender çš„éª¨éª¼è‡ªç„¶æœ‰é•¿åº¦ï¼Œå› ä¸ºå®ƒä»¬å®é™…ä¸Šæ˜¯ä¸¤ä¸ªç›¸è¿çš„å…³èŠ‚ã€‚å®é™…ä¸Šï¼Œåˆ›å»ºå˜æ¢çŸ©é˜µå¹¶ä¸éœ€è¦éª¨éª¼çš„å°–ç«¯ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªç‰¹å®šäºæ…æ‹Œæœºçš„è®¾è®¡å†³ç­–ã€‚
å› æ­¤ï¼Œå¯¼å‡ºæ—¶ï¼Œæœªè¿æ¥çš„éª¨éª¼å°†ä¼šå¢åŠ ä¸€ä¸ªåç¼€ä¸º `_end` çš„éª¨éª¼å……å½“å…³èŠ‚ã€‚

åœ¨ Blender å¯¼å…¥ FBX æ–‡ä»¶æ—¶ï¼Œæœ‰ä¸€ä¸ªé€‰é¡¹å¯ä»¥è‡ªåŠ¨åˆ é™¤æœ«ç«¯å…³èŠ‚ï¼šArmature -> Ignore Leaf Bonesï¼Œå‹¾é€‰åå¯¼å…¥çš„éª¨æ¶å°±ä¸ä¼šåŒ…å«éª¨éª¼é“¾æœ€åä¸€ä¸ªåŠ `_end`åç¼€çš„éª¨éª¼ã€‚

å®‰è£…å¥½ Mixamo æ’ä»¶åå¹¶å¯ç”¨ï¼Œé€‰æ‹©ç»™æ¨¡å‹è®¾ç½®çš„éª¨æ¶å¯¹è±¡ï¼ŒæŒ‰ N æ‰“å¼€ä¾§æ å·¥å…·ï¼Œæ‰¾åˆ°æ’ä»¶é¢æ¿ï¼Œå¹¶æ‰§è¡Œ Mixamo Control Rig -> Create Control Rig åˆ›å»ºç»‘å®šæ§åˆ¶å™¨å¯¹è±¡ï¼Œä½¿ç”¨ Zero Out Rig å½’ä½éª¨æ¶æ§åˆ¶å™¨ï¼ŒåŒæ—¶åŠ¨ç”»æ•°æ®ä¹Ÿæ¸…é™¤ã€‚

- Apply Animationï¼Œç”³è¯·åŠ¨ç”»ç¤ºèŒƒç»‘å®šï¼›
- IK Arms ç»‘å®šæ‰‹éƒ¨ IK æ§åˆ¶å™¨ï¼›
- IK Legs ç»‘å®šè…¿éƒ¨ IK æ§åˆ¶å™¨ï¼›

è§£å†³éª¨éª¼å‘½åé—®é¢˜åï¼ŒMixamo æ’ä»¶ç»‘å®šæ—¶ï¼Œè¿˜æ˜¯ä¸æ­£ç¡®ï¼Œæ²¡æœ‰ç”Ÿæˆ IK Hand æˆ– IK Legã€‚ä½†æ˜¯ä½¿ç”¨ Mixamo ç½‘ç«™ç»è¿‡ Auto-Rigging ç»‘å®šçš„æ¨¡å‹å´å¯ä»¥åœ¨å¤„ç†å¥½éª¨éª¼åç§°åæ­£å¸¸ç»‘å®šæ§åˆ¶å™¨ã€‚ä¼°è®¡æ˜¯ä½¿ç”¨ Blender å¯¼å‡ºçš„æ¨¡å‹ï¼Œç»™éª¨æ¶æ·»åŠ äº†æœ«ç«¯çš„ `_end` éª¨éª¼ï¼Œå¯¼è‡´éª¨æ¶ç»“æ„æœ‰äº†å˜åŒ–ã€‚

å‡ºç°çº¦æŸå™¨å±æ€§ä¸å­˜åœ¨ï¼Œå‡ºé”™è„šæœ¬ç‰‡æ®µå¦‚ä¸‹ï¼Œæ˜¯å‰é¢å› ä¸ºä»€ä¹ˆåŸå› æ²¡æœ‰ç»™åŸå§‹éª¨æ¶è®¾ç½®çº¦æŸå™¨å¯¼è‡´åç»­è®¿é—®å‡ºé”™ï¼š

```py
# C:\Users\...\AppData\Roaming\Blender Foundation\Blender\2.93\scripts\addons\mixamo_rig\mixamo_rig.py
# Foot Ctrl IK
c_foot_ik_pb = get_pose_bone(c_foot_ik_name)

cns_name = "Child Of"
cns = c_foot_ik_pb.constraints.get(cns_name)
# in execute _make_rig(self) -> add_leg(left) -> here
# AttributeError:'NoneType' object has no attribute 'constraints'
if cns == None:
    cns = c_foot_ik_pb.constraints.new("CHILD_OF")
    cns.name = cns_name
cns.target = rig
cns.subtarget = "Ctrl_Master"
```

æµ‹è¯•å‘ç°ä¸‹è½½åˆ°çš„ X Bot å’Œ Y Bot æ¨¡å‹åŠ¨ç”»åŸºæœ¬ä¸èƒ½æ­£å¸¸å®Œæˆ Mixamo Rig ç»‘å®šï¼Œé™¤éç»è¿‡ç½‘ç«™è¿›è¡Œ Aoto-Rigging åï¼Œä½†æ˜¯å®˜ç½‘ä¸Šä¸‹è½½åˆ°çš„ Mousey æ¨¡å‹çš„åŠ¨ç”»å´æ˜¯å¯ä»¥æ­£å¸¸å®Œæˆç»‘å®šã€‚è€Œä¸”å¤§å¤šæ•°éƒ½æ˜¯ç¼ºå¤±è…¿éƒ¨ IK æ§åˆ¶å™¨ï¼Œæ€»ä¹‹æ˜¯æœ‰æŒ‘é£Ÿç°è±¡ã€‚

æ­£ç¡®ç»‘å®š Rig æ§åˆ¶å™¨åä¼šåˆ é™¤åŸæ¥éª¨æ¶ä¸­çš„æœ«ç«¯éª¨éª¼ï¼Œå¹¶ç»™åŸéª¨æ¶æ·»åŠ çº¦æŸå™¨ï¼Œå¤§æ¦‚ä¼šæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

- Animation
    - Drivers æ›²çº¿é©±åŠ¨åŠ¨ç”»
- Bone Groups éª¨éª¼åˆ†ç»„æ§åˆ¶
    - master
    - root_master
    - body_mid
    - neck
    - head
    - body_left
    - body_right
- Armature å§¿æ€æ§åˆ¶éª¨æ¶
    - Hips åŸéª¨æ¶æ ¹éª¨éª¼ä¸‹æ·»åŠ  Copy Constraintsï¼›
    - Ctrl_Master æ§åˆ¶æ•´ä½“ç§»åŠ¨ï¼›
    - Ctrl_ArmPole_IK_Left æ§åˆ¶æ‰‹è‚˜ Elbows å¾„å‘æ‰­è½¬ï¼›
    - Ctrl_Hand_IK_Left æ§åˆ¶æ‰‹æŒéƒ¨åˆ†çš„ IKï¼›
    - Ctrl_ArmPole_IK_Right æ§åˆ¶æ‰‹è‚˜ Elbows å¾„å‘æ‰­è½¬ï¼›
    - Ctrl_Hand_IK_Right æ§åˆ¶æ‰‹æŒéƒ¨åˆ†çš„ IKï¼›
    - Ctrl_Foot_IK_Left æ§åˆ¶è„šæŒéƒ¨åˆ†çš„ IKï¼›
    - Ctrl_LegPole_IK_Left æ§åˆ¶è†å…³èŠ‚ Knees å¾„å‘æ‰­è½¬ï¼›
    - Ctrl_Foot_IK_Right æ§åˆ¶è„šæŒéƒ¨åˆ†çš„ IKï¼›
    - Ctrl_LegPole_IK_Right æ§åˆ¶è†å…³èŠ‚ Knees å¾„å‘æ‰­è½¬ï¼›

Mixamo æ’ä»¶é¢æ¿ä¸­çš„ Animation -> Source Skeleton å¯ä»¥ç”¨æ¥æŒ‡å®šè¦å¯¼å…¥åˆ° Mixamo Control Rig çš„åŠ¨ç”»æ¥æºçš„ï¼Œå¯ä»¥ä» Mixamo ç½‘ç«™ä¸Šä¸‹è½½ç›¸åŒè§’è‰²çš„ FBX åŠ¨ç”»æ–‡ä»¶ã€‚å¤åˆ»åŠ¨ç”»å‰ï¼Œå…ˆæ‰§è¡Œæ‰§è¡Œ Zero Out Rig å°†æœ¬èº«çš„å…³é”®å¸§åŠ¨ç”»çŠ¶æ€å½’é›¶ã€‚æ³¨æ„ï¼Œä¸è¦åœ¨ç¼–è¾‘å…¶å®ƒéª¨æ¶æ—¶æ‰§è¡Œï¼Œä¼šè¯¯åˆ å…¶å®ƒéª¨éª¼åŠ¨ç”»ã€‚è€Œä¸”åªèƒ½å¯¹ Timeline çš„å…³é”®å¸§åŠ¨ç”»æ“ä½œï¼Œå¯¹ NLA ä¸­çš„åŠ¨ç”»ç‰‡æ®µæ— æ•ˆã€‚

å¦å¤–ï¼Œå› ä¸º Mixamo æä¾›çš„éª¨éª¼å‘½åä¼¼å«æœ‰å†’å·å’Œå‰ç¼€ï¼Œéœ€è¦å…ˆå°†å¯¼å…¥çš„åŠ¨ç”»éª¨éª¼æ”¹åï¼Œå¹¶ä¸”è¦ä¸ Mixamo Control Rig ç»‘å®šçš„éª¨éª¼å‘½åä¸€è‡´ï¼Œå¦åˆ™åŠ¨ç”»å¤åˆ¶ä¸ä¸€è‡´ã€‚



å¯¹äºåˆ¶ä½œå¥½çš„åŠ¨ç”»ï¼Œå½“ç„¶æ˜¯å¸Œæœ›å°½é‡å¤ç”¨åˆ°æ›´å¤šçš„æ¨¡å‹ä¸Šï¼Œé¿å…é‡å¤è°ƒæ•´åŒæ ·çš„åŠ¨ç”»å¸¦æ¥çš„é¢å¤–å·¥ä½œé‡ã€‚éª¨æ¶å¯ä»¥é€šè¿‡ *Skeleton Mesh* åˆ›å»ºï¼Œä¹Ÿå¯ä»¥æ˜ å°„åˆ°å¦ä¸€ä¸ªéª¨æ¶ Retarget to Another Skeletonï¼Œè€Œéª¨æ¶ç½‘æ ¼ä¹Ÿå¯ä»¥é‡æ–°åˆ†é…ä¸€å‰¯éª¨æ¶ï¼Œé€šè¿‡å†…å®¹æµè§ˆå™¨å³é”®èœå•æ“ä½œ Skeleton -> Assign Skeletonã€‚


åŠ¨ç”»é‡å®šä½ *Retarget* æ˜¯ä¸€ç§å…è®¸åœ¨å…±ç”¨ç›¸åŒéª¨æ¶èµ„æºä½†æ¯”ä¾‹å·®å¼‚å¾ˆå¤§çš„è§’è‰²ä¹‹é—´å¤ç”¨åŠ¨ç”»çš„åŠŸèƒ½ã€‚åŠ¨ç”»é‡å®šä½æ˜¯å¯¹ç°æœ‰åŠ¨ç”»ç¨åŠ ä¿®æ”¹åç”¨äºå¤šä¸ªè§’è‰²çš„è¿‡ç¨‹ï¼Œå®ƒä½¿ä½ æ— éœ€åˆ›å»ºå…¨æ–°çš„åŠ¨ç”»ï¼Œå› ä¸ºä½ å¯ä»¥åœ¨å¤šä¸ªè§’è‰²é—´å…±äº«åŠ¨ç”»èµ„æºã€‚æ¯”å¦‚ï¼Œå¸Œæœ›åœ¨åŸºæœ¬è§’è‰²ã€çŸ®å£®è§’è‰²å’Œé«˜ç˜¦è§’è‰²ä¹‹é—´å…±äº«åŠ¨ç”»ã€‚åœ¨åº”ç”¨é‡å®šä½å‰ï¼Œæ‚¨å°±å¯ä»¥åœ¨ä»»ä½•å…±ç”¨ç›¸åŒéª¨æ¶èµ„æºçš„éª¨éª¼ç½‘æ ¼ä¹‹é—´ä½¿ç”¨åŠ¨ç”»ã€‚ä½†æ˜¯ï¼Œå¦‚æœè§’è‰²èº«ææ¯”ä¾‹å¦‚ä¸Šå›¾æ‰€ç¤ºæœ‰å·®å¼‚ï¼ŒçŸ®ä¸ªè§’è‰²ä¼šè¢«æ‹‰é•¿ï¼Œé«˜ä¸ªè§’è‰²åˆä¼šè¢«å‹çŸ­ï¼Œè¿™éƒ½æ˜¯ç³»ç»Ÿä¸ºäº†ä½¿å…¶ç¬¦åˆåŸºæœ¬è§’è‰²çš„éª¨éª¼æ¯”ä¾‹è€Œè¿›è¡Œçš„æ›´æ”¹ã€‚

é€šè¿‡é‡å®šä½ï¼Œå¯ä»¥é˜²æ­¢ç”ŸæˆåŠ¨ç”»çš„éª¨æ¶åœ¨ä½¿ç”¨æ¥è‡ªä¸åŒå¤–å½¢çš„è§’è‰²çš„åŠ¨ç”»æ—¶ä¸¢å¤±æ¯”ä¾‹æˆ–äº§ç”Ÿä¸å¿…è¦çš„å˜å½¢ã€‚ é€šè¿‡åŠ¨ç”»é‡å®šä½ï¼Œè¿˜å¯ä»¥åœ¨ä½¿ç”¨ ä¸åŒéª¨æ¶ èµ„æºçš„è§’è‰²ä¹‹é—´å…±äº«åŠ¨ç”»ï¼Œå‰ææ˜¯ä»–ä»¬ä½¿ç”¨ç›¸ä¼¼çš„éª¨éª¼å±‚çº§ï¼Œå¹¶ä½¿ç”¨åä¸º ç»‘å®šï¼ˆRigï¼‰ çš„å…±äº«èµ„æºåœ¨éª¨æ¶ä¹‹é—´ä¼ é€’åŠ¨ç”»æ•°æ®ã€‚

å­˜åœ¨ä¸¤ç§å½¢å¼çš„åŠ¨ç”»é‡å®šä½ï¼Œåœ¨ç¬¬ä¸€ç§å½¢å¼ä¸­ï¼Œä½ è¦ä¸ä¹‹å…±äº«åŠ¨ç”»çš„è§’è‰²çš„éª¨æ¶ä½¿ç”¨äº†ä¸æœ€åˆä¸ºå…¶åˆ›å»ºåŠ¨ç”»çš„ç›®æ ‡è§’è‰² ç›¸åŒçš„éª¨æ¶ã€‚ åœ¨å¦ä¸€ç§å½¢å¼çš„åŠ¨ç”»é‡å®šä½ä¸­ï¼Œéœ€è¦ä½¿ç”¨ç§°ä¸º éª¨æ¶ç»‘å®šï¼ˆRigï¼‰ çš„ä¸­é—´å¯¹è±¡ï¼Œå®ƒä½¿ä½ èƒ½å¤Ÿå¯¹æ¥è‡ªä¸€ä¸ªè§’è‰²çš„éª¨æ¶çš„åŠ¨ç”»è¿›è¡Œé‡å®šä½ï¼Œç„¶åå°†è¯¥éª¨æ¶çš„éª¨éª¼ä¿¡æ¯ä¼ é€’ç»™ å¦ä¸€ä¸ªéª¨æ¶ï¼ˆä½¿ç”¨è¿™ä¸¤ä¸ªéª¨æ¶å…±äº«çš„éª¨æ¶ç»‘å®šï¼‰ã€‚

åŠ¨ç”»ç»‘å®šåˆ°éª¨æ¶èµ„æºã€‚éª¨æ¶èµ„äº§å…¶å®å°±æ˜¯ä¸€ä¸ªéª¨éª¼åç§°å’Œå±‚æ¬¡ç»“æ„æ•°æ®çš„åˆ—è¡¨ï¼Œä½†å®ƒä¹Ÿå­˜å‚¨äº†æ¥è‡ªç”¨äºå®šä¹‰éª¨æ¶èµ„äº§çš„åŸå§‹éª¨éª¼ç½‘æ ¼çš„åˆå§‹æ¯”ä¾‹ã€‚æ­¤æ•°æ®æ˜¯ä»¥éª¨éª¼å¹³ç§»æ•°æ®çš„å½¢å¼å­˜å‚¨çš„ã€‚ç‰¹åˆ«è¦æ³¨æ„çš„æ˜¯ï¼Œé‡å®šä½ç³»ç»Ÿåªä¼šé‡å®šä½éª¨éª¼çš„å¹³ç§»åˆ†é‡ã€‚éª¨éª¼çš„æ—‹è½¬å§‹ç»ˆæ¥è‡ªåŠ¨ç”»æ•°æ®ã€‚

å› ä¸ºä½¿ç”¨äº†åŸå§‹éª¨éª¼ç½‘æ ¼å®šä¹‰éª¨æ¶èµ„äº§çš„æ¯”ä¾‹ï¼Œæ‰€ä»¥ä½¿ç”¨è¯¥éª¨æ¶èµ„äº§ä½†æœ‰ä¸åŒæ¯”ä¾‹çš„å…¶ä»–ä»»ä½•éª¨éª¼ç½‘æ ¼ï¼ˆä¾‹å¦‚æ¯”åŸå§‹ç½‘æ ¼çŸ­å¾—å¤šçš„ç½‘æ ¼ï¼‰éƒ½éœ€è¦ç»è¿‡é‡å®šä½æ‰èƒ½æ­£ç¡®å·¥ä½œã€‚å¦‚æœä¸ç»è¿‡è¿™ä¸€æ­¥ï¼Œå…·æœ‰ä¸åŒæ¯”ä¾‹çš„éª¨éª¼ç½‘æ ¼ä¼šå°è¯•ä½¿ç”¨åŸå§‹ç½‘æ ¼çš„å¹³ç§»æ•°æ®ï¼Œå¯¼è‡´æˆ‘ä»¬åœ¨æœ¬æ–‡å¼€å¤´çœ‹åˆ°çš„å„ç§é”™è¯¯ã€‚

éª¨æ¶ç¼–è¾‘å™¨ ä¸­çš„éª¨æ¶æ ‘æä¾›äº†å‡ ä¸ªè®¾ç½®ï¼Œç”¨äºæ›´æ”¹å¤„ç†éª¨éª¼ä¹‹é—´å¹³ç§»é‡å®šä½çš„æ–¹å¼ã€‚æœ‰ 3 ç§ä¸åŒè®¾ç½®å¯ç”¨äºéª¨éª¼å¹³ç§»é‡å®šä½ï¼š

- Animation â€”â€” éª¨éª¼å¹³ç§»æ¥è‡ªåŠ¨ç”»æ•°æ®ï¼Œä¸åšæ”¹å˜ã€‚
- Skeleton â€”â€” éª¨éª¼å¹³ç§»æ¥è‡ªç›®æ ‡éª¨æ¶çš„ç»‘å®šå§¿åŠ¿ã€‚
- AnimationScaled â€”â€” éª¨éª¼å¹³ç§»æ¥è‡ªåŠ¨ç”»æ•°æ®ï¼Œä½†æŒ‰éª¨æ¶çš„æ¯”ä¾‹è°ƒæ•´ã€‚è¿™æ˜¯ç›®æ ‡éª¨æ¶ï¼ˆæ’­æ”¾åŠ¨ç”»çš„éª¨æ¶ï¼‰ä¸æºéª¨æ¶ï¼ˆåˆ¶ä½œåŠ¨ç”»çš„éª¨æ¶ï¼‰çš„éª¨éª¼é•¿åº¦ä¹‹æ¯”ã€‚

æ­¤å¤–ï¼Œå¯¹äºåŠ¨ç”»é‡å®šä½ï¼Œä½¿ç”¨é‡å®šä½åŠ¨ç”»å’Œéé‡å®šä½åŠ¨ç”»æ²¡æœ‰æ˜¾è‘—çš„æ€§èƒ½å·®å¼‚ã€‚ä½¿ç”¨åŠ¨ç”»é‡å®šä½çš„å¥½å¤„æ˜¯å¢åŠ ç‹¬ç‰¹è§’è‰²çš„æ•°é‡ï¼Œåˆä¸å¿…åˆ›å»ºå…¨æ–°çš„ä¸€å¥—åŒ¹é…åŠ¨ç”»ï¼Œé‡æ–°åšåŠ¨ç”»å¯èƒ½ä¼šä¸¥é‡å ç”¨æ‚¨çš„åŠ¨ç”»å­˜å‚¨é¢„ç®—ã€‚

åœ¨ä¸ºä¸å…±äº«ç›¸åŒéª¨æ¶èµ„æºçš„è§’è‰²å¤„ç†åŠ¨ç”»é‡å®šä½æ—¶ï¼Œéœ€è¦æŒ‡å®šä¸€ä¸ªç‰¹æ®Šçš„èµ„æºï¼Œåä¸ºç»‘å®šï¼ˆRigï¼‰ï¼Œå®ƒè´Ÿè´£å¤„ç†éª¨æ¶ä¹‹é—´ä¼ é€’çš„åŠ¨ç”»æ•°æ®ã€‚ä¸å„ä¸ªè§’è‰²å…³è”çš„éª¨æ¶èµ„æºé€šè¿‡å…±äº«çš„ç»‘å®šèµ„æºé€šä¿¡ï¼Œä»¥æ­£ç¡®åœ°å°†å˜æ¢æ•°æ®ä»ä¸€ä¸ªæºä¼ é€’åˆ°å…¶é¢„å®šç›®æ ‡ã€‚

ç»‘å®šï¼ˆRigï¼‰å¯ä»¥åœ¨éª¨æ¶ç¼–è¾‘å™¨ä¸­çš„é‡å®šä½ç®¡ç†å™¨ä¸­æŒ‡å®šï¼ŒåŒä¸€ä¸ªç»‘å®šéœ€è¦æŒ‡å®šç»™ä¸¤ä¸ªéª¨æ¶èµ„æºã€‚

åœ¨åŠ¨ç”»é‡å®šä½ä¸­ä½¿ç”¨çš„å¦ä¸€ä¸ªå·¥å…·æ˜¯é‡å®šä½ç®¡ç†å™¨ï¼Œå®ƒå¯ä»¥è®©æ‚¨ï¼š

- Manage Retarget Source â€”â€” å¦‚æœæ¯ä¸ªéª¨æ¶æœ‰ä¸åŒæ¯”ä¾‹çš„ç½‘æ ¼ä½“ï¼Œå¯ä»¥è®¾ç½®æŸä¸ªç‰¹å®šåŠ¨ç”»çš„ç½‘æ ¼ä½“æ¥æºã€‚
- Setup Rig â€”â€” å°†åŠ¨ç”»é‡å®šä½åˆ°ä½¿ç”¨ç›¸åŒç»‘å®šçš„ä¸åŒéª¨æ¶ã€‚
- Manage Retarget Base Pose â€”â€” é‡å®šä½èµ„æºåˆ°å…¶ä»–éª¨æ¶æ—¶å¯ä»¥ä½¿ç”¨ï¼Œå…è®¸æ›´æ”¹ç›®æ ‡çš„åŸºæœ¬å§¿åŠ¿ï¼Œä»¥ä½¿å…¶ä¸æºåŸºæœ¬å§¿åŠ¿ä¸€è‡´ï¼Œå¹¶æä¾›æ›´å‡†ç¡®çš„é‡å®šä½åŠ¨ç”»ã€‚

æ·»åŠ é‡å®šå‘æºæ“ä½œæ­¥éª¤ï¼š

- åœ¨å†…å®¹æµè§ˆå™¨åŒå‡»éª¨æ¶æ‰“å¼€éª¨æ¶ç¼–è¾‘å™¨ï¼Œä»å·¥å…·æ ä¸­å•å‡»ï¼ˆRetarget Managerï¼‰æŒ‰é’®æ‰“å¼€é‡å®šä½ç®¡ç†å™¨é¢æ¿ã€‚
- å•å‡» Manage Retarget Source éƒ¨åˆ†çš„ï¼ˆAdd New ï¼‰æŒ‰é’®æ·»åŠ æ–°é‡å®šå‘æºã€‚
- é€‰æ‹©ä¸€ä¸ª Skeleton Meshï¼Œè¿™æ˜¯ä¸ºå½“å‰éª¨æ¶åˆ›å»ºäº†ç‰¹æ®ŠåŠ¨ç”»çš„éª¨æ¶ç½‘æ ¼ä½“ã€‚
- ç°åœ¨ä½ å¯ä»¥çœ‹åˆ°è¯¥éª¨æ¶ç½‘æ ¼ä½“åœ¨é‡å®šå‘ç®¡ç†å™¨ï¼ˆRetarget Managerï¼‰ä¸­åˆ—å‡ºã€‚
- æ‰“å¼€é’ˆå¯¹ä»¥éª¨æ¶ç½‘æ ¼ä½“çš„åŠ¨ç”»åºåˆ—ã€‚
- è®¾ç½® Asset Details -> Animation -> Retarget Source å±æ€§ï¼Œå¹¶ä»ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©ä½ çš„ç‰¹å®šéª¨æ¶ç½‘æ ¼ä½“ã€‚
- é€šè¿‡é€‰æ‹©æ­¤ç½‘æ ¼ä½“ï¼Œå°±æŒ‡å®šäº†è¦ä½¿ç”¨è¯¥ç½‘æ ¼ä½“çš„æ¯”ä¾‹é©±åŠ¨æ­¤åŠ¨ç”»ã€‚

é‡å®šå‘ç®¡ç†å™¨çš„ Setup Rig éƒ¨åˆ†å…è®¸ä½ ä¸ºéª¨æ¶æŒ‡å®šéª¨æ¶ç»‘å®šï¼Œå¯ç”¨å®ƒå°†åŠ¨ç”»æ•°æ®ä¼ é€’ç»™ä½¿ç”¨åŒä¸€ä¸ªéª¨æ¶ç»‘å®šçš„ä¸åŒéª¨æ¶ã€‚å¯ä»¥ä»é€‰æ‹©éª¨æ¶ç»‘å®šï¼ˆSelect Rigï¼‰ä¸‹æ‹‰é€‰é¡¹ä¸­é€‰æ‹©è¦ä½¿ç”¨çš„éª¨æ¶ç»‘å®šï¼Œå…¶ä¸­åŒ…å«äººå½¢ï¼ˆHumanoidï¼‰éª¨æ¶ç±»å‹é€‰é¡¹ï¼Œå®ƒé€‚ç”¨äºå¤§å¤šæ•°è§’è‰²ã€‚

æŒ‡å®šå¥½äººå½¢éª¨æ¶ç»‘å®šåï¼Œä½ å°†éœ€è¦æŒ‡å®šéª¨æ¶ä¸­ä¸éª¨æ¶ç»‘å®šä¸Šçš„èŠ‚ç‚¹å¯¹åº”çš„ç›¸åŒï¼ˆæˆ–ç›¸ä¼¼ï¼‰ä½ç½®çš„éª¨éª¼ã€‚ä½ å¯ä»¥ä½¿ç”¨ä¸‹æ‹‰èœå•æ¥é€‰æ‹©èŠ‚ç‚¹å¹¶æ‰‹åŠ¨ä»éª¨æ¶æŒ‡å®šç›¸åº”çš„éª¨éª¼ï¼Œæˆ–è€…ä½ å¯ä»¥ä½¿ç”¨ä½äºèœå•é¡¶éƒ¨çš„ è‡ªåŠ¨æ˜ å°„ï¼ˆAuto Mappingï¼‰ åŠŸèƒ½ã€‚æ­¤åŠŸèƒ½å°†å¯¹éª¨æ¶è¿›è¡Œç¿»æŸ¥å¹¶å°è¯•ä¸ºéª¨æ¶ç»‘å®šä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹æ‰¾åˆ°æœ€åŒ¹é…çš„éª¨éª¼ã€‚

é‡å®šç®¡ç†å™¨çš„æœ€åä¸€ä¸ªåŠŸèƒ½æ˜¯è®¾ç½®åŸºæœ¬å§¿åŠ¿ï¼Œæœ‰æ—¶ä½ å¯èƒ½å¸Œæœ›å°†åŠ¨ç”»é‡å®šå‘åˆ°åŸºæœ¬å§¿åŠ¿ä¸æºéª¨æ¶ä¸å¤ªä¸€è‡´çš„éª¨æ¶ã€‚æ¯”å¦‚ï¼Œæºéª¨æ¶å‘ˆAå­—å§¿åŠ¿ï¼Œè€Œç›®æ ‡éª¨æ¶å‘ˆ T å­—å§¿åŠ¿ã€‚å¦‚æœç›´æ¥å°±è¿™æ ·é‡å®šå‘åŠ¨ç”»ï¼Œå¯èƒ½ä¼šé‡åˆ°é—®é¢˜ã€‚ç”±äºå®ƒä»¬ä½¿ç”¨çš„åŸºæœ¬å§¿åŠ¿ä¸åŒï¼Œæ¯”å¦‚æ‰‹è‡‚å®šä½ä¸æ­£ç¡®ã€‚é€šè¿‡è®¾ç½®é‡å®šå‘åŸºæœ¬å§¿åŠ¿æ¥è§£å†³è¿™ä¸€é—®é¢˜ï¼Œé‡å®šå‘ç®¡ç†å™¨ï¼ˆRetarget Managerï¼‰ä½¿æˆ‘ä»¬èƒ½å¤Ÿå®šä¹‰åŸºæœ¬å§¿åŠ¿ä½¿å…¶é‡å®šå‘ï¼Œå¹¶ä½¿ç”¨é‡å®šå‘åçš„åŸºæœ¬å§¿åŠ¿æ¥è¿›è¡ŒåŠ¨ç”»é‡å®šå‘ï¼Œè€Œéä½¿ç”¨è§’è‰²æ­£å¸¸çš„åŸºæœ¬å§¿åŠ¿ã€‚

æˆ‘ä»¬å¯ä»¥é€‰ä¸­è§’è‰²çš„éª¨éª¼å¹¶æ—‹è½¬å®ƒä»¬ï¼ˆåœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œæ—‹è½¬å·¦è‚©å’Œå³è‚©ï¼‰ï¼Œä½¿è§’è‰²å‘ˆ A å­—å§¿åŠ¿ï¼Œç„¶åå•å‡»ä¿®æ”¹å§¿åŠ¿ï¼ˆModify Poseï¼‰ã€‚åœ¨ä¸Šä¸‹æ–‡èœå•ä¸­ï¼Œé€‰æ‹©ä½¿ç”¨å½“å‰å§¿åŠ¿ï¼ˆUse Current Poseï¼Œè¿™æ ·å°±å¯ä»¥æŠŠè¯¥å§¿åŠ¿è®¾ç½®ä¸ºåœ¨æ‰§è¡Œä»»ä½•åŠ¨ç”»é‡å®šå‘æ—¶è¦ä½¿ç”¨çš„é‡å®šå‘åçš„åŸºæœ¬å§¿åŠ¿ã€‚

ç°åœ¨ï¼Œé€šè¿‡å†…å®¹æµè§ˆå™¨å†å¯¹åŠ¨ç”»æ‰§è¡Œé‡å®šæ—¶ï¼ŒRetarget Anim Assets -> Duplicate Anim Assets and Retargetï¼Œå°†ä¼šçœ‹åˆ°ç»è¿‡æ›´æ–°çš„é‡å®šå‘åçš„åŸºæœ¬å§¿åŠ¿ã€‚


    Old skeleton and new skeleton need to have Preview Mesh set up to convert animation


### âœ’ Control Rig åŠ¨ç”»å·¥å…·
- Control Rig https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/ControlRig
- Control Rig mannequin sample https://www.unrealengine.com/marketplace/en-US/product/control-rig-mannequin

æ–°çš„ Control Rig æ’ä»¶æ˜¯åŸºäºèŠ‚ç‚¹çš„æ“æ§ç³»ç»Ÿï¼Œè®¾è®¡ç”¨äºä¸ºæ“æ§è€…å’ŒåŠ¨ç”»å¸ˆæä¾›å¤šç§å·¥å…·ï¼Œé€šè¿‡å¯¹ç¾æœ¯å¸ˆå‹å¥½çš„ç•Œé¢æ¥åˆ›å»ºçµæ´»ã€åŠ¨æ€å’Œç¨‹åºæ€§çš„è§’è‰²ã€‚ä¸è“å›¾ä¸åŒï¼ŒControl Rig ä½¿ç”¨ç§°ä¸º RigVM çš„è‡ªæœ‰è½»é‡çº§VMæä¾›é«˜æ•ˆçš„å§¿åŠ¿è®¡ç®—ã€‚ç”¨æˆ·å¯å°†ç§°ä¸º Rig Units çš„èŠ‚ç‚¹ä¸ Control Rig å›¾è¿æ¥åœ¨ä¸€èµ·ï¼Œåˆ›é€ è¿è¡Œæ—¶åŠ¨ç”»ã€‚

å¯¼å…¥éª¨éª¼ç½‘æ ¼ä½“å°†ç”Ÿæˆ Rig Hierarchy çš„éª¨éª¼ï¼Œä»¥åŠåœ¨ Control Rig ç¼–è¾‘å™¨ä¸­åˆ›å»ºçš„å…¶ä»–éª¨éª¼ã€ç©ºé—´å’ŒåŠŸèƒ½æŒ‰é’®ï¼Œå¯ä»¥ä½œä¸º Rig Units çš„è¾“å…¥æˆ–è¾“å‡ºï¼Œç±»ä¼¼äºå§¿åŠ¿ä½œä¸ºåŠ¨ç”»è“å›¾ä¸­çš„åŠ¨ç”»èŠ‚ç‚¹çš„è¾“å…¥æˆ–è¾“å‡ºã€‚Control Rig ä¸ä»…é™äºéª¨éª¼ç½‘æ ¼ä½“ã€‚ç”¨æˆ·å¯ä» Control Rig ç»„ä»¶ä¸­è·å–åŠŸèƒ½æŒ‰é’®æ•°å€¼ï¼Œä»è€Œåœ¨è“å›¾ Actor ä¸­åˆ›å»º Control Rig ç»„ä»¶ï¼ŒæŠŠå…¶ä»–ç»„ä»¶åˆ¶ä½œæˆåŠ¨ç”»ï¼Œå¦‚é™æ€ç½‘æ ¼ä½“æˆ–å…‰æºã€‚

ä½ å¯ä»¥ä½¿ç”¨ Control Rig ç³»ç»Ÿåœ¨å¼•æ“å†…åˆ›ä½œåŠ¨ç”»ï¼ˆAnimate in Engineï¼‰ï¼Œå³åˆ©ç”¨ç¨‹åºåˆ¶ä½œåŠ¨ç”»ï¼Œæˆ–æ˜¯åˆ›å»ºè‡ªå®šä¹‰é‡å®šå‘æˆ– FullBody IKè§£å†³æ–¹æ¡ˆã€‚å¾—ç›Šäºå®Œå¤‡çš„ Python é›†æˆï¼Œä½ å¯ä»¥ä¸ºä»»ä½•äº§å“å®ç°å¤æ‚ä»»åŠ¡çš„è‡ªå®šä¹‰å’Œè‡ªåŠ¨åŒ–æµç¨‹ã€‚

å¯ä»¥ä½¿ç”¨ Control Rig ä¿®æ”¹ç°æœ‰çš„éª¨éª¼åŠ¨ç”»ï¼ŒRig åå‘è®¡ç®—ï¼ˆRig inversionï¼‰ ä½¿ç”¨æˆ·èƒ½å¤Ÿå°†ç°æœ‰åŠ¨ç”»é‡æ–°æ˜ å°„ï¼Œä»¥ä¾¿ç”¨æˆ·ä½¿ç”¨ Sequencer è°ƒæ•´ Gameplay æˆ–è¿‡åœºåŠ¨ç”»ã€‚Control Rig ä¸­çš„ Backwards Event èŠ‚ç‚¹å°†å®šä¹‰éª¨éª¼åœ°å›¾å¦‚ä½•æ˜ å°„åˆ°æ§åˆ¶ç‚¹æˆ–å…¶ä»–æ§åˆ¶é€»è¾‘ã€‚å€ŸåŠ© Numerical Pre-Sequencer åŠŸèƒ½ï¼Œç”¨æˆ·èƒ½å¤Ÿé€šè¿‡åœ¨ Sequencer ä¸­ä¸ºæ¯å¸§åŠ¨ç”»è¿è¡Œåå‘è§£ç®—äº‹ä»¶æ¥çƒ˜ç„™åˆ° Control Rigã€‚è¯¥è§£å†³æ–¹æ¡ˆå…è®¸ç¼–è¾‘ç°æœ‰åŠ¨ç”»åºåˆ—æˆ–ç¼–è¾‘è®°å½•çš„è¿åŠ¨æ•è·æ•°æ®ç­‰å·¥ä½œæµã€‚

ä½¿ç”¨æ­£å‘è§£ç®—ï¼ˆForward Solveï¼‰ï¼Œé€šè¿‡æ§åˆ¶ç‚¹æˆ–å…¶ä»–ç¨‹åºåŒ–é€»è¾‘ï¼ˆä¾‹å¦‚IKæˆ–æ­£å¼¦æ³¢ï¼‰æ¥æ“æ§éª¨éª¼ã€‚ä¸ Forward Solve RigUnit èŠ‚ç‚¹å»ºç«‹è¿æ¥ã€‚

ä½¿ç”¨åå‘è§£ç®—ï¼ˆBackwards Solveï¼‰ æ¥å¤„ç†æ‰€æœ‰éœ€è¦åº”ç”¨åˆ°æ§åˆ¶ç‚¹çš„ä¼ å…¥éª¨éª¼åŠ¨ç”»æ•°æ®ã€‚å¯ä»¥ä¸ Backwards Solve RigUnit èŠ‚ç‚¹å»ºç«‹è¿æ¥ã€‚

åˆ›å»º Control Rig åºåˆ—çš„æ­¥éª¤ï¼š

- é¦–å…ˆç¡®ä¿å¯ç”¨ Control Rig æ’ä»¶ã€‚
- é€šè¿‡å†…å®¹æµè§ˆå™¨å³é”®èœå•æ–°å¢å…³å¡åºåˆ—ï¼ˆLevel Sequenceï¼‰ å¹¶è®¾ç½®ä»»æ„å‘½åã€‚
- åŒå‡»æ‰“å¼€åºåˆ—èµ„äº§ï¼Œåœ¨ Sequencer ç¼–è¾‘å™¨ç•Œé¢ä¸­ï¼Œå¢åŠ è½¨é“ Track -> Actor to Sequenceï¼Œå°†ä½ é€‰æ‹©çš„éª¨æ¶ç½‘æ ¼ä½“æ·»åŠ åˆ°åºåˆ—ä¸­ã€‚
- ç‚¹å‡» + æŒ‰é’®ï¼Œç„¶åé€‰æ‹© FK Control Rigï¼Œæ·»åŠ ä¸€æ¡ Control Rig è½¨é“æˆ– Asset Based Control Rigï¼ŒæŒ‡å®šä¸€ä¸ª Control Rig è“å›¾èµ„äº§ã€‚
- åºåˆ—å°†æ›´æ–°å¹¶æ·»åŠ  Control Rig è“å›¾ã€‚æ¨¡å¼ï¼ˆModesï¼‰é¢æ¿ä¹Ÿå°†æ›´æ–°ï¼Œæ˜¾ç¤ºå¯ç”¨å’Œå¯è®¾ç½®å…³é”®å¸§çš„å±æ€§ã€‚

æ¥ä¸‹æ¥ä¸º Actor æ·»åŠ åŠ¨ç”»ï¼Œå±•å¼€ Control Rig è½¨é“ï¼Œæ‰€æœ‰å¯è®¾ç½®å…³é”®å¸§çš„å±æ€§å°†æ˜¾ç¤ºï¼Œç‚¹å‡»éœ€è¦è®¾ç½®å…³é”®å¸§çš„å±æ€§æ—çš„ Add Key å›¾æ ‡å³å¯æ·»åŠ å…³é”®å¸§ã€‚ 

æ­¤æ“ä½œå°†åœ¨ Control Rigåºåˆ—çš„ç‰¹å®šæ—¶é—´å¤„æ·»åŠ ä¸€ä¸ªå±æ€§çš„å…³é”®å¸§ã€‚å¯ä»¥å°†æ—¶é—´è½´æ‹–åŠ¨åˆ°æ–°æ—¶é—´å¤„ï¼Œç„¶åä½¿ç”¨è§†å£ä¸­çš„"å˜æ¢ï¼ˆTransformï¼‰"æ§ä»¶ï¼ˆæˆ–åœ¨Sequencerä¸­æ‰‹åŠ¨è¾“å…¥ä¸€ä¸ªå€¼ï¼‰æ¥ç§»åŠ¨ Control Rig çš„ç›¸å…³éƒ¨åˆ†å¹¶å¯¹æ–°å€¼è®¾ç½®å…³é”®å¸§ã€‚

åœ¨ä¸Šä¾‹ä¸­ï¼Œæˆ‘ä»¬æ­£åœ¨ç§»åŠ¨ä¸éª¨æ¶ç½‘æ ¼ä½“å³è‡‚ç›¸å…³è”çš„æœ«ç«¯æ‰§è¡Œå™¨å¹¶å¯¹æ–°å€¼è®¾ç½®å…³é”®å¸§ï¼Œä½¿è§’è‰²ä»åˆå€¼å†…æ’åˆ°æ–°çš„é”®å€¼ã€‚



### âœ’ Persona åŠ¨ç”»ç¼–è¾‘å·¥å…·
- åŠ¨ç”»ç¼–è¾‘å™¨ https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/Persona/
- https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/Persona/MeshDetails
- https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/Persona/Modes/Skeleton/
- https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/Persona/SkeletonTree/
- https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/Skeleton/

åœ¨è™šå¹»å¼•æ“ 4 ä¸­åˆ›å»ºå¸¦åŠ¨ç”»è§’è‰²éœ€è¦ä½¿ç”¨å‡ ç§ä¸åŒçš„åŠ¨ç”»å·¥å…·ï¼ˆæˆ–ç¼–è¾‘å™¨ï¼‰ï¼Œæ¯ç§å·¥å…·é’ˆå¯¹åŠ¨ç”»çš„ä¸åŒæ–¹é¢è¿›è¡Œç¼–è¾‘ï¼š

- éª¨æ¶ç¼–è¾‘å™¨`Skeleton Editor`æ˜¯æ‰€æœ‰æ“ä½œçš„èµ·ç‚¹ï¼Œå…¶ç”¨äºç®¡ç†é©±åŠ¨éª¨æ¶ç½‘æ ¼ä½“`Skeletal Mesh`å’ŒåŠ¨ç”»çš„éª¨éª¼ï¼ˆæˆ–å…³èŠ‚å±‚çº§ï¼‰ã€‚
- éª¨æ¶ç½‘æ ¼ä½“ç¼–è¾‘å™¨`Skeletal Mesh Editor`ç”¨äºä¿®æ”¹é“¾æ¥åˆ°éª¨æ¶çš„éª¨æ¶ç½‘æ ¼ä½“ï¼Œæ˜¯è§’è‰²çš„å¤–è§‚ã€‚
- åŠ¨ç”»ç¼–è¾‘å™¨`Animation Editor`å¯ä»¥åˆ›å»ºå¹¶ä¿®æ”¹åŠ¨ç”»èµ„æºï¼Œå¯ç”¨äºå¯¹åŠ¨ç”»è¿›è¡Œå¾®è°ƒ/è°ƒæ•´ã€‚
- åŠ¨ç”»è“å›¾ç¼–è¾‘å™¨`Animation Blueprint Editor`å¯ç”¨äºåˆ›å»ºé€»è¾‘ï¼Œé©±åŠ¨è§’è‰²ä½¿ç”¨çš„åŠ¨ç”»ã€ä½¿ç”¨æ—¶æœºï¼Œä»¥åŠåŠ¨ç”»æ··åˆçš„æ–¹å¼ã€‚
- ç‰©ç†èµ„æºç¼–è¾‘å™¨`Physics Asset Editor`å¯åˆ›å»ºå’Œç¼–è¾‘ç”¨äºéª¨æ¶ç½‘æ ¼ä½“ç¢°æ’çš„ç‰©ç†å½¢ä½“ã€‚

è™šå¹»å¼•æ“ 4 ä¸­ Persona åŠ¨ç”»å·¥å…·çš„å„ä¸ªæ–¹é¢çš„æ“ä½œæ­¥éª¤ç¤ºä¾‹ã€‚ æ— è®ºæ‚¨æ˜¯è™šå¹»å¼•æ“ 4 ä¸­çš„åŠ¨ç”»æ–°æ‰‹ï¼Œè¿˜æ˜¯è¦å­¦ä¹ å¦‚ä½•ä½¿ç”¨ Persona çš„æˆ‘å„ç§ä½¿ç”¨æ–¹æ³•ã€‚

Persona æ˜¯è™šå¹»å¼•æ“ä¸­çš„ä¸€ç»„åŠ¨ç”»ç¼–è¾‘å·¥å…·é›†ã€‚è¿™æ˜¯ä¸€ä¸ªå¥å£®çš„ç³»ç»Ÿï¼Œå¯ç”¨æ¥ç¼–è¾‘éª¨æ¶ï¼Œéª¨æ¶ç½‘æ ¼ä½“ï¼ŒåŠ¨ç”»è“å›¾ä»¥åŠå¤šç§å…¶å®ƒåŠ¨ç”»èµ„æºã€‚åœ¨è™šå¹»å¼•æ“ä¸­ï¼Œå¤§éƒ¨åˆ†ï¼ˆå³æ—¶ä¸æ˜¯å…¨éƒ¨ï¼‰åŠ¨ç”»å¤„ç†å·¥ä½œéƒ½åœ¨è¿™ä¸ªç¼–è¾‘å™¨ä¸­è¿›è¡Œã€‚è¿™æ˜¯ä¸€æ¬¾å¤šåŠŸèƒ½çš„å·¥å…·ï¼ŒåŒ…å«äº†ç”¨äºç¼–è¾‘éª¨æ¶ æ’æ§½ ã€é¢„è§ˆ åŠ¨ç”»åºåˆ— ã€è®¾ç½®åŠ¨ç”» æ··åˆç©ºé—´ ä»¥åŠ è’™å¤ªå¥‡ ã€ç¼–è¾‘ åŠ¨ç”»è“å›¾ ç­‰çš„é¢æ¿ã€‚

åœ¨è™šå¹»å¼•æ“ 4.14 ä¹‹å‰ï¼Œåˆå¹¶çš„åŠ¨ç”»ç¼–è¾‘å™¨ç§°ä¸º Personaï¼Œåç»­ç‰ˆæœ¬ä¸­ï¼Œè¯¥ç¼–è¾‘å™¨è¢«æ‹†è§£ä¸ºå››ä¸ªç‹¬ç«‹çš„ç¼–è¾‘å™¨ã€‚è™½ç„¶å®ƒä»¬çš„åŠŸèƒ½åŸºæœ¬ç›¸åŒï¼Œä½†éƒ¨åˆ†ç•Œé¢å‘ç”Ÿäº†å˜åŒ–ï¼Œç°åœ¨ï¼Œæ‚¨å¯ä»¥åŒæ—¶æ‰“å¼€ä¸åŒçŠ¶æ€çš„å¤šä¸ªåŠ¨ç”»ç¼–è¾‘å™¨çª—å£ã€‚ä¾‹å¦‚ï¼Œæ‚¨ç°åœ¨å¯ä»¥é’ˆå¯¹æ¸¸æˆä¸­çš„æ¯ä¸ª åŠ¨ç”»åºåˆ— æ‰“å¼€ä¸€ä¸ªé€‰é¡¹å¡ï¼Œè€Œä¸æ˜¯åªé€šè¿‡ä¸€ä¸ªé€‰é¡¹å¡åœ¨å®ƒä»¬ä¹‹é—´è¿›è¡Œåˆ‡æ¢ï¼ˆå¦‚æœä» èµ„æºæµè§ˆå™¨ ä¸­é€‰æ‹© åŠ¨ç”»åºåˆ—ï¼Œåˆ™ä»ä¿æŒè¿™ç§è¡Œä¸ºï¼‰ã€‚

ä½¿ç”¨åŠ¨ç”»ç¼–è¾‘å™¨`Animation Editor`å¯è½»æ¾åœ°è®¿é—®å¯ç”¨äºéª¨æ¶ç½‘æ ¼ä½“çš„å„ç§ä»¥åŠ¨ç”»ä¸ºä¸­å¿ƒçš„èµ„æºã€‚ åœ¨åŠ¨ç”»ç¼–è¾‘å™¨ä¸­ï¼Œä½ å¯ä»¥é¢„è§ˆåŠ¨ç”»åºåˆ—ã€æ··åˆç©ºé—´ã€åŠ¨ç”»è’™å¤ªå¥‡ç­‰åŠ¨ç”»èµ„æºçš„æ’­æ”¾ï¼Œç¼–è¾‘åŠ¨ç”»èµ„æºï¼Œä¸ºæè´¨å‚æ•°æˆ–å˜å½¢ç›®æ ‡æ·»åŠ å’Œç¼–è¾‘æ›²çº¿ï¼Œä»¥åŠå®šä¹‰åŠ¨ç”»é€šçŸ¥ï¼ˆåœ¨åŠ¨ç”»ä¸­çš„ç‰¹å®šç‚¹å‘ç”Ÿçš„äº‹ä»¶ï¼‰ã€‚

åœ¨åŠ¨ç”»ç¼–è¾‘å™¨ä¸­ï¼Œéª¨éª¼æ“ä½œæ¨¡å¼ï¼ˆBone Manipulation Modeï¼‰ å…è®¸æŠ€æœ¯äººå‘˜åœ¨é¢„è§ˆåŠ¨ç”»æ—¶ä¸´æ—¶å¹³ç§»æˆ–æ—‹è½¬éª¨éª¼ï¼Œä»¥æŸ¥æ‰¾éª¨æ¶ç½‘æ ¼ä½“ä¸­çš„çš®è‚¤é—®é¢˜ã€‚ éª¨éª¼æ“ä½œæ¨¡å¼çš„å¦ä¸€ä¸ªæœ‰ç”¨çš„æ–¹é¢æ˜¯ï¼Œæ‚¨å¯ä»¥å¹³ç§»æˆ–æ—‹è½¬éª¨éª¼ï¼ˆä¾‹å¦‚ï¼Œå°†æŸä¸ªè§’è‰²çš„å¤´éƒ¨å‘ä¸Šæˆ–å‘ä¸‹å€¾æ–œï¼‰ï¼Œç„¶åæ ¹æ®æ”¹å˜çš„éª¨éª¼ä½ç½®ä½¿ç”¨æ—¶é—´è½´çš„è®°å½•é€‰é¡¹ï¼Œä»¥åˆ›å»ºä¸€ä¸ªæ–°åŠ¨ç”»ã€‚

åœ¨å†…å®¹æµè§ˆå™¨ä¸­æˆ–ä»ç¼–è¾‘å™¨å·¥å…·æ ä¸­æ‰“å¼€ä¸€ä¸ªéª¨æ¶ç½‘æ ¼ä½“ï¼ˆSkeletal Meshï¼‰èµ„æºæ—¶ï¼Œå°±ä¼šæ‰“å¼€éª¨æ¶ç½‘æ ¼ä½“ç¼–è¾‘å™¨ï¼ˆ*Skeletal Mesh Editor*ï¼‰ï¼Œå¯ä»¥è®¾ç½®éª¨æ¶ç½‘æ ¼ä½“çš„æè´¨ï¼ˆMaterialsï¼‰ï¼Œæ·»åŠ å¸ƒæ–™å…ƒç´ ï¼Œè®¾ç½® LOD å’Œæµ‹è¯•ä»»ä½•åº”ç”¨åˆ°ç½‘æ ¼ä½“çš„å˜æ¢ç›®æ ‡ï¼ˆMorph Targetï¼‰æ¥å¯¹å¤šè¾¹å½¢ç½‘æ ¼ä½“è¿›è¡Œæ›´æ”¹ã€‚ æ­¤ç¼–è¾‘å™¨åŒ…æ‹¬ä¸€äº›å¯åœ¨å…¶ä»–ä¸€äº›åŠ¨ç”»å·¥å…·ä¸­æ‰¾åˆ°çš„çª—å£ï¼Œä¾‹å¦‚å·¥å…·æ /è§†å£ï¼ˆå’Œå…¶ä»–ä¸€äº›é»˜è®¤éšè—çš„çª—å£ï¼‰ï¼Œä½†æ‚¨çš„å¤§éƒ¨åˆ†ç½‘æ ¼ä½“å·¥ä½œéƒ½å°†åœ¨ èµ„æºè¯¦ç»†ä¿¡æ¯ï¼ˆAsset Detailsï¼‰ å’Œ å˜æ¢ç›®æ ‡é¢„è§ˆï¼ˆMorph Target Previewï¼‰ çª—å£ä¸­å®Œæˆã€‚

éª¨æ¶ç½‘æ ¼ä½“ç¼–è¾‘å™¨å†…çš„å·¥å…·æ ä¸ºæ‚¨æä¾›å¯å°†ä»»ä½•æ›´æ”¹ä¿å­˜åˆ°æ‚¨çš„åŠ¨ç”»æˆ–åœ¨å†…å®¹æµè§ˆå™¨ä¸­æ‰¾åˆ°è¯¥æ›´æ”¹çš„é€‰é¡¹ã€‚ å®ƒå…è®¸æ‚¨åœ¨é¢„è§ˆçš„å½“å‰å§¿åŠ¿ä¸­åˆ›å»ºä¸€ä¸ªé™æ€ç½‘æ ¼ä½“ï¼ˆStatic Meshï¼‰ã€‚ å·¥å…·æ æœ€å³ä¾§æ˜¯ ç¼–è¾‘å™¨å·¥å…·æ ï¼ˆEditor Toolbarï¼‰ï¼Œå…è®¸æ‚¨åœ¨è™šå¹»å¼•æ“ 4 ä¸­çš„ä¸åŒåŠ¨ç”»å·¥å…·ä¸­åˆ‡æ¢ã€‚


éª¨æ¶ç¼–è¾‘å™¨ï¼ˆ*Skeleton Editor*ï¼‰ æ˜¯ä¸€ç§ç”¨äºå¤„ç†è™šå¹»å¼•æ“ 4 ä¸­çš„éª¨æ¶èµ„æºçš„å·¥å…·ï¼Œå®ç°å¯è§†åŒ–æ§åˆ¶ä¸éª¨æ¶ç½‘æ ¼ä½“ï¼ˆSkeletal Meshï¼‰å…³è”çš„éª¨éª¼æˆ–å…³èŠ‚å±‚çº§ã€‚ åœ¨æ­¤ç¼–è¾‘å™¨ä¸­ï¼Œå¯ä»¥åˆ›å»ºéª¨æ¶ç½‘æ ¼ä½“æ’æ§½ä»¥å°†é¡¹ç›®é™„åŠ åˆ°éª¨æ¶ç½‘æ ¼ä½“ï¼Œé¢„è§ˆåŠ¨ç”»æ›²çº¿å¹¶è·Ÿè¸ªä¸éª¨æ¶å…³è”çš„ç›¸å…³åŠ¨ç”»é€šçŸ¥ï¼Œè¿˜å¯è®¾ç½®æ‚¨çš„åŠ¨ç”»é‡å®šä½é€‰é¡¹å¹¶ä½¿ç”¨é‡å®šå‘ç®¡ç†å™¨ï¼Œç®¡ç†æ‚¨çš„é‡å®šå‘æºã€‚

å·¥å…·æ æœ€å³ä¾§æ˜¯ç¼–è¾‘å™¨å·¥å…·æ ï¼ˆEditor Toolbarï¼‰ï¼Œå…è®¸æ‚¨åœ¨è™šå¹»å¼•æ“4ä¸­çš„ä¸åŒåŠ¨ç”»å·¥å…·ä¸­åˆ‡æ¢ã€‚å¯ä»¥æŸ¥çœ‹åŠ¨ç”»é€šçŸ¥ï¼ˆAnim Notifiesï¼‰ï¼Œæ‰“å¼€é‡å®šå‘ç®¡ç†å™¨ï¼ˆRetarget Managerï¼‰ï¼Œå¯¼å…¥æ–°çš„éª¨æ¶ç½‘æ ¼ä½“ï¼ˆSkeletal Meshï¼‰ï¼Œä»¥ä¸éª¨æ¶å…³è”å¹¶ç”¨é¢„è§ˆçš„å½“å‰å§¿åŠ¿åˆ›å»ºä¸€ä¸ªé™æ€ç½‘æ ¼ä½“ï¼ˆStatic Meshï¼‰ã€‚

éª¨æ¶ç¼–è¾‘å™¨å·¦ä¾§æ˜¯éª¨æ¶æ ‘ *Skeleton Tree*ï¼Œæ˜¾ç¤ºå½“å‰éª¨æ¶èµ„æºçš„éª¨æ¶å±‚çº§ï¼Œå¹¶å¯åœ¨å…¶ä¸­åˆ›å»ºå’Œç¼–è¾‘æ’æ§½ï¼Œé¢„è§ˆèµ„æºå’Œæ§åˆ¶åŠ¨ç”»é‡å®šå‘é€‰é¡¹ã€‚

éª¨æ¶æ ‘é¢æ¿å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

- é€‰æ‹©å¹¶æŸ¥çœ‹éª¨æ¶å±‚çº§ä¸­çš„ç‰¹å®šéª¨éª¼ã€‚
- åˆ›å»ºå¹¶ç¼–è¾‘æ’æ§½ï¼Œæ’æ§½æ˜¯ç”¨äºè¿æ¥é“å…·å’Œå…¶ä»–ç‰©å“çš„éª¨éª¼åç§»è¿æ¥ç‚¹ã€‚
- åˆ›å»ºæš‚æ—¶è¿æ¥çš„é¢„è§ˆèµ„äº§ï¼Œå®ƒä»¬éå¸¸æœ‰ç”¨ï¼Œä¾‹å¦‚ï¼Œå¯ä»¥é¢„è§ˆæ­¦å™¨æ‹¿åœ¨è§’è‰²æ‰‹ä¸­çš„æ•ˆæœã€‚
- æ§åˆ¶åŠ¨ç”»é‡å®šä½è®¾ç½®ï¼ˆéœ€è¦é€‰ä¸­ Show Advanced Optionsï¼‰ã€‚


ä¸­é—´çš„è§†å£çª—å£å…è®¸æ‚¨é¢„è§ˆæ‚¨æ‰€åšçš„æ›´æ”¹ï¼Œå¹¶è°ƒæ•´æ’æ§½ä½ç½®æˆ–é¢„è§ˆä»»ä½•åŠ¨ç”»æ›²çº¿ã€‚ ä»è§†å£ï¼ˆViewportï¼‰ä¸­è¿˜å¯åˆ†é…ä¸€ä¸ªé¢„è§ˆåŠ¨ç”»ä»¥ä¾›éª¨æ¶ç½‘æ ¼ä½“ä½¿ç”¨ï¼Œæ›´æ”¹ç…§æ˜æ¨¡å¼ï¼Œæ˜¾ç¤ºæˆ–éšè—éª¨æ¶çš„éª¨éª¼ï¼Œè°ƒæ•´åŠ¨ç”»æ’­æ”¾é€Ÿåº¦ï¼Œç”šè‡³å°†éª¨æ¶ç½‘æ ¼ä½“ï¼ˆSkeletal Meshï¼‰è®¾ç½®ä¸ºåœ¨è½¬ç›˜ä¸Šè‡ªåŠ¨æ—‹è½¬ï¼Œä½¿æ‚¨å¯ä»¥ä»ä»»ä½•è§’åº¦æŸ¥çœ‹å®ƒã€‚

å³ä¾§çš„è¯¦ç»†ä¿¡æ¯é¢æ¿ä¸»è¦ç”¨äºä¿®æ”¹æ’æ§½ï¼ˆSocketï¼‰ç­‰æ–°å¢å…ƒç´ çš„å±æ€§ã€‚ ä¾‹å¦‚ï¼Œå½“æ‚¨å°†ä¸€ä¸ªæ’æ§½æ·»åŠ åˆ°éª¨æ¶ï¼ˆSkeletonï¼‰æ—¶ï¼Œå•å‡»éª¨æ¶æ ‘ï¼ˆSkeleton Treeï¼‰ä¸­çš„æ’æ§½å°†ç”¨ä¸æ’æ§½ä½¿ç”¨æ–¹å¼ç›¸å…³çš„é€‰é¡¹å¡«å……è¯¦ç»†ä¿¡æ¯ï¼ˆDetailsï¼‰é¢æ¿ã€‚

è¿™ä¸€éƒ¨åˆ†ä¸­è¿˜æœ‰ä¸€ä¸ªç”¨äºé¢„è§ˆè®¾ç½®çš„é€‰é¡¹å¡ï¼Œèƒ½å¤Ÿå®šä¹‰è§†å£è®¾ç½®ï¼Œä¾‹å¦‚ åŠ¨ç”»æ¨¡å¼ï¼ˆAnimation Modeï¼‰ æˆ– åŠ¨ç”»ï¼ˆAnimationï¼‰ ä»¥ç”¨ä½œé¢„è§ˆï¼Œåˆ‡æ¢ç”¨äºé¢„è§ˆçš„ éª¨æ¶ç½‘æ ¼ä½“ï¼ˆSkeletal Meshesï¼‰ï¼Œä»¥åŠåº”ç”¨çš„è§†å£ç…§æ˜å’ŒåæœŸå¤„ç†ï¼ˆPost Processï¼‰è®¾ç½®ï¼Œä½¿æ‚¨å¯ä»¥é¢„è§ˆåº”ç”¨äº†å„ç§ç…§æ˜çš„è®¾ç½®ã€‚

åŠ¨ç”»æ›²çº¿æŸ¥çœ‹å™¨å…è®¸æ‚¨åœ¨è§†å£ï¼ˆViewportï¼‰ä¸­æŸ¥çœ‹å½“å‰ç½‘æ ¼ä½“å¯ç”¨çš„ä»»ä½•åŠ¨ç”»æ›²çº¿ã€‚ åŠ¨ç”»é€šçŸ¥çª—å£å…è®¸æ‚¨ä¿®æ”¹æ‚¨è‡ªå®šä¹‰åˆ›å»ºçš„ä¸è¯¥éª¨æ¶ï¼ˆSkeletonï¼‰èµ„æºå…³è”çš„åŠ¨ç”»é€šçŸ¥ï¼ˆAnimation Notifiesï¼‰ã€‚

åœ¨éª¨æ¶ç¼–è¾‘å™¨ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨éª¨æ¶æ ‘å°† è™šæ‹Ÿéª¨éª¼ï¼ˆVirtual Bonesï¼‰ æ·»åŠ åˆ°ç½‘æ ¼ä½“çš„ç°æœ‰éª¨æ¶ä¸­ã€‚è¿™æ ·æœ‰åŠ©äºç¼©çŸ­è¿­ä»£æ—¶é—´ï¼Œä½¿æ‚¨èƒ½å¤Ÿä»ç¼–è¾‘å™¨å†…éƒ¨æ›´æ”¹ç”¨äºç„å‡†æˆ–IKï¼ˆé€†å‘è¿åŠ¨å­¦ï¼‰çš„ç›®æ ‡å…³èŠ‚å±‚çº§ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæ‚¨å¿…é¡»åœ¨è¯¥ç¼–è¾‘å™¨ä¹‹å¤–çš„3Då»ºæ¨¡è½¯ä»¶ä¸­æ·»åŠ è¿™äº›éª¨éª¼ï¼Œç„¶åé‡æ–°å¯¼å…¥æ‰€æœ‰åŠ¨ç”»ï¼Œå°†æ–°å…³èŠ‚åŒ…å«åœ¨å†…ä»¥ä¿®å¤åŠ¨ç”»æ•°æ®ã€‚

è™šæ‹Ÿéª¨éª¼æœ¬è´¨ä¸Šæ˜¯ä¸å¯ä»¥æ·»åŠ çš®è‚¤çš„ï¼Œå¹¶ä¸”å¯ä»¥çº¦æŸåœ¨éª¨æ¶å±‚çº§ä¸­çš„ä¸¤ä¸ªç°æœ‰éª¨éª¼ä¹‹é—´ä½¿ç”¨ï¼Œå®ƒä»¬ä¼šè‡ªåŠ¨ä¸ºå„ä¸ªåŠ¨ç”»ç”Ÿæˆæ•°æ®ã€‚ ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥æ·»åŠ ä¸€ä¸ªå…³èŠ‚ä½œä¸ºæ‰‹éƒ¨çš„å­èµ„æºï¼Œä½†å®ƒå°†å—åˆ°æ‰‹æŒå…³èŠ‚çš„é™åˆ¶ã€‚ä¸éª¨è‡¼ä¸åŒçš„æ˜¯ï¼Œè¯¥å…³èŠ‚å¯ä»¥åœ¨åŠ¨ç”»è“å›¾ä¸­ç”¨ä½œç›®æ ‡ï¼Œä¾‹å¦‚IKç›®æ ‡æˆ–"æ³¨è§†"ç›®æ ‡ã€‚ç”šè‡³å¯ä»¥åœ¨åŠ¨ç”»è“å›¾ä¸­ä¿®æ”¹è™šæ‹Ÿéª¨éª¼ä»¥ä¾›å°†æ¥ä½¿ç”¨ã€‚



### âœ’ Root Motion æ ¹è¿åŠ¨
- Root Motion https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/RootMotion/
- Sync Groups https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/SyncGroups/
- åŠ¨ç”»ä¼˜åŒ– https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/Optimization/

è§’è‰²çš„è¿åŠ¨æ—¶ï¼Œå¯¹è±¡åœ¨åœºæ™¯çš„ä½ç½®ä¹Ÿéœ€è¦è¿›è¡Œç§»åŠ¨ï¼Œä¸€èˆ¬æœ‰ 2 ç§æ–¹æ³•å¤„ç†ï¼š

- ç›´æ¥æˆ–é—´æ¥ä¿®æ”¹è§’è‰²åæ ‡ï¼Œç„¶åè®¡ç®—ä¸Šä¸€å¸§å’Œè¿™ä¸€å¸§ä¹‹é—´çš„è·ç¦»å·®æ¥ç®—å‡ºé€Ÿåº¦ï¼Œç„¶åç”¨é€Ÿåº¦æ¥é€‰æ‹©æ’­æ”¾å“ªä¸ªåŠ¨ç”»ï¼Œæ¯”å¦‚ 0=idleï¼Œ300=walkï¼Œ600=runã€‚
- ç”±åŠ¨ç”» Root Motion é©±åŠ¨ã€‚åŠ¨ç”»å¸ˆåšçš„åŠ¨ç”»ä¸­ï¼Œè§’è‰²éª¨éª¼çš„ Root èŠ‚ç‚¹å°±è‡ªå¸¦ä½ç§»ï¼Œç„¶åæ¸¸æˆå¼•æ“è·å–åˆ°è¿™äº›ä½ç§»ï¼Œä»¥æ­¤æ¥æ”¹å˜è§’è‰²åœ¨æ¸¸æˆä¸­çš„ä½ç½®ã€‚

ç›´æ¥æ§åˆ¶ä¼˜ç‚¹æ˜¯å®ç°ç®€å•ï¼Œå¯æ§æ€§é«˜ï¼Œå¯¹è”æœºçš„æ”¯æŒè¶³å¤Ÿå¥½ã€‚ç¼ºç‚¹å°±æ˜¯ç®€å•ï¼Œå¦‚æœæ˜¯æ­¥å±¥è¹’è·šçš„èµ°æ³•ï¼Œå› ä¸ºç§»åŠ¨é€Ÿåº¦ä¸æ’å®šï¼Œä¼šæ»‘æ­¥ï¼ˆå¸¸è§ä¸§å°¸ã€è€äººä¹‹ç±»çš„æ…¢èµ°ï¼‰ã€‚

è€Œ Root Motion æ§åˆ¶å®Œå…¨ä¸ä¼šæ»‘æ­¥ï¼ŒåŠ¨ç”»é‡Œæ€ä¹ˆç§»åŠ¨ï¼Œæ¸¸æˆé‡Œå°±ä¼šæ€ä¹ˆç§»åŠ¨ã€‚ç¼ºç‚¹å°±æ˜¯å®ç°å¤æ‚ï¼Œå¯æ§æ€§å·®ï¼Œå¯¹è”æœºæ”¯æŒä¸å¤Ÿï¼ˆæ— æ³•é¢„æµ‹ä¸‹ä¸€å¸§æ—¶è§’è‰²çš„ä½ç½®ï¼‰ï¼Œç½‘ç»œå·®çš„æ—¶å€™ä¼šå¾ˆç³Ÿç³•ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœèƒ¶å›Šä½“åœ¨å‘å‰ç§»åŠ¨ï¼Œç³»ç»Ÿå°±ä¼šçŸ¥é“åœ¨è§’è‰²ä¸Šæ’­æ”¾ä¸€ä¸ªè·‘æ­¥æˆ–è¡Œèµ°çš„åŠ¨ç”»ï¼Œè®©è§’è‰²çœ‹èµ·æ¥æ˜¯åœ¨é è‡ªå·±çš„åŠ›é‡ç§»åŠ¨ã€‚ä½†è¿™ç§ç±»å‹çš„è¿åŠ¨å¹¶ä¸å§‹ç»ˆé€‚ç”¨äºæ‰€æœ‰æƒ…å†µã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè®©å¤æ‚çš„åŠ¨ç”»å®é™…é©±åŠ¨ç¢°æ’èƒ¶å›Šä½“ï¼ˆè€Œéç›¸åï¼‰æ˜¯æœ‰é“ç†çš„ã€‚è¿™æ­£æ˜¯ æ ¹è¿åŠ¨ï¼ˆRoot Motionï¼‰ å¤„ç†å¯¹æ¸¸æˆè€Œè¨€è‡³å…³é‡è¦çš„åŸå› ä¹‹æ‰€åœ¨ã€‚

ä¾‹å¦‚ï¼Œå‡è®¾ç©å®¶å‘èµ·ä¸€æ¬¡ç‰¹æ®Šæ”»å‡»ï¼Œåœ¨è¿™ç§æ”»å‡»ä¸­ï¼Œæ¨¡å‹å·²é¢„å…ˆè®¾å®šå¥½å‘å‰å†²çš„åŠ¨ä½œã€‚å¦‚æœæ‰€æœ‰çš„è§’è‰²åŠ¨ä½œéƒ½æ˜¯åŸºäºç©å®¶èƒ¶å›Šä½“çš„ï¼Œè¿™æ ·çš„åŠ¨ç”»ä¼šå¯¼è‡´è§’è‰²è¿ˆå‡ºèƒ¶å›Šä½“ï¼Œä»è€Œåœ¨äº‹å®ä¸Šå¤±å»ç¢°æ’ã€‚ä¸€æ—¦åŠ¨ç”»æ’­æ”¾ç»“æŸï¼Œç©å®¶å°±ä¼šæ»‘å›å…¶ç¢°æ’ä½ç½®ã€‚è¿™å°±ä¼šäº§ç”Ÿé—®é¢˜ï¼Œå› ä¸ºèƒ¶å›Šä½“é€šå¸¸ç”¨ä½œæ‰€æœ‰è®¡ç®—çš„ä¸­å¿ƒã€‚èƒ¶å›Šä½“å¤–çš„è§’è‰²å°†è¶Šè¿‡å‡ ä½•ä½“ï¼Œä¸ä¼šå¯¹å…¶ç¯å¢ƒåšå‡ºé€‚å½“çš„ååº”ã€‚å¦å¤–ï¼Œåœ¨åŠ¨ç”»ç»“æŸæ—¶æ»‘å›ä»–ä»¬çš„èƒ¶å›Šä½“ä¹Ÿå¹¶ä¸ç°å®ã€‚

å¯¹äºé‚£äº›åˆšåˆšæ¥è§¦è¿™ä¸ªæ¦‚å¿µçš„äººæ¥è¯´ï¼Œä»…ä»…é˜…è¯»è¯´æ˜æœªå¿…èƒ½æ˜¾ç„¶åœ°æ˜ç™½åˆé€‚æ ¹è¿åŠ¨ï¼ˆRoot Motionï¼‰çš„é‡è¦æ€§ã€‚

ç®€å•åœ°è¯´ï¼Œæ ¹è¿åŠ¨ï¼ˆRoot Motionï¼‰æ˜¯åŸºäºéª¨æ¶æ ¹éª¨éª¼åŠ¨ç”»çš„è§’è‰²è¿åŠ¨ã€‚æ¸¸æˆä¸­çš„å¤§å¤šæ•°åŠ¨ç”»éƒ½æ˜¯é€šè¿‡å¾ªç¯å¤„ç†çš„ï¼Œè§’è‰²çš„æ ¹åœ¨å¾ªç¯ä¸­ä¿æŒå›ºå®šã€‚ç„¶è€Œï¼Œå®é™…æƒ…å†µå´å¹¶éå§‹ç»ˆå¦‚æ­¤ï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨ä¸Šä¾‹ä¸­çœ‹åˆ°çš„é‚£æ ·ã€‚ä¸ºäº†å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å°†æ ¹çš„è¿åŠ¨ä»è§’è‰²ä¸­æŠ½ç¦»ï¼Œå¹¶å°†å…¶åº”ç”¨åˆ°è§’è‰²çš„èƒ¶å›Šä½“ä¸­ã€‚è¿™å°±æ˜¯UE4ä¸­æ ¹è¿åŠ¨ï¼ˆRoot Motionï¼‰çš„æœ¬è´¨ã€‚

åŠ¨ç”»çš„æ ¹è¿åŠ¨ï¼ˆRoot Motionï¼‰å¯ä»¥åœ¨æ’­æ”¾è¿‡ç¨‹ä¸­å¯è§†åŒ–ã€‚åªéœ€æ‰“å¼€ä»»ä½•æ ¹éª¨éª¼ç§»åŠ¨çš„åŠ¨ç”»ï¼Œåœ¨è§†å£ä¸­é€‰æ‹© æ˜¾ç¤º > éª¨éª¼ï¼ˆShow > Bonesï¼‰ å³å¯ã€‚å¦‚æœå°šæœªåœ¨åŠ¨ç”»å±æ€§ä¸­é€‰æ‹© å¯ç”¨æ ¹è¿åŠ¨ï¼ˆEnable Root Motionï¼‰ï¼Œå½“è§’è‰²çš„æ ¹ç§»åŠ¨æ—¶ï¼Œä½ ä¼šçœ‹åˆ°ä¸€æ¡çº¢çº¿ã€‚è¿™è¯´æ˜äº†åŠ¨ç”»çš„æ ¹è¿åŠ¨ï¼ˆRoot Motionï¼‰ã€‚

å¯ç”¨æ ¹è¿åŠ¨ï¼ˆRoot Motionï¼‰åï¼Œè¿™æ¡çº¢çº¿å°†æ¶ˆå¤±ã€‚è€Œè§’è‰²å°†ç§»åŠ¨åˆ°ä½ã€‚è¿™æ˜¯å› ä¸ºï¼Œè§’è‰²çš„æ ¹å°†ä¸å†ä»åŸå§‹ä½ç½®ç§»åŠ¨ã€‚åœ¨è¿™ä¸ªå›¾åƒä¸­ï¼Œæˆ‘ä»¬åœ¨è§’è‰²ä¸Šå¯ç”¨äº†æ ¹è¿åŠ¨ï¼ˆRoot Motionï¼‰ã€‚è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ä¸ä¸Šé¢çš„å›¾åƒå¤„äºåŒä¸€å¸§ï¼Œä½†æ˜¯è§’è‰²çš„ä½ç½®æ²¡æœ‰æ”¹å˜ã€‚

ä½ å¯ä»¥åœ¨ Animation Editor ä¸­çš„ Asset Details -> Root Motion é¢æ¿ä¸­ä¸ºä½ çš„åŠ¨ç”»åºåˆ—å¯ç”¨æ ¹è¿åŠ¨ã€‚


### âœ’ Blend Spaces æ··åˆç©ºé—´
- https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/Blendspaces/
- æ··åˆç©ºé—´æ€»è§ˆ https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/Blendspaces/Overview/

æ··åˆç©ºé—´ï¼ˆBlend Spaceï¼‰ æ˜¯å¯ä»¥åœ¨ åŠ¨ç”»å›¾ï¼ˆAnimGraphï¼‰ä¸­é‡‡æ ·çš„ç‰¹æ®Šèµ„æºï¼Œ å…è®¸æ ¹æ®ä¸¤ä¸ªè¾“å…¥çš„å€¼æ··åˆåŠ¨ç”»ã€‚è¦æ ¹æ®ä¸€ä¸ªè¾“å…¥åœ¨ä¸¤ä¸ªåŠ¨ç”»ä¹‹é—´å®ç°ç®€å•æ··åˆï¼Œ å¯ä»¥ä½¿ç”¨åŠ¨ç”»è“å›¾ä¸­æä¾›çš„ä¸€ä¸ªæ ‡å‡† æ··åˆèŠ‚ç‚¹ã€‚æ··åˆç©ºé—´æä¾›çš„æ–¹æ³•æ˜¯æ ¹æ®å¤šä¸ªå€¼ï¼ˆç›®å‰ä»…é™äºä¸¤ä¸ªï¼‰ åœ¨å¤šä¸ªåŠ¨ç”»ä¹‹é—´è¿›è¡Œæ›´å¤æ‚çš„æ··åˆã€‚

æ··åˆç©ºé—´çš„ç›®çš„æ˜¯é¿å…åˆ›å»ºå•ä¸ªç¡¬ç¼–ç èŠ‚ç‚¹ æ¥æ ¹æ®ç‰¹å®šå±æ€§æˆ–æ¡ä»¶æ‰§è¡Œæ··åˆã€‚é€šè¿‡å…è®¸åŠ¨ç”»å¸ˆæˆ–ç¨‹åºå‘˜æŒ‡å®šè¾“å…¥ã€åŠ¨ç”» ä»¥åŠå¦‚ä½•ä½¿ç”¨è¾“å…¥æ¥æ··åˆåŠ¨ç”»ï¼Œå‡ ä¹å¯ä»¥ä½¿ç”¨é€šç”¨ æ··åˆç©ºé—´æ‰§è¡Œä»»ä¸€ç±»å‹çš„æ··åˆã€‚

æ··åˆç©ºé—´ åˆ©ç”¨åŸºäºç‰¹å®šå±æ€§æˆ–æ¡ä»¶è¿›è¡Œæ··åˆçš„èµ„æºï¼Œé™ä½åˆ›å»ºå•ä¸ªç¡¬ç¼–ç èŠ‚ç‚¹è¿›è¡Œæ··åˆåŠ¨ç”»çš„éœ€æ±‚ã€‚å®ƒä½¿åŠ¨ç”»å¸ˆæˆ–ç¨‹åºå‘˜èƒ½å¤ŸæŒ‡å®šè¾“å…¥ã€åŠ¨ç”»ï¼Œä»¥åŠè¾“å…¥åœ¨åŠ¨ç”»ä¹‹é—´è¿›è¡Œæ··åˆçš„æ–¹å¼ï¼Œå®é™…ä¸Šä»»ä½•ç±»å‹çš„æ··åˆéƒ½èƒ½é€šè¿‡æ··åˆç©ºé—´æ³›å‹æ¥æ‰§è¡Œã€‚

è¿™ä¸åŠ¨ç”»æ ‘åœ¨è™šå¹»å¼•æ“ 3 ä¸­æ‰§è¡Œç›¸åŒä»»åŠ¡çš„åŸç†å®Œå…¨ç›¸åã€‚ä»»ä½•å¤æ‚æ··åˆéƒ½éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°èŠ‚ç‚¹æ¥å¤„ç†æ··åˆã€‚è€Œæ··åˆç©ºé—´æ˜¯å®Œå…¨çš„æ³›å‹ï¼Œå†³å®šæ··åˆçš„å› ç´ åœ¨æ¯ä¸ªå•ç‹¬çš„æ··åˆç©ºé—´ä¸Šå‡æœ‰æ‰€ä¸åŒã€‚æ¯ä¸ªæ··åˆç©ºé—´å‡æœ‰è¾“å…¥ï¼Œå¯æ¥æ”¶æ•°å€¼ã€‚è¿™äº›æ•°å€¼å¯åœ¨ åŠ¨ç”»è“å›¾ çš„æ›´æ–°å‘¨æœŸä¸­è¿›è¡Œè®¡ç®—ï¼ˆé€šè¿‡ EventGraphï¼‰ï¼Œç”±æ¸¸æˆæ€§ä»£ç æˆ–å…¶ä»–æ–¹å¼é©±åŠ¨ï¼ˆå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼‰ã€‚è¿™äº›ç‰¹æ€§ä½¿å¾—æ··åˆç©ºé—´çµæ´»æ€§æå¼ºï¼Œå¯æŠŠä¸»åŠ¨æƒäº¤åˆ° AnimGraph çš„åˆ›å»ºè€…æ‰‹ä¸­ï¼Œä»¥ç¬¦åˆå…¶éœ€æ±‚çš„æ–¹å¼æ··åˆåŠ¨ç”»ã€‚

    +============+   +==============+  +=======+
    | EventGraph |   | Gameplay Code|  | Other |
    +============+   +==============+  +=======+
           |               |               |
           +---------------+------------+--+
           |                            |
    +======v=====+                +=====v======+
    | Variable 1 |                | Variable 2 |
    +============+                +============+
           |                            |
    +======v============================v======+
    |   Input 1                    Input 2     |
    |               Blendspace                 |
    |               OutputPose                 |
    +==========================================+
                        |
                +=======v======+
                |     Pose     |
                +==============+

äº‹ä»¶å›¾è¡¨ã€æ¸¸æˆæ€§ä»£ç æˆ–é©±åŠ¨ç€æ¯ä¸ªå˜é‡ã€‚åä¹‹ï¼Œè¿™äº›å˜é‡å†³å®šæ··åˆç©ºé—´ä¸­çš„å“ªä¸ªåŠ¨ä½œå°†ç”¨ä½œæœ€ç»ˆåŠ¨ä½œã€‚

æ··åˆç©ºé—´å¯è¢«è§†ä¸ºä¸€ä¸ª 2D å›¾è¡¨ï¼Œæ¯ä¸ªè¾“å…¥å€¼å‡æ²¿ä¸€æ ¹è½´ï¼ŒåŠ¨ç”»åˆ™åˆ†å¸ƒåœ¨å›¾è¡¨ä¸Šçš„å„ç‚¹å¤„ã€‚æ··åˆåŠ¨ç”»ç”±å›¾è¡¨ä¸ŠåŠ¨ç”»ä¹‹é—´çš„æ··åˆåŸºäºå½“å‰è¾“å…¥å€¼æ‰€æŒ‡å®šçš„ä½ç½®è¿›è¡Œè®¡ç®—ã€‚ ä¸¾ä¾‹è€Œè¨€ï¼Œå®šå‘è·‘æ­¥åŠ¨ç”»å’Œå¾…æœºåŠ¨ç”»ä¹‹é—´çš„æ··åˆå°±æ˜¯åŸºäºè§’è‰²ç§»åŠ¨çš„æ–¹å‘å’Œé€Ÿåº¦ã€‚

åˆ›å»º Blend Space å’Œ Blend Space 1D èµ„æºå¹¶è®¾ç½®å…³è”çš„éª¨æ¶ï¼š

- åœ¨å†…å®¹æµè§ˆå™¨æ–°å»º Animation -> Blend Space æˆ–è€… Blend Space 1Dã€‚
- åœ¨é€‰å–éª¨æ¶ï¼ˆPick Skeletonï¼‰å¯¹è¯æ¡†ä¸­ï¼Œé€‰æ‹©åº”ä½œä¸ºæ··åˆç©ºé—´ç›®æ ‡çš„éª¨æ¶ã€‚
- æ ¹æ®é¡¹ç›®ä¸­çš„éª¨æ¶èµ„æºæ•°é‡ï¼Œèµ„æºåˆ—è¡¨å¯èƒ½æœ‰æ‰€ä¸åŒã€‚
- è¾“å…¥æ–°çš„æ··åˆç©ºé—´èµ„æºçš„åç§°ã€‚
- å¦‚æœåŠ¨ç”»è“å›¾ä¸æ··åˆç©ºé—´å…·æœ‰ç›¸åŒçš„ç›®æ ‡éª¨æ¶ï¼Œåˆ™è¯¥æ··åˆç©ºé—´ä¹Ÿå¯ä»¥åœ¨è¯¥åŠ¨ç”»è“å›¾çš„ åŠ¨ç”»å›¾ï¼ˆAnim Graphï¼‰ ä¸­ä½¿ç”¨ã€‚

åˆ›å»ºæ··åˆç©ºé—´åï¼ŒåŒå‡»æ‰“å¼€ç¼–è¾‘å™¨ï¼Œå¯ä»¥å¼€å§‹åˆ›å»ºåŸºäºè¿åŠ¨çš„æ··åˆæˆ–æ‰€éœ€çš„æ··åˆæ•ˆæœã€‚

éœ€è¦å®šä¹‰ è½´è®¾ç½®ï¼ˆAxis Settingsï¼‰ï¼ˆé©±åŠ¨æ··åˆçš„å±æ€§ï¼‰ä»¥åŠæŒ‡å®šè¦ç”¨ä½œ æ ·æœ¬å§¿åŠ¿ï¼ˆSample Posesï¼‰ çš„åŠ¨ç”»ã€‚ å®šä¹‰è¿™ä¸¤ä¸ªå…ƒç´ åï¼Œå¯ä»¥é€šè¿‡æ›´æ”¹ æ··åˆç©ºé—´èµ„æº"ç»†èŠ‚ï¼ˆDetailsï¼‰" é¢æ¿ä¸­çš„å±æ€§æ¥è¿›ä¸€æ­¥è°ƒæ•´æ··åˆç©ºé—´ã€‚

åœ¨ç½‘æ ¼ä¸Šæ”¾ç½®ä¸€äº›æ ·æœ¬å§¿åŠ¿åï¼ŒæŒ‰ä½ Shift é”®å¹¶å››å¤„æ‹–åŠ¨ç»¿è‰²è±å½¢ä»¥æŸ¥çœ‹å§¿åŠ¿ä¹‹é—´çš„æ··åˆæ•ˆæœã€‚

åœ¨åŠ¨ç”»è“å›¾çš„ åŠ¨ç”»å›¾ï¼ˆAnimGraphï¼‰ä¸­æ”¾å…¥èŠ‚ç‚¹ï¼Œè¿™äº›èŠ‚ç‚¹ä½¿ç”¨æ•°å€¼æ•°æ®æ¥æ¨åŠ¨åŠ¨ç”»æ··åˆå¹¶ç”Ÿæˆæœ€ç»ˆåŠ¨ç”»å§¿åŠ¿ã€‚

æ··åˆç©ºé—´èŠ‚ç‚¹æä¾›å¯¹æ··åˆç©ºé—´çš„æ ·æœ¬å‚æ•°æ•°æ®å’Œè¾“å‡ºå§¿åŠ¿çš„è®¿é—®ã€‚

è¦ä½¿ç”¨æ‹–æ”¾æ¥æ”¾ç½®æ··åˆç©ºé—´èŠ‚ç‚¹ï¼š

- åœ¨ åŠ¨ç”»è“å›¾ çš„AnimGraphä¸­ï¼Œåœ¨ èµ„æºæµè§ˆå™¨ï¼ˆAsset Browserï¼‰ æŸ¥æ‰¾è¦é‡‡æ ·çš„æ··åˆç©ºé—´ã€‚
- å•å‡»è¯¥èµ„æºï¼Œå¹¶æ‹–åŠ¨é¼ æ ‡è‡³ åŠ¨ç”»å›¾ï¼ˆAnimGraphï¼‰ã€‚
- æ¾å¼€ é¼ æ ‡å·¦é”® ä»¥å°†è¯¥ æ··åˆç©ºé—´ èŠ‚ç‚¹æ”¾å…¥å›¾ä¸­ã€‚

è¦ä½¿ç”¨ä¸Šä¸‹æ–‡èœå•æ”¾ç½®æ··åˆç©ºé—´èŠ‚ç‚¹ï¼š

- åœ¨ åŠ¨ç”»å›¾å½¢ï¼ˆAnimGraphï¼‰ ä¸­å•å‡»å³é”®å¹¶å±•å¼€ æ··åˆç©ºé—´ï¼ˆBlend Spacesï¼‰ï¼Œé€‰æ‹©æƒ³è¦é‡‡æ ·çš„ æ··åˆç©ºé—´ã€‚
- æ··åˆç©ºé—´ èŠ‚ç‚¹å·²æ”¾å…¥å›¾ä¸­ã€‚

æ··åˆç©ºé—´ä¾èµ–è¦ä¼ é€’åˆ°æ ·æœ¬å‚æ•°çš„æ•°æ®æ¥æ‰§è¡ŒåŠ¨ç”»æ··åˆã€‚ æ¯ä¸ªæ··åˆç©ºé—´èŠ‚ç‚¹éƒ½åŒ…å«åœ¨ç¼–è¾‘æ··åˆç©ºé—´è¿‡ç¨‹ä¸­åˆ›å»ºçš„æ¯ä¸ªæ ·æœ¬å‚æ•°çš„è¾“å…¥æ•°æ®ã€‚ æ¥è‡ªå…¶ä»–èŠ‚ç‚¹çš„å˜é‡æˆ–è¾“å‡ºå¯ä»¥è¿çº¿åˆ°è¿™äº›å¼•è„šï¼Œä»¥å°†å¿…è¦æ•°æ®ä¼ é€’ç»™æ··åˆç©ºé—´å¹¶é©±åŠ¨æ ·æœ¬å§¿åŠ¿çš„æ··åˆã€‚

ä¼ é€’ç»™æ··åˆç©ºé—´çš„å€¼é€šå¸¸æ˜¯åœ¨ äº‹ä»¶å›¾ï¼ˆEventGraphï¼‰ ä¸­çš„æ›´æ–°å¾ªç¯æˆ–é€šè¿‡æ¸¸æˆä»£ç è®¡ç®—çš„å˜é‡ã€‚

åœ¨æœ€ç®€å•çš„æƒ…å†µä¸‹ï¼Œæ··åˆç©ºé—´èŠ‚ç‚¹çš„ å§¿åŠ¿ï¼ˆPoseï¼‰ è¾“å‡ºå¼•è„šå¯ä»¥è¿çº¿åˆ° åŠ¨ç”»å›¾ï¼ˆAnimGraphï¼‰ ä¸­ ç»“æœï¼ˆResultï¼‰ èŠ‚ç‚¹çš„ å§¿åŠ¿ï¼ˆPoseï¼‰ è¾“å…¥å¼•è„šã€‚æˆ–è€…ï¼Œå¦‚æœéœ€è¦æ›´å¤æ‚çš„åŠ¨ç”»é“¾ï¼Œå¯ä»¥å°†å®ƒè¿çº¿åˆ°ä»¥åŠ¨ç”»å§¿åŠ¿ä½œä¸ºè¾“å…¥çš„ä»»æ„å…¶ä»–è¾“å…¥å¼•è„šã€‚



### âœ’ Physics Animation åŸºäºç‰©ç†çš„åŠ¨ç”»
- https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/PhysicallyDrivenAnimation/
- ç‰©ç†å†…å®¹ç¤ºä¾‹ https://docs.unrealengine.com/4.27/zh-CN/Resources/ContentExamples/Physics

åœ¨éª¨æ¶ç½‘æ ¼ç‰©ä½“ä¸Šä»¥ä»»ä½•å½¢å¼åº”ç”¨ç‰©ç†éƒ½éœ€è¦é‚£ä¸ªç½‘æ ¼ç‰©ä½“è®¾ç½® Physics Assetï¼ˆç‰©ç†èµ„æºï¼‰ï¼Œå¹¶åº”ç”¨è¯¥ç‰©ç†èµ„æºã€‚

ç»™è§’è‰²åº”ç”¨ç‰©ç†æœ‰å¾ˆå¤šç§æ–¹æ³•ï¼Œä¸¤ä¸ªä¸»è¦å·¥å…·æ˜¯ Set All Bodies Simulate Physics å’Œ Set All Bodies Below Physics Blend Weight èŠ‚ç‚¹ï¼Œä¸€èˆ¬å°†å®ƒä»¬æ”¾ç½®åœ¨ä½ çš„è§’è‰²åŠ¨ç”»è“å›¾å›¾è¡¨ä¸­ã€‚

- *Set All Bodies Below Simulate Physics* èŠ‚ç‚¹çš„ä½œç”¨æ˜¯é€’å½’åœ°æ¿€æ´»éª¨æ¶ç½‘æ ¼ç‰©ä½“ä¸Šçš„ç‰©ç†èµ„æºåˆšä½“ï¼Œä»ç»™å®šéª¨éª¼å¼€å§‹æ¨¡æ‹Ÿç‰©ç†ï¼Œå¹¶é€’å½’åœ°æ²¿ç€éª¨éª¼é“¾å‘ä¸‹ç§»åŠ¨ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ è®©å·¦é”éª¨å¼€å§‹æ¨¡æ‹Ÿï¼Œé‚£ä¹ˆåœ¨éª¨æ¶å±‚æ¬¡ç»“æ„ä¸­ä½äºå…¶ä¸‹é¢çš„æ‰€æœ‰éª¨éª¼ä¹Ÿä¼šå¼€å§‹æ¨¡æ‹Ÿï¼Œæœ€ç»ˆäº§ç”Ÿä¸€æ¡æŸ”è½¯çš„æˆ–è€…æ˜¯ç±»ä¼¼äºå¸ƒå¨ƒå¨ƒæ•ˆæœçš„æ‰‹è‡‚ã€‚ç®€å•åœ°è¯´ï¼Œä½ å¯ä»¥æŠŠè¿™ä¸ªèŠ‚ç‚¹çœ‹æˆä¸€ä¸ªç”¨äºå¯åŠ¨æˆ–æš‚åœä»ç‰¹å®šèŠ‚ç‚¹å¼€å§‹æ¨¡æ‹Ÿç‰©ç†çš„å¼€å…³ã€‚

- *Set All Bodies Below Physics Blend Weight*
è¯¥èŠ‚ç‚¹ç®€å•åœ°æ§åˆ¶ç‰©ç†èµ„æºå¯¹åŠ¨ç”»éª¨æ¶ç½‘æ ¼ç‰©ä½“å½±å“çš„ç¨‹åº¦ã€‚æƒé‡å€¼ä¸º 1.0ï¼Œåˆ™ä½¿ç”¨ç‰©ç†é©±åŠ¨ç»™å®šéª¨éª¼åŠè¯¥éª¨éª¼ä¸‹çš„æ‰€æœ‰éª¨éª¼ã€‚æƒé‡å€¼ä¸º 0.0ï¼Œåˆ™éª¨æ¶ç½‘æ ¼ç‰©ä½“è¿”å›åˆ°å…¶åˆå§‹å…³é”®å¸§åŠ¨ç”»ã€‚é€šå¸¸ï¼Œä½ è¦åœ¨æ¯æ¬¡æ›´æ–°æ—¶é©±åŠ¨è¯¥èŠ‚ç‚¹ï¼Œä»¥ä¾¿ä½ å¯ä»¥å¹³æ»‘åœ°æ”¹å˜ç‰©ç†æ··åˆæƒé‡çš„å€¼ã€‚

åŸºäºç¢°æ’çš„ç‰©ç†ååº”æ˜¯è§’è‰²æ¨¡æ‹Ÿçš„å¸¸ç”¨æƒ…å½¢ï¼Œæ¯”å¦‚ï¼Œå½“è§’è‰²è¢«å°„å¼¹å‡»ä¸­æ—¶ã€‚ä»é«˜çš„å±‚æ¬¡æ¥è®²ï¼Œè¿™è¦æ±‚ä½ ï¼š

- è·å¾—ç¢°æ’åˆ°çš„éª¨éª¼çš„åç§°ã€‚è¿™å¯ä»¥é€šè¿‡é€Ÿæ•ˆæ­¦å™¨çš„è¸ªè¿¹æ¥å®Œæˆï¼Œæˆ–è€…åœ¨å°„å¼¹ç±»çš„é€‚å½“åœ°æ–¹å®Œæˆã€‚
- å°†é‚£ä¸ªéª¨éª¼åç§°ä¼ é€’åˆ°è§’è‰²çš„åŠ¨ç”»è“å›¾ä¸­ï¼Œä»¥ä¾›äº‹ä»¶å›¾è¡¨ä½¿ç”¨, ä¸€èˆ¬é€šè¿‡ *Set All Bodies Below Simulate Physics* èŠ‚ç‚¹å®Œæˆã€‚è¿™æ¿€æ´»äº†æ¨¡æ‹Ÿç³»ç»Ÿã€‚
- é€šè¿‡ *Set All Below Physics Blend Weight* èŠ‚ç‚¹æ§åˆ¶ç‰©ç†æ··åˆæƒé‡å±æ€§ã€‚ä¸€èˆ¬ï¼Œä½ ä¼šæƒ³å¿«é€Ÿåœ°ä½¿å®ƒå¢åŠ åˆ° 1.0ï¼Œç„¶ååœ¨ä¸‹é™å›åˆ° 0.0ï¼Œä»¥ä¾¿ç‰©ç†ååº”æ··å…¥ç„¶åå†æ··å‡ºã€‚è¿™ä¸€èˆ¬åœ¨åŠ¨ç”»è“å›¾çš„äº‹ä»¶å›¾è¡¨ä¸­å®Œæˆã€‚
- ä¸€æ—¦ååº”å®Œæˆä¸”ç‰©ç†æ··åˆæƒé‡è¿”å›ä¸º0ï¼Œé‚£ä¹ˆä½ åº”è¯¥å†æ¬¡ä½¿ç”¨ *Set All Bodies Below Simulate Physics* èŠ‚ç‚¹æ¥ç¦ç”¨è¯¥æ¨¡æ‹Ÿã€‚



# ğŸŒŸ Cartoon NPR æ¸²æŸ“
- Real-Time Hatching, Appears in SIGGRAPH 2001 https://gfx.cs.princeton.edu/proj/hatching/
- å…³äºéå®æ„Ÿå›¾å½¢å­¦æˆ–è€…é£æ ¼åŒ–æ¸²æŸ“æœ‰å“ªäº›å¥½çš„ä¹¦æˆ–è€…paperï¼Ÿ https://www.zhihu.com/question/32078473
- éå®æ„Ÿå›¾å½¢å­¦ https://zhuanlan.zhihu.com/p/84075550
- Unity shader åå¤„ç†å®ç°æ°´å¢¨é£æ ¼æ¸²æŸ“ã€ŒLow æš´äº†ã€ https://zhuanlan.zhihu.com/p/34406208
- UE5åˆ¶ä½œå¡é€šç€è‰²çš„æ–¹æ³•ï¼ https://www.bilibili.com/video/BV1vT4y1Z7RQ

å›¾å½¢å­¦æ¸²æŸ“é£æ ¼ä¸»è¦åˆ†ä¸ºçœŸå®æ„Ÿæ¸²æŸ“ (Photorealistic Rendering)å’ŒéçœŸå®æ„Ÿæ¸²æŸ“ (Non-photorealistic renderingï¼ŒNPR)ä¸¤å¤§ç±»ã€‚ çœŸå®æ„Ÿæ¸²æŸ“ç›®çš„åœ¨äºæ¸²æŸ“å‡ºç›¸ç‰‡çº§åˆ«çš„ç”»é¢çœŸå®æ„Ÿï¼Œè€ŒéçœŸå®æ„Ÿæ¸²æŸ“çš„ç›®çš„æ›´åŠ çš„å¤šæ ·ï¼Œä¸»è¦åœ¨äºæ¨¡æ‹Ÿè‰ºæœ¯åŒ–çš„ç»˜åˆ¶é£æ ¼ï¼Œå‘ˆç°å‡ºæ‰‹ç»˜çš„æ•ˆæœã€‚å¸¸è§çš„éçœŸå®æ¸²æŸ“æŠ€æœ¯åŒ…æ‹¬å¡é€šæ¸²æŸ“ã€æ²¹ç”»æ¸²æŸ“ã€åƒç´ æ„Ÿæ¸²æŸ“ã€é“…ç¬”ç”»ã€ç´ æç”»ã€èœ¡ç¬”ç”»å’Œæ°´å¢¨ç”»ç­‰ç±»å‹ã€‚

ç´ æ(Hatching)æ˜¯éå¸¸æµè¡Œçš„éçœŸå®æ¸²æŸ“é£æ ¼ã€‚ç°åœ¨ç´ æç®—æ³•å¤§å¤šéƒ½åŸºäº Praun ç­‰äººåœ¨ 2001 å¹´å‘è¡¨çš„ Real-Time Hatching è®ºæ–‡ï¼Œæ–‡ä¸­æè¿°äº†å¦‚ä½•é€šè¿‡æå‰ç”Ÿæˆçš„ç´ æçº¹ç†æ¥å®ç°å®æ—¶çš„ç´ æé£æ ¼æ¸²æŸ“ï¼Œè®ºæ–‡ä¸­å°†è¿™ç»„çº¹ç†æˆä¸ºè‰²è°ƒè‰ºæœ¯å›¾(Tonal Art Mapï¼ŒTAM)ã€‚è‰²è°ƒè‰ºæœ¯å›¾ä»å·¦åˆ°å³ç¬”ç”»é€æ¸å¢å¤šï¼Œç”¨æ¥æ¨¡æ‹Ÿç‰©ä½“æ¼«åå°„çš„æ•ˆæœã€‚åŒä¸€åˆ—ä¸åŒåˆ†è¾¨ç‡çš„çº¹ç†ä»£è¡¨çš„æ˜¯å¤šçº§æ¸è¿›çº¹ç†ï¼Œç”¨æ¥æ›´å¥½çš„æ¨¡æ‹Ÿè¿œç¦»æ‘„åƒæœºçš„ç‰©ä½“ã€‚TAM å›¾é—´çš„ç¬”è§¦æ˜¯æœ‰ä¸€å®šè®²ç©¶çš„ï¼Œå³è¾¹çº¹ç†å›¾ç¬”è§¦å¿…é¡»åŒ…å«å·¦è¾¹çš„ç¬”è§¦ï¼Œå¦‚æœæ²¡æœ‰éµå¾ªè¿™ä¸ªè§„åˆ™çš„è¯ï¼Œå¾—åˆ°çš„ç´ ææ•ˆæœä¼šéå¸¸å¥‡æ€ªã€‚è®ºæ–‡ç»™å‡ºäº†è‡ªåŠ¨ç”Ÿæˆ TAM çš„æ–¹æ³•ï¼Œé™¤äº†ä½¿ç”¨å…­å¼ çº¹ç†å›¾ä¹‹å¤–ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹çº¹ç†å›¾è¿›è¡Œ pack å¾—åˆ°ä¸¤å¼  RGB çº¹ç†å›¾ï¼ŒRGB ä¸‰ä¸ªé€šé“åˆ†åˆ«å¯¹åº”å‰ä¸‰å¼ å’Œåä¸‰å¼ çº¹ç†å›¾çš„çº¹ç†ä¿¡æ¯ã€‚

æè¾¹ Outline rendering å‡ ä¹æ˜¯æ‰€æœ‰éçœŸå®æ„Ÿæ¸²æŸ“éƒ½éœ€è¦å®ç°çš„æ•ˆæœï¼Œåªä¸è¿‡ä¸åŒçš„æ¸²æŸ“é£æ ¼æœ‰ä¸åŒçš„æè¾¹ç»†èŠ‚ã€‚

Real-Time Rendering ä¸€ä¹¦ä¸­å°†æè¾¹æŠ€æœ¯åˆ†ä¸ºäº†ä»¥ä¸‹äº”å¤§ç±»ï¼š

- åŸºäºæ³•çº¿å’Œè§†è§’çš„æè¾¹( Shading Normal Contour Edges)
- è¿‡ç¨‹å¼çš„å‡ ä½•æè¾¹( Procedural Geometry Silhouetting)
- åŸºäºå›¾ç‰‡å¤„ç†çš„æè¾¹( Edge Detection by Image Processing)
- åŸºäºè½®å»“çº¿æ£€æµ‹çš„æè¾¹( Geometric Contour Edge Detection)
- æ··åˆä»¥ä¸Šå‡ ç§æè¾¹æ–¹æ³•(Hybrid Silhouetting)

å…¶ä¸­ï¼Œä½¿ç”¨çš„æœ€å¤šçš„æ˜¯åŸºäºæ³•çº¿å’Œè§†è§’çš„æè¾¹ã€è¿‡ç¨‹å¼å‡ ä½•æè¾¹å’ŒåŸºäºå›¾ç‰‡å¤„ç†çš„æè¾¹ä¸‰ç§æ–¹æ³•ã€‚

å¡é€šæ¸²æŸ“çš„ç€è‰²æ–¹å¼ä¸»è¦åŒ…æ‹¬å¡é€šç€è‰²(Cel Shading)å’ŒåŸºäºè‰²è°ƒçš„ç€è‰²(Tone Based Shading)ä¸¤ç§ã€‚å¡é€šæ¸²æŸ“æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„ç‰¹ç‚¹å°±æ˜¯è‰²é˜¶å°‘ï¼Œç€è‰²å‘ˆç°å—çŠ¶æ„Ÿï¼Œè¿™äº›æ•ˆæœéƒ½å¯ä»¥åœ¨ç€è‰²æ–¹å¼ä¸­è¿›è¡Œå®ç°ã€‚è¿™ä¸¤ç§ç€è‰²æ–¹å¼çš„ä¸»è¦åŒºåˆ«åœ¨äºè‰²å—çš„é£æ ¼å’Œè‰²å—çš„è¾¹ç•Œå¤„ç†ä¸Šï¼Œå¾—åˆ°çš„æ•ˆæœä¼šæœ‰è¾ƒå¤§çš„åŒºåˆ«ã€‚

å¡é€šç€è‰²ä¸€èˆ¬ä¼šæ ¹æ®NdotL = dot(normalï¼ŒlightDir)çš„ç»“æœæŒ‡å®šä¸åŒçš„é¢œè‰²å€¼ï¼Œæ¥æ¨¡æ‹Ÿå¡é€šè‰²å—çš„ç€è‰²æ•ˆæœï¼›é™¤äº†è¿™ç§æ–¹æ³•ä¹‹å¤–ï¼Œæ›´å¸¸è§çš„å¤„ç†æ–¹å¼æ˜¯åˆ©ç”¨ NdotL çš„ç»“æœä»ä¸€ç»´æ¸å˜çº¹ç† RampTexture ä¸­è¿›è¡Œé‡‡æ ·ã€‚


# ğŸŒŸ Building Virtual World
- æ„å»ºè™šæ‹Ÿä¸–ç•Œ https://docs.unrealengine.com/4.27/zh-CN/BuildingWorlds


## âš¡ Lights å…‰ç…§
- å…‰ç…§ä¸é˜´å½± https://docs.unrealengine.com/4.27/zh-CN/BuildingWorlds/LightingAndShadows/
- å…¨å±€å…‰ç…§ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/GlobalIllumination/
- å…‰æºç±»å‹ https://docs.unrealengine.com/4.27/zh-CN/BuildingWorlds/LightingAndShadows/LightTypes/

åœ¨è™šå¹»å¼•æ“ 4 ä¸­ï¼Œæœ‰æ•°ä¸ªå…³é”®å±æ€§ä¼šå¯¹åœºæ™¯ä¸­çš„å…‰ç…§äº§ç”Ÿè¾ƒå¤§å½±å“ã€‚

`Intensity`å¼ºåº¦å†³å®šç€å…‰çº¿è¾“å‡ºåˆ°åœºæ™¯ä¸­çš„èƒ½é‡ã€‚å¯¹ Point Light å’Œ Spot Light è€Œè¨€ï¼Œè¿™ä»¥æµæ˜ä¸ºå•ä½ï¼Œ1700æµæ˜åˆ™ç›¸å½“äºä¸€ä¸ª100Wçš„ç”µç¯æ³¡ã€‚

`Light Color`å…‰æºé¢œè‰²ï¼Œç¼–è¾‘å™¨ä¸­ä»£è¡¨å…‰æºçš„spriteä¹Ÿå°†è°ƒæ•´é¢œè‰²è¿›è¡ŒåŒ¹é…ã€‚

`Attenuation Radius` å…‰æºçš„è¡°å‡åŠå¾„å†³å®šå…‰çº¿å¯è¾¾çš„èŒƒå›´ï¼Œå®šä¹‰å…‰çº¿å½±å“çš„å¯¹è±¡ï¼Œå¹¶ä¸”è®¡ç®—å…‰æºè¡°å‡æ—¶å°†å…¶ç”¨ä½œå¤–è¾¹ç•Œã€‚å…‰æºè¡°å‡åŠå¾„ä¼šå¯¹æ€§èƒ½äº§ç”Ÿä¸¥é‡å½±å“ï¼Œæ‰€ä»¥è¦å°½é‡å°‘ä½¿ç”¨è¾ƒå¤§çš„åŠå¾„å€¼ã€‚

æºåŠå¾„ï¼ˆ`Source Radius`ï¼‰å’Œæºé•¿åº¦ï¼ˆ`Source Length`ï¼‰éœ€è¦ç‰¹åˆ«å…³æ³¨ï¼Œå› ä¸ºå®ƒä»¬å°†å®šä¹‰è¡¨é¢ä¸Šåå°„é«˜å…‰çš„å¤§å°ã€‚

æ¸²æŸ“å…‰ç…§è´´å›¾æ—¶å®ƒä»¬è¿˜åœ¨ Lightmass ä¸­å­˜åœ¨å½±å“ã€‚è¾ƒå¤§åŠå¾„çš„å…‰æºå°†æŠ•å°„æ›´æŸ”å’Œçš„é˜´å½±ï¼ˆä¾‹å¦‚å¤šæ•°ä¸»è¦3Dåˆ¶ä½œåŒ…ä¸­çš„åŒºåŸŸå…‰æºï¼‰ã€‚å› å…¶ç”± Lightmass è¿›è¡Œå¤„ç†ï¼Œæ‰€ä»¥åªæœ‰ é™æ€ å…‰æºå°†è·å¾—æ•ˆæœã€‚

æ³¨æ„äº‹é¡¹ï¼š

- ç•™æ„è§†å£çš„ Scalability è®¾ç½®ï¼Œå¦‚æœ Shadows è®¾ç½®ä¸º High ä»¥ä¸‹çš„çº§åˆ«ï¼Œå¼•æ“å°†ä¼šè¿‡æ»¤æ‰å¤§é‡çš„é˜´å½±æ•ˆæœã€‚
- å¦‚æœç¯å…‰è®¾ç½®ä¸ºé™æ€ï¼Œå¹¶ä¸”æ²¡æœ‰æ„å»ºé‚£åœºæ™¯ä¸­çš„å…‰ç…§ï¼Œåˆ™é˜´å½±æœ‰ Preview é¢„è§ˆå­—æ ·ï¼Œå¯ä»¥å°†ç¯å…‰å¯ç§»åŠ¨å±æ€§ä» Static æ”¹ä¸º Movableï¼Œæˆ–è€…æ„å»ºé¡¹ç›®çš„å…‰ç…§ä¿¡æ¯ã€‚
- å¯¹äºç›´å°„å…‰ï¼Œå¯ä»¥è®¾ç½® Cascaded Shadow Maps -> Dynamic Shadow Distance Stationary/Dynamic Lightã€‚
- å…‰æºè®¾ç½® Light -> Cast Shadows å’Œ Affect World æ¿€æ´»æ—¶æ‰ä¼šæŠ•èº«é˜´å½±ï¼Œå¹¶ä¸”å‹¾é€‰ Cast Static/Dynamic Shadows æ‰ä¼šå¯¹é™æ€/åŠ¨æ€ç‰©ä½“æŠ•å½±çš„é˜´å½±æœ‰å“åº”ã€‚
- ä½¿ç”¨è·ç¦»åœºé˜´å½±éœ€è¦åœ¨ Distance Field Shadows å±æ€§é¢æ¿ï¼Œä¸ºå…‰æºå¯ç”¨è·ç¦»åœºé˜´å½±ã€‚

è™šå¹»å¼•æ“ 4 ä¸­æœ‰å››ç§å…‰æºç±»å‹ï¼š

- Directional Light å®šå‘å…‰æºä¸»è¦ç”¨ä½œä¸ºåŸºæœ¬çš„å®¤å¤–å…‰æºï¼Œæˆ–è€…ç”¨ä½œæ¥è¿‘äºæ— é™è¿œå¤„å‘å‡ºçš„å…‰çš„ä»»ä½•å…‰æºï¼› 
- Point Light ç‚¹å…‰æºåƒä¼ ç»Ÿçš„"ç¯æ³¡"ä¸€æ ·çš„å…‰æºï¼Œä»ä¸€ä¸ªå•ç‹¬çš„ç‚¹å¤„å‘å„ä¸ªæ–¹å‘å‘å…‰ï¼›
- Spot Light èšå…‰æºä¹Ÿæ˜¯ä»ä¸€ä¸ªå•ç‹¬çš„ç‚¹å¤„å‘å¤–å‘å…‰ï¼Œä½†æ˜¯å…¶å…‰çº¿ä¼šå—åˆ°ä¸€ç»„é”¥ä½“çš„é™åˆ¶ï¼›
- Sky Light å¤©å…‰åˆ™è·å–åœºæ™¯çš„èƒŒæ™¯å¹¶å°†å®ƒç”¨äºåœºæ™¯ç½‘æ ¼ç‰©ä½“çš„å…‰ç…§æ•ˆæœã€‚

åœ¨æ¯ä¸ªå…‰æºçš„ Transform åŒºå—ä¸­ï¼Œå¯ä»¥çœ‹åˆ° Mobility ç§»åŠ¨æ€§ï¼Œä¸åŒçš„è®¾ç½®åœ¨å…‰ç…§å’Œé˜´å½±æ•ˆæœä¸Šæœ‰ç€æ˜¾è‘—çš„åŒºåˆ«ï¼Œä»¥åŠæ€§èƒ½ä¸Šä¹Ÿå„æœ‰å·®å¼‚ã€‚

- Static Light é™æ€å…‰æºï¼Œé«˜æ•ˆåœ°æä¾›é«˜è´¨é‡çš„å…‰ç…§ï¼Œå¯é¢„è®¡ç®—ã€‚ä½†å¯¹äºé«˜è´¨é‡çš„ç›´æ¥ç…§æ˜ï¼Œå…‰ç…§è´´å›¾å…·æœ‰ç›¸å…³æˆæœ¬ï¼Œå¹¶ä¸”è¿è¡Œæ—¶å®Œå…¨æ— æ³•æ›´æ”¹æˆ–ç§»åŠ¨ã€‚
- Stationary Light å›ºå®šå…‰æºï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶æ”¹å˜é¢œè‰²å’Œäº®åº¦ï¼Œä½†æ˜¯ä¸èƒ½ç§»åŠ¨ã€æ—‹è½¬æˆ–ä¿®æ”¹å½±å“èŒƒå›´ã€‚
- Movable Light å…¨åŠ¨æ€èƒ½åŠ›ï¼Œä½†è€—èƒ½ï¼Œå¹¶ä¸”ä¸èƒ½é¢„è®¡ç®—é—´æ¥å…‰çº¿ï¼›

è™šå¹»å¼•æ“ 4 ä¸­å…·æœ‰çš„å››ç§ç±»å‹çš„é˜´å½±æŠ•å°„ï¼š

- é™æ€å…‰æºæŠ•å°„å®Œå…¨é™æ€çš„é˜´å½±å’Œå…‰ç…§ã€‚
- å®šå‘å›ºå®šå…‰æºæ˜¯ç‰¹æ®Šçš„ï¼Œå®ƒä»¬æ”¯æŒè”çº§é˜´å½±è´´å›¾ï¼ˆCascaded Shadow Mapsï¼‰çš„å…¨æ™¯é˜´å½±ï¼ŒåŒæ—¶ä½œä¸ºé™æ€é˜´å½±ã€‚
- åŠ¨æ€ç‰©ä½“ï¼ˆæ¯”å¦‚ StaticMeshComponent æˆ– SkeletalMeshComponentï¼‰å¿…é¡»è¦ä»è·ç¦»åœºé˜´å½±è´´å›¾ä¸­é›†æˆç¯å¢ƒä¸–ç•Œçš„é™æ€é˜´å½±ã€‚
- å¯ç§»åŠ¨å…‰æºåœ¨ä»»ä½•ç‰©ä½“ä¸Šéƒ½æŠ•å°„å®Œå…¨åŠ¨æ€çš„é˜´å½±(å’Œå…‰ç…§)ã€‚

é™æ€å…‰æºæŠ•å°„çš„é˜´å½±æ˜¯å®Œå…¨é™æ€çš„é˜´å½±å’Œå…‰ç…§ï¼Œè¿™æ„å‘³ç€å®ƒä»¬å¯¹åŠ¨æ€å¯¹è±¡ä¸ä¼šäº§ç”Ÿç›´æ¥å½±å“ï¼Œé™æ€å…‰ç…§ç”±äºçƒ˜ç„™åˆ°äº†é—´æ¥å…‰ç…§ç¼“å­˜ä¸­ï¼Œæ‰€ä»¥ä¼šæœ‰ä¸€äº›å½±å“ï¼Œä½†æ˜¯ä¸ä¼šå¯¹è¿è¡Œæ€§èƒ½é€ æˆå½±å“ã€‚

å®šå‘å›ºå®šå…‰æºæ˜¯ç‰¹æ®Šçš„ï¼Œå®ƒä»¬æ”¯æŒé‡‡ç”¨ è”çº§é˜´å½±è´´å›¾ï¼ˆCascaded Shadow Mapsï¼‰ çš„å…¨æ™¯é˜´å½±ï¼ŒåŒæ—¶ä½œä¸ºé™æ€é˜´å½±ã€‚è¿™åœ¨å…·æœ‰å¾ˆå¤šå¸¦åŠ¨ç”»çš„æ¤è¢«çš„å…³å¡æ˜¯éå¸¸æœ‰ç”¨çš„ï¼›æ‚¨æƒ³åœ¨ ç©å®¶å‘¨å›´äº§ç”Ÿå¯ä»¥åŠ¨çš„é˜´å½±ï¼Œä½†æ˜¯ä¸æƒ³ä»˜å‡ºä»¥è®©å¾ˆå¤šé˜´å½±é‡å æ¥è¦†ç›–è¾ƒå¤§çš„ è§†å›¾èŒƒå›´è¿™æ ·çš„ä»£ä»·ã€‚åŠ¨æ€é˜´å½±ä¼šéšç€è·ç¦»è€Œæ¸å˜ä¸ºé™æ€é˜´å½±ï¼Œä½†è¿™ç§å˜æ¢é€šå¸¸æ˜¯ å¾ˆéš¾å¯Ÿè§‰åˆ°ã€‚è¦æƒ³è®¾ç½®è¿™æ ·çš„å¤„ç†ï¼Œä»…éœ€æŠŠ DirectionalLightStationary çš„ Dynamic Shadow Distance StationaryLight ä¿®æ”¹ä¸ºæ‚¨æƒ³è®©æ¸å˜å‘ç”Ÿçš„èŒƒå›´å³å¯ã€‚

å¯ç§»åŠ¨å…‰æºåœ¨ä»»ä½•ç‰©ä½“ä¸Šéƒ½æŠ•å°„å®Œå…¨åŠ¨æ€çš„é˜´å½±(å’Œå…‰ç…§)ã€‚å®ƒçš„å…‰ç…§æ•°æ®ä¸ä¼šçƒ˜ç„™åˆ°å…‰ç…§è´´å›¾ä¸­ï¼Œå®ƒå¯ä»¥è‡ªç”±åœ°åœ¨ä»»ä½•ç‰©ä½“ä¸ŠæŠ•å°„åŠ¨æ€é˜´å½±ã€‚é™æ€ç½‘æ ¼ä½“ã€éª¨éª¼ç½‘æ ¼ä½“ã€ç²’å­ç‰¹æ•ˆç­‰ï¼Œéƒ½å°†ä¼šä»å¯ç§»åŠ¨å…‰æºæŠ•å°„æˆ–æ¥æ”¶é˜´å½±ã€‚é€šå¸¸æ¥è¯´ï¼ŒæŠ•å°„å¯ç§»åŠ¨åŠ¨æ€é˜´å½±çš„å…‰æºæ˜¯æ€§èƒ½æ¶ˆè€—æœ€å¤§çš„ã€‚

å¤©ç©ºå…‰ç…§ä»…ä¼šæŸäº›æƒ…å†µä¸‹æ•è·åœºæ™¯ï¼š

- å¯¹äºé™æ€å¤©ç©ºå…‰ç…§ï¼ˆStatic Sky Lightsï¼‰ï¼Œæ„å»ºå…‰ç…§æ—¶ä¼šè‡ªåŠ¨è¿›è¡Œæ›´æ–°ã€‚
- é™¤éå¯ç”¨å®æ—¶æ•è·åŠŸèƒ½ï¼Œå¦åˆ™å¯¹äº Stationary or Movable Sky Lightsï¼Œåœ¨åŠ è½½æ—¶æ›´æ–°ä¸€æ¬¡ï¼Œåªæœ‰è°ƒç”¨ Recapture æ—¶æ‰ä¼šè¿›ä¸€æ­¥æ›´æ–°ã€‚

åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¤ªé˜³åœ¨å¤©ç©ºä¸­çš„ä½ç½®ä¸ä»¥å®¡ç¾ä¸ºç›®çš„ã€‚ç›¸åï¼Œå®ƒæ˜¯ä¸€ä¸ªå…³é”®çš„è®¾è®¡å› ç´ ã€‚

å¤ªé˜³ä½ç½®è®¡ç®—å™¨ï¼ˆSun Position Calculatorï¼‰ æ’ä»¶åœ¨è™šå¹»å¼•æ“ä¸­ä¸ºæ‚¨æ±‚è§£è¿™äº›æ•°å­¦æ–¹ç¨‹ã€‚æ‚¨å®šä¹‰çº¬åº¦ã€ç»åº¦ã€åŸºç‚¹ã€æ—¥æœŸå’Œæ—¶é—´ã€‚ç„¶åï¼Œå¤ªé˜³ä½ç½®è®¡ç®—å™¨ä¸è™šå¹»å¼•æ“ä¸­çš„é»˜è®¤å¤©ç©ºçƒååŒå·¥ä½œï¼Œå°†æ—¥è½®æ”¾ç½®åœ¨å¤©ç©ºçƒä¸­ï¼Œå¹¶åœ¨å…³å¡ä¸­ç¡®å®šä¸»å®šå‘å…‰æºçš„æ–¹å‘ã€‚

åœ°ç†ä½ç½®å‡†ç¡®çš„å¤ªé˜³å®šä½é€šè¿‡é»˜è®¤çš„ *BP_SkySphere* å¤ªé˜³å®šä½å™¨å®ç°ï¼Œåœ¨è™šå¹»ç¼–è¾‘å™¨ä¸­åˆ›å»ºçš„å¤§å¤šæ•°æ–°å…³å¡ä¸­å·²ç»è®¾ç½®äº†å®ƒã€‚

SunSky Actor æ˜¯æ­¤æ’ä»¶çš„ä¸€éƒ¨åˆ†ã€‚å®ƒåˆ©ç”¨ç›¸åŒçš„æ•°å­¦æ–¹ç¨‹æ§åˆ¶å¤ªé˜³åœ¨å¤©ç©ºä¸­çš„ä½ç½®ï¼Œè¿˜åŒ…æ‹¬å®šå‘å…‰æºã€å¤©ç©ºå…‰ç…§ã€SkyAtmosphereå¤šä¸ªç»„ä»¶ï¼Œç”¨äºäº§ç”Ÿé€¼çœŸçš„æ¸²æŸ“ï¼Œå‘ˆç°çœŸå®å½¢æ€çš„é˜³å…‰å’Œé˜´å½±ã€‚

å€ŸåŠ© SunSky Actorï¼Œæ— è®ºæ€æ ·çš„å®¡ç¾é€‰æ‹©ï¼Œéƒ½å¯ä½¿ç”¨å¤ä»¤æ—¶(DST)ã€æ—¥æœŸã€æ—¶é—´çš„è®¾ç½®ç®€å•å¿«æ·åœ°è®¾ç½®åœºæ™¯ã€‚è®¾è®¡ç”¨äºæ¸¸æˆå’Œå…¶ä»–è¡Œä¸šï¼Œä¾‹å¦‚å»ºç­‘ã€å·¥ç¨‹å’Œæ–½å·¥(AEC)æˆ–æ±½è½¦ã€äº§å“è®¾è®¡å’Œåˆ¶é€ ã€‚

SunSky Actor åŒ…å«å®šå‘å…‰æºã€å¤©ç©ºå…‰ç…§å’Œ SkyAtmosphere ç»„ä»¶ï¼Œä½œä¸ºè“å›¾çš„ä¸€éƒ¨åˆ†ã€‚å°†å…¶æ·»åŠ åˆ°åœºæ™¯æ—¶ï¼Œæœ€å¥½åˆ é™¤ä»»ä½•å·²æœ‰çš„å®šå‘å…‰æºã€å¤©ç©ºå…‰ç…§å’Œ SkyAtmosphere ç»„ä»¶ã€‚å¦åˆ™ï¼Œè‹¥ä»å¤´å¼€å§‹ï¼Œæœ€å¥½ä»å…¨æ–°çš„ç©ºç™½å…³å¡å¼€å§‹ã€‚

å°†SunSky Actoræ‹–è‡³å…³å¡æ—¶ï¼Œå°†æ˜¾ç¤ºä¸ºäº®ç™½è‰²ï¼Œå¯æ‰§è¡Œä»¥ä¸‹æ“ä½œä¹‹ä¸€ï¼š

åœ¨é¡¹ç›®è‡ªåŠ¨æ›å…‰è®¾ç½®ä¸­å»¶ä¼¸é»˜è®¤äº®åº¦èŒƒå›´ï¼Œè®¾ç½® Project Settings -> Rendering -> Default -> Extend default luminance range in Auto Exposure settingsã€‚æˆ–è€…ï¼Œè‹¥ä¸å¸Œæœ›æ­¤é¡¹ç›®è®¾ç½®å½±å“é¡¹ç›®å¤–è§‚ï¼Œå¯é€‰æ‹© SunSky Actor å†…éƒ¨çš„ Directional Light å®šå‘å…‰æºå¹¶ä½¿ç”¨è¾ƒä½å…‰ç…§å¼ºåº¦ã€‚


é˜´å½±è®©æ‚¨çš„ä¸–ç•Œäº§ç”Ÿå¯¹æ¯”ï¼Œä½¿å¾—ä¸–ç•Œä¸­çš„ç‰©ä½“æ„Ÿè§‰æ›´åŠ çœŸå®ï¼Œå¹¶è¥é€ ä¸€ç§æ°›å›´ã€‚é™æ€é˜´å½±æ— è®ºæ€ä¹ˆæ¸²æŸ“ï¼Œå®é™…ä¸Šéƒ½å‡ ä¹æ²¡æœ‰ä»»ä½•æ€§èƒ½æ¶ˆè€—ï¼Œä½†æ˜¯åŠ¨æ€é˜´å½±æ˜¯é€ æˆè¾ƒå¤§æ€§èƒ½æ¶ˆè€—çš„åŸå› ä¹‹ä¸€ã€‚

å¯ä½¿ç”¨ å…‰ç…§è´´å›¾åˆ†è¾¨ç‡ï¼ˆ`Lightmap Resolution`ï¼‰ æ¥æ§åˆ¶é™æ€å…‰æºç”Ÿæˆçš„çƒ˜ç„™å…‰ç…§çš„ç»†èŠ‚ã€‚

åœ¨é™æ€ç½‘æ ¼ä½“ç»„ä»¶ä¸Šï¼Œå…‰ç…§è´´å›¾åˆ†è¾¨ç‡åœ¨é™æ€ç½‘æ ¼ä½“èµ„æºä¸Šè®¾ç½®ï¼Œæˆ–å‹¾é€‰ï¼ˆOverride Lightmap Resï¼‰å¹¶è®¾ç½®å€¼ã€‚å€¼è¶Šå¤§æ„å‘³ç€åˆ†è¾¨ç‡è¶Šé«˜ï¼Œä½†ä¹Ÿæ„å‘³ç€æ„å»ºæ—¶é—´æ›´é•¿ã€å†…å­˜æ¶ˆè€—æ›´å¤šã€‚

åœ¨ç¬”åˆ·è¡¨é¢ä¸Šï¼Œå…‰ç…§è´´å›¾åˆ†è¾¨ç‡é€šè¿‡"å…‰ç…§è´´å›¾åˆ†è¾¨ç‡"å±æ€§è¿›è¡Œè®¾ç½®ã€‚è¿™æ˜¯çœŸæ­£åœ¨å¯¹å¯†åº¦è¿›è¡Œè®¾ç½®ï¼Œå› æ­¤è¾ƒä½çš„å€¼èƒ½å½¢æˆæ›´é«˜çš„åˆ†è¾¨ç‡ã€‚

å›ºå®šå…‰æºï¼ˆ`Stationary Lights`ï¼‰ æ˜¯ä¿æŒå›ºå®šä½ç½®ä¸å˜çš„å…‰æºï¼Œä½†ä½ å¯ä»¥æ”¹å˜å…‰æºçš„äº®åº¦å’Œé¢œè‰²ç­‰ã€‚è¿™æ˜¯ä¸é™æ€å…‰æºçš„ä¸»è¦ä¸åŒä¹‹å¤„ï¼Œé™æ€å…‰æºåœ¨gameplayæœŸé—´ä¸ä¼šæ”¹å˜ã€‚ä½†æ˜¯ï¼Œå¦‚æœåœ¨è¿è¡Œæ—¶æ›´æ”¹äº®åº¦ï¼Œè¯·æ³¨æ„å®ƒä»…å½±å“ç›´æ¥å…‰ç…§ã€‚é—´æ¥ï¼ˆåå°„ï¼‰å…‰ç…§ä¸ä¼šæ”¹å˜ï¼Œå› ä¸ºå®ƒæ˜¯åœ¨å…‰ç…§ç³»ç»Ÿï¼ˆLightmassï¼‰ä¸­é¢„å…ˆè®¡ç®—çš„ã€‚

åœ¨ä¸‰ç§å…‰æºçš„å¯ç§»åŠ¨æ€§ä¸­ï¼Œå›ºå®šå…‰æºä¸€èˆ¬æ‹¥æœ‰æœ€å¥½çš„å“è´¨ã€ä¸­ç­‰çš„å˜åŒ–ç¨‹åº¦ï¼Œä»¥åŠä¸­ç­‰çš„æ€§èƒ½å¼€é”€ã€‚

æ‰€æœ‰é—´æ¥å…‰ç…§å’Œæ¥è‡ªå›ºå®šå…‰æºçš„é˜´å½±éƒ½å­˜å‚¨åœ¨å…‰ç…§è´´å›¾ä¸­ã€‚ç›´æ¥é˜´å½±å­˜å‚¨åœ¨é˜´å½±è´´å›¾ä¸­ã€‚è¿™äº›å…‰æºä½¿ç”¨è·ç¦»åœºé˜´å½±ï¼ˆDistance Field Shadowsï¼‰ï¼Œå› æ­¤å¯¹äºå¸¦æœ‰å…‰ç…§çš„å¯¹è±¡æ¥è¯´ï¼Œå³ä½¿å…‰ç…§è´´å›¾åˆ†è¾¨ç‡ç›¸å½“ä½ï¼Œå®ƒä»¬çš„é˜´å½±ä¹Ÿä¼šä¿æŒæ¸…æ™°ã€‚

å›ºå®šå…‰æºçš„*ç›´æ¥å…‰ç…§*ä½¿ç”¨å»¶è¿Ÿç€è‰²ç›´æ¥è¿›è¡Œæ¸²æŸ“ã€‚ è¿™ä½¿å¾—åœ¨è¿è¡Œæ—¶å¯ä»¥æ”¹å˜å…‰æºçš„äº®åº¦å’Œé¢œè‰²ï¼ŒåŒæ—¶æä¾›äº†å…‰æºå‡½æ•°æˆ–IESæ¦‚è¿°æ–‡ä»¶ã€‚ è¯¥å…‰æºå…·æœ‰å’Œå¯ç§»åŠ¨å…‰æºä¸€æ ·çš„é«˜è´¨é‡è§£æé«˜å…‰ã€‚ åœ¨æ¸¸æˆä¸­ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹å…‰æºçš„ Visible å±æ€§æ¥æ˜¾ç¤ºæˆ–éšè—è¯¥å…‰æºã€‚

å…‰æºçš„å®æ—¶é˜´å½±å…·æœ‰è¾ƒå¤§çš„æ€§èƒ½æ¶ˆè€—ã€‚ æ¸²æŸ“ä¸€ä¸ªæœ‰é˜´å½±çš„å®Œå…¨åŠ¨æ€çš„å…‰æºæ‰€å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—ï¼Œé€šå¸¸æ˜¯æ¸²æŸ“ä¸€ä¸ªæ²¡æœ‰é˜´å½±çš„åŠ¨æ€å…‰æºçš„æ€§èƒ½æ¶ˆè€—çš„ 20 å€ã€‚ æ‰€ä»¥ï¼Œå›ºå®šå…‰æºå¯ä»¥åœ¨é™æ€ç‰©ä½“ä¸ŠæŠ•å°„é™æ€é˜´å½±ï¼Œä½†ä»æœ‰ä¸€äº›é™åˆ¶ã€‚

Lightmass åœ¨é‡æ–°æ„å»ºå…‰ç…§è¿‡ç¨‹ä¸­ä¸ºé™æ€å¯¹è±¡ä¸Šçš„å›ºå®šå…‰æºç”Ÿæˆè·ç¦»åœºé˜´å½±è´´å›¾ã€‚ è·ç¦»åœºé˜´å½±è´´å›¾å³æ—¶åœ¨åˆ†è¾¨ç‡éå¸¸ä½çš„æƒ…å†µä¸‹ï¼Œä¹Ÿå¯ä»¥æä¾›éå¸¸ç²¾ç¡®çš„é˜´å½±å˜æ¢ï¼Œ äº§ç”Ÿçš„è¿è¡Œæ—¶æ€§èƒ½æ¶ˆè€—éå¸¸å°ã€‚å’Œå…‰ç…§è´´å›¾ç±»ä¼¼ï¼Œ è·ç¦»åœºé˜´å½±è´´å›¾è¦æ±‚æ‰€æœ‰é™æ€å…‰ç…§çš„ é™æ€ç½‘æ ¼ä½“ å…·æœ‰å”¯ä¸€çš„å±•å¼€çš„ UVã€‚

æœ€å¤šåªèƒ½æœ‰ 4 ä¸ªé‡å çš„å›ºå®šå…‰æºå…·æœ‰*é™æ€é˜´å½±*ï¼Œå› ä¸ºè¿™äº›å…‰æºå¿…é¡»è¢«åˆ†é…åˆ°é˜´å½±è´´å›¾çš„ä¸åŒé€šé“ã€‚ è¿™æ˜¯ä¸ªå›¾å½¢è‰²å½©é—®é¢˜ï¼Œç”±äºè¿™ç§æ‹“æ‰‘ç»“æ„ï¼Œæ‰€ä»¥é€šå¸¸ä»…å…è®¸å°‘äº4ä¸ªçš„å…‰æºé‡å ã€‚ é˜´å½±ä¸èƒ½å½±å“è¿™ä¸ªé‡å æµ‹è¯•ï¼Œæ‰€ä»¥ å¤ªé˜³å…‰ä¸€èˆ¬éœ€è¦ä»å®ƒæ‰€åœ¨å…³å¡è·å¾—ä¸€ä¸ªé€šé“ï¼Œ å³ä½¿åœ°ä¸‹åŒºåŸŸä¹Ÿå¦‚æ­¤ã€‚ä¸€æ—¦è¾¾åˆ°é€šé“çš„æé™ï¼Œå…¶ä»–å›ºå®šå…‰æºå°†ä¼šä½¿ç”¨å…¨æ™¯åŠ¨æ€é˜´å½±ï¼Œ è¿™ä¼šå¸¦æ¥å¾ˆå¤§çš„æ€§èƒ½æ¶ˆè€—ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ StationaryLightOverlap è§†å›¾æ¨¡å¼æ¥å¯è§†åŒ–åœ°æŸ¥çœ‹é‡å æ•ˆæœï¼Œ å®ƒä¼šéšç€æ‚¨ä¿®æ”¹å…‰æºè€ŒåŠ¨æ€åœ°æ›´æ–°ã€‚ å½“æŸä¸ªå…‰æºæ— æ³•åˆ†é…åˆ°ä¸€ä¸ªé€šé“æ—¶ï¼Œè¯¥å…‰æºçš„å›¾æ ‡ä¼šå˜ä¸ºçº¢è‰²çš„ Xã€‚

åŠé€æ˜è¡¨é¢ä¹Ÿèƒ½å¤Ÿåœ¨å¼€é”€è¾ƒå°çš„æƒ…å†µä¸‹æ¥å—å›ºå®šå…‰æºçš„é˜´å½±æŠ•å°„ï¼ŒLightmass ä¼šæ ¹æ®åœºæ™¯é™æ€ç‰©ä½“é¢„è®¡ç®—é˜´å½±æ·±åº¦è´´å›¾ï¼Œè¿™å°†åœ¨è¿è¡Œæ—¶è¢«åº”ç”¨åˆ°åŠé€æ˜è¡¨é¢ã€‚è¿™ç§å½¢å¼çš„é˜´å½±æ˜¯æ¯”è¾ƒç²—ç³™çš„ï¼Œä»…ä»…åœ¨ç±³çš„åº¦é‡å•ä½ä¸Šè®¡ç®—é˜´å½±ã€‚

åŠ¨æ€ç‰©ä½“å¿…é¡»è¦ä»è·ç¦»åœºé˜´å½±è´´å›¾ä¸­é›†æˆç¯å¢ƒä¸–ç•Œçš„é™æ€é˜´å½±ã€‚ è¿™æ˜¯é€šè¿‡ä½¿ç”¨ æ¯ä¸ªå¯¹è±¡ çš„é˜´å½±å®Œæˆçš„ã€‚ æ¯ä¸ªå¯ç§»åŠ¨çš„å¯¹è±¡ä»å›ºå®šå…‰æºåˆ›å»ºä¸¤ä¸ªåŠ¨æ€é˜´å½±ï¼šä¸€ä¸ªç”¨äºå¤„ç†é™æ€ç¯å¢ƒä¸–ç•ŒæŠ•å°„åˆ°è¯¥å¯¹è±¡ä¸Šçš„é˜´å½± ï¼Œä¸€ä¸ªå¤„ç†è¯¥å¯¹è±¡æŠ•å°„åˆ°ç¯å¢ƒä¸–ç•Œä¸­çš„é˜´å½±ã€‚ é€šè¿‡ä½¿ç”¨è¿™ç§è®¾ç½®ï¼Œå›ºå®šå…‰æºå”¯ä¸€çš„é˜´å½±æ¶ˆè€—å°±æ¥æºäºå®ƒæ‰€å½±å“çš„åŠ¨æ€å¯¹è±¡ã€‚ è¿™æ„å‘³ç€ï¼Œæ ¹æ®æ‰€å…·æœ‰çš„åŠ¨æ€å¯¹è±¡çš„æ•°é‡ä¸åŒï¼Œè¯¥æ€§èƒ½æ¶ˆè€—å¯èƒ½å¾ˆå°ï¼Œä¹Ÿå¯èƒ½å¾ˆå¤§ã€‚ å¦‚æœè¶³å¤Ÿå¤šçš„åŠ¨æ€å¯¹è±¡ï¼Œé‚£ä¹ˆä½¿ç”¨å¯ç§»åŠ¨å…‰æºä¼šæ›´åŠ é«˜æ•ˆã€‚

å³ä¾¿åœ¨å®šå‘å…‰æºä¸Šä½¿ç”¨è”çº§é˜´å½±è´´å›¾çš„æ—¶å€™ï¼Œå¯ç§»åŠ¨ç»„ä»¶ä»ç„¶å°†ä¼šåˆ›å»º PerObject çš„é˜´å½±ã€‚è¿™ä¹ˆåšåœ¨è¾ƒå°çš„ Dynamic Shadow Distances æ—¶æ¯”è¾ƒæœ‰ç”¨ï¼Œä½†å¦‚æœè®¾ç½®è¾ƒå¤§çš„æ—¶å€™è¿™ä¹ˆåšå°±ä¼šäº§ç”Ÿä¸å¿…è¦çš„æ€§èƒ½å¼€é”€ã€‚è¦ç¦ç”¨ PerObject é˜´å½±æ¥ä¼˜åŒ–æ€§èƒ½çš„è¯ï¼Œå¯ä»¥åœ¨å…‰æºå±æ€§ä¸Šç¦ç”¨ Use Inset Shadows For Movable Objectsã€‚

å’Œé™æ€å…‰æºä¸€æ ·ï¼Œå›ºå®šå…‰æºæŠŠ*é—´æ¥å…‰ç…§*ä¿¡æ¯å­˜å‚¨åœ¨å…‰ç…§è´´å›¾ä¸­ã€‚ åœ¨è¿è¡Œæ—¶ï¼Œé€šè¿‡ä¿®æ”¹äº®åº¦å’Œé¢œè‰²æ¥æ”¹å˜ç›´æ¥å…‰ç…§çš„åšæ³•å¹¶ä¸é€‚ç”¨äºæ”¹å˜é—´æ¥å…‰ç…§ã€‚ è¿™æ„å‘³ç€ï¼Œå³ä½¿å½“ä¸€ä¸ªå…‰æºæœªé€‰ä¸­ Visible é¡¹æ—¶ï¼Œåœ¨æ„å»ºå…‰ç…§æ—¶ï¼Œå®ƒçš„é—´æ¥å…‰ç…§ä»ä¼šå­˜æ”¾åˆ°å…‰ç…§è´´å›¾ä¸­ã€‚ å…‰æºå±æ€§ä¸­çš„ `IndirectLightingIntensity` å¯ä»¥ç”¨äºæ§åˆ¶æˆ–ç¦ç”¨è¯¥å…‰æºçš„é—´æ¥å…‰ç…§å¼ºåº¦ï¼Œä»¥ä¾¿å½“åœ¨æ„å»ºå…‰ç…§æ—¶å‡å°ç”šè‡³å½»åº•å…³é—­å®ƒçš„é—´æ¥å…‰ç…§ã€‚

ä¸è¿‡ï¼Œè¿˜æœ‰ä¸€ä¸ªåå¤„ç† `Volume`ï¼Œå«åš `IndirectLightingIntensity`ï¼Œå®ƒèƒ½å¤Ÿæ§åˆ¶æ‰€æœ‰å…‰æºåœ¨å…‰ç…§è´´å›¾ä¸­çš„é—´æ¥å…‰ç…§å¼ºåº¦æ•ˆæœï¼Œè¿™ä¸ª Volume å¯ä»¥åœ¨è¿è¡Œæ—¶ä¿®æ”¹ï¼Œå¹¶å¯ä»¥ä»è“å›¾æ§åˆ¶ã€‚

åœ¨è™šå¹»å¼•æ“çš„ 4.9 ç‰ˆæœ¬åŠä»¥åçš„ç‰ˆæœ¬ä¸­ï¼Œå›ºå®šçš„å®šå‘å…‰æºæä¾›äº†ä¸€ä¸ªæ–°çš„é˜´å½±é€‰é¡¹ï¼Œåœ¨ Lightmass åŒºå—å†…ï¼Œå«å›ºå®šå…‰æºä½¿ç”¨åŒºåŸŸé˜´å½± Use Area Shadows for Stationary Lightsã€‚

å¦‚æœæƒ³ä½¿ç”¨å›ºå®šå…‰æºçš„åŒºåŸŸé˜´å½±é€‰é¡¹ï¼Œ å…ˆé€‰æ‹©åœºæ™¯ä¸­çš„ å®šå‘å…‰æº å¹¶ç¡®è®¤å®ƒçš„ Mobility è®¾ç½®ä¸º Stationaryã€‚ ç„¶ååœ¨è¯¥å®šå‘å…‰æºå±æ€§çš„ Lightmass åŒºåŸŸä¸­ï¼Œå‹¾é€‰ Use Area Shadows for Stationary Lights é€‰é¡¹ã€‚ å½“è¯¥é€‰é¡¹è¢«å‹¾é€‰æ—¶ï¼Œè¯¥å›ºå®šå…‰æºå°†ä¼šä½¿ç”¨åŒºåŸŸé˜´å½±æ¥åšä¸è®¡ç®—é˜´å½±è´´å›¾ã€‚ åŒºåŸŸé˜´å½±èƒ½åœ¨å…‰ç…§æŠ•å½±è¾ƒè¿œå¤„äº§ç”ŸæŸ”å’Œçš„é˜´å½±è¾¹ç•Œã€‚ä¸‹å›¾ä¸­å¯ä»¥çœ‹åˆ°æ˜¯å¦ä½¿ç”¨åŒºåŸŸé˜´å½±çš„å·®å¼‚ã€‚

*å¯ç§»åŠ¨å…‰æº*å°†æŠ•å°„å®Œå…¨åŠ¨æ€çš„å…‰ç…§å’Œé˜´å½±ã€‚å¯ä¿®æ”¹ä½ç½®ã€æ—‹è½¬ã€é¢œè‰²ã€äº®åº¦ã€è¡°å‡ã€åŠå¾„ç­‰æ‰€æœ‰å±æ€§ã€‚å…¶æŠ•å°„çš„å…‰ç…§ä¸ä¼šçƒ˜ç„™åˆ°å…‰ç…§è´´å›¾ä¸­ï¼Œåœ¨æ— å…¨å±€å…‰ç…§æ–¹æ³•æ—¶ä¸æ”¯æŒé—´æ¥å…‰ç…§ã€‚

å¯ç§»åŠ¨å…‰æºè®¾ä¸ºä½¿ç”¨å…¨åœºæ™¯åŠ¨æ€é˜´å½±æ¥æŠ•å°„é˜´å½±ï¼Œæ­¤æ–¹å¼æ€§èƒ½å¼€é”€å¾ˆé«˜ã€‚æ€§èƒ½å¼€é”€ä¸»è¦å–å†³äºå—è¯¥å…‰æºå½±å“çš„ç½‘æ ¼ä½“æ•°é‡ä»¥åŠè¿™äº›ç½‘æ ¼ä½“çš„ä¸‰è§’å½¢æ•°é‡ã€‚è¿™æ„å‘³ç€åŠå¾„è¾ƒå¤§çš„å¯ç§»åŠ¨å…‰æºçš„é˜´å½±æŠ•å°„æ€§èƒ½å¼€é”€æ˜¯åŠå¾„è¾ƒå°çš„å¯ç§»åŠ¨å…‰æºçš„æ•°å€ä¹‹å¤šã€‚

ç‚¹å…‰æºæˆ–èšå…‰æºæœªç§»åŠ¨æ—¶ï¼Œå¯å­˜å‚¨è¯¥å…‰æºçš„*é˜´å½±è´´å›¾*å¹¶åœ¨ä¸‹ä¸€å¸§é‡å¤ä½¿ç”¨ã€‚åœ¨ç¯å¢ƒé€šå¸¸ä¸ç§»åŠ¨çš„æ¸¸æˆä¸­ï¼Œæ­¤åŠŸèƒ½å¯æ˜¾è‘—é™ä½å¯ç§»åŠ¨ç‚¹å…‰æºå’Œèšå…‰æºçš„é˜´å½±æŠ•å°„å¼€é”€ã€‚

é˜´å½±è´´å›¾ç¼“å­˜ä¼šå¯¹æ€§èƒ½äº§ç”Ÿæå¤§å½±å“ï¼Œä½¿ç”¨ NVIDIA 970 GTX GPU ä»¥ 1920x1200 å±å¹•åˆ†è¾¨ç‡è¿›è¡Œä¼˜åŒ–æµ‹è¯•çš„ç»“æœã€‚

- åœ¨å¯ç”¨æ­¤åŠŸèƒ½ä¹‹å‰ï¼Œæ— ç¼“å­˜çš„ 3 ä¸ªé˜´å½±æŠ•å°„ç‚¹å…‰æºèŠ±è´¹äº† 14.89 æ¯«ç§’å®Œæˆé˜´å½±æ·±åº¦æ¸²æŸ“ã€‚
- å¯ç”¨ç¼“å­˜é˜´å½±è´´å›¾åï¼Œç›¸åŒçš„ 3 ä¸ªé˜´å½±æŠ•å°„å…‰æºèŠ±è´¹ 0.9 æ¯«ç§’ä¾¿å®Œæˆæ¸²æŸ“ï¼Œå¤§çº¦ å¿«16å€ï¼
- å¯ä½¿ç”¨ r.Shadow.WholeSceneShadowCacheMb æ§åˆ¶é˜´å½±è´´å›¾ç¼“å­˜ä½¿ç”¨çš„æœ€å¤§å†…å­˜é‡

è™½ç„¶é˜´å½±è´´å›¾ç¼“å­˜å¯é™ä½åœ¨é¡¹ç›®ä¸­ä½¿ç”¨åŠ¨æ€é˜´å½±çš„å¼€é”€ï¼Œä½†å…¶ä»å­˜åœ¨éƒ¨åˆ†é™åˆ¶ï¼Œç»“åˆä¸æ”¯æŒçš„åŠŸèƒ½ä½¿ç”¨æ—¶å¯èƒ½å¼•èµ·æ¸²æŸ“ç‘•ç–µã€‚

é»˜è®¤ä»…åœ¨å¯¹è±¡æ»¡è¶³ä»¥ä¸‹è¦æ±‚æ—¶æ‰ä¼šè¿›è¡Œç¼“å­˜ï¼š

- åŸºå…ƒå°†å…¶ ç§»åŠ¨æ€§ è®¾ä¸º é™æ€ æˆ– é™æ­¢ã€‚
- å…³å¡ä¸­ä½¿ç”¨çš„æè´¨ä¸ä½¿ç”¨ åœºæ™¯ä½ç½®åç§»ã€‚
- å…‰æºå¿…é¡»æ˜¯ ç‚¹å…‰æº æˆ– èšå…‰æºï¼Œç§»åŠ¨æ€§ è®¾ä¸º å¯ç§»åŠ¨ï¼Œå¹¶å¯ç”¨ é˜´å½±æŠ•å°„ã€‚
- å…‰æºå¿…é¡»åœç•™åœ¨ä¸€å¤„ã€‚
- ä½¿ç”¨åŠ¨ç”» æ›²é¢ç»†åˆ† æˆ– åƒç´ æ·±åº¦åç§» çš„æè´¨å¯èƒ½ä¼šåœ¨ç¼“å­˜å…¶é˜´å½±æ·±åº¦æ—¶äº§ç”Ÿç‘•ç–µã€‚

è™šå¹»å¼•æ“ 4ï¼ˆUE4ï¼‰æ”¯æŒåœ¨å…³å¡ä¸­ä½¿ç”¨ä¸åŒçš„ é¢„è®¡ç®—å…‰ç…§æƒ…æ™¯ï¼ˆPrecomputed Lighting Scenariosï¼‰ã€‚è¿™ä½¿å¾—å•ä¸ªå…³å¡å¯ä»¥ä¿å­˜å¹¶æ˜¾ç¤ºå¤šç§å…‰ç…§è®¾ç½®ï¼Œä½¿ç©å®¶æ—¢è·å¾—çµæ´»çš„åŠ¨æ€å…‰ç…§ï¼Œåˆèƒ½ä»¥å›ºå®šå¼€é”€é¢„è®¡ç®—å…‰ç…§ã€‚ å¯¹ç”¨é«˜æ€§èƒ½æ–¹å¼è¿›è¡Œé«˜ç²¾åº¦æ¸²æŸ“çš„è™šæ‹Ÿç°å®ï¼ˆVRï¼‰æˆ–å»ºç­‘å¯è§†åŒ–é¡¹ç›®è€Œè¨€ï¼Œåœ¨ä¸åŒé¢„è®¡ç®—å…‰ç…§æƒ…æ™¯ä¹‹é—´åˆ‡æ¢æ›´æ˜¾é‡è¦ã€‚ é€šè¯»æ­¤æ–‡åï¼Œä½ ä¾¿èƒ½äº†è§£å¦‚ä½•åœ¨ UE4 é¡¹ç›®ä¸­ä½¿ç”¨é¢„è®¡ç®—å…‰ç…§ã€‚


## âš¡ Landscape åœ°å½¢
- Landscape https://docs.unrealengine.com/4.27/zh-CN/BuildingWorlds/Landscape
- Water https://docs.unrealengine.com/4.27/zh-CN/BuildingWorlds/Water
- Foliage https://docs.unrealengine.com/4.27/en-US/BuildingWorlds/Foliage/
- Fog Effects https://docs.unrealengine.com/4.27/zh-CN/BuildingWorlds/FogEffects
- Lighting And Shadows https://docs.unrealengine.com/4.27/zh-CN/BuildingWorlds/LightingAndShadows
- Creating a Stylized Chaparral Environment in UE4 https://80.lv/articles/creating-a-stylized-chaparral-environment-in-ue4/
- Mastering Unreal Technology: Advanced Level Design Concepts with Unreal Engine 3 

Landscape Layer æ˜¯æ¤è¢«ç³»ç»Ÿçš„æ ¸å¿ƒã€‚å®ƒç¡®å®šæ¤è¢«çš„ç”Ÿé•¿åŒºåŸŸå’Œ Landscape Material å±‚æè´¨æ··åˆåŒºåŸŸã€‚Landscape Layer Info æ˜¯ Landscape Layer çš„æ•°æ®æ¥æºï¼Œæ¯ä¸ª Landscape Layer å¯¹åº”ä¸€ä¸ª Landscape Layer Info å‚¨å­˜ä¿¡æ¯ã€‚

Landscape å°†è¯»å–æŒ‡å®šç»™å®ƒçš„ Landscape Materialï¼Œä»¥ç¡®å®šå…¶ä¸Šä½¿ç”¨çš„ Landscape Layerã€‚ç›®å‰æœ‰å‡ ç§èŠ‚ç‚¹å¯ä»¥å‘ Landscape Material ä¸­åˆ›å»º Landscape Layerï¼Œå®ƒä»¬æ˜¯ï¼š

- Landscape Layer Blend
- Landscape Layer Sample
- Landscape Layer Switch
- Landscape Layer Weight

åªè¦é€šè¿‡èŠ‚ç‚¹åˆ›å»ºäº† Landscape Layerï¼Œå³ä½¿æœ€ç»ˆå¹¶ä¸ä½¿ç”¨å®ƒä»¬ï¼ŒLandscape ä¾æ—§ä¼šè¯»å–åˆ°è¯¥èŠ‚ç‚¹ã€‚

å³ä½¿ä¸ä½¿ç”¨åˆ›å»ºçš„èŠ‚ç‚¹ï¼Œåœ¨èŠ‚ç‚¹ä¸­åˆ›å»ºçš„ Landscape Layer ä¾ç„¶ä¼šåœ¨ Landscape ä¸­å­˜åœ¨ã€‚

å¯ä»¥å‘ç°ï¼ŒGrass å¿…é¡»ä¾èµ–äº Landscape åŒæ—¶ä½¿ç”¨ã€‚è€Œ Foliage å¯ä»¥ç‹¬ç«‹äº Landscapeï¼Œä½†æ— æ³•å†é€šè¿‡ Landscape Layer æ§åˆ¶ç”Ÿé•¿èŒƒå›´ã€‚

æ™¯è§‚ç³»ç»Ÿï¼ˆLandscapeï¼‰åœ¨ç»˜åˆ¶ æ™¯è§‚æè´¨ï¼ˆLandscape Materialï¼‰æ—¶ï¼Œå…ˆå°† æ™¯è§‚å±‚ä¿¡æ¯ï¼ˆ Landscape Layer Infoï¼‰æäº¤åˆ°æ™¯è§‚æè´¨ï¼Œæ™¯è§‚æè´¨ä¸­çš„ æ™¯è§‚å±‚ï¼ˆLandscape Layerï¼‰å†åˆ©ç”¨è¿™äº›ä¿¡æ¯è¿›è¡ŒGrasså’Œè¡¨é¢æè´¨çš„èŒƒå›´è®¡ç®—ã€‚


## âš¡ Foliage æ¤è¢«
- Foliage https://docs.unrealengine.com/4.27/en-US/BuildingWorlds/Foliage/
- ä¸º UE4 åˆ¶ä½œæ¤è¢« â€”â€” Foliage for UE4 https://zhuanlan.zhihu.com/p/371496673
- Nanite è™šæ‹Ÿå‡ ä½•ä½“ https://docs.unrealengine.com/5.0/zh-CN/RenderingFeatures/Nanite/

Nanite æ˜¯è™šå¹»å¼•æ“ 5 å…¨æ–°æ¨å‡ºçš„è™šæ‹Ÿå‡ ä½•ä½“ç³»ç»Ÿï¼ˆVirtualized Geometry Systemï¼‰ã€‚å®ƒé‡‡ç”¨å…¨æ–°çš„å†…éƒ¨ç½‘æ ¼ä½“æ ¼å¼å’Œæ¸²æŸ“æŠ€æœ¯æ¥æ¸²æŸ“åƒç´ çº§åˆ«çš„ç»†èŠ‚ä»¥åŠæµ·é‡çš„ç‰©ä½“å¯¹è±¡ã€‚å®ƒè¶³å¤Ÿæ™ºèƒ½ï¼Œå¯ä»¥ä»…å¤„ç†èƒ½å¤Ÿè§‚å¯Ÿåˆ°çš„ç»†èŠ‚ã€‚Nanite é‡‡ç”¨é«˜åº¦å‹ç¼©çš„æ•°æ®æ ¼å¼ï¼Œå¹¶ä¸”æ”¯æŒé«˜ç»†èŠ‚æµé€å’Œè‡ªåŠ¨ LOD - Level of Detailã€‚

Nanite çš„ä¼˜åŠ¿ï¼š

- å‡ ä½•ä½“å½¢çŠ¶çš„å¤æ‚åº¦æé«˜äº†æ•°ä¸ªæ•°é‡çº§ï¼›ä¸‰è§’å½¢å’Œå¯¹è±¡çš„å®æ—¶æ¸²æŸ“æ•°é‡è¾¾åˆ°äº†å‰æ‰€æœªæœ‰çš„é«˜åº¦ã€‚
- å¸§é¢„ç®—ï¼ˆFrame Budgetï¼‰ä¸å†ä¼šå› ä¸ºå¤šè¾¹å½¢æ•°é‡ã€ç»˜åˆ¶è°ƒç”¨å’Œå†…å­˜ä½¿ç”¨æƒ…å†µè€Œå—é™ã€‚
- å¯ä»¥ç›´æ¥å¯¼å…¥ç”µå½±çº§å“è´¨çš„ç¾æœ¯èµ„æºï¼Œä¾‹å¦‚ZBrushé›•åˆ»æ¨¡å‹å’Œæ‘„å½±æµ‹é‡æ‰«ææ•°æ®
- é€šè¿‡é«˜æ¨¡å®ç°ç»†èŠ‚ï¼Œè€Œéé€šè¿‡çƒ˜åŸ¹æ³•çº¿è´´å›¾æ¥å®ç°ã€‚
- è‡ªåŠ¨å¤„ç† LODï¼Œä¸å†éœ€è¦æ‰‹åŠ¨è®¾ç½®ã€‚
- å“è´¨æŸå¤±æå°‘æˆ–æ²¡æœ‰æŸå¤±ï¼Œç‰¹åˆ«æ˜¯åœ¨ LOD å‘ç”Ÿè¿‡æ¸¡æ—¶ã€‚

ä»æ¸²æŸ“ç®¡çº¿è¯ç”Ÿèµ·ï¼Œæ¸²æŸ“è‰ºæœ¯å®¶å°±ä¸€ç›´åœ¨ä¸ºç°ä»£æ¸²æŸ“ç®¡çº¿çš„å®ç°æµç¨‹æ”¯ä»˜ç€é«˜æ˜‚çš„ä½¿ç”¨ä»£ä»·ã€‚æ¯”èµ·è‰ºæœ¯å®¶ï¼Œä»–ä»¬æ›´åƒæ˜¯ç²¾æ˜çš„å•†äººï¼Œä»å®æ—¶æ¸²æŸ“ç®¡çº¿çš„æ‰‹ä¸­â€œäº‰åˆ†å¤ºç§’â€ï¼ŒèŠ±è´¹å¤§é‡æ—¶é—´å’Œç²¾åŠ›åˆ©ç”¨å„ç§å„æ ·çš„æŠ€å·§ï¼Œå¯»æ‰¾è´¨é‡å’Œæ€§èƒ½ä¹‹é—´çš„å¹³è¡¡ç‚¹ã€‚

å®æ—¶æ¸²æŸ“å¯¹äºå‚ä¸æ¸²æŸ“çš„èµ„äº§æ€»ä¼šæœ‰ä¸¤é¡¹åŸºæœ¬çš„è¦æ±‚ï¼š

- ç²¾ç®€çš„é¡¶ç‚¹æ•°é‡ã€‚å°ä½“é‡çš„æ•°æ®ç¡®ä¿ CPU å’Œ GPU ä¹‹é—´ä¼ é€’æ•ˆç‡ï¼ŒåŒæ—¶é™ä½ GPU å¯¹å…¶è¿›è¡Œæ·±åº¦æµ‹è¯•ã€é˜´å½±è®¡ç®—ç­‰æ¸²æŸ“å·¥ä½œçš„è´Ÿæ‹…ã€‚
- ç²¾ç®€çš„æè´¨æ•°é‡ã€‚å®æ—¶æ¸²æŸ“ç®¡çº¿å¸¸ä¼šæŒ‰ç…§é€å¯¹è±¡-é€æè´¨æˆ–é€æè´¨-é€å¯¹è±¡çš„é€»è¾‘é¡ºåºè¿›è¡Œ Draw Callï¼Œè°ƒç”¨æ¬¡æ•°ä¸å¯¹è±¡æ•°é‡åŠæè´¨æ•°é‡éƒ½ç›´æ¥ç›¸å…³ã€‚å› æ­¤æˆ‘ä»¬å¸¸å¸¸ä¼šå°†å¤šä¸ªæ¨¡å‹åˆå¹¶ä¸ºä¸€ä¸ªæ¨¡å‹ä»¥å‡å°‘å¯¹è±¡æ•°é‡ã€å°†å¤šä¸ªåŒç±»å‹æè´¨çº¹ç†åˆå¹¶ä¸ºä¸€ä¸ªçº¹ç†ä»¥å‡å°‘æè´¨æ•°é‡ã€‚

å¯¹äºä¸€äº›ç¡¬è¡¨é¢ç‰©ä½“ï¼Œä¾‹å¦‚çŸ³å¤´ã€å»ºç­‘è¡¨é¢ç­‰ï¼Œå®ƒä»¬çš„ç»†èŠ‚åœ¨ç©ºé—´ä¸­çš„å˜åŒ–å¹¶ä¸ååˆ†å‰§çƒˆï¼Œå¯ä»¥å·§å¦™åœ°åˆ©ç”¨æ³•çº¿è´´å›¾ï¼ˆNormal-mapï¼‰ã€è§†å·®è´´å›¾ï¼ˆParallax-mapï¼‰ç­‰å‹ç¼©çº¹ç†åœ¨äºŒç»´è¡¨é¢ä¸Šæ¨¡æ‹Ÿå®ƒä»¬çš„è§†è§‰å˜åŒ–ï¼Œä»è€Œå¾ˆå¥½åœ°å‡å°‘å®ƒä»¬çš„é¡¶ç‚¹æ•°é‡ã€‚

ä½†å¯¹äºå¦ä¸€äº›è¡¨é¢ï¼Œä¾‹å¦‚æ¯›å‘ã€æ¤è¢«ç­‰ï¼Œæƒ…å†µå°±ä¸ä¸€æ ·äº†ã€‚è¿™äº›èµ„äº§æ‹¥æœ‰çš„ç»†èŠ‚åœ¨ç©ºé—´ä¸­å‘ˆç°å‡ºç»†ç¢ä¸”å‰§çƒˆçš„å˜åŒ–ï¼Œå¾ˆéš¾ä»…ä»äºŒç»´å¹³é¢ä¸Šå¯¹å…¶è¿›è¡Œæ¨¡æ‹Ÿã€‚

æ—©å…ˆå¯¹äºå®æ—¶æ¸²æŸ“çš„ä¸»æˆ˜åœºæ¸¸æˆé¢†åŸŸè€Œè¨€ï¼Œè¿™å¹¶ä¸æ˜¯ä»€ä¹ˆå¤ªå¤§çš„é—®é¢˜ï¼Œå› ä¸ºç©å®¶å¾ˆå°‘ä¼šå°†ç²¾åŠ›æ”¾åœ¨è¿™ç§ä¸æ¸¸æˆç›®æ ‡æ— å…³çš„èƒŒæ™¯ç‰©ä¸Šã€‚ä½†å¦‚æœè¦å°†å®æ—¶æ¸²æŸ“å¼•å…¥å…¶ä»–çš„ä¸‰ç»´åˆ¶ä½œé¢†åŸŸä¸­ï¼Œæˆ–è¿›ä¸€æ­¥æå‡æ¸¸æˆçš„ç”»é¢è´¨é‡ï¼Œé—®é¢˜å°±å˜å¾—æ— æ³•å¿½è§†äº†ï¼Œä¸ç®¡é‡‡ç”¨å¤šå°‘è®¨å·§çš„æ–¹æ³•ï¼Œé«˜è´¨é‡çš„ç”»é¢æ€»ä¼šæ— æ³•å›é¿é«˜é¢æ•°çš„éœ€æ±‚ã€‚

è™šå¹» 5 å¼•æ“çš„ Nanite è™šæ‹Ÿå‡ ä½•ä½“é€šè¿‡å°†æ•´ä¸ªæ¨¡å‹èµ„äº§è¿›è¡Œå‹ç¼©ï¼ˆæ—¢ç„¶èƒ½å¤Ÿå°†æ¨¡å‹è¡¨é¢çš„ç»†èŠ‚è¿›è¡Œå‹ç¼©ï¼Œé‚£ä¹ˆå°†æ•´ä¸ªæ¨¡å‹å‹ç¼©çš„æ€æƒ³ä¹Ÿå¹¶ä¸å¥‡æ€ªå˜›ï¼‰ï¼Œä»è€Œå®ç°äº†å°†å¯å®æ—¶æ¸²æŸ“çš„å‡ ä½•ä½“å½¢çŠ¶å¤æ‚åº¦æé«˜äº†æ•°ä¸ªæ•°é‡çº§çš„å£®ä¸¾ã€‚

ä»ç»“æœä¸Šæ¥è¯´ï¼ŒNanite é€šè¿‡å…ˆè™šæ‹ŸåŒ–å†é‡‡æ ·ï¼Œå°†å±å¹•ä¸­çœ‹è§çš„å‡ ä½•ä½“å½¢çŠ¶å¤æ‚åº¦è¿›è¡Œäº†é‡æ–°åˆ†é…ï¼Œå¹³å‡äº†æ‰€æœ‰èƒ½çœ‹è§çš„ Nanite å‡ ä½•ä½“å½¢çŠ¶å¤æ‚åº¦ã€‚


UE 4 æœ‰ä¸¤å¥—æ¤è¢«ç³»ç»Ÿï¼šGrass å’Œ Foliageã€‚

Grass ä¾é  LandscapeLayer ç¡®å®šç”ŸæˆèŒƒå›´ï¼ŒGrass çš„ç”Ÿæˆé€»è¾‘å’Œ Landscape Layer éƒ½åœ¨ Landscape Material çš„å†…éƒ¨ã€‚Grass æ¤è¢«åœ¨æŒ‡å®šäº† Landscape Material çš„ Landscape ä¸Šè‡ªåŠ¨ç”Ÿæˆã€‚Grass ä¸€æ—¦ç”Ÿæˆï¼Œæ— æ³•é€šè¿‡ä¿®æ”¹ Landscape Layer Info ä¹‹å¤–çš„æ‰‹æ®µå°†å…¶ç§»é™¤ã€‚ä¸ Foliage ç›¸æ¯”ï¼ŒGrass çš„ç”Ÿæˆæ€§èƒ½å’Œæ˜¾ç¤ºæ€§èƒ½éƒ½æ›´åŠ ä¼˜ç§€ã€‚

Foliage å¯ä»¥è‡ªç”±ç»˜åˆ¶ï¼ˆFoliage Toolï¼‰å’Œç¨‹åºåŒ–ç”Ÿæˆï¼ˆProcedural Foliage Spawnerï¼‰ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é€šè¿‡ Landscape Layer é…åˆæ§åˆ¶ç”Ÿé•¿èŒƒå›´ï¼Œå¯¹äº Foliage æ¥è¯´ Landscape Layer æ˜¯å¯é€‰é¡¹ã€‚Foliage åœ¨ç”Ÿæˆåä¹Ÿå¯ä»¥é€šè¿‡ç»˜åˆ¶å·¥å…·æ‰‹åŠ¨ä¿®æ”¹å’Œç§»é™¤ï¼ŒActor Foliage ç”šè‡³å¯ä»¥åœ¨æ¸¸æˆä¸­è¿›è¡Œå®æ—¶é”€æ¯ã€‚

Speedtree æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„ä¸‰ç»´æ¤è¢«å»ºæ¨¡è½¯ä»¶ï¼Œæœ€å‰å®³çš„åœ°æ–¹åœ¨äºå®ƒåŸºäºå‚æ•°åŒ–å»ºæ¨¡çš„æ–¹å¼ï¼Œæ„å‘³ç€åˆ¶ä½œè€…åªéœ€è¦åšå¥½ä¸€æ£µæ ‘ï¼Œå°±èƒ½å¤Ÿéšæœºç”Ÿæˆæˆåƒä¸Šä¸‡æ£µè¿™æ£µæ ‘çš„å˜ç§ç‰ˆæœ¬ã€‚ã€‚å®ƒèƒ½å¤Ÿç”Ÿæˆæä¸ºå¤æ‚çš„æ¤ç‰©æ¨¡å‹ï¼ŒçŸ¥åç”µå½±ã€Šé˜¿å‡¡è¾¾ã€‹çš„å¾¡ç”¨æ¤ç‰©æ¨¡å‹ç”Ÿæˆå·¥å…·ã€‚

Speedtree æœ‰ä¸“é—¨çš„ forUE4 ç‰ˆæœ¬ï¼Œä½†èµ„äº§å¹¶ä¸ç¨³å®šå¯ç”¨æ€§ä¸é«˜ï¼ˆä¾‹å¦‚å¦‚æœä½ ä¸ºSpeedtreeèµ„äº§æŒ‡å®šè‡ªå®šä¹‰LODï¼Œå¼•æ“å°±ä¼šå´©æºƒï¼‰ã€‚å»ºè®®çš„æ–¹å¼æ˜¯ä½¿ç”¨èƒ½å¯¼å‡º .fbx å’Œ .obj æ ¼å¼çš„ Indie ç‰ˆæœ¬ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥éšæ—¶å¯¼å‡º Speedtree èµ„äº§åœ¨å…¶ä»–ä¸‰ç»´è½¯ä»¶é‡Œè¿›è¡Œä¿®é¥°ï¼Œç„¶åå°†å…¶ä½œä¸º Nanite èµ„äº§å¯¼å…¥åˆ°å¼•æ“ä¸­ã€‚

Epic æ‹¥æœ‰å…¨ä¸–ç•Œæœ€å¤§çš„æ‰«æèµ„æºåº“ Quixel Megascansï¼Œåªéœ€è¦æ³¨å†Œä¸€ä¸ª Epic è´¦å·è¿›è¡Œç™»å½•ï¼Œå°±å¯ä»¥å…è´¹åˆ©ç”¨å…¶ä¸­çš„èµ„æºåˆ›å»ºè‡ªå·±çš„èµ„äº§ã€‚æœ€æ–°çš„ Unreal Engine 5 ä½“éªŒç‰ˆå·²ç»é›†æˆ Quixel Bridge æ’ä»¶å…è®¸ä½ è®¿é—® Megascans ç´ æåº“ï¼Œä»è€Œå°†åœºæ™¯ã€æè´¨å’Œ MetaHuman å¯¼å…¥åˆ°è™šå¹»å¼•æ“ä¸­ã€‚

åœ¨æ‰«æåº“çš„ Atlas åˆ†ç±»ä¸‹ï¼Œå¯ä»¥ä¸‹è½½åˆ°å„ç§å„æ ·çš„æ¤è¢«å›¾é›†ç”¨äº Speedtree åˆ›å»ºã€‚


## âš¡ Water æ°´ä½“
- https://docs.unrealengine.com/4.27/zh-CN/BuildingWorlds/Water/

æ°´ä½“ç³»ç»Ÿå…è®¸ä½ åŸºäºæ ·æ¡çº¿åˆ›å»ºå„ç§æ²³æµã€æ¹–æ³Šã€æµ·æ´‹ï¼Œå¹¶é™†åœ°åœ°å½¢æœ‰æœºäº’åŠ¨ã€‚å®ƒé›†æˆäº†ç€è‰²å’Œæ¸²æŸ“ç®¡çº¿ï¼Œå…¶æ°´ä½“è¡¨é¢æ”¯æŒ ç‰©ç†äº¤äº’å’ŒåŠ¨æ€æµä½“æ¨¡æ‹Ÿï¼Œæ¯”å¦‚è„šæœ¬åœ¨æ°´ä¸­çš„æ¶Ÿæ¼ªæˆ–èˆ¹åœ¨æ°´ä¸­ç§»åŠ¨æ—¶çš„å°¾è¿¹ã€‚

æ°´ä½“ç³»ç»Ÿæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ’ä»¶ï¼Œå¯ä»¥æ ¹æ®ä½ çš„é¡¹ç›®éœ€æ±‚æ¥å¯ç”¨/åœç”¨ã€‚è¯¥æ’ä»¶èƒ½ä¸ºå¼•æ“å¢æ·»æ°´ä½“æ¸²æŸ“å’Œç½‘æ ¼åˆ’åˆ†ç³»ç»Ÿï¼Œè¿˜æä¾›äº†èŒƒä¾‹å’Œé»˜è®¤å†…å®¹ä¾›ä½ ä½¿ç”¨ã€‚

å¦‚éœ€å¯ç”¨æ°´ä½“ç³»ç»Ÿï¼Œè¯·ç‚¹å‡» Edit -> Plugin -> Water æ°´ä½“æ’ä»¶ï¼Œå‹¾é€‰å¤é€‰æ¡†ä»è€Œå¯ç”¨å®ƒã€‚è¯·é‡å¯ç¼–è¾‘å™¨ä»¥ä¾¿è®©æ’ä»¶ç”Ÿæ•ˆã€‚

æ°´ä½“æ’ä»¶è¿˜åŒ…å«ä¸€äº›é»˜è®¤çš„æè´¨å’Œå†…å®¹ï¼Œå¯ä»¥åœ¨ä½ è‡ªå·±çš„é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œä¾›ä½ æ¢ç´¢ã€‚ä½ å¯ä»¥åœ¨å†…å®¹æµè§ˆå™¨çš„æ°´ä½“å†…å®¹ï¼ˆWater Contentï¼‰ä¸­æ‰¾åˆ°è¿™äº›å†…å®¹ï¼Œè¯·å‹¾é€‰å†…å®¹æµè§ˆå™¨çš„è®¾ç½® Settings -> Show Plugin Contentã€‚

åœ¨æ­¤ç›®å½•ä¸­ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€äº›åœ°å›¾å’Œå†…å®¹ç¤ºä¾‹ä¾›ä½ æ¢ç´¢ï¼Œæ¯”å¦‚ï¼š

- æ°´æ³¢ç”Ÿæˆï¼ˆCaustics generationï¼‰
- æµä½“æ¨¡æ‹Ÿï¼ˆFluid simulationï¼‰
- æµ®åŠ›æ¨¡æ‹Ÿè“å›¾ï¼ˆ Physics simulation buoyancy Blueprintsï¼‰

æ°´ç³»ç»Ÿç”±ä¸¤ä¸ªå…³é”®å…ƒç´ æ„æˆï¼š

- æ°´ç½‘æ ¼ä½“ï¼ˆ*Water Mesh Actor*ï¼‰å¯ç¼–è¾‘çš„æ°´é¢å’Œæ°´é¢æè´¨ã€‚
- æ°´ä½“ï¼ˆ*Water Body Actors*ï¼‰ï¼ˆæ±Ÿæ²³ã€æ¹–æ³Šå’Œæµ·æ´‹ï¼‰ã€‚

è¿™ä¸¤ä¸ªå…ƒç´ ç¡®å®šäº†é¡¹ç›®ä¸­çš„æ°´å¦‚ä½•è¡¨ç°ï¼Œä»¥åŠä¸æ‰€æ¥è§¦å¯¹è±¡äº’åŠ¨ã€‚è¿™å¯ä»¥æ˜¯éå¸¸ç®€å•ï¼Œæ¯”å¦‚æ°´æè´¨å¦‚ä½•å°†å…‰åå°„å’ŒæŠ˜å°„åˆ°ä¸æ°´é¢æ¥è§¦çš„å¯¹è±¡ä¸Šã€‚å¯¹äº Gameplayï¼Œè¿™å¯ä»¥æ˜¯è§’è‰²åœ¨æ°´ä¸­ç§»åŠ¨æ—¶å¦‚ä½•è®©æ°´é¢äº§ç”Ÿæ³¢æµªï¼Œæˆ–è€…å¯¹è±¡åœ¨æ°´é¢ä¸Šæ¼‚æµ®æ—¶çš„æµ®åŠ›æœ‰å¤šå¤§ã€‚

æ°´ç³»ç»Ÿæœ‰è‡ªå·±çš„åŸºäºæ ·æ¡çº¿çš„ç½‘æ ¼ä½“ç³»ç»Ÿï¼Œå¯å®šä¹‰ä¸–ç•Œå†…åº”è¯¥åŒ…å«æ°´çš„åŒºåŸŸã€‚å®ƒä½¿ç”¨æ°´ç½‘æ ¼ä½“ï¼Œè®¾ç½®åº”ç”¨äºå…³å¡ä¸­æ”¾å…¥çš„æ‰€æœ‰æ°´ä½“ï¼ˆæ±Ÿæ²³ã€æ¹–æ³Šå’Œæµ·æ´‹ï¼‰çš„å±æ€§ï¼Œæ°´ç½‘æ ¼ä½“ä¸»è¦å®šä¹‰äº†æ‰€æ¸²æŸ“æ°´é¢çš„è´¨é‡å’Œç»†èŠ‚ã€‚

ä½ å¿…é¡»å°†æ°´ç½‘æ ¼ä½“æ”¾å…¥åœºæ™¯ä¸­ï¼Œä»¥ç”Ÿæˆå…³å¡ä¸­æ°´ä½“ï¼ˆWater Bodyï¼‰ç±»å‹çš„è¡¨é¢ã€‚æ°´ç½‘æ ¼ä½“æœ¬èº«å¹¶ä¸ä¼šæ¸²æŸ“è¡¨é¢ã€‚æ°´ä½“å°†ä½¿ç”¨æ ·æ¡çº¿æ¥å®šä¹‰å…³å¡ä¸­è¡¨ç¤ºæ±Ÿæ¹–ã€æ¹–æ³Šå’Œæµ·æ´‹çš„åŒºåŸŸã€‚è¿™äº›æ ·æ¡çº¿å®šä¹‰äº†æ°´ç½‘æ ¼ä½“åœ¨ä½•å¤„ç»˜åˆ¶å¹¶æ¸²æŸ“æ°´ç½‘æ ¼ä½“å›¾å—ã€‚è¿™æ ·åšæ›´é«˜æ•ˆï¼Œå› ä¸ºå®ƒä»…æ¸²æŸ“å½“å‰æ‘„åƒæœºè§†å›¾ä¸­å¯è§çš„è¡¨é¢ç½‘æ ¼ä½“ã€‚

æ°´ç½‘æ ¼ä½“ä½äºåœºæ™¯ä¸­æ—¶ï¼Œå°†æ°´ä½“æ‹–æ”¾åˆ°åœºæ™¯ä¸­å¯æ·»åŠ æˆ–ç§»é™¤è¡¨ç¤ºæ°´é¢çš„å›¾å—ã€‚ç”±äºæ‰€æœ‰æ°´ä½“ä½¿ç”¨ç›¸åŒçš„ç½‘æ ¼ä½“æ¥æ¸²æŸ“æ°´é¢ï¼Œå› æ­¤å®ƒä»¬ä¼šæ— ç¼åœ°æ··åˆåœ¨ä¸€èµ·ã€‚è¿™è¿˜æ„å‘³ç€ï¼Œä½ å¯ä»¥åœ¨ä¸åŒç±»å‹çš„æ°´é¢ä¹‹é—´è¿›è¡Œè¿‡æ¸¡ï¼Œå¦‚ä»å¥”æµçš„æ±Ÿæ²³æ±‡å…¥å¹³é™çš„æ¹–æ³Šæˆ–æ±¹æ¶Œçš„æµ·æ´‹ã€‚

ä½¿ç”¨æ§åˆ¶å°å‘½ä»¤ r.Water.WaterMesh.ShowWireframe 1 å¯ç”¨æ°´ç½‘æ ¼ä½“çº¿æ¡†è§†å›¾ï¼Œä»¥æŸ¥çœ‹ä¸åŒæ°´ä½“ä¹‹é—´çš„è¿™äº›è¿‡æ¸¡å¦‚ä½•ç›¸äº’ä½œç”¨ï¼Œä»è€Œåˆ›å»ºæ— ç¼çš„è¡¨é¢ã€‚


æ°´ç³»ç»Ÿä¼šä½¿ç”¨ GPU é©±åŠ¨çš„æ³¢æµªæ•°æ®åœ¨æ°´ä½“ä¸Šæ¨¡æ‹Ÿæ³¢æµªè¡¨é¢ã€‚æ°´æ³¢èµ„äº§ï¼ˆ*Water Waves*ï¼‰æä¾›äº†ç”±å…¶æ¨¡æ‹Ÿæ¨¡å‹ç®¡æ§çš„å„ç§æ³¢æµªå‚æ•°ã€‚

æ°´ä½“éšé™„äº†æ³¢æµªæ¨¡æ‹Ÿæ¨¡å‹ï¼Œå¯ä»¥å’Œæ°´æ³¢èµ„äº§ï¼ˆ*Water Waves Asset*ï¼‰æŒ‡å®šæ’æ§½é…åˆä½¿ç”¨ã€‚é»˜è®¤æƒ…å†µä¸‹ä¼šæä¾›ä¸€ä¸ªï¼Œä½¿ç”¨çš„æ˜¯ TODOLINKï¼ˆGerstner Water Wavesï¼‰ç›–æ–¯ç‰¹çº³æ³¢æ¨¡æ‹Ÿæ¨¡å‹ã€‚

è™½ç„¶ä¸æ˜¯æ¯æ¬¡ä½¿ç”¨æ°´ä½“æ—¶éƒ½éœ€è¦åˆ›å»ºæ–°çš„æ°´æ³¢èµ„äº§ï¼Œä½†æœ‰æ—¶ä½ å¯èƒ½å¸Œæœ›æ¨¡æ‹Ÿæ¨¡å‹æœ‰ä¸åŒç±»å‹çš„æ³¢æµªè¾“å…¥æ¥äº§ç”Ÿä¸åŒçš„è¡¨ç°ï¼Œæˆ–è€…ä½ å¯èƒ½å¸Œæœ›ä½¿ç”¨å®Œå…¨ä¸åŒçš„æ³¢æµªæ¨¡æ‹Ÿæ¨¡å‹ã€‚

åˆ›å»ºæ°´æ³¢èµ„äº§ï¼Œå‰å¾€å†…å®¹æµè§ˆå™¨ï¼Œç‚¹å‡»ï¼ˆAdd/Importï¼‰å¯¼å…¥æˆ–ä½¿ç”¨å³é”®ç‚¹å‡»ä¸Šä¸‹æ–‡èœå•ï¼Œä»è€Œåˆ›å»ºè‡ªå·±çš„æ°´æ³¢èµ„äº§ã€‚åœ¨èœå•ä¸­ï¼Œé€‰æ‹© Water -> Water Wavesã€‚

åœ¨é€‰æ‹©çš„æ°´ä½“ï¼ˆ*Water Body*ï¼‰ä¸Šï¼Œä½¿ç”¨æ°´æ³¢èµ„äº§ï¼ˆWater Waves Assetï¼‰æŒ‡å®šè¦åº”ç”¨æ­¤èµ„äº§çš„æ’æ§½ã€‚

æ³¢æµªæ¥æºï¼ˆ*Waves Source*ï¼‰ ä¼šæŒ‡å®šè¦ç”¨äºåœ¨æ°´ä½“ä¸Šç”Ÿæˆæ³¢æµªçš„æ³¢æµªæ¨¡æ‹Ÿæ¨¡å‹ã€‚é€‰æ‹©ä¸€ä¸ªæ¥æºä¹‹åï¼Œè¯¥æ¥æºå°±ä¼šæä¾›è¦é€šè¿‡æ‰€é€‰æ³¢æµªæ¥æºï¼ˆWaves Sourceï¼‰æ–‡ä»¶å…¬å¼€çš„å‚æ•°ï¼Œä»¥æ§åˆ¶æ³¢æµªæ¨¡æ‹Ÿã€‚ä¾‹å¦‚ï¼Œç›–æ–¯ç‰¹çº³æ³¢æ¥æºä¼šåœ¨ç›–æ–¯ç‰¹çº³æ³¢ç”Ÿæˆå™¨ï¼ˆGerstner Wave Generatorï¼‰ä¸‹æä¾›å‚æ•°ã€‚

å‡¡æ˜¯åœ¨å…³å¡ä¸­åˆ†é…äº†æ­¤æ°´æ³¢èµ„äº§çš„æ°´ä½“ï¼Œä½ éƒ½å¯ä»¥é€šè¿‡é…ç½®è¿™äº›å‚æ•°æ¥å®šä¹‰è¿™äº›æ°´ä½“ä¸Šæ³¢æµªæ¨¡æ‹Ÿçš„å¤–è§‚ã€‚


è™šå¹»å¼•æ“ä¸ºæ°´ç³»ç»Ÿæä¾›äº†ç›–æ–¯ç‰¹çº³æ³¢æ¨¡æ‹Ÿæ¨¡å‹ã€‚æ°´ç³»ç»Ÿå…·æœ‰å¯é…ç½®çš„å‚æ•°çš„æ°´æ³¢æµªèµ„äº§ï¼Œæ‰€ä»¥æ”¯æŒæ›´å¤šçš„æ³¢æµªæ¨¡æ‹Ÿæ¨¡å‹ï¼Œä½ å¯ä»¥é€šè¿‡C++ä»£ç æˆ–è“å›¾æ¥å®ç°ã€‚

æ­¤éƒ¨åˆ†ä¸­çš„ä¿¡æ¯ä½¿ç”¨äº†ç›–æ–¯ç‰¹çº³æ³¢å®æ–½ï¼Œç”¨ä»¥ä¸¾ä¾‹è¯´æ˜å¦‚ä½•åˆ›å»ºä½ è‡ªå·±çš„æ³¢æµªç”Ÿæˆå™¨åç«¯ï¼Œä»è€Œå¯¹æ°´é¢æ³¢æµªè¿›è¡Œæ±‚å€¼ã€‚

å¯ä»¥åœ¨ C++ æˆ–åœ¨è“å›¾ä¸­ï¼Œä» *UGerstnerWaterWaveGeneratorBase* æ‰©å±•æ¨å¯¼å‡ºçš„æ–°ç±»å‹ï¼ŒC++ ä¸­ä½¿ç”¨ `GenerateGerstnerWaves_Implementation(TArray<FGerstnerWave>&OutWaves) const`ã€‚


æ±Ÿæ²³ã€æ¹–æ³Šå’Œæµ·æ´‹çš„æ°´ä½“å…¨éƒ½ä½¿ç”¨ç›¸åŒçš„æè´¨ï¼ˆ*Water_Material*ï¼‰ä½œä¸ºåŸºåº•ã€‚å®ƒåŒ…å«ç‰¹å®šäºæ¯ç§æ°´ä½“ç±»å‹çš„ä¸€ç»„å¼€å…³å’Œå‚æ•°ï¼Œè¿™æ ·å•ä¸ªæºæè´¨å¯ä»¥ç”¨äºé©±åŠ¨æ‰€ç”¨çš„æ‰€æœ‰ç±»å‹çš„æ°´ã€‚å°†ä¸ºæ¯ç§æ°´ä½“ç±»å‹ï¼ˆæ±Ÿæ²³ã€æ¹–æ³Šã€æµ·æ´‹ï¼‰åˆ›å»ºä¸€ä¸ªæè´¨å®ä¾‹ï¼Œå¹¶ä¸”æ¯ä¸ªå®ä¾‹ä¼šå¯ç”¨ä¸€ä¸ªå¼€å…³ï¼Œç”¨äºç¡®å®šå¯¹åº”äºè¯¥æ°´ä½“ç±»å‹çš„å¯ç”¨å‚æ•°ã€‚æ­¤å·¥ä½œæµç¨‹åœ¨æ¯ç§æ°´ä½“ç±»å‹æè´¨ä¹‹é—´ç»´æŒä¸€è‡´çš„å¤–è§‚å’Œè®¾è®¡ã€‚

å¯¹äºä½¿ç”¨æ¹–æ³Šã€æµ·æ´‹æˆ–æ±Ÿæ²³æè´¨çš„æ°´ä½“ç±»å‹ï¼Œå¤§éƒ¨åˆ†æè´¨å‚æ•°ç±»ä¼¼ã€‚ä½†æ±Ÿæ²³æè´¨æ˜¯ä¸€ä¸ªä¾‹å¤–ã€‚æ±Ÿæ²³æè´¨åŒ…å«å…¶ä»–æ°´ä½“æè´¨æ‰€ä¸å…·å¤‡çš„ç‰¹å®šå‚æ•°ï¼Œå¦‚é€Ÿåº¦ã€æµé‡æ§åˆ¶ã€å¯†åº¦ç­‰ç­‰ã€‚ä½†æ˜¯ï¼Œæ±Ÿæ²³æ°´ä½“æ²¡æœ‰æ³¢æµªçš„å‚æ•°ï¼Œè€Œæµ·æ´‹å’Œæ¹–æ³Šå´æœ‰æ­¤å‚æ•°ã€‚

åœ¨å†…å®¹æµè§ˆå™¨ä¸­æ‰“å¼€ Water Content/Materials/WaterSurface æ–‡ä»¶å¤¹ï¼Œæ¢ç´¢æ¯ç§ä¸åŒçš„æ°´ä½“ç±»å‹æè´¨å®ä¾‹ã€‚

æ±Ÿæ²³æ°´ä½“æè´¨çš„è¿‡æ¸¡ï¼Œæ±Ÿæ²³æ°´ä½“å…è®¸æ°´æ²¿ç€ä¸åŒä½ç½®ä¹‹é—´çš„æ ·æ¡çº¿æµåŠ¨ï¼Œå¹¶ä¸”å¯ä»¥æºè‡ªæ¹–æ³Šã€æµ·æ´‹ã€æ±Ÿæ²³æˆ–å…¶ä»»æ„ç»„åˆã€‚ä¸æ¹–æ³Šå’Œæµ·æ´‹ä¸åŒï¼Œæ±Ÿæ²³æœ‰å¤§è‡´çš„æ°´æµæ–¹å‘ã€‚å®ƒå¯ä»¥ä»æ¹–æ³Šæµå…¥æµ·æ´‹æˆ–å¦ä¸€ä¸ªæ¹–æ³Šï¼Œç”šè‡³å¯ä»¥æ²¿é€”ä¸å¦ä¸€æ¡æ±Ÿæ²³åˆæµã€‚

ç”±äºæ±Ÿæ²³æœ‰ä¸åŒäºæ¹–æ³Šå’Œæµ·æ´‹çš„ä¸€ç»„å±æ€§ï¼ˆå³ï¼Œæ±Ÿæ²³ä¸ä¼šäº§ç”Ÿæ³¢æµªï¼‰ï¼Œå› æ­¤æ±Ÿæ²³ä½¿ç”¨è¿‡æ¸¡æ€§æè´¨ä» æ±Ÿæ²³åˆ°æ¹–æ³Š å’Œ æ±Ÿæ²³åˆ°æµ·æ´‹ è¿‡æ¸¡æ— ç¼æ··åˆã€‚æ±Ÿæ²³æ°´ä½“å…·æœ‰ä¸æ¹–æ³Šå’Œæµ·æ´‹æ°´ä½“ç›¸åŒçš„å›¾å—ç½‘æ ¼ä½“ï¼Œå› æ­¤è¿‡æ¸¡æ€§æè´¨å°±èƒ½å¤Ÿå¾ˆå¥½åœ°èåˆåˆ°æ‰€æ¥è§¦åˆ°çš„ä»»ä½•å…¶ä»–æ°´ä½“çš„è¡¨é¢ã€‚

è¿‡æ¸¡æ€§æè´¨æ˜¯æ±Ÿæ²³æ°´ä½“çš„é»˜è®¤æè´¨å®ä¾‹ã€‚è¦è®©å…³å¡ä¸­çš„æ°´æœ‰ä¸€è‡´çš„å¤–è§‚ï¼Œå”¯ä¸€éœ€è¦çš„è®¾ç½®æ˜¯ï¼Œæ‰‹åŠ¨å°†å…¶é¢œè‰²åŒ¹é…åˆ°æ‰€ä½¿ç”¨çš„ä»»ä½•å…¶ä»–æ¹–æ³Šã€æµ·æ´‹å’Œæ±Ÿæ²³æ°´ä½“æè´¨ã€‚

åœ¨ä¸‹é¢çš„ç®€å•åœºæ™¯ç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨äº†ä¸€ä¸ªåœ°å—ï¼Œåœ¨ä¸­å¿ƒåŒ…å«æ¹–æ³Šæ°´ä½“ï¼Œå›´ç»•å²›å±¿çš„æ˜¯æµ·æ´‹æ°´ä½“ï¼Œè¿æ¥ä¸¤è€…çš„æ˜¯æ±Ÿæ²³æ°´ä½“ã€‚è¿‡æ¸¡æ€§æè´¨å¤„ç†äº†æ°´å¼€å§‹ä»æ¹–æ³Šæµå…¥æ±Ÿæ²³ï¼Œå†ä»æ±Ÿæ²³è¿‡æ¸¡åˆ°æµ·æ´‹çš„è¿‡ç¨‹ã€‚æ¯ç§æ°´ä½“å’Œè¿‡æ¸¡æè´¨éƒ½åŒ¹é…äº†é¢œè‰²ï¼Œä»¥ä¿è¯ä¸€è‡´ã€‚


æ¯ä¸ªæ°´ä½“éƒ½æŒ‡å®šäº† æ°´ä¸‹åæœŸå¤„ç†æè´¨ï¼ˆ*Underwater Post Process Material*ï¼‰ï¼Œä»¥ä½¿ç”¨åæœŸå¤„ç†æè´¨é©±åŠ¨ç©¿è¿‡æ°´é¢çš„è¿‡æ¸¡ã€‚æ‘„åƒæœºä½äºç»™å®šæ°´ä½“è¾¹ç•Œä¹‹å†…ï¼Œæ²‰æ²¡åˆ°æ°´é¢ä»¥ä¸‹æ—¶ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œæ°´ä¸‹åæœŸå¤„ç†ã€‚åæœŸå¤„ç†æè´¨è¿˜ä¼šå±è”½æ‰åœºæ™¯ä¸­ä¸åœ¨æ°´ä¸‹çš„éƒ¨åˆ†æ¥åˆ›å»ºéƒ¨åˆ†æ°´ä¸‹çš„è§†å›¾ï¼Œä»è€Œå¤„ç†è¿›å…¥å’Œç¦»å¼€æ°´é¢çš„è¿‡æ¸¡ã€‚

æ¯ç§æ°´ä½“çš„ç»†èŠ‚é¢æ¿ï¼ˆDetailsï¼‰åŒ…å« Actor çš„ç‰¹å®šè®¾ç½®ï¼Œå¹¶ä¸”å¯åœ¨å…¶ä¸­è®¿é—®åæœŸå¤„ç†è®¾ç½®ï¼ˆPost Processing Settingsï¼‰ï¼Œè¿›ä¸€æ­¥è°ƒæ•´æ°´ä¸‹çš„å¤–è§‚ï¼Œæ— éœ€æ‰“å¼€å¹¶æ‰‹åŠ¨é…ç½®æè´¨å±æ€§ã€‚

å‡ºäºä¼˜åŒ–ç›®çš„ï¼Œä»…å½“æ‘„åƒæœºåœ¨æ°´é¢ä»¥ä¸‹æˆ–ç•¥å¾®éœ²å‡ºæ°´é¢ä¹‹ä¸Šæ—¶ï¼Œæ‰ä¼šè¿›è¡Œæ°´ä¸‹åæœŸå¤„ç†ã€‚è¿™æ˜¯ä¸ºäº†è€ƒè™‘æ¹–æ³Šå’Œæµ·æ´‹çš„æƒ…å†µï¼Œå…¶ä¸­æ³¢å³°å’Œæ³¢è°·å¯èƒ½ä¼šå¯¼è‡´æ‘„åƒæœºå®Œå…¨æˆ–éƒ¨åˆ†æ²‰æ²¡æ°´ä¸‹ã€‚éœ€è¦å¯ç”¨ ç”Ÿæˆç¢°æ’ï¼ˆGenerate Collisionï¼‰ï¼Œæ‰èƒ½è¿›è¡Œæ­¤æ°´ä¸‹åæœŸå¤„ç†ã€‚

æ­¤å¤–ï¼Œæ°´ä½“å›¾å—ç½‘æ ¼ä½“èƒ½å¤Ÿä½¿ç”¨æ±Ÿæ²³æ°´ä½“çš„è¿‡æ¸¡æ€§æè´¨æ— ç¼æ··åˆã€‚ä½†æ˜¯ï¼Œå¦‚æœæ°´ä¸‹åæœŸå¤„ç†çš„å¤–è§‚åœ¨ä¸¤ç§æ°´ä½“ä¹‹é—´å·®å¼‚æ˜¾è‘—ï¼ˆä¾‹å¦‚ï¼Œä»æ¸…æ¾ˆçš„æ±Ÿæ²³æµå…¥æµ‘æµŠçš„æ¹–æ³Šï¼‰ï¼Œé‚£ä¹ˆéšç€æ‘„åƒæœºåœ¨ä¸¤ç§åæœŸå¤„ç†ä½“ç§¯ä¹‹é—´ç§»åŠ¨ï¼Œä¼šæ˜¾ç¤ºä¸€ç§ç¡¬è¿‡æ¸¡ã€‚


å•å±‚æ°´ï¼ˆ*Single Layer Water*ï¼‰ ç€è‰²æ¨¡å‹å¯ç”¨äºæ‰€æœ‰é»˜è®¤æ°´æè´¨ï¼Œå› ä¸ºå®ƒèƒ½ä½¿ç”¨å•åšåº¦å±‚æä¾›ä¸€ç§ç»æµé«˜æ•ˆçš„åŠé€æ˜æ–¹æ³•ã€‚è¿™ç§åŸºäºç‰©ç†åŸç†çš„ç€è‰²æ¨¡å‹æ”¯æŒæ°´é¢ä¸Šæ°å½“çš„å…‰æ•£å°„ã€å¸æ”¶ã€åå°„å’ŒæŠ˜å°„ä»¥åŠé˜´å½±æŠ•å°„ã€‚

ä½ å¯ä»¥åˆ›å»ºè‡ªå·±çš„æ°´æè´¨æ¥é…åˆæ°´ç³»ç»Ÿä½¿ç”¨ï¼Œå› æ­¤ä½ ä¸å¿…ä¸“é—¨ä½¿ç”¨æŒ‡å®šç»™æ¯ç§æ°´ä½“çš„é»˜è®¤æ°´æè´¨ã€‚

è®¾ç½®è‡ªå·±çš„æè´¨æ—¶ï¼Œè¯·è®°ä½ä»¥ä¸‹å‡ ç‚¹ï¼š

- æ°´ä½“æ”¯æŒä½¿ç”¨ä»»ä½•ç±»å‹çš„ç€è‰²æ¨¡å‹çš„æ°´æè´¨ã€‚
- æè´¨éœ€è¦å¯ç”¨ï¼ˆUsed with Waterï¼‰çš„ç”¨æ³•æ ‡è®°ï¼ˆUsage Flagï¼‰ã€‚æ¯å½“å°†æè´¨æŒ‡å®šç»™ä¸åŒç±»å‹çš„ Actor æ—¶ï¼Œæ­¤æ ‡è®°åº”è¯¥ä¼šè‡ªåŠ¨å¯ç”¨ï¼Œå¹¶ä¸”è¯¥æè´¨å°†é‡æ–°ç¼–è¯‘ã€‚å¦‚æœä¸æ˜¯è¿™ç§æƒ…å†µï¼Œæè´¨æœªæ­£ç¡®æ¸²æŸ“ï¼Œè¯·æ£€æŸ¥æ­¤æ ‡è®°æ˜¯å¦å·²å¯ç”¨ã€‚
- SingleLayerWater ç€è‰²æ¨¡å‹å¯æä¾›åŠé€æ˜å’Œç…§æ˜ç»“æœï¼Œæˆæœ¬ä»¥æ¯”ä¼ ç»ŸåŠé€æ˜æè´¨æ›´ä½ã€‚


## âš¡ Fog Effects é›¾æ•ˆ
- é›¾æ•ˆ https://docs.unrealengine.com/4.27/zh-CN/BuildingWorlds/FogEffects/

ä½¿ç”¨é›¾æ•ˆæ¥ä¸ºåœºæ™¯æ·»åŠ ã€è®¾ç½®æ°›å›´ï¼Œé›¾æ•ˆæ˜¯åœºæ™¯æ°”æ°›ä¸å¯ç¼ºå°‘çš„å…ƒç´ ã€‚

è™šå¹»å¼•æ“ä¸­çš„é›¾æ•ˆï¼š

- æŒ‡æ•°é«˜åº¦é›¾`Exponential Height Fog`æ˜¯åŸºäºé«˜åº¦çš„è¿œå¤„é›¾ã€‚
- ä»è™šå¹»å¼•æ“ 4.16 ç‰ˆæœ¬å¼€å§‹æ”¯æŒä½“ç§¯é›¾ï¼Œä½¿ç”¨æŒ‡æ•°é«˜åº¦é›¾æ—¶å¯ç”¨ä½“ç§¯é›¾ï¼ˆ`Volumetric Fog`ï¼‰åŠŸèƒ½ã€‚
- å¤§æ°”é›¾ï¼ˆ`Atmospheric Fog`ï¼‰ æä¾›ä¸€ç§é€è¿‡è¡Œæ˜Ÿå¤§æ°”çš„å…‰æ•£å°„çš„è¿‘ä¼¼ç°è±¡ï¼Œè¿™å¯ä»¥è®©å®¤å¤–å…³å¡çœ‹èµ·æ¥æ›´åŠ é€¼çœŸå¾—å¤šã€‚
- å¤©ç©ºå¤§æ°” `SkyAtmosphere` ç»„ä»¶æ˜¯ä¸€ç§åŸºäºç‰©ç†çš„å¤©ç©ºå’Œå¤§æ°”æ¸²æŸ“æŠ€æœ¯ã€‚

ä½¿ç”¨æŒ‡æ•°é«˜åº¦é›¾ï¼šPlace Actors -> Visual Effects -> *Exponential Height Fog*ã€‚

æŒ‡æ•°é«˜åº¦é›¾`Exponential Height Fog`æ˜¯åŸºäºé«˜åº¦çš„è¿œå¤„é›¾ï¼Œåœ¨åœ°å›¾ä¸Šè¾ƒä½ä½ç½®å¤„å¯†åº¦è¾ƒå¤§ï¼Œè€Œåœ¨è¾ƒé«˜ä½ç½®å¤„å¯†åº¦è¾ƒå°ã€‚å…¶è¿‡æ¸¡ååˆ†å¹³æ»‘ï¼Œéšç€æµ·æ‹”å‡é«˜ï¼Œä¹Ÿä¸ä¼šå‡ºç°æ˜æ˜¾åˆ‡æ¢ã€‚æŒ‡æ•°é«˜åº¦é›¾æä¾›ä¸¤ä¸ªé›¾è‰²ï¼Œä¸€ä¸ªç”¨äºé¢æœä¸»å®šå‘å…‰æºï¼ˆå¦‚ä¸å­˜åœ¨ï¼Œåˆ™ä¸ºç›´ä¸Šå…‰æºï¼‰çš„åŠçƒä½“ï¼Œå¦ä¸€ä¸ªç”¨äºç›¸åæ–¹å‘çš„åŠçƒä½“ã€‚

æŒ‡æ•°é«˜åº¦é›¾çš„ä½ç½®å°†å†³å®šé›¾çš„é«˜åº¦ã€‚ä½¿ç”¨é›¾é«˜åº¦è¡°å‡ï¼ˆFog Height Falloffï¼‰ è¿›ä¸€æ­¥è°ƒæ•´é«˜åº¦ã€‚

æŒ‡æ•°é«˜åº¦é›¾çš„æ¸²æŸ“å¼€é”€ä¸é¢å¤–ä¼˜åŒ–çš„ä¸¤å±‚å›ºå®šå¯†åº¦é«˜åº¦é›¾ç›¸è¿‘ã€‚*å¼€å§‹è·ç¦»*ç”¨äºåœ¨æŸ¥çœ‹å™¨å‰æ–¹äººä¸ºä¿ç•™æ— é›¾çš„å®šä¹‰åŒºåŸŸã€‚ç”¨äº Z ç¼“å†²ä¼šå‰”é™¤åƒç´ ï¼Œå› æ­¤è¯¥è·ç¦»æœ‰åŠ©äºç»´æŒæ€§èƒ½ã€‚æ ¹æ®åœºæ™¯å†…å®¹ä»¥åŠå’Œä½¿ç”¨è¿œé›¾å¼€å§‹è·ç¦» çš„æ—¶é—´ï¼Œæ¸²æŸ“å¼€é”€å¯å‡å°‘ 50% ä»¥ä¸Šã€‚æ¸²æŸ“å¯ç”¨ Z å€¼å’Œæ·±åº¦æµ‹è¯•çš„å…¨å±å››è¾¹å½¢å³å¯å®ç°æ­¤ä¼˜åŒ–ã€‚

ä»è™šå¹»å¼•æ“ 4.16 ç‰ˆæœ¬å¼€å§‹æ”¯æŒä½“ç§¯é›¾ï¼Œä½¿ç”¨æŒ‡æ•°é«˜åº¦é›¾æ—¶å¯ç”¨ä½“ç§¯é›¾åŠŸèƒ½ã€‚æ­¤æ–¹æ³•åœ¨æ‘„åƒæœºè§†é”¥çš„æ¯ä¸ªç‚¹ä¸Šéƒ½è®¡ç®—å‚ä¸åª’ä»‹çš„å¯†åº¦å’Œå…‰ç…§ï¼Œä»¥ä¾¿ æ”¯æŒå¯¹é›¾äº§ç”Ÿå½±å“çš„å„ç§å¯†åº¦å’Œä»»æ„æ•°é‡çš„å…‰æºã€‚

è®¾ç½®å’Œè°ƒæ•´ä½“ç§¯é›¾æ—¶ï¼Œä½ å¯ä»¥å…¨å±€æ§åˆ¶å®ƒï¼Œä¹Ÿå¯ä»¥åœ¨åœºæ™¯ä¸­å±€éƒ¨æ§åˆ¶å®ƒã€‚å…¨å±€æ§åˆ¶åŠŸèƒ½ä½¿ä½ èƒ½å¤Ÿä½¿ç”¨æŒ‡æ•°é«˜åº¦é›¾ï¼ˆExponential Height Fogï¼‰ç»„ä»¶æ§åˆ¶æ•´ä¸ªåœºæ™¯çš„é›¾ã€‚ å±€éƒ¨æ§åˆ¶åŠŸèƒ½ä½¿ä½ èƒ½å¤Ÿé€šè¿‡åœ¨å¯ä»¥ç”Ÿæˆç²’å­çš„åŒºåŸŸä¸­ä½¿ç”¨ç²’å­ç³»ç»Ÿçš„æ–¹å¼æ§åˆ¶é›¾ã€‚

è¦æ§åˆ¶ä½“ç§¯é›¾ï¼Œä½ å¯ä»¥è°ƒæ•´æŒ‡æ•°é«˜åº¦é›¾ï¼ˆExponential Height Fogï¼‰ä¸­çš„å±æ€§å’Œæ¯ä¸ªå…‰æºä¸Šçš„å±æ€§ï¼Œä»¥æ§åˆ¶å…‰æºçš„è´¡çŒ®é‡ã€‚

æŒ‡æ•°é«˜åº¦é›¾çš„ä½“ç§¯é›¾åŠŸèƒ½æŒ‰é’®ä½äºç»„ä»¶çš„ä½“ç§¯é›¾ï¼ˆVolumetric Fogï¼‰éƒ¨åˆ†ä¸‹ã€‚æŒ‡æ•°é«˜åº¦ Distribution è§„å®šä½“ç§¯é›¾çš„å…¨å±€å¯†åº¦ã€‚


è™šå¹»å¼•æ“ 4 å¤©ç©ºå¤§æ°” `SkyAtmosphere` ç»„ä»¶æ˜¯ä¸€ç§åŸºäºç‰©ç†çš„å¤©ç©ºå’Œå¤§æ°”æ¸²æŸ“æŠ€æœ¯ã€‚å®ƒç›¸å½“çµæ´»ï¼Œå¯ä»¥åˆ›é€ ç±»ä¼¼åœ°çƒçš„å¤§æ°”å±‚ï¼ŒåŒæ—¶æä¾›åŒ…æ‹¬æ—¥å‡ºå’Œæ—¥è½çš„ä¸€å¤©æ—¶é—´ï¼Œè¿˜å¯ä»¥åˆ›é€ å¥‡ç‰¹çš„å¤–æ˜Ÿå¤§æ°”å±‚ã€‚å®ƒè¿˜æä¾›ç©ºæ°”é€è§†ï¼Œä»ä¸­å¯åˆ©ç”¨ç›¸å…³è¡Œæ˜Ÿæ›²ç‡æ¥æ¨¡æ‹Ÿä»åœ°é¢åˆ°å¤©ç©ºå†åˆ°å¤–å¤ªç©ºçš„è¿‡æ¸¡ã€‚

å¤©ç©ºå¤§æ°”æä¾›ä¸€ç§å…‰ç»è¿‡è¡Œæ˜Ÿå¤§æ°”å±‚ä¸­çš„å‚ä¸ä»‹è´¨å‘ç”Ÿçš„æ•£å°„çš„è¿‘ä¼¼æ•£å°„ï¼Œå› è€Œä¸ºæˆ·å¤–å…³å¡æä¾›æ›´é€¼çœŸæˆ–æ›´å¥‡ç‰¹çš„å¤–è§‚ï¼ŒåŒ…æ‹¬ä»¥ä¸‹å†…å®¹ï¼š

- å¯æœ‰ä¸¤ä¸ªå¤§æ°”å®šå‘å…‰æºæ¥æ”¶æ—¥è½®åœ¨å¤§æ°”ä¸­çš„è¡¨ç°ï¼Œå…¶ä¸­å¤©ç©ºé¢œè‰²å–å†³äºå¤ªé˜³å…‰å’Œå¤§æ°”å±æ€§ã€‚
- å¤©ç©ºé¢œè‰²å°†éšç€å¤ªé˜³é«˜åº¦è€Œå˜åŒ–ï¼Œå³éšä¸»è¦å®šå‘å…‰æºçš„çŸ¢é‡ä¸åœ°é¢å¹³è¡Œç¨‹åº¦è€Œå˜åŒ–ã€‚
- æ§åˆ¶æ•£å°„å’Œæ¨¡ç³Šè®¾ç½®ï¼Œä»è€Œå®Œå…¨æ§åˆ¶å¤§æ°”å¯†åº¦ã€‚
- ä»åœ°é¢åˆ°å¤©ç©ºå†åˆ°å¤ªç©ºè¿‡æ¸¡æ—¶ï¼Œç©ºæ°”é€è§†å¯æ¨¡æ‹Ÿåœºæ™¯çš„æ›²ç‡ã€‚

åˆ©ç”¨å…³å¡ç¼–è¾‘å™¨ä¸­çš„æ¨¡å¼ï¼ˆModesï¼‰é¢æ¿æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ä»¥å¯ç”¨å¤©ç©ºå¤§æ°”ç»„ä»¶ï¼š

- åœ¨åœºæ™¯ä¸­æ”¾ç½®å¤©ç©ºå¤§æ°”ç»„ä»¶ã€‚
- åœ¨åœºæ™¯ä¸­æ”¾ç½®å®šå‘å…‰æºï¼Œç„¶åä»å…¶é¢æ¿å¯ç”¨å¤§æ°”/é›¾å¤ªé˜³å…‰ Details -ã€‹ Atmosphere/Fog Sun Lightã€‚
- è‹¥ä½¿ç”¨å¤šä¸ªå®šå‘å…‰æºï¼Œåˆ™ä¸ºæ¯ä¸ªå®šå‘å…‰æºè®¾ç½®ï¼ˆAtmosphere Sun Light Indexï¼‰ï¼Œä¾‹å¦‚ï¼Œ0è¡¨ç¤ºå¤ªé˜³ï¼Œ1ä»£è¡¨æœˆäº®ã€‚
- åœ¨åœºæ™¯ä¸­æ”¾ç½®å¤©ç©ºå…‰ç…§ `SkyLight` ä»¥é‡‡é›†å¤©ç©ºå¤§æ°”å¹¶è®©å®ƒä¸ºåœºæ™¯å…‰ç…§åšè´¡çŒ®ã€‚

éœ€è¦è°ƒæ•´å¤§æ°”å®šå‘å…‰æºæ—¶ï¼Œå…ˆè¦ä¸ºå®šå‘å…‰æºä¸Šå¯ç”¨ï¼ˆ*Atmosphere/Fog Sun Light*ï¼‰ å¹¶ä¸ºæ¯ä¸ªå®šå‘å…‰æºè®¾ç½®ï¼ˆ*Atmosphere Sun Light Index*ï¼‰ã€‚

å¯åˆ©ç”¨ä»¥ä¸‹å¿«æ·æ–¹å¼å¿«é€Ÿè°ƒæ•´æ¯ä¸ªå®šå‘å…‰æºçš„ä½ç½®ï¼š

- ä½¿ç”¨ Ctrl + L å¹¶ç§»åŠ¨é¼ æ ‡å°†è°ƒæ•´å·²è®¾ä¸ºæŒ‡æ•°0çš„å®šå‘å…‰æºã€‚å®ƒé€šå¸¸æ˜¯å¤ªé˜³ã€‚
- ä½¿ç”¨ Ctrl + L + Shift å¹¶ç§»åŠ¨é¼ æ ‡å°†è°ƒæ•´å·²è®¾ä¸ºæŒ‡æ•° 1 çš„å®šå‘å…‰æºï¼Œå®ƒé€šå¸¸æ˜¯æœˆäº®ã€‚


å¤§æ°”é›¾ï¼ˆ`Atmospheric Fog`ï¼‰ æä¾›ä¸€ç§é€è¿‡è¡Œæ˜Ÿå¤§æ°”çš„å…‰æ•£å°„çš„è¿‘ä¼¼ç°è±¡ã€‚è¿™å¯ä»¥è®©å®¤å¤–å…³å¡çœ‹èµ·æ¥æ›´åŠ é€¼çœŸå¾—å¤šã€‚

æ•´ä½“æ•ˆæœåŒ…æ‹¬ä»¥ä¸‹æ–¹é¢ï¼š

- å…³å¡ä¸­çš„ä¸»å®šå‘å…‰æºå°†åœ¨å¤©ç©ºä¸­è·å¾—æ—¥è½®æ•ˆæœã€‚æ—¥è½®å°†è¢«æ”¾ç½®åœ¨æ— é™è¿œçš„ä½ç½®ï¼Œæ–¹å‘ä¸ä¸»å®šå‘å…‰æºæ–¹å‘ç›¸åã€‚
- å¤©ç©ºé¢œè‰²å°†éšç€å¤ªé˜³çš„é«˜åº¦è€Œå˜åŒ–ï¼ˆæ¢è¨€ä¹‹ï¼Œå³éšç€ä¸»å®šå‘å…‰æºçš„çŸ¢é‡ä¸åœ°é¢å¹³è¡Œçš„ç¨‹åº¦è€Œå˜åŒ–ï¼‰
- æ§åˆ¶æ•£å°„å’Œè¡°å‡è®¾ç½®ï¼Œä»è€Œèƒ½å¤Ÿå®Œå…¨æ§åˆ¶å¤§æ°”å¯†åº¦ã€‚


# ğŸŒŸ GPU Rendering
- GPU å›¾å½¢æ¸²æŸ“ç¼–ç¨‹ https://docs.unrealengine.com/4.27/zh-CN/ProgrammingAndScripting/Rendering/
- ç‰¹æ•ˆç¤ºä¾‹ https://docs.unrealengine.com/4.27/zh-CN/Resources/ContentExamples/EffectsGallery/

é’ˆå¯¹å›¾å½¢ç¨‹åºå‘˜çš„æ¸²æŸ“ç³»ç»Ÿä½¿ç”¨å’Œç€è‰²å™¨ç¼–å†™ä¿¡æ¯ã€‚


# ğŸŒŸ Rendering & Graphics è®¾è®¡è§†è§‰ã€æ¸²æŸ“å’Œå›¾å½¢æ•ˆæœ
- https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics

## âš¡ Global Illumination å…¨å±€å…‰ç…§
- Global Illumination å…¨å±€å…‰ç…§ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/GlobalIllumination/
- åæœŸå¤„ç†ç‰¹æ•ˆ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/PostProcessEffects/

å…¨å±€å…‰ç…§ï¼ˆä¹Ÿç§°é—´æ¥ç…§æ˜å’Œé—´æ¥å…‰ç…§ï¼‰æ¨¡æ‹Ÿä¸å‡ ä½•ä½“å’Œæè´¨è¡¨é¢çš„ç…§æ˜äº¤äº’ï¼Œä¸ºåœºæ™¯å’Œé¡¹ç›®æ·»åŠ çœŸå®çš„ç…§æ˜æ•ˆæœã€‚æ­¤æ¨¡æ‹Ÿè¿˜è€ƒè™‘åˆ°ä¸ä¹‹ç›¸äº’ä½œç”¨çš„æè´¨çš„å…‰çº¿å¸æ”¶æ€§å’Œåå°„æ€§ã€‚

æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥åœ¨ 3D ä¸–ç•Œä¸­æ¨¡æ‹Ÿå…‰çš„æ´»åŠ¨ï¼šä¸€æ˜¯ä½¿ç”¨å®æ—¶å…‰ç…§æ³•ï¼Œè¿™ç§æ–¹æ³•æ”¯æŒåŠ¨æ€å…‰æºçš„å…‰æºç§»åŠ¨å’Œäº¤äº’ï¼›äºŒæ˜¯ä½¿ç”¨é¢„è®¡ç®—ï¼ˆæˆ–å·²çƒ˜ç„™ï¼‰çš„å…‰ç…§ä¿¡æ¯ï¼Œè¿™ç±»ä¿¡æ¯å­˜å‚¨åœ¨å‡ ä½•ä½“è¡¨é¢åº”ç”¨çš„çº¹ç†ä¸­ã€‚è™šå¹»å¼•æ“æä¾›è¿™ä¸¤ç§åœºæ™¯ç…§æ˜æ–¹æ³•ï¼Œå®ƒä»¬å½¼æ­¤äº’ä¸æ’æ–¥ï¼Œå¯ä»¥æ— ç¼åœ°æ··åˆä½¿ç”¨ã€‚

é¢„è®¡ç®—æˆ–çƒ˜ç„™æ³•ç”¨é€”å’ŒåŠŸèƒ½ï¼š

- éå¸¸é€‚åˆæ— éœ€å˜æ›´å…‰ç…§çš„åœºæ™¯ã€‚
- æ€§èƒ½æˆæœ¬ä¸åŠ è½½å’Œå­˜å‚¨å…‰ç…§è´´å›¾çº¹ç†æ‰€éœ€çš„å†…å­˜æœ‰å…³ã€‚
- ç»“æœçš„è´¨é‡å’Œç²¾ç¡®åº¦æ˜¯ç”±è¢«çƒ˜ç„™å’Œåº”ç”¨åˆ°å‡ ä½•ä½“çš„å…‰ç…§è´´å›¾çº¹ç†çš„çº¹ç†åˆ†è¾¨ç‡æ‰€å†³å®šçš„ã€‚
- é»˜è®¤æ”¯æŒé™æ€ç½‘æ ¼ä½“å’Œ BSP å‡ ä½•ä½“ã€‚
- é™æ€ç½‘æ ¼ä½“éœ€è¦è®¾ç½®å…‰ç…§è´´å›¾UVæ¥å­˜å‚¨å…‰ç…§æ•°æ®ã€‚
- å¯ä¸åŠ¨æ€å…‰ç…§ç»“åˆä½¿ç”¨ã€‚

å®æ—¶å…‰ç…§æ³•ç”¨é€”å’ŒåŠŸèƒ½ï¼š

- éå¸¸é€‚åˆéœ€è¦å˜æ›´å…‰ç…§çš„åœºæ™¯ï¼Œå¦‚å¼€ç¯æˆ–å…³ç¯ï¼Œæˆ–æ˜¼å¤œå˜æ¢ç³»ç»Ÿã€‚
- å¤§å‹çš„å¼€æ”¾ä¸–ç•Œç¯å¢ƒå¯¹çƒ˜ç„™å…‰ç…§æå‡ºäº†ä¸åˆ‡å®é™…çš„è¦æ±‚ï¼ˆå³ä½¿æ²¡æœ‰æ˜¼å¤œå˜æ¢ç³»ç»Ÿï¼‰ã€‚çƒ˜ç„™æ—¶é—´ã€å†…å­˜ä½¿ç”¨ç‡ã€çº¹ç†å­˜å‚¨å’Œæ’­æ”¾éƒ½æ˜¯ä½¿ç”¨åŠ¨æ€ GI æ—¶éœ€è¦è€ƒé‡çš„é‡è¦å› ç´ ã€‚
- å®æ—¶è®¡ç®—çš„æ€§èƒ½æˆæœ¬å¯èƒ½è¦æ˜‚è´µå¾—å¤šï¼Œå…·ä½“å–å†³äºæ‰€ä½¿ç”¨çš„æ–¹æ³•ã€‚
- ç»å¸¸éœ€è¦åœ¨è´¨é‡å’Œç²¾ç¡®åº¦ä»¥åŠæ€§èƒ½ä¹‹é—´å¯»æ‰¾å¹³è¡¡ã€‚ä¸€äº›åŠ¨æ€GIæ–¹æ³•å—å®æ—¶ä½¿ç”¨æƒ…å†µçš„é™åˆ¶ã€‚
- é»˜è®¤æ”¯æŒæ‰€æœ‰å‡ ä½•ä½“ç±»å‹ã€‚
- å¯ä¸é¢„è®¡ç®—çš„å…‰ç…§ç»“åˆä½¿ç”¨ã€‚

è™šå¹»å¼•æ“ä¸­çš„åŠ¨æ€å…‰ç…§æ–¹æ³•æä¾›äº†å®æ—¶å…¨å±€å…‰ç…§è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥ç”¨åŠ¨æ€å…‰æºçš„åå°„å…‰ç…§ä¸ºåœºæ™¯æä¾›ç…§æ˜ã€‚ä½ å¯ä»¥ä½¿ç”¨è¿™äº›è§£å†³æ–¹æ¡ˆæ›´æ”¹å…‰ç…§å¹¶è‡ªåŠ¨æ›´æ–°åˆ°åœºæ™¯ä¸­çš„å¯¹è±¡ï¼Œä½¿å®ƒèƒ½å¤Ÿæ¨¡æ‹Ÿæ˜¼å¤œå˜æ¢è¿‡æ¸¡æˆ–ä¸€äº›ç®€å•çš„äº‹æƒ…ï¼Œå¦‚åœ¨åœ¨å®¤å†…å¼€å…³ç¯ã€‚è¿™äº›å…‰ç…§ç³»ç»Ÿæ˜¯å®æ—¶è®¡ç®—çš„ï¼Œå› æ­¤å‡ ä¹ä¸éœ€è¦è®¾ç½®ä¾¿å¯å·¥ä½œã€‚

è™šå¹»å¼•æ“çš„å…‰çº¿è¿½è¸ªåŠŸèƒ½åŒ…æ‹¬åŠ¨æ€å…¨å±€å…‰ç…§æ–¹æ³•ï¼Œåˆ©ç”¨å¾®è½¯çš„ DXR æ¡†æ¶å’Œ NVIDIA çš„å…‰çº¿è¿½è¸ª GPU æ¥æ¸²æŸ“éå¸¸å‡†ç¡®çš„å…‰ç…§ç»“æœã€‚

æ”¯æŒä¸¤ç§å…‰çº¿è¿½è¸ªå…¨å±€å…‰ç…§(RTGI)æ–¹æ³•ï¼š

- Brute Force æ–¹æ³•æ¨¡æ‹Ÿè·¯å¾„è¿½è¸ªå™¨çš„åœ°é¢çœŸå®å‚è€ƒçŠ¶å†µï¼Œå¹¶ä¸”åœ¨å®æ—¶æ¸²æŸ“æ—¶çš„æ‰§è¡Œè¿‡ç¨‹ä¸­æœ€ç›¸ä¼¼ã€‚æ­¤æ–¹æ³•æœ€æ¶ˆè€—å¸§æ€§èƒ½ï¼ŒåŒæ—¶ä¹Ÿæä¾›æœ€ç²¾ç¡®çš„åŠ¨æ€å…¨å±€å…‰ç…§æ–¹æ³•ã€‚
- Final Gather æ–¹æ³•ä½¿ç”¨ä¸¤æ¬¡æ‰«æç®—æ³•ï¼Œé‡‡ç”¨åˆ†å¸ƒå¼ç€è‰²ç‚¹å’Œæ¯åƒç´ å›ºå®šæ•°é‡æ ·æœ¬ï¼Œç”¨ç²¾ç¡®åº¦æ¢å–æ€§èƒ½ã€‚å¯¹äºéœ€è¦å®æ—¶æ€§èƒ½çš„é¡¹ç›®ï¼ŒBrute Force æ–¹æ³•åœ¨ç²¾ç¡®åº¦ä¸Šçš„æƒè¡¡æ„å‘³ç€ä½ çš„å¸§é¢„ç®—å¯ä»¥æ”¯æŒåŠ¨æ€å…¨å±€å…‰ç…§ã€‚

è€Œè™šå¹»å¼•æ“ä¸­çš„å…‰ç…§çƒ˜ç„™ç³»ç»Ÿæä¾›äº†ä¸¤ç§æ–¹å¼ä½¿ç”¨ Lightmass è®¡ç®—å…‰ç…§æ•°æ®ï¼š

- åŸºäº CPU çš„ Lightmass ç³»ç»Ÿ
- åŸºäº GPU çš„ Lightmass ç³»ç»Ÿ

é¢„è®¡ç®—çš„å…‰ç…§ç”¨äºè·å¾—é«˜è´¨é‡ç»“æœï¼Œä¸å—å®æ—¶é™åˆ¶å› ç´ çš„å½±å“ã€‚ç„¶è€Œï¼Œç”±äºå…‰ç…§æ˜¯åœ¨å‡ ä½•ä½“åº”ç”¨çš„çº¹ç†ä¸­ç”Ÿæˆå’Œå­˜å‚¨çš„ï¼Œæ— æ³•åŠ¨æ€åœ°æ”¹å˜ã€‚

åŸºäº CPU çš„ Lightmass ç³»ç»Ÿä½¿ç”¨åä¸º Unreal Swarm çš„ç‹¬ç«‹è¿›ç¨‹æ¥è®¡ç®—å’Œç”Ÿæˆå…‰ç…§æ•°æ®ï¼Œè¿™æ˜¯ä¸€ç§åˆ†å¸ƒå¼ç³»ç»Ÿã€‚Unreal Swarm ä¹Ÿç”¨äºå°†å…‰ç…§åˆ†é…åˆ°æ„å»ºåœºï¼Œåœ¨æ„å»ºåœºä¸­å¯ä»¥å°†å¤æ‚çš„å…³å¡åˆ†è§£ä»¥å®Œæˆæ„å»ºæµç¨‹ã€‚ç”±äºè¿™æ˜¯åœ¨ CPU ä¸Šå¤„ç†çš„ï¼Œæ‰€ä»¥åœ¨ç”Ÿæˆæœ€ç»ˆçš„å…‰ç…§è´´å›¾ç»“æœæ—¶ï¼Œæ„å»ºå¯ä»¥åˆ†é…åˆ°çš„å¯ç”¨çº¿ç¨‹æˆ–æœºå™¨çš„æ•°é‡å˜å¾—æä¸ºé‡è¦ã€‚å¯¹äºä¸€å°æœºå™¨æ¥è¯´ï¼Œå¤æ‚çš„åœºæ™¯å¯èƒ½éœ€è¦å¤§é‡çš„å¤„ç†æ—¶é—´ã€åŠŸç‡å’Œ RAM æ¥å®Œæˆã€‚

åŸºäº GPU çš„ Lightmass (GPULM)æ˜¯ä¸€ç§å…‰ç…§çƒ˜ç„™è§£å†³æ–¹æ¡ˆï¼Œå®ƒå¯ä»¥é¢„è®¡ç®—ç§»åŠ¨æ€§è®¾ç½®ä¸ºé™æ­¢ï¼ˆStationaryï¼‰æˆ–é™æ€ï¼ˆStaticï¼‰çš„å…‰æºçš„å¤æ‚å…‰çº¿äº¤äº’ï¼Œå¹¶å°†è¿™äº›æ•°æ®ä¿å­˜åœ¨ç”Ÿæˆçš„å…‰ç…§è´´å›¾çº¹ç†ä¸­ï¼Œè¿™äº›çº¹ç†åˆè½¬è€Œåº”ç”¨åˆ°åœºæ™¯å‡ ä½•ä½“ã€‚è¿™ä¸ªå°†å…‰ç…§çƒ˜ç„™åˆ°çº¹ç†ä¸­çš„ç³»ç»Ÿç±»ä¼¼äº CPU Lightmass å…¨å±€å…‰ç…§ç³»ç»Ÿã€‚ç„¶è€Œï¼Œä½¿ç”¨ GPU æ¥ç”Ÿæˆå’Œæ„å»ºå…‰ç…§æ•°æ®æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ DirectX 12 å’Œå¾®è½¯ DXR æ¡†æ¶çš„æœ€æ–°å…‰çº¿è¿½è¸ªåŠŸèƒ½ã€‚

å®ƒä½¿ç”¨å•ä¸ªç¼–è¾‘å™¨å†…è¿›ç¨‹æ¥å®Œæˆå…‰ç…§æ„å»ºï¼Œä¸æ”¯æŒä½¿ç”¨ Unreal Swarm çš„åˆ†å¸ƒå¼æ„å»ºï¼Œä½†å®ƒé€šè¿‡ SLI æ”¯æŒå¤šä¸ª GPUã€‚

GPULM å¤§å¤§å‡å°‘äº†è®¡ç®—ã€æ„å»ºå’Œç”Ÿæˆå¤æ‚åœºæ™¯å…‰ç…§æ•°æ®æ‰€éœ€çš„æ—¶é—´ï¼Œå…¶é€Ÿåº¦å¯ä¸åŸºäº CPU Lightmass ä½¿ç”¨ Swarm è¿›è¡Œåˆ†å¸ƒå¼æ„å»ºæ—¶çš„é€Ÿåº¦ç›¸åª²ç¾ã€‚æ­¤å¤–ï¼ŒGPULM æä¾›å…·æœ‰äº¤äº’æ€§çš„æ–°å·¥ä½œæµï¼Œå¯ä»¥å®æ—¶ç¼–è¾‘åœºæ™¯ã€é‡æ–°è®¡ç®—å’Œé‡æ–°æ„å»ºå…‰ç…§ã€‚åŸºäº CPU çš„ Lightmass ç³»ç»Ÿæ— æ³•ä½¿ç”¨æ­¤å·¥ä½œæµã€‚

å·¥ç¨‹è®¾ç½®ï¼š

- Rendering -> Global Illumination è®¾ç½®å…¨å±€ç…§æ˜æ–¹å¼
- Rendering -> Lumen -> Software Ray Tracing Mode è®¾ç½®ä¸º Global Tracingï¼Œè¿™ç§æ–¹å¼æ¯”ç»†èŠ‚è·Ÿè¸ªæ–¹å¼æ›´å¿«é€Ÿï¼Œç²¾ç¡®åº¦è¾ƒè¾ƒä½ã€‚

Lumen å…‰ç…§ä¸€ä¸ªå°ç¼ºé™·ï¼šå½“ç‰©ä½“ä¸å…¥é•œå¤´æ—¶ä¸è¿›è¡Œè®¡ç®—ä»¥æé«˜æ•ˆç‡ï¼Œä¸ä¼šå¯¹å…¶å®ƒç‰©ä½“äº§ç”Ÿç›¸åº”çš„å½±å“ï¼Œå³ä½¿ç”¨åŸæœ¬åº”è¯¥å½±å“åˆ°çš„è¿‘è·ç¦»ç‰©ä½“ã€‚


## âš¡ Lightmass Importance Volume
- Lightmass Importance Volume https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/Lightmass/Basics/

è¦å°†ä¸€ä¸ªå…¨å±€å…‰ç…§é‡è¦ä½“ç§¯æ·»åŠ åˆ°æŸä¸ªå…³å¡ä¸­ï¼Œå°† Place Actors -> Volume -> Lightmass Importance Volume å¯¹è±¡æ‹–åŠ¨åˆ°å…³å¡ä¸­ï¼Œç„¶åå°†å…¶ç¼©æ”¾åˆ°æ‰€éœ€çš„å¤§å°ã€‚

è¿˜å¯ä»¥å°†é€‰ä¸­çš„ Actor è¿›è¡Œè½¬æ¢ï¼ŒDetails -> Convert Actorï¼Œå°†ç”»ç¬”è½¬æ¢ä¸ºå…¨å±€å…‰ç…§é‡è¦ä½“ç§¯ã€‚

å¦‚æœä½ æ”¾ç½®å¤šä¸ªå…¨å±€å…‰ç…§é‡è¦ä½“ç§¯ï¼Œé‚£ä¹ˆå¤§å¤šæ•°ç…§æ˜å·¥ä½œå°†é€šè¿‡åŒ…å«æ‰€æœ‰è¿™äº›ä½“ç§¯çš„è¾¹ç•Œæ¡†æ¥å®Œæˆã€‚ä½†æ˜¯ï¼Œä½“ç§¯ç…§æ˜æ ·æœ¬ä»…æ”¾ç½®åœ¨è¾ƒå°çš„ä½“å—ä¸­ã€‚

ç‚¹å‡»å·¥å…·æ¡ä¸Šçš„ Build -> Build Lightingï¼Œç„¶åç­‰å¾…æ¸²æŸ“ç»“æœã€‚

ä»¥ä¸‹è¿™äº›é¢„ç½®æ¨¡å¼æ˜¯æ—¶é—´èŠ±è´¹å’Œè·å¾—ç”»è´¨ä¹‹é—´çš„å¹³è¡¡ï¼š

- äº§å“çº§ Production - æ¸²æŸ“è¾ƒæ…¢ï¼Œæ•ˆæœçœ‹ä¸Šå»éå¸¸æ£’ï¼Œå¹¶ä¸”å¯ä»¥æ ¡æ­£å„ç§å…‰ç…§æ¸—é€é”™è¯¯ï¼Œéœ€è¦èŠ±è´¹ä¸€äº›æ—¶é—´
- é«˜çº§ High - çœ‹ä¸Šå»å¾ˆå¥½ï¼Œéœ€è¦ä¸€äº›æ—¶é—´
- ä¸­çº§ Medium - çœ‹ä¸Šå»è¾ƒå¥½ï¼Œéœ€è¦ç¨å¾®é•¿ä¸€ç‚¹çš„æ—¶é—´è¿›è¡Œè®¡ç®—
- é¢„è§ˆçº§ Preview - å°†ä¼šå¿«é€Ÿåœ°è¿›è¡Œæ¸²æŸ“ï¼Œå¹¶æä¾›å¤§éƒ¨åˆ†ç›´æ¥å…‰ç…§çƒ˜åŸ¹åçš„ä¸€èˆ¬æ•ˆæœï¼Œåªæ˜¯å¯ä»¥æ¥å—ï¼Œä½†æ¸²æŸ“é€Ÿåº¦å¾ˆå¿«

è¿™äº›ä»…æ˜¯é¢„ç½®ï¼Œè¿˜æœ‰å¾ˆå¤šè®¾ç½®å¯ä»¥è°ƒæ•´ï¼Œä»¥ä¾¿åœ¨æ‚¨çš„æ¸¸æˆä¸­è·å¾—æ»¡æ„çš„å…‰ç…§ï¼Œè¯·å‚ç…§ Lightmass æ–‡æ¡£è·å¾—å…³äºå¦‚ä½•è°ƒæ•´ Lightmass è®¾ç½®çš„æ›´å¤šä¿¡æ¯ã€‚

## âš¡ Post Process Effects åæœŸå¤„ç†
- åæœŸå¤„ç†ç‰¹æ•ˆ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/PostProcessEffects/

è™šå¹»å¼•æ“æä¾›åæœŸå¤„ç†æ•ˆæœï¼Œå…è®¸ç¾æœ¯å¸ˆå’Œè®¾è®¡å¸ˆè°ƒæ•´åœºæ™¯çš„æ•´ä½“å¤–è§‚å’Œæ„Ÿè§‰ã€‚å…ƒç´ å’Œæ•ˆæœçš„ç¤ºä¾‹åŒ…æ‹¬æ³›å…‰ï¼ˆæ˜äº®å¯¹è±¡ä¸Šçš„HDRæ³›å…‰æ•ˆæœï¼‰ã€ç¯å¢ƒé®æŒ¡å’Œè‰²è°ƒæ˜ å°„ã€‚

ä»è™šå¹»å¼•æ“ 4.15 ç‰ˆèµ·ï¼Œé»˜è®¤æƒ…å†µä¸‹å¯ç”¨ç”µå½±è‰²è°ƒæ˜ å°„å™¨ï¼Œä¸å­¦é™¢é¢œè‰²ç¼–ç ç³»ç»Ÿ Academy Color Encoding System (ACES) è®¾ç½®çš„æ ‡å‡†ç›¸åŒ¹é…ã€‚ è¿™ä½¿å¾— UE4 ä¸­çš„è‰²è°ƒæ˜ å°„å™¨å¯ä»¥è½»æ¾åœ°é¢å‘å¤šç§æ˜¾ç¤ºç±»å‹ï¼ŒåŒ…æ‹¬é«˜åŠ¨æ€èŒƒå›´ HDR æ˜¾ç¤ºã€‚å‘ ACES æ ‡å‡†çš„è½¬å˜ç¡®ä¿äº†åœ¨å¤šç§æ ¼å¼å’Œæ˜¾ç¤ºä¹‹é—´ä¿æŒä¸€è‡´çš„é¢œè‰²ï¼Œ åŒæ—¶ä¹Ÿä½œä¸ºä¸€ç§æ–¹å¼æ¥å‰ç»æ€§åœ°é€‚åº”æ‰€ä½¿ç”¨çš„æºï¼Œè€Œæ— éœ€é’ˆå¯¹å…¶ä»–ä»‹è´¨å¯¹å…¶è¿›è¡Œè°ƒæ•´ã€‚

- ç”µå½±è‰²è°ƒæ˜ å°„å™¨æä¾›ä»¥ä¸‹é¢å¤–çš„å¥½å¤„ï¼š
- å¯¹äºç”µè§†å’Œç”µå½±ï¼Œç¬¦åˆACESæ ‡å‡†ã€‚
- é¢å¤–çš„é¢œè‰²åˆ†çº§å’Œç™½å¹³è¡¡æ§åˆ¶ã€‚
- ç°åœ¨ï¼Œè‡ªå‘å…‰é¢œè‰²åœ¨ç‰©ç†ä¸Šä»¥ä¸€ç§æ›´æ­£ç¡®çš„æ–¹å¼æ³›å…‰ã€‚

åæœŸå¤„ç†ä½“ç§¯ï¼ˆPost Process Volumeï¼‰ æ˜¯å¯ä»¥æ·»åŠ åˆ°å…³å¡çš„ä¸€ç§ç‰¹æ®Šç±»å‹çš„ä½“ç§¯ï¼Œç”±äºè™šå¹»å¼•æ“4ä¸ä½¿ç”¨åæœŸå¤„ç†é“¾ï¼Œå› æ­¤ç›®å‰è¿™äº›ä½“ç§¯æ˜¯æ“ä½œåæœŸå¤„ç†å‚æ•°çš„å”¯ä¸€æ–¹æ³•ã€‚æ–°ç³»ç»Ÿè¿˜ä¸å®Œæ•´ï¼Œæˆ‘ä»¬å°†å…¬å¼€ä¸€äº›å¯ç¼–ç¨‹æ€§ï¼Œä½†æ˜¯æˆ‘ä»¬å¸Œæœ›ç³»ç»Ÿèƒ½å¤Ÿå¾ˆå¥½åœ°å¤„ç†å¸¸è§çš„æƒ…å†µã€‚è¿™ä¼šä½¿å¾—ç¾æœ¯å¸ˆ/è®¾è®¡å¸ˆæ›´å®¹æ˜“ä½¿ç”¨è¯¥ç³»ç»Ÿï¼Œç¨‹åºå‘˜ä¹Ÿæ›´å®¹æ˜“å¯¹å®ƒè¿›è¡Œä¼˜åŒ–ã€‚

åœ¨è™šå¹»å¼•æ“4ä¸­ï¼Œæ¯ä¸ªåæœŸå¤„ç†ä½“ç§¯æœ¬è´¨ä¸Šåªæ˜¯ä¸€ç§æ··åˆå±‚ç±»å‹ã€‚å…¶ä»–æ··åˆå±‚å¯èƒ½æ¥è‡ªæ¸¸æˆä»£ç ï¼ˆä¾‹å¦‚ç¢°æ’æ•ˆæœï¼‰ã€UIä»£ç ï¼ˆä¾‹å¦‚æš‚åœèœå•ï¼‰ã€æ‘„åƒæœºï¼ˆä¾‹å¦‚æ™•æ˜ ï¼‰æˆ–Matineeï¼ˆè€ç”µå½±æ•ˆæœï¼‰ã€‚æ¯ä¸€å±‚å¯ä»¥æœ‰ä¸€ä¸ªæƒé‡ï¼Œæ‰€ä»¥å®ƒä¼šå¾ˆå®¹æ˜“æ··åˆæ•ˆæœã€‚

æ··åˆæ€»æ˜¯ä½¿ç”¨æ’å€¼ï¼ˆçº¿æ€§æ’å€¼ï¼‰æ¥å®Œæˆï¼Œè€Œä¸”åªæœ‰å·²å¯ç”¨çš„ä½“ç§¯è¿›è¡Œæ··åˆã€‚é™¤éé€‰ä¸­äº† è§£é™¤ç»‘å®šï¼ˆUnboundï¼‰ å±æ€§ï¼Œå¦åˆ™åªæœ‰å½“æ‘„åƒæœºåœ¨åæœŸå¤„ç†ä½“ç§¯çš„è¾¹ç•Œå†…æ—¶æ‰ä¼šåº”ç”¨è¯¥ä½“ç§¯ã€‚

åæœŸå¤„ç†ä½“ç§¯çš„å±æ€§ï¼š

- Settings ä½“ç§¯çš„åæœŸå¤„ç†è®¾ç½®ã€‚å¤§å¤šæ•°å±æ€§å‰é¢çš„å¤é€‰æ¡†å®šä¹‰ä½“ç§¯ä¸­çš„è¡Œæ˜¯å¦ä½¿ç”¨ä½“ç§¯çš„ æ··åˆæƒé‡ï¼ˆBlend Weightï¼‰ è¿›è¡Œæ··åˆã€‚
- Priority ä¼˜å…ˆçº§å®šä¹‰å¤šä¸ªä½“ç§¯æ··åˆåœ¨ä¸€èµ·çš„é¡ºåºã€‚å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§çš„ä½“ç§¯ä¼˜å…ˆäºæ‰€æœ‰å…¶ä»–é‡å ä½“ç§¯ã€‚
- Blend Radius æ··åˆåŠå¾„ï¼Œåœ¨ä½“ç§¯å‘¨å›´ä¸ä½“ç§¯çš„è®¾ç½®å‘ç”Ÿæ··åˆå¤„çš„è·ç¦»ï¼Œä»¥è™šå¹»å•ä½è®¡é‡ã€‚
- Blend Weight æ··åˆæƒé‡ï¼Œä½“ç§¯çš„å±æ€§å…·æœ‰çš„å½±å“é‡ã€‚0 è¡¨ç¤ºæ— æ•ˆæœï¼›1 è¡¨ç¤ºå…¨æ•ˆæœã€‚
- Enabled å·²å¯ç”¨ï¼Œä½“ç§¯æ˜¯å¦å½±å“åæœŸå¤„ç†ã€‚å¦‚æœä¸º trueï¼Œå°†ä½¿ç”¨ä½“ç§¯çš„è®¾ç½®è¿›è¡Œæ··åˆã€‚
- Unbound è§£é™¤ç»‘å®šï¼Œæ˜¯å¦è€ƒè™‘ä½“ç§¯çš„è¾¹ç•Œã€‚å¦‚æœä¸º trueï¼Œä½“ç§¯å°†å½±å“æ•´ä¸ªåœºæ™¯ï¼Œè€Œæ— è®ºå…¶è¾¹ç•Œå¦‚ä½•ã€‚å¦‚æœ falseï¼Œä½“ç§¯å°†åªå½±å“å…¶è¾¹ç•Œä»¥å†…ã€‚

### âœ’ Post Process Materials åæœŸå¤„ç†æè´¨
- Post Processing Content Examples https://docs.unrealengine.com/4.27/en-US/Resources/ContentExamples/PostProcessing/
- åæœŸå¤„ç†æè´¨ç¤ºä¾‹(è§†é¢‘æ‰«æçº¿) https://docs.unrealengine.com/4.26/zh-CN/RenderingAndGraphics/PostProcessEffects/PostProcessMaterials/PostProcessDemoMaterialOverview/
- å‰–æè™šå¹»æ¸²æŸ“ä½“ç³»ï¼ˆ07ï¼‰- åå¤„ç† https://www.likecs.com/show-137340.html

ä½¿ç”¨ä»¥ä¸‹æ§åˆ¶å°å‘½ä»¤å¯ä»¥åˆ‡æ¢åæœŸæ•ˆæœæ˜¯å¦å¯ç”¨ï¼Œä»¥æŸ¥çœ‹ç›¸åº”æ•ˆæœï¼š

    ShowFlag.PostProcessing 0
    ShowFlag.PostProcessing 1

é€šè¿‡åæœŸå¤„ç†è®¾ç½®ï¼ˆé€šå¸¸ç”¨åæœŸå¤„ç†ä½“ç§¯æˆ–æ‘„åƒæœºè®¾ç½®å®šä¹‰ï¼‰ï¼Œå¯ä»¥æ··åˆï¼ˆæ‰€è°“çš„ï¼‰å¯æ··åˆèµ„æºã€‚ ç›®å‰ï¼Œåªæœ‰ æè´¨ï¼ˆMaterialsï¼‰ å’Œ æè´¨å®ä¾‹ï¼ˆMaterial Instancesï¼‰ æ˜¯å¯æ··åˆèµ„æºã€‚è¯¥å¼•æ“æä¾›äº†ä¸€äº›åæœŸå¤„ç†æè´¨ï¼Œä½†æœ‰äº†è¿™ä¸ªç‰¹æ€§ï¼Œ æ‚¨å¯ä»¥åˆ›å»ºè‡ªå·±çš„ è‡ªå®šä¹‰åæœŸå¤„ç†ï¼Œæ— éœ€ä»»ä½•ç¨‹åºå‘˜çš„å¸®åŠ©ã€‚

åªéœ€å°†ä¸€ä¸ªæˆ–å¤šä¸ªåæœŸå¤„ç†æè´¨åˆ†é…åˆ° å¯æ··åˆï¼ˆBlendablesï¼‰ éƒ¨åˆ†çš„åæœŸå¤„ç†ä½“ç§¯ä¸­ã€‚é¦–å…ˆæŒ‰ + æ·»åŠ æ–°æ§½ï¼Œ åœ¨ å†…å®¹æµè§ˆå™¨ï¼ˆContent Browserï¼‰ ä¸­é€‰æ‹©ä¸€ä¸ªæè´¨ï¼Œç„¶åæŒ‰å·¦ç®­å¤´è¿›è¡Œåˆ†é…ã€‚è¿™é‡Œçš„é¡ºåºå¹¶ä¸é‡è¦ï¼Œæœªä½¿ç”¨çš„æ’æ§½å°†è¢«å¿½ç•¥ã€‚

åæœŸå¤„ç†æè´¨éœ€è¦æŒ‡å®šæè´¨åŸŸä¸º Post Processï¼Œå¹¶ä¸”ï¼ŒåæœŸå¤„ç†æè´¨åªèƒ½ä½¿ç”¨è‡ªå‘å…‰é¢œè‰²ï¼ˆEmissive Colorï¼‰è¾“å‡ºæ–°é¢œè‰²ã€‚æ­¤å¤–ï¼Œå¯ä»¥å®šä¹‰åœ¨åæœŸå¤„ç†è¿‡ç¨‹ä¸­åº”åœ¨ä½•å¤„åº”ç”¨æ­¤é€šé“(Blendable Location)ï¼Œå¦‚æœæœ‰å¤šä¸ªé€šé“ï¼Œåˆ™åº”æŒ‰ä»€ä¹ˆé¡ºåºå¤„ç†ï¼ˆBlendable Priorityï¼‰ã€‚

å¼•æ“å·²ç»å…·æœ‰åŸºäºåæœŸå¤„ç†èŠ‚ç‚¹å›¾è¡¨çš„å¤æ‚åæœŸå¤„ç†åŠŸèƒ½ã€‚åæœŸå¤„ç†æè´¨ï¼ˆPost Processing Materialsï¼‰ å¯ä»¥é¢å¤–æ’å…¥åˆ°æŸäº›ç‰¹å®šä½ç½®ã€‚æœ‰å…³ r.CompositionGraphDebugï¼Œè¯·å‚é˜…å¸¸è§é—®é¢˜éƒ¨åˆ†ï¼Œè·å–å®Œæ•´å›¾è¡¨çš„è½¬å‚¨ã€‚ è¿™å¼ å›¾è¡¨å®é™…ä¸Šä¸ä»…åœ¨åšåæœŸå¤„ç†ï¼Œè¿˜åœ¨åšéƒ¨åˆ†ç…§æ˜äº‹å®œã€‚

å¤§å¤šæ•°æ—¶å€™ï¼Œå›¾è¡¨ä¼šè‡ªåŠ¨åˆ›å»ºä¸­é—´æ¸²æŸ“ç›®æ ‡ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœæ‚¨æƒ³ä¸å‰ä¸€ç§é¢œè‰²æ··åˆï¼Œæ‚¨éœ€è¦åœ¨ç€è‰²å™¨ä¸­è¿›è¡Œæ··åˆ ï¼ˆä½¿ç”¨æ¥è‡ª *PostProcessInput0* çš„è¾“å…¥ï¼‰ã€‚

åæœŸå¤„ç†æè´¨åº”è¯¥èŠ‚çº¦ä½¿ç”¨ï¼Œä»…åœ¨çœŸæ­£éœ€è¦æ—¶ä½¿ç”¨ã€‚åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œå¦‚é¢œè‰²æ ¡æ­£æˆ–è°ƒæ•´ã€æ³›å…‰ã€æ™¯æ·±å’Œå„ç§å…¶ä»–æ•ˆæœï¼Œæ‚¨åº”è¯¥ä½¿ç”¨åæœŸå¤„ç†ä½“ç§¯ä¸­å›ºæœ‰çš„è®¾ç½®ï¼Œè¿™äº›è®¾ç½®å·²ç»è¿‡ä¼˜åŒ–ï¼Œè€Œä¸”æ›´æœ‰æ•ˆã€‚

åæœŸå¤„ç†æè´¨å¯æ··åˆä½ç½®ï¼š

- è‰²è°ƒæ˜ å°„å‰ï¼ˆBefore Tonemappingï¼‰*PostProcessInput0* ä¸º HDR ä¸­çš„æ‰€æœ‰ç…§æ˜æä¾›åœºæ™¯é¢œè‰²ã€‚ç”¨å®ƒæ¥ä¿®å¤æ—¶é—´æŠ—é”¯é½¿å’Œ GBuffer æŸ¥æ‰¾çš„é—®é¢˜ï¼Œå¦‚æ·±åº¦ï¼Œæ³•çº¿ã€‚
- è‰²è°ƒæ˜ å°„åï¼ˆAfter Tonemappingï¼‰é¦–é€‰æ€§èƒ½ä½ç½®ï¼Œå› ä¸ºé¢œè‰²æ˜¯ LDRï¼Œå› æ­¤éœ€è¦çš„ç²¾åº¦å’Œå¸¦å®½è¾ƒå°‘ã€‚è¿™æ˜¯åœ¨è‰²è°ƒæ˜ å°„å’Œé¢œè‰²åˆ†çº§ä¹‹åã€‚
- åŠé€æ˜å‰ï¼ˆBefore Translucencyï¼‰è¿™åœ¨é€šé“ä¸­ç”šè‡³æ¯”åŠé€æ˜ä¸åœºæ™¯é¢œè‰²ç»“åˆä¹‹å‰çš„"è‰²è°ƒæ˜ å°„å‰"è¿˜è¦æ—©ã€‚æ³¨æ„ SeparateTranslucency çš„æ··åˆæ¯”æ³•çº¿é€æ˜åº¦è¦æ™šã€‚
- æ›¿æ¢è‰²è°ƒæ˜ å°„å™¨ï¼ˆReplacing the Tonemapperï¼‰*PostProcessInput0* ä¸º HDR æä¾›åœºæ™¯é¢œè‰²ï¼Œ*PostProcessInput1* å…·æœ‰ SeparateTranslucencyï¼ˆAlphaæ˜¯é®ç½©ï¼‰ï¼Œ*PostProcessInput2* å…·æœ‰ä½åˆ†è¾¨ç‡æ³›å…‰è¾“å…¥ã€‚

å…¸å‹çš„åæœŸå¤„ç†è¾“å…¥æ¥è‡ªä»¥å‰çš„é€šé“ã€‚å½“ä½¿ç”¨ *PostProcessInput0* æ—¶ï¼Œå¯ä»¥é€šè¿‡ SceneTexture æè´¨è¡¨è¾¾å¼è®¿é—®è¯¥é¢œè‰²ã€‚ä½¿ç”¨ SceneColor å¯èƒ½ä¸ä¼šå¾—åˆ°æ­£ç¡®çš„ç»“æœã€‚

é»˜è®¤çš„æ··åˆé˜¶æ®µæ˜¯åœ¨è‰²è°ƒæ˜ å°„ä¹‹åï¼ˆAfter Tonemappingï¼‰ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å˜æ··åˆä½ç½®æ¥å®ç°ä¸åŒçš„æ•ˆæœã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬çš„åå¤„ç†æ•ˆæœéœ€è¦ç”¨åˆ°è‰²è°ƒæ˜ å°„ä¹‹å‰çš„åœºæ™¯é¢œè‰²ï¼Œé‚£ä¹ˆå°±éœ€è¦å°†æ··åˆä½ç½®æ”¹æˆ Before Tonemappingï¼›å¦‚æœéœ€è¦è‡ªå®šä¹‰è‰²è°ƒæ˜ å°„ç®—æ³•ï¼Œä»¥ä»£æ›¿ UE çš„é»˜è®¤è‰²è°ƒæ˜ å°„æ•ˆæœï¼Œé‚£ä¹ˆå¯ä»¥æ”¹æˆ Replacing the Tonemapperï¼›å¦‚æœæˆ‘ä»¬çš„åå¤„ç†æ•ˆæœä¸å¸Œæœ›å½±å“é€æ˜ç‰©ä½“ï¼Œåˆ™å¯ä»¥æ”¹æˆBefore Translucencyï¼›å¦‚æœæƒ³å®ç°è‡ªå®šä¹‰çš„ SSR ç®—æ³•ï¼Œåˆ™å¯ä»¥æ”¹æˆ SSR Inputã€‚

ä»¥ä¸‹ç¤ºèŒƒå±å¹•æ‰«æçº¿çš„åæœŸæ•ˆæœï¼Œä½¿ç”¨ UE 4.26ã€‚

- åœ¨å†…å®¹æµè§ˆå™¨ä¸­çš„ Add New -> Material åˆ›å»ºæ–°æè´¨å¯¹è±¡ï¼Œå¹¶å‘½åï¼Œå¦‚ M-PostProcessã€‚
- åŒå‡»æ‰“å¼€æ­¤æè´¨ç¼–è¾‘å™¨ï¼Œè®¾ç½® Material -> Material Domain å±æ€§è®¾ä¸ºåæœŸå¤„ç†ï¼ˆPost Processï¼‰ã€‚
- å¹¶ä¸”ï¼Œå°†ç€è‰²æ¨¡å‹ï¼ˆShading Modelï¼‰è®¾ä¸ºæ— å…‰ç…§ï¼ˆUnlitï¼‰ï¼Œå› ä¸ºä¸éœ€è¦å…‰æºçš„å½±å“ã€‚
- è®¾ç½® Post Process Material -> Blendable Location å±æ€§è®¾ä¸ºè‰²è°ƒæ˜ å°„å‰æ··åˆï¼ˆBefore Tonemappingï¼‰ã€‚è¿™ä¼šå¯¹æ€§èƒ½äº§ç”Ÿå½±å“ï¼Œä½†å¯é˜²æ­¢è§†å›¾è¿åŠ¨æ—¶å‡ºç°é‡å½±ã€‚

ç°åœ¨å³å¯åˆ›å»ºä¸€äº›æè´¨è¡¨ç°ç½‘ç»œï¼Œå®šä¹‰åæœŸå¤„ç†çš„æ•ˆæœã€‚

- æ‰°ä¹±åœºæ™¯é¢œè‰²ï¼ˆScene Colorï¼‰çš„ UVã€‚
    - é¦–å…ˆï¼Œæ·»åŠ åœºæ™¯çº¹ç†ï¼ˆScene Textureï¼‰è¡¨è¾¾å¼å¼€å§‹ï¼ŒDetails å±æ€§é¢æ¿ä¸­ï¼Œé€‰æ‹©çº¹ç†ä¸ºåœºæ™¯é¢œè‰²ï¼ˆScene Colorï¼‰ï¼Œä»¥é€šè¿‡åæœŸå¤„ç†å¯¹åœºæ™¯è¿›è¡Œè®¾ç½®ã€‚
    - ä½¿ç”¨ç®€å•çš„å¹³ç§»çº¹ç† (ScanDistort.png) æ‰°ä¹±åœºæ™¯é¢œè‰²ï¼ˆScene Colorï¼‰çš„ UVã€‚åªéœ€è¦å°†çº¹ç† RGB ä¹˜ä»¥ 0.03ã€‚
    - ç„¶åä½¿ç”¨ Mask æå– R å’Œ G é€šé“ç»„åˆï¼Œå¹¶ä¸ TextureCoordinate çº¹ç†åæ ‡ç›¸åŠ ï¼Œåœ¨å±å¹•ä¸Šæœ‰æ•ˆåœ°æ»‘åŠ¨åƒç´ å»ºå‡ºæ‰­æ›²æ•ˆæœã€‚
- ä½¿ç”¨ 4x4 åƒç´ æ‰«æçº¿çº¹ç†ä½é¢‘ç§»åŠ¨ï¼Œä¸¤ä¸ªæ–¹å‘éœ€è¦åˆ†åˆ«è®¾ç½®ä¸åŒçš„é¢‘ç‡ã€‚
    - ç¬¬ä¸€ä¸ªä½¿ç”¨ 4x4 åƒç´ æ‰«æçº¿çº¹ç†ï¼Œè®¾ç½®åœ¨å‚ç›´æ–¹å‘å¤§é‡å¹³é“º (VTiling:128)ï¼Œç„¶åå¾ˆæ…¢åœ°å‘ä¸‹å¹³ç§»(Speed Y:-0.1)ã€‚
    - ç¬¬äºŒä¸ªä½¿ç”¨ç›¸åŒçš„æ‰«æçº¿çº¹ç†ï¼Œå¹³é“ºå€¼è®¾ä¸º 1.28ï¼Œå‘ä¸Šå¹³ç§»ï¼Œé€Ÿåº¦ç¨å¿«ã€‚å¹¶å°†å…¶é”å®šåœ¨ 0.1 åˆ° 0.5 ä¹‹é—´ã€‚å¯åœ¨æ‰«æçº¿ä¸­å½¢æˆä¸€äº›å˜åŒ–ã€‚
- åˆ›å»ºä¸€ä¸ªæ—¶é—´é©±åŠ¨çš„æ­£å¼¦æ³¢ï¼Œä½¿æ‰«æçº¿å‡ºç°é—ªçƒã€‚
    - åˆ›å»ºä¸€ä¸ªæ—¶é—´é©±åŠ¨çš„æ­£å¼¦æ³¢ï¼Œåœ¨ 0.6 åˆ° 1.0 ä¹‹é—´ä»¥ 10 Hz çš„é¢‘ç‡è¿è¡Œã€‚èŠ‚ç‚¹è¡¨è¾¾å¼ä¸º Sine(Time * 10) * 0.1 + 0.3ã€‚
- ç°åœ¨åˆ›å»ºçº¿æ€§æ’å€¼èŠ‚ç‚¹æ¥æ•´åˆå‰é¢åˆ›å»ºçš„éƒ¨åˆ†åŠŸèƒ½ç½‘ç»œï¼š
    - ä½¿ç”¨ Multiple åˆå¹¶å‰é¢åˆ¶ä½œå¥½çš„ 4x4 åƒç´ æ‰«æçº¿çº¹ç†ï¼Œå¹¶ä¸ Scene Color çš„ RGB ç›¸ä¹˜ã€‚ä½¿ç”¨ ComponentMask å¯ä»¥åˆ†ç¦»å¾—åˆ° RGB é€šé“ã€‚
    - å°† Mask(RGB) å’Œä¹˜ç§¯è¾“å…¥ Lerp çš„ A å’Œ B è¿›è¡Œæ’å€¼ï¼ŒAlpha æ¥å…¥æ­£ç»Ÿæ³¢ä»¥æ§åˆ¶æ’å€¼çš„å˜åŒ–ã€‚
- åˆ¶ä½œä¸¤ä¸ª Noise çº¹ç†ã€‚
    - å– Noise.PNG çº¹ç†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Perlin éšæœºå™ªå£°çº¹ç†æ›¿ä»£ï¼Œä»¥ä¸¤ç§ä¸åŒçš„é‡å’Œé€Ÿåº¦æ‰§è¡Œå¹³é“ºå’Œå¹³ç§»ï¼Œè·å¾—ä¸åŒæ•ˆæœã€‚
    - å–ä¸¤ä¸ª noise çš„å¹³å‡å€¼ï¼Œç„¶åä¸ ScanDistort çº¹ç†ç›¸ä¹˜ã€‚å°†ç»“æœä¹˜ä»¥ 40ï¼Œç„¶åæ·»åŠ åˆ°ç»“æœä¸­ï¼Œåˆ›å»ºç™½è‰²é™æ€ç”»é¢ã€‚
    - é€‰å–å¹³ç§» ScanDistort çº¹ç†ï¼Œå°†å…¶æå‡ä¸º 4 çš„å¹‚æ¬¡æ–¹ï¼ˆæå‡å¯¹æ¯”åº¦ï¼‰ï¼Œä¹˜ä»¥ 40 ä½¿å…¶æ›´æ˜äº®ï¼Œç„¶åä»æœ€åç»“æœä¸­å°†å…¶å‡å»ï¼Œä½¿å…¶å˜ä¸ºå…¨é»‘è‰²ã€‚å¯åˆ›å»ºå‡ºå¤å¤ VCR ä¸­å¸¸è§çš„é»‘æ¡æ•ˆæœã€‚


ç°åœ¨éœ€è¦å°†æè´¨å’ŒåæœŸå¤„ç†ä½“ç§¯å…³è”èµ·æ¥ï¼Œå‘åœºæ™¯æ·»åŠ  Post Process Volumeï¼Œä¿æŒåœ¨ä¸–ç•Œå¤§çº²è§†å›¾é€‰ä¸­çŠ¶æ€ã€‚

- è®¾ç½®ç»†èŠ‚ Details -> Misc ç±»ç›®ä¸‹çš„ Blendables å±æ€§ï¼Œç‚¹å‡»å±æ€§æ—çš„ + æŒ‰é’®æ·»åŠ ä¸€ä¸ªæ–°å…ƒç´ ã€‚(Render Features -> Post Process Materials)
- åœ¨ Content Browser ä¸­é€‰æ‹©æ–°æè´¨ï¼Œç„¶åç‚¹å‡»åº”ç”¨æŒ‰é’®å°†æè´¨åº”ç”¨åˆ°å…ƒç´ ã€‚

ç°åœ¨ï¼Œè®¾ç½®åæœŸå¤„ç†ä½“ç§¯å¯¹è±¡ï¼š

- Post Process Volume Settings -> Weight è®¾ç½®ä¸€ä¸ªå°äº 0.5 çš„å€¼ï¼Œå¤ªé«˜ä¼šå¯¼è‡´å…‰å¼ºåº¦ç´¯ç§¯è¿‡å¿«å¯¼è‡´å…¨ç™½ç”»é¢ã€‚
- Film -> Saturation è®¾ç½®å€¼æ¥è¿‘äº 0ï¼Œé™ä½è‰²å½©é¥±å’Œåº¦ã€‚
- Film -> Tint è®¾ç½®ä¸€ä¸ªæ·¡ç»¿è‰²ï¼Œä»¥åœ¨ç»“æœä¸ŠæŠ•å°„å‡ºæ·¡ç»¿è‰²ã€‚
- Film -> Contrast å¯¹æ¯”åº¦è®¾ä¸º 0.65 å·¦å³ã€‚
- Film -> Crush Shadows å’Œ Crush Highlights å†è°ƒæ•´ä»¥è¿›ä¸€æ­¥å¢åŠ å¯¹æ¯”åº¦ã€‚
- Lens -> Image Effects -> Vignette Intensity è®¾ä¸º 0.9 å·¦å³ï¼Œå½¢æˆæå¼ºçš„æ™•æ˜ ã€‚
- Lens -> Bloom è¾‰å…‰å¼ºåº¦è®¾ä¸º 3.0 å·¦å³ã€‚

UE5 åæœŸå¤„ç†æè´¨ SceneTextureId ä¸èƒ½ä½¿ç”¨ SceneColorï¼š

```C++
// UE_5.0EA\Engine\Source\Runtime\Engine\Private\Materials\HLSLMaterialTranslator.cpp
void FHLSLMaterialTranslator::UseSceneTextureId(ESceneTextureId SceneTextureId, bool bTextureLookup)
    ...
    if(SceneTextureId == PPI_SceneColor && Material->GetMaterialDomain() != MD_Surface)
    {
        if(Material->GetMaterialDomain() == MD_PostProcess)
        {
            Errorf(TEXT("SceneColor lookups are only available when MaterialDomain = Surface. PostProcessMaterials should use the SceneTexture PostProcessInput0."));
        }
        else
        {
            Errorf(TEXT("SceneColor lookups are only available when MaterialDomain = Surface."));
        }
    }
    ...
```

åœºæ™¯çº¹ç†åº”æ”¹ä¸º PostProcessInputï¼Œè€Œä¸æ˜¯æ–‡æ¡£æ‰€æŒ‡çš„ SceneColorã€‚ä½†æ˜¯ï¼Œåœ¨å¤šæ•°åå¤„ç†é€šé“ä¸­ï¼ŒPostProcessInput0 ~ PostProcessInput6 æ˜¯ç©ºçº¹ç†ã€‚

æ–°å»º PostProcessVolumeï¼Œè€Œä¸”æŒ‡å‘å®ƒè‡ªèº«åŒºåŸŸå†…æ‰æœ‰æ•ˆæœï¼Œä¸éœ€è¦å‹¾é€‰ Unboundï¼Œå½“ä¸”ä»…å½“ç©å®¶è¿›å…¥è¯¥åŒºåŸŸæ—¶ï¼Œæ‰èƒ½çœ‹åˆ° PostProcess ç‰¹æ•ˆã€‚

å¹¶ä¸”ï¼ŒPostProcessVolume ä¸å†æä¾› Blendables è®¾ç½®ã€‚é€šè¿‡ Render Features -> Post Process Materials è®¾ç½®ï¼Œåªè¦å°†å®ç°äº† IBlendableInterface æ¥å£çš„æè´¨æ·»åŠ åˆ°è¿™ä¸ªæ•°ç»„å³å¯ã€‚

æ–°ç‰ˆæœ¬ä¸­ï¼Œæè´¨ä¾ç„¶å¯ä»¥æŒ‡å®šä¸º Blendable æè´¨ï¼ŒPost Process Material -> Is Blendableã€‚

å¦å¤–ï¼Œå®˜æ–¹æ–‡æ¡£çš„ä¸¤ä¸ª Noise è¾“å‡ºè¿æ¥æœ‰é”™ï¼ŒRGB å’Œ RGBA ä¸èƒ½è¿æ¥åˆ° Add èŠ‚ç‚¹ä¸Šï¼Œå› ä¸ºé€šé“æ•°é‡ä¸åŒï¼Œåº”è¯¥ç»Ÿä¸€ä½¿ç”¨ RGBã€‚


## âš¡ RayTracing å®æ—¶å…‰çº¿è¿½è¸ª
- RayTracing å®æ—¶å…‰çº¿è¿½è¸ª https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/RayTracing/

ç”µå½±ã€ç”µè§†å’Œå¯è§†åŒ–é¢†åŸŸé•¿æœŸä½¿ç”¨å…‰çº¿è¿½è¸ªæŠ€æœ¯æ¸²æŸ“ç…§ç‰‡èˆ¬é€¼çœŸçš„å½±åƒï¼Œä½†è¿™ç§æŠ€æœ¯éœ€è¦åŠŸèƒ½å¼ºå¤§çš„è®¡ç®—æœºï¼Œè€Œä¸”æ¸²æŸ“æ¯ä¸€å¸§å›¾åƒéƒ½å¾ˆèŠ±æ—¶é—´ã€‚

é€šè¿‡å°†è™šå¹»å¼•æ“4ï¼ˆUE4ï¼‰çš„æŠ€æœ¯ä¸ å®æ—¶å…‰çº¿è¿½è¸ªï¼ˆRTRTï¼‰ç›¸ç»“åˆï¼Œå°±å¯ä»¥åˆ›ä½œå‡ºåœ¨ç»†å¾®å…‰ç…§æ•ˆæœä¸Šèƒ½å¤Ÿä¸è®¸å¤šè„±æœºæ¸²æŸ“å™¨ç›¸åª²ç¾çš„äº¤äº’å¼ä½“éªŒã€‚å®æ—¶å…‰çº¿è¿½è¸ªå¯ä»¥è®©å½±åƒçœ‹èµ·æ¥æ›´è‡ªç„¶ï¼Œåˆ¶ä½œå‡ºé¢ç§¯å…‰æºä¸‹çš„æŸ”å’Œé˜´å½±ã€å‡†ç¡®çš„ç¯å¢ƒå…‰é®è”½ã€äº¤äº’å¼çš„å…¨å±€å…‰ç…§ç­‰æ•ˆæœã€‚

UE4 ä¸­çš„å…‰çº¿è¿½è¸ªåŒ…å«ä¸¤ç§æŠ€æœ¯ï¼š

- æ··åˆçš„ Ray Tracerï¼Œå°†å…‰çº¿è¿½è¸ªåŠŸèƒ½ä¸æˆ‘ä»¬ç°æœ‰çš„å…‰æ …æ•ˆæœç›¸ç»“åˆã€‚
- Path Tracerï¼Œç”¨äºç”Ÿæˆå‚è€ƒæ¸²æŸ“å™¨ã€‚

Ray Tracer èƒ½å¤Ÿé’ˆå¯¹é˜´å½±ã€ç¯å¢ƒå…‰é®è”½ï¼ˆAOï¼‰ã€åå°„ã€åŠé€æ˜å’Œå…¨å±€å…‰ç…§ç”Ÿæˆå¸¦æœ‰å…‰çº¿è¿½è¸ªçš„å®æ—¶æ•ˆæœã€‚å®ƒä½¿ç”¨æ•°é‡ä¸å¤šçš„é‡‡æ ·é…åˆé™å™ªç®—æ³•æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œå¯ä»¥å¾—åˆ°åœ¨è§†è§‰ä¸Šå¾—åˆ°ä¸ Path Tracer æä¸ºè¿‘ä¼¼çš„æ•ˆæœã€‚é€šè¿‡è®¾ç½®åæœŸå¤„ç†ä½“ç§¯ã€Actorã€å…‰æºã€æè´¨çš„ç›¸å…³å±æ€§æ¥å½±å“å…‰çº¿è¿½è¸ªåŠŸèƒ½ã€‚

Path Tracer æ˜¯ä¸€æ¬¾åŸºäºç‰©ç†çš„æ— åæ€§è·¯å¾„è¿½è¸ªå™¨ï¼Œå¾ˆé€‚åˆæ¸²æŸ“åœºæ™¯çš„å‚è€ƒå›¾åƒã€‚å®ƒä¸è„±æœºæ¸²æŸ“å™¨ç±»ä¼¼ï¼Œé€šè¿‡è¿ç»­æ”¶é›†é‡‡æ ·æ¥å·¥ä½œï¼Œä»¥å®ƒç›®å‰çš„çŠ¶æ€æ›´é€‚åˆç”¨äºç”Ÿæˆåœºæ™¯çš„çœŸç›¸æ¸²æŸ“ï¼Œè€Œä¸æ˜¯æœ€ç»ˆåƒç´ ã€‚

å¯ç”¨å…‰çº¿è¿½è¸ªæ”¯æŒï¼Œéœ€è¦ GeForce RTX GPUsï¼Œè™šå¹»å¼•æ“ 4.22+ ç‰ˆæœ¬ã€‚

ä¸ºä½ çš„é¡¹ç›®å¯ç”¨ DX12 å’Œå…‰çº¿è¿½è¸ªï¼šEdit -> Project Settings -> Platforms -> Windows -> Default RHI -> DX12ï¼Œä»¥åŠ Engine -> Rendering -> Ray Tracingã€‚

è¦å¯ç”¨å…‰çº¿è¿½è¸ªï¼Œå¿…é¡»ä¸ºé¡¹ç›®å¯ç”¨æ”¯æŒè®¡ç®—çš®è‚¤ç¼“å­˜ï¼ˆSupport Compute Skincacheï¼‰ã€‚å¦‚æœè¯¢é—®ä½ æ˜¯å¦è¦ç«‹å³å¯ç”¨ï¼Œè¯·å•å‡»ï¼ˆYesï¼‰ã€‚

ä½¿ç”¨è·¯å¾„è¿½è¸ªå™¨ï¼šViewport -> View Modes -> Path Tracingã€‚è®¾ç½® Post Process Volume æ¸²æŸ“åŠŸèƒ½ Rendering Features -> Path Tracingï¼Œå¯ä»¥è®¾ç½®å…‰çº¿åº”è¯¥è¡Œè¿›çš„æœ€å¤§åå°„æ¬¡æ•°ï¼ˆMax Bouncesï¼‰ å’Œåº”è¯¥ç”¨äºæ”¶æ•›çš„é€åƒç´ é‡‡æ ·ï¼ˆSamples Per Pixelï¼‰ã€‚ 

## âš¡ Visibility Culling å¯è§†æ€§å’Œé®æŒ¡å‰”é™¤
- å¯è§†æ€§å’Œé®æŒ¡å‰”é™¤ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/VisibilityCulling/VisibilityCullingReference/
- Precomputed Visibility Volume https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/VisibilityCulling/PrecomputedVisibilityVolume/
- Cull Distance Volume https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/VisibilityCulling/CullDistanceVolume

é¡¹ç›®è®¾ç½®åŒ…å«ä¼šå½±å“é¡¹ç›®æ•´ä½“çš„å‰”é™¤è®¾ç½®ï¼Œä¾‹å¦‚å¯¹ç¡¬ä»¶é®æŒ¡æŸ¥è¯¢çš„æ”¯æŒã€åº”å‰”é™¤ç…§æ˜çš„å±å¹•å°ºå¯¸ç­‰ç­‰ã€‚

å¯è§†æ€§å’Œé®æŒ¡å‰”é™¤æ–¹å¼ï¼š

- Precomputed Visibility Volume é¢„è®¡ç®—å¯è§†æ€§ä½“ç§¯ï¼Œé€šè¿‡ç¦»çº¿å‰”é™¤æ–¹æ³•æ¥åŠ¨æ€å‰”é™¤å…³å¡ä¸­çš„å¯¹è±¡ã€‚
- Cull Distance Volume å¯æ ¹æ®å¯¹è±¡è·æ‘„åƒæœºçš„è·ç¦»åŠå…¶å°ºå¯¸ï¼Œå¯¹å¯¹è±¡è¿›è¡Œå‰”é™¤ï¼ˆå³ä¸ç»˜åˆ¶åˆ°å±å¹•ä¸Šï¼‰ã€‚

æ‰“å¼€é¡¹ç›®è®¾ç½® Project Settings -> Rendering -> Culling éƒ¨åˆ†æ¥æŸ¥çœ‹è¿™äº›è®¾ç½®ï¼š

- Occlusion Culling å…è®¸é®æŒ¡æŸ¥è¯¢æ–¹æ³•ï¼ˆå¦‚ç¡¬ä»¶ã€è½¯ä»¶å’Œå¾ªç¯é®æŒ¡æŸ¥è¯¢ï¼‰æ¥å‰”é™¤ Actorã€‚è¯¥è®¾ç½®ä¸ç¦ç”¨åŸºäºè·ç¦»çš„å‰”é™¤æ–¹æ³•ï¼Œå¦‚å‰”é™¤è·ç¦»æˆ–é¢„è®¡ç®—å¯è§†æ€§ä½“ç§¯ã€‚ç¦ç”¨é®æŒ¡å‰”é™¤å¯èƒ½ä¼šå¯¹é¡¹ç›®å’Œå…³å¡äº§ç”Ÿæ˜æ˜¾çš„æ€§èƒ½å½±å“ï¼Œå…·ä½“å–å†³äºè¢«æ¸²æŸ“çš„ Actor æ•°é‡ã€‚
- Min Screen Radius for Lights è®¾ç½®åº”ä»è§†å›¾å‰”é™¤ç…§æ˜çš„æœ€å°å±å¹•åŠå¾„ã€‚å€¼è¶Šå¤§ï¼Œè¶Šèƒ½æ›´å¿«é€Ÿå‰”é™¤ç…§æ˜æ¥æé«˜æ€§èƒ½ã€‚ä½†æ˜¯ï¼Œå¦‚æœä¸æ¸²æŸ“å¤§å‹é®æŒ¡ç‰©ï¼Œå€¼è¿‡å¤§å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚
- Min Screen Radius for Early Z Pass è®¾ç½®å¯¹è±¡å°†è¢«æ—©æœŸ Z é€šé“é®æŒ¡çš„æœ€å°å±å¹•åŠå¾„ã€‚å€¼è¶Šå¤§ï¼Œè¶Šèƒ½æ›´å¿«é€Ÿå‰”é™¤å¯¹è±¡æ¥æé«˜æ€§èƒ½ã€‚ä½†æ˜¯ï¼Œå¦‚æœä¸æ¸²æŸ“å¤§å‹é®æŒ¡ç‰©ï¼Œå€¼è¿‡å¤§å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚
- Min Screen Radius for Cascaded Shadow Maps è®¾ç½®è¦é’ˆå¯¹çº§è”é˜´å½±è´´å›¾æ·±åº¦é€šé“é®æŒ¡å¯¹è±¡çš„æœ€å°å±å¹•åŠå¾„ã€‚è¾ƒå¤§çš„å€¼å¯ä»¥æ”¹å–„æ€§èƒ½ã€‚ä½†æ˜¯ï¼Œå®ƒä»¬å¯èƒ½ä¼šç‘•ç–µï¼Œå› ä¸ºåœ¨é è¿‘æ‘„åƒæœºæ—¶å¯¹è±¡ä¼šåœæ­¢æŠ•å°„é˜´å½±ã€‚
- Warn about no precomputed visibility å½“å‰æ‘„åƒæœºä½ç½®æ²¡æœ‰å¯ç”¨çš„é¢„è®¡ç®—å¯è§†æ€§æ•°æ®æ—¶å¯ç”¨è­¦å‘Šã€‚å¦‚æœé¡¹ç›®ä¾èµ–äºé¢„è®¡ç®—å¯è§†æ€§è¿›è¡Œé®æŒ¡ï¼Œè¿™å¯èƒ½æ˜¯ååˆ†æœ‰ç”¨çš„æé†’ã€‚

å…³å¡æˆ–è“å›¾ä¸­çš„æ‰€é€‰ Actor åŒ…å«å¯é€šè¿‡å…¶ Details é¢æ¿è®¿é—®çš„è·ç¦»è®¾ç½®ã€‚å®ƒä»¬æ”¯æŒè®¾ç½®æŒ‰å®ä¾‹è·ç¦»ï¼Œæˆ–è€…æ˜¯å¦ä½¿ç”¨å‰”é™¤è·ç¦»ä½“ç§¯æ¥å‰”é™¤ Actorã€‚

åœ¨ World Settings -> Precomputed Visibility è®¿é—®ç”¨æ¥æ›´æ”¹é¢„è®¡ç®—å¯è§†æ€§ç”Ÿæˆæ–¹å¼çš„è®¾ç½®ï¼š

- Precomputed Visibility æ˜¯å¦åœ¨é¢„è®¡ç®—å¯è§†æ€§ä½“ç§¯å†…ä»¥åŠæ²¿ç€è¯¥å…³å¡çš„æ‘„åƒæœºè½¨é“æ”¾ç½®å¯è§†æ€§å•å…ƒæ ¼ã€‚é¢„è®¡ç®—å¯è§†æ€§èƒ½å¤Ÿç¼©çŸ­æ¸²æŸ“çº¿ç¨‹æ—¶é—´ï¼Œä½†ä»£ä»·æ˜¯å ç”¨è¿è¡Œæ—¶å†…å­˜å’Œå»¶é•¿ç…§æ˜æ„å»ºæ—¶é—´ã€‚
- Place Cells Only Along Camera Tracks å¯ç”¨æ—¶ï¼Œä»…æ²¿ç€æ‘„åƒæœºè½¨é“æ”¾ç½®å¯è§†æ€§å•å…ƒæ ¼ã€‚
- Visibility Cells ç”¨ x å’Œ y è¡¨ç¤ºçš„é¢„è®¡ç®—å¯è§†æ€§å•å…ƒæ ¼çš„åœºæ™¯ç©ºé—´å¤§å°ã€‚å¤§å°è¶Šå°ï¼Œé®æŒ¡å‰”é™¤æ•ˆç‡è¶Šé«˜ï¼Œä»£ä»·æ˜¯è¿è¡Œæ—¶å†…å­˜å ç”¨é‡å’Œç…§æ˜æ„å»ºæ—¶é—´éƒ½ä¼šå¢åŠ ã€‚
- Visibility Aggressiveness è®¾ç½®å¯è§†æ€§å¼ºåº¦è¶Šå¤§ï¼Œå‰”é™¤çš„å¯¹è±¡è¶Šå¤šï¼Œä½†ä¹Ÿä¼šå¯¼è‡´æ›´å¤šçš„å¯è§†æ€§é”™è¯¯ï¼Œä¾‹å¦‚å¼¹å‡ºã€‚


é¢„è®¡ç®—å¯è§†æ€§è¦†ç›–ä½“ç§¯ Precomputed Visibility Override Volumes ä½¿ä½ èƒ½å¤Ÿè¦†ç›–ç°æœ‰é¢„è®¡ç®—å¯è§†æ€§ä½“ç§¯å†…çš„ Actor å’Œå…³å¡çš„å¯è§†æ€§æ§åˆ¶ã€‚

- Override Visible Actors ä»è¯¥ä½“ç§¯å†…éƒ¨æŸ¥çœ‹æ—¶ï¼Œé¢„è®¡ç®—å¯è§†æ€§å§‹ç»ˆè§†ä¸ºå¯è§çš„Actoræ•°ç»„ã€‚
- Override Invisible Actors ä»è¯¥ä½“ç§¯å†…éƒ¨æŸ¥çœ‹æ—¶ï¼Œé¢„è®¡ç®—å¯è§†æ€§å§‹ç»ˆè§†ä¸ºä¸å¯è§çš„Actoræ•°ç»„ã€‚
- Override Invisible Levels ä»è¯¥ä½“ç§¯å†…éƒ¨æŸ¥çœ‹æ—¶ï¼Œé¢„è®¡ç®—å¯è§†æ€§å§‹ç»ˆè§†ä¸ºä¸å¯è§çš„Actoræ‰€å±çš„å…³å¡åç§°æ•°ç»„ã€‚


åƒå…¶ä»–å‰”é™¤æ–¹æ³•ä¸€æ ·ï¼Œé¢„è®¡ç®—å¯è§†æ€§ä½“ç§¯ ç”¨äºå®ç°ä¸­å°å‹åœºæ™¯çš„æ€§èƒ½ä¼˜åŒ–ï¼Œé€šå¸¸ç”¨äºå› ä¸ºç¡¬ä»¶é—®é¢˜è€Œä½¿åŠ¨æ€é®æŒ¡å‰”é™¤å—åˆ°é™åˆ¶çš„ç§»åŠ¨å¹³å°ã€‚é¢„è®¡ç®—å¯è§†æ€§ä½“ç§¯æ ¹æ®ç©å®¶æˆ–æ‘„åƒæœºçš„ä½ç½®ï¼Œå°† Actor ä½ç½®çš„å¯è§†æ€§çŠ¶æ€å­˜å‚¨åœ¨åœºæ™¯ä¸­ã€‚å› æ­¤ï¼Œé¢„è®¡ç®—å¯è§†æ€§å¯¹äºä¸»è¦ä¸ºé™æ€ç‚¹äº®çš„ç¯å¢ƒçš„é¡¹ç›®ã€ç©å®¶è¿åŠ¨å—é™å’ŒæŸäº›2Dæ¸¸æˆåŒºåŸŸæœ€æœ‰ç”¨ã€‚

åœ¨ç…§æ˜æ„å»ºæœŸé—´ï¼Œä¼šåœ¨é˜´å½±æŠ•å°„å‡ ä½•ä½“ä¸Šæ–¹ç”Ÿæˆå¯è§†æ€§å•å…ƒæ ¼ã€‚Actor å¯è§†æ€§ä»æ¯ä¸ªå•å…ƒæ ¼ä½ç½®å­˜å‚¨ã€‚ç”±äºé¢„è®¡ç®—å¯è§†æ€§æ˜¯åœ¨çº¿ä¸‹ç”Ÿæˆçš„ï¼Œå› æ­¤ä½ çœå»çš„æ˜¯é€šå¸¸ç”¨äºç¡¬ä»¶é®æŒ¡æŸ¥è¯¢çš„æ¸²æŸ“çº¿ç¨‹æ—¶é—´ï¼Œä½†ä»£ä»·æ˜¯ä¼šå¢åŠ è¿è¡Œæ—¶å†…å­˜å’Œç…§æ˜æ„å»ºæ—¶é—´ã€‚åŸºäºè¿™ä¸€ç‚¹ï¼Œå»ºè®®ä»…åœ¨ç©å®¶æˆ–æ‘„åƒæœºå¯è®¿é—®åŒºåŸŸæ”¾ç½®ä½“ç§¯æ¥ä¿æŒå¯è§†æ€§å‰”é™¤ã€‚ 

é¢„è®¡ç®—å¯è§†æ€§å…·æœ‰ä»¥ä¸‹é™åˆ¶ï¼š

- ä¸å¤„ç†å¯ç§»åŠ¨Actorã€‚
- ä¸å¤„ç†é€å…‰æè´¨ï¼Œå¦‚åŠé€æ˜æˆ–é®ç½©æè´¨ã€‚
- å•å…ƒæ ¼ä»…æ”¾ç½®åœ¨è¡¨é¢ä¸Šæ–¹ã€‚å¯¹å¯ç”¨é£è¡Œæ¨¡å¼çš„é¡¹ç›®ç›Šå¤„ä¸å¤§ã€‚
- ä¸èƒ½æœ‰æ•ˆå¤„ç†æµé€å…³å¡ã€‚æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨æŒä¹…å…³å¡ã€‚
- åªæœ‰é™æ€é˜´å½±æŠ•å°„ä¸‰è§’å½¢ä¼šå‘ç”Ÿé®æŒ¡ã€‚

ä¸ºå…³å¡å¯ç”¨é¢„è®¡ç®—å¯è§†æ€§ï¼šWorld Settings -> Precomputed Visibility -> Precomputed Visibility å‹¾é€‰æ—è¾¹çš„å¤é€‰æ¡†ã€‚

åœ¨é¢„è®¡ç®—å¯è§†æ€§å‘æŒ¥ä½œç”¨å‰ï¼Œéœ€è¦å…ˆæ„å»ºç…§æ˜ï¼Œå¹¶åœ¨å…³å¡è§†å£å¯ç”¨é¢„è®¡ç®—å¯è§†æ€§å•å…ƒæ ¼ï¼šViewport -> Show -> Advanced -> Precomputed Visibilityã€‚

ä¸ºå…³å¡æ„å»ºè‡³å°‘ä¸€æ¬¡ç…§æ˜ä¿¡æ¯åï¼Œå¯ä»¥æ”¾ç½®ä»»æ„æ•°é‡çš„é¢„è®¡ç®—å¯è§†æ€§ä½“ç§¯ï¼Œç„¶åç”Ÿæˆå¯è§†æ€§å•å…ƒæ ¼æ¥å¡«å……ä»»ä½•é™æ€é˜´å½±æŠ•å°„ Actor çš„è¡¨é¢ã€‚å¦‚æœä½ å·²ç»æ„å»ºäº†ç…§æ˜ï¼Œå¯ä»¥ä½¿ç”¨ä¸»å·¥å…·æ ä¸­çš„ Build -> Precompute Static Visibility æ¥ç”Ÿæˆé™æ€å¯è§†æ€§å•å…ƒæ ¼ï¼Œè€Œä¸å¿…æ¯æ¬¡é‡æ–°æ„å»ºç…§æ˜ã€‚

# ğŸŒŸ Materials
- æè´¨ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/Materials/
- ç»´åº¦ï¼šæ•°å­¦æ¼«æ­¥ Dimensions: a walk through mathematics https://www.bilibili.com/video/BV1zg41177Dk?p=5

æè´¨ æ˜¯å¯ä»¥åº”ç”¨åˆ°ç½‘æ ¼ç‰©ä½“ä¸Šçš„èµ„æºï¼Œç”¨å®ƒå¯æ§åˆ¶åœºæ™¯çš„å¯è§†å¤–è§‚ã€‚ä»è¾ƒé«˜çš„å±‚é¢ä¸Šæ¥è¯´ï¼Œå¯èƒ½æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯æŠŠæè´¨è§†ä¸ºåº”ç”¨åˆ°ä¸€ä¸ªç‰©ä½“çš„"æç”»"ã€‚ä½†è¿™ç§è¯´æ³•ä¹Ÿä¼šäº§ç”Ÿä¸€ç‚¹ç‚¹è¯¯å¯¼ï¼Œå› ä¸ºæè´¨å®é™…ä¸Šå®šä¹‰äº†ç»„æˆè¯¥ç‰©ä½“æ‰€ç”¨çš„è¡¨é¢ç±»å‹ã€‚æ‚¨å¯ä»¥å®šä¹‰å®ƒçš„é¢œè‰²ã€å®ƒçš„å…‰æ³½åº¦åŠæ‚¨æ˜¯å¦èƒ½çœ‹ç©¿è¯¥ç‰©ä½“ç­‰ç­‰ã€‚

ç”¨æ›´ä¸ºä¸“ä¸šçš„æœ¯è¯­æ¥è¯´ï¼Œå½“ç©¿è¿‡åœºæ™¯çš„å…‰ç…§æ¥è§¦åˆ°è¡¨é¢åï¼Œæè´¨è¢«ç”¨æ¥è®¡ç®—è¯¥å…‰ç…§å¦‚ä½•ä¸è¯¥è¡¨é¢è¿›è¡Œäº’åŠ¨ã€‚è¿™äº›è®¡ç®—æ˜¯é€šè¿‡å¯¹æè´¨çš„è¾“å…¥æ•°æ®æ¥å®Œæˆçš„ï¼Œè€Œè¿™äº›è¾“å…¥æ•°æ®æ¥è‡ªäºä¸€ç³»åˆ—å›¾åƒï¼ˆè´´å›¾ï¼‰ä»¥åŠæ•°å­¦è¡¨è¾¾å¼ï¼Œä»¥åŠæè´¨æœ¬èº«æ‰€ç»§æ‰¿çš„ä¸åŒå±æ€§è®¾ç½®ã€‚

æè´¨æ˜¯è®©æ‚¨çš„å¯¹è±¡å’Œå…³å¡å…·æœ‰æ‚¨æƒ³è¦çš„å¤–è§‚çš„å…³é”®å› ç´ ä¹‹ä¸€ã€‚

å…³äºæè´¨ï¼Œæ‚¨éœ€è¦çŸ¥é“çš„ç¬¬ä¸€ä»¶ä¹Ÿæ˜¯æœ€é‡è¦çš„äº‹æƒ…å°±æ˜¯ï¼Œå®ƒä»¬å¹¶éé€šè¿‡ä»£ç ï¼Œè€Œæ˜¯é€šè¿‡æè´¨ç¼–è¾‘å™¨ä¸­çš„å¯è§†åŒ–è„šæœ¬èŠ‚ç‚¹ï¼ˆç§°ä¸ºæè´¨è¡¨è¾¾å¼ï¼‰æ‰€ç»„æˆçš„ç½‘ç»œæ¥æ„å»ºã€‚æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½åŒ…å« HLSL ä»£ç  ç‰‡æ®µï¼Œå¹¶ç”¨äºæ‰§è¡Œç‰¹å®šçš„ä»»åŠ¡ã€‚è¿™æ„å‘³ç€å½“æ‚¨æ„å»ºæè´¨æ—¶ï¼Œæ‚¨æ˜¯åœ¨é€šè¿‡å¯è§†åŒ–è„šæœ¬ç¼–ç¨‹æ¥åˆ›å»º HLSL ä»£ç ã€‚

å…³äºæè´¨ï¼Œæ‚¨éœ€è¦çŸ¥é“çš„ç¬¬ä¸€ä»¶ä¹Ÿæ˜¯æœ€é‡è¦çš„äº‹æƒ…å°±æ˜¯ï¼Œå®ƒä»¬å¹¶éé€šè¿‡ä»£ç ï¼Œè€Œæ˜¯é€šè¿‡æè´¨ç¼–è¾‘å™¨ä¸­çš„å¯è§†åŒ–è„šæœ¬èŠ‚ç‚¹ï¼ˆç§°ä¸ºæè´¨è¡¨è¾¾å¼ï¼‰æ‰€ç»„æˆçš„ç½‘ç»œæ¥æ„å»ºã€‚æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½åŒ…å« HLSL ä»£ç  ç‰‡æ®µï¼Œå¹¶ç”¨äºæ‰§è¡Œç‰¹å®šçš„ä»»åŠ¡ã€‚è¿™æ„å‘³ç€å½“æ‚¨æ„å»ºæè´¨æ—¶ï¼Œæ‚¨æ˜¯åœ¨é€šè¿‡å¯è§†åŒ–è„šæœ¬ç¼–ç¨‹æ¥åˆ›å»º HLSL ä»£ç ã€‚

æè´¨ä½¿ç”¨ RGBA æµ®ç‚¹å€¼æ¥å‚¨å­˜é¢œè‰²ä¿¡æ¯ï¼Œæ„å‘³ç€æ¯ä¸ªé€šé“çš„å€¼èŒƒå›´éƒ½æ˜¯ 0.0 åˆ° 1.0ï¼Œè€Œä¸åƒæ˜¯æŸäº›å›¾åƒç¼–è¾‘åº”ç”¨ç¨‹åºé‚£æ ·ä½¿ç”¨ 0 åˆ° 255ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ‚¨åœ¨ä»»ä½•æ—¶å€™éƒ½å¯ä»¥ä½¿ç”¨è¶…è¿‡æ­¤èŒƒå›´çš„å€¼ï¼Œè¿™åœ¨æŸäº›æƒ…å†µä¸‹ä¼šäº§ç”Ÿç‰¹æ®Šçš„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå°†é¢œè‰²å‘é€åˆ°æè´¨çš„"è‡ªå‘å…‰"ï¼ˆEmissiveï¼‰è¾“å…¥æ—¶ï¼ˆè¿™å°†ä½¿æè´¨å‘å…‰ï¼‰ï¼Œå¤§äº 1.0 çš„å€¼ä¼šå¢åŠ å‘å…‰å¼ºåº¦ã€‚

æ‰§è¡Œå•é€šé“æ“ä½œçš„èŠ‚ç‚¹ä¸€èˆ¬éœ€è¦å…·æœ‰ç›¸åŒé€šé“æ•°ç›®çš„è¾“å…¥ï¼Œå¦åˆ™ä¼šäº§ç”Ÿé”™è¯¯ï¼Œå¹¶å¯¼è‡´æè´¨æ— æ³•ç¼–è¯‘ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥å°†ä¸€ä¸ª RGB é¢œè‰²ä¸å¦ä¸€ä¸ª RGB é¢œè‰²ç›¸ åŠ ï¼ˆAddï¼‰ã€‚æ­¤è§„åˆ™æœ‰ä¸€ä¸ªä¾‹å¤–æƒ…å†µï¼Œå³ï¼Œå…¶ä¸­ä¸€ä¸ªè¾“å…¥æ˜¯å•é€šé“ï¼ˆæ ‡é‡ï¼‰å€¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯¥æ ‡é‡çš„å€¼å°†ç›´æ¥åº”ç”¨äºæ‰€æœ‰å…¶ä»–é€šé“ã€‚æ¯”å¦‚ï¼Œå°† RGB (0.35, 0.28, 0.77) ä¸æ ‡é‡å€¼ 1.0 ç›¸åŠ ï¼Œå¾—åˆ° RGB (1.35, 1.28, 1.77)ã€‚

å¯¹äºæè´¨ï¼Œçº¹ç† `Texture` åªæ˜¯ç”¨äºæä¾›æŸç§åŸºäºåƒç´ çš„æ•°æ®çš„å›¾åƒã€‚è¿™äº›æ•°æ®å¯èƒ½æ˜¯å¯¹è±¡çš„é¢œè‰²ã€å…‰æ³½åº¦ã€é€æ˜åº¦ä»¥åŠå„ç§å…¶ä»–æ–¹é¢ã€‚æœ‰ä¸€ç§è¿‡æ—¶çš„æƒ³æ³•ï¼Œè®¤ä¸º"æ·»åŠ çº¹ç†"æ˜¯ç»™æ¸¸æˆæ¨¡å‹ä¸Šè‰²çš„è¿‡ç¨‹ã€‚è™½ç„¶åˆ›å»ºçº¹ç†çš„è¿‡ç¨‹ä»ç„¶å¾ˆå…³é”®ï¼Œä½†æˆ‘ä»¬åº”è¯¥å°†çº¹ç†çœ‹ä½œæè´¨çš„"å…ƒä»¶"ï¼Œè€Œä¸æ˜¯å°†å®ƒä»¬æœ¬èº«è§†ä¸ºæœ€ç»ˆæˆå“ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚

ä¸€ä¸ªå•ä¸€æè´¨æœ‰å¯èƒ½ç”¨åˆ°å‡ ä¸ªä¸åŒçš„çº¹ç†è´´å›¾ä½œä¸ºä¸åŒçš„ç›®çš„æ•ˆæœã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªç®€å•çš„æè´¨å¯èƒ½ä¼šæœ‰ä¸€ä¸ªåŸºç¡€é¢œè‰²`Base Color`çš„çº¹ç†è´´å›¾ï¼Œä¸€ä¸ªé«˜å…‰`Specular`ï¼Œä¸€ä¸ªæ³•çº¿è´´å›¾`Normal Map`ã€‚é™¤æ­¤ä»¥å¤–ï¼Œè¿˜æœ‰å¯èƒ½æœ‰ä¿å­˜åœ¨é€æ˜é€šé“ä¸­çš„è‡ªå‘å…‰`Emisive Color`è´´å›¾ä»¥åŠç²—é€ åº¦è´´å›¾`Roughness`ã€‚

å¯ä»¥å‘ç°ï¼Œè™½ç„¶è¿™äº›å¯èƒ½éƒ½åŒæ—¶å­˜åœ¨äºä¸€ä¸ªè´´å›¾çš„å¸ƒå±€ä¸­ï¼Œä½†çº¹ç†è´´å›¾ä¸­çš„ä¸åŒçš„é¢œè‰²è¢«ç”¨äºä¸åŒçš„ç›®çš„ã€‚

çº¹ç†ä¸€æ—¦åˆ›å»ºå¹¶å¯¼å…¥è™šå¹»å¼•æ“ï¼Œå°±ä¼šé€šè¿‡ç‰¹æ®Šçš„æè´¨è¡¨è¾¾å¼èŠ‚ç‚¹å¼•å…¥åˆ°æè´¨ä¸­ï¼Œä¾‹å¦‚çº¹ç†å–æ ·ï¼ˆ`Texture Sample`ï¼‰èŠ‚ç‚¹ã€‚

å¯¹ç½‘æ ¼ç½‘æ ¼ä½“ï¼ˆé™æ€ã€åŠ¨æ€æˆ–éª¨éª¼ï¼‰åº”ç”¨æè´¨æœ‰è®¸å¤šç§ä¸åŒæ–¹æ³•ã€‚å¯ä»¥ç›´æ¥ä½¿ç”¨ç½‘æ ¼å±æ€§ä¸­çš„æè´¨å…ƒç´ æ§½ã€‚åœ¨å…³å¡ä¸­é€‰ä¸­ç½‘æ ¼æ—¶ï¼Œæ‚¨å¯ä»¥åœ¨ ç»†èŠ‚ï¼ˆDetailsï¼‰é¢æ¿ä¸­æ‰¾åˆ°è¿™äº›æ§½ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å³é”®å•å‡»ç½‘æ ¼å¹¶ä»å¿«æ·èœå•ï¼ˆPropertiesï¼‰æ‰¾åˆ°è¿™äº›æ§½ã€‚ä¹Ÿå¯ä»¥åœ¨å„ç§ç¼–è¾‘å™¨ï¼ˆä¾‹å¦‚é™æ€ç½‘æ ¼ç¼–è¾‘å™¨æˆ–è€…äººç‰©éª¨éª¼ç½‘æ ¼ç¼–è¾‘å™¨ï¼‰ä¸­æ‰¾åˆ°è¿™äº›æ§½ã€‚

å°†æè´¨åº”ç”¨äº Brush è¡¨é¢ï¼š

- åœ¨å†…å®¹æµè§ˆå™¨ä¸­é€‰ä¸­ä¸€ä¸ªæè´¨ã€‚
- å•å‡»è¦å°†è¯¥æè´¨æŒ‡æ´¾åˆ°çš„ Brush è¡¨é¢ã€‚
- åœ¨ Details é¢æ¿ä¸­ï¼Œå•å‡»å‘å³ç®­å¤´æŒ‰é’®å°±ä¼šå°†è¯¥æè´¨åº”ç”¨äºåˆ·è¡¨é¢ã€‚

ä»£ç è§†å›¾é¢æ¿æ˜¾ç¤ºäº†ç”±å½“å‰æè´¨ç”Ÿæˆçš„é«˜çº§ç€è‰²å™¨è¯­è¨€ï¼ˆHigh Level Shader Languageï¼‰ ï¼ˆHLSLï¼‰ä»£ç ã€‚æ³¨æ„è¿™å¹¶éç¼–è¾‘å™¨ï¼›ä½¿ç”¨è€…æ— æ³•ä¿®æ”¹ HLSL ä»£ç ã€‚è¿™åªæ˜¯ä¸€ä¸ªæŸ¥çœ‹å™¨ï¼Œå…è®¸ä½¿ç”¨è€…æ˜¾ç¤ºç”±æè´¨ç½‘ç»œå®šä¹‰çš„ä»£ç ã€‚

ä»£ç è§†å›¾é¢æ¿é»˜è®¤ä¸å¯è§ï¼Œé€šè¿‡ Window -> Shader Code -> HLSL Code æ˜¾ç¤ºä»£ç è§†å›¾é¢æ¿ã€‚

ç€è‰²å™¨ä»£ç èœå•ä¸‹ï¼Œå¯ä»¥åˆ‡æ¢æ˜¾ç¤ºæ‰€é€‰å¹³å°çš„æè´¨ HLSL ä»£ç ï¼š

- Desktop - åˆ‡æ¢æ˜¾ç¤ºå„ç§æ¡Œé¢æ¸²æŸ“çš„ HLSL ä»£ç ã€‚
    - DirectX SM5 - åˆ‡æ¢æ˜¾ç¤º Windows SM5 çš„ HLSL ä»£ç ã€‚
    - DirectX SM4 - åˆ‡æ¢æ˜¾ç¤º Windows SM4 çš„ HLSL ä»£ç ã€‚
    - Vulkan SM5 - åˆ‡æ¢æ˜¾ç¤º Vulkan SM5 çš„ HLSL ä»£ç ã€‚
    - Vulkan SM4 - åˆ‡æ¢æ˜¾ç¤º Vulkan SM4 çš„ HLSL ä»£ç ã€‚
    - OpenGL SM5 - åˆ‡æ¢æ˜¾ç¤º OpenGL SM5 çš„ HLSL ä»£ç ã€‚
    - OpenGL SM4 - åˆ‡æ¢æ˜¾ç¤º OpenGL SM4 çš„ HLSL ä»£ç ã€‚
- Android - åˆ‡æ¢æ˜¾ç¤ºå„ç§ Android æ¸²æŸ“çš„ HLSL ä»£ç ã€‚
    - Android GLES 3.1 - åˆ‡æ¢æ˜¾ç¤º Android GLES 3.1 çš„ HLSL ä»£ç ã€‚
    - Android GLES 2.0 - åˆ‡æ¢æ˜¾ç¤º Android GLES 2.0 çš„ HLSL ä»£ç ã€‚
    - Android Vulkan - åˆ‡æ¢æ˜¾ç¤º Android Vulkan çš„ HLSL ä»£ç ã€‚
- iOS - åˆ‡æ¢æ˜¾ç¤ºå„ç§ iOS æ¸²æŸ“çš„ HLSL ä»£ç ã€‚
    - Metal SM5 - åˆ‡æ¢æ˜¾ç¤º Metal SM5 çš„ HLSL ä»£ç ã€‚


### âœ’ Materials æè´¨åŸºç¡€
- UE4 æè´¨å…¥é—¨ https://www.bilibili.com/video/BV1GJ411j7d4?p=10
- æè´¨è¾“å…¥ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/Materials/MaterialInputs/
- æè´¨æ··åˆæ¨¡å¼ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/Materials/MaterialProperties/BlendModes/
- ç€è‰²æ¨¡å‹ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/Materials/MaterialProperties/LightingModels/
- æè´¨è¡¨è¾¾å¼å‚è€ƒ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/Materials/ExpressionReference/
- æè´¨å‡½æ•°å‚è€ƒ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/Materials/Functions/
- Landscape Materials https://docs.unrealengine.com/4.27/zh-CN/BuildingWorlds/Landscape/Materials/
- Mesh Paint & VertexColor https://docs.unrealengine.com/4.27/zh-CN/BuildingWorlds/LevelEditor/Modes/MeshPaintMode/VertexColor
- Render Targets https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/RenderTargets/BlueprintRenderTargets/
- åæœŸå¤„ç†æè´¨ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/PostProcessEffects/PostProcessMaterials/

ä»¥ä¸‹æ˜¯æè´¨ç¼–è¾‘å™¨ä¸­ä¸»æè´¨ï¼ˆMain Materialï¼‰çš„è¾“å…¥ç«¯å£ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰æè´¨è¾“å…¥éƒ½å¯¹ä½ åˆ›å»ºçš„æ¯ç§ç±»å‹æè´¨éƒ½æœ‰ç”¨ï¼š

- åº•è‰²ï¼ˆ`Base Color`ï¼‰ å®šä¹‰æè´¨çš„æ•´ä½“é¢œè‰²ã€‚å®ƒæ¥æ”¶ Vector3 (RGB) å€¼ï¼Œå¹¶ä¸”æ¯ä¸ªé€šé“éƒ½è‡ªåŠ¨é™åˆ¶åœ¨ 0 ä¸ 1 ä¹‹é—´ã€‚
- é‡‘å±è‰²ï¼ˆ`Metallic`ï¼‰è¾“å…¥æ§åˆ¶è¡¨é¢åœ¨å¤šå¤§ç¨‹åº¦ä¸Š"åƒé‡‘å±"ã€‚éé‡‘å±çš„é‡‘å±è‰²ï¼ˆMetallicï¼‰å€¼ä¸º 0ï¼Œ é‡‘å±çš„é‡‘å±è‰²ï¼ˆMetallicï¼‰å€¼ä¸º 1ã€‚å¯¹äºçº¯è¡¨é¢ï¼Œä¾‹å¦‚çº¯é‡‘å±ã€çº¯çŸ³å¤´ã€ çº¯å¡‘æ–™ç­‰ç­‰ï¼Œæ­¤å€¼å°†æ˜¯ 0 æˆ– 1ï¼Œè€Œä¸æ˜¯ä»»ä½•ä»‹äºå®ƒä»¬ä¹‹é—´çš„å€¼ã€‚åˆ›å»ºå—è…èš€ã€è½æ»¡ç°å°˜æˆ–ç”Ÿé”ˆé‡‘å±ä¹‹ç±»çš„æ··åˆè¡¨é¢æ—¶ï¼Œ æ‚¨å¯èƒ½ä¼šå‘ç°éœ€è¦ ä»‹äº 0 ä¸ 1 ä¹‹é—´çš„å€¼ã€‚
- éé‡‘å±è¡¨é¢æè´¨ä½¿ç”¨`Specular`é«˜å…‰è¾“å…¥è°ƒæ•´å®ƒåå°„å…‰çº¿çš„èƒ½åŠ›ã€‚ è¦æ›´æ–°æè´¨çš„é«˜å…‰åº¦ï¼Œéœ€è¾“å…¥ä»‹äº 0ï¼ˆæ— åå°„ï¼‰å’Œ 1ï¼ˆå…¨åå°„ï¼‰ä¹‹é—´çš„æ ‡é‡æ•°å€¼ï¼Œé»˜è®¤é«˜å…‰å€¼ä¸º 0.5ã€‚
- ç²—ç³™åº¦ï¼ˆ`Roughness`ï¼‰è¾“å…¥æ§åˆ¶æè´¨è¡¨é¢çš„ç²—ç³™æˆ–å¹³æ»‘ç¨‹åº¦ã€‚ä¸å¹³æ»‘çš„æè´¨ç›¸æ¯”ï¼Œç²—ç³™çš„æè´¨å°†å‘æ›´å¤šæ–¹å‘æ•£å°„æ‰€åå°„çš„å…‰çº¿ã€‚ è¿™å†³å®šäº†åå°„çš„æ¨¡ç³Šæˆ–æ¸…æ™°åº¦ï¼ˆæˆ–è€…é•œé¢åå°„é«˜å…‰çš„å¹¿åº¦æˆ–å¯†é›†åº¦ï¼‰ã€‚ ç²—ç³™åº¦ 0ï¼ˆå¹³æ»‘ï¼‰æ˜¯é•œé¢åå°„ï¼Œè€Œç²—ç³™åº¦ 1ï¼ˆç²—ç³™ï¼‰æ˜¯æ¼«å°„ï¼ˆæˆ–æ— å…‰ï¼‰è¡¨é¢ã€‚
- å¯ä»¥åˆ©ç”¨ å„å‘å¼‚æ€§ï¼ˆ`Anisotropy`ï¼‰ å’Œ åˆ‡çº¿ï¼ˆ`Tangent`ï¼‰ è¾“å…¥æ§åˆ¶æè´¨ç²—ç³™åº¦çš„å„å‘å¼‚æ€§å’Œå…‰æºæ–¹å‘æ€§ã€‚å¦‚æœæè´¨è¦å±•ç°ç±»ä¼¼æ‹‰ä¸é‡‘å±çš„å„å‘å¼‚æ€§æ•ˆæœï¼Œè¿™ä¸¤é¡¹è¾“å…¥è‡³å…³é‡è¦ã€‚
- ç”±äºæè´¨åœ¨å‘å…‰ï¼Œæ‰€ä»¥è‡ªå‘å…‰é¢œè‰²ï¼ˆ`Emissive Color`ï¼‰ è¾“å…¥å°†æ§åˆ¶æè´¨çš„å“ªäº›éƒ¨åˆ†ä¼šå‘å…‰ã€‚ç†æƒ³æƒ…å†µä¸‹è¿™å°†è·å¾—ä¸€ä¸ªé®ç½©çº¹ç†ï¼ˆé™¤äº†éœ€è¦å‘å…‰çš„åŒºåŸŸä¹‹å¤–ï¼Œå¤§éƒ¨åˆ†å‘ˆé»‘è‰²ï¼‰ã€‚
- ä½¿ç”¨åŠé€æ˜æ··åˆæ¨¡å¼æ—¶ï¼Œä¼šç”¨åˆ°ä¸é€æ˜åº¦ï¼ˆ`Opacity`ï¼‰ï¼Œé€šå¸¸é€‚ç”¨äºåŠé€æ˜ï¼ˆTranslucentï¼‰ã€æ·»åŠ ï¼ˆAdditiveï¼‰å’Œè°ƒåˆ¶ï¼ˆModulatedï¼‰æè´¨ã€‚å¯ä»¥è¾“å…¥ 0 å®Œå…¨é€æ˜ï¼Œä¸ 1 å®Œå…¨ä¸é€æ˜ï¼Œæˆ–ä¹‹é—´çš„å€¼ã€‚
- ä¸é€æ˜é®ç½©ï¼ˆ`Opacity Mask`ï¼‰ ç±»ä¼¼äºä¸é€æ˜åº¦ï¼ˆOpacityï¼‰ï¼Œä½†ä»…åœ¨ä½¿ç”¨é®ç½©ï¼ˆMaskedï¼‰æ··åˆæ¨¡å¼æ—¶å¯ç”¨ã€‚ä¸ä¸é€æ˜åº¦ï¼ˆOpacityï¼‰ä¸€æ ·ï¼Œå®ƒçš„å€¼åœ¨0.0åˆ°1.0ä¹‹é—´ï¼Œä½†ä¸ä¸é€æ˜åº¦ï¼ˆOpacityï¼‰ ä¸åŒ çš„æ˜¯ï¼Œç»“æœä¸­çœ‹ä¸åˆ°ä¸åŒæ·±æµ…çš„ç°è‰²ã€‚ åœ¨é®ç½©æ¨¡å¼ä¸‹æ—¶ï¼Œæè´¨è¦ä¹ˆå®Œå…¨å¯è§ï¼Œè¦ä¹ˆå®Œå…¨ä¸å¯è§ã€‚å½“ä½ éœ€è¦å¯ä»¥å®šä¹‰å¤æ‚å®å¿ƒè¡¨é¢ï¼ˆå¦‚é“ä¸ç½‘ã€é“¾ç¯å›´æ ç­‰ç­‰ï¼‰çš„æè´¨æ—¶ï¼Œå®ƒå°†æˆä¸ºä¸€ç§ç†æƒ³çš„è§£å†³æ–¹æ¡ˆã€‚ä¸é€æ˜éƒ¨åˆ†ä»å°†éµå¾ªå…‰ç…§ã€‚ä½ å¯ä»¥ä½¿ç”¨åŸºç¡€æè´¨èŠ‚ç‚¹ä¸Šçš„ ä¸é€æ˜åº¦é®ç½©å‰ªåˆ‡å€¼ï¼ˆ`Opacity Mask Clip Value`ï¼‰ å±æ€§æ¥æ§åˆ¶å‰ªåˆ‡å‘ç”Ÿç‚¹ã€‚
- æ³•çº¿ï¼ˆ`Normal`ï¼‰ è¾“å…¥æ¥æ”¶æ³•çº¿è´´å›¾ï¼Œåè€…å°†æ‰“ä¹±æ¯ä¸ªå•ç‹¬åƒç´ çš„æ³•çº¿æˆ–æœå‘æ–¹å‘ï¼Œä¸ºè¡¨é¢æä¾›é‡è¦çš„ç‰©ç†ç»†èŠ‚ã€‚æ³•çº¿æ˜¯è®¡ç®—å…‰çº¿çš„é‡è¦å‚æ•°ï¼Œå…¥å°„è§’ä¸æ³•çº¿çš„è§’åº¦ç­‰åå°„è§’ï¼ŒæŠ˜å°„è§’åˆ™è¿˜ä¸ææ–™çš„æŠ˜å°„ç‡ç›¸å…³ã€‚
- ä¸–ç•Œä½ç½®åç§»ï¼ˆ`World Position Offset`ï¼‰ è¾“å…¥å…è®¸ç½‘æ ¼ä½“çš„é¡¶ç‚¹åœ¨ä¸–ç•Œç©ºé—´ä¸­ç”±æè´¨æ“çºµã€‚è¿™æœ‰åŠ©äºå®ç°ä½¿å¯¹è±¡ç§»åŠ¨ã€æ”¹å˜å½¢çŠ¶ã€æ—‹è½¬å’Œå„ç§å…¶ä»–æ•ˆæœã€‚è¿™é€‚ç”¨äºç¯å¢ƒåŠ¨ç”»ä¹‹ç±»çš„å†…å®¹ã€‚
- ä¸–ç•Œä½ç§»ï¼ˆ`World Displacement`ï¼‰ çš„å·¥ä½œæ–¹å¼ä¸ä¸–ç•Œä½ç½®åç§»éå¸¸ç›¸ä¼¼ï¼Œä½†å®ƒä½¿ç”¨æ›²é¢ç»†åˆ†é¡¶ç‚¹ï¼Œè€Œéç½‘æ ¼ä½“çš„åŸºç¡€é¡¶ç‚¹ã€‚æè´¨ä¸Šçš„æ›²é¢ç»†åˆ†ï¼ˆTessellationï¼‰å±æ€§å¿…é¡»è®¾ä¸ºï¼ˆNoneï¼‰ä»¥å¤–çš„å€¼ã€‚
- æ›²é¢ç»†åˆ†ä¹˜æ•°ï¼ˆ`Tessellation Multiplier`ï¼‰æ§åˆ¶æ²¿è¡¨é¢çš„æ›²é¢ç»†åˆ†é‡ï¼Œèƒ½å¤Ÿåœ¨éœ€è¦çš„åœ°æ–¹æ·»åŠ æ›´å¤šç»†èŠ‚ã€‚æè´¨ä¸Šçš„æ›²é¢ç»†åˆ†ï¼ˆTessellationï¼‰å±æ€§å¿…é¡»è®¾ä¸ºï¼ˆNoneï¼‰ä»¥å¤–çš„å€¼ã€‚
- æ¬¡è¡¨é¢é¢œè‰²ï¼ˆ`Subsurface Color`ï¼‰åœ¨ï¼ˆ`Subsurface`ï¼‰ç€è‰²æ¨¡å‹ä¸‹å¯ç”¨ã€‚ è¾“å…¥ä¸€ç§é¢œè‰²æ·»æ¥æ¨¡æ‹Ÿå…‰é€šè¿‡è¡¨é¢ï¼Œåœ¨è¡¨å±‚æ·±å…¥éƒ¨ä½äº§ç”Ÿçš„æŠ˜å°„æ•ˆæœï¼Œä¾‹å¦‚å¯¹ç€å¤ªé˜³çœ‹äººç±»è§’è‰²çš„çš®è‚¤äº§ç”Ÿçš„çº¢è‰²æ¬¡è¡¨é¢é¢œè‰²ï¼Œæ¥æ¨¡æ‹Ÿå…¶è¡¨é¢ä¹‹ä¸‹çš„è¡€æ¶²ã€‚
- æŠ˜å°„ï¼ˆ`Refraction`ï¼‰è¾“å…¥æ¥å—ä¸€ä¸ªçº¹ç†æˆ–æ•°å€¼ï¼Œå…¶æ¨¡æ‹Ÿè¡¨é¢çš„æŠ˜å°„ç‡ã€‚å®ƒé€‚ç”¨äºç»ç’ƒå’Œæ°´è¿™æ ·çš„ç‰©è´¨ï¼Œå› ä¸ºå…‰ç©¿è¿‡è¿™äº›ç‰©è´¨æ—¶ä¼šå‘ç”ŸæŠ˜å°„ã€‚
- ç¯å¢ƒå…‰é®è”½ï¼ˆ`Ambient Occlusion`ï¼‰ è¾“å…¥ç”¨æ¥å¸®åŠ©æ¨¡æ‹Ÿåœ¨è¡¨é¢ç¼éš™ä¸­å‘ç”Ÿçš„è‡ªé˜´å½±æ•ˆæœã€‚ç¯å¢ƒå…‰é®è”½çº¹ç†è´´å›¾é€šå¸¸åœ¨ Mayaã€3ds Max æˆ– ZBrush ç­‰ä¸‰ç»´å»ºæ¨¡è½¯ä»¶æˆ– Photoshop è¿™ç±»ç…§ç‰‡ç¼–è¾‘è½¯ä»¶ä¸­åˆ›å»ºã€‚
- é€æ˜æ¶‚å±‚ï¼ˆ`Clear Coat`ï¼‰ ç€è‰²æ¨¡å‹å¯ä»¥ç”¨æ¥æ›´å¥½åœ°æ¨¡æ‹Ÿæè´¨è¡¨é¢æœ‰ä¸€å±‚åŠé€æ˜è–„è†œçš„å¤šå±‚æè´¨ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œé€æ˜æ¶‚å±‚ç€è‰²æ¨¡å‹ä¹Ÿå¯ä»¥ç”¨äºé‡‘å±æˆ–éé‡‘å±è¡¨é¢ã€‚

çœ¼ç›ç€è‰²æ¨¡å‹ï¼ˆEye Shading Modelï¼‰åœ¨ä¸»æè´¨èŠ‚ç‚¹ä¸Šå¢åŠ äº†ä¸¤ç§é¢å¤–è¾“å…¥ï¼š

- è™¹è†œé®ç½©ï¼ˆ`Iris Mask`ï¼‰ï¼šè¿™æœ‰åŠ©äºæ§åˆ¶è™¹è†œçš„æŠ˜å°„ç‡å’Œæ·±åº¦ã€‚åœ¨æ•°å­—äººç±»èŒƒä¾‹é¡¹ç›®çš„æè´¨ M_EyeRefractive ä¸­ï¼ŒæŸ¥çœ‹ã€‚
- è™¹è†œè·ç¦»ï¼ˆ`Iris Distance`ï¼‰ï¼šç”¨äºæ§åˆ¶æŠ˜å°„è™¹è†œçš„å‡¹åº¦ã€‚

åœ¨æ•°å­—äººç±»èŒƒä¾‹é¡¹ç›®çš„æè´¨ M_EyeRefractive ä¸­ï¼Œå¯ä»¥æŸ¥çœ‹ IOR å’Œæ·±åº¦èŒƒå›´ï¼ˆDepth Scaleï¼‰ï¼Œè™¹è†œå‡¹åº¦æ¯”ä¾‹ï¼ˆIris Concavity Scaleï¼‰å’Œè™¹è†œå‡¹åº¦å¹‚ï¼ˆIris Concavity Powerï¼‰ç­‰å‚æ•°ã€‚


å¸ƒæ–™ç€è‰²æ¨¡å‹ï¼ˆCloth Shading Modelï¼‰åœ¨ä¸»æè´¨èŠ‚ç‚¹ä¸Šå¼€è¾Ÿäº†ä¸¤ç§è¾“å…¥ï¼š

- ç»’æ¯›é¢œè‰²ï¼ˆ`Fuzz Color`ï¼‰ï¼šä½ å¯ä»¥é€šè¿‡æ­¤è¾“å…¥å°†é¢œè‰²æ·»åŠ åˆ°æè´¨ï¼Œä»¥æ¨¡æ‹Ÿå…‰é€šè¿‡è¡¨é¢æ—¶é¢œè‰²çš„å˜åŒ–ã€‚
- å¸ƒæ–™ï¼ˆ`Cloth`ï¼‰ï¼šå¯ä»¥é€šè¿‡æ­¤è¾“å…¥æ§åˆ¶ ç»’æ¯›é¢œè‰² ä½œä¸ºé®ç½©çš„å¼ºåº¦ã€‚å€¼ä¸º0è¡¨ç¤ºç»’æ¯›é¢œè‰²å¯¹åº•è‰²æ²¡æœ‰å½±å“ï¼Œå€¼ä¸º1åˆ™è¡¨ç¤ºå®Œå…¨æ··åˆåœ¨åº•è‰²ä¸Šã€‚


æ¯›å‘ç€è‰²æ¨¡å‹ï¼ˆ*Hair Shading Model*ï¼‰åœ¨ä¸»æè´¨èŠ‚ç‚¹ä¸Šå¼€è¾Ÿäº†ä¸‰ç§è¾“å…¥ï¼š

- æ•£å°„ï¼ˆ`Scatter`ï¼‰ï¼šæ­¤è¾“å…¥æ§åˆ¶å…è®¸ç©¿è¿‡æ¯›å‘çš„å…‰çº¿æ•£å°„é‡ã€‚
- åˆ‡çº¿ï¼ˆ`Tangent`ï¼‰ï¼šæ­¤è¾“å…¥å¯ä»£æ›¿ æ³•çº¿ï¼ˆNormalï¼‰ è¾“å…¥ï¼Œç”¨äºæ§åˆ¶æ²¿Uå’ŒVçº¹ç†åæ ‡çš„æ³•çº¿æ–¹å‘ã€‚
- èƒŒå…‰ï¼ˆ`Backlit`ï¼‰ï¼šæ­¤è¾“å…¥æ§åˆ¶å½±å“æ¯›å‘æè´¨çš„èƒŒå…‰é‡ã€‚


ä¾‹å¦‚ï¼Œåœ¨å¼€å‘å…‰ç…§å‡½æ•°ï¼ˆLight Functionï¼‰æ—¶ï¼Œä½ åªèƒ½åœ¨æè´¨ä¸Šä½¿ç”¨è‡ªå‘å…‰é¢œè‰²ï¼ˆEmissive Colorï¼‰è¾“å…¥ï¼Œè€Œä¸èƒ½ä½¿ç”¨å…¶ä»–ä»»ä½•è¾“å…¥ï¼Œå› ä¸ºå…¶ä»–è¾“å…¥ï¼Œå¦‚é‡‘å±æ„Ÿï¼ˆMetallicï¼‰æˆ–ç²—ç³™åº¦ï¼ˆRoughnessï¼‰ä¸é€‚ç”¨ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œä¸ºäº†é¿å…ä½ è¿‡åº¦æ‹…å¿ƒè¾“å…¥ï¼Œäº†è§£æ­£åœ¨åˆ›å»ºçš„æè´¨ç±»å‹éå¸¸é‡è¦ã€‚

å…¶ä¸­ä¸‰ä¸ªä¸»è¦çš„æ§åˆ¶å±æ€§æ˜¯ï¼š

- Blend Mode â€”â€” æ­¤å±æ€§å°†æ§åˆ¶ä½ çš„æè´¨å¦‚ä½•æ··å…¥å®ƒåé¢çš„åƒç´ ã€‚
- Shading Model â€”â€” æ­¤å±æ€§å®šä¹‰å¦‚ä½•è®¡ç®—æè´¨è¡¨é¢çš„å…‰æºã€‚
- Material Domain â€”â€” æ­¤å±æ€§æ§åˆ¶æè´¨çš„ä½¿ç”¨æ–¹å¼ï¼Œä¾‹å¦‚å®ƒä½œä¸ºè¡¨é¢çš„ä¸€éƒ¨åˆ†ã€å…‰ç…§å‡½æ•°ï¼Œè¿˜æ˜¯åæœŸå¤„ç†æè´¨ã€‚

å¹¸è¿çš„æ˜¯ï¼Œè™šå¹»å¼•æ“ 4 ä¸éœ€è¦ä½ çŒœæµ‹å„ç§æè´¨åº”ä½¿ç”¨ä»€ä¹ˆè¾“å…¥ã€‚åœ¨æè´¨ä¸­æ›´æ”¹è¿™äº›è®¾ç½®æ—¶ï¼Œä½ ä¼šæ³¨æ„åˆ°å¯ç”¨çš„è¾“å…¥å°†æ›´æ–°ï¼Œè€Œä¸éœ€è¦çš„è¾“å…¥å°†è¢«ç¦ç”¨ã€‚

é€šè¿‡æè´¨ç¼–è¾‘å™¨ä¸­çš„ Details -> Material é¢æ¿ï¼Œå¯ä»¥è®¾ç½®ä¸¤ä¸ªæœ€é‡è¦çš„æè´¨å‚æ•°æè´¨æ··åˆæ¨¡å‹ `Blend Mode` å’Œç€è‰²æ¨¡å‹ `Shading Model`ã€‚

ç€è‰²æ¨¡å‹`Shading Model`å¯ä»¥æ§åˆ¶æè´¨åå°„å…¥å°„å…‰çº¿çš„æ–¹å¼ã€‚æˆ–æ¢è¨€ä¹‹ï¼Œç€è‰²æ¨¡å‹èƒ½å¤Ÿæ§åˆ¶æ„æˆæè´¨çš„è¾“å…¥æ•°æ®ï¼Œæ‰“é€ å‡ºæœ€ç»ˆå¤–è§‚ã€‚

æ— å…‰ç…§ï¼ˆ`Unlit`ï¼‰ ç€è‰²æ¨¡å‹ä»…è¾“å‡ºé¢œè‰²è‡ªå‘å…‰ï¼Œéå¸¸é€‚ç”¨äºç‰¹æ®Šæ•ˆæœï¼Œä¾‹å¦‚ç«ç„°æˆ–ç…§æ˜ç‰©ã€‚é»˜è®¤å…‰ç…§ï¼ˆ`Default Lit`ï¼‰ æ˜¯é»˜è®¤ç€è‰²æ¨¡å‹ï¼Œè€Œä¸”å¾ˆå¯èƒ½æ˜¯æœ€å¸¸ç”¨çš„æ¨¡å‹ã€‚ æ­¤ç€è‰²æ¨¡å‹ä½¿ç”¨ç›´æ¥å’Œé—´æ¥å…‰ç…§ï¼Œä»¥åŠåå°„é«˜å…‰ã€‚

æ¬¡è¡¨é¢ï¼ˆ`Subsurface`ï¼‰ ç€è‰²æ¨¡å‹èƒ½å¤Ÿæ¨¡æ‹Ÿæ¬¡è¡¨é¢æ•£å°„æ•ˆæœã€‚è¿™æ˜¯ä¸€ç§çœŸå®ä¸–ç•Œä¸­çš„ç°è±¡ï¼Œå…‰çº¿ä¼šç©¿é€è¡¨é¢ï¼Œç„¶ååœ¨æ•´ä¸ªç‰©ä½“ä¸­å¼¥æ•£ã€‚è¿™ç§ç°è±¡åœ¨å†°ã€èœ¡çƒ›ã€çš®è‚¤ç­‰å¯¹è±¡ä¸Šæœ€å®¹æ˜“å‡ºç°ã€‚ æ¬¡è¡¨é¢æ¨¡å‹ä¾èµ–äºï¼ˆSubsurface Colorï¼‰è¾“å…¥ã€‚å¯ä»¥å°†å…¶è§†ä¸ºç‰©ä½“è¡¨é¢ä¸‹ç‰©è´¨çš„é¢œè‰²ï¼Œå…‰çº¿åœ¨è¡¨é¢æ•£å°„æ—¶ï¼Œå°±ä¼šå‡ºç°è¿™ç§é¢œè‰²ã€‚å¯¹äººç±»çš®è‚¤è€Œè¨€ï¼Œæ·±çº¢è‰²æ•ˆæœé€šå¸¸ä¸é”™ã€‚åœ¨ä¸‹é¢çš„å†°å…ƒç´ ä¸­ï¼Œæ·±è“ç»¿è‰²ï¼ˆæ ¹æ®å…‰ç…§è¿›è¡Œå¤šç§è®¡ç®—ï¼‰æ—¨åœ¨ç»™è¡¨é¢è¥é€ ä¸€ç§åŠé€æ˜æ·±åº¦æ„Ÿã€‚

é¢„æ•´åˆçš®è‚¤ï¼ˆ`Pre-integrated Skin`ï¼‰ ç€è‰²æ¨¡å‹çš„æ€§è´¨ä¸æ¬¡è¡¨é¢ï¼ˆSubsurfaceï¼‰æ¨¡å‹éå¸¸ç›¸ä¼¼ï¼Œé€‚ç”¨äºäººç±»è§’è‰²çš„ä½æ€§èƒ½å¼€é”€çš®è‚¤æ¸²æŸ“ã€‚å°½ç®¡åœ¨ç‰©ç†æ•ˆæœä¸Šå¹¶ä¸å®Œç¾ï¼Œ ä½†æ­¤ç€è‰²æ¨¡å‹æ¸²æŸ“å¼€é”€ä½äºæ¬¡è¡¨é¢ï¼ˆSubsurfaceï¼‰æ³•ï¼Œè€Œä¸”é€šå¸¸èƒ½å®ç°ä¸é”™çš„è§’è‰²æ•ˆæœã€‚

é€æ˜æ¶‚å±‚ï¼ˆ`Clear Coat`ï¼‰ ç€è‰²æ¨¡å‹å¯ç”¨æ¥æ›´å¥½åœ°æ¨¡æ‹Ÿæ ‡å‡†æè´¨è¡¨é¢æœ‰ä¸€å±‚åŠé€æ˜è–„è†œçš„å¤šå±‚æè´¨ã€‚æ­¤å¤–ï¼Œæ­¤ç€è‰²æ¨¡å‹å¯ç”¨äºé‡‘å±æˆ–éé‡‘å±è¡¨é¢ã€‚æ­¤æ¨¡å‹ç»ä¸“é—¨è®¾è®¡ï¼Œç”¨äºå°†è¿™ç¬¬äºŒç±»å…‰æ»‘å½©è‰²è–„è†œè´´åœ¨æ— é¢œè‰²çš„é‡‘å±ä¸Šã€‚æ¯”å¦‚ä¸™çƒ¯é…¸æˆ–å–·æ¼†é€æ˜æ¶‚å±‚ï¼Œä»¥åŠè‹æ‰“ç½å’Œæ±½è½¦æ¼†ç­‰é‡‘å±è¡¨é¢çš„å½©è‰²è–„è†œã€‚

æ¬¡è¡¨é¢è½®å»“ç€è‰²æ¨¡å‹ï¼ˆ`Subsurface Profile`ï¼‰çš„æ€§è´¨ä¸æ¬¡è¡¨é¢å’Œé¢„æ•´åˆçš®è‚¤ç€è‰²æ¨¡å‹éå¸¸ç›¸ä¼¼ï¼Œä½†è¯¥æ¨¡å‹åªé€‚ç”¨äºé«˜ç«¯çš®è‚¤æ¸²æŸ“ã€‚å¦‚æœå¸Œæœ›æ¨¡æ‹Ÿçš®è‚¤ï¼Œå°¤å…¶æ˜¯äººç±»çš®è‚¤ï¼Œè¯¥æ¨¡å‹ä¸ºç€è‰²æ¨¡å‹æœ€ä½³é€‰æ‹©ã€‚

åŒæ³•çº¿é€æ˜æ¶‚å±‚ç€è‰²æ¨¡å‹ï¼ˆ`Clear Coat`ï¼‰è¿˜å¯ä»¥ä¸ºé€æ˜æ¶‚å±‚ä¸‹çš„è¡¨é¢æ·»åŠ ç¬¬äºŒæ³•çº¿è´´å›¾ã€‚è¿™æ ·æè´¨èƒ½å¤Ÿæ›´ç²¾ç¡®åœ°ä¸ºå¤æ‚æè´¨å»ºæ¨¡ï¼Œä¾‹å¦‚ç¢³çº¤ç»´å’Œè½¦æ¼†ï¼Œè¿™äº›æè´¨çš„å‡ ä½•æˆ–åå°„è¡¨é¢ä¸é€æ˜æ¶‚å±‚ä¸åŒã€‚

åŒé¢æ¤è¢«ç€è‰²æ¨¡å‹ï¼ˆ`Two Sided Foliage`ï¼‰å…è®¸å…‰çº¿ç©¿é€æè´¨è¡¨é¢ï¼Œå½¢æˆè‡ªç„¶ã€ç»Ÿä¸€çš„å¤–è§‚æ•ˆæœï¼Œæ¯”å¦‚å…‰çº¿ç©¿é€æ ‘å¶é‚£ç§æ•ˆæœã€‚æ¬¡è¡¨é¢é¢œè‰²ç”¨äºå®šä¹‰å…‰çº¿ç©¿é€é‡ï¼ŒåŒæ—¶ç”¨äºä¸ºå¶ç‰‡èŒè„‰ç­‰éƒ¨åˆ†åˆ›å»ºé®ç½©ã€‚

åŒé¢æ¤è¢«ç€è‰²æ¨¡å‹è¿˜æœ‰åŠ©äºæ¶ˆé™¤æ¬¡è¡¨é¢æ•£å°„æ¨¡å‹ä¸­å­˜åœ¨çš„é—®é¢˜ï¼Œè¯¥æ¨¡å‹å¯¹çš®è‚¤æˆ–è¾ƒåšçš„è¡¨é¢éå¸¸æœ‰æ•ˆã€‚ä½¿ç”¨å…¶ä»–ç€è‰²æ¨¡å‹è¿˜ä¼šå¯¼è‡´é”™è¯¯çš„å¤–è§‚ç»“æœã€‚ä¾‹å¦‚ï¼Œç”±äºé»˜è®¤å…‰ç…§æ²¡æœ‰æ¨¡æ‹Ÿä»»ä½•å½¢å¼çš„å…‰é€å°„ï¼Œè€Œé€å°„å…‰æ˜¯å½¢æˆé€¼çœŸçš„æ¤ç‰©æ•ˆæœçš„å…³é”®ï¼Œå› æ­¤ä½¿ç”¨é»˜è®¤å…‰ç…§ä¼šå¯¼è‡´åº•ä¾§è¡¨é¢çœ‹ä¼¼å‡ ä¹æ¼†é»‘çš„ç»“æœã€‚

æ¯›å‘ï¼ˆ`Hair`ï¼‰ç€è‰²æ¨¡å‹åˆ›å»ºæ•ˆæœè‡ªç„¶çš„æ¯›å‘ï¼Œæ¨¡æ‹Ÿå¤šç§é«˜å…‰ï¼šä¸€ç§ä»£è¡¨å…‰çº¿çš„é¢œè‰²ï¼Œå¦ä¸€ç§ä»£è¡¨æ¯›å‘å’Œå…‰çº¿çš„æ··åˆè‰²ã€‚

å¸ƒæ–™ï¼ˆ`Cloth`ï¼‰ç€è‰²æ¨¡å‹é‡æ–°åˆ›å»ºæ¨¡ä»¿å¸ƒæ–™æ•ˆæœæœ€ä½³çš„æè´¨ã€‚å…¶ä¸­åŒ…æ‹¬å¸ƒæ–™è¡¨é¢çš„"ç»’æ¯›"è–„å±‚ï¼Œæ¨¡æ‹Ÿå…‰çº¿ä¸è¿™ç±»æè´¨çš„äº¤äº’å’ŒåŒ¹é…ã€‚

çœ¼ç›ï¼ˆ`Eye`ï¼‰ç€è‰²æ¨¡å‹ç”¨äºæ¨¡æ‹Ÿçœ¼ç›çš„è¡¨é¢ï¼Œä»è€Œå¯¹çœ¼ç›çš„æ¯ä¸ªç”Ÿç‰©æ„æˆéƒ¨åˆ†è¿›è¡Œè‰ºæœ¯æ•ˆæœæ§åˆ¶ã€‚è¿™æ˜¯ä¸€ç§æŠ€æœ¯æ€§å¾ˆé«˜çš„ç€è‰²æ¨¡å‹ï¼Œåœ¨ç€è‰²å™¨ä»£ç ã€æè´¨ã€å‡ ä½•å½¢çŠ¶åŠå…¶ UV å¸ƒå±€ä¹‹é—´å­˜åœ¨éå¸¸å¼ºçš„ä¾èµ–æ€§ã€‚

å•å±‚æ°´ï¼ˆ`Single Layer Water`ï¼‰ ç€è‰²æ¨¡å‹åœ¨ä½¿ç”¨ä¸é€æ˜ï¼ˆOpaqueï¼‰æ··åˆæ¨¡å¼æ—¶å®ç°é€æ˜æ°´é¢çš„æ•ˆæœã€‚è¿™æ ·å¯ä»¥é™ä½éœ€è¦ä½¿ç”¨é€æ˜ï¼ˆTransparentï¼‰ æ··åˆæ¨¡å¼çš„æè´¨çš„ä½¿ç”¨å¼€é”€å’Œå¤æ‚æ€§ã€‚

è–„åŠé€æ˜ï¼ˆ`Thin Translucent`ï¼‰ ç€è‰²æ¨¡å‹æ”¯æŒåŸºäºç‰©ç†åŸç†çš„åŠé€æ˜æè´¨ç±»å‹ï¼Œå¯ä»¥é€šè¿‡è¯¥æ¨¡å‹åˆ›å»ºèƒ½å‡†ç¡®å¤„ç†é«˜å…‰åº¦å’ŒèƒŒæ™¯å¯¹è±¡çš„çœŸå®æœ‰è‰²æˆ–å½©è‰²ç»ç’ƒã€‚

ä¸¾ä¾‹è€Œè¨€ï¼Œåˆ›å»ºæœ‰è‰²ç»ç’ƒæè´¨æ—¶éœ€è¦ç™½è‰²é«˜å…‰å’Œç€è‰²èƒŒæ™¯ã€‚æ­¤ç€è‰²æ¨¡å‹ä½¿ç”¨åŸºäºç‰©ç†åŸç†çš„ç€è‰²å™¨åœ¨å•é€šé“ä¸­æ¸²æŸ“ï¼Œç€è‰²å™¨ä¼šè´Ÿè´£å¤„ç†å…‰çº¿ä»ç©ºæ°”åå°„åˆ°ç»ç’ƒã€ä»¥åŠä»ç»ç’ƒåå°„åˆ°ç©ºæ°”ä¸­çš„æƒ…å†µã€‚

Fromæè´¨è¡¨è¾¾å¼ï¼ˆ`From Material Expression`ï¼‰æˆ–é€åƒç´ ç€è‰²æ¨¡å‹ï¼ˆ`Per-Pixel`ï¼‰æ˜¯ä¸€ç§é«˜çº§åŠŸèƒ½ï¼Œç”¨äºé€šè¿‡æè´¨å›¾è¡¨ä¸­çš„é€»è¾‘å°†å¤šä¸ªç€è‰²æ¨¡å‹åˆå¹¶åˆ°å•ä¸ªæè´¨ï¼ˆæˆ–æè´¨å®ä¾‹ï¼‰ä¸­ã€‚

å½“ç€æè´¨çš„è‰²æ¨¡å‹ï¼ˆShading Modelï¼‰è®¾ç½®ä¸º From Material Expressionï¼Œç€è‰²æ¨¡å‹è¾“å…¥å°†å˜ä¸ºå¯ç”¨ï¼Œå¯ä»¥ä½¿ç”¨æè´¨å›¾è¡¨ï¼ˆMaterial Graphï¼‰ä¸­çš„ é˜´å½±æ¨¡å‹ï¼ˆShading Modelï¼‰èŠ‚ç‚¹è¿›è¡Œè®¾ç½®ã€‚


æè´¨æ··åˆæ¨¡å‹æœ‰å‡ ä¸‹å‡ ç§ï¼š

- `Opaque` æœ€ç»ˆé¢œè‰² = æ¥æºé¢œè‰²ã€‚è¿™æ„å‘³ç€æè´¨å°†ç»˜åˆ¶åœ¨èƒŒæ™¯å‰é¢ã€‚è¿™ç§æ··åˆæ¨¡å¼ä¸ç…§æ˜å…¼å®¹ã€‚
- `Masked` å¦‚æœä¸é€æ˜è’™ç‰ˆå¤§äºä¸é€æ˜è’™ç‰ˆå‰ªè¾‘å€¼ï¼ˆOpacityMask > OpacityMaskClipValueï¼‰ï¼Œåˆ™æœ€ç»ˆé¢œè‰²ä¸ºæ¥æºé¢œè‰²ï¼Œå¦åˆ™åºŸå¼ƒåƒç´ ã€‚è¿™ç§æ··åˆæ¨¡å¼ä¸ç…§æ˜å…¼å®¹ã€‚
- `Translucent` æœ€ç»ˆé¢œè‰² = Source color * Opacity + Dest color * (1 - Opacity)ã€‚è¿™ç§æ··åˆæ¨¡å¼ä¸åŠ¨æ€ç…§æ˜ä¸å…¼å®¹ã€‚
- `Additive` æœ€ç»ˆé¢œè‰² = æ¥æºé¢œè‰² + ç›®æ ‡é¢œè‰²ã€‚è¿™ç§æ··åˆæ¨¡å¼ä¸åŠ¨æ€ç…§æ˜ ä¸ å…¼å®¹ã€‚
- `Modulate` æœ€ç»ˆé¢œè‰² = æ¥æºé¢œè‰² x ç›®æ ‡é¢œè‰²ã€‚é™¤éæ˜¯è´´èŠ±æè´¨ï¼Œå¦åˆ™è¿™ç§æ··åˆæ¨¡å¼ä¸åŠ¨æ€ç…§æ˜æˆ–é›¾ ä¸ å…¼å®¹ã€‚

è®°ä½*é€æ˜*ä¸*ä¸æ¸²æŸ“*ä¹‹é—´çš„å·®åˆ«ååˆ†é‡è¦ï¼Œè™½ç„¶å®ƒä»¬éƒ½å¯èƒ½äº§ç”Ÿé€æ˜æ•ˆæœã€‚é€æ˜è¡¨é¢ï¼ˆä¾‹å¦‚ç»ç’ƒï¼‰ä»ä¼šä»¥åå°„ï¼ˆé•œé¢åå°„ï¼‰å½¢å¼ä¸å…‰çº¿äº¤äº’ã€‚ä»¥"é®ç½©"ï¼ˆMaskedï¼‰æ¨¡å¼å‰”é™¤çš„åƒç´ æ— éæ˜¯ä¸ç»˜åˆ¶ï¼Œåœ¨è¿™äº›åŒºåŸŸçœ‹ä¸åˆ°ä»»ä½•åå°„ã€‚å¦‚æœæ‚¨æƒ³è¦ä¿ç•™åå°„æˆ–é•œé¢åå°„å¤–è²Œï¼Œé‚£ä¹ˆæœ€å¥½ä½¿ç”¨"åŠé€æ˜"ï¼ˆ`Translucent`ï¼‰æ··åˆæ¨¡å¼ï¼Œæˆ–è€ƒè™‘å»ºç«‹åˆ†å±‚æè´¨ã€‚

ä½¿ç”¨é®ç½©ï¼ˆ`Masked`ï¼‰æ··åˆæ¨¡å¼æ—¶ï¼Œæ‚¨éœ€è¦ç‰¹åˆ«æ³¨æ„ä¸é€æ˜è’™ç‰ˆå‰ªè¾‘å€¼ï¼ˆOpacity Mask Clip Valueï¼‰ å±æ€§ã€‚æ­¤å±æ€§åŒ…å« 0-1 æ ‡é‡å€¼ï¼Œç”¨äºæ§åˆ¶å°†ä¸é€æ˜è’™ç‰ˆçº¹ç†çš„å“ªä¸ªå€¼ç”¨ä½œåˆ†ç•Œç‚¹ï¼Œè¿™ä¸ªåˆ†ç•Œç‚¹ä¹‹ä¸Šæ‰€æœ‰ è¾ƒæš— çš„å€¼éƒ½ä¸ä¼šè¿›è¡Œæ¸²æŸ“ã€‚

å åŠ å‹æ··åˆæ¨¡å¼ï¼ˆ`Additive`ï¼‰æ— éè·å–æè´¨çš„åƒç´ ï¼Œå¹¶å°†å…¶ä¸èƒŒæ™¯çš„åƒç´ ç›¸åŠ ã€‚è¿™ä¸ Photoshop ä¸­çš„*Linear Dodge (Add)*çº¿æ€§å‡æ·¡æ·»åŠ æ··åˆæ¨¡å¼éå¸¸ç›¸ä¼¼ã€‚è¿™è¡¨ç¤ºä¸ä¼šè¿›è¡Œæš—åŒ–ï¼›å› ä¸ºæ‰€æœ‰åƒç´ å€¼éƒ½å åŠ åˆ°ä¸€èµ·ï¼Œå› æ­¤é»‘è‰²å°†ç›´æ¥æ¸²æŸ“ä¸ºé€æ˜ã€‚è¿™ç§æ··åˆæ–¹å¼é€‚åˆäºå„ç§ç‰¹æ®Šæ•ˆæœï¼Œä¾‹å¦‚ç«ç„°ã€è’¸æ±½æˆ–å…¨æ¯å›¾ã€‚

ä¸åŠé€æ˜ï¼ˆTranslucentï¼‰æ··åˆæ–¹å¼ç›¸åŒï¼Œè¿™ç§æ··åˆæ–¹å¼ä¸æ”¯æŒé•œé¢åå°„ï¼ˆå³ï¼Œåå°„ï¼‰ã€‚è¿™ç§æ··åˆçš„å åŠ å‹æ€§è´¨å¯èƒ½æ„å‘³ç€æ‚¨ä¸ä¼šä»¥ä»»ä½•æ–¹å¼ä½¿ç”¨è¿™ç§æ··åˆï¼Œä½†æ‚¨å¯ä»¥ä½¿ç”¨ä¸Šæ–‡ä¸­"åŠé€æ˜"ï¼ˆTranslucentï¼‰å°èŠ‚ä¸­æ‰€ç¤ºçš„"ç«‹æ–¹ä½“è´´å›¾"æ–¹æ³•æ¥æ¨¡æ‹Ÿç±»ä¼¼äºåå°„çš„æ•ˆæœã€‚

è°ƒåˆ¶ï¼ˆ`Modulate`ï¼‰æ··åˆæ¨¡å¼æ— éå°†æè´¨çš„å€¼ä¸èƒŒæ™¯çš„åƒç´ ç›¸ä¹˜ã€‚è¿™ç§è¡Œä¸ºä¸ Photoshop ä¸­çš„*æ­£ç‰‡å åº•æ¨¡å¼*æ··åˆæ¨¡å¼éå¸¸ç±»ä¼¼ã€‚


è™šå¹»å¼•æ“ä¸­çš„æè´¨ç³»ç»Ÿæ˜¯ä¸€å¥—åŠŸèƒ½å¼ºå¤§ã€çµæ´»å¤šå˜çš„è§£å†³æ–¹æ¡ˆï¼Œé€‚åˆåœ¨é¡¹ç›®ä¸­å¼€å‘å’Œæ„å»ºæè´¨ã€‚è¯¥ç³»ç»Ÿå…è®¸ä½ å°†ä¸åŒçº¹ç†åˆ†å±‚å¹¶æ··åˆåœ¨ä¸€èµ·ï¼Œä¸ºå…³å¡ä¸­çš„å¯¹è±¡åˆ›å»ºç‹¬ç‰¹çš„æè´¨ã€‚æè´¨å›¾å±‚`Material Layers`ç±»ä¼¼äºæè´¨å‡½æ•°çš„åˆ†å±‚æè´¨å·¥ä½œæµï¼Œä½ å¯ä»¥åœ¨æè´¨å›¾è¡¨ä¸­ä½¿ç”¨æè´¨å›¾å±‚èµ„äº§ç±»å‹æ¥ç»„åˆå¹¶æ··åˆçº¹ç†ã€‚æ­¤å¯é€‰å·¥ä½œæµåˆ©ç”¨æè´¨å®ä¾‹åŒ– æ¥ç®€åŒ–æè´¨åˆ†å±‚å’Œæ··åˆè¿‡ç¨‹ã€‚

ä½¿ç”¨æè´¨å›¾å±‚çš„å¥½å¤„ä¹‹ä¸€æ˜¯èƒ½å¤Ÿåˆ›å»ºéå¸¸å¤æ‚çš„æè´¨ï¼Œä»æœªæ¥å¯ç¼–è¾‘çš„è§’åº¦çœ‹ä¹Ÿæ›´æ˜“äºç®¡ç†ã€‚è™½ç„¶å¯ä»¥ä½¿ç”¨åˆ†å±‚æè´¨å·¥ä½œæµæˆ–åœ¨ä¼ ç»Ÿæè´¨ï¼ˆæ— å›¾å±‚å’Œæè´¨å‡½æ•°ï¼‰ä¸­åˆ›å»ºç›¸åŒç±»å‹çš„æè´¨ï¼Œä½†æè´¨å›¾å±‚å·¥ä½œæµèƒ½æä¾›æ›´å¥½çš„æŒæ§æ€§å’Œçµæ´»æ€§ï¼Œè¿˜å¯ä»¥å‡å°‘åˆ›å»ºæè´¨çš„å¤æ‚ç¨‹åº¦ã€‚

ä»è™šå¹»å¼•æ“ 4.26 å¼€å§‹ï¼Œæè´¨å›¾å±‚åŠŸèƒ½å°†é»˜è®¤å¯ç”¨ã€‚åœ¨è€ç‰ˆæœ¬ä¸­å¯ç”¨æè´¨å›¾å±‚ï¼Œæ‰“å¼€é¡¹ç›®è®¾ç½® Project Settings -> Rendering -> Materials ç±»ç›®ï¼Œå¹¶å¯ç”¨ Support Material Layersã€‚


å†…å®¹æµè§ˆå™¨æä¾›çš„ Materials & Textures é€‰é¡¹ï¼š

- 2D Array Render Target äºŒç»´æ•°ç»„æ¸²æŸ“ç›®æ ‡ï¼Œå°†æ¸²æŸ“è¾“å‡ºåˆ°äºŒç»´æ•°ç»„ï¼›
- Canvas Render Target ç”»å¸ƒæ¸²æŸ“ç›®æ ‡ï¼Œå°†æ¸²æŸ“è¾“å‡ºåˆ°äºŒç»´ç”»å¸ƒï¼›
- Cube render Target ç«‹æ–¹ä½“æ¸²æŸ“ç›®æ ‡ï¼›
- Material æè´¨ï¼›
- Material Function æè´¨å‡½æ•°ï¼Œå®ƒç”¨äºç»„ç»‡éœ€è¦é‡å¤ä½¿ç”¨çš„æè´¨èŠ‚ç‚¹ç¼–æ’ï¼›
- Material Instance æè´¨å®ä¾‹ï¼Œå¤åˆ¶è‡ªå…¶å®ƒæè´¨ã€‚
- Material Layer æè´¨å›¾å±‚ï¼›
- Material Layer Blend æè´¨å›¾å±‚æ··åˆï¼›
- Material Paramerter Collection æè´¨å‚æ•°é›†ä½“ï¼›
- Media Texture å¤šåª’ä½“æè´¨ï¼›
- Render Target æ¸²æŸ“ç›®æ ‡ï¼›
- Runtime Virtual Texture è¿è¡Œæ—¶è™šæ‹Ÿçº¹ç†ï¼›
- Subsurface Profile æ¬¡è¡¨é¢è½®å»“ç€è‰²ï¼Œä»¥æ¸²æŸ“çœŸå®çš„çš®è‚¤æˆ–èœ¡è´¨è¡¨é¢ã€‚
- Texture 2D Array äºŒç»´çº¹ç†æ•°ç»„ï¼›
- Volume Render Target ä½“ç§¯æ¸²æŸ“ç›®æ ‡ï¼›
- Volume Texture ä½“ç§¯çº¹ç†ï¼›

æ¸²æŸ“ç›®æ ‡ï¼ˆRender Targetï¼‰å¯å¹¿æ³›åº”ç”¨äºè™šå¹»å¼•æ“ 4 ä¸­çš„ä¸åŒä»»åŠ¡ï¼Œæ¸²æŸ“ç›®æ ‡å¯ç”¨äºæ‰§è¡Œå„ç§æœ‰è¶£è€Œå®ç”¨çš„æ•ˆæœï¼Œå¦‚ä¿å­˜å»¶è¿Ÿæ¸²æŸ“å™¨æ‰€éœ€çš„è¯¸å¤šç¼“å­˜ã€åœ¨ç©å®¶æŠ•æ·ç‰©ä½“åˆ°æ°´å¡˜ä¸­æ—¶å½¢æˆå„ç§å¤æ‚æ•ˆæœï¼ˆå¦‚æ¶Ÿæ¼ªï¼‰ï¼Œé›ªåœ°é—è¿¹ç­‰ç­‰ã€‚é…åˆåæœŸæè´¨ï¼Œå°† `SceneTexture` æè´¨è¡¨è¾¾å¼æ·»åŠ åˆ°æè´¨ä¸­ï¼Œå¹¶åœ¨è¡¨è¾¾å¼å±æ€§ä¸­é€‰æ‹©è¦å¼•ç”¨çš„çº¹ç†ã€‚

ä¸ºè™šå¹»å¼•æ“ 4 é¡¹ç›®åˆ›å»ºçº¹ç†æ—¶ï¼Œä½ é€šå¸¸éœ€è¦å¤–éƒ¨ 2D ç»˜å›¾ç¨‹åºï¼Œå¦‚ Photoshop æˆ– GIMPã€‚è™½ç„¶ä»¥è¿™ç§æ–¹å¼ç¼–å†™å†…å®¹èƒ½è·å¾—å‡ºè‰²çš„ç»“æœï¼Œä½†æœ‰äº›æƒ…å†µä¸‹ï¼Œä½¿ç”¨è“å›¾å’Œæ¸²æŸ“ç›®æ ‡åˆ›å»ºè¿™ç±»å†…å®¹éå¸¸æœ‰ç”¨ã€‚

è“å›¾å’Œæ¸²æŸ“ç›®æ ‡é…åˆä½¿ç”¨ï¼Œå¯ç”¨äºåˆ›å»ºå¤§é‡ä¸åŒæ¸²æŸ“æ•ˆæœï¼š

- åˆ›å»ºé«˜åº¦å›¾ç»˜åˆ¶å™¨ã€‚
- åˆ›å»ºæ¶²ä½“è¡¨é¢æ¨¡æ‹Ÿã€‚
- åˆ›å»ºè¿è¡Œæ—¶ç»˜åˆ¶ç¨‹åºã€‚
- ç‰¹å®šç‰©ä½“é€šè¿‡æ—¶ä½¿è¡¨é¢å˜å½¢ã€‚

ä½¿ç”¨è“å›¾å’Œæ¸²æŸ“ç›®æ ‡æ—¶é¡»æ³¨æ„å…¶å­˜åœ¨çš„é™åˆ¶å’Œçº¦æŸï¼š

- æ¸²æŸ“ç›®æ ‡æ­£åœ¨è¢«ç”¨æˆ·æŒ‡å®šçš„æè´¨ä½œä¸ºçº¹ç†è¿›è¡Œé‡‡æ ·ï¼Œåˆ™æ— æ³•å¯¹å…¶è¿›è¡Œç»˜åˆ¶ã€‚éœ€è¦ä½¿ç”¨é€æ˜åº¦æ··åˆåœ¨åŸå¤„ä¿®æ”¹æ¸²æŸ“ç›®æ ‡ï¼›æˆ–åœ¨ä¸¤ä¸ªä¸åŒæ¸²æŸ“ç›®æ ‡ä¹‹é—´æ¥å›åˆ‡æ¢ã€‚
- ç»˜åˆ¶åˆ°æ¸²æŸ“ç›®æ ‡æ—¶ï¼Œæè´¨åªæœ‰ Emissive Color å’Œ Opacity è¾“å‡ºä¸ºæœ‰æ•ˆã€‚
- ä½¿ç”¨æ¸²æŸ“ç›®æ ‡å’Œ World Position ä¹‹ç±»çš„æè´¨è¡¨è¾¾å¼èŠ‚ç‚¹æ—¶ä¸æ”¯æŒç¯å…‰ï¼Œå¯èƒ½è¿”å›éé¢„æƒ³çš„ç»“æœã€‚
- Emissive Color é»˜è®¤é”å®šä¸ºæ­£ï¼Œä½†å¯ç”¨æè´¨å±æ€§ AllowNegativeEmissiveColor å³å¯è¾“å‡ºè´Ÿå€¼ã€‚

æ¸²æŸ“ç›®æ ‡è“å›¾èŠ‚ç‚¹ï¼š

- `BeginDrawCanvasToRenderTarget` è¿”å›ä¸€ä¸ªå¯ç”¨äºç»˜åˆ¶åˆ°ç‰¹å®šæ¸²æŸ“ç›®æ ‡çš„ç”»å¸ƒå¯¹è±¡ã€‚éœ€è¦é…åˆè°ƒç”¨ End Draw å®Œæˆæ¸²æŸ“ï¼
- `EndDrawCanvasToRenderTarget` å¿…é¡»å’Œä¸€ä¸ª BeginDrawCanvasToRenderTarget ç»„å¯¹è°ƒç”¨ï¼Œå®Œæˆåˆ°æ¸²æŸ“ç›®æ ‡çš„æ¸²æŸ“ã€‚
- `ClearRenderTarget2D` ç”¨ç»™å®šçš„ Clear Color æ¸…é™¤ç‰¹å®šçš„æ¸²æŸ“ç›®æ ‡ã€‚
- `CreateRenderTarget2D` æ–°å»ºä¸€ä¸ªæ¸²æŸ“ç›®æ ‡å¹¶å°†å…¶åˆå§‹åŒ–åˆ°ç‰¹å®šçš„æœ‰æ•ˆç»´åº¦ã€‚
- `DrawMaterialToRenderTarget` å°†æè´¨æ¸²æŸ“ä¸€ä¸ªå››è¾¹å½¢ï¼Œå³ä½¿æ¸²æŸ“ç›®æ ‡å·²è®¾ç½®ï¼Œæ­¤èŠ‚ç‚¹ä¹Ÿä¼šå¯¹å…¶è¿›è¡Œè®¾ç½®ï¼Œè¿™æ˜¯ä¸€ä¸ªå¼€é”€å¤§çš„è¿ç®—ã€‚
- `ExportRenderTarget` å°†æ¸²æŸ“ç›®æ ‡ä½œä¸º HDR å›¾åƒå¯¼å‡ºåˆ°ç£ç›˜ä¸Šã€‚

åˆ©ç”¨ UPrimitiveComponent æä¾›çš„ `CreateDynamicMaterialInstance` æ–¹æ³•åˆ›å»ºåŠ¨æ€æè´¨ï¼Œå†é€šè¿‡ `DrawMaterialToRenderTarget` å°†å…¶ç»˜åˆ¶åˆ° RenderTargetã€‚


æè´¨å‡½æ•°`Material Function`æ˜¯æè´¨å›¾çš„ä¸€äº›å°ç‰‡æ®µï¼Œå®ƒä»¬å¯ä»¥ä¿å­˜åœ¨åŒ…ä¸­ï¼Œå¹¶åœ¨å¤šä¸ªæè´¨ä¹‹é—´é‡å¤ä½¿ç”¨ã€‚å®ƒä»¬çš„ç”¨é€”æ˜¯ä½¿æ‚¨èƒ½å¤Ÿå³æ—¶è®¿é—®å¸¸ç”¨çš„æè´¨èŠ‚ç‚¹ç½‘ç»œï¼Œä»è€Œç®€åŒ–åˆ›å»ºæè´¨çš„è¿‡ç¨‹ã€‚

ç¼–è¾‘æè´¨å‡½æ•°æ—¶ï¼Œé¢„è§ˆçª—å£å°†æ˜¾ç¤ºæ­£åœ¨é¢„è§ˆçš„èŠ‚ç‚¹ã€‚æ‚¨å¯ä»¥ å³é”®å•å‡» ä»»ä½•èŠ‚ç‚¹å¹¶é€‰æ‹© å¼€å§‹é¢„è§ˆèŠ‚ç‚¹ï¼ˆStart Previewing Nodeï¼‰ï¼Œä»¥é¢„è§ˆæˆªè‡³è¯¥ç‚¹ä¸ºæ­¢çš„ç½‘ç»œçš„ç»“æœã€‚

åˆ›å»ºæè´¨å‡½æ•°å®Œæˆåï¼Œåº”è¯¥å°†å…¶å‘å¸ƒåˆ°æè´¨å‡½æ•°åº“ï¼Œä»¥æ–¹ä¾¿åˆ›å»ºæè´¨æœŸé—´è¿›è¡Œè®¿é—®ã€‚æè´¨å‡½æ•°åº“æ˜¯æè´¨ç¼–è¾‘å™¨ä¸­çš„ä¸€ä¸ªçª—å£ï¼Œå…¶ä¸­åŒ…å«ç»è¿‡åˆ†ç±»ä¸”å¯è¿‡æ»¤çš„å¯ç”¨æè´¨å‡½æ•°åˆ—è¡¨ã€‚è¿™ä¸ªåˆ—è¡¨åŒ…å«æ‰€æœ‰å·²è£…å…¥çš„å‡½æ•°ï¼Œä¸è¿‡ä¹ŸåŒ…å«æ‰€æœ‰è™½ç„¶æœªè£…å…¥ä½†å·²é€šè¿‡å†…å®¹æµè§ˆå™¨æ‰€ä½¿ç”¨çš„ å†…å®¹æµè§ˆå™¨æ•°æ®åº“ æ‰¾åˆ°çš„å‡½æ•°ã€‚

çº¹ç†å¤„ç†å‡½æ•°å‚è€ƒï¼š

- `CylindricalUVs`ï¼ˆåœ†æŸ±å½¢ UVï¼‰
- `DetailTexturing`ï¼ˆç»†èŠ‚çº¹ç†å¤„ç†ï¼‰
- `LocalAlignedTexture`ï¼ˆå±€éƒ¨ä¸€è‡´çº¹ç†ï¼‰
- `ZWorldSpaceFlow`ï¼ˆZ å…¨å±€ç©ºé—´æµåŠ¨ï¼‰
- `TextureCropping`ï¼ˆçº¹ç†è£åˆ‡ï¼‰
- `WorldAlignedNormal`ï¼ˆå…¨å±€ä¸€è‡´æ³•çº¿ï¼‰
- `WorldAlignedTexture`ï¼ˆå…¨å±€ä¸€è‡´çº¹ç†ï¼‰
- `3DSandMayaUVCoordinates`ï¼ˆ3D æ²™ Maya UV åæ ‡ï¼‰
- `CustomRotator`ï¼ˆå®šåˆ¶æ—‹è½¬ï¼‰
- `HeightLerp`ï¼ˆé«˜åº¦æ’å€¼ï¼‰
- `CameraWorldBlend`ï¼ˆæ‘„åƒæœºå…¨å±€æ··åˆï¼‰
- `LocalSpaceSurfaceMirroring`ï¼ˆå±€éƒ¨ç©ºé—´è¡¨é¢é•œåƒï¼‰
- `SubUV_Function`ï¼ˆå­ UV_å‡½æ•°ï¼‰
- `TwoSidedTexturing`ï¼ˆåŒé¢çº¹ç†å¤„ç†ï¼‰
- `WorldCoordinate3Way`ï¼ˆå…¨å±€åæ ‡ä¸‰å‘ï¼‰

åœ¨è™šå¹»å¼•æ“ 4 ä¸­ï¼Œ`Material Instancing` æè´¨å®ä¾‹åŒ–ç”¨æ¥æ›´æ”¹æè´¨çš„å¤–è§‚ï¼Œè€Œä¸ä¼šå¼•èµ·æˆæœ¬é«˜æ˜‚çš„æè´¨é‡æ–°ç¼–è¯‘ã€‚é‰´äºå…¸å‹çš„æè´¨åœ¨è¿›è¡Œç¼–è¾‘æˆ–æ›´æ”¹åå¿…é¡»æ‰§è¡Œé‡æ–°ç¼–è¯‘ï¼ˆåœ¨æ¸¸æˆå‰ å¿…é¡» æ‰§è¡Œçš„æ“ä½œï¼‰ï¼Œå¯ä»¥å»ºç«‹å®ä¾‹åŒ–æè´¨æ¥è¿›è¡Œæ›´æ”¹ï¼Œè€Œä¸å¿…æ‰§è¡Œè¿™æ ·çš„é‡æ–°ç¼–è¯‘ã€‚æŸäº›ç±»å‹çš„å®ä¾‹åŒ–æè´¨ç”šè‡³å¯ä»¥åœ¨æ¸¸æˆæœŸé—´æ›´æ”¹ï¼Œä»è€Œå¯¹æ¸¸æˆä¸­çš„äº‹ä»¶ä½œå‡ºååº”ï¼ˆä¾‹å¦‚ï¼Œæ ‘æœ¨ç‡ƒçƒ§æ—¶å…¶æè´¨å˜æš—å¹¶çƒ§ç„¦ï¼‰ã€‚è¿™æ ·ï¼Œç¾å·¥å…ƒç´ å°±å¯å®ç°æå¤§çš„è§†è§‰çµæ´»æ€§ã€‚

æè´¨å¯ä»¥è®¾ç½®å„ç§å‚æ•°èŠ‚ç‚¹ï¼Œåˆ›å»ºå…¶æè´¨å®ä¾‹åï¼Œå†ç”±æè´¨å®ä¾‹ä¼ å…¥ï¼Œä»¥å®ç°å¸¦å‚æ•°åœ°è°ƒç”¨çˆ¶æè´¨ã€‚

æè´¨å¯¹è±¡å¯ä»¥è®¾ç½®ä»¥ä¸‹å‡ ç§å…¬å¼€å‚æ•°ï¼š

- S `ScalarParameter` ä¸€ç»´å‚æ•°ã€‚
- V `VectorParameter` å››ç»´å‚æ•°ã€‚
- `TextureSampleParameter2D` æ¥å—åŸºæœ¬çš„ Texture2Dã€‚
- `TextureSampleParameterCube` æ¥å— TextureCubeæˆ–ç«‹æ–¹ä½“è´´å›¾ã€‚
- `TextureSampleParameterFlipbook` æ¥å— FlipbookTextureï¼ˆå›¾åƒåºåˆ—è§†å›¾çº¹ç†ï¼‰ã€‚
- `TextureSampleParameterMeshSubUV` æ¥å— Texture2Dï¼Œåè€…ç”¨äºå…·æœ‰ç½‘æ ¼å‘å°„å™¨çš„å­ UV æ•ˆæœ ã€‚
- `TextureSampleParameterMeshSubUV` æ¥å— Texture2Dï¼Œåè€…ç”¨äºå…·æœ‰ç½‘æ ¼å‘å°„å™¨çš„å­ UV æ··åˆæ•ˆæœã€‚
- `TextureSampleParameterMovie` æ¥å— MovieTextureï¼ˆç”µå½±çº¹ç†ï¼‰ã€‚
- `TextureSampleParameterNormal` æ¥å—ç”¨ä½œæ³•çº¿è´´å›¾çš„ Texture2Dã€‚
- `TextureSampleParameterSubUV` æ¥å— Texture2Dï¼Œåè€…ç”¨äºå…·æœ‰ç²¾çµå‘å°„å™¨çš„å­ UV æ•ˆæœã€‚

è¿˜æœ‰ä¸€äº›é™æ€å‚æ•°ï¼š

- `StaticBoolParameter`
- `StaticSwitchParameter`
- `StaticComponentMaskParameter` åˆ†é‡é®ç½©ã€‚

å¼€å…³å‚æ•°è¡¨è¾¾å¼ SwitchParameter æ¥æ”¶ä¸¤ä¸ªè¾“å…¥ï¼Œå¹¶ä¸”åœ¨å‚æ•°å€¼ä¸º true æ—¶è¾“å‡ºç¬¬ä¸€ä¸ªè¾“å…¥çš„å€¼ (True ç«¯å£ï¼‰ï¼Œå¦åˆ™è¾“å‡ºç¬¬äºŒä¸ªè¾“å…¥çš„å€¼ï¼ˆFalse ç«¯å£ï¼‰ã€‚

é™æ€å‚æ•°åœ¨ç¼–è¯‘æ—¶åº”ç”¨ï¼Œå› æ­¤å®ƒä»¬ä¼šç”Ÿæˆæ›´åŠ ä¼˜åŒ–çš„ä»£ç ï¼Œç”±é™æ€å‚æ•°å±è”½çš„æ•´ä¸ªæè´¨åˆ†æ”¯åœ¨ç¼–è¯‘åå°†æ¶ˆé™¤ï¼Œè€Œä¸ä¼šåœ¨è¿è¡Œæ—¶æ‰§è¡Œã€‚ç”±äºå®ƒä»¬æ˜¯åœ¨ç¼–è¯‘æ—¶åº”ç”¨çš„ï¼Œåªèƒ½ä»æè´¨å®ä¾‹ç¼–è¾‘å™¨ä¸­æ›´æ”¹ï¼Œè€Œä¸èƒ½ä»è„šæœ¬ä¸­æ›´æ”¹ã€‚å¯¹äºåŸºæœ¬æè´¨ä¸­æ¯ç§ç”±å®ä¾‹ä½¿ç”¨çš„é™æ€å‚æ•°ç»„åˆï¼Œéƒ½å°†é€šè¿‡ç¼–è¯‘äº§ç”Ÿä¸€ä¸ªæ–°æè´¨ï¼è¿™å¯èƒ½ä¼šå¯¼è‡´ç¼–è¯‘å¤§é‡ç€è‰²å™¨ã€‚è¯·å°½é‡å‡å°‘æè´¨ä¸­çš„é™æ€å‚æ•°æ•°ç›®ä»¥åŠå®é™…ä½¿ç”¨çš„é™æ€å‚æ•°æ’åˆ—æ•°ã€‚

æœ‰ä¸¤ç§ä¸“ç”¨äºç»„ç»‡æè´¨å‚æ•°çš„æè´¨è¡¨è¾¾å¼èŠ‚ç‚¹ï¼š

- `CollectionParameter`è¡¨è¾¾å¼ç”¨æ¥å¼•ç”¨"å‚æ•°é›†åˆ"èµ„äº§ã€‚è¿™äº›æ˜¯å¯ä»¥ç”±è®¸å¤šä¸åŒèµ„äº§ï¼ˆä¾‹å¦‚æè´¨å’Œè“å›¾ç­‰ç­‰ï¼‰è½»æ¾é‡å¤ä½¿ç”¨çš„å‚æ•°ç»„ã€‚
- `DynamicParameter`è¡¨è¾¾å¼ä¸ºç²’å­å‘å°„å™¨æä¾›ç®¡é“ï¼Œä»¥ä¾¿å°†æœ€å¤šå››ä¸ªè¦ä»¥ä»»æ„æ–¹å¼å¤„ç†çš„å€¼ä¼ é€’ç»™æè´¨ã€‚è¿™äº›å€¼æ˜¯é€šè¿‡æ”¾ç½®åœ¨å‘å°„å™¨ä¸Šçš„ ParameterDynamic æ¨¡å—åœ¨ Cascade ä¸­è®¾ç½®çš„ã€‚


åœ¨è™šå¹»å¼•æ“ 4 ä¸­ï¼Œå…±æœ‰ä¸¤ç±»æè´¨å®ä¾‹ï¼š

- Material Instance Constant å¸¸é‡æè´¨å®ä¾‹ - ä»…åœ¨è¿è¡Œæ—¶ä¹‹å‰è®¡ç®—ã€‚
- Material Instance Dynamic (MID) åŠ¨æ€æè´¨å®ä¾‹ - å¯ä»¥åœ¨è¿è¡Œæ—¶è®¡ç®—å’Œç¼–è¾‘ã€‚

åœ¨ GPU ä¸Šï¼Œé¡¶ç‚¹ç€è‰²å™¨é’ˆå¯¹æ¯ä¸ªé¡¶ç‚¹è¿è¡Œï¼Œè€Œåƒç´ ç€è‰²å™¨é’ˆå¯¹æ¯ä¸ªåƒç´ è¿è¡Œã€‚åœ¨è™šå¹»å¼•æ“ 4 ä¸­ï¼Œå‡ ä¹æ‰€æœ‰æè´¨èŠ‚ç‚¹éƒ½é’ˆå¯¹æ¯ä¸ªåƒç´ æ¥è¿è¡Œã€‚è™½ç„¶ UV åæ ‡ï¼ˆUV Coordinateï¼‰èŠ‚ç‚¹å¯ä»¥æ˜¯é¡¶ç‚¹æˆ–åƒç´ ç€è‰²å™¨çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯å®šåˆ¶ UV åŠŸèƒ½ *CustomizedUV* ä»…åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­è¿è¡Œï¼Œä¸åœ¨åƒç´ ç€è‰²å™¨ä¸­è¿è¡Œç›¸åŒè®¡ç®—ç›¸æ¯”ï¼Œè¿™å¯ä»¥æé«˜æ€§èƒ½ã€‚è¿™æ˜¯ä¸€ç§æé«˜é€Ÿåº¦çš„ç»ä½³æ–¹æ³•ï¼Œå³ä½¿æ˜¯ä»…ä»…å¹³é“ºçº¹ç†ä¹Ÿæ˜¯å¦‚æ­¤ã€‚è™½ç„¶ç³»ç»Ÿå¹¶æœªé™åˆ¶å¯ä»¥å¯¹ UV è¿è¡Œçš„æ•°å­¦è¿ç®—ï¼Œä½†æ˜¯ç»“æœå°†ä¾èµ–äºç½‘æ ¼çš„é“ºåµŒã€‚


æè´¨å‚æ•°é›†åˆï¼ˆ`Material Parameter Collection`ï¼‰ æ˜¯ä¸€ä¸ªç”¨äºå­˜å‚¨ä»»æ„ æ ‡é‡å‚æ•°å’ŒçŸ¢é‡å‚æ•°é›†åˆçš„èµ„æºã€‚ è¿™äº›å‚æ•°å¯ä»¥åœ¨ä»»æ„æè´¨ä¸­å¼•ç”¨ã€‚è¿™æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œç¾æœ¯å€ŸåŠ©è¿™ä¸ªå·¥å…·å¯ä»¥ä¸€æ¬¡æ€§ å°†å…¨å±€æ•°æ®å¯¼å…¥åˆ°å¤šä¸ªæè´¨ã€‚å®ƒè¿˜æœ‰åŠ©äºè®¾ç½®æ¯ä¸ªå…³å¡çš„æ•ˆæœï¼Œå¦‚é›ªé‡ã€ç ´åç¨‹åº¦ã€æ¹¿åº¦ç­‰ã€‚ å¦‚æœä¸ä½¿ç”¨æ­¤å·¥å…·ï¼Œè¿™äº›æŒ‰å…³å¡æ•ˆæœéœ€è¦å¯¹å…³å¡ä¸­çš„è®¸å¤šä¸åŒæè´¨å®ä¾‹è®¾ç½®å•ç‹¬çš„å‚æ•°å€¼ã€‚


è™šå¹»å¼•æ“ 4 å·²é‡‡ç”¨åŸºäºç‰©ç†çš„æ–°æè´¨å’Œæ˜æš—å¤„ç†æ¨¡å‹ï¼ŒPhysically Basedï¼ŒåŸºäºç‰©ç†çš„æ˜æš—å¤„ç†æ„å‘³ç€æˆ‘ä»¬ä¼°ç®—å…‰çº¿çš„å®é™…æƒ…å†µï¼Œè€Œä¸æ˜¯ä¼°ç®—æˆ‘ä»¬ å‡­ç›´è§‰è®¤ä¸ºå®ƒåº”è¯¥å‘ç”Ÿçš„æƒ…å†µã€‚æœ€ç»ˆç»“æœæ˜¯ï¼Œè¿™æ ·å¯äº§ç”Ÿæ›´å‡†ç¡®å¹¶ä¸”é€šå¸¸æ›´åŠ è‡ªç„¶çš„å¤–è§‚ã€‚åŸºäºç‰©ç† çš„æè´¨åœ¨æ‰€æœ‰ç…§æ˜ç¯å¢ƒä¸­éƒ½å¯ä»¥åŒæ ·å®Œç¾åœ°å·¥ä½œã€‚å¦å¤–ï¼Œæè´¨å€¼å¯ä»¥ ä¸é‚£ä¹ˆå¤æ‚ï¼Œç›¸äº’ä¾èµ–ä¹Ÿå¯ä»¥å°‘ä¸€äº›ï¼Œä»è€Œäº§ç”Ÿæ›´åŠ ç›´è§‚çš„ç•Œé¢ã€‚è¿™äº›ç›Šå¤„ç”šè‡³é€‚ç”¨äºéé€¼çœŸæ¸²æŸ“ï¼Œæ‚¨å¯åœ¨çš®å…‹æ–¯å’Œè¿ªå£«å°¼çš„æœ€æ–°ç”µå½±ä¸­æ‰¾åˆ°è¯æ˜ã€‚

åœ¨åŸºäºç‰©ç†æè´¨ç³»ç»Ÿæ–¹é¢ï¼Œåªæœ‰ 4 ä¸ªæè´¨å‚æ•°éœ€è¦ç†Ÿæ‚‰ï¼Œæ‰€æœ‰è¿™äº›è¾“å…¥éƒ½è®¾è®¡æˆæ¥æ”¶ä»‹äº 0 ä¸ 1 ä¹‹é—´çš„å€¼ï¼š

- åº•è‰²ï¼ˆBase Colorï¼‰
- ç²—ç³™åº¦ï¼ˆRoughnessï¼‰
- é‡‘å±è‰²ï¼ˆMetallicï¼‰
- é«˜å…‰ï¼ˆSpecularï¼‰

åŸºäºç‰©ç†çš„åº•è‰²å€¼å¯ä»¥ä»ç°å®æè´¨ä¸­æµ‹å¾—ï¼Œé‚£ä¹ˆè¿™æ˜¯ä½¿ç”¨åæŒ¯æ»¤å…‰å™¨æ‹æ‘„æ—¶è·å¾—çš„é¢œè‰²ï¼ˆåæŒ¯åœ¨æ ¡å‡†æ—¶ä¼šæ¶ˆé™¤éé‡‘å±æè´¨çš„é•œé¢åå°„ï¼‰ã€‚

å¯¹äºéé‡‘å±æè´¨æµ‹å¾—çš„åº•è‰²å€¼ï¼ˆä»…é™å¼ºåº¦ï¼‰ï¼š

    |    æè´¨    | åº•è‰²å¼ºåº¦ |
    |------------|----------|
    | æœ¨ç‚­       |     0.02 |
    | æ–°é²œæ²¥é’   |     0.02 |
    | è€åŒ–æ²¥é’   |     0.08 |
    | è£¸éœ²åœŸå£¤   |     0.13 |
    | ç»¿è‰²è‰åœ°   |     0.21 |
    | æ²™æ¼ æ²™å­   |     0.36 |
    | æ–°é²œæ··å‡åœŸ |     0.51 |
    | æµ·å†°       |     0.56 |
    | æ–°é²œé›ª     |     0.81 |

é’ˆå¯¹é‡‘å±æµ‹å¾—çš„åº•è‰²ï¼š

    | æè´¨ |     åº•è‰² (R, G, B)    |
    |------|-----------------------|
    | é“   | (0.560, 0.570, 0.580) |
    | é“¶   | (0.972, 0.960, 0.915) |
    | é“   | (0.913, 0.921, 0.925) |
    | é‡‘   | (1.000, 0.766, 0.336) |
    | é“œ   | (0.955, 0.637, 0.538) |
    | é“¬   | (0.550, 0.556, 0.554) |
    | é•   | (0.660, 0.609, 0.526) |
    | é’›   | (0.542, 0.497, 0.449) |
    | é’´   | (0.662, 0.655, 0.634) |
    | é“‚   | (0.672, 0.637, 0.585) |

é‡‘å±è‰²ï¼ˆ`Metallic`ï¼‰è¾“å…¥æ§åˆ¶è¡¨é¢åœ¨å¤šå¤§ç¨‹åº¦ä¸Š"åƒé‡‘å±"ã€‚éé‡‘å±çš„é‡‘å±è‰²å€¼ä¸º 0ï¼Œ é‡‘å±çš„é‡‘å±è‰²å€¼ä¸º 1ã€‚å¯¹äºçº¯è¡¨é¢ï¼Œä¾‹å¦‚çº¯é‡‘å±ã€çº¯çŸ³å¤´ã€ çº¯å¡‘æ–™ç­‰ç­‰ï¼Œæ­¤å€¼å°†æ˜¯ 0 æˆ– 1ï¼Œè€Œä¸æ˜¯ä»»ä½•ä»‹äºå®ƒä»¬ä¹‹é—´çš„å€¼ã€‚åˆ›å»ºå—è…èš€ã€è½æ»¡ç°å°˜æˆ–ç”Ÿé”ˆé‡‘å±ä¹‹ç±»çš„æ··åˆè¡¨é¢æ—¶ï¼Œ æ‚¨å¯èƒ½ä¼šå‘ç°éœ€è¦ ä»‹äº 0 ä¸ 1 ä¹‹é—´çš„å€¼ã€‚

åœ¨ç¼–è¾‘éé‡‘å±è¡¨é¢æè´¨æ—¶ï¼Œæ‚¨æœ‰æ—¶å¯èƒ½å¸Œæœ›è°ƒæ•´å®ƒåå°„å…‰çº¿çš„èƒ½åŠ›ï¼Œå°¤å…¶æ˜¯å®ƒçš„ é«˜å…‰ å±æ€§ã€‚ è¦æ›´æ–°æè´¨çš„é«˜å…‰åº¦ï¼Œéœ€è¾“å…¥ä»‹äº 0 æ— åå°„å’Œ 1 å…¨åå°„ä¹‹é—´çš„æ ‡é‡æ•°å€¼ã€‚æ³¨æ„ï¼Œæè´¨çš„é»˜è®¤é«˜å…‰å€¼ä¸º 0.5ã€‚

å¯¹äºæ¼«å°„åº¦éå¸¸å¤§çš„æè´¨ï¼Œæ‚¨å¯èƒ½å€¾å‘äºå°†æ­¤å€¼è®¾ç½®ä¸ºé›¶ã€‚è¯·å¿ä½ï¼Œä¸è¦è¿™æ ·åšï¼æ‰€æœ‰æè´¨ éƒ½å…·æœ‰é•œé¢åå°„ã€‚å¯¹äºæ¼«å°„åº¦éå¸¸å¤§çš„æè´¨ï¼Œæ‚¨çœŸæ­£æƒ³åšçš„æ˜¯ ä½¿å®ƒä»¬ç²—ç³™ã€‚

ç²—ç³™åº¦ï¼ˆ`Roughness`ï¼‰è¾“å…¥æ§åˆ¶æè´¨è¡¨é¢çš„ç²—ç³™æˆ–å¹³æ»‘ç¨‹åº¦ã€‚ä¸å¹³æ»‘çš„æè´¨ç›¸æ¯”ï¼Œç²—ç³™çš„æè´¨å°†å‘æ›´å¤šæ–¹å‘æ•£å°„æ‰€åå°„çš„å…‰çº¿ã€‚ è¿™å†³å®šäº†åå°„çš„æ¨¡ç³Šæˆ–æ¸…æ™°åº¦ï¼ˆæˆ–è€…é•œé¢åå°„é«˜å…‰çš„å¹¿åº¦æˆ–å¯†é›†åº¦ï¼‰ã€‚ ç²—ç³™åº¦ 0ï¼ˆå¹³æ»‘ï¼‰æ˜¯é•œé¢åå°„ï¼Œè€Œç²—ç³™åº¦ 1ï¼ˆç²—ç³™ï¼‰æ˜¯æ¼«å°„ï¼ˆæˆ–æ— å…‰ï¼‰è¡¨é¢ã€‚

ä¸€èˆ¬è€Œè¨€ï¼Œé€šè¿‡ä¿®æ”¹é«˜å…‰ï¼ˆ`Specular`ï¼‰ï¼Œå¯æ·»åŠ è½»å¾®çš„å¸ç€ç°è±¡æˆ–å°æ¯”ä¾‹çš„é®è”½ï¼Œä¾‹å¦‚åœ¨æ³•çº¿è´´å›¾ä¸­è¡¨ç¤ºçš„è£‚ç¼ã€‚æœ‰æ—¶ï¼Œå°†è¿™äº›ç°è±¡ç§°ä¸ºè…”æ´ã€‚ æ¯”ä¾‹è¾ƒå°çš„å‡ ä½•ä½“ï¼Œå°¤å…¶æ˜¯ä»…å­˜åœ¨äºé«˜å¤šè¾¹å½¢ä¸­ä¸”å¹¶å…¥æ³•çº¿è´´å›¾çš„ç»†èŠ‚ï¼Œä¸ä¼šè¢«æ¸²æŸ“å™¨çš„å®æ—¶é˜´å½±æ‹¾å–ã€‚ä¸ºäº†æ•è·è¿™ç§é®è”½ï¼Œæˆ‘ä»¬ç”Ÿæˆè…”æ´è´´å›¾ï¼Œ è¿™é€šå¸¸æ˜¯è¿½è¸ªè·ç¦»éå¸¸çŸ­çš„ AO è´´å›¾ã€‚æ­¤è´´å›¾å…ˆä¹˜ä»¥æœ€ç»ˆçš„åº•è‰²ï¼Œç„¶åè¾“å‡ºå¹¶ä¹˜ä»¥ 0.5ï¼ˆé•œé¢åå°„é»˜è®¤å€¼ï¼‰ä»¥ä½œä¸ºé•œé¢åå°„è¾“å‡ºã€‚ å³ï¼ŒBaseColor = Cavity * OldBaseColorï¼ŒSpecular = Cavity * 0.5ã€‚

å¯¹äºé«˜çº§ä½¿ç”¨ï¼Œè¿™å¯ç”¨æ¥æ§åˆ¶æŠ˜å°„ç‡ (IOR)ã€‚æˆ‘ä»¬å‘ç°å¯¹äº 99% çš„æè´¨ï¼Œè¿™å¹¶éå¿…è¦ã€‚ä»¥ä¸‹æ˜¯åŸºäºå®æµ‹ IOR çš„é•œé¢åå°„å€¼ã€‚

å®æµ‹é•œé¢åå°„å€¼ï¼š

    | æè´¨ | é•œé¢åå°„ |
    |------|----------|
    | ç»ç’ƒ |      0.5 |
    | å¡‘æ–™ |      0.5 |
    | çŸ³è‹± |    0.570 |
    | å†°   |    0.224 |
    | æ°´   |    0.255 |
    | ç‰›å¥¶ |    0.277 |
    | çš®è‚¤ |     0.35 |

åœ¨è™šå¹»å¼•æ“ 4 çš„å½“å‰ç‰ˆæœ¬ä¸­ï¼Œä½¿ç”¨äº†æŠ˜å°„çš„éç‰©ç†æ¨¡å‹åƒç´ æ³•çº¿åç§»ï¼ˆ`Pixel Normal Offset`ï¼‰ã€‚ å†…åµŒä»£ç ä½¿ç”¨ `Index of Refraction` çš„æŠ˜å°„ç‰©ç†æ¨¡å‹ï¼Œä»¥å…‰çº¿åœ¨åª’ä»‹ä¹‹é—´çš„æŠ˜å°„æ–¹å¼ä¸ºåŸºç¡€ï¼Œå¯èƒ½å¯¼è‡´å¤§é‡ç©¿å¸®ï¼ˆå› ä¸ºåœºæ™¯é¢œè‰²åœ¨å±å¹•å¤–è¯»å–ï¼‰ã€‚ å¯ç”¨äºç»ç’ƒç½ä¹‹ç±»çš„å°å‹ç‰©ä½“ï¼ˆæ•ˆæœä¸ç”šæ˜æ˜¾ï¼‰ï¼Œä½†åœ¨å¹³é¢ä¸Šå­˜åœ¨é—®é¢˜ã€‚

åƒç´ æ³•çº¿åç§»å¯ä¸ºæ°´é¢ä¹‹ç±»çš„å¤§å‹å¹³é¢å¯ç”¨æŠ˜å°„ï¼Œæ­¤å¤„å¸¸é‡åç§»ä¸ä¼šä»è¿œç¦»å±å¹•ä¹‹å¤–ä¹‹å¤„è¿›è¡Œè¯»å–ã€‚å®ƒä»¥é¡¶ç‚¹æ³•çº¿ä½œä¸ºå‚è€ƒï¼Œç„¶åé€šè¿‡é€åƒç´ æ³•çº¿å’Œé¡¶ç‚¹æ³•çº¿ä¹‹é—´çš„å·®åˆ«è®¡ç®—æŠ˜å°„åç§»ï¼Œä½¿è¿™äº›å¹³é¢ä¸ä¼šç§»ä½ã€‚

Index of Refraction æ— éœ€æ³•çº¿è´´å›¾æ’å…¥æè´¨å³å¯ä½¿ç”¨ï¼›è€Œ Pixel Normal Offset æ²¡æœ‰æ³•çº¿è´´å›¾åˆ™æ— æ³•è·å¾—æŠ˜å°„ã€‚



### âœ’ Material Editor
- https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/Materials/Editor/
- https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/Materials/HowTo/BumpOffset/
- GAMES101: ç°ä»£è®¡ç®—æœºå›¾å½¢å­¦å…¥é—¨ https://sites.cs.ucsb.edu/~lingqi/teaching/games101.html
- Grant Sanderson - 3blue1brown çº¿æ€§ä»£æ•°çš„æœ¬è´¨ https://www.bilibili.com/video/BV1ys411472E
- MIT 18.06 Linear Algebra https://mitmath.github.io/1806/
- éº»çœç†å·¥ - çº¿æ€§ä»£æ•° å…¨34è®² https://www.bilibili.com/video/BV1ix411f7Yp/
- https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/Materials/HowTo/BumpOffset/

æè´¨ç¼–è¾‘å™¨ï¼ˆMaterial Editorï¼‰ æ˜¯ä¸€ä¸ªåŸºäºèŠ‚ç‚¹çš„å›¾å½¢ç•Œé¢ï¼Œå®ƒå…è®¸ä½ åˆ›å»ºç€è‰²å™¨ï¼Œè¿™äº›ç€è‰²å™¨å¯ä»¥åº”ç”¨åˆ°ä½ çš„å‡ ä½•ä½“ï¼Œæ¯”å¦‚é™æ€å’Œéª¨æ¶ç½‘æ ¼ä½“ï¼Œæˆ–è€…ä¸å…¶ä»–ç³»ç»Ÿä¸€åŒä½¿ç”¨ï¼ˆæ¯”å¦‚çº§è”ï¼‰ ä»¥åˆ›å»ºæœ‰è¶£çš„æè´¨ã€‚

å¯ä»¥é€šè¿‡åŒå‡»ä»»ä½•æè´¨èµ„æºï¼Œæˆ–é€šè¿‡å†…å®¹æµè§ˆå™¨ä¸­çš„å³é”®ä¸Šä¸‹æ–‡èœå•æ‰“å¼€æè´¨ç¼–è¾‘å™¨ã€‚

æ¯ä¸ªæè´¨èŠ‚ç‚¹åŒ…å«ä¸€ä¸ªæè¿°ï¼ˆDescï¼‰å±æ€§ï¼Œç”¨äºæè¿°æŸä¸ªç‰¹å®šèŠ‚ç‚¹çš„ä½œç”¨ï¼Œè¯¥å±æ€§å¯é€šè¿‡å…¶ Details é¢æ¿è®¾ç½®ã€‚å½“é¼ æ ‡æ‚¬åœåœ¨èŠ‚ç‚¹ä¸Šï¼ŒDesc æ–‡æœ¬å°†æ˜¾ç¤ºåœ¨æ–‡æœ¬æ°”æ³¡ä¸­ã€‚

ä¹Ÿå¯ä»¥åˆ›å»ºæ³¨é‡Šæ¡†ï¼Œå½“é¼ æ ‡åœ¨æè´¨å›¾è¡¨ä¸Šæ—¶ï¼ŒæŒ‰ C é”®ç›˜å¿«æ·é”®ã€‚å¦‚æœåœ¨å›¾è¡¨ä¸­é€‰æ‹©äº†ä»»ä½•èŠ‚ç‚¹ï¼Œåˆ™æ³¨é‡Šæ¡†å°†ç¼©æ”¾ä»¥åŒ…å«æ‰€é€‰èŠ‚ç‚¹ã€‚ä½¿ç”¨æè´¨å›¾è¡¨ä¸Šä¸‹æ–‡èœå•é€‰æ‹©ï¼ˆNew Commentï¼‰ä¹Ÿå¯ä»¥åŠ ä¸€ä¸ªæ³¨é‡Šæ¡†ã€‚

å¯ä»¥è°ƒæ•´æ³¨é‡Šæ¡†çš„é¢œè‰²ï¼Œä½¿å…¶æ›´ç›´è§‚ã€‚è®¾ç½® Details -> Comment Color å±æ€§ï¼Œä½¿ç”¨è‰²è½®é€‰æ‹©é¢œè‰²æˆ–è¾“å…¥ç‰¹å®šçš„ RGB å€¼ã€‚

åœ¨å¯¹ç½‘ç»œè¿›è¡Œæ›´æ”¹æ—¶ï¼Œå®æ—¶ä»æ¯æ¬¡æ›´æ”¹ä¸­è·å¾—å³æ—¶åé¦ˆæ˜¯å¾ˆæœ‰ç”¨çš„ã€‚

å®æ—¶é¢„è§ˆï¼ˆ`Live Preview`ï¼‰- æ­¤é€‰é¡¹å…è®¸ä»»ä½•æ›´æ”¹åœ¨æè´¨é¢„è§ˆï¼ˆMaterial Previewï¼‰çª—å£ä¸­è‡ªåŠ¨å®æ—¶æ›´æ–°ï¼Œè€Œæ— éœ€ä½¿ç”¨ ä¿å­˜ï¼ˆSaveï¼‰ æˆ– åº”ç”¨ï¼ˆApplyï¼‰ æŒ‰é’®ã€‚

å®æ—¶èŠ‚ç‚¹ï¼ˆ`Live Node`ï¼‰- æ­¤é€‰é¡¹å…è®¸èŠ‚ç‚¹æ‰€åšçš„ä»»ä½•å¸¸é‡æ›´æ”¹ï¼Œä¾‹å¦‚ç”¨äºå¹³ç§»å™¨çš„æè´¨è¡¨è¾¾å¼ï¼Œä»¥ä¾¿å®ƒä»¬åœ¨å›¾è¡¨ä¸­å®æ—¶å›æ”¾ã€‚

å®æ—¶æ›´æ–°ï¼ˆ`Live Update`ï¼‰- æ­¤é€‰é¡¹å…è®¸ç½‘ç»œä¸­çš„æ¯ä¸ªèŠ‚ç‚¹åœ¨è¿›è¡Œæ›´æ”¹æ—¶é‡æ–°ç¼–è¯‘å…¶ç€è‰²å™¨ã€‚è¿™äº›æ›´æ”¹åŒ…æ‹¬æ–°èŠ‚ç‚¹çš„åˆ›å»ºã€èŠ‚ç‚¹çš„åˆ é™¤ã€èŠ‚ç‚¹è¿æ¥å’Œæ–­å¼€ä»¥åŠå±æ€§çš„æ›´æ”¹ã€‚è¿™ç§é‡æ–°ç¼–è¯‘æ˜¯å¿…è¦çš„ï¼Œä»¥ä¾¿åœ¨è¯¥èŠ‚ç‚¹ç»˜åˆ¶çš„æè´¨é¢„è§ˆä¿æŒä¸ºæœ€æ–°ã€‚ç„¶è€Œï¼Œé‡æ–°ç¼–è¯‘è¿™äº›ä¸­é—´ç€è‰²å™¨å¯èƒ½å¾ˆè€—æ—¶ï¼Œå°¤å…¶æ˜¯å½“ä½ çš„æè´¨åŒ…å«è¾ƒå¤§çš„ç½‘ç»œæ—¶ã€‚å¦‚æœæ¯æ¬¡æ›´æ”¹ä¹‹åéƒ½ä¼šç»å†é•¿æ—¶é—´çš„ç­‰å¾…ï¼Œé‚£ä¹ˆä½ å¯èƒ½éœ€è¦åœç”¨å®æ—¶æ›´æ–°ï¼ˆLive Updateï¼‰é€‰é¡¹ã€‚

å½“åˆ¶ä½œå¤æ‚çš„æè´¨æ—¶ï¼Œæœ‰æ—¶ä½ çš„ç€è‰²å™¨ç½‘ç»œä¼šå˜å¾—éš¾ä»¥è¯»å–æˆ–ç†è§£ï¼Œå› ä¸ºè¿æ¥çº¿ä¼šä¸ä½ çš„æè´¨ç½‘ç»œçš„å¤§éƒ¨åˆ†é‡å æˆ–äº¤å‰ï¼Œä»¥è¿æ¥ä¸åŒçš„è¾“å…¥ã€‚å˜æ›´è·¯çº¿ èŠ‚ç‚¹ä½¿ä½ èƒ½å¤Ÿè½»æ¾åœ°ç»„ç»‡å’Œæ¸…ç†ç€è‰²å™¨ç½‘ç»œï¼Œè€Œä¸å½±å“æ€§èƒ½æˆ–æ·»åŠ åˆ°æŒ‡ä»¤è®¡æ•°ï¼Œå› ä¸ºè¿™äº›éƒ½æ˜¯çº¯å¯è§†åŒ–çš„ã€‚ä»å³é”®ä¸Šä¸‹æ–‡èœå•ä¸­æˆ–å®ç”¨å·¥å…· Utility -> Material Palette ä¸­ï¼Œä½ å¯ä»¥æ‹–å…¥æ·»åŠ å˜æ›´è·¯çº¿èŠ‚ç‚¹ï¼ˆ`Reroute Node`ï¼‰ã€‚

å¯ä»¥ä½¿ç”¨çƒ­é”®æ¥æ”¾ç½®å¸¸ç”¨çš„æè´¨è¡¨è¾¾å¼èŠ‚ç‚¹ï¼ŒæŒ‰ä½ä»¥ä¸‹çƒ­é”®å¹¶ç‚¹å‡»å·¦é”®æ”¾ç½®èŠ‚ç‚¹ï¼š

- B `BumpOffset` å‡¹å‡¸åç§»è´´å›¾ï¼Œä¸€ç§ä½æˆæœ¬çš„æ³•çº¿è´´å›¾æ›¿ä»£æ–¹æ³•ï¼Œåˆ©ç”¨ UV åæ ‡æ¥è®©çº¹ç†äº§ç”Ÿå‡¹å‡¸è§†æ„Ÿã€‚
- C `Comment` æ³¨è§£æ¡†ã€‚
- A `Add` åŠ æ³•èŠ‚ç‚¹ã€‚
- D `Divide` é™¤æ³•èŠ‚ç‚¹ã€‚
- E `Power` ä¹˜æ–¹èŠ‚ç‚¹ã€‚
- M `Multiply` ä¹˜æ³•èŠ‚ç‚¹ã€‚
- F `MaterialFunctionCall` æè´¨å‡½æ•°è°ƒç”¨èŠ‚ç‚¹ï¼Œåœ¨å†…å®¹æµè§ˆå™¨èœå• Materials & Textures åˆ›å»ºæè´¨å‡½æ•°ï¼Œå®ƒç”¨äºç»„ç»‡éœ€è¦é‡å¤ä½¿ç”¨çš„æè´¨èŠ‚ç‚¹ç¼–æ’ã€‚
- I `If` æ¡ä»¶é€‰æ‹©èŠ‚ç‚¹ï¼Œæ¯”è¾ƒ A å’Œ B çš„å€¼ï¼Œå†æ ¹æ®ç»“æ„è¾“å‡ºå…¶å®ƒä¸‰ä¸ªè¾“å…¥å€¼ã€‚
- L `LinearInterpolate` çº¿æ€§æ’å€¼èŠ‚ç‚¹ Lerpã€‚
- N `Normalize` å½’ä¸€åŒ–å‘é‡ï¼Œè¿”å›æ–¹å‘ç›¸åŒä½†é•¿åº¦ä¸º 1 çš„å‘é‡å³å•ä½å‘é‡ã€‚å¦‚æœå‘é‡å¤ªå°è€Œä¸èƒ½è¢«å½’ä¸€åŒ–ï¼Œåˆ™è¿”å›ä¸€ä¸ªé›¶å‘é‡ã€‚
- O `OneMinus` æ±‚è¡¥ï¼Œç”¨ 1 å‡å» 0 ~ 1 çš„å€¼ã€‚
- P `Panner` å¹³ç§»å™¨èŠ‚ç‚¹ï¼Œç”Ÿæˆéšæ—¶é—´å¹³ç¨³çš„åæ ‡ã€‚
- R `ReflectionVector` 
- T `TextureSample` çº¹ç†é‡‡æ ·ã€‚
- U `TexCoord` çº¹ç†åæ ‡
- S `ScalarParameter` ä¸€ç»´å‚æ•°ï¼Œåœ¨æè´¨ä¸­å¼•å…¥å‚æ•°ï¼Œå¯ä»¥ç”±æè´¨å®ä¾‹ä¼ å…¥ã€‚
- V `VectorParameter` å››ç»´å‚æ•°ï¼Œåœ¨æè´¨ä¸­å¼•å…¥å‚æ•°ï¼Œå¯ä»¥ç”±æè´¨å®ä¾‹ä¼ å…¥ã€‚
- 1 `Constant` ä¸€ç»´å¸¸é‡ã€‚
- 2 `Constant2Vector` äºŒç»´å¸¸é‡ã€‚
- 3 `Constant3Vector` ä¸‰ç»´å¸¸é‡ã€‚
- 4 `Constant4Vector` å››ç»´å¸¸é‡ã€‚
- Shift + C `ComponentMask` åˆ†é‡é®ç½©ã€‚

å…¶å®ƒå¸¸ç”¨èŠ‚ç‚¹ï¼š

- `CrossProduct` å‰ç§¯å³çŸ¢é‡ç§¯ï¼Œè¡¨è¾¾å¼è®¡ç®—ä¸¤ä¸ªä¸‰é€šé“çŸ¢é‡å€¼ï¼Œå¹¶è¾“å‡ºæ‰€äº§ç”Ÿçš„ä¸‰é€šé“çŸ¢é‡å€¼ã€‚ç»™å®šç©ºé—´ä¸­çš„ä¸¤ä¸ªçŸ¢é‡ï¼ŒçŸ¢é‡ç§¯æ˜¯ä¸ä¸¤ä¸ªè¾“å…¥éƒ½å‚ç›´çš„çŸ¢é‡ã€‚
- `DotProduct` å‘é‡ç‚¹ç§¯è¡¨ç¤ºæ ‡é‡ç§¯ï¼Œå³ä¸€ä¸ªçŸ¢é‡æŠ•å°„åˆ°å¦ä¸€ä¸ªçŸ¢é‡ä¸Šçš„é•¿åº¦ã€‚è®¸å¤šæŠ€æœ¯ä½¿ç”¨æ­¤è®¡ç®—æ¥è®¡ç®—è¡°å‡ã€‚ç‚¹ç§¯è¦æ±‚ä¸¤ä¸ªçŸ¢é‡è¾“å…¥å…·æœ‰ç›¸åŒæ•°ç›®çš„é€šé“ã€‚
- `Rotater` å¹³ç§»å™¨èŠ‚ç‚¹ï¼Œç”Ÿæˆéšæ—¶é—´å¹³ç¨³çš„åæ ‡ã€‚
- `Abs`ï¼ˆç»å¯¹å€¼ï¼‰
- `AppendVector`ï¼ˆè¿½åŠ çŸ¢é‡ï¼‰
- `Clamp`ï¼ˆé’³åˆ¶ï¼Œå°†è¾“å…¥å€¼é™åˆ¶åœ¨ä¸¤ä¸ªå€¼ä¹‹é—´ï¼‰
- `Cosine`ï¼ˆä½™å¼¦ï¼‰
- `Ceil`ï¼ˆå‘ä¸Šå–æ•´ï¼Œå°æ•°éƒ¨åˆ†ä¸ä¸º 0 åˆ™åŠ ä¸€ï¼‰
- `Floor`ï¼ˆå‘ä¸‹å–æ•´ï¼Œæˆªæ‰å°æ•°éƒ¨åˆ†ï¼‰
- `FMod`ï¼ˆæµ®ç‚¹ä½™æ•°ï¼Œå¯¹ä¸¤ä¸ªè¾“å…¥æ‰§è¡Œé™¤æ³•è¿ç®—å¹¶è¿”å›æµ®ç‚¹ä½™æ•°ã€‚ï¼‰
- `Frac`ï¼ˆå°æ•°ï¼‰
- `Max`ï¼ˆæœ€å¤§å€¼ï¼‰
- `Min`ï¼ˆæœ€å°å€¼ï¼‰
- `Sine`ï¼ˆæ­£å¼¦ï¼‰
- `SquareRoot`ï¼ˆå¹³æ–¹æ ¹ï¼‰
- `Subtract`ï¼ˆå‡ï¼‰
- `Fresnel`ï¼ˆè²æ¶…å°”æ•ˆåº”ï¼‰

ç‚¹ä¹˜ï¼ˆDot Productï¼‰çš„ç»“æœæ˜¯æ•°é‡ç§¯æˆ–æ ‡é‡ç§¯ï¼ˆScalar Productï¼‰ã€‚ä»å‡ ä½•è§’åº¦çœ‹ï¼Œç‚¹ç§¯æ˜¯ä¸¤ä¸ªå‘é‡çš„é•¿åº¦ä¸å®ƒä»¬å¤¹è§’ä½™å¼¦çš„ç§¯ï¼Œå³ *aï¹¡b* è¡¨ç¤º *b* åœ¨ *a* ä¸Šçš„æŠ•å½±ã€‚

æ ¹æ®ä½™å¼¦å®šç†ï¼Œå‘é‡ç‚¹ç§¯å®šä¹‰å¦‚ä¸‹ï¼Œæ³¨æ„ä¸¤ç«–è¡¨ç¤ºå‘é‡çš„æ¨¡ï¼š

    aÂ·b = |a|Ã—|b|cosÎ¸

åˆ¤æ–­è¿™ä¸¤ä¸ªå‘é‡æ˜¯å¦æ˜¯åŒä¸€æ–¹å‘ï¼Œæ˜¯å¦æ­£äº¤(ä¹Ÿå°±æ˜¯å‚ç›´)ç­‰æ–¹å‘å…³ç³»ï¼Œå…·ä½“å¯¹åº”å…³ç³»ä¸ºï¼š

- aÂ·b > 0 å¤¹è§’åœ¨ 0Â° ~ 90Â° ä¹‹é—´ï¼›
- aÂ·b = 0 æ­£äº¤ï¼Œç›¸äº’å‚ç›´ï¼›
- aÂ·b < 0 æ–¹å‘åŸºæœ¬ç›¸åï¼Œå¤¹è§’åœ¨ 90Â° ~ 180Â° ä¹‹é—´ï¼›

å‰ä¹˜ï¼ˆCross Productï¼‰åˆç§°å‘é‡ç§¯ï¼ˆVector Productï¼‰ã€‚å‡ ä½•æ„ä¹‰ä¸Šï¼Œåœ¨ç©ºé—´ä¸­æœ‰ä¸¤ä¸ªå‘é‡å‰ç§¯è¿ç®—ç»“æœæ˜¯ä¸€ä¸ªå‘é‡ï¼Œå¹¶ä¸”ä¸è¿™ä¸¤ä¸ªå‘é‡éƒ½å‚ç›´ï¼Œæ˜¯è¿™ä¸¤ä¸ªå‘é‡æ‰€åœ¨å¹³é¢çš„æ³•çº¿å‘é‡ã€‚ä½¿ç”¨å³æ‰‹å®šåˆ™ç¡®å®šå…¶æ–¹å‘ï¼Œé£ŸæŒ‡ä¸º *a* æŒ‡å‘æ­£å‰æ–¹ï¼Œä¸­æŒ‡ä¸º *b* æŒ‡å¦ä¸€ä¸ªè§’åº¦ï¼Œæ‹‡æŒ‡ä¸º *aÃ—b* å¹¶ä¸”ä¸ a å’Œ *b* çš„æ–¹å‘éƒ½å‚ç›´ã€‚è®¡ç®—æœºå›¾å½¢å­¦ä¸­ï¼Œå‰ç§¯å¸¸ç”¨äºåˆ¤æ–­ä¸€ä¸ªç‰©ä½“æ˜¯å¦åœ¨å¦å¤–ä¸€ä¸ªç‰©ä½“çš„å·¦ä¾§æˆ–å³ä¾§ã€‚

å¦‚æœä»¥å‘é‡ *a* å’Œ *b* ä¸ºè¾¹æ„æˆä¸€ä¸ªå¹³è¡Œå››è¾¹å½¢ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå‘é‡å¤–ç§¯çš„æ¨¡é•¿ä¸è¿™ä¸ªå¹³è¡Œå››è¾¹å½¢çš„é¢ç§¯ç›¸ç­‰ã€‚



### âœ’ Materials æè´¨æ“ä½œæŒ‡å—
- æè´¨æ“ä½œæŒ‡å— https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/Materials/HowTo
- æè´¨è¡¨è¾¾å¼å‚è€ƒ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/Materials/ExpressionReference/
- æè´¨å‡½æ•°å‚è€ƒ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/Materials/Functions/
- UE4 ç§¯é›ªæ•ˆæœ(VertexNormalWS) https://www.bilibili.com/read/cv14053897
- äº’åŠ¨é›ªåœ°æè´¨ https://www.bilibili.com/video/BV1wt411m7L7
- æ·±åº¦è¡¨è¾¾å¼ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/Materials/ExpressionReference/Depth
- åœ°å½¢è¡¨è¾¾å¼ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/Materials/ExpressionReference/Landscape/
- æè´¨å›¾å±‚ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/Materials/MaterialLayers/

æè´¨ä¸­å¯ä»¥ä½¿ç”¨çš„å„ç§è¾“å…¥æ•°æ®è¡¨è¾¾å¼å‚è€ƒï¼š

å„ç§æ·±åº¦è¡¨è¾¾å¼ï¼Œå¤„ç†æ‰€æ¸²æŸ“åƒç´ çš„æ·±åº¦çš„è¡¨è¾¾å¼ï¼š

- `DepthFade`ï¼ˆæ·±åº¦æ¶ˆé€€ï¼‰è¡¨è¾¾å¼ç”¨æ¥éšè—åŠé€æ˜å¯¹è±¡ä¸ä¸é€æ˜å¯¹è±¡ç›¸äº¤æ—¶å‡ºç°çš„ä¸ç¾è§‚æ¥ç¼ã€‚
- `SceneDepth`ï¼ˆåœºæ™¯æ·±åº¦ï¼‰è¡¨è¾¾å¼è¾“å‡ºç°æœ‰çš„åœºæ™¯æ·±åº¦ã€‚è¿™ç±»ä¼¼äº PixelDepthï¼Œä½†æ˜¯å®ƒåªèƒ½åœ¨å½“å‰æ‰€ç»˜åˆ¶åƒç´ å¤„è¿›è¡Œæ·±åº¦å–æ ·ï¼Œè€Œåœºæ™¯æ·±åº¦å¯ä»¥åœ¨ä»»ä½•ä½ç½®è¿›è¡Œæ·±åº¦å–æ ·ã€‚
- `PixelDepth`ï¼ˆåƒç´ æ·±åº¦ï¼‰è¡¨è¾¾å¼è¾“å‡ºå½“å‰æ‰€æ¸²æŸ“åƒç´ çš„æ·±åº¦ï¼Œå³è¯¥åƒç´ ä¸æ‘„åƒæœºä¹‹é—´çš„è·ç¦»ã€‚

å„ç§çŸ¢é‡è¡¨è¾¾å¼ï¼Œè¾“å‡ºä½ç½®ã€æ³•çº¿ç­‰çŸ¢é‡å€¼çš„è¡¨è¾¾å¼ï¼š

- CameraVectorWS è¡¨è¾¾å¼è¾“å‡ºä¸€ä¸ªä¸‰ä¿¡é“çŸ¢é‡å€¼ï¼Œè¯¥å€¼è¡¨ç¤ºæ‘„åƒæœºç›¸å¯¹äºè¡¨é¢çš„æ–¹å‘ï¼Œå³åƒç´ åˆ°æ‘„åƒæœºçš„æ–¹å‘ã€‚é€šå¸¸é€šè¿‡ ComponentMask ä½¿ç”¨ CameraVector çš„ x å’Œ y ä¿¡é“ä½œä¸ºçº¹ç†åæ ‡ï¼Œæ¥ç”¨äºè™šè®¾ç¯å¢ƒè´´å›¾ã€‚
- Object Bounds å¯¹è±¡è¾¹ç•Œè¡¨è¾¾å¼è¾“å‡ºå¯¹è±¡åœ¨æ¯ä¸ªè½´ä¸­çš„å¤§å°ã€‚
- Vector Noise Material çŸ¢é‡å™ªç‚¹æè´¨è¡¨è¾¾å¼æ·»åŠ äº†æ›´å¤šçš„ä¸‰ç»´æˆ–å››ç»´çŸ¢é‡å™ªç‚¹ç»“æœä»¥åœ¨æè´¨ä¸­ä½¿ç”¨ã€‚
- PixelNormalWS è¡¨è¾¾å¼æ ¹æ®å½“å‰æ³•çº¿è¾“å‡ºçŸ¢é‡æ•°æ®ï¼Œè¯¥æ•°æ®è¡¨ç¤ºåƒç´ æ‰€é¢å¯¹çš„æ–¹å‘ã€‚
- ReflectionVectorWS è¡¨è¾¾å¼åœ¨æœ¬è´¨ä¸Šç±»ä¼¼äº CameraVectorWSï¼Œä½†å®ƒè¾“å‡ºä¸€ä¸ªä¸‰ä¿¡é“çŸ¢é‡å€¼ï¼Œè¯¥å€¼è¡¨ç¤ºé€šè¿‡è¡¨é¢æ³•çº¿åå°„çš„æ‘„åƒæœºæ–¹å‘ã€‚ReflectionVector é€šå¸¸ç”¨äºç¯å¢ƒè´´å›¾ï¼Œå…¶ä¸­åå°„çŸ¢é‡çš„ x/y åˆ†é‡è¢«ç”¨ä½œ UV è¾“å…¥ç«‹æ–¹ä½“è´´å›¾çº¹ç†ã€‚
- VertexNormalWS è¡¨è¾¾å¼è¾“å‡ºä¸–ç•Œåœºæ™¯ç©ºé—´é¡¶ç‚¹æ³•çº¿ã€‚

å„ç§çŸ¢é‡åæ ‡è¡¨è¾¾å¼ï¼š

- `ActorPositionWS` è¾“å‡ºçŸ¢é‡(RGB)æ•°æ®ï¼Œè¯¥æ•°æ®è¡¨ç¤ºå¯¹è±¡åœ¨ä¸–ç•Œåœºæ™¯ç©ºé—´ä¸­çš„ä½ç½®ä»¥åŠå…¶ä¸Šçš„æè´¨ã€‚
- `CameraWorldPosition` è¡¨è¾¾å¼è¾“å‡ºä¸‰ä¿¡é“çŸ¢é‡å€¼ï¼Œè¯¥å€¼è¡¨ç¤ºæ‘„åƒæœºåœ¨ä¸–ç•Œåœºæ™¯ç©ºé—´ä¸­çš„ä½ç½®ã€‚
- `LightmapUVs`ï¼ˆå…‰ç…§è´´å›¾ UVï¼‰è¡¨è¾¾å¼ä»¥åŒé€šé“çŸ¢é‡å€¼å½¢å¼è¾“å‡ºå…‰ç…§è´´å›¾ UV çº¹ç†åæ ‡ã€‚å¦‚æœæ— æ³•è·å¾—å…‰ç…§è´´å›¾ UVï¼Œé‚£ä¹ˆå°†è¾“å‡ºåŒé€šé“çŸ¢é‡å€¼ (0,0)ã€‚
- `ObjectPositionWS` è¡¨è¾¾å¼è¾“å‡ºå¯¹è±¡è¾¹ç•Œçš„ä¸–ç•Œåœºæ™¯ç©ºé—´ä¸­å¿ƒä½ç½®ã€‚ä¾‹å¦‚ï¼Œè¿™å¯¹äºä¸ºæ¤ç‰©åˆ›å»ºçƒå½¢ç…§æ˜å¾ˆæœ‰ç”¨ã€‚
- `ObjectOrientation` è¡¨è¾¾å¼è¾“å‡ºå¯¹è±¡çš„ä¸–ç•Œåœºæ™¯å‘ä¸ŠçŸ¢é‡ã€‚æ¢è¨€ä¹‹ï¼Œå¯¹è±¡çš„å±€éƒ¨æ­£ z è½´æ­£æŒ‡å‘æ­¤æ–¹å‘ã€‚
- `ObjectRadius`ï¼ˆå¯¹è±¡åŠå¾„ï¼‰è¾“å‡ºç»™å®šå¯¹è±¡ä»¥ Unreal å•ä½è®¡çš„åŠå¾„å€¼ã€‚ç³»ç»Ÿä¼šå¯¹æ¯”ä¾‹ç¼©æ”¾åŠ ä»¥è€ƒè™‘ï¼Œå¹¶ä¸”å¯¹äºæ¯ä¸ªå¯¹è±¡ï¼Œç»“æœå¯èƒ½æ˜¯å”¯ä¸€çš„ã€‚
- `ParticlePositionWS` ç²’å­ä½ç½®è¡¨è¾¾å¼è¾“å‡ºä»£è¡¨ä¸–ç•Œåœºæ™¯ç©ºé—´ä¸­æ¯ä¸ªå•ç‹¬ç²’å­ä½ç½®çš„ Vector3(RGB) æ•°æ®ã€‚
- `Panner`ï¼ˆå¹³ç§»ï¼‰è¡¨è¾¾å¼è¾“å‡ºå¯ç”¨äºåˆ›å»ºå¹³ç§»ï¼ˆæˆ–ç§»åŠ¨ï¼‰çº¹ç†çš„ UV çº¹ç†åæ ‡ã€‚
- `Rotator`ï¼ˆæ—‹è½¬ï¼‰è¡¨è¾¾å¼ä»¥åŒé€šé“çŸ¢é‡å€¼å½¢å¼è¾“å‡º UV çº¹ç†åæ ‡ï¼Œè¯¥çŸ¢é‡å€¼å¯ç”¨æ¥åˆ›å»ºæ—‹è½¬çº¹ç†ã€‚
- `SceneTexelSize`ï¼ˆåœºæ™¯çº¹ç´ å¤§å°ï¼‰è¡¨è¾¾å¼å…è®¸æŒ‰çº¹ç´ å¤§å°è¿›è¡Œåç§»ï¼Œæ­£å¦‚æ‚¨ä½¿ç”¨ SceneColorï¼ˆåœºæ™¯é¢œè‰²ï¼‰å’Œ SceneDepthï¼ˆåœºæ™¯æ·±åº¦ï¼‰è¡¨è¾¾å¼æ—¶æ‰§è¡Œçš„åç§»æ“ä½œã€‚
- `ScreenPosition`ï¼ˆå±å¹•ä½ç½®ï¼‰è¡¨è¾¾å¼è¾“å‡ºå½“å‰æ‰€æ¸²æŸ“åƒç´ çš„å±å¹•ç©ºé—´ä½ç½®ã€‚
- `TextureCoordinate`ï¼ˆçº¹ç†åæ ‡ï¼‰è¡¨è¾¾å¼ä»¥åŒé€šé“çŸ¢é‡å€¼å½¢å¼è¾“å‡º UV çº¹ç†åæ ‡ï¼Œä»è€Œå…è®¸æè´¨ä½¿ç”¨ä¸åŒçš„ UV é€šé“ã€æŒ‡å®šå¹³é“ºä»¥åŠä»¥å…¶ä»–æ–¹å¼å¯¹ç½‘æ ¼çš„ UV æ‰§è¡Œæ“ä½œã€‚
- `ViewSize`ï¼ˆè§†å›¾å¤§å°ï¼‰è¡¨è¾¾å¼è¾“å‡ºä¸€ä¸ª 2D çŸ¢é‡ï¼Œä»¥ç»™å‡ºå½“å‰è§†å›¾çš„å¤§å°ï¼ˆä»¥åƒç´ ä¸ºå•ä½ï¼‰ã€‚è¿™å¯¹äºä½¿æè´¨æ ¹æ®å½“å‰å±å¹•åˆ†è¾¨ç‡äº§ç”Ÿå„ç§å˜åŒ–æ¥è¯´éå¸¸æœ‰ç”¨ã€‚
- `WorldPosition`ï¼ˆå…¨å±€ä½ç½®ï¼‰è¡¨è¾¾å¼è¾“å‡ºå½“å‰åƒç´ åœ¨å…¨å±€ç©ºé—´ä¸­çš„ä½ç½®ã€‚è¦å®ç°å¯è§†åŒ–ï¼Œåªéœ€å°†è¾“å‡ºè¿æ¥åˆ°"è‡ªå‘å…‰"ï¼ˆEmissiveï¼‰ï¼š

å„ç§çŸ¢é‡æ“ä½œè¡¨è¾¾å¼ï¼š

- `AppendVector`ï¼ˆè¿½åŠ çŸ¢é‡ï¼‰è¡¨è¾¾å¼å…è®¸æ‚¨å°†é€šé“ç»„åˆåœ¨ä¸€èµ·ï¼Œä»¥åˆ›å»ºé€šé“æ•°æ¯”åŸå§‹çŸ¢é‡æ›´å¤šçš„çŸ¢é‡ã€‚
- `ComponentMask`ï¼ˆåˆ†é‡è’™ç‰ˆï¼‰è¡¨è¾¾å¼å…è®¸ä»è¾“å…¥ä¸­é€‰æ‹©é€šé“ï¼ˆRã€Gã€B å’Œ/æˆ– Aï¼‰çš„ç‰¹å®šå­é›†ä»¥ä¼ é€’åˆ°è¾“å‡ºã€‚
- `CrossProduct` è¡¨è¾¾å¼è®¡ç®—ä¸¤ä¸ªä¸‰é€šé“çŸ¢é‡å€¼è¾“å…¥çš„äº¤å‰ä¹˜ç§¯ï¼Œå¹¶è¾“å‡ºäº§ç”Ÿçš„ä¸‰é€šé“çŸ¢é‡å€¼ã€‚
- `DeriveNormalZ`ï¼ˆæ´¾ç”Ÿæ³•çº¿ Zï¼‰è¡¨è¾¾å¼åœ¨ç»™å®š X å’Œ Y åˆ†é‡çš„æƒ…å†µä¸‹æ´¾ç”Ÿåˆ‡çº¿ç©ºé—´æ³•çº¿çš„ Z åˆ†é‡ï¼Œå¹¶è¾“å‡ºæ‰€äº§ç”Ÿçš„ä¸‰é€šé“åˆ‡çº¿ç©ºé—´æ³•çº¿ã€‚Z è®¡ç®—æ–¹æ³•ä¸ºï¼šZ = sqrt(1 - (x * x + y * y))ï¼›
- `DotProduct` è¡¨è¾¾å¼è®¡ç®—ç‚¹ç§¯ï¼Œç‚¹ç§¯å¯ä»¥æè¿°ä¸ºä¸€ä¸ªçŸ¢é‡æŠ•å½±åˆ°å¦ä¸€ä¸ªçŸ¢é‡ä¸Šçš„é•¿åº¦ï¼Œä¹Ÿå¯ä»¥æè¿°ä¸ºä¸¤ä¸ªçŸ¢é‡ä¹‹é—´çš„ä½™å¼¦ä¹˜ä»¥å®ƒä»¬çš„å¹…å€¼ã€‚è®¸å¤šæŠ€æœ¯ä½¿ç”¨è¿™ç§ç®—æ³•æ¥è®¡ç®—è¡°å‡ã€‚
- `Normalize` è¡¨è¾¾å¼è®¡ç®—å¹¶è¾“å‡ºå…¶è¾“å…¥çš„å½’ä¸€åŒ–å€¼ã€‚å½’ä¸€åŒ–çŸ¢é‡ï¼ˆä¹Ÿç§°"å•ä½çŸ¢é‡"ï¼‰çš„æ•´ä½“é•¿åº¦ä¸º1.0ã€‚è¿™æ„å‘³ç€è¾“å…¥çš„æ¯ä¸ªåˆ†é‡éƒ½é™¤ä»¥çŸ¢é‡çš„æ€»å¤§å°ï¼ˆé•¿åº¦ï¼‰ã€‚
- `Transform`ï¼ˆè½¬æ¢ï¼‰è¡¨è¾¾å¼å°†ä¸‰é€šé“çŸ¢é‡å€¼ä»ä¸€ç§å‚è€ƒåæ ‡ç³»è½¬æ¢åˆ°å¦ä¸€ç§å‚è€ƒåæ ‡ç³»ã€‚
- `TransformPosition`ï¼ˆè½¬æ¢ä½ç½®ï¼‰è¡¨è¾¾å¼å¯å°†å±å¹•ç©ºé—´ä¸­çš„ä»»ä½•ä½ç½®è½¬æ¢åˆ°è¡¨è¾¾å¼çš„ TransformType å˜é‡æ‰€æŒ‡å®šçš„ç›®æ ‡ç©ºé—´ã€‚ç›®å‰åªæ”¯æŒè½¬æ¢åˆ°å…¨å±€ç©ºé—´ã€‚æ­¤è¡¨è¾¾å¼å¯ç”¨æ¥è·å–æè´¨ä¸­çš„å…¨å±€ç©ºé—´åæ ‡ã€‚

å­—ä½“çº¹ç†è¡¨è¾¾å¼ï¼š

- `FontSample`ï¼ˆå­—ä½“å–æ ·ï¼‰è¡¨è¾¾å¼å…è®¸æ‚¨ä»¥å¸¸è§„ 2D çº¹ç†å½¢å¼ï¼Œä»å­—ä½“èµ„æºä¸­å–å¾—çº¹ç†é¡µé¢æ ·æœ¬ã€‚å­—ä½“çš„é˜¿å°”æ³•é€šé“å°†åŒ…å«å­—ä½“è½®å»“å€¼ã€‚æ‚¨åªèƒ½æŒ‡å®šæœ‰æ•ˆçš„å­—ä½“é¡µé¢ã€‚
- `FontSampleParameter`ï¼ˆå­—ä½“å–æ ·å‚æ•°ï¼‰è¡¨è¾¾å¼æä¾›äº†ä¸€ç§åœ¨æè´¨å®ä¾‹å¸¸é‡ä¸­å…¬å¼€åŸºäºå­—ä½“çš„å‚æ•°çš„æ–¹æ³•ï¼Œè¿™ä½¿æ‚¨å¯ä»¥åœ¨ä¸åŒå®ä¾‹ä¸­è½»æ¾ä½¿ç”¨ä¸åŒçš„å­—ä½“ã€‚å­—ä½“çš„é˜¿å°”æ³•é€šé“å°†åŒ…å«å­—ä½“è½®å»“å€¼ã€‚æ‚¨åªèƒ½æŒ‡å®šæœ‰æ•ˆçš„å­—ä½“é¡µé¢ã€‚


å°½ç®¡ä»»æ„æè´¨éƒ½å¯ç”¨äºåœ°å½¢ï¼Œä½†è™šå¹»å¼•æ“ 4 ä¸­çš„æè´¨ç³»ç»ŸåŒæ—¶æä¾›äº†ä¸€äº›ç‰¹å®šçš„åœ°å½¢æè´¨èŠ‚ç‚¹ï¼Œå¯å¸®åŠ©ä¼˜åŒ–åœ°å½¢çº¹ç†ã€‚åœ°å½¢ä½¿ç”¨æƒé‡æ··åˆï¼Œè€Œé Alpha æ··åˆï¼Œå› æ­¤æ‰€æœ‰å±‚åœ¨ä»»ä½•ä½ç½®çš„æ··åˆç³»æ•°æœ€å¤šç´¯ç§¯åˆ° 1.0ã€‚Alpha æ··åˆä¸é¡ºåºæ— å…³ï¼Œå¯éšæ—¶ç»˜åˆ¶ä»»æ„å±‚ï¼Œå› æ­¤ååˆ†æœ‰ç”¨ã€‚æ­¤å¤–ï¼Œåœ¨ä½¿ç”¨ Alpha æ··åˆæ—¶ï¼ŒAlpha å±‚çš„æƒé‡ä¼šå¢åŠ ï¼Œè€Œå…¶ä»–ç°æœ‰å±‚æƒé‡ä¼šå‡å°ã€‚

ä½†æ˜¯ï¼Œä½¿ç”¨ Alpha æ··åˆçš„ä¸€ä¸ªå¼Šç«¯æ˜¯å±‚ç»˜åˆ¶è¾¾ 100% æ—¶ï¼Œæ‰€æœ‰å…¶ä»–å±‚çš„æƒé‡å€¼å°†å˜ä¸º 0%ã€‚æ­¤æƒ…å†µåœ¨ä½¿ç”¨ç»˜åˆ¶å·¥å…·ç§»é™¤å·² 100% çš„å±‚æ—¶ååˆ†æ˜æ˜¾ã€‚ç”±äºå…¶ä»–å±‚ä¸º 0%ï¼Œå·¥å…·æ— æ³•å–ä»£è¦ç§»é™¤çš„ 100% å±‚ï¼Œå› æ­¤å±‚å¥½ä¼¼å¹¶æ— å˜åŒ–ã€‚

åœ¨æè´¨ç¼–è¾‘å™¨ä¸­ï¼Œå¯å‘ç°å…­ä¸ªå¯ç”¨äºåœ°å½¢ç³»ç»Ÿçš„ç‰¹æ®ŠèŠ‚ç‚¹ã€‚å¯åœ¨åœ°å½¢åˆ†ç±»ä¸‹çš„æ§åˆ¶æ¿èœå•ä¸­æ‰¾åˆ°è¿™äº›èŠ‚ç‚¹ï¼š

- åˆ©ç”¨ `LandscapeLayerBlend` èŠ‚ç‚¹å¯æ··åˆå¤šä¸ªçº¹ç†æˆ–æè´¨ç½‘ç»œï¼Œä»¥ä¾¿å°†å…¶ç”¨ä½œåœ°å½¢å±‚ã€‚LandscapeLayerBlend ä½¿ç”¨é˜µåˆ—å­˜å‚¨å…³äºåœ°å½¢å±‚çš„ä¿¡æ¯ã€‚ä½¿ç”¨ Alpha æ··åˆæˆ–å¸¦æœ‰åŸºäºé«˜åº¦åç§»çš„ Alpha æ··åˆæ¥æ··åˆå¤šä¸ªå±‚ã€‚åˆ©ç”¨åŸºäºé«˜åº¦çš„åç§»ï¼Œå±‚å¯æ ¹æ®é«˜åº¦å›¾è¾“å…¥ä¸å…¶ä»–å±‚æ··åˆã€‚
- `LandscapeLayerCoords` èŠ‚ç‚¹ç”ŸæˆUVåæ ‡ï¼Œå¯ç”¨äºå°†æè´¨ç½‘ç»œæ˜ å°„åˆ°åœ°å½¢åœ°è²Œã€‚
- ç‰¹å®šå±‚æœªå¯¹åœ°å½¢åŒºåŸŸè´¡çŒ®æ—¶ï¼Œåˆ©ç”¨ `LandscapeLayerSwitch` èŠ‚ç‚¹å¯æ’é™¤éƒ¨åˆ†æè´¨è¿ç®—ã€‚ç‰¹å®šå±‚æƒé‡ä¸º0æ—¶ï¼Œåˆ©ç”¨æ­¤æ“ä½œå¯é€šè¿‡ç§»é™¤ä¸å¿…è¦çš„è®¡ç®—ä¼˜åŒ–æè´¨ã€‚
- åˆ©ç”¨ `LandscapeLayerWeight` è¡¨è¾¾å¼å¯æ ¹æ®åœ°å½¢æè´¨ä¸­è·å–çš„å…³è”å±‚æƒé‡æ··åˆæ‰€æœ‰æè´¨ç½‘ç»œã€‚è¯¥å±‚çš„æƒé‡ç”¨ä½œæ··åˆä¸¤ä¸ªè¾“å…¥ç½‘ç»œçš„Alphaå€¼ã€‚
- `LandscapeVisibilityMask` èŠ‚ç‚¹ç§»é™¤åœ°å½¢çš„å¯è§éƒ¨åˆ†ï¼Œä»¥ä¾¿åœ¨åœ°å½¢ä¸­åˆ›å»ºæ´è¿›è¡Œå¦‚æ´ç©´åˆ›å»ºç­‰æ“ä½œã€‚

ä½¿ç”¨å±‚æ··åˆæ¨¡å¼çš„ç‰¹å®šç»„åˆæ—¶ï¼Œåœ°å½¢ä¸Šä¸åŒå±‚äº¤å‰çš„ä½ç½®å°†å‡ºç°å¤§é‡é»‘æ–‘ã€‚å°†*LB_HeightBlend*æ¨¡å¼ç”¨äºå¤šåœ°å½¢å±‚æ—¶ï¼Œæ­¤é—®é¢˜å°¤å…¶å¸¸è§ã€‚LB_HeightBlend çš„å·¥ä½œåŸç†æ˜¯ä½¿ç”¨æŒ‡å®šæƒé‡å€¼è°ƒåˆ¶å±‚çš„æ··åˆç³»æ•°æˆ–æƒé‡ã€‚å¦‚åŒºåŸŸä¸Šç»˜åˆ¶æœ‰å¤šä¸ªå±‚ï¼Œä¸”å‡è¢«è®¾ä¸ºè¿™ç§æ¨¡å¼åˆ™å¯èƒ½ç‰¹å®šåŒºåŸŸä¸­ç»˜åˆ¶çš„æ‰€æœ‰å±‚å°†åŒæ—¶æ‹¥æœ‰0é«˜åº¦å€¼ï¼Œå› æ­¤å„å±‚çš„ç†æƒ³æ··åˆç³»æ•°å°†å˜ä¸º 0ã€‚

ç”±äºæ— éšå¼æˆ–æ˜¾å¼æ’åºï¼Œä¸”æ— å±‚å¯¹è¯¥åŒºåŸŸæœ‰è´¡çŒ®ï¼Œå› æ­¤ç»“æœä¼šäº§ç”Ÿé»‘æ–‘ã€‚ç”±äºæ··åˆæ³•çº¿è´´å›¾ä¼šäº§ç”Ÿæ³•çº¿å€¼(0,0,0)ï¼Œä¸”è¯¥å€¼æ— æ•ˆï¼Œä¼šå¯¼è‡´ç…§æ˜æ¸²æŸ“é—®é¢˜ï¼Œå› æ­¤æ··åˆæ³•çº¿è´´å›¾æ—¶æƒ…å†µä¼šæ›´ç³Ÿã€‚é’ˆå¯¹æ­¤é—®é¢˜çš„è§£å†³æ–¹æ¡ˆæ˜¯å¯¹å…¶ä¸­ä¸€ä¸ªå±‚ä½¿ç”¨ *LB_AlphaBlend*ã€‚

æ‰€æœ‰å±‚å‘½åå¿…é¡»å”¯ä¸€ï¼Œå› æ­¤å»ºè®®ä½¿ç”¨å¯è¡¨æ˜å±‚æ‰€å«å†…å®¹çš„æè¿°æ€§åç§°æ¥å‘½åå±‚ã€‚æ­¤å‘½åè¿™å¯ååŠ©è®°å¿†å±‚ä¸­çš„å†…å®¹ï¼Œä»¥ä¾¿æ›´åŠ å¿«é€Ÿåœ°æœç´¢å±‚ã€‚

è®¾ç½®å’Œä½¿ç”¨ *LandscapeLayerWeight* èŠ‚ç‚¹çš„è¿‡ç¨‹ï¼š

- åœ¨æè´¨ç¼–è¾‘å™¨ä¸­ï¼Œå‘æè´¨å›¾è¡¨æ·»åŠ  *LandscapeLayerWeight* èŠ‚ç‚¹ï¼Œåœ¨ç»†èŠ‚é¢æ¿ä¸­ï¼Œå°†å‚æ•°å‘½åæ”¹ä¸ºå±‚çš„æè¿°æ€§å‘½åï¼Œå¦‚"Rock"ã€‚
- æ·»åŠ é¢å¤– *LandscapeLayerWeight* èŠ‚ç‚¹ï¼Œç›´åˆ°æ‰€éœ€æè´¨ä¸­çš„æ‰€æœ‰å±‚éƒ½æ‹¥æœ‰æ­¤ç±»èŠ‚ç‚¹ä¸ºæ­¢ã€‚
- æ·»åŠ çº¹ç†å–æ ·æˆ–å…¶ä»–æè´¨ç½‘ç»œè¡¨è¾¾å¼ï¼Œå¹¶å°†å…¶ä¸ LandscapeLayerWeight èŠ‚ç‚¹è¿æ¥ã€‚
- å¹¶ä¸”å°†è¾“å‡ºå¥—æ¥åœ¨å¦å¤–çš„ *LandscapeLayerWeight* èŠ‚ç‚¹çš„ Base è¾“å…¥ç«¯ï¼Œé¡¶å±‚çš„ Base ç•™ç©ºã€‚
- ä»æœ€ç»ˆå±‚èŠ‚ç‚¹çš„è¾“å‡ºå¼•è„šè¿å‡ºå¼•çº¿ï¼Œè¿æ¥åˆ°æè´¨åŸºæœ¬èŠ‚ç‚¹çš„åº•è‰²è¾“å…¥ã€‚
- æ·»åŠ  *LandscapeLayerCoords* èŠ‚ç‚¹ï¼Œä»»æ„è®¾ç½®å…¶ UV æ ‡é¢˜ï¼Œç„¶åå°†å…¶ä¸çº¹ç†å–æ ·èŠ‚ç‚¹è¿æ¥ã€‚


`VertexColor`é¡¶ç‚¹é¢œè‰²èŠ‚ç‚¹è¾“å‡ºæ¨¡å‹é¡¶ç‚¹é¢œè‰²ï¼Œæ­¤é¢œè‰²é€šè¿‡ Mesh Paint å·¥å…·åœ¨ Color æ¨¡å¼ä¸‹ç»˜åˆ¶å¾—åˆ°ï¼Œå®ƒä¸ä¸€å®šç”¨æ¥ç›´æ¥æ˜¾ç¤ºï¼Œè¿˜å¯ä»¥ç”¨æ¥åšå…¶å®ƒæ•ˆæœçš„æ§åˆ¶æ•°æ®ã€‚é™¤äº†é¡¶ç‚¹è‰²ï¼Œè¿˜å¯ä»¥è¿›è¡Œæƒé‡ç»˜åˆ¶ï¼ˆVertex Weight Paintingï¼‰æ¨¡å¼ï¼Œåœ¨ç½‘æ ¼ä½“é¡¶ä¸Šç»˜åˆ¶é¡¶ç‚¹æƒé‡ï¼Œæä¾› 5 è·¯æ•°æ® RGBã€Alpha ä»¥åŠè‰²å½©çš„å„ä¸ªåˆ†é‡ã€‚

ä½¿ç”¨ Mesh Paint è¿›è¡Œé¡¶ç‚¹æƒé‡ç»˜åˆ¶æ—¶ï¼Œè¿›å…¥é¡¶ç‚¹æƒé‡ç»˜åˆ¶æ¨¡å¼ï¼ˆVertex Weight Paintingï¼‰ï¼Œå¹¶ä¸”å…ˆæ ¹æ®éœ€è¦çš„æ•°æ®è·¯æ•°é€‰æ‹©çº¹ç†æƒé‡ç±»å‹ï¼ˆTexture Weight Typeï¼‰ã€‚

- Alpha (Two Textures) 2 è·¯æ•°æ®ï¼›
- RGB (Three Textures) 3 è·¯æ•°æ®ï¼›
- ARGB (Four Textures) 4 è·¯æ•°æ®ï¼›
- ARGB - 1 (Five Textures) 5 è·¯æ•°æ®ï¼›

é€šè¿‡è®¾ç½®åœ¨ä¸ç½‘æ ¼ä½“ç›¸å…³æè´¨ä¸­æ··åˆçš„çº¹ç†æ•°é‡ï¼Œæ¥é…ç½®æ··åˆæƒé‡"ç­–ç•¥"ã€‚æ›´æ”¹ç†æƒé‡ç±»å‹åï¼Œå¯ç”¨äºç»˜åˆ¶çº¹ç†ï¼ˆPaint Textureï¼‰å’Œæ“¦é™¤çº¹ç†ï¼ˆErase Textureï¼‰çš„é€‰é¡¹å°†ä¼šæ›´æ–°ã€‚

è®¾ç½® Color View Mode ä¸º RGB Channel æ¨¡å¼ä¸‹æŸ¥çœ‹è¯¥ç½‘æ ¼ç‰©ä½“ï¼Œä¼šå±•ç¤ºè®¾ç½®åœ¨é¡¶ç‚¹çš„ RGB é¢œè‰²ï¼ŒAlpha é€šé“ç»˜åˆ¶å†…å®¹æ˜¾ç¤ºä¸ºé»‘è‰²ã€‚æ³¨æ„ï¼Œè®¾ç½®é¢œè‰²æŸ¥çœ‹æ¨¡å¼ä¸º Alpha Channelï¼Œåˆ™æ‰€æœ‰é€šé“çš„ç»˜ç”»å†…å®¹æ˜¾ç¤ºä¸ºé»‘è‰²ï¼Œæ— å†…å®¹åŒºä¸ºç™½è‰²ã€‚æ— ç»˜ç”»å†…å®¹çš„åŒºåŸŸè¾“å‡ºä¸º 0 å€¼ï¼Œå·²ç»˜ç”»å†…å®¹çš„åŒºåŸŸï¼Œåœ¨å¯¹åº”çš„é€šé“ä¸Šè¾“å‡ºä¸º 1 å€¼ã€‚

åœ¨ UE5 ä¸Šï¼ŒWeight Painting é¢æ¿ä¼¼ä¹æœ‰ UI é€»è¾‘ Bugã€‚åœ¨ Paint Texture Weight Index åˆ—è¡¨çš„åº”è¯¥æ˜¯ç”»ç¬”çº¹ç†ï¼Œä»¥ ARGB - 1 (Five Textures) ç»˜åˆ¶ç±»å‹ä¸ºä¾‹ï¼Œå¯¹åº”çš„çº¹ç†ä½œç”¨ï¼š

- Texture One æ¸…é™¤ Alpha é€šé“ï¼Œç™½è‰²ï¼›
- Texture Two ç»˜åˆ¶ R é€šé“ï¼Œçº¢è‰²ï¼›
- Texture Three ç»˜åˆ¶ G é€šé“ï¼Œç»¿è‰²ï¼›
- Texture Four ç»˜åˆ¶ B é€šé“ï¼Œè“è‰²ï¼›
- Texture Five ç»˜åˆ¶ Alpha é€šé“ï¼Œé»‘è‰²ã€‚

æ³¨æ„ï¼Œç»˜ç”»å‰ä¸€å®šè¦å…ˆç‚¹ç”»ç¬”å·¥å…·ï¼Œéœ€è¦ç»˜åˆ¶å“ªä¸ªé€šé“ï¼Œç›´æ¥åœ¨ Paint Texture Weight Index è¿™é‡Œé€‰æ‹©ã€‚è€Œ Erase Texture Weight Index ä¸­çš„é€‰é¡¹å®Œå…¨ä¸èµ·ä½œç”¨çš„ã€‚

è§£æä¸€ä¸‹ 5 è·¯æ•°æ®çš„æ¥æºï¼ŒRGBA å››ä¸ªåˆ†é‡å³ä¸º 4 è·¯ï¼Œç„¶åï¼Œç”¨ 1 - Alpha è®¡ç®—å¾—åˆ°å¦å¤–ä¸€è·¯ã€‚

å„é€šé“ç»˜å›¾åï¼Œå¦‚ä½•éœ€è¦è¿˜åŸä¸ºçº¯è‰²ï¼ŒRGB å„é€šé“å¯ä»¥é€šè¿‡ Mesh Paint çš„æ¸…é™¤æˆ–å¡«å……å·¥å…· Remove/Fill æ¥å®ç°ï¼Œä½†å®ƒä»¬æœ‰æ—¶å€™ä¸å¯ç‚¹å‡»çŠ¶æ€ï¼Œåœ¨æ¨¡å‹ä¸Šç”»å‡ ç¬”å°±æ­£å¸¸äº†ã€‚


`WorldPosition`è¾“å‡ºæ¨¡å‹é¡¶ç‚¹åœ¨å…¨å±€ç©ºé—´çš„åæ ‡ï¼ŒAbsolute World Positionã€‚

`VertexNormalWS`è¾“å‡ºæ¨¡å‹é¡¶ç‚¹åœ¨å…¨å±€ç©ºé—´çš„æ³•çº¿å‘é‡ï¼Œå¯ä»¥ä½œä¸º World Position ä¸­çš„ä½ç½®åç§»è¿›è¡Œä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨äºåˆ¶ä½œæŸäº›ç‰¹æ®Šè´´å›¾ã€‚

ç›´æ¥å°† VertexNormalWS è¾“å‡ºåˆ°æè´¨çš„ Base Colorï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªç«‹æ–‡ä½“å‘ X/Y/Z è½´æ­£æ–¹å‘çš„ä¸‰ä¸ªé¢åˆ†åˆ«æ˜¾ç¤ºä¸º Red/Yellow/Blue ä¸‰åŸè‰²ï¼Œå¯¹åº”å„ä¸ªé¢çš„æ³•çº¿å‘é‡ (1,0,0)/(0,1,0)/(0,0,1)ï¼Œå¦å¤–ä¸‰ä¸ªé¢å¤„äºå„è½´çš„è´Ÿå‘ï¼Œæ‰€ä»¥å„åˆ†é‡éƒ½å°äºæˆ–ç­‰äº 0ï¼Œå¯¹äºé¢œè‰²è¾“å…¥éƒ½ç­‰ä»·ä¸º 0ã€‚å¦‚æœæ˜¯ Sphereï¼Œé‚£ä¹ˆä¸‰ä¸ªæ­£å‘é¢çš„é¢œè‰²å°†ä¼šæ˜¯ä¸‰åŸè‰²æ¸å˜çš„æ•ˆæœï¼Œæ ¹æ®å…¶å„åƒç´ åœ¨æ‰€ä½ç½®çš„æ³•çº¿å†³å®šã€‚

ä¸¤ä¸ªå‘é‡çš„ç‚¹ç§¯æ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œå‡ ä½•å«ä¹‰å°±æ˜¯ä¸€ä¸ªå‘é‡åœ¨å¦ä¸€ä¸ªå‘é‡ä¸Šçš„æŠ•å°„é•¿åº¦ï¼Œæ‰€ä»¥ï¼ŒXY å¹³é¢ä¸Šçš„ä¸¤ä¸ªå‘é‡çš„ç‚¹ç§¯å°±ç›¸å½“äºä¸€ä¸ªä»…è¡¨ç° Z è½´æ–¹å‘ä¸Šçš„é«˜åº¦è’™ç‰ˆã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå‡å¦‚å±±ä½“æ¨¡å‹çš„æŸä¸ªéƒ¨åˆ†æ˜¯å¹³é¡¶çš„ï¼Œé‚£ä¹ˆå®ƒçš„æ³•çº¿å¿…å®šæ˜¯æŒ‡å‘ Z è½´æ­£æ–¹å‘ã€‚é‚£ä¹ˆï¼Œå°†é¡¶ç‚¹å‘é‡ä¸å‘é‡(0,0,1ï¼‰åš `DotProduct` è¿ç®—ï¼Œå½“å®ƒä»¬å¹³è¡Œæ—¶ï¼Œä¹Ÿå°±æ˜¯å±±ä½“æ¨¡å‹å¹³é¡¶éƒ¨åˆ†å°±ä¼šå¾—åˆ°æœ€å¤§å€¼ 1ã€‚è€Œæ–œé¢éƒ¨åˆ†ï¼Œæ ¹æ®å¡åº¦ä¸åŒï¼Œè¾“å‡ºçš„æ•°å­—å°äº 0 ~ 1 ä¹‹é—´ã€‚å¯¹äºé‚£äº›ç«–èµ·çš„æ–­å´–éƒ¨åˆ†ï¼Œå‡ ä¹ä¸ Z æ–¹å‘å‚ç›´ï¼Œå³ COSÎ¸ è¾“å‡ºä¸º 0ã€‚æ˜ç™½è¯¥åŸç†ä¹‹åï¼Œä¾¿å¯ä»¥è¿›è¡Œä¸€äº›ç‰¹æ®Šæ•ˆæœçš„åˆ¶ä½œï¼Œä¾‹å¦‚ç§¯é›ªçš„æè´¨ï¼Œæ ¹æ®è¾“å‡ºå€¼çš„å¼ºåº¦ï¼Œå†ç»“åˆ LinearInterpolate æˆ– HeightLerp åšæ’å€¼ï¼Œå®ç°é›ªèŠ±ä¸å²©çŸ³æè´¨çš„è¦†ç›–ã€‚

æ³•çº¿è´´å›¾çš„æ··åˆå åŠ ä¸èƒ½ç›´æ¥ç›¸ä¹˜ Multiplyï¼Œè€Œåº”è¯¥ä½¿ç”¨æè´¨å‡½æ•° *BlendAngleCorrectedNormals* èŠ‚ç‚¹ã€‚

`VertexTangentWS`è¾“å‡ºæ¨¡å‹é¡¶ç‚¹åœ¨å…¨å±€ç©ºé—´çš„åˆ‡çº¿å‘é‡ï¼Œã€‚

ç½‘æ ¼ä½“ç»˜åˆ¶ç³»ç»Ÿè¦æ±‚ç½‘æ ¼ä½“æè´¨åŒ…å«ä¸€ä¸ªé¡¶ç‚¹é¢œè‰²èŠ‚ç‚¹ `Vertex Color`ï¼Œå› ä¸ºè¿™æ˜¯ä»ç½‘æ ¼ä½“å°†æ¨¡å‹çš„é¡¶ç‚¹é¢œè‰²æ•°æ®ä¼ è‡³æè´¨çš„æ–¹å¼ï¼Œæ•°æ®æµï¼šMesh -> Vertex Color -> Materialã€‚

Vertex Color å››ä¸ªè¾“å‡ºç«¯ç‚¹è¯´æ˜ï¼š

- RGB é£æ ¼ä½“é¡¶ç‚¹çš„ä¸‰é€šé“è‰²å½©è¾“å‡ºï¼›
- R é£æ ¼ä½“é¡¶ç‚¹çš„çš„ Red åˆ†é‡è¾“å‡ºï¼›
- G é£æ ¼ä½“é¡¶ç‚¹çš„çš„ Green åˆ†é‡è¾“å‡ºï¼›
- B é£æ ¼ä½“é¡¶ç‚¹çš„çš„ Blue åˆ†é‡è¾“å‡ºï¼›
- A é£æ ¼ä½“é¡¶ç‚¹çš„çš„ Alpha åˆ†é‡è¾“å‡ºï¼›

é«˜åº¦æ’å€¼`HeightLerp`æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„çº¹ç†å¤„ç†å‡½æ•°ï¼Œå®ƒæ ¹æ®é«˜åº¦è´´å›¾å’Œè¿‡æ¸¡é˜¶æ®µå€¼ï¼Œåœ¨ 2 ä¸ªçº¹ç†ä¹‹é—´æ‰§è¡Œçº¿æ€§æ’å€¼ï¼Œå…è®¸æ²¿ç€å‘ç”Ÿæ’å€¼çš„é«˜åº¦è´´å›¾æ¥è°ƒæ•´å€¼ã€‚å’Œ Lerp çº¿æ€§æ’å€¼ç±»ä¼¼ï¼Œå†é…åˆ `Vertex Color` çš„ 5 è·¯è¾“å‡ºæ•°æ®å¯ä»¥å®ç°æœ€å¤§ 5 è·¯çº¹ç†æ··åˆçš„æè´¨ã€‚

ä¾‹å¦‚ï¼Œé€šè¿‡ HeightLerp åœ¨æ¨¡å‹ä¸Šç»˜åˆ¶ç –å¢™ä¸è‹”è—“ï¼š

- A (Vector3) è¾“å…¥ç”¨äºæ’å€¼è®¡ç®—çš„ç¬¬ä¸€ä¸ªçº¹ç†ï¼Œæ¯”å¦‚ç –å¢™çº¹ç†ã€‚
- B (Vector3) ç”¨äºæ’å€¼è®¡ç®—çš„ç¬¬äºŒä¸ªçº¹ç†ï¼Œæ¯”å¦‚è‹”è—“çº¹ç†ã€‚
- Transition Phase (Scalar) æ­¤å€¼å®šä¹‰å‘ç”Ÿè¿‡æ¸¡çš„é«˜åº¦è´´å›¾èŒƒå›´ã€‚
- Height Texture (Scalar) ç°åº¦å›¾ï¼Œç”¨äºæ’å€¼æ“ä½œçš„é«˜åº¦è´´å›¾ã€‚
- Contrast (Scalar)  ä½¿ç”¨ CheapContrastï¼ˆä½æˆæœ¬å¯¹æ¯”åº¦ï¼‰å‡½æ•°å¯¹é«˜åº¦è´´å›¾åº”ç”¨å¯¹æ¯”åº¦æå‡ã€‚
- Results è¾“å‡ºç»“æœï¼ŒHeightLerp å‡½æ•°æ ¹æ®è¾“å…¥æ¡ä»¶æ··åˆ A B åçš„ç»“æœã€‚
- Alpha åœ¨æ’å€¼ä¸­ä½¿ç”¨çš„é˜¿å°”æ³•å€¼ï¼ˆå·²æå‡å¯¹æ¯”åº¦ï¼‰ã€‚
- Lerp Alpha No Contrast åœ¨æ’å€¼ä¸­ä½¿ç”¨çš„é˜¿å°”æ³•å€¼ï¼ˆæœªæå‡å¯¹æ¯”åº¦ï¼‰ã€‚

å°†*Transition Phase*è®¾ç½®ä¸º 0.5 è¡¨ç¤ºæ‰§è¡Œæ ‡å‡†æ’å€¼ï¼ŒAB ä¸¤è¾¹éƒ½å¯ä»¥å…¼é¡¾ï¼Œè€Œ 0 æˆ– 1 è¡¨ç¤ºæ²¡æœ‰è¿‡åº¦èŒƒå›´ï¼Œæ— è®ºé«˜åº¦è´´å›¾è¾“å…¥ä»€ä¹ˆå€¼ï¼Œæ’å€¼ç»“æœåªå¯¹åº” A æˆ– Bï¼Œæ²¡æœ‰äºŒè€…çš„æ··åˆã€‚

`HeightLerp` å’Œ `Lerp` ç›¸æ¯”ï¼Œå¤šäº†ä¸€ä¸ªé«˜åº¦è´´å›¾çš„è¾“å…¥ï¼Œä¹Ÿå°±å¯ä»¥æ ¹æ®ä¸åŒåæ ‡ç‚¹çš„é«˜åº¦æ¥å†³å®šæ’å€¼ï¼Œç»˜åˆ¶é¡¶ç‚¹é¢œè‰²æ—¶ï¼Œè¯·ç¡®ä¿æ¨¡å‹æœ‰è¶³å¤Ÿçš„é¡¶ç‚¹æ¥ä¿å­˜ç›¸å…³æ•°æ®ã€‚

çº¹ç†è´´å›¾çš„ UV åæ ‡è°ƒæ•´ä½¿ç”¨`TextureCoordinate`è¡¨è¾¾å¼èŠ‚ç‚¹ã€‚


åˆ©ç”¨ World Position Offset æè´¨å±æ€§å¯ä»¥åˆ›å»ºé£å¹è‰åŠ¨çš„æ•ˆæœï¼ŒUE4 å†…ç½®æœ‰ *SimpleGrassWind* æè´¨å‡½æ•°å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚æ­¤å‡½æ•°å¯¹æ¤ç‰©å¶å­åº”ç”¨åŸºæœ¬çš„é£è¿ç®—ï¼Œå¹¶å…è®¸æ‚¨æŒ‡å®šæƒé‡è´´å›¾å’Œé£åŠ›ã€‚è¿™æ˜¯æ— æ–¹å‘çš„é£ï¼Œå®ƒåªæ˜¯ä½¿æ¤ç‰©å¶å­äº§ç”Ÿéå¸¸æ™®é€šçš„ç§»åŠ¨æ•ˆæœã€‚éœ€è¦é£å‘ï¼Œåº”è¯¥ä½¿ç”¨æœ€åä¸€ä¸ª WPO å‚æ•°ã€‚

è¾“å…¥å‚æ•°è¯´æ˜ï¼Œç»™å®ƒä»¬ç»Ÿä¸€è¾“å…¥ 0 ~ 10 çš„å€¼å°±å¯ä»¥çœ‹åˆ°æ™ƒåŠ¨æ•ˆæœï¼š

- WindIntensity (Scalar) æ§åˆ¶é£å½±å“ç½‘æ ¼çš„ç¨‹åº¦ã€‚
- WindWeight (Scalar)   è¿™æ˜¯ä¸€ä¸ªç°é˜¶è´´å›¾ï¼Œç”¨äºæ§åˆ¶ç½‘æ ¼é¡¶ç‚¹å¯¹é£äº§ç”Ÿååº”çš„ç¨‹åº¦ã€‚
- WindSpeed (Scalar) æ­¤å€¼æ§åˆ¶é£é€Ÿã€‚
- AdditionalWPO (Vector3) é¢å¤–çš„ä¸–ç•Œä½ç½®åç§»ç½‘ç»œæˆ–å‡½æ•°ï¼Œworld position offset networks or functionsã€‚

é™¤äº†æ¨¡æ‹Ÿé£å¹è‰åŠ¨æ•ˆæœï¼Œè¿˜å¯ä»¥åˆ¶ä½œäº’åŠ¨è‰ä¸›ï¼Œç©å®¶ç»è¿‡è‰ä¸›æ—¶ä¼šæœ‰æ‘†åŠ¨ï¼Œåˆ¶ä½œæ­¥éª¤è¦ç‚¹ï¼š

- é¦–å…ˆï¼Œåœ¨å…³å¡è“å›¾è°ƒç”¨ *GetPlayerPawn* å’Œ *GetActorLocation* æ¥è·å–ç©å®¶çš„åæ ‡ï¼›
- ç„¶åè°ƒç”¨ *SetVectorParameterValue* å°†è¿™ä¸ªåæ ‡é€šè¿‡æè´¨å‚æ•°é›†ä½“ä¼ é€’ç»™æè´¨è“å›¾ï¼Œæè´¨å‚æ•°é›†åˆåç»­åˆ›å»ºï¼›
- åˆ›å»ºä¸€ä¸ª Material Parameter Collectionï¼Œå‘½åä¸º MPC_PlayerLocationï¼Œç›¸åº”ä¿®æ”¹ VectorParameter å‚æ•°åå­—ï¼›
- å°†æè´¨å‚æ•°é›†åˆ MPC_PlayerLocation æ‹–å…¥æè´¨è“å›¾ï¼Œå¹¶è®¾ç½® General -> Parameter Name å’Œä¸Šé¢çš„å‚æ•°åå­—ä¸€è‡´ï¼›
- è®¾ç½®`WorldPosition`èŠ‚ç‚¹è·å–è‰ä¸›æ¨¡å‹é¡¶ç‚¹åœ¨å…¨å±€ç©ºé—´çš„åæ ‡ã€‚
- ä½¿ç”¨`Utility Distance`èŠ‚ç‚¹è®¡ç®—ä¸ç©å®¶åæ ‡ä¹‹é—´çš„è·ç¦»ï¼Œæ ¹æ®è·ç¦»æ¥å†³å®šæ˜¯å¦è¦è®¾ç½® *World Position Offset* æ¥äº§ç”Ÿç§»åŠ¨æ•ˆæœã€‚

æ³¨æ„ï¼ŒVectorParameterValue æ˜¯ä¸€ä¸ªå››ç»´å‘é‡ï¼Œå¯ä»¥ä½¿ç”¨ *ComponentMask* è½¬æ¢ä¸ºä¸‰ç»´å‘é‡ã€‚å¦å¤–ï¼Œå½“ç„¶ï¼Œè¿˜æœ‰è®¾ç½®æ ‡é‡å‚æ•°çš„æ–¹æ³•*SetScalarParameterValue*ã€‚


å‡¹å‡¸è´´å›¾åç§»ï¼ˆBumpOffsetï¼‰ æ˜¯è™šå¹»å¼•æ“ 4 æœ¯è¯­ï¼Œå°±æ˜¯é€šå¸¸æ‰€è°“çš„"è§†å·®è´´å›¾"ã€‚BumpOffset è¡¨è¾¾å¼å¯ä»¥ä½¿æè´¨äº§ç”Ÿæ·±åº¦é”™è§‰ï¼Œè€Œä¸éœ€è¦é¢å¤–çš„å‡ ä½•ä½“ã€‚BumpOffset æè´¨ä½¿ç”¨ç°é˜¶*é«˜åº¦è´´å›¾*æ¥æä¾›æ·±åº¦ä¿¡æ¯ã€‚é«˜åº¦è´´å›¾ä¸­çš„å€¼è¶Šäº®ï¼Œæè´¨çš„"å‡¸å‡º"æ•ˆæœè¶Šæ˜æ˜¾ï¼›å½“æ‘„åƒæœºåœ¨è¡¨é¢ä¸Šç§»åŠ¨æ—¶ï¼Œè¿™äº›åŒºåŸŸå°†äº§ç”Ÿè§†å·®ï¼ˆç§»ä½ï¼‰ã€‚é«˜åº¦è´´å›¾ä¸­è¾ƒæš—çš„åŒºåŸŸå°†æ˜¾å¾—"è·ç¦»è¾ƒè¿œ"ï¼Œå…¶ç§»ä½ç¨‹åº¦æœ€å°ã€‚åˆé€‚çš„ Height Ratio è®¾ç½®åœ¨ 0.05 ~ 0.1 åŒºé—´ã€‚




æ°´ä½“æè´¨ä½¿ç”¨æœ‰æŠ˜å°„åŠ¨æ€å˜åŒ–çš„ç‰¹ç‚¹ï¼Œå¹¶ä¸”ä¸ç‰©ä½“äº¤ç•Œå¤„çš„æŠ˜å°„ä¼šç‰¹åˆ«ä¸åŒï¼Œä½¿ç”¨`DistanceToNearestSurface` æˆ– `DistanceFieldGradient`å¯ä»¥å¯¹æ°´æµä¸ç‰©ä½“æ¥è§¦è¾¹ç•Œè¿›è¡Œç‰¹æ•ˆå¤„ç†ã€‚é€šè¿‡æŠ–åŠ¨ UV å¯ä»¥æ¨¡æ‹Ÿæ°´ä½“çš„æ³¢çº¹æ™ƒåŠ¨ï¼Œè€Œç”¨åŸæœ¬çš„ UV å‡æ‰ DistanceFieldGradient è®¡ç®—å‡ºæ¥çš„å‘é‡ï¼Œè¿™æ ·å°±å¯ä»¥åšå‡ºæ²¿ç€ç›¸äº¤åŒºåŸŸç‚¹æ³•çº¿æ–¹å‘å‘å¤–æ¨è´´å›¾çš„æ•ˆæœã€‚

è¯·åŠ¡å¿…æ³¨æ„ï¼ŒDistanceFieldGradient é¦–å…ˆè¿›è¡Œè§„èŒƒåŒ–ï¼Œç„¶åè¾“å…¥åˆ°"è’™ç‰ˆé€šé“"ï¼ˆMask Channelï¼‰èŠ‚ç‚¹ã€‚ è¿™æ ·åšçš„åŸå› æ˜¯ï¼Œå¦‚æœä¸é¦–å…ˆè¿›è¡Œè§„èŒƒåŒ–ï¼Œå°†æ— æ³•è·å¾—æ–¹å‘æ€§æ•°æ®ã€‚ä¸ºäº†æ–¹ä¾¿åœ¨æè´¨å®ä¾‹ä¸­è¿›è¡Œ RGB é€šé“åˆ‡æ¢ï¼Œæ·»åŠ äº†"è’™ç‰ˆé€šé“"ï¼ˆMask Channelï¼‰å‚æ•°ã€‚

è¿™ä¸¤ä¸ªèŠ‚ç‚¹ä¾èµ–è·ç¦»åœºæ¥è®¡ç®—ï¼Œæ‰€ä»¥éœ€è¦åœ¨é¡¹ç›®ä¸­æ¿€æ´»ï¼šProject Settings -> Rendering -> Generate Mesh Distance Fieldsã€‚

DistanceToNearestSurface æè´¨è¡¨è¾¾å¼èŠ‚ç‚¹å…è®¸æè´¨å¯¹"å…¨å±€è·ç¦»åœº"å…³å¡ä¸­çš„ä»»ä½•ç‚¹è¿›è¡Œå–æ ·ã€‚ è¿™ä¸ªæè´¨è¡¨è¾¾å¼å°†è¾“å‡ºä»è·ç¦»åœºåˆ°åœºæ™¯ä¸­æœ€è¿‘é®æŒ¡ä½“çš„å¸¦ç¬¦å·è·ç¦»ï¼ˆä»¥å…¨å±€ç©ºé—´å•ä½è®¡ï¼‰ã€‚

UE4 è‡ªå¸¦çš„ Starter Content å°±æœ‰ M_Water_Lake æ°´ä½“æè´¨ç¤ºèŒƒã€‚



## âš¡ Reactive Snow äº’åŠ¨é›ªåœ°
- å¯äº’åŠ¨é›ªåœ°æè´¨ https://www.bilibili.com/video/BV1wt411m7L7
- Creating Snow Trails in UE 4 https://www.raywenderlich.com/5760-creating-snow-trails-in-unreal-engine-4
- Creating Interactive Grass in UE4 https://www.raywenderlich.com/6314-creating-interactive-grass-in-unreal-engine-4

ä¸»è§’åœ¨åœ°é¢ä¸Šç•™ä¸‹è„šå°æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„è¡¨ç°æ‰‹æ³•ï¼Œä½¿ç”¨ UE4ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿å®ç°è¿™ä¸ªæ•ˆæœï¼Œä¸€èˆ¬çš„æ€ç»´è¿‡ç¨‹æ˜¯ä¸»è§’çš„è„šæ­¥è¸©è¸åœ°é¢æ—¶ï¼ŒTRACE åœ°é¢å¾—åˆ°åæ ‡ï¼Œç„¶åä¸Šè´´èŠ±ã€‚

å®ç°é›ªåœ°è¶³è¿¹çš„åŸºæœ¬æ€è·¯ï¼š

- ä¸ºè¶³è¿¹åˆ›å»ºæ¸²æŸ“ç›®æ ‡ï¼Œè¿™æ˜¯ä¸€ä¸ªç°åº¦é®ç½©ï¼Œå…¶ä¸­ç™½è‰²ä»£è¡¨ç€è¶³è¿¹ï¼Œé»‘è‰²ä»£è¡¨éè¶³è¿¹ã€‚
- å°†æ¸²æŸ“ç›®æ ‡æŠ•å½±åˆ°åœ°é¢ï¼Œç„¶åç”¨å®ƒæ¥æ··åˆçº¹ç†ä»¥åŠç½®æ¢é¡¶ç‚¹ï¼Œä½¿å¾—é›ªåœ°æœ‰ä¸‹é™·æ•ˆæœã€‚

ä½†æ˜¯ï¼Œéœ€è¦ä¸€ç§æ–¹æ³•æ‰¾åˆ°é‚£äº›å¯å½±å“é›ªçš„ç‰©ä½“ï¼Œå¯ä»¥å…ˆæŠŠå¯¹è±¡æ¸²æŸ“åˆ°è‡ªå®šä¹‰æ·±åº¦ï¼ˆCustomDepthï¼‰ç¼“å†²åŒºï¼Œå†ä½¿ç”¨ä¸€ä¸ªå¸¦æœ‰åæœŸå¤„ç†æè´¨çš„ SceneCapture å¯¹æ‰€æœ‰æ¸²æŸ“åˆ°è‡ªå®šä¹‰æ·±åº¦çš„å¯¹è±¡è¿›è¡Œé®ç½©ï¼Œç„¶åå†æŠŠé®ç½©è¾“å‡ºç»™æ¸²æŸ“ç›®æ ‡ã€‚

SceneCapture çš„å…³é”®æ˜¯å®ƒæ”¾ç½®çš„ä½ç½®ã€‚å‡å¦‚ï¼Œæ˜¯é¡¶å‘ä¸‹è§†è§’è®°å½•åœºæ™¯å¹¶è¾“å‡ºç»™æ¸²æŸ“ç›®æ ‡ï¼Œé‚£ä¹ˆå¯¹äºçƒä½“ï¼Œå®ƒåªæ˜¯åº•éƒ¨ç€åœ°ï¼Œä½†æ˜¯é¡¶è§†è§’ä¼šè®¤ä¸ºæ•´ä¸ªçƒä½“æŠ•èº«åˆ°åœ°å€çš„éƒ¨åˆ†éƒ½æ˜¯è¢«é®ç½©çš„åŒºåŸŸã€‚

æ‰€ä»¥ï¼ŒSceneCaptue æ‘„åƒæœºåº”è¯¥ä»åº•éƒ¨æ•æ‰åœºæ™¯ï¼Œä¹Ÿå°±æ˜¯æ¥è§¦åœ°é¢çš„è§’åº¦æ‹æ‘„ã€‚è¦åˆ¤æ–­ç‰©ä½“æ˜¯å¦æ¥è§¦åœ°é¢ï¼Œä½¿ç”¨åæœŸå¤„ç†æè´¨è¿›è¡Œæ·±åº¦æ£€æµ‹ã€‚è¿™ä¸ªæ£€æµ‹ä¼šå‘Šè¯‰æˆ‘ä»¬ç‰©ä½“æ˜¯å¦é«˜äºåœ°é¢æ·±åº¦ä¸”ä½äºæŒ‡å®šçš„åç§»é‡ã€‚å¦‚æœè¿™ä¸¤ä¸ªæ¡ä»¶å‡ä¸º Trueï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸ºè¿™ä¸€åƒç´ é®ç½©ã€‚

è¦è¿›è¡Œæ·±åº¦æ£€æµ‹ï¼Œæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªæ·±åº¦ç¼“å†²åŒºã€‚ä¸€ä¸ªé’ˆå¯¹åœ°é¢ï¼›å¦ä¸€ä¸ªé’ˆå¯¹å½±å“é›ªçš„ç‰©ä½“ã€‚å› ä¸º SceneCapture ä»…èƒ½çœ‹åˆ°åœ°é¢ï¼Œåœºæ™¯æ·±åº¦ï¼ˆSceneDepthï¼‰ç¼“å†²åŒº å°†ä¼šè¾“å‡ºåœ°é¢çš„æ·±åº¦ã€‚è¦è·å–ç‰©ä½“çš„æ·±åº¦ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å®ƒä»¬æ¸²æŸ“åˆ° è‡ªå®šä¹‰æ·±åº¦ï¼ˆCustomDepthï¼‰ç¼“å†²åŒº


ç¤ºèŒƒé¡¹ç›®åŸºäº ThirdPerson Shooter æ¨¡æ¿ï¼Œäº’åŠ¨é›ªåœ°åŠŸèƒ½åŸºæœ¬é€»è¾‘ï¼š

- åˆ›å»ºä¸€ä¸ª Actor è“å›¾ï¼Œå‘½åä¸º *RenderTarget_BP*ï¼Œæ·»åŠ å¹¶ä½¿ç”¨ SceneCaptureComponent2D ç»„ä»¶æ¥æ•æ‰ä¸‰ç»´åœºæ™¯ä¸­çš„ä¿¡æ¯ã€‚
- åˆ›å»ºä¸€ä¸ª Material Parameters Collection å‘½åä¸º *SnowMPC*ï¼Œç”¨äºå‘é›ªåœ°æè´¨*Snow_Mat*ä¼ é€’ç©å®¶åæ ‡ï¼Œä½¿ç”¨`SetVectorParameterValue`æ–¹æ³•ã€‚
- åœ¨ BeginPlay äº‹ä»¶ä¸­ï¼Œé€šè¿‡ `SetScalarParameterValue` å°† SceneCaptureComponent2D ç»„ä»¶çš„ OrthoWidth æŠ•å½±å®½åº¦å†™å…¥ *SnowMPC*ã€‚
- ä¸ç©å®¶åæ ‡ç»‘å®šï¼Œåœ¨ Tick äº‹ä»¶ä¸­ï¼Œä½¿ç”¨ `GetPlayerCharacter` å’Œ `GetActorLocation` è·å–ç©å®¶çš„åæ ‡ä½ç½®ï¼Œå¹¶ä½¿ç”¨ `AddActorWorldOffset` æ–¹æ³•æ›´æ–°åˆ° RenderTarget_BP æœ¬èº«çš„åæ ‡ã€‚
- åˆ›å»ºä¸¤ä¸ª RenderTarget ç”¨æ¥å­˜å‚¨ç©å®¶çš„è¶³è¿¹ï¼Œä¸€ä¸ªå‘½åä¸º *RenderTarget*ï¼Œå¦ä¸€ä¸ªå‘½åä¸º *RenderTargetPersistent*ã€‚
- åˆ›å»ºä¸€ä¸ªæè´¨å‘½åä¸º *DrawToPersistant* ç”¨æ¥è£…å…¥ *RenderTarget* æè´¨é‡‡æ ·ã€‚
- å†åˆ©ç”¨ UPrimitiveComponent æä¾›çš„ `CreateDynamicMaterialInstance` æ–¹æ³•åˆ›å»ºåŠ¨æ€æè´¨ï¼Œé€šè¿‡ `DrawMaterialToRenderTarget` å°†å…¶ç»˜åˆ¶åˆ° *RenderTargetPersistent*ã€‚
- åˆ›å»ºä¸€ä¸ª WidgetBlueprint ç”¨æ¥åœ¨å±å¹•ä¸Šæ˜¾ç¤ºç©å®¶è¶³è¿¹ï¼Œåªéœ€è¦æ·»åŠ ä¸€ä¸ª Image ç»„ä»¶ï¼Œè®¾ç½® Brush -> Texture ä¸º *RenderTarget*ã€‚
- é›ªåœ°æè´¨*Snow_Mat*åªæ˜¯ç®€å•åœ°ä½¿ç”¨ç™½è‰²æ¨¡æ‹Ÿé›ªåœ°ï¼Œä½¿ç”¨æ·±æ£•è‰²æ¨¡æ‹ŸåœŸåœ°ï¼Œå®ƒä»¬é€šè¿‡ LinearInterpolate è¿›è¡Œçº¿æ€§æ’å€¼ï¼ŒAlpha è¾“å…¥çš„æ’å€¼æ§åˆ¶æ¥è‡ª *RenderTarget* è®°å½•çš„è¶³è¿¹æ•°æ®ï¼Œå¹¶ç»è¿‡è‡ªå®šä¹‰æè´¨å‡½æ•°*MaskUV*å¤„ç†ã€‚
- ä½¿ç”¨ WorldPosition è·å–é›ªåœ°ä¸­åƒç´ åæ ‡ï¼Œå¹¶ä¸ç©å®¶å½“å‰çš„åæ ‡è¿›è¡Œå·®å€¼å¤„ç†ã€‚
- åœ¨ ThirdPersonCharacter è§’è‰²çš„ BeginPlay äº‹ä»¶ï¼Œä½¿ç”¨ `Create Widget` åˆ›å»ºå…¶å®ä¾‹ï¼Œå† `AddToViewport` æ·»åŠ åˆ°åœºæ™¯ä¸­ã€‚


å·¥ç¨‹ä¸­ä½¿ç”¨äº†ä¸‰ä¸ªæè´¨ï¼Œæè´¨æ··åˆæ¨¡å¼åŠç€è‰²æ¨¡å¼å¦‚ä¸‹ï¼š

- *Snow_Mat* é›ªåœ°æè´¨ï¼ŒSurface æè´¨åŸŸï¼ŒOpaque + Default Lit æ¨¡å¼ï¼ŒTwo Sidedï¼›
- *DrawToPersistant* ç»˜å›¾ç”¨çš„æè´¨ï¼ŒSurface æè´¨åŸŸï¼ŒOpaque + Default Lit æ¨¡å¼ï¼Œç”¨äºç»˜åˆ¶ RenderTarget çš„æè´¨ï¼›
- *Mat_Depth* Post Process æè´¨åŸŸï¼Œç”¨æ¥æµ‹é‡æ¸²æŸ“æ·±åº¦ï¼›

åæœŸå¤„ç†æè´¨éœ€è¦æŒ‡å®šæè´¨åŸŸä¸º Post Processï¼Œå¹¶ä¸”ï¼ŒåæœŸå¤„ç†æè´¨åªèƒ½ä½¿ç”¨è‡ªå‘å…‰é¢œè‰²ï¼ˆEmissive Colorï¼‰è¾“å‡ºæ–°é¢œè‰²ã€‚æ­¤å¤–ï¼Œå¯ä»¥å®šä¹‰åœ¨åæœŸå¤„ç†è¿‡ç¨‹ä¸­åº”åœ¨ä½•å¤„åº”ç”¨æ­¤é€šé“(Blendable Location)ï¼Œå¦‚æœæœ‰å¤šä¸ªé€šé“ï¼Œåˆ™åº”æŒ‰ä»€ä¹ˆé¡ºåºå¤„ç†ï¼ˆBlendable Priorityï¼‰ã€‚

*RenderTarget_BP* å†…éƒ¨çš„ *SceneCaptureComponent2D* ç»„ä»¶éœ€è¦ä½¿ç”¨æ·±åº¦æµ‹è¯•æè´¨ *Mat_Depth*ï¼Œå…¶é€»è¾‘è¯´æ˜ï¼š

- ä½¿ç”¨ *SceneTexture* æè´¨è¡¨è¾¾å¼çš„ CustomDepth å’Œ ScreenDepth çº¹ç†çš„ R åˆ†é‡ï¼Œæ±‚å…¶å·®å€¼ï¼Œå¹¶é™¤ä»¥ 25ã€‚
- å³å¦‚æœæŸåƒç´ è·åœ°é¢ 25 ä¸ªå•ä½ä»¥å†…ï¼Œé‚£ä¹ˆå®ƒå°†è¢«é®ç½©ã€‚é®ç½©çš„å¼ºåº¦ï¼ˆmasking intensityï¼‰ä¾èµ–äºåƒç´ å’Œåœ°é¢çš„è·ç¦»ã€‚
- å†é€šè¿‡ *Saturate* èŠ‚ç‚¹èŒƒå›´åˆ° 0 ~ 1 çš„èŒƒå›´ï¼Œå¹¶ä½¿ç”¨ *OneMinus* æ±‚åå€¼ã€‚
- å°†ä¸Šé¢çš„æ ‡é¢˜å€¼å’Œ RenderTargetPersistent çš„ RGB çŸ¢é‡ç›¸åŠ ï¼Œè¿™ä¸€æ­¥æ··åˆäº†æ—§çš„è¶³è¿¹æ•°æ®ã€‚
- å°†ç»“æœè¾“å‡ºåˆ° Emissive Colorï¼Œè¿™ä½œä¸ºåæœŸå¤„ç†æè´¨çš„ä¸“ç”¨é€šé“ã€‚

æ·»åŠ å¯¹è±¡åˆ°åœºæ™¯æ—¶ï¼Œé»˜è®¤ä¸ä¼šå¼€å¯ Rendering -> Render CustomDepth Passï¼Œä½ éœ€è¦å¼€å¯è¿™ä¸ªåŠŸèƒ½ä»¥ç”Ÿæˆ SceneCapture éœ€è¦æ•æ‰çš„æ·±åº¦æ•°æ®ã€‚è¿™ä¸ªå•ç‹¬çš„ç‰¹æ€§é€šè¿‡å°†æŸäº›å¯¹è±¡æ¸²æŸ“åˆ°å¦ä¸€ä¸ªæ·±åº¦ç¼“å†²åŒºï¼ˆCustomDepthï¼‰æ¥å±è”½å®ƒä»¬ã€‚ è¿™å¢åŠ äº†é¢å¤–çš„ç»˜åˆ¶è°ƒç”¨ï¼Œä½†ä¸ä½¿ç”¨æ›´å¤šæè´¨ã€‚æ¸²æŸ“ç›¸å½“ä¾¿å®œï¼Œå› ä¸ºæˆ‘ä»¬åªè¾“å‡ºæ·±åº¦ã€‚è€Œ


æè´¨å‚æ•°é›†åˆ SnowMPC ä¼ é€’äº†ä¸¤ä¸ªå‚æ•°ï¼š

- SceneCaptureComponent2D ç»„ä»¶çš„ OrthoWidth æŠ•å½±å®½åº¦ï¼Œæ ‡é‡ã€‚
- RenderTarget_BP å¯¹è±¡çš„ Actor Locationï¼Œå››ä¸‰ç»´çŸ¢é‡ã€‚

è®¾ç½® *RenderTarget_BP* å†…éƒ¨çš„ SceneCaptureComponent2D ç»„ä»¶ï¼š

- Projection éƒ¨åˆ†ï¼š
    - Projection Type -> Orthographic æ­£äº¤æŠ•å½±
    - Ortho Width -> 2048 åƒç´ çš„çŸ©å½¢ï¼ˆå¤§æ¦‚è¦†ç›–20må¹³æ–¹èŒƒå›´ï¼‰
- Scene Capture éƒ¨åˆ†ï¼š
    - Texture Target -> *RenderTarget*
    - Capture Source -> Final Color (LDR) in RGB
- Post Process Volume -> Rendering Features éƒ¨åˆ†ï¼š
    - Post Process Materials çš„æ•°ç»„è®¾ç½®ä¸­ï¼Œæ·»åŠ  *Mat_Depth*ï¼›

å°† *RenderTarget_BP* æ·»åŠ åˆ°åœºæ™¯å†…ï¼Œå¹¶è®¾ç½® Location ä¸º (0, 0, -2000)ï¼Œç›®çš„æ˜¯å°† SceneCapture æ‘„åƒæœºæ”¾åˆ°åœ°é¢ä»¥ä¸‹ï¼Œä½¿ç”¨åº•è§†è§’æ¥æ•æ‰åšæ·±åº¦æµ‹è¯•çš„æ•°æ®ã€‚è¿™äº›æ•°æ®ä¸ºä¿å­˜åˆ° Scene Capture è®¾ç½®çš„ Texture Target å¯¹è±¡ä¸Šã€‚

ä¸¤ä¸ª RenderTarget å¯¹è±¡çš„æ•°æ®æµå‘å¦‚ä¸‹ï¼Œä¸»è¦æ˜¯é€šè¿‡ RenderTarget_BP å„ä¸ªæ–¹æ³•å¤„ç†ï¼š

*RenderTarget* -> DrawToPersistant -> *RenderTargetPersistent* -> Mat_Depth -> RenderTarget_BP -> *RenderTarget*ã€‚

å¦‚æœä¸é€šè¿‡ *RenderTargetPersistent* ä½¿è¶³è¿¹æŒä¹…åŒ–ï¼Œé‚£ä¹ˆæ¯æ¬¡å¿ƒè·³äº‹ä»¶ä¸­ï¼Œæ–°çš„è¶³è¿¹éƒ½ä¼šè¦†ç›–æ‰ *RenderTarget* åŸæœ‰çš„è¶³è¿¹ã€‚æ‰€ä»¥ï¼Œéœ€è¦ä¸€ä¸ªæ¸²æŸ“ç›®æ ‡ä½œä¸ºæŒä¹…åŒ–ç¼“å­˜ï¼ˆpersistent bufferï¼‰ï¼Œåœ¨è¶³è¿¹è¢«è¦†ç›–ä¹‹å‰æŠŠå®ƒå­˜å‚¨åˆ°æŒä¹…åŒ–ç¼“å­˜ä¸­ã€‚ç„¶åå†é€šè¿‡ *Mat_Depth* æŠŠæŒä¹…åŒ–ç¼“å­˜è¿”å›ç»™ SceneCaptureï¼Œæ‰€ä»¥å†æ¬¡æ•æ‰åˆ°çš„æ·±åº¦ä¿¡æ¯å°±ä¼šåŒ…å«æŒä¹…åŒ–çš„è¶³è¿¹ã€‚è¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†ä¸¤ä¸ªæ¸²æŸ“ç›®æ ‡äº’ç›¸å†™æ¥å†™å»çš„å¾ªç¯ç»“æ„ï¼Œå®ƒå°±æ˜¯å®ç°æŒä¹…åŒ–çš„æ–¹æ³•ã€‚


å› ä¸ºæ¸²æŸ“ç›®æ ‡ä¹Ÿæ˜¯æ¶ˆè€—å†…å­˜ï¼Œåˆ†è¾¨ç‡è¦å°½å¯èƒ½ä½ï¼Œä»¥å……åˆ†åˆ©ç”¨å†…å­˜ç©ºé—´ã€‚ä½¿ç”¨ *PixelWorldSize* è¡¨ç¤ºä¸€ä¸ªåƒç´ å¯¹åº”å¤šå¤§çš„å®é™…é¢ç§¯ã€‚

å¯¹äºé›ªåœ°ä¸Šçš„è¶³è¿¹ï¼Œä¸éœ€è¦é‚£ä¹ˆå¤šçš„ç»†èŠ‚ï¼Œä½¿ç”¨ä¸éœ€è¦ 1:1 çš„æ¯”ä¾‹ã€‚ç¬”è€…å»ºè®®ä½¿ç”¨æ›´å¤§çš„æ¯”ä¾‹ï¼Œè¿™æ ·å°±èƒ½æŠŠä½åˆ†è¾¨ç‡çš„æ¸²æŸ“ç›®æ ‡ç”¨åˆ°æ›´å¤§çš„æ•è·åŒºåŸŸä¸Šã€‚æ³¨æ„ï¼Œä¹Ÿä¸è¦ç”¨å¤ªå¤§çš„æ¯”ä¾‹ï¼Œé‚£æ ·ä¼šæŸå¤±ç»†èŠ‚ã€‚æœ¬ä¾‹ä¸­ï¼Œä½¿ç”¨ 8:1 çš„æ¯”ä¾‹ï¼Œå³ä¸€ä¸ªåƒç´ å¯¹åº” 8Ã—8 çš„ä¸–ç•Œå•ä½ã€‚æ³¨æ„ï¼Œæ¸²æŸ“ç›®æ ‡é»˜è®¤çš„åˆ†è¾¨ç‡æ˜¯256Ã—256ã€‚é€šè¿‡ Scene Capture -> Ortho Width æŒ‡å®šæ•è·åŒºåŸŸå¤§å°ï¼Œåœ¨ Perspective æŠ•å½±æ–¹å¼ä¸‹æ— æ•ˆã€‚æ¯”å¦‚ï¼Œæƒ³æ•è· 1024Ã—1024 çš„åŒºåŸŸï¼Œå› ä¸ºä½¿ç”¨çš„æ¯”ä¾‹æ˜¯ 8:1ï¼Œæ‰€ä»¥å°†å®ƒè®¾ä¸º 2048ï¼ˆ256Ã—8ï¼‰ã€‚

åœ°é¢ä½¿ç”¨çš„æè´¨ï¼Œå³ *Snow_Mat* ä¹Ÿéœ€è¦è®¿é—®æ•è·åŒºåŸŸçš„å¤§å°ä»è€Œå‡†ç¡®æŠ•å½±æ¸²æŸ“ç›®æ ‡ã€‚ä¸€ç§ç®€å•çš„æ–¹å¼æ˜¯å°†æ•è·åŒºåŸŸçš„å¤§å°å­˜å‚¨åœ¨æè´¨å˜é‡é›†ï¼ˆMaterial Parameter Collectionï¼‰ï¼Œè¿™æ˜¯å› ä¸ºä»»ä½•æè´¨éƒ½å¯ä»¥è®¿é—®å˜é‡é›†ã€‚

é›ªåœ°æè´¨ç»†èŠ‚é¢æ¿ä¸­çš„è®¾ç½®è¯´æ˜ï¼š

å¯ç”¨ Two Sided æ˜¯å› ä¸º SceneCapture æ˜¯è‡ªåº•å‘ä¸Šçœ‹åœ°é¢ï¼Œå³éœ€è¦çœ‹åˆ°å®ƒçš„èƒŒé¢ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå¼•æ“å¹¶ä¸æ¸²æŸ“èƒŒé¢ï¼Œè¿™æ ·ä¹Ÿå°±æ— æ³•æŠŠåœ°é¢æ·±åº¦å­˜å‚¨åˆ°æ·±åº¦ç¼“å†²åŒºã€‚å› æ­¤æˆ‘ä»¬è¦è®©å¼•æ“å¯¹åœ°é¢è¿›è¡ŒåŒé¢æ¸²æŸ“ã€‚

è®¾ç½® Tessellation -> D3D11 Tessellation ä¸º Flat Tessellationï¼ˆä½¿ç”¨ PN Triangles ä¹Ÿå¯ä»¥ï¼‰ã€‚ Tessellation ä¼šæŠŠç½‘æ ¼çš„ä¸‰è§’é¢åˆ†è§£æˆæ›´å°çš„ä¸‰è§’é¢ã€‚ä»è€Œæœ‰æ•ˆæé«˜ç½‘æ ¼åˆ†è¾¨ç‡ï¼Œæ˜¯æˆ‘ä»¬åœ¨é¡¶ç‚¹ç½®æ¢æ—¶è·å¾—æ›´å¤šçš„ç»†èŠ‚ã€‚å¦åˆ™ï¼Œé¡¶ç‚¹å¯†åº¦è¿‡å°å¾ˆéš¾ç”Ÿæˆç”ŸåŠ¨çš„è¶³è¿¹ã€‚Tessellation å³å†…åµŒï¼Œåœ¨ä¸‰è§’é¢ä¸­åˆ†å‰²åµŒå¥—å°çš„ä¸‰è§’é¢ï¼Œæå‡æ¨¡å‹ç»†èŠ‚ã€‚

å¼€å¯ Tessellation åï¼Œæè´¨çš„ World Displacement å’Œ Tessellation Multiplier é€šé“ä¹Ÿä¼šè¢«å¯ç”¨ã€‚åè€…æ§åˆ¶å†…åµŒä¸‰è§’é¢çš„æ•°é‡ï¼Œæœ¬ä¾‹ä¸­ä¸å¯¹è¯¥é€šé“è¿æ¥ï¼Œè¿™æ„å‘³ç€ä½¿ç”¨å…¶é»˜è®¤å€¼ 1ã€‚

World Displacement é€šé“è·å–è¾“å…¥çš„å‘é‡å€¼ï¼Œæ ¹æ®å‘é‡çš„æ–¹å‘å’Œå¤§å°ç§»åŠ¨é¡¶ç‚¹ã€‚è¦è®¡ç®—è¿™ä¸ªå¼•è„šçš„å€¼ï¼Œæˆ‘ä»¬å…ˆå¾—æŠŠæ¸²æŸ“ç›®æ ‡æŠ•å½±åˆ°åœ°é¢ã€‚

å¼•æ“å‡çº§åˆ° UE5EA å¼•å…¥ Nanite è™šæ‹Ÿå¾®å¤šè¾¹å½¢å‡ ä½•ä½“ï¼Œå¯ä»¥å¤„ç†ä¸Šäº¿çº§åˆ«çš„å¤šè¾¹å½¢ï¼Œå¯ä»¥ä½¿ç”¨ Photogrammetry çš„æ‰«ææ•°æ®å’Œ CAD æ•°æ®ï¼Œå¹¶ä¸”æ— éœ€åˆ¶ä½œ LOD æ¨¡å‹ã€‚åŸå…ˆçš„ Tessellation å·²ç»è¢«ç§»é™¤ï¼Œå¯ä»¥ä½¿ç”¨ Virtual HeightField Mesh è¿™æ ·çš„æ›¿ä»£æŠ€æœ¯ã€‚ä½¿ç”¨ Modeling Tools Editor Mode å»ºæ¨¡æ’ä»¶è§£å†³é™æ€çš„ç½®æ¢é—®é¢˜ï¼Œå…¶å·¥å…·é¢æ¿ Deform -> Displace æä¾›äº†è´´å›¾ç½®æ¢åŠŸèƒ½ã€‚

- å¯ç”¨ VirtualHeightfieldMesh æ’ä»¶ï¼›
- 

*Snow_Mat* æè´¨ä¸­ï¼Œä½¿ç”¨ *WorldPosition* è·å–é›ªåœ°ä¸­åƒç´ åæ ‡ï¼Œå¹¶è®¡ç®—ä¸ç©å®¶å½“å‰çš„åæ ‡å·®å€¼ã€‚å› ä¸º SceneCapture ç»„ä»¶æ”¾ç½®åœ¨åœ°ä¸‹å‘ä¸Šæ‹æ‘„çš„è§†è§’ï¼Œæ‰€ä»¥è·å–åˆ°çš„åƒç´ åæ ‡éœ€è¦è¿›è¡Œåè½¬ä»¥åŒ¹é… RenderTarget çš„åƒç´ åæ ‡ã€‚æ³¨æ„ï¼Œæ‘„åƒæœºçš„ç”»é¢åæ ‡æ˜¯ X ç«–ç›´å‘ä¸Šï¼ŒY è½´æ°´å¹³å‘å·¦ï¼Œæœå‘ Z è½´æ­£æ–¹å‘ï¼Œè¿™å„è§†å›¾çš„åæ ‡ç³»ç»Ÿæ˜¯ä¸€è‡´çš„ã€‚ä½†æ˜¯ç©å®¶çš„è§’åº¦æ˜¯é¡¶è§†å›¾ï¼Œæ‰€ä»¥é¡¶åº•ç¿»è½¬æ–¹å‘åï¼ŒX è½´ç¿»è½¬ 180Â°ã€‚

ç¿»è½¬åçš„åæ ‡ä¸‹æ­¥å¤„ç†å°±æ˜¯å°†ä»¥ä¸–ç•Œä¸­å¿ƒåæ ‡çš„ (0, 0) åƒç´ åæ ‡è½¬æ¢åˆ° UV åæ ‡ç³»ï¼ŒæŒ‰æ¸²æŸ“ç›®æ ‡çš„å°ºå¯¸å±…ä¸­ï¼Œè¿™å°±éœ€è¦å°†åæ ‡å’Œ ShowMVC æ¥æ”¶åˆ° Size çš„ä¸€åŠç›¸åŠ ã€‚åœ¨ä½¿ç”¨ *MaskUV* è‡ªå®šä¹‰æè´¨å‡½æ•°è¿‡æ»¤å‰ï¼Œ

è¿™é‡Œé¢å¯¹é½ UV åæ ‡æ˜¯æ¯”è¾ƒéº»çƒ¦çš„éƒ¨åˆ†ï¼Œå› ä¸º RenderTarget å°ºå¯¸æœ‰é™ï¼Œåªèƒ½ç”¨æ¥æ˜¾ç¤ºç©å®¶å½“å‰çš„æ´»åŠ¨åŒºåŸŸçš„è¶³è¿¹ã€‚å½“ç©å®¶æ´»åŠ¨èŒƒå›´è¶…è¿‡å…¶å°ºå¯¸ï¼Œå°±ä»¥æœ€åå¯è¦†ç›–çš„åŒºåŸŸä¸ºå‡†ï¼Œæˆªæ–­è¶…å‡ºèŒƒå›´çš„éƒ¨åˆ†ã€‚è¿™æ ·å°±éœ€è¦å¯¹çº¹ç†çš„ UV åæ ‡è¿›è¡ŒåŠ¨æ€æ›´æ–°ï¼Œä»¥å’Œç©å®¶çš„ä½ç½®ä¸€è‡´ã€‚å·¥ç¨‹ä¸­ï¼Œè¿˜ä½¿ç”¨äº†è‡ªå®šä¹‰äº†æè´¨å‡½æ•°*MaskUV*ï¼Œç”¨æ¥ï¼Œå…¶å†…éƒ¨ä½¿ç”¨äº† *Custom* ç¼–å†™è‡ªå®šä¹‰æè´¨è¡¨è¾¾ï¼Œä½¿ç”¨ *FunctionInput* æ¥æ”¶ä¸€ä¸ªå‘é‡è¾“å…¥ï¼š

```js
if (UV.x < 0 || UV.x > 1 || UV.y < 0 || UV.y > 1)
{
    return 0;
}

return 1;
```

åœ¨*RenderTarget_BP*åŒå®šä¹‰çš„ *MoveRT* ä½œç”¨å°±æ˜¯ç”¨æ¥å°†ç©å®¶çš„è¶³è¿¹æ´»åŠ¨è½¬æ¢åˆ° RenderTarget å°ºå¯¸èŒƒå›´ã€‚

å…¶å†…éƒ¨è¿˜å®šä¹‰äº†ä¸€ä¸ªè“å›¾å®ï¼Œ*SnapPixelToGrid*ï¼Œä¸»è¦æ˜¯ä½¿ç”¨æ•°å­¦è¡¨è¾¾å¼ Math Expressionï¼Œå°†è¾“å…¥çš„ç©å®¶åæ ‡ (PlayerX, PlayerY) è½¬æ¢ä¸ºè§„èŒƒå€¼ï¼Œä»¥å®ç°é™„ç€ï¼š

    ((vector((floor((PlayerX / PixelWorldSize))), (floor((PlayerY / PixelWorldSize))), 0)) + 0.500000) * PixelWorldSize

è¾“å…¥å‚æ•° PixelWorldSize å°±æ˜¯å°† SceneCaptureComponent2D ç»„ä»¶çš„ OrthoWidth æŠ•å½±å®½åº¦ç»†åˆ†ä¸º 256 æ ¼å­ï¼Œåæ ‡å°±é™„ç€åœ¨è¿™äº›æ ¼å­çš„ä¸­é—´ï¼Œé€ä¸ªæ ¼å­ç§»åŠ¨çº¹ç†åæ ‡ã€‚

å¤„ç†åçš„åæ ‡ä¼šä¼ é€’åˆ°æè´¨å‚æ•°é›†ä½“ï¼Œä»¥ä¾›*Snow_Mat*æè´¨ä½¿ç”¨ï¼Œå¹¶ä½¿ç”¨ `AddActorWorldOffset` æ–¹æ³•æ›´æ–° RenderTarget_BP æœ¬èº«çš„åæ ‡ã€‚


## âš¡ Distance Field è·ç¦»åœº
- Mesh Distance Fields https://docs.unrealengine.com/4.27/zh-CN/BuildingWorlds/LightingAndShadows/MeshDistanceFields
- Distance Functions - Inigo Quilez https://www.iquilezles.org/www/articles/distfunctions/distfunctions.htm

è™šå¹»å¼•æ“ 4 ä½¿ç”¨è·ç¦»åœºï¼ˆDistance Fieldsï¼‰çš„å¼ºå¤§åŠŸèƒ½æ¥å®ç°æ¸¸æˆä¸­é™æ€ç½‘æ ¼ä½“ Actor çš„åŠ¨æ€ç¯å¢ƒå…‰é®è”½å’Œé˜´å½±ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒActor çš„ç½‘æ ¼ä½“è·ç¦»åœºè¡¨è¾¾è¿˜å¯ç”¨äºå…¶ä»–ä¸€äº›ç‰¹æ€§ï¼Œä¾‹å¦‚ GPU ç²’å­ç¢°æ’ï¼Œç”šè‡³è¿˜å¯ä»¥ä½¿ç”¨æè´¨ç¼–è¾‘å™¨åˆ›å»ºåŠ¨æ€æµåŠ¨è´´å›¾ç­‰ç­‰ã€‚

æ­¤æŠ€æœ¯ä¸­ä½¿ç”¨çš„è·ç¦»åœºæ˜¯ä»£è¡¨é™æ€ç½‘æ ¼ä½“è¡¨é¢çš„æœ‰å‘è·ç¦»åœºï¼ˆSigned Distance Fieldï¼‰ï¼ŒSDF æœ‰ 2D å’Œ 3D çš„åŒºåˆ«ï¼Œå®ƒçš„å®šä¹‰éå¸¸ç®€å•ï¼šæ¯ä¸ªåƒç´ ï¼ˆä½“ç´ ï¼‰è®°å½•è‡ªå·±ä¸è·ç¦»è‡ªå·±æœ€è¿‘ç‰©ä½“ä¹‹é—´çš„è·ç¦»ï¼Œå¦‚æœåœ¨ç‰©ä½“å†…ï¼Œåˆ™è·ç¦»ä¸ºè´Ÿï¼Œæ­£å¥½åœ¨ç‰©ä½“è¾¹ç•Œä¸Šåˆ™ä¸º 0ã€‚æœ‰å‘è·ç¦»åœºåœ¨æ¯ä¸ªç‚¹å°†è·ç¦»æœ€è¿‘è¡¨é¢çš„è·ç¦»ä¿å­˜åˆ°ä½“ç§¯çº¹ç†ä¸­ã€‚ç½‘æ ¼ä½“å¤–çš„æ¯ä¸ªç‚¹ä¿å­˜çš„è·ç¦»ä¸ºæ­£å€¼ï¼Œç½‘æ ¼ä½“å†…çš„æ¯ä¸ªç‚¹ä¿å­˜çš„è·ç¦»ä¸ºè´Ÿå€¼ã€‚

SDF é¦–ä¸ªå®ç”¨å±æ€§çš„ä½œç”¨æ˜¯ï¼Œåœ¨è¿½è¸ªå…‰çº¿æ—¶å®‰å…¨åœ°è·³è¿‡ç©ºç™½ç©ºé—´ï¼Œå› ä¸ºåˆ°æœ€è¿‘è¡¨é¢çš„è·ç¦»å·²ç»æ˜ç¡®ï¼ˆæœ‰æ—¶ç§°è¿™ç§æ–¹æ³•ä¸ºçƒä½“è¿½è¸ªï¼‰ã€‚åªéœ€åŒºåŒºå‡ æ­¥å°±å¯ä»¥åˆ¤å®šå‡ºäº¤å‰ç‚¹ã€‚å¯¹è·ç¦»åœºè¿›è¡Œå…‰çº¿è¿½è¸ªå°†ç”Ÿæˆå¯è§æ€§æ•ˆæœï¼Œ ä¹Ÿå°±æ˜¯è¯´å¦‚æœå…‰çº¿å’Œç½‘æ ¼ä½“äº¤å‰ï¼Œå…‰çº¿å°±ä¼šæŠ•å°„å‡ºé˜´å½±ã€‚

è·ç¦»åœºç¬¬äºŒä¸ªå®ç”¨å±æ€§çš„ä½œç”¨æ˜¯ï¼Œåœ¨è¿½è¸ªå…‰çº¿æ—¶ï¼Œé€šè¿‡è¿½è¸ªç»è¿‡é®æŒ¡ç‰©çš„è·ç¦»æœ€è¿‘çš„å…‰çº¿å°±å¯ä»¥è®¡ç®—å‡ºè¿‘ä¼¼çš„é”¥ä½“äº¤å‰ç‚¹ï¼Œè€Œä¸äº§ç”Ÿé¢å¤–æˆæœ¬ã€‚è¿™ç§è¿‘ä¼¼æ³•å¯ä»¥åˆ©ç”¨è·ç¦»åœºæ¥å®ç°éå¸¸æŸ”å’Œçš„åŒºåŸŸé˜´å½±å’Œå¤©ç©ºé®è”½ã€‚è¿™ä¸ªå±æ€§æ˜¯è·ç¦»åœºç¯å¢ƒå…‰é®è”½çš„å…³é”®ï¼Œå› ä¸ºå°‘é‡çš„é”¥ä½“å³å¯ä¸ºæ¥æ”¶å™¨ç‚¹çš„æ•´ä¸ªåŠçƒè®¡ç®—å‡ºæŸ”å’Œçš„å¯è§æ€§ã€‚

SDF çš„å…¶å®ƒåº”ç”¨ï¼š

1. é«˜æ¸…æ–‡å­—ï¼ˆTMPï¼‰
2. å½¢å˜åŠ¨ç”»
3. åºåˆ—å¸§åŠ¨ç”»æŸ”å’Œè¿‡åº¦
4. ç¢°æ’æ£€æµ‹
5. è½¯é˜´å½±
6. ç¯å¢ƒé®è”½ï¼ˆAOï¼‰

å¼€å‘æ¸¸æˆæ—¶ï¼Œæ‚¨å¯èƒ½å‘ç°æœ‰æ—¶åŠ¨æ€ç…§æ˜æ˜¯ç”¨äºå…³å¡çš„æœ€ä½³é€‰æ‹©ï¼Œä¾‹å¦‚ï¼Œå¯è§†è·ç¦»å¾ˆå¤§çš„å…³å¡æˆ–è€…å…·æœ‰å¤§å‹å¼€æ”¾ä¸–ç•Œåœºæ™¯çš„å…³å¡ã€‚åœ¨è¿™ç±»æƒ…å†µä¸‹ï¼Œé¢„è®¡ç®—ç…§æ˜å¯èƒ½æ•ˆç‡å¾ˆä½æˆ–å¯¹äºç›®æ ‡ç³»ç»Ÿçš„èµ„æºè¦æ±‚è¿‡é«˜ã€‚è·ç¦»åœºé˜´å½±ï¼ˆDistance Field Shadowsï¼‰ï¼Œä¸é…åˆå®šå‘å…‰æºä½¿ç”¨çš„ä¼ ç»Ÿçº§è”é˜´å½±è´´å›¾ï¼ˆCascaded Shadow Mapï¼‰CSM ç›¸æ¯”ï¼Œå®ƒä½¿æ‚¨èƒ½å¤Ÿåœ¨æ›´è¿œçš„è·ç¦»æŠ•å°„é˜´å½±ã€‚

è¦ä¸ºé¡¹ç›®å¯ç”¨ç½‘æ ¼ä½“è·ç¦»åœºï¼Œè¯·ä½¿ç”¨æ–‡ä»¶èœå•æ‰“å¼€é¡¹ç›®è®¾ç½®ç”Ÿæˆç½‘æ ¼ä½“è·ç¦»åœºï¼šProject Settings -> Engine -> Rendering -> Lighting -> Generate Mesh Distance Fieldsã€‚

é‡æ–°å¯åŠ¨é¡¹ç›®æ—¶ï¼Œä½ å°†åœ¨ä¸‹è§’å¤„çœ‹åˆ°ä»¥ä¸‹å¼¹å‡ºçª—å£ï¼Œè¡¨ç¤ºæ­£åœ¨ç”Ÿæˆç½‘æ ¼ä½“è·ç¦»åœºã€‚å®Œæˆåï¼Œä½ å¯ä»¥åœ¨è§†å£æŸ¥çœ‹ç½‘æ ¼ä½“è·ç¦»åœºï¼šShow -> Visualize -> Mesh DistanceFieldsã€‚

åœ¨åœºæ™¯æ”¾ç½®å…‰æºï¼Œå®šå‘ï¼ˆDirectionalï¼‰ã€èšï¼ˆSpotï¼‰æˆ– ç‚¹ï¼ˆPointï¼‰å…‰æºï¼Œåœ¨ä»»æ„å…‰æºç»„ä»¶ä¸Šå¯ç”¨è·ç¦»åœºé˜´å½±çš„æ“ä½œç›¸åŒï¼šDetails -> Mobility è®¾ç½®ä¸ºå¯ç§»åŠ¨ï¼ˆMovableï¼‰æˆ–å›ºå®šï¼ˆStationaryï¼‰ã€‚å¹¶ä¸” Distance Field Shadow è®¾ç½®ä¸ºå¯ç”¨ã€‚

å¼€å‘æ¸¸æˆæ—¶ï¼Œä½ å¯èƒ½ä¸»è¦ä¾èµ–å±å¹•ç©ºé—´æ–¹æ³•æ¥æä¾›åŠ¨æ€ç¯å¢ƒå…‰é®è”½ï¼ˆAOï¼‰ä¹ƒè‡³é¢„è®¡ç®—ç…§æ˜ï¼Œä»¥ä½¿ä¸–ç•Œåœºæ™¯ä¸­çš„å¯¹è±¡çœ‹èµ·æ¥æ›´åŠ çœŸå®ã€‚è¿™äº›æ–¹æ³•è™½ç„¶æœ‰ç”¨ä½†å´å­˜åœ¨å±€é™æ€§ã€‚å±å¹•ç©ºé—´ç¯å¢ƒå…‰é®è”½ï¼ˆScreen Space Ambient Occlusionï¼‰ä»…é™äºä½¿ç”¨åœºæ™¯æ·±åº¦çš„æƒ…å†µè€Œä¸”ä»…åœ¨å¯è§å±å¹•ç©ºé—´ä¸­æœ‰æ•ˆã€‚é¢„è®¡ç®—æ–¹æ³•ä»…å¯¹ä¸–ç•Œåœºæ™¯ä¸­çš„é™æ€å¯¹è±¡æœ‰æ•ˆï¼Œè¿™æ„å‘³ç€å®ƒä»¬æ— æ³•å®æ—¶æ›´æ–°ã€‚è·ç¦»åœºç¯å¢ƒå…‰é®è”½ï¼ˆDistance Field Ambient Occlusionï¼‰æ˜¯ä¸€ç§å…¨åŠ¨æ€AOæ–¹æ³•ï¼Œå®ƒå°†ç½‘æ ¼ä½“è·ç¦»åœºï¼ˆMesh Distance Fieldï¼‰ç”¨äºå¯ç§»åŠ¨é™æ€ç½‘æ ¼ä½“ã€‚å®ƒä¸ä»…å¯åœ¨åŠ¨æ€ç…§æ˜çš„ä¸–ç•Œåœºæ™¯ä¸­ä½¿ç”¨ï¼Œä¹Ÿå¯ç”¨äºé¢„è®¡ç®—ç…§æ˜ã€‚


ä¾èµ–åœºæ™¯æ·±åº¦æ—¶ï¼Œåœ¨æ¸¸æˆä¸­çš„ç²’å­ç¢°æ’ä¼šå—åˆ°é™åˆ¶ï¼Œä»…å¯ä»¥å°†æ‘„åƒæœºè§†å›¾ä¸­å¯ç”¨çš„ç²’å­ç”¨äºç¢°æ’ã€‚å¯¹äºå¯¿å‘½è¾ƒé•¿çš„ç²’å­æˆ–åœ¨å¤§é¢ç§¯åŒºåŸŸä¸­ä½¿ç”¨çš„ç²’å­ï¼Œåœ¨æŸäº›è§’åº¦ï¼Œåœºæ™¯æ·±åº¦ä¸æ˜¯ç‰¹åˆ«ç²¾ç¡®ã€‚å¦‚æœåœ¨é¡¹ç›®ä¸­ä½¿ç”¨ç½‘æ ¼ä½“è·ç¦»åœºï¼ˆMesh Distance Fieldï¼‰ï¼Œç²’å­çš„ ç¢°æ’æ¨¡å¼ å°±å¯ä»¥ä½¿ç”¨æ•´ä¸ªåœºæ™¯è¿›è¡Œç¢°æ’ï¼Œè€Œéåœºæ™¯æ·±åº¦ã€‚

è·ç¦»åœºç¢°æ’æ¨¡å¼æä¾›çš„ç¢°æ’ç›¸è¾ƒäºåœºæ™¯æ·±åº¦æ›´åŠ å¯é ã€‚ä½†æ˜¯ï¼Œç”±äºå…¨å±€è·ç¦»åœºï¼ˆGlobal Distance Fieldï¼‰ç”¨äºè¡¨ç¤ºæ•´ä¸ªåœºæ™¯çš„è¾ƒä½åˆ†è¾¨ç‡ï¼Œæ‚¨å¯èƒ½ä¼šå‘ç°ä½¿ç”¨è·ç¦»åœºç¢°æ’æ¨¡å¼æ—¶ç²’å­ä¼šç©¿è¿‡è¾ƒè–„çš„å¯¹è±¡æˆ–è€…å°–è§’ä¼šå˜åœ†ã€‚ä½œä¸ºåˆ†è¾¨ç‡é™ä½çš„å›æŠ¥ï¼Œè·ç¦»åœºç¢°æ’å¯ä»¥é«˜æ•ˆè¿è¡Œã€‚å…¶æ€§èƒ½æˆæœ¬ä¸åœºæ™¯æ·±åº¦ç¢°æ’å·®ä¸å¤šï¼Œä½†æ˜¯å´ä¸å—æ‘„åƒæœºè§†å›¾é™åˆ¶ã€‚è·ç¦»åœºç¢°æ’æ¨¡å¼æ˜¯ä¸€ä¸ª Shader Model 5ï¼ˆSM5ï¼‰åŠŸèƒ½ã€‚åœ¨ä¸æ”¯æŒSM5çš„ç¡¬ä»¶ä¸Šï¼Œç²’å­ç¢°æ’ä¼šè‡ªåŠ¨é€€å›åˆ°ä½¿ç”¨åœºæ™¯æ·±åº¦ç¢°æ’ã€‚

ä¸ºç²’å­è®¾ç½®è·ç¦»åœºï¼š

- åœ¨å†…å®¹æµè§ˆå™¨ä¸­ï¼Œæ‰¾åˆ°å¹¶æ‰“å¼€ä»»æ„ç²’å­ç³»ç»Ÿï¼ˆParticle Systemï¼‰ï¼Œå¦‚æœä¸å­˜åœ¨ç«‹å³å¯ç”¨çš„ç²’å­ç³»ç»Ÿåˆ™æ–°å»ºä¸€ä¸ªã€‚
- åŒå‡»å·²é€‰æ‹©çš„ç²’å­ç³»ç»Ÿä»¥æ‰“å¼€çº§è”ç²’å­ç¼–è¾‘å™¨ï¼ˆCascade Particle Editorï¼‰ã€‚
- åœ¨å‘å°„å™¨é¢æ¿ç©ºç™½çš„åœ°æ–¹å³é”®å•å‡»ï¼Œåˆ›å»º Type Data -> New GPU Spritesã€‚
- å†æ¬¡åœ¨ç©ºç™½çš„åœ°æ–¹å³é”®å•å‡»ï¼Œç„¶åä»æ¨¡å—åˆ—è¡¨ä¸­é€‰æ‹© Collision -> Collision(Scene Depth)ã€‚
- é€‰æ‹© Collision (Scene Depth) -> Details -> Collision Mode æ—è¾¹çš„ä¸‹æ‹‰èœå•ï¼Œè®¾ç½®ä¸º Distance Fieldã€‚


å¦‚æœæ¸¸æˆé’ˆå¯¹é—´æ¥å…‰ç…§åŒºåŸŸä½¿ç”¨é¢„è®¡ç®—ç…§æ˜ï¼Œæ··åˆå¯ç§»åŠ¨å¯¹è±¡å¯èƒ½ä¼šéå¸¸å…·æœ‰æŒ‘æˆ˜æ€§ï¼Œå› ä¸ºå®ƒä»¬ä¸ä¼šæ‹¥æœ‰æŸ”å’ŒåŒºåŸŸé˜´å½±ã€‚æœ‰æ—¶éœ€è¦æ¨¡æ‹Ÿè¿™ç§ç±»å‹çš„æ•ˆæœï¼Œä»¥ä½¿ç”¨å¤æ‚æè´¨è®¾ç½®ä¹ƒè‡³è´´èŠ±å°†åŠ¨æ€å¯¹è±¡ä¸åœºæ™¯çš„å…¶ä»–éƒ¨åˆ†æ··åˆèµ·æ¥ã€‚*è·ç¦»åœºé—´æ¥é˜´å½±*ï¼ˆDistance Field Indirect Shadowsï¼‰ DFIS ä½¿ä½ èƒ½å¤Ÿä¸ºç”¨äºé—´æ¥å…‰ç…§åŒºåŸŸä¸­çš„åŒºåŸŸé˜´å½±çš„å•ä¸ªé™æ€ç½‘æ ¼ä½“ç”Ÿæˆç½‘æ ¼ä½“è·ç¦»åœºã€‚åœ¨è¿™äº›åŒºåŸŸä¸­ï¼Œä¼ ç»Ÿçš„é˜´å½±è´´å›¾æ–¹æ³•è¡¨ç°ä¸ä½³ã€‚

è·ç¦»åœºé—´æ¥é˜´å½±çš„å·¥ä½œåŸç†ä¸ç”¨äºéª¨æ¶ç½‘æ ¼ä½“çš„èƒ¶å›Šä½“é˜´å½±çš„ç›¸ä¼¼ï¼Œéƒ½æ˜¯ä½¿ç”¨åœ¨ç…§æ˜æ„å»ºè¿‡ç¨‹ä¸­ç”Ÿæˆçš„é¢„è®¡ç®—ç…§æ˜æ ·æœ¬ã€‚è¿™äº›ç…§æ˜æ ·æœ¬ä½¿ç”¨ä½“ç§¯å…‰ç…§è´´å›¾æ¥ç¡®å®šé—´æ¥ç…§æ˜çš„æ–¹å‘æ€§å’Œå¼ºåº¦ã€‚

åœ¨é™æ€ç½‘æ ¼ä½“ç¼–è¾‘å™¨ï¼ˆStatic Mesh Editorï¼‰ä¸­è®¾ç½®è·ç¦»åœºé—´æ¥é˜´å½±ï¼›

- åŒå‡»ä»»æ„é™æ€ç½‘æ ¼ä½“ï¼Œæ‰“å¼€ç½‘æ ¼ç¼–è¾‘å™¨ï¼Œä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨æ¥è‡ªå¤ªé˜³ç¥åº™ Sun Temple é¡¹ç›®çš„é›•å¡‘ *SM_Statue*ã€‚
- å¯ç”¨ Details -> Static Mesh Settings -> Generate Mesh Distance Fieldsã€‚
- ä»å†…å®¹æµè§ˆå™¨é€‰æ‹© *SM_Statue* ç½‘æ ¼ä½“å¹¶å°†å®ƒæ‹–åŠ¨åˆ°å…³å¡è§†å£ä¸­ï¼Œåœ¨å…¶ä¸­ï¼Œä½ ä¼šç•™æ„åˆ°è¯¥é™æ€ç½‘æ ¼ä½“æ²¡æœ‰é˜´å½±ã€‚
- åœ¨å…³å¡ä¸­é€‰ä¸­è¯¥ Actor ä¹‹åï¼Œè®¾ç½® Details -> Mobility ä¸º Movableã€‚
- å¹¶ä¸”å¯ç”¨ Lighting -> Distance Field Indirect Shadowã€‚
- å¦‚æœåœºæ™¯å°šæœªè¿›è¡Œç…§æ˜æ„å»ºï¼Œä½¿ç”¨ä¸»å·¥å…·æ æ„å»ºæŒ‰é’®æ¥ä¸ºåœºæ™¯æ„å»ºç…§æ˜ã€‚



# ğŸŒŸ Niagara VFX
- Niagara VFX è§†è§‰æ•ˆæœç³»ç»Ÿ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/Niagara/
- Niagara å¿«é€Ÿå…¥é—¨ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/Niagara/QuickStart/

Cascade å’Œ Niagara éƒ½å¯ç”¨äºåœ¨è™šå¹»å¼•æ“(UE4)å†…åˆ›å»ºè§†è§‰æ•ˆæœ(VFX)ï¼Œä½†ä»åˆ›å»ºå’Œè°ƒæ•´ VFX çš„æ–¹å¼æ¥çœ‹ï¼Œå®ƒä»¬æœ‰å¾ˆå¤§ä¸åŒã€‚

Niagara æ˜¯è™šå¹»å¼•æ“çš„æ¬¡ä¸–ä»£ VFX ç³»ç»Ÿï¼ŒæŠ€æœ¯ç¾æœ¯å¸ˆèƒ½å¤Ÿè‡ªè¡Œåˆ›å»ºé¢å¤–åŠŸèƒ½ï¼Œè€Œæ— éœ€ç¨‹åºå‘˜çš„ååŠ©ã€‚ç³»ç»Ÿè®¾è®¡å¾—å…·æœ‰æ›´é«˜é€‚åº”æ€§å’Œçµæ´»æ€§ï¼ŒåŒæ—¶ä½¿å…¶æ˜“ç”¨ã€æ˜“ç†è§£ã€‚

Cascade æ˜¯è™šå¹»å¼•æ“ä½¿ç”¨å¤šå¹´çš„ VFX ç³»ç»Ÿï¼Œä¼˜ç‚¹å¦‚ä¸‹ï¼š

- Cascade å¯å¿«é€Ÿæ·»åŠ è¡Œä¸ºï¼Œæ¨¡å—å±‚ã€å †æ ˆå’Œäº¤äº’ä¹‹é—´é…åˆæä½³ã€‚
- éæŠ€æœ¯ç±»çš„ç¾æœ¯å¸ˆä¹Ÿèƒ½çµæ´»æ§åˆ¶ï¼Œå¹¶ä½¿ç”¨ä¸€å¥—é€šç”¨è¡Œä¸ºã€‚
- å †æ ˆèŒƒå¼åˆ™æä¾›äº†å¤§é‡ä¿¡æ¯ï¼Œä¸”ä¸€ç›®äº†ç„¶ã€‚

ä½† Cascade ä¹Ÿå­˜åœ¨ä¸€äº›ç¼ºé™·ï¼š

- Cascade åŠŸèƒ½å›ºå®šã€‚åªæœ‰ç¨‹åºå‘˜æ‰èƒ½æ›´æ”¹ã€æ·»åŠ æˆ–ç§»é™¤åŠŸèƒ½ã€‚
- å‘ç³»ç»Ÿæ·»åŠ å†…å®¹ä¼šä½¿ç²’å­æœ‰æ•ˆè·è½½é£™å‡ã€‚
- ç²’å­ç³»ç»Ÿå’Œå¼•æ“å…¶ä½™éƒ¨åˆ†ä¹‹é—´å‡ ä¹æ— æ³•å®ç°æ•°æ®å…±äº«ã€‚
- äº‹ä»¶æœ‰é™ä¸”è¾ƒä¸ºç¹çã€‚
- CPUæ¨¡æ‹Ÿå’ŒGPUæ¨¡æ‹Ÿå·®å¼‚å¾ˆå¤§ã€‚

æ–° VFX ç³»ç»Ÿçš„ç›®æ ‡æ˜¯ï¼š

- ç¾æœ¯å¸ˆå¯å…¨æƒæŒæ§æ•ˆæœã€‚
- å„è½´å‡å¯ç¼–ç¨‹ã€å¯è‡ªå®šä¹‰ã€‚
- æä¾›æ›´å¥½çš„è°ƒè¯•ã€æ˜¾ç¤ºå’Œæ€§èƒ½å·¥å…·ã€‚
- æ”¯æŒæ¥è‡ªè™šå¹»å¼•æ“ 4 å…¶ä»–éƒ¨åˆ†æˆ–å¤–éƒ¨æºçš„æ•°æ®ã€‚
- ä¸å¦¨ç¢ç”¨æˆ·æ“ä½œã€‚

Niagara VFX ç³»ç»Ÿå…±æœ‰å››å¤§æ ¸å¿ƒç»„ä»¶ï¼š

- Systems ç³»ç»Ÿ
- Emitters å‘å°„å™¨
- Modules æ¨¡å—
- Parameters å‚æ•°

Niagara ç³»ç»ŸåŒ…å«å¤šä¸ªå‘å°„å™¨ï¼Œç»“åˆåå¯äº§ç”Ÿä¸€ç§æ•ˆæœã€‚ä¾‹å¦‚åˆ¶ä½œçƒŸèŠ±æ•ˆæœï¼Œå¯èƒ½éœ€è¦å¤šæ¬¡çˆ†å‘ã€‚ä¸ºæ­¤éœ€åˆ›å»ºå¤šä¸ªå‘å°„å™¨ï¼Œå¹¶æ”¾ç½®åœ¨åä¸º Firework çš„ Niagara ç³»ç»Ÿä¸­ã€‚ åœ¨ Niagara ç³»ç»Ÿç¼–è¾‘å™¨ä¸­ï¼Œå¯åœ¨ç³»ç»Ÿä¸­ä¿®æ”¹æˆ–è¦†ç›–å‘å°„å™¨æˆ–æ¨¡å—å†…çš„ä»»ä½•å†…å®¹ã€‚ç³»ç»Ÿç¼–è¾‘å™¨ä¸­çš„æ—¶é—´è½´ï¼ˆTimelineï¼‰é¢æ¿å°†æ˜¾ç¤ºç³»ç»ŸåŒ…å«çš„å‘å°„å™¨ï¼Œå¹¶å¯ç”¨äºç®¡ç†æ­¤ç±»å‘å°„å™¨ã€‚ å‘å°„å™¨ç¼–è¾‘å™¨å’Œç³»ç»Ÿç¼–è¾‘å™¨å¤§è‡´ç›¸åŒã€‚

Niagara å‘å°„å™¨åŒ…å«æ¨¡å—ã€‚å…¶ç”¨é€”å•ä¸€ï¼Œä½†å¯é‡å¤ä½¿ç”¨ã€‚Niagara å‘å°„å™¨çš„ä¸€å¤§ç‹¬ç‰¹ä¹‹å¤„åœ¨äºï¼Œå¯ä½¿ç”¨æ¨¡å—å †æ ˆåˆ›å»ºæ¨¡æ‹Ÿï¼Œå¹¶åœ¨åŒä¸€å‘å°„å™¨ä¸­ä»¥å¤šç§æ–¹å¼è¿›è¡Œæ¸²æŸ“ã€‚ç»§ç»­ä»¥çƒŸèŠ±æ•ˆæœä¸ºä¾‹ï¼Œå¯åˆ›å»ºä¸€ä¸ªå‘å°„å™¨ï¼Œå…¶ä¸­åŒ…å«ç”¨äºç«èŠ±çš„ sprite æ¸²æŸ“å™¨ï¼Œå’Œç”¨äºç«èŠ±ä¹‹åæµå…‰æ•ˆæœçš„æ¡å¸¦æ¸²æŸ“å™¨ã€‚ 

Niagara æ¨¡å—ç­‰åŒäº Cascade çš„è¡Œä¸ºã€‚æ¨¡å—å°†ä¸ä¸€èˆ¬æ•°æ®é€šä¿¡ã€å°è£…è¡Œä¸ºï¼Œä¸å…¶ä»–æ¨¡å—å †æ ˆï¼Œå¹¶å†™å…¥å‡½æ•°ã€‚ ä½¿ç”¨é«˜çº§ç€è‰²è¯­è¨€ï¼ˆHLSLï¼‰ç¼–è¯‘æ¨¡å—ï¼Œä½†å¯ç”¨èŠ‚ç‚¹åœ¨å›¾è¡¨ä¸­è¿›è¡Œå¯è§†åŒ–ç¼–è¯‘ã€‚å¯åˆ›å»ºå‡½æ•°ï¼ŒåŒ…æ‹¬è¾“å…¥ï¼Œæˆ–å†™å…¥åˆ°å€¼æˆ–å‚æ•°å›¾ã€‚ç”šè‡³å¯ä½¿ç”¨å›¾è¡¨ä¸­çš„ CustomHLSL èŠ‚ç‚¹å†™å…¥ HLSL å†…è”ä»£ç ã€‚

å‚æ•°æ˜¯ Niagara æ¨¡æ‹Ÿä¸­çš„æ•°æ®çš„æŠ½è±¡è¡¨ç°ï¼Œå…±æœ‰å››ç§å‚æ•°ï¼š

- å›¾å…ƒï¼ˆPrimitiveï¼‰ï¼šæ­¤ç±»å‚æ•°å®šä¹‰ä¸åŒç²¾åº¦å’Œé€šé“å®½åº¦çš„æ•°å€¼æ•°æ®ã€‚
- æšä¸¾ï¼ˆEnumï¼‰ï¼šæ­¤ç±»å‚æ•°å®šä¹‰ä¸€ç»„å›ºå®šçš„æŒ‡å®šå€¼ï¼Œå¹¶å–å…¶ä¸­ä¸€ä¸ªæŒ‡å®šå€¼ã€‚
- ç»“æ„ä½“ï¼ˆStructï¼‰ï¼šæ­¤ç±»å‚æ•°å®šä¹‰ä¸€ç»„å›¾å…ƒå’Œæšä¸¾ç±»å‹çš„ç»„åˆã€‚
- æ•°æ®æ¥å£ï¼ˆData Interfacesï¼‰ï¼šæ­¤ç±»å‚æ•°å®šä¹‰ä»å¤–éƒ¨æ•°æ®æºä¸­æä¾›æ•°æ®çš„å‡½æ•°ã€‚æ­¤å¯ä¸ºUE4å…¶ä»–éƒ¨åˆ†ä¸­çš„æ•°æ®ï¼Œæˆ–å¤–éƒ¨åº”ç”¨ç¨‹åºä¸­çš„æ•°æ®ã€‚

Niagara ä¸­çš„ç²’å­æ¨¡æ‹Ÿé‡‡ç”¨å †æ ˆçš„å½¢å¼è¿è¡Œã€‚æ¨¡æ‹Ÿä»å †æ ˆé¡¶éƒ¨æµå‘åº•éƒ¨ï¼Œä¾æ¬¡æ‰§è¡Œåä¸ºæ¨¡å—çš„å¯ç¼–ç¨‹ä»£ç å—ã€‚é‡è¦çš„æ˜¯ï¼Œæ¯ä¸ªæ¨¡å—éƒ½ä¼šè¢«åˆ†é…åˆ°ä¸€ä¸ªåˆ†ç»„ä¸­ï¼Œè¯¥åˆ†ç»„ä¼šæè¿°è¯¥æ¨¡å—çš„æ‰§è¡Œæ—¶é—´ã€‚

ä¾‹å¦‚ï¼Œåˆå§‹åŒ–ç²’å­çš„æ¨¡å—æˆ–ç²’å­ç”Ÿæˆæ—¶èµ·ä½œç”¨çš„æ¨¡å—ä½äºç²’å­ç”Ÿæˆç»„ä¸­ã€‚

æ¯ä¸ªç»„ä¸­éƒ½æœ‰å¤šä¸ªé˜¶æ®µï¼Œä¼šåœ¨ä¸€ä¸ªç³»ç»Ÿçš„ç”Ÿå‘½å‘¨æœŸå†…çš„ç‰¹å®šæ—¶é—´ç‚¹ä¸Šè°ƒç”¨å®ƒä»¬ã€‚ å‘å°„å™¨ã€ç³»ç»Ÿå’Œç²’å­éƒ½é»˜è®¤å…·æœ‰ç”Ÿæˆå’Œæ›´æ–°é˜¶æ®µã€‚ç”Ÿæˆé˜¶æ®µä¼šåœ¨ç»„å­˜åœ¨çš„ç¬¬ä¸€å¸§å†…è¢«è§¦å‘ã€‚

ä¾‹å¦‚ï¼Œç³»ç»Ÿä¼šåœ¨å…³å¡å†…é¦–æ¬¡å®ä¾‹åŒ–å¹¶è¢«æ¿€æ´»æ—¶è§¦å‘å…¶ç”Ÿæˆé˜¶æ®µã€‚ç²’å­ä¼šåœ¨å‘å°„å™¨å‘å°„ç²’å­æ—¶è§¦å‘å…¶ç”Ÿæˆé˜¶æ®µï¼Œåœ¨æ¯ä¸ªæ–°ç²’å­è¢«åˆ›å»ºå‡ºæ¥æ—¶å°†æ‰§è¡Œç”ŸæˆæŒ‡ä»¤ã€‚æ›´æ–°é˜¶æ®µä¼šåœ¨ç³»ç»Ÿã€å‘å°„å™¨æˆ–ç²’å­è¢«æ¿€æ´»çš„æ¯ä¸€å¸§ä¸­è§¦å‘ã€‚

æ­¤å¤–è¿˜æœ‰å…¶ä»–é«˜çº§é˜¶æ®µï¼Œå¦‚äº‹ä»¶å’Œæ¨¡æ‹Ÿé˜¶æ®µã€‚å®ƒä»¬å¯ä»¥è¢«æ·»åŠ åˆ°ç”Ÿæˆå’Œæ›´æ–°æµç¨‹ä¸­ã€‚æ¯å½“ç²’å­ç”Ÿæˆä¸€ä¸ªæ–°äº‹ä»¶ï¼Œå¹¶è®¾ç½®ä¸€ä¸ªå‘å°„å™¨å»å¤„ç†è¯¥äº‹ä»¶æ—¶ï¼Œå°±ä¼šè§¦å‘ äº‹ä»¶ã€‚å¦‚æœæœ‰å¯èƒ½ï¼Œäº‹ä»¶å¥æŸ„é˜¶æ®µä¼šå‘ç”Ÿåœ¨åŒä¸€å¸§ä¸­ï¼Œä½†ä½äºå‘èµ·äº‹ä»¶ä¹‹åã€‚æ¨¡æ‹Ÿé˜¶æ®µ æ˜¯ä¸€ä¸ªé«˜çº§GPUåŠŸèƒ½ã€‚è¯¥åŠŸèƒ½å¯è®©ä¸€ä¸ªåºåˆ—ä¸­å‘ç”Ÿå¤šä¸ªç”Ÿæˆå’Œæ›´æ–°é˜¶æ®µï¼Œå¯¹äºæ„å»ºæµä½“æ¨¡æ‹Ÿä¹‹ç±»çš„å¤æ‚ç»“æ„éå¸¸æœ‰ç”¨ã€‚

åˆ›å»ºå‘å°„å™¨æ—¶ï¼Œä½ éœ€è¦å°†æ¨¡å—æ”¾å…¥å †æ ˆï¼Œä»¥ä¾¿å®šä¹‰å¤–è§‚æ•ˆæœä»¥åŠè¦é‡‡å–çš„æ“ä½œç­‰ã€‚åœ¨ å‘å°„å™¨ç”Ÿæˆï¼ˆEmitter Spawnï¼‰ ç»„ä¸­ï¼Œæ”¾ç½®çš„æ¨¡å—ç”¨äºå®šä¹‰å‘å°„å™¨é¦–æ¬¡ç”Ÿæˆæ—¶çš„æ•ˆæœã€‚åœ¨ å‘å°„å™¨æ›´æ–°ï¼ˆEmitter Updateï¼‰ ç»„ä¸­ï¼Œæ”¾ç½®çš„æ¨¡å—ç”¨äºéšæ—¶é—´æŒç»­å½±å“å‘å°„å™¨ã€‚åœ¨ ç²’å­ç”Ÿæˆï¼ˆParticle Spawnï¼‰ ç»„ä¸­ï¼Œæ”¾ç½®çš„æ¨¡å—ç”¨äºå®šä¹‰å‘å°„å™¨ä¸­ç”Ÿæˆç²’å­æ—¶çš„æ•ˆæœã€‚åœ¨ ç²’å­æ›´æ–°ï¼ˆParticle Updateï¼‰ ç»„ä¸­ï¼Œæ”¾ç½®çš„æ¨¡å—ç”¨äºéšæ—¶é—´æŒç»­å½±å“ç²’å­ã€‚åœ¨ äº‹ä»¶å¤„ç†å‡½æ•°ï¼ˆEvent Handlersï¼‰ ç»„ä¸­ï¼Œä½ å¯ä»¥åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªç”¨äºå®šä¹‰ç‰¹å®šæ•°æ®çš„å‘å°„å™¨ä¸­åˆ›å»º"ç”Ÿæˆ"äº‹ä»¶ã€‚ç„¶åä½ å¯ä»¥åœ¨å…¶ä»–å‘å°„å™¨ä¸­åˆ›å»ºç›‘å¬äº‹ä»¶ï¼Œè¿™äº›å‘å°„å™¨ä¼šæ ¹æ®ç”Ÿæˆçš„äº‹ä»¶è§¦å‘ç‰¹å®šè¡Œä¸ºã€‚

ä½ å¯ä»¥å°†å„ä¸ªå•ç‹¬çš„å‘å°„å™¨ç»„æˆä¸€ä¸ªç³»ç»Ÿï¼Œä»è€ŒåˆåŠ›è¡¨ç°å‡ºä½ æƒ³è¦çš„æ•´ä½“è§†è§‰æ•ˆæœã€‚æœ‰äº›æ¨¡å—æ˜¯ç‰¹å®šäºç³»ç»Ÿçš„ï¼›å½“ä½ ç¼–è¾‘ç³»ç»Ÿè€Œéå‘å°„å™¨æ—¶ï¼Œç¼–è¾‘å™¨çš„éƒ¨åˆ†å…ƒç´ ä¼šå±•ç°å‡ºä¸åŒè¡Œä¸ºã€‚åœ¨Niagaraç¼–è¾‘å™¨ä¸­ç¼–è¾‘ç³»ç»Ÿæ—¶ï¼Œä½ å¯ä»¥æ›´æ”¹æˆ–è¦†ç›–åŒ…å«åœ¨ç³»ç»Ÿä¸­çš„å‘å°„å™¨çš„æ¨¡å—ã€‚ä½ è¿˜å¯åˆ©ç”¨Niagaraç¼–è¾‘å™¨çš„æ—¶é—´è½´ï¼ˆTimelineï¼‰é¢æ¿æ¥ç®¡ç†ç³»ç»Ÿä¸­æ‰€åŒ…å«çš„å‘å°„å™¨çš„è®¡æ—¶ã€‚

ä»¥ç©å®¶è§’è‰²çš„è„šéƒ¨é™„è¿‘è¸©è¸å¼•èµ·çš„ç²‰å°˜æ•ˆæœä¸ºä¾‹ï¼Œä½¿ç”¨ Niagara ç³»ç»Ÿå‰ï¼Œè¯·åœ¨æè´¨ç¼–è¾‘å™¨ä¸­å®Œæˆä»¥ä¸‹è®¾ç½®ï¼š

- é€‰ä¸­ä¸»è¦æè´¨èŠ‚ç‚¹åï¼Œè®¾ç½® Details -> Material -> Blend Mode ä¸ºåŠé€æ˜ï¼ˆ*Translucent*ï¼‰ï¼Œå¹¶å‹¾é€‰åŒé¢ï¼ˆ*Two Sided*ï¼‰å¤é€‰æ¡†ï¼Œå°†å…¶ä»–è®¾ç½®ä¿ç•™ä¸ºé»˜è®¤ã€‚
- é€šè¿‡å›¾è¡¨ç©ºç™½åŒºå³é”®èœå•ï¼Œæ·»åŠ ç²’å­é¢œè‰² Particle -> Particle Colorï¼Œå¹¶å°†èŠ‚ç‚¹çš„é¡¶éƒ¨è¾“å‡ºæ’å…¥åˆ°ä¸»æè´¨èŠ‚ç‚¹ä¸Šçš„åº•è‰²ï¼ˆBase Colorï¼‰ è¾“å…¥ã€‚
- åˆ›å»º Texture Sample èŠ‚ç‚¹ï¼Œè®¾ç½®çº¹ç† Details  -> Material Expression Texture Base -> Textureï¼Œä»ä¸‹æ‹‰åˆ—è¡¨æœç´¢å™ªç‚¹ï¼ˆNoiseï¼‰ï¼Œé€‰æ‹© *T_Perlin_Noise_M* çº¹ç†ã€‚
- åˆ›å»º Value Step èŠ‚ç‚¹ï¼Œè¿æ¥ Texture Sample èŠ‚ç‚¹çš„ R è¾“å‡ºåˆ°æ¢¯åº¦ï¼ˆ*Gradient*ï¼‰è¾“å…¥ã€‚
- åˆ›å»º Dynamic Parameter èŠ‚ç‚¹ï¼Œè®¾ç½®å‚æ•°æ•°ç»„ Details -> Material Expression Dynamic Parameterï¼ŒæŒ‡å®šæ•°ç»„ 0 å…ƒç´ çš„åç§°ä¸º *Erode*ã€‚
- å¹¶åŠ¨æ€å‚æ•°èŠ‚ç‚¹çš„ *Erode* è¿æ¥åˆ° Value Step èŠ‚ç‚¹çš„é®ç½©åç§»å€¼ï¼ˆ*Mask Offset Value*ï¼‰è¾“å…¥ã€‚
- å°† Value Step èŠ‚ç‚¹çš„ç»“æœï¼ˆ*Results*ï¼‰è¿æ¥åˆ°ä¸»æè´¨èŠ‚ç‚¹çš„ä¸é€æ˜åº¦ï¼ˆ*Opacity*ï¼‰è¾“å…¥ã€‚
- ç‚¹å‡»åº”ç”¨ï¼ˆApplyï¼‰å’Œä¿å­˜ï¼ˆSaveï¼‰ï¼Œç„¶åå…³é—­æè´¨ç¼–è¾‘å™¨ï¼ˆMaterial Editorï¼‰ã€‚

æ¥ä¸‹æ¥å°†åˆ›å»º Niagara ç³»ç»Ÿï¼Œä¸ Cascade ä¸åŒï¼ŒNiagara ä¸­çš„å‘å°„å™¨å’Œç³»ç»Ÿç›¸äº’ç‹¬ç«‹ã€‚ç›®å‰æ¨èçš„å·¥ä½œæµç¨‹æ˜¯ä»ç°æœ‰å‘å°„å™¨æˆ–å‘å°„å™¨æ¨¡æ¿åˆ›å»ºç³»ç»Ÿã€‚

- é¦–å…ˆï¼Œåœ¨å†…å®¹æµè§ˆå™¨åˆ›å»ºï¼ˆNiagara Systemï¼‰ï¼Œé€‰æ‹© Show -> FX -> Niagara System æ‰“å¼€å‘å¯¼ã€‚
- é€‰æ‹© New system from selected emittersã€‚
- åœ¨æ¨¡æ¿ï¼ˆTemplateï¼‰ä¸­ï¼Œé€‰æ‹©ï¼ˆSimple Sprite Burstï¼‰ã€‚ç‚¹å‡»åŠ å·å›¾æ ‡ï¼ˆ+ï¼‰ï¼Œå°†å‘å°„å™¨æ·»åŠ åˆ°è¦æ·»åŠ åˆ°ç³»ç»Ÿçš„å‘å°„å™¨åˆ—è¡¨ä¸­ã€‚
- æ·»åŠ å‘å°„å™¨å¹¶å®Œæˆï¼Œå°†ç³»ç»Ÿå‘½åä¸º *FX_FootstepDustPoof*ï¼ŒåŒå‡»æ‰“å¼€ Niagara Editorã€‚
- å°†æ–°ç³»ç»Ÿä¸­å‘å°„å™¨å®ä¾‹çš„é»˜è®¤å SimpleSpriteBurst ä¿®æ”¹ä¸º *FX_DustPoof*ï¼Œåœ¨ç³»ç»Ÿæ€»è§ˆä¸­ç‚¹å‡»å‘å°„å™¨å®ä¾‹çš„åç§°ï¼Œå…¶å°†å˜ä¸ºå¯ç¼–è¾‘ã€‚
- é™¤éåœ¨æ¸²æŸ“å™¨ä¸­è®¾ç½®ç½‘æ ¼ä½“å’Œæè´¨ï¼Œå¦åˆ™åœ¨é¢„è§ˆä¸­çœ‹ä¸åˆ°ä»»ä½•å†…å®¹ã€‚
- åœ¨ System Overview å›¾è¡¨ä¸­é€‰æ‹©æ¸²æŸ“å™¨ï¼ˆRenderï¼‰ï¼Œå®ƒä¼šåœ¨ï¼ˆSelectionï¼‰é¢æ¿ä¸­æ‰“å¼€ã€‚
- ç‚¹å‡»åƒåœ¾æ¡¶å›¾æ ‡ï¼Œåˆ é™¤ï¼ˆ*Sprite Renderer*ï¼‰ï¼Œç‚¹å‡»åŠ å·ï¼ˆ+ï¼‰å›¾æ ‡æ·»åŠ ç½‘æ ¼ä½“æ¸²æŸ“å™¨ï¼ˆ*Mesh Renderer*ï¼‰ã€‚
- ç‚¹å‡»ç²’å­ç½‘æ ¼ä½“ï¼ˆ*Particle Mesh*ï¼‰æ—è¾¹çš„ä¸‹æ‹‰åˆ—è¡¨ï¼Œç„¶åé€‰æ‹©ä¸€ä¸ªç”¨äºç²’å­æ•ˆæœçš„ç½‘æ ¼ä½“ã€‚
- å¯ç”¨è¦†ç›–æè´¨ï¼ˆOverride Materialsï¼‰ï¼Œç‚¹å‡»åŠ å·ï¼ˆ+ï¼‰å›¾æ ‡æ·»åŠ æ•°ç»„å…ƒç´ ã€‚ç‚¹å‡»ï¼ˆExplicit Materialï¼‰æ—è¾¹çš„ä¸‹æ‹‰åˆ—è¡¨ï¼Œç„¶åé€‰æ‹©åœ¨å‰é¢åˆ›å»ºçš„æè´¨ã€‚
- è®¾ç½®ï¼ˆFacing Modeï¼‰ä¸ºï¼ˆ*Velocity*ï¼‰ã€‚
- åœ¨å†…å®¹æµè§ˆå™¨ä¸­ï¼Œå°† Niagara ç³»ç»Ÿæ‹–å…¥å…³å¡ã€‚å°†å…¶æ”¾ç½®åœ¨ç©å®¶è§’è‰²çš„è„šéƒ¨é™„è¿‘ï¼Œæ£€æŸ¥è§’è‰²ç›¸å…³æ•ˆæœçš„å¤§å°å’Œå½¢çŠ¶ã€‚

åˆ¶ä½œç²’å­æ•ˆæœæ—¶ï¼Œæœ€å¥½å°†ç³»ç»Ÿæ‹–å…¥å…³å¡ï¼Œè¿™æ ·ä½ å°±èƒ½äº†è§£æ¯é¡¹æ›´æ”¹çš„æ•ˆæœå¹¶åœ¨æƒ…å¢ƒä¸­ç¼–è¾‘ã€‚

å®Œæˆä»¥ä¸Šæ“ä½œï¼Œå°±æ‹¥æœ‰äº† Niagara ç³»ç»Ÿå’Œå‘å°„å™¨å®ä¾‹ï¼Œå¹¶ä¸”å·²å°†ç³»ç»Ÿæ‹–å…¥å…³å¡ï¼ˆLevelï¼‰ï¼Œä»¥ä¾¿åœ¨ç©å®¶è§’è‰²ï¼ˆPlayer Characterï¼‰æ—è¾¹é¢„è§ˆã€‚åœ¨ä¸‹ä¸€éƒ¨åˆ†ä¸­ï¼Œä½ å°†åœ¨ Niagara ç³»ç»Ÿä¸­ç¼–è¾‘è®¾ç½®ï¼Œåˆ›å»ºå°˜äº‘æ•ˆæœã€‚



ç°åœ¨è¦å°†æ­¤æ•ˆæœæ·»åŠ åˆ°è§’è‰²çš„å¥”è·‘åŠ¨ç”»ä¸­ï¼Œä¹Ÿå¯ä»¥ç”¨è¿™äº›æ­¥éª¤å°† Niagara æ•ˆæœæ·»åŠ åˆ°è™šå¹»å¼•æ“ä¸­çš„ä»»æ„è§’è‰²èº«ä¸Šã€‚

- åœ¨å†…å®¹æµè§ˆå™¨ä¸­ï¼Œå¯¼èˆªåˆ°äººä½“æ¨¡å‹ Mannequin -> Animationsã€‚åŒå‡» ThirdPersonRun åŠ¨ç”»ï¼Œå°†å…¶åœ¨åŠ¨ç”»ç¼–è¾‘å™¨ä¸­æ‰“å¼€ã€‚
- åœ¨åŠ¨ç”»æ—¶é—´è½´ï¼ˆAnimation timelineï¼‰ä¸­ç‚¹å‡» Pause å¯æš‚åœå¾ªç¯åŠ¨ç”»ã€‚ä½¿ç”¨æ»‘åŠ¨æŒ‡é’ˆæ‰¾åˆ°è§’è‰²å³è„šæ¥è§¦åœ°é¢çš„ç¬é—´ï¼Œä½ éœ€è¦åœ¨è¯¥ä½ç½®æ·»åŠ å°˜åœŸæ•ˆæœã€‚
- æ‰¾åˆ°é€šçŸ¥ï¼ˆNotifiesï¼‰ï¼Œå€ŸåŠ©é€šçŸ¥ï¼Œä½ å¯ä»¥åœ¨åŠ¨ç”»ä¸Šçš„æŸä¸ªä½ç½®è¿›è¡Œæ ‡è®°ï¼Œä»¥ä¾¿æ’­æ”¾ç²’å­æ•ˆæœã€‚ä¼šçœ‹åˆ°ä¸€æ¡ä½äºæ—¶é—´è½´æ‹–åŠ¨æ¡ä¸‹æ–¹çš„ç›´çº¿ã€‚å³é”®ç‚¹å‡»è¯¥ç›´çº¿ï¼Œç„¶åé€‰æ‹© Add Notify -> Play Niagara Particle Effectã€‚è¿™æ ·å°±èƒ½åœ¨åŠ¨ç”»ä¸­çš„è¯¥ç‚¹ä½ç½®ä¸Šæ”¾ç½®ä¸€ä¸ªæ ‡è®°ï¼Œå¹¶ä¸”å¸¦æœ‰é»˜è®¤æ ‡ç­¾ PlayNiagaraEffectã€‚
- é€‰ä¸­ PlayNiagaraEffectï¼Œè®¾ç½® Details -> Anim Notifyï¼Œåœ¨æ­¤å¤„é€‰æ‹©è¦æ·»åŠ åˆ°åŠ¨ç”»ä¸­çš„ Niagara ç³»ç»Ÿã€‚
- ç‚¹å‡» Niagara System æ—è¾¹çš„ä¸‹æ‹‰èœå•ï¼Œç„¶åé€‰æ‹©åœ¨ Niagara ä¸­åˆ›å»ºçš„ FX_FootstepDustPoof ç³»ç»Ÿã€‚é€šçŸ¥ä¸Šçš„æ ‡ç­¾æ›´æ”¹ä¸º FX_FootstepDustPoofã€‚
- é€‰æ‹© FX_FootstepDustPoof ç³»ç»Ÿï¼Œå¯¹å·¦è„šé‡å¤ä¸Šè¿°æ­¥éª¤ã€‚




# ğŸŒŸ Particle Systems çº§è”ç²’å­ç³»ç»Ÿ
- çº§è”ç²’å­ç³»ç»Ÿ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/ParticleSystems/
- æ•°æ®åˆ†å¸ƒç±»å‹ https://docs.unrealengine.com/4.27/zh-CN/Basics/Distributions
- ç²’å­ç³»ç»Ÿå‚è€ƒ https://docs.unrealengine.com/4.27/zh-CN/RenderingAndGraphics/ParticleSystems/Reference/

è™šå¹»å¼•æ“å†…åŒ…å«äº†ä¸€å¥—æä¸ºå¼ºå¤§å¹¶å¥å£®çš„ç²’å­ç³»ç»Ÿï¼Œè®©ç¾æœ¯äººå‘˜èƒ½å¤Ÿåˆ›å»ºä»¤äººç ç›®ç»“èˆŒçš„è§†è§‰ç‰¹æ•ˆï¼Œä»çƒŸé›¾ã€ç«æ˜Ÿã€ç«ç„°ï¼Œåˆ°æå…¶å¤æ‚çš„å¹»æƒ³ä¸­æ‰æœ‰çš„æ•ˆæœã€‚

è™šå¹»çš„ç²’å­ç³»ç»Ÿç”± Cascade Editor æ¥ç¼–è¾‘ï¼Œè¿™æ˜¯ä¸€ä¸ªå®Œå…¨æ•´åˆå¹¶æ¨¡å—åŒ–çš„ç²’å­ç‰¹æ•ˆç¼–è¾‘å™¨ã€‚çº§è”ä¸ºç¼–è¾‘ç‰¹æ•ˆæä¾›äº†å®æ—¶çš„åé¦ˆï¼Œèƒ½å¤Ÿè®©å³ä¾¿æ˜¯éå¸¸å¤æ‚çš„ç‰¹æ•ˆï¼Œåˆ¶ä½œè¿‡ç¨‹ä¹Ÿå˜å¾—æ›´ä¸ºå¿«æ·å®¹æ˜“ã€‚

ç²’å­ç³»ç»Ÿä¹Ÿå’Œæ¯ä¸ªç²’å­ä¸Šä½¿ç”¨çš„å„ç§æè´¨ä»¥åŠè´´å›¾ç´§å¯†ç›¸å…³ã€‚ç²’å­ç³»ç»Ÿè‡ªèº«ä¸»è¦çš„åŠŸèƒ½æ˜¯è¦æ§åˆ¶ç²’å­çš„è¡Œä¸ºï¼Œç„¶åæ•´ä½“çš„çœ‹ç²’å­ç³»ç»Ÿæœ€ç»ˆçš„å±•ç°æ•ˆæœåˆ™é€šå¸¸å–å†³äºæè´¨çš„åšæ³•ã€‚

ç²’å­ç³»ç»Ÿå’Œçº§è”ç²’å­ç³»ç»Ÿç¼–è¾‘å™¨éƒ½æ˜¯çµæ´»å¹¶å¼ºå¤§çš„ï¼Œçº§è”çš„ä¸»è¦çš„æ¦‚å¿µå°±æ˜¯å¯¹ç²’å­ç³»ç»Ÿè¿›è¡Œæ¨¡å—åŒ–çš„è®¾è®¡ã€‚

åœ¨ä¸€äº›å…¶ä»–è½¯ä»¶çš„ç‰¹æ•ˆåŠŸèƒ½ä¸­ï¼Œæ¯”å¦‚ Mayaï¼Œä¸€ä¸ªç²’å­æ•ˆæœè¦åˆ›å»ºçš„è¯éœ€è¦å…ˆå®šä¹‰å¤§éƒ¨åˆ†è¡Œä¸ºçš„å±æ€§ï¼Œç„¶åç”¨æˆ·å†å¯¹è¿™äº›å±æ€§è¿›è¡Œä¿®æ”¹æ¥è·å¾—å¸Œæœ›ä¸­çš„æ•ˆæœã€‚

åœ¨çº§è”ç²’å­ç³»ç»Ÿä¸­ï¼Œåˆ™æ˜¯å¦å¤–ä¸€ç§åšæ³•ï¼Œä¸€ä¸ªç²’å­ç³»ç»Ÿåˆ›å»ºååªæœ‰å¾ˆå°‘çš„æœ€åŸºç¡€çš„å±æ€§ï¼Œä»¥åŠä¸€äº›è¡Œä¸ºæ¨¡å—ã€‚

æ¯ä¸ªæ¨¡å—ä»£è¡¨äº†ç²’å­è¡Œä¸ºçš„ä¸€ä¸ªç‰¹å®šæ–¹é¢ï¼Œå¹¶åªå¯¹è¡Œä¸ºçš„è¯¥æ–¹é¢æä¾›å±æ€§å‚æ•°ï¼Œæ¯”å¦‚é¢œè‰²ã€ç”Ÿæˆçš„ä½ç½®ã€ç§»åŠ¨è¡Œä¸ºã€ç¼©æ”¾è¡Œä¸ºï¼ŒåŠå…¶ä»–ç­‰ã€‚ç”¨æˆ·å¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™æ·»åŠ æˆ–è€…åˆ é™¤ä¸€ä¸ªæ¨¡å—ï¼Œæ¥è¿›ä¸€æ­¥å®šä¹‰ç²’å­çš„æ•´ä½“è¡Œä¸ºã€‚ç”±äºè¿™é‡Œçš„ç»“æœä¸­åªæœ‰å¿…è¦çš„æ¨¡å—æ‰ä¼šè¢«æ·»åŠ è¿›æ¥ï¼Œå› æ­¤å¹¶æ²¡æœ‰é¢å¤–çš„è®¡ç®—ï¼Œä¹Ÿæ²¡æœ‰ä¸éœ€è¦çš„å±æ€§å˜é‡çš„å‚ä¸ã€‚

æœ€æ£’çš„æ˜¯ï¼Œæ¨¡å—å¯ä»¥å¾ˆå®¹æ˜“çš„è¢«æ·»åŠ ã€åˆ é™¤ã€æ‹·è´ï¼Œç”šè‡³åœ¨ä¸€ä¸ªç²’å­ç³»ç»Ÿä¸­ä»å…¶ä»–å‘å°„å™¨å®ä¾‹åŒ–è¿‡æ¥ï¼Œä¸€æ—¦ç”¨æˆ·ç†Ÿæ‚‰äº†æœ‰å“ªäº›å¯ç”¨çš„æ¨¡å—å’Œå®ƒä»¬çš„åŠŸèƒ½åï¼Œåˆ¶ä½œä¸€ä¸ªå¤æ‚çš„ç²’å­ç³»ç»Ÿä¹Ÿä¼šå˜å¾—éå¸¸å®¹æ˜“ã€‚

æœ‰äº›æ¨¡å—åœ¨ç²’å­å‘å°„å™¨é»˜è®¤å­˜åœ¨ï¼ŒåŒ…æ‹¬ä¸¤ä¸ªé»˜è®¤çš„æ¨¡å— Required & Spawnã€‚å½“ä¸€ä¸ªç²’å­ç³»ç»Ÿçš„å…³é”®ç»„ä»¶ Sprite Emitter è¢«æ·»åŠ åˆ°ç²’å­ç³»ç»Ÿä¸­ï¼Œä»¥ä¸‹å‡ ä¸ªé»˜è®¤æ¨¡å—éƒ½ä¼šéšä¹‹åˆ›å»ºï¼š

- `Required` - è¿™é‡ŒåŒ…å«äº†ä¸€äº›å±æ€§ï¼Œéƒ½æ˜¯å¯¹ç²’å­ç³»ç»Ÿç»å¯¹éœ€è¦ç”¨åˆ°çš„å±æ€§ï¼Œæ¯”å¦‚ç²’å­ä½¿ç”¨çš„æè´¨ï¼Œå‘å°„å™¨å‘å°„ç²’å­çš„æ—¶é—´ï¼Œä»¥åŠå…¶ä»–ã€‚
- `Spawn` - è¿™ä¸ªæ¨¡å—æ§åˆ¶ç²’å­ä»å‘å°„å™¨ç”Ÿæˆçš„é€Ÿåº¦ï¼Œå®ƒä»¬æ˜¯å¦ä»¥ Burst ç”Ÿæˆï¼Œä»¥åŠå…¶ä»–å’Œç²’å­å‘ç”Ÿæ—¶æœºæœ‰å…³çš„å±æ€§ã€‚
- `Lifetime` - è¿™é‡Œå®šä¹‰äº†æ¯ä¸ªç²’å­åœ¨ç”Ÿæˆåå­˜åœ¨çš„æ—¶é—´ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªæ¨¡å—ï¼Œç²’å­åˆ™ä¼šä¸€ç›´æŒç»­ä¸‹å»ã€‚
- `Initial Size` - è¿™é‡Œå¯¹ç²’å­ç”Ÿæˆæ—¶çš„ç¼©æ”¾æ¯”ä¾‹è¿›è¡Œæ§åˆ¶ã€‚
- `Initial Velocity` - è¿™é‡Œå¯¹ç²’å­ç”Ÿæˆæ—¶çš„ç§»åŠ¨è¿›è¡Œæ§åˆ¶ã€‚
- `Color Over Life` - è¿™ä¸ªæ¨¡å—ç”¨äºæ§åˆ¶æ¯ä¸ªç²’å­çš„é¢œè‰²åœ¨è¿‡ç¨‹ä¸­å¦‚ä½•æ”¹å˜ã€‚

å…¶å®ƒå¯ç”¨äºå‘å°„å™¨ä¸Šçš„ç²’å­æ¨¡å—åˆ†ä¸ºä»¥ä¸‹å‡ ç§ç±»åˆ«ï¼š

- `Acceleration` ç”¨äºå¤„ç†ç²’å­åŠ é€Ÿè¡Œä¸ºçš„æ¨¡å—ï¼Œæ¯”å¦‚é€šè¿‡å®šä¹‰é˜»åŠ›ç­‰ã€‚
- `Attraction` é€šè¿‡ä¸åŒä½ç½®æ”¾ç½®å¼•åŠ›ç‚¹æ¥æ§åˆ¶ç²’å­ç§»åŠ¨çš„æ¨¡å—ã€‚
- `Camera` ç”¨äºç®¡ç†å¦‚ä½•åœ¨æ‘„åƒæœºç©ºé—´æ¥ç§»åŠ¨ç²’å­çš„æ¨¡å—ï¼Œèƒ½å¤Ÿå¤„ç†ç²’å­æ˜¯é è¿‘è¿˜æ˜¯è¿œç¦»æ‘„åƒæœºã€‚
- `Collision` ç”¨äºç®¡ç†ç²’å­å¦‚ä½•å’Œå…¶ä»–å‡ ä½•ä½“ç¢°æ’çš„æ¨¡å—ã€‚
- `Color` è¯¥åˆ†ç±»æ¨¡å—ç”¨äºæ”¹å˜ç²’å­çš„é¢œè‰²ã€‚
- `Event` è¯¥åˆ†ç±»æ¨¡å—æ§åˆ¶ç²’å­çš„äº‹ä»¶è§¦å‘ï¼Œè¿™å¯ä»¥ç”¨æ¥åœ¨æ¸¸æˆä¸­åšå„ç§å“åº”ã€‚
- `Kill` è¯¥åˆ†ç±»æ¨¡å—ç”¨äºå¤„ç†å•ä¸ªç²’å­çš„åˆ é™¤è¡Œä¸ºã€‚
- `Lifetime` è¯¥åˆ†ç±»æ¨¡å—ç”¨äºå¤„ç†ç²’å­å­˜åœ¨çš„æ—¶é—´ã€‚
- `Light` è¿™äº›æ¨¡å—ç®¡ç†ç²’å­çš„å…‰ç…§ç‰¹æ€§ã€‚
- `Location` è¿™äº›æ¨¡å—å®šä¹‰äº†ç›¸å¯¹äºå‘å°„å™¨ä½ç½®çš„ç²’å­ç”Ÿæˆä½ç½®çš„ä¿¡æ¯ã€‚
- `Material` è¿™äº›æ¨¡å—å®šä¹‰äº†ç²’å­ä¸Šåº”ç”¨çš„æè´¨ä¿¡æ¯ã€‚
- `Orbit` è¿™äº›æ¨¡å—èƒ½å¤Ÿå®šä¹‰å±å¹•ç©ºé—´çš„è¡Œä¸ºè½¨è¿¹ï¼Œä¸ºæ•ˆæœæ·»åŠ é¢å¤–çš„è¿åŠ¨ç‰¹æ€§ã€‚
- `Orientation` - è¿™äº›æ¨¡å—èƒ½å¤Ÿé”å®šç²’å­çš„æ—‹è½¬è½´ã€‚
- `Parameter` è¿™äº›æ¨¡å—èƒ½å¤Ÿè¢«å‚æ•°åŒ–ï¼Œå¯ä»¥ä½¿ç”¨å¤–éƒ¨ç³»ç»Ÿæ¥å¯¹ç²’å­è¿›è¡Œæ§åˆ¶ï¼Œæ¯”å¦‚è“å›¾å’Œ Matineeã€‚
- `Rotation` è¿™äº›æ¨¡å—ç”¨äºæ§åˆ¶ç²’å­çš„æ—‹è½¬ã€‚
- `RotationRate` - è¿™äº›æ¨¡å—ç®¡ç†æ—‹è½¬é€Ÿåº¦çš„å˜åŒ–ã€‚
- `Size` è¿™äº›æ¨¡å—æ§åˆ¶ç²’å­çš„ç¼©æ”¾è¡Œä¸ºã€‚
- `Spawn` è¿™äº›æ¨¡å—ç”¨æ¥ç»™ç²’å­ç”Ÿæˆé€Ÿç‡æ·»åŠ é¢å¤–å®šä¹‰ï¼Œæ¯”å¦‚æ ¹æ®è·ç¦»çš„æ”¹å˜æ¥è°ƒæ•´ç²’å­çš„ç”Ÿæˆã€‚
- `SubUV` è¿™äº›æ¨¡å—èƒ½å¤Ÿè®©ç²’å­ä½¿ç”¨åºåˆ—å¸§åŠ¨ç”»è´´å›¾æ•°æ®ã€‚
- `Velocity` è¿™äº›æ¨¡å—å¤„ç†æ¯ä¸ªç²’å­çš„ç§»åŠ¨é€Ÿåº¦ã€‚

ç²’å­å…‰æºæ¨¡å—ï¼ˆParticle Light Moduleï¼‰ ä»¥ä½¿ç”¨é™„åŠ åˆ°å„ä¸ªç²’å­çš„å…‰æºæ¥æ¸²æŸ“ CPU Particle Emittersã€‚è¿™å¯¹ç«èŠ±æˆ–ç«ç„°ç­‰ç‰¹æ•ˆå¾ˆæœ‰ç”¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹å®ƒå¯ä»¥å‘å‡ºè¶³å¤Ÿçš„å…‰ï¼Œåœ¨å‘¨å›´ç¯å¢ƒä¸­å¼•äººæ³¨ç›®ã€‚

è®¾ç½®ç²’å­å…‰æºæ—¶çš„ä¸€èˆ¬ç­–ç•¥æ˜¯ï¼Œè®¾ç½®æå°‘çš„å¤§ç²’å­å…‰æºä»¥åŠå¤§é‡çš„å°ç²’å­å…‰æºã€‚è¯·åŠ¡å¿…ä½¿ç”¨ ProfileGPU æ§åˆ¶å°å‘½ä»¤è¿›è¡Œå¾®è°ƒå’Œæç”»ï¼Œå› ä¸ºç²’å­å…‰æºçš„æˆæœ¬å¾ˆå®¹æ˜“å¤±æ§ã€‚

è¯·è®°ä½ï¼šå…‰æºæ¨¡å— Light ä»…å¯ç”¨äº CPU ç²’å­ä¸Šï¼Œå› æ­¤ä»»ä½• GPU ç²’å­éƒ½æ— æ³•ä½¿ç”¨è¯¥æ¨¡å—ã€‚å°†æ¨¡å—æ·»åŠ åˆ°GPUå‘å°„å™¨ä¸ä¼šç ´åç³»ç»Ÿï¼Œä½†æ˜¯å®ƒä¸ä¼šæ‰§è¡Œä»»ä½•æ“ä½œï¼Œå¹¶ä¸”åœ¨åˆ—è¡¨ä¸­æ¨¡å—ä¸Šæ–¹ä¼šæ˜¾ç¤ºä¸€ä¸ªå·¨å¤§çš„çº¢è‰² Xã€‚

åœ¨ä½¿ç”¨çº§è”åˆ¶ä½œç²’å­æ•ˆæœçš„æ—¶å€™ï¼Œéœ€è¦å§‹ç»ˆè®°ä½æ¯ä¸ªå¯¹è±¡ä¹‹é—´çš„äº’ç›¸ä½œç”¨å…³ç³»ã€‚æ€»çš„æ¥è¯´ï¼Œç²’å­ç³»ç»Ÿçš„ç»„ä»¶åŒ…æ‹¬æ¨¡å—ã€å‘å°„å™¨ã€ç²’å­ç³»ç»Ÿï¼Œä»¥åŠå‘å°„å™¨ Actorã€‚å¯ä»¥ç”¨ä»¥ä¸‹æè¿°æ¥è®°ä½è¿™äº›æ¦‚å¿µä¹‹é—´çš„å…³ç³»ï¼š

- `Modules`ï¼Œæ¨¡å—å®šä¹‰ç²’å­çš„è¡Œä¸ºï¼Œå¹¶ä¸”è¢«æ”¾ç½®åœ¨ä¸€ä¸ªå‘å°„å™¨ä¸­ã€‚
- `Emitters`ï¼Œä¸ºå±•ç¤ºæ•ˆæœå‘å°„ç‰¹å®šè¡Œä¸ºçš„ç²’å­ï¼Œä»»æ„ä¸ªå‘å°„å™¨å¯ä»¥è¢«åŒæ—¶æ”¾ç½®åœ¨ä¸€ä¸ªç²’å­ç³»ç»Ÿå†…ã€‚
- `Particle System`ï¼Œç²’å­ç³»ç»Ÿä½œä¸ºå†…å®¹æµè§ˆå™¨ä¸­çš„ä¸€ä¸ªèµ„æºï¼Œå¯ä»¥è¢«ä¸€ä¸ªå‘å°„å™¨ Actor æ¥å¼•ç”¨ã€‚
- `Emitter Actor`ï¼Œæ˜¯ä¸€ä¸ªæ”¾ç½®åœ¨å…³å¡ä¸­çš„ä¸œè¥¿ï¼Œç”¨äºå®šä¹‰ç²’å­åœ¨åœºæ™¯ä¸­å¦‚ä½•ä½¿ç”¨ã€‚

Particle System æ˜¯ä¸€ä¸ªåŒ…å«ä»»ä½•æ•°é‡ Particle Emitters çš„å®Œæ•´ç²’å­ç‰¹æ•ˆã€‚åœ¨ä¸€ä¸ªç³»ç»Ÿä¸­åº”ç”¨å¤šä¸ªå‘å°„å™¨åï¼Œè®¾è®¡å¸ˆå¯ä»¥åˆ›å»ºå‡ºç²¾ç¾ç»†è‡´çš„ç²’å­ç‰¹æ•ˆï¼Œå¹¶å­˜æ”¾äºå•ä¸ªç³»ç»Ÿä¸­ã€‚ä½¿ç”¨çº§è”å®Œæˆåˆ›å»ºåï¼Œå³å¯å°† Particle System ç½®äºå…³å¡ä¸­æˆ–åˆ›å»ºäºè„šæœ¬ä¸­ã€‚


åœ¨ä½¿ç”¨ç²’å­æ¨¡å—å·¥ä½œçš„æ—¶å€™è¦å¯¹ä¸¤ä¸ªæ¦‚å¿µæœ‰æ‰€äº†è§£ï¼š

- `Initial` åˆå§‹çŠ¶æ€çš„æ¨¡å—ä¸€èˆ¬ç”¨äºç®¡ç†ç²’å­è¢«ç”Ÿæˆé‚£ä¸€åˆ»çš„å„æ–¹é¢å±æ€§ã€‚
- `Over Life` or `Per Life`ï¼Œç”Ÿå‘½å‘¨æœŸæˆ–è€…æ¯æ¬¡ç”Ÿå‘½çš„æ¨¡å—æ˜¯ä¸ºäº†å¯¹ç²’å­çš„ç”Ÿå‘½è¿‡ç¨‹ä¸­å¯¹å®ƒä»¬çš„å±æ€§è¿›è¡Œä¿®æ”¹çš„æ–¹é¢ã€‚

æ¯”å¦‚ï¼Œåˆå§‹é¢œè‰²çš„æ¨¡å—èƒ½å¤Ÿä¸ºç²’å­ç”Ÿæˆé‚£ä¸€åˆ»æŒ‡å®šé¢œè‰²å±æ€§ï¼Œè€Œç”Ÿå‘½å‘¨æœŸé¢œè‰² çš„å±æ€§åˆ™æ˜¯ç”¨äºåœ¨ç²’å­ç”Ÿæˆåï¼Œç›´åˆ°è¢«æ¶ˆäº¡å‰çš„è¿™æ®µè¿‡ç¨‹ä¸­é€æ¸ä¿®æ”¹é¢œè‰²çš„è¡Œä¸ºã€‚

å¦‚æœå°†ä¸€ä¸ªå±æ€§è®¾ç½®ä¸º distribution çš„ç±»å‹ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šåœ¨æ—¶é—´è¿‡ç¨‹ä¸Šå‘ç”Ÿå˜åŒ–ï¼Œæœ‰äº›æ¨¡å—ä½¿ç”¨ç›¸å¯¹æ—¶é—´ï¼Œè€Œæœ‰äº›æ¨¡å—ä½¿ç”¨ç»å¯¹æ—¶é—´ã€‚

- ç»å¯¹æ—¶é—´åŸºæœ¬ä¸Šå°±æ˜¯å¤–éƒ¨å‘å°„å™¨çš„è®¡æ—¶ã€‚å¦‚æœå‘å°„å™¨çš„è®¾ç½®æ˜¯æ¯ä¸ªå¾ªç¯ 2 ç§’ï¼Œä¸€ä¸ªä¸‰æ¬¡å¾ªç¯ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªå‘å°„å™¨å†…çš„æ¨¡å—çš„ç»å¯¹æ—¶é—´å°†æ˜¯ä» 0 åˆ° 2ï¼Œä¼šè¿è¡Œ 3 éã€‚
- ç›¸å¯¹æ—¶é—´åœ¨ 0 åˆ° 1 ä¹‹é—´ï¼Œè¡¨ç¤ºæ¯ä¸ªç²’å­åœ¨ç”Ÿå‘½å‘¨æœŸä¸­çš„æ—¶é—´ã€‚


å½“ä½¿ç”¨ç²’å­ç³»ç»Ÿæ—¶ï¼Œäº†è§£è¿ç®—çš„æ¬¡åºä¹Ÿæ˜¯å¾ˆé‡è¦çš„ã€‚åœ¨çº§è”ç¼–è¾‘å™¨ä¸­ï¼Œåˆ—è¡¨åŒºåŸŸçš„æ¯åˆ—éƒ½ä»£è¡¨äº†ä¸€ä¸ªå‘å°„å™¨ï¼Œä¸€åˆ—ä¸­çš„æ¯ä¸ªå—ä»£è¡¨ä¸€ä¸ªæ¨¡å—ã€‚

è¿ç®—æ—¶çš„æ¬¡åºå¦‚ä¸‹ï¼š

- å‘å°„å™¨çš„è¿ç®—æ˜¯æ ¹æ®å‘å°„å™¨çš„åˆ—è¡¨ä»å·¦å¾€å³çš„ã€‚
- æ¨¡å—çš„è®¡ç®—æŒ‰ç…§å †æ ˆåˆ—è¡¨ä»ä¸Šåˆ°ä¸‹çš„ã€‚

æ‰€æœ‰å‘å°„å™¨é»˜è®¤éƒ½æ˜¯é¢ç‰‡å‘å°„å™¨ Sprite Emittersï¼Œæ·»åŠ ä¸åŒçš„å‘å°„å™¨ç±»å‹æ•°æ®æ¨¡å—ï¼Œå³å¯ä»¥æ”¹å˜å‘å°„å™¨çš„ç±»å‹ï¼š

- `Sprite Emitters` - è¿™æ˜¯å‘å°„å™¨çš„åŸºæœ¬ç±»å‹ï¼Œä¹Ÿæ˜¯ç”¨çš„æœ€å¹¿æ³›çš„ç±»å‹ã€‚ä½¿ç”¨å§‹ç»ˆæœå‘æ‘„åƒæœºçš„å¤šè¾¹å½¢åŒ–çš„é¢ç‰‡ï¼ˆ2 ä¸ªå¤šå˜å½¢ç»„æˆï¼‰ä½œä¸ºå•ä¸ªç²’å­å‘å°„ã€‚å¯ä»¥ç”¨æ¥åšçƒŸé›¾ã€ç«ç„°ç‰¹æ•ˆï¼Œä»¥åŠå…¶ä»–å„ç§ç§ç±»çš„æ•ˆæœã€‚
- `AnimTrail Data` - ç”¨äºåˆ›å»ºåŠ¨ç”»çš„æ‹–å°¾æ•ˆæœã€‚
- `Beam Data` - ç”¨äºåˆ›å»ºå…‰æŸæ•ˆæœï¼Œæ¯”å¦‚é•­å°„å…‰ã€é—ªç”µç­‰ç±»ä¼¼çš„æ•ˆæœã€‚
- `GPU Sprites` - è¿™æ˜¯ç‰¹æ®Šç±»å‹çš„ç²’å­ï¼Œåœ¨è¿è¡Œæ—¶å¤§é‡è®¡ç®—äº¤ç»™ GPU æ‰§è¡Œã€‚è¿™å°† CPU çš„ç²’å­ç‰¹æ•ˆè®¡ç®—ä»å‡ åƒçš„æ•°é‡çº§æé«˜åˆ° GPU è®¡ç®—ç‰¹æ•ˆçš„å‡ åä¸‡çš„æ•°é‡çº§ï¼Œå–å†³äºå…·ä½“çš„ç›®æ ‡ç³»ç»Ÿä¸Š GPU çš„ç±»å‹ã€‚
- `Mesh Data` - ä¸å†å‘å°„ä¸€ç³»åˆ—çš„é¢ç‰‡ï¼Œè¿™ä¸ªç±»å‹çš„å‘å°„å™¨å°†ä¼šå‘å°„å¤šè¾¹å½¢æ¨¡å‹ã€‚ç”¨äºåˆ›å»ºå²©çŸ³å—ï¼ŒåºŸå¢Ÿç­‰ç±»ä¼¼çš„æ•ˆæœã€‚
- `Ribbon Data` - è¿™ä¸ªä¼šäº§ç”Ÿä¸€ä¸²ç²’å­é™„å±åˆ°ä¸€ä¸ªç‚¹ä¸Šï¼Œèƒ½åœ¨ä¸€ä¸ªç§»åŠ¨çš„å‘å°„å™¨åå½¢æˆä¸€ä¸ªè‰²å¸¦ã€‚

Distribution æ˜¯ä¸€ç»„æ•°æ®ç±»å‹ï¼Œä»¥ç‰¹æ®Šçš„æ–¹å¼å¤„ç†æ•°æ®ï¼Œæ¯”å¦‚ä¸ºä¸€ä¸ªæ•°å€¼åº”ç”¨ä¸€ä¸ªèŒƒå›´ï¼Œæˆ–è€…ä½¿ç”¨æ›²çº¿æ¥å¯¹æ•°å€¼åšæ’å€¼æ“ä½œã€‚å¦‚æœç²’å­ç³»ç»Ÿéœ€è¦ä»»ä½•éšæœºå±æ€§ï¼Œæˆ–è€…ç²’å­éœ€è¦éšç€æ—¶é—´è¿›è¡Œå˜åŒ–æ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨ä¸€ä¸ª distribution æ¥æ§åˆ¶å±æ€§ã€‚

åœ¨çº§è”ä¸­çš„å¾ˆå¤šæ¨¡å—çš„å±æ€§ä¸­éƒ½å¯ä»¥çœ‹åˆ°ä½¿ç”¨äº†å„ç§ä¸åŒçš„ distributionã€‚å±æ€§çš„å®é™…æ•°å€¼å°±æ˜¯é€šè¿‡ distribution æ¥è®¾ç½®çš„ã€‚

æœ‰ 5 ç§ä¸»è¦çš„ distribution ç±»å‹ï¼š

- Constant - è¿™è¡¨ç¤ºä¸€ä¸ªé™æ€ä¸å˜çš„å¸¸é‡ã€‚
- Uniform - ä¸€ä¸ª Uniform Distribution æä¾›äº†ä¸€ä¸ªæœ€å°å€¼å’Œä¸€ä¸ªæœ€å¤§å€¼ï¼Œè¾“å‡ºè¿™ä¸¤ä¸ªå€¼ä¹‹é—´ï¼ˆåŒ…å«è¿™ä¸¤ä¸ªå€¼ï¼‰çš„éšæœºæ•°å€¼ã€‚
- Constant Curve - Constant Curve æä¾›äº†ä¸€ä¸ªæ•°å€¼çš„ç®€å•æ›²çº¿ã€‚åœ¨è¿™ä¸ªç±»å‹ä¸‹ï¼Œæ—¶é—´é€šå¸¸æ˜¯æŒ‡ä¸€ä¸ªç²’å­ä»ç”Ÿæˆçš„æ¶ˆå¤±çš„è¿‡ç¨‹ï¼Œæˆ–è€…è¯´æ˜¯ç²’å­çš„èµ·å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´ã€‚
- Uniform Curve - Uniform Curve Distribution æä¾›äº†æœ€å°æ›²çº¿å’Œæœ€å¤§æ›²çº¿ï¼Œæœ€ç»ˆæ•°å€¼åœ¨è¿™ä¸¤ä¸ªæ›²çº¿ä¸­é—´æ¥é€‰å–ã€‚
- Parameter - è¿™ç§ç±»å‹çš„ Distribution ä½¿å¾—è¯¥å±æ€§å‚æ•°åŒ–ï¼Œä»¥ä¾¿äºå®ƒèƒ½å¤Ÿè¢«å¤–éƒ¨ç³»ç»Ÿï¼Œè¯¸å¦‚è“å›¾ã€Matinee æˆ–è€…å…¶ä»–ç³»ç»Ÿè¯»å–æˆ–æ”¹å†™ã€‚

ç»†èŠ‚çº§åˆ« Level of Detailï¼ˆLODï¼‰æ˜¯ç‰¹æ•ˆå¸ˆçš„ç¦éŸ³ï¼Œåˆ©ç”¨å®ƒå¯ä»¥åˆ›å»ºå‡ºæ ¹æ®ç©å®¶è·ç¦»é«˜æ•ˆåˆ©ç”¨å±å¹•ç©ºé—´çš„ç²’å­ç‰¹æ•ˆã€‚

ä¾‹å¦‚ç¯ç«ç²’å­ç³»ç»Ÿï¼Œå¯èƒ½åŒ…å«ä»¥ä¸‹å‡ ç§å‘å°„å™¨ï¼š

- ç«ç„°å†…ç„°
- ç«ç„°å¤–ç„°
- å†…ç„°è¾‰å…‰
- ç«æ˜Ÿå’Œç°çƒ¬
- ä¸€å±‚æˆ–å¤šå±‚çƒŸé›¾

è¿‘è·ç¦»è§‚å¯Ÿæ—¶ï¼Œç³»ç»Ÿçš„æ‰€æœ‰å…ƒç´ éƒ½åº”è¯¥è¡¨ç°å‡ºç‰¹æœ‰çš„å¤–è§‚ã€‚è€Œå½“ç©å®¶èµ°è¿œæ—¶ï¼Œç³»ç»Ÿå ç”¨å±å¹•çš„ç©ºé—´å˜å°‘ï¼Œå®ƒå¯èƒ½å°±åªèƒ½æ˜¾ç¤ºå‡ ä¸ªåƒç´ ï¼Œè€Œæ²¡æœ‰å…·ä½“çš„ç»†èŠ‚ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç²’å­ç³»ç»Ÿçš„ä¸€äº›æ–¹é¢å°†ä¼šå˜å¾—ååˆ†å°ï¼ˆå°äºä¸€ä¸ªåƒç´ ï¼‰è€Œæ— éœ€è¿›è¡Œæ¸²æŸ“ï¼Œå¦‚ç°çƒ¬ã€‚ç„¶è€Œï¼Œè¿™äº›ç²’å­ä»ç„¶è¢«è®¡ç®—å’Œå¤„ç†ã€‚LOD å°±å¯ä»¥å¤§æ˜¾èº«æ‰‹äº†ã€‚å®ƒå¯ä½¿ç²’å­ç³»ç»ŸåŸºäºè·ç¦»è¿›è¡Œç®€åŒ–ï¼Œï¼ˆåœ¨ç©å®¶è·ç¦»è¿‡è¿œè€Œæ¬£èµä¸åˆ°ç‰¹æ•ˆæ—¶ï¼‰å°†ç³»ç»Ÿä¸­çš„å‘å°„å™¨å’Œæ¨¡å—å°†è®¾ç½®å…³é—­ï¼Œæˆ–å®Œå…¨å…³é—­ã€‚

é™¤æ•ˆç‡ä¹‹å¤–ï¼ŒGPU ç²’å­æœ€æœ‰è¶£çš„ç‰¹æ€§æ˜¯å‘é‡åœºï¼Œå‘é‡åœºæ˜¯ä¸€ä¸ªç”±å½±å“ç²’å­è¿åŠ¨çš„å‘é‡ç»„æˆçš„ç»Ÿä¸€ç½‘æ ¼ã€‚å®ƒä»¬æ˜¯åŠ¨æ€çš„ï¼Œå¯ä»¥åœ¨ä»»ä½•æ—¶å€™ç§»åŠ¨ã€‚å½“ç²’å­è¿›å…¥å‘é‡åœºçš„è¾¹ç•Œæ—¶ï¼Œç²’å­çš„è¿åŠ¨å°†å—åˆ°å‘é‡åœºçš„å½±å“ï¼Œå½“ç²’å­ç¦»å¼€è¾¹ç•Œæ—¶ï¼Œå‘é‡åœºçš„å½±å“å°†æ¶ˆå¤±ã€‚

- æ•´ä½“å‘é‡åœºï¼ˆ`Global Vector Fields`ï¼‰æ”¾ç½®åœ¨å…³å¡ä¸­ï¼Œå¯ä»¥å½±å“ä»»ä½•å¸¦æœ‰æ•´ä½“å‘é‡åœºæ¨¡å—çš„ç²’å­ç³»ç»Ÿï¼Œä½†æ˜¯éœ€è¦é…åˆå‘é‡åœºä½“ç§¯ä½¿ç”¨ï¼Œå¹¶ä¸”éœ€è¦å°†é€‚å½“çš„å‘é‡åœºèµ„æºä¸ä¹‹å…³è”ã€‚
- å±€éƒ¨å‘é‡åœºï¼ˆ`Local Vector Fields`ï¼‰å®Œå…¨å­˜åœ¨äºç²’å­ç³»ç»Ÿä¸­ï¼Œè¿™æ„å‘³ç€ï¼Œå±€éƒ¨å‘é‡åœºåªèƒ½å½±å“å®ƒä»¬è¢«æŒ‡å®šç»™çš„ç²’å­å‘å°„å™¨ã€‚
- å‘é‡åœºä½“ç§¯ï¼ˆ`Vector Field Volume`ï¼‰ä¸æ˜¯ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„ä½“ç§¯ï¼Œå¯ä»¥å¯¹åœºè¿›è¡Œå®šä½ã€æ—‹è½¬å’Œç¼©æ”¾ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼Œå‘é‡åœºä¼šå¯¹å…¶ä¸­çš„ç²’å­æ–½åŠ›ã€‚å‘é‡åœºè¿˜æœ‰ä¸€ä¸ª"ç´§å¯†åº¦"å‚æ•°ã€‚æ­¤å‚æ•°æ§åˆ¶ç²’å­å¦‚ä½•ç›´æ¥è·Ÿéšåœºä¸­çš„å‘é‡ã€‚å½“ç´§å¯†åº¦è®¾ç½®ä¸º1æ—¶ï¼Œç²’å­ç›´æ¥ä»åœºä¸­è¯»å–å…¶é€Ÿåº¦ï¼Œä»è€Œå‡†ç¡®åœ°è·Ÿéšåœºã€‚

é™æ€å‘é‡åœºæ˜¯å‘é‡ç½‘æ ¼æ°¸ä¸æ”¹å˜çš„åœºã€‚è¿™äº›åœºå¯ä»¥ä»Mayaå¯¼å‡ºå¹¶ä½œä¸ºä½“ç§¯çº¹ç†å¯¼å…¥ã€‚é™æ€åœºèµ„æºå ç”¨ä½ï¼Œå¯ä»¥ç”¨æ¥å‘ç²’å­æ·»åŠ æœ‰è¶£çš„è¿åŠ¨ï¼Œç‰¹åˆ«æ˜¯é€šè¿‡å¯¹åœºæœ¬èº«çš„è¿åŠ¨è®¾ç½®åŠ¨ç”»ã€‚

æ­¤å¤–ï¼Œè¿˜å¯ä»¥ä»äºŒç»´å›¾åƒé‡æ–°æ„å»ºå‘é‡åœºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥å¯¼å…¥ä¸€ä¸ªéå¸¸ç±»ä¼¼äºæ³•çº¿è´´å›¾çš„å›¾åƒï¼Œé€šè¿‡æŒ¤å‹å®ƒæˆ–å°†å…¶å›´ç»•ä½“ç§¯æ—‹è½¬æ¥é‡æ–°æ„å»ºä½“ç§¯çº¹ç†ã€‚åœ¨æ­¤é‡æ–°æ„å»ºçš„åŸºç¡€ä¸Šï¼Œå¯ä»¥æ·»åŠ ä¸€ä¸ªé™æ€å‘é‡åœºï¼Œå¼•å…¥ä¸€äº›å™ªç‚¹å’Œéšæœºæ€§ã€‚æ­¤å¤–ï¼Œå¯ä»¥é€šè¿‡åœ¨å›¾è°±çº¹ç†ä¸­å­˜å‚¨å•ç‹¬çš„å¸§æ¥å¯¹2Då›¾åƒè®¾ç½®åŠ¨ç”»ã€‚è¿™æ ·åšè®©æ‚¨å¯ä»¥ç¦»çº¿æ‰§è¡Œæµä½“æ¨¡æ‹Ÿï¼Œå¹¶ä»¥æä½çš„æˆæœ¬å®æ—¶é‡æ–°æ„å»ºè¿åŠ¨ã€‚
