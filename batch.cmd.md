
/. CMD Command Line
=======================================================

启动 Windows 命令解释器的一个新实例

    CMD [/A | /U] [/Q] [/D] [/E:ON | /E:OFF] [/F:ON | /F:OFF] [/V:ON | /V:OFF]
        [[/S] [/C | /K] string]

    /C      执行字符串指定的命令然后终止
    /K      执行字符串指定的命令但保留
    /S      修改 /C 或 /K 之后的字符串处理(见下)
    /Q      关闭回显
    /D      禁止从注册表执行 AutoRun 命令(见下)
    /A      使向管道或文件的内部命令输出成为 ANSI
    /U      使向管道或文件的内部命令输出成为 Unicode
    /T:fg   设置前台/背景颜色(详细信息见 COLOR /?)
    /E:ON   启用命令扩展(见下)
    /E:OFF  禁用命令扩展(见下)
    /F:ON   启用文件和目录名完成字符(见下)
    /F:OFF  禁用文件和目录名完成字符(见下)
    /V:ON   使用 ! 作为分隔符启用延迟的环境变量
            扩展。例如，/V:ON 会允许 !var! 在执行时
            扩展变量 var。var 语法会在输入时
            扩展变量，这与在一个 FOR
            循环内不同。
    /V:OFF  禁用延迟的环境扩展。

注意，如果字符串加有引号，可以接受用命令分隔符 "&&"分隔多个命令。另外，由于兼容性原因，
/X 与 /E:ON 相同，/Y 与 /E:OFF 相同，且 /R 与 /C 相同。任何其他开关都将被忽略。

如果指定了 /C 或 /K，则会将该开关之后的命令行的剩余部分作为一个命令行处理，其中，
会使用下列逻辑处理引号(")字符:

1.  如果符合下列所有条件，则会保留命令行上的引号字符:

    - 不带 /S 开关
    - 正好两个引号字符
    - 在两个引号字符之间无任何特殊字符，特殊字符指下列字符: &<>()@^|
    - 在两个引号字符之间至少有一个空格字符
    - 在两个引号字符之间的字符串是某个可执行文件的名称。

2.  否则，老办法是看第一个字符是否是引号字符，如果是，则去掉首字符并
    删除命令行上最后一个引号，保留最后一个引号之后的所有文本。

如果 /D 未在命令行上被指定，当 CMD.EXE 开始时，它会寻找以下 REG_SZ/REG_EXPAND_SZ 注册表变量。
如果其中一个或两个都存在，这两个变量会先被执行。

    HKEY_LOCAL_MACHINE\Software\Microsoft\Command Processor\AutoRun

        和/或

    HKEY_CURRENT_USER\Software\Microsoft\Command Processor\AutoRun

命令扩展是按默认值启用的。你也可以使用 /E:OFF ，为某一特定调用而停用扩展。
你可以在机器上和/或用户登录会话上启用或停用 CMD.EXE 所有调用的扩展，这要通过设置使用
REGEDIT.EXE 的注册表中的一个或两个 REG_DWORD 值:

    HKEY_LOCAL_MACHINE\Software\Microsoft\Command Processor\EnableExtensions

        和/或

    HKEY_CURRENT_USER\Software\Microsoft\Command Processor\EnableExtensions

到 0x1 或 0x0。用户特定设置比机器设置有优先权。命令行开关比注册表设置有优先权。

在批处理文件中，SETLOCAL ENABLEEXTENSIONS 或 DISABLEEXTENSIONS 参数
比 /E:ON 或 /E:OFF 开关有优先权。请参阅 SETLOCAL /? 获取详细信息。

命令扩展包括对下列命令所做的更改和/或添加:

    DEL or ERASE
    COLOR
    CD or CHDIR
    MD or MKDIR
    PROMPT
    PUSHD
    POPD
    SET
    SETLOCAL
    ENDLOCAL
    IF
    FOR
    CALL
    SHIFT
    GOTO
    START (同时包括对外部命令调用所做的更改)
    ASSOC
    FTYPE

有关特定详细信息，请键入 commandname /? 查看。

延迟环境变量扩展不按默认值启用。你可以用 /V:ON 或 /V:OFF 开关，为 CMD.EXE 的某个调用而
启用或停用延迟环境变量扩展。你可以在机器上和/或用户登录会话上启用或停用 CMD.EXE 所有
调用的延迟扩展，这要通过设置使用 REGEDIT.EXE 的注册表中的一个或两个 REG_DWORD 值:

    HKEY_LOCAL_MACHINE\Software\Microsoft\Command Processor\DelayedExpansion

        和/或

    HKEY_CURRENT_USER\Software\Microsoft\Command Processor\DelayedExpansion

如果延迟环境变量扩展被启用，惊叹号字符可在执行时间被用来代替一个环境变量的数值。

你可以用 /F:ON 或 /F:OFF 开关为 CMD.EXE 的某个调用而启用或禁用文件名完成。
你可以在计算上和/或用户登录会话上启用或禁用 CMD.EXE 所有调用的完成，
这可以通过使用 REGEDIT.EXE 设置注册表中的下列 REG_DWORD 的全部或其中之一:

    HKEY_LOCAL_MACHINE\Software\Microsoft\Command Processor\CompletionChar
    HKEY_LOCAL_MACHINE\Software\Microsoft\Command Processor\PathCompletionChar

        和/或

    HKEY_CURRENT_USER\Software\Microsoft\Command Processor\CompletionChar
    HKEY_CURRENT_USER\Software\Microsoft\Command Processor\PathCompletionChar

由一个控制字符的十六进制值作为一个特定参数(例如，0x4 是 Ctrl-D，0x6 是 Ctrl-F)。
用户特定设置优先于机器设置。命令行开关优先于注册表设置。

如果完成是用 /F:ON 开关启用的，两个要使用的控制符是: 目录名完成用 Ctrl-D，文件名完成用 Ctrl-F。
要停用注册表中的某个字符，请用空格(0x20)的数值，因为此字符不是控制字符。

如果键入两个控制字符中的一个，完成会被调用。完成功能将路径字符串带到光标的左边，
如果没有通配符，将通配符附加到左边，并建立相符的路径列表。然后，显示第一个相符的路径。
如果没有相符的路径，则发出嘟嘟声，不影响显示。
之后，重复按同一个控制字符会循环显示相符路径的列表。
将 Shift 键跟控制字符同时按下，会倒着显示列表。
如果对该行进行了任何编辑，并再次按下控制字符，保存的相符路径的列表会被丢弃，
新的会被生成。如果在文件和目录名完成之间切换，会发生同样现象。
两个控制字符之间的唯一区别是文件完成字符匹配文件和目录名，而目录完成字符只符合目录名。
如果文件完成被用于内置式目录命令(CD、MD 或 RD)，就会使用目录完成。

用引号将相符路径括起来，完成代码可以正确处理含有空格或其他特殊字符的文件名。
同时，如果备份，然后从行内调用文件完成，则调用完成时位于光标右方的文字会被弃用。

需要引号的特殊字符是:

    <space>
     &()[]{}^=;!'+,`~


/. Windows CMD Command Syntax
=======================================================
* https://ss64.com/nt/
* https://ss64.com/nt/syntax.html
* https://ss64.com/nt/commands.html

Windows CMD Shell How-to guides and examples
============================================

> [Parameters](syntax-args.html)  Command Line Arguments %1 %~f1
> [Array Variables](syntax-arrays.html)  Create pseudo-array variables.
> [Env. Variables](syntax-variables.html)  Variable types, arrays and a list of all standard environment variables.
> [functions](syntax-functions.html)  How to package blocks of code.
> [AND/OR Logic](syntax-conditional.html)  Conditional Execution (If-Then-Else)
> [Loops](syntax-loops.html)  Loops and Subroutines.
> [Macros](syntax-macros.html)  Embed blocks of code in a variable.
> [Redirection](syntax-redirection.html)  Spooling output to a file, piping input.
> [Services](syntax-services.html)  List of Windows 10 Services (21H2). ![services](https://ss64.com/nt/services.png)

Evaluate expressions
--------------------

> [Using brackets](syntax-brackets.html)  to Group and expand expressions.
> [Delayed Expansion](delayedexpansion.html)  Variables within loops.
> [Escape chars](syntax-esc.html)  Escape characters, delimiters and quotes
> [SET](set.html) /A  Environment variable arithmetic.
> 
> [VarSubstring](syntax-substring.html)  Extract part of a variable (substring).
> [VarSearch](syntax-replace.html)  Search & replace part of a variable.
> [RANDOM](syntax-random.html)  Random Numbers.
> [Wildcards](syntax-wildcards.html)  Match multiple files.

Shortcuts
---------

> [Keyboard shortcuts](syntax-keyboard.html)  For CMD, PowerShell and Windows.
> [RUN commands](run.html)  Start ➞ Run commands.
> [MMC Snap-ins](syntax-mmc.html)  Admin commands.
> [ms-settings](syntax-settings.html)  Shortcuts to settings.
> [Shell: folder](shell.html)  Shortcuts to key folders.
> [ProfileFolders](syntax-folders.html)  User profile folders: Start Menu, Roaming etc.

Example Batch Files and functions
---------------------------------

> [Run a script](syntax-run.html)  How to create and run a batch file. Also VBS and .ps1 scripts.
> [Banner](syntax-banner.html)  Display a string of text in extra large letters.
> [Elevate/UAC](syntax-elevate.html)  Run with elevated permissions (As Admin).
> [DateMath](syntax-datemath.html)  Add or subtract days from any date.
> [DeQuote](syntax-dequote.html)  Remove quotes from a string.
> [DelOlder](syntax-delolder.html)  Delete files more than _n_ days old.
> [Empty](syntax-empty.html)  Find out if a directory is empty
> [GenChr.cmd](syntax-genchr.html)  Generate an ASCII/Unicode character.
> [GetDate.cmd](syntax-getdate.html)  Get todays date (any region, any OS.)
> [GetTime.cmd](syntax-gettime.html)  Get the time now.
> [GetGMT.cmd](syntax-gmt.html)  Time adjusted to Greenwich Mean Time.
> [IsDirectory.cmd](syntax-isdirectory.html)  Check if a path leads to a folder or a file.
> [Sanitize.cmd](syntax-sanitize.html)  Sanitize an input string omitting any non-approved chars.
> [StampMe.cmd](syntax-stampme.html)  Rename a file with the date/time.
> [StrLen](syntax-strlen.html)  Calculate the length of a string.
> [ToLower.cmd](syntax-tolower.html)  Upper or Lower case a String.
> [tdiff.cmd](syntax-tdiff.html)  Calculate the difference in Hours/Mins between two time values.
> [timer.cmd](syntax-timer.html)  Measure the run time of a script.
> [Which.cmd](syntax-which.html)  Display full path to any executable file.
> [xlong.cmd](syntax-xlong.html)  Find filenames that exceed the 256 char pathname limit.

Reference
---------

> [ANSI colors](syntax-ansi.html)  Use ANSI colors in the Windows 10 terminal.
> [Autoexec](syntax-autoexec.html)  Run commands at startup.
> [CMD Shell](syntax-cmd.html)  Working in the Windows CMD shell.
> [CMD Internal](syntax-internal.html)  Commands that are Internal to the CMD shell.
> [Compatibility](syntax-compatibility.html)  Backwards compatibility - runas admin / color
> [Errorlevel](errorlevel.html)  Errorlevel and Exit codes in CMD (set and detect errors)
> [Error Handling](syntax-error.html)  Error Handling in a batch file.
> [Slow Browsing](slow_browsing.html)  Speed up network browsing.
> [LAN Mgr auth](../nt/syntax-ntlm.html)  NTLM authentication.
> [Logon Types](syntax-logon-types.html)  Windows Logon types.
> [Long Filenames](syntax-filenames.html)  Long filename issues (>256 chars) and legal filename /host name/computer name characters.
> [Display DPI](syntax-dpi.html)  Monitor size settings.
> [Share modes](syntax-share-modes.html)  An explanation of File Sharing modes.
> [File Shares](syntax-shares.html)  Organising shared files.
> [NoDrives](syntax-nodrives.html)  Hide mapped drives from Windows Explorer.
> [% vs %%](syntax-percent.html)  Why you need to double the %'s in a batch file.
> [Printing](syntax-printing.html)  Printer connections and print drivers.
> [Recovery](syntax-recovery.html)  The Windows Recovery Environment (WinRE), Safe mode and Win PE.
> [Reg Tweaks](syntax-reghacks.html)  Registry tweaks and settings.
> [BuiltIn Groups](syntax-security_groups.html)  Built-In Users and Security Groups.
> [AD Groups](syntax-groups.html)  Local Domain groups, Global and Universal groups.
> [64Bit](syntax-64bit.html)  Detect 64 bit vs 32 bit Windows.

### Related:

See also: [Websites, Resource Kits, Books and Utilities for Microsoft Windows.](https://ss64.com/links/windows.html)  
[Batch File Scripting Techniques](https://www.robvanderwoude.com/battech.php) - Rob van der Woude.


* * *

Copyright © 1999-2023 [SS64.com](https://ss64.com/)  
Some rights reserved


/. An A-Z Index of Windows CMD commands - SS64.com   
========================================================


An A-Z Index of Windows CMD commands.
=====================================

___________________
NT CMD A
-------------------

001. [AccessChk](accesschk.html) Get the security descriptor (SDDL) for an object (file, directory, reg key).
002. [ADDUSERS](addusers.html) Add or list users to/from a CSV file
003. [ADmodcmd](admodcmd.html) Active Directory Bulk Modify
004. [ARP](arp.html) Address Resolution Protocol
005. [ASSOC](assoc.html) Change file extension associations•
006. [ATTRIB](attrib.html) Change file attributes

___________________
NT CMD B
-------------------

007. [BCDBOOT](bcdboot.html) Create or repair a system partition
008. [BCDEDIT](bcdedit.html) Manage Boot Configuration Data
009. [BITSADMIN](bitsadmin.html) Background Intelligent Transfer Service
010. [BOOTREC](bootrec.html) Repair or replace a partition boot sector
011. [BREAK](break.html) Do nothing, successfully •
012. [BROWSTAT](browstat.html) Get domain, browser and PDC info

___________________
NT CMD C
-------------------

013. [CACLS](cacls.html) Change file permissions
014. [CALL](call.html) Call one batch program from another •
015. [CERTREQ](certreq.html) Request certificate from a certification authority
016. [CERTUTIL](certutil.html) Manage certification authority (CA) files and services
017. [CD](cd.html) Change Directory - move to a specific Folder•
018. [CHANGE](change.html) Change Terminal Server Session properties
019. [CHANGEPK](changepk.html) Upgrade device Edition/Product Key
020. [CHCP](chcp.html) Change the active console Code Page
021. [CHDIR](cd.html) Change Directory - move to a specific Folder•
022. [CHKDSK](chkdsk.html) Check Disk - check and repair disk problems
023. [CHKNTFS](chkntfs.html) Check the NTFS file system
024. [CHOICE](choice.html) Accept keyboard input to a batch file
025. [CIPHER](cipher.html) Encrypt or Decrypt files/folders, overwrite data.
026. [CleanMgr](cleanmgr.html) Automated cleanup of Temp files, recycle bin
027. [CLIP](clip.html) Copy STDIN to the Windows clipboard
028. [CLS](cls.html) Clear the screen•
029. [CMD](cmd.html) Start a new CMD shell
030. [CMDKEY](cmdkey.html) Manage stored usernames/passwords
031. [COLOR](color.html) Change colors of the CMD window•
032. [COMP](comp.html) Compare the contents of two files or sets of files
033. [COMPACT](compact.html) Compress files or folders on an NTFS partition
034. [COMPRESS](compress.html) Compress one or more files
035. [CON](con.html) Console input
036. [CONVERT](convert.html) Convert a FAT drive to NTFS
037. [COPY](copy.html) Copy one or more files to another location•
038. [Coreinfo](coreinfo.html) Show the mapping between logical & physical processors
039. [CSCcmd](csccmd.html) Client-side caching (Offline Files)
040. [CSVDE](csvde.html) Import or Export Active Directory data
041. [CURL](curl.html) Transfer data from or to a server

___________________
NT CMD D
-------------------

042. [DATE](date.html) Display or set the date•
043. [DEFRAG](defrag.html) Defragment hard drive
044. [DEL](del.html) Delete one or more files•
045. [DELPROF](delprof.html) Delete user profiles
046. [DELTREE](deltree.html) Delete a folder and all subfolders
047. [DevCon](devcon.html) Device Manager Command Line Utility
048. [DIR](dir.html) Display a list of files and folders•
049. [DIRQUOTA] File Server Resource Manager Disk quotas
049. [DIRUSE](diruse.html) Display directory sizes/usage
050. [DISKPART](diskpart.html) Disk Administration
051. [DISKSHADOW](diskshadow.html) Volume Shadow Copy Service
052. [DISKUSE](diskuse.html) Show the space used in folders
053. [DISM](dism.html) Deployment Image Servicing and Management
054. [DisplaySwitch](displayswitch.html) Specify which display to use and how to use it
055. [DNSCMD](dnscmd.html) Manage DNS servers
056. [DOSKEY](doskey.html) Edit command line, recall commands, and create macros
057. [DriverQuery](driverquery.html) Display installed device drivers
058. [DSACLs](dsacls.html) Active Directory ACLs
059. [DSAdd](dsadd.html) Add items to Active Directory ([user](dsadd-user.html) [group](dsadd-group.html) [computer](dsadd-computer.html))
060. [DSGet](dsget.html) View items in Active Directory ([user](dsget-user.html) [group](dsget-group.html) [computer](dsget-computer.html))
061. [DSQuery](dsquery.html) Search Active Directory ([user](dsquery-user.html) [group](dsquery-group.html) [computer](dsquery-computer.html))
062. [DSMod](dsmod.html) Modify items in Active Directory ([user](dsmod-user.html) [group](dsmod-group.html) [computer](dsmod-computer.html))
063. [DSMove](dsmove.html) Move an Active Directory Object
064. [DSRM](dsrm.html) Remove items from Active Directory
065. [DSREGCMD](dsregcmd.html) Directory Service Registration
066. [DU](du.html) Display directory sizes/usage

___________________
NT CMD E
-------------------

067. [ECHO](echo.html) Display message on screen•
068. [ENDLOCAL](endlocal.html) End localisation of the environment in a batch file•
069. [ERASE](del.html) Delete one or more files•
070. [EVENTCREATE](eventcreate.html) a message to the Windows event log
071. [EXIT](exit.html) Quit the current script/routine and set an errorlevel•
072. [EXPAND](expand.html) Uncompress CAB files
073. [EXPLORER](explorer.html) Open Windows Explorer
074. [EXTRACT](extract.html) Uncompress CAB files

___________________
NT CMD F
-------------------

075. [FC](fc.html) Compare two files
076. [FIND](find.html) Search for a text string in a file
077. [FINDSTR](findstr.html) Search for strings in files
078. [FLTMC](fltmc.html) Manage MiniFilter drivers
079. [FONDUE](fondue.html) Features on Demand User Experience Tool
080. [FOR /F](for_f.html) Loop command: against a set of files•
081. [FOR /F](for_cmd.html) Loop command: against the results of another command•
082. [FOR](for.html) Loop command: all options Files, Directory, List•
083. [FORFILES](forfiles.html) Batch process multiple files
084. [FORMAT](format.html) Format a disk
085. [FREEDISK](freedisk.html) Check free disk space
086. [FSUTIL](fsutil.html) File and Volume utilities
087. [FTP](ftp.html) File Transfer Protocol
088. [FTYPE](ftype.html) File extension file type associations•

___________________
NT CMD G
-------------------

089. [GETMAC](getmac.html) Display the Media Access Control (MAC) address
090. [GOTO](goto.html) Direct a batch program to jump to a labelled line•
091. [GPRESULT](gpresult.html) Display Resultant Set of Policy information
092. [GPUPDATE](gpupdate.html) Update Group Policy settings

___________________
NT CMD H
-------------------

093. [HELP](help.html) Online Help
094. [HOSTNAME](hostname.html) Display the host name of the computer

___________________
NT CMD I
-------------------

095. [iCACLS](icacls.html) Change file and folder permissions
096. [IEXPRESS](iexpress.html) Create a self extracting ZIP file archive
097. [IF](if.html) Conditionally perform a command•
098. [IFMEMBER](ifmember.html) Is the current user a member of a group
099. [IPCONFIG](ipconfig.html) Configure IP
100. [INUSE](inuse.html) Replace files that are in use by the OS

___________________
NT CMD K
-------------------

101. [KLIST](klist.html) List cached Kerberos tickets

___________________
NT CMD L
-------------------

102. [LABEL](label.html) Edit a disk label
103. [LGPO](lgpo.html) Local Group Policy Object utility
104. [LODCTR](lodctr.html) Load PerfMon performance counters
105. [LOGMAN](logman.html) Manage Performance Monitor logs
106. [LOGOFF](logoff.html) Log a user off
107. [LOGTIME](logtime.html) Log the date and time in a file

___________________
NT CMD M
-------------------

108. [MAKECAB](makecab.html) Create .CAB files
109. [MAPISEND](mapisend.html) Send email from the command line
110. [Manage-BDE](manage-bde.html) BitLocker Drive Encryption
111. [MBR2GPT](mbr2gpt.html) Convert a disk partition from Master Boot Record to a GPT
112. [MD](md.html) Create a new Directory•
113. [MKLINK](mklink.html) Create a symbolic link (linkd)
114. [MODE](mode.html) Configure a system device COM/LPT/CON
115. [MORE](more.html) Display output, one screen at a time
116. [MOUNTVOL](mountvol.html) Manage a volume mount point
117. [MOVE](move.html) Move files from one folder to another•
118. [MOVEUSER](moveuser.html) Move a user from one domain to another
119. [MSG](msg.html) Send a message
120. [MSIEXEC](msiexec.html) Microsoft Windows Installer
121. [MSINFO32](msinfo32.html) System Information
122. [MSTSC](mstsc.html) 127. Terminal Server Connection/Remote Desktop Protocol(RDP)

___________________
NT CMD N
-------------------

123. [NET](net.html) Manage network resources
124. [NETDOM](netdom.html) Domain Manager
125. [NETSH](netsh.html) Configure Network Interfaces, Firewall & Remote access
126. [NBTSTAT](nbtstat.html) Display networking statistics (NetBIOS over TCP/IP)
127. [NETSTAT](netstat.html) Display networking statistics (TCP/IP)
135. [NLSINFO] Display [locale](https://ss64.com/locale.html) information (reskit)
128. [NLTEST](nltest.html) Network Location Test (AD)
129. [NMBIND](nmbind.html) Manage Hyper-V network bindings
130. [NOW](now.html) Display the current Date and Time
131. [NSLOOKUP](nslookup.html) Name server lookup
132. [NTBACKUP](ntbackup.html) Windows Backup folders to tape
133. [NTDSUtil](ntdsutil.html) Active Directory Domain Services management
134. [NTRIGHTS](ntrights.html) Edit user account rights
135. [NVSPBIND](nvspbind.html) Modify network bindings

___________________
NT CMD O
-------------------

136. [OPENFILES](openfiles.html) Query or display open files

___________________
NT CMD P
-------------------

137. [PATH](path.html) Display or set a search path for executable files•
138. [PATHPING](pathping.html) Trace route plus network latency and packet loss
139. [PAUSE](pause.html) Suspend processing of a batch file•
140. [PERMS](perms.html) Show permissions for a user
141. [PING](ping.html) Test a network connection
142. [PKTMON](pktmon.html) Monitor internal packet propagation and packet drop reports
143. [PNPUTIL](pnputil.html) Plug and Play Utility
144. [POPD](popd.html) Return to a previous directory saved by PUSHD•
145. [PORTQRY](portqry.html) Display the status of ports and services
146. [POWERCFG](powercfg.html) Configure power settings
147. [PRINT](print.html) Print a text file
148. [PRINTBRM](printbrm.html) Print queue Backup/Recovery
149. [PRNCNFG](prncnfg.html) Configure a printer
150. [PRNDRVR](prndrvr.html) Add, delete or list print drivers.
151. [PRNJOBS](prnjobs.html) Pause, resume, cancel, or list print jobs.
152. [PRNMNGR](prnmngr.html) Add, delete, or list printer connections.
153. [PRNPORT](prnport.html) Manage Printer Ports, change port configuration.
154. [PRNQCTL](prnqctl.html) Manage Print Queues, print a test page.
155. [ProcDump](procdump.html) Monitor an application for CPU spikes
156. [PROMPT](prompt.html) Change the command prompt•
157. [PsExec](psexec.html) Execute process remotely
158. [PsFile](psfile.html) Show files opened remotely
159. [PsGetSid](psgetsid.html) Display the SID of a computer or a user
160. [PsInfo](psinfo.html) List information about a system
161. [PsKill](pskill.html) Kill processes by name or process ID
162. [PsList](pslist.html) List detailed information about processes
163. [PsLoggedOn](psloggedon.html) Who's logged on (locally or via resource sharing)
164. [PsLogList](psloglist.html) Event log records
165. [PsPasswd](pspasswd.html) Change account password
166. [PsPing](psping.html) Measure network performance
167. [PsService](psservice.html) View and control services
168. [PsShutdown](psshutdown.html) Shutdown or reboot a computer
169. [PsSuspend](pssuspend.html) Suspend processes
170. [PUSHD](pushd.html) Save and then change the current directory•

___________________
NT CMD Q
-------------------

171. [QPROCESS](query-process.html) [Query Process] Display processes
172. [QWinsta](query-session.html) [Query Session] Display all sessions (TS/Remote Desktop)
173. [QAppSrv](query-termserver.html) [Query TermServer] List all servers (TS/Remote Desktop)
174. [QUSER](query-user.html) [Query User] Display user sessions (TS/Remote Desktop)

___________________
NT CMD R
-------------------

175. [RASDIAL](rasdial.html) Manage RAS connections
176. [RASPHONE](rasphone.html) Manage RAS connections
177. [RD](rd.html) Delete a Directory•
178. [RECOVER](recover.html) Recover a damaged file from a defective disk
179. [REG](reg.html) Registry: Read, Set, Export, Delete keys and values
180. [REGEDIT](regedit.html) Import or export registry settings
181. [REGSVR32](regsvr32.html) Register or unregister a DLL
182. [REGINI](regini.html) Change Registry Permissions
183. [REM](rem.html) Record comments (remarks) in a batch file•
184. [REN](ren.html) Rename a file or files•
185. [REPLACE](replace.html) Replace or update one file with another
186. [Reset Session](reset-session.html) Delete a Remote Desktop Session
187. [RMDIR](rd.html) Delete a Directory•
188. [RMTSHARE](rmtshare.html) Share a folder or a printer
189. [ROBOCOPY](robocopy.html) Robust File and Folder Copy
190. [ROUTE](route.html) Manipulate network routing tables
191. [RUN](run.html) [Start | RUN](run.html) commands
192. [RUNAS](runas.html) Execute a program under a different user account
193. [RUNDLL32](rundll32.html) 207. Run a DLL command (add/remove print connections)

___________________
NT CMD S
-------------------

194. [SC](sc.html) Service Control
195. [SCHTASKS](schtasks.html) Schedule a command to run at a specific time
196. [ScriptRunner](scriptrunner.html) Run one or more scripts in sequence
197. [SET](set.html) Display, set, or remove session environment variables•
198. [SETLOCAL](setlocal.html) Control the visibility of environment variables•
199. [SetObjectSecurity](setobjectsecurity.html) Set security for an object (file, directory, reg key etc).
200. [SetSPN](setspn.html) Edit Service Principal Names
201. [SETX](setx.html) Set environment variables
202. [SFC](sfc.html) System File Checker
203. [SHARE](share.html) List or edit a file share or print share
204. [ShellRunAs](shellrunas.html) Run a command under a different user account
205. [SHIFT](shift.html) Shift the position of batch file parameters•
206. [SHORTCUT](shortcut.html) Create a windows shortcut (.LNK file)
207. [SHUTDOWN](shutdown.html) Shutdown the computer
208. [SIGCHECK](sigcheck.html) Display file version no. VirusTotal status & timestamp
209. [SLEEP](sleep.html) Wait for x seconds
210. [SLMGR](slmgr.html) Software Licensing Management
211. [SORT](sort.html) Sort input
212. [SSH](ssh.html) OpenSSH remote login client
213. [START](start.html) Start a program, command or batch file•
214. [STRINGS](strings.html) Search for ANSI and UNICODE strings in binary files
215. [SUBINACL](subinacl.html) Edit file and folder Permissions, Ownership and Domain
216. [SUBST](subst.html) Associate a path with a drive letter
217. [SXSTRACE](sxstrace.html) Diagnose side-by-side problems
218. [SYSMON](sysmon.html) Monitor and log system activity to the Windows event log
219. [SYSTEMINFO](systeminfo.html) List system configuration

___________________
NT CMD T
-------------------

220. [TAKEOWN](takeown.html) Take ownership of a file
221. [TAR](tar.html) Store, list or extract files in an archive
222. [TASKLIST](tasklist.html) List running applications and services
223. [TASKKILL](taskkill.html) End a running process
224. [TELNET](telnet.html) Communicate with another host using the TELNET protocol
225. [TIME](time.html) Display or set the system time•
226. [TIMEOUT](timeout.html) Delay processing of a batch file/command
227. [TITLE](title.html) Set the window title for a CMD.EXE session•
228. [TLIST](tlist.html) Task list with full path
229. [TOUCH](touch.html) Change file timestamps
230. [TRACERT](tracert.html) Trace route to a remote host
231. [TREE](tree.html) Graphical display of folder structure
232. [TSDISCON](tsdiscon.html) Disconnect a Remote Desktop Session
233. [TSKILL](tskill.html) End a running process
234. [TYPE](type.html) Display the contents of a text file•
235. [TypePerf](typeperf.html) Write Performance Monitor data to a log file
236. [TZUTIL](tzutil.html) Time Zone Utility

___________________
NT CMD V
-------------------

237. [VBC](vbc.html) Visual Basic compiler
238. [VER](ver.html) Display version information•
239. [VERIFY](verify.html) Verify that files have been saved•
240. [VMConnect](vmconnect.html) Connect to a Hyper-V Virtual Machine
241. [VOL](vol.html) Display a disk label•
242. [VSSADMIN](vssadmin.html) Display volume shadow copy backups + writers/providers

___________________
NT CMD W
-------------------

243. [W32TM](w32tm.html) Time Service
244. [WAITFOR](waitfor.html) Wait for or send a signal
245. [WBADMIN](wbadmin.html) Windows Backup Admin
246. [WECUTIL](wecutil.html) Windows Event Collector Utility
247. [WEVTUTIL](wevtutil.html) Clear event logs, enable/disable/query logs
248. [WHERE](where.html) Locate and display files in a directory tree
249. [WHOAMI](whoami.html) Output the current UserName and domain
250. [WHOIS](whois.html) Lookup the registration record for a domain
251. [WINDIFF](windiff.html) Compare the contents of two files or sets of files
252. [WINGET](winget.html) Windows Package Manager (coming [May 2021](https://devblogs.microsoft.com/commandline/windows-package-manager-preview/))
253. [WINMGMT](winmgmt.html) Manage the WMI service/WMI repository
254. [WINRM](winrm.html) Windows Remote Management
255. [WINRS](winrs.html) Windows Remote Shell
256. [WMIC](wmic.html) WMI Commands
257. [WPEUTIL](wpeutil.html) Run Preinstallation Environment (WinPE) commands
258. [WPR](wpr.html) Windows Performance Recorder
259. [WT](wt.html) Windows Terminal
260. [WUSA](wusa.html) Windows Update Standalone Installer
261. [WUAUCLT](wuauclt.html) Windows Update

___________________
NT CMD X
-------------------

262. [XCACLS](xcacls.html) Change file and folder permissions
263. [XCOPY](xcopy.html) Copy files and folders
264. [::](rem.html) Comment / Remark•

To scroll this page, press [ a – z ] on the keyboard, [] = Search.

Commands marked • are _Internal_ commands only available within the CMD shell.  
All other commands (not marked with •) are _external_ commands.  
External commands may be used under the CMD shell, [PowerShell](https://ss64.com/ps/), or directly from [START-RUN].

[A categorized list](https://ss64.com/nt/commands.html) of Windows CMD commands.  
Microsoft Help pages: [Windows Commands 8.1-10 / Windows Server 2012-2019](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/windows-commands)  
[SS64 CMD Forum](https://ss64.org/viewforum.php?f=2)  
[Websites, Books and Utilities](../links/windows.html) for Microsoft Windows.




    Windows CMD Commands (categorized) - Windows CMD - SS64.com  

/. A categorized list of Windows CMD commands
========================================================

Active Directory
*   [ADmodcmd](admodcmd.html) Active Directory Bulk Modify
*   [CSVDE](csvde.html)    Import or Export Active Directory data 
*   [DSACLs](dsacls.html)   Active Directory ACLs
*   [DSAdd](dsadd.html)    Add items to active directory ([user](dsadd-user.html) [group](dsadd-group.html) [computer](dsadd-computer.html)) 
*   [DSGet](dsget.html)    View items in active directory ([user](dsget-user.html) [group](dsget-group.html) [computer](dsget-computer.html))
*   [DSQuery](dsquery.html)  Search for items in active directory ([user](dsquery-user.html) [group](dsquery-group.html) [computer](dsquery-computer.html))
*   [DSMod](dsmod.html)    Modify items in active directory ([user](dsmod-user.html) [group](dsmod-group.html) [computer](dsmod-computer.html))
*   [DSMove](dsmove.html)   Move an Active directory Object
*   [DSRM](dsrm.html)     Remove items from Active Directory

Batch Files
*   [CALL](call.html)     Call one batch program from another•
*   [CHOICE](choice.html)   Accept keyboard input to a batch file
*   [CLIP](clip.html)     Copy STDIN to the Windows clipboard
*   CLS      Clear the screen•
*   [CMD](cmd.html)      Start a new CMD shell
*   [COLOR](color.html)    Change colors of the CMD window•
*   [DOSKEY](doskey.html)   Edit command line, recall commands, and create macros
*   [ECHO](echo.html)     Display message on screen•
*   [ENDLOCAL](endlocal.html) End localisation of environment changes in a batch file•
*   [EVENTCREATE](eventcreate.html) Add a message to the Windows event log
*   [EXIT](exit.html)     Quit the current script/routine and set an errorlevel•
*   [FOR /F](for_f.html)   Loop command: against a set of files•
*   [FOR /F](for_cmd.html)   Loop command: against the results of another command•
*   [FOR](for.html)      Loop command: all options Files, Directory, List•
*   [GOTO](goto.html)     Direct a batch program to jump to a labelled line•
*   [IF](if.html)       Conditionally perform a command•
*   [IFMEMBER](ifmember.html) Is the current user a member of a Workgroup
*   [LOGTIME](logtime.html)  Log the date and time in a file
*   [MAPISEND](mapisend.html) Send email from the command line
*   [MORE](more.html)     Display output, one screen at a time
*   [PAUSE](pause.html)    Suspend processing of a batch file and display a message•
*   [PROMPT](prompt.html)   Change the command prompt•
*   [REM](rem.html)      Record comments (remarks) in a batch file•
*   [RUN](run.html)      [Start | RUN](run.html) commands
*   [RUNAS](runas.html)    Execute a program under a different user account
*   [SET](set.html)      Display, set, or remove session environment variables•
*   [SETLOCAL](setlocal.html) Control the visibility of environment variables•
*   [SETX](setx.html)     Set environment variables
*   [SORT](sort.html)     Sort input
*   [SHIFT](shift.html)    Shift the position of batch file parameters•
*   [SLEEP](sleep.html)    Wait for x seconds
*   [START](start.html)    Start a program, command or batch file•
*   [TIMEOUT](timeout.html)  Delay processing of a batch file
*   [TITLE](title.html)    Set the window title for a CMD.EXE session•
*   [WAITFOR](waitfor.html)  Wait for or send a signal
*   [WMIC](wmic.html)     WMI Commands
*   [::](rem.html)       Comment / Remark•

Disk Management
*   [BCDBOOT](bcdboot.html)  Create or repair a system partition
*   [BCDEDIT](bcdedit.html)  Manage Boot Configuration Data
*   CONVERT  Convert a FAT drive to NTFS
*   [CHKDSK](chkdsk.html)   Check Disk - check and repair disk problems
*   [CHKNTFS](chkntfs.html)  Check the NTFS file system
*   [DEFRAG](defrag.html)   Defragment hard drive
*   [DISKPART](diskpart.html) Disk Administration
*   [DISKSHADOW](diskshadow.html) Volume Shadow Copy Service
*   [DriverQuery](driverquery.html) Display installed device drivers
*   [FORMAT](format.html)   Format a disk
*   FREEDISK Check free disk space (in bytes)
*   [LABEL](label.html)    Edit a disk label
*   [MOUNTVOL](mountvol.html) Manage a volume mount point
*   [NTBACKUP](ntbackup.html) Backup folders to tape
*   [SFC](sfc.html)      System File Checker
*   [VOL](vol.html)      Display a disk label•

Files and Folders
*   [ASSOC](assoc.html)    Change file extension associations•
*   [ASSOCIAT](associate.html) One step file association
*   [ATTRIB](attrib.html)   Change file attributes
*   [BITSADMIN](bitsadmin.html) Background Intelligent Transfer Service
*   [CACLS](cacls.html)    Change file permissions
*   [CD](cd.html)       Change Directory - move to a specific Folder•
*   [CIPHER](cipher.html)   Encrypt or Decrypt files/folders, secure delete
*   [COMP](comp.html)     Compare the contents of two files or sets of files
*   COMPACT  Compress files or folders on an NTFS partition
*   COMPRESS Compress individual files on an NTFS partition
*   [COPY](copy.html)     Copy one or more files to another location•
*   [CSCcmd](csccmd.html)   Client-side caching (Offline Files)
*   [DEL](del.html)      Delete one or more files•
*   [DELTREE](deltree.html)  Delete a folder and all subfolders
*   [DIR](dir.html)      Display a list of files and folders•
*   [ERASE](del.html)    Delete one or more files•
*   [EXPAND](expand.html)   Uncompress files
*   [EXTRACT](extract.html)  Uncompress CAB files
*   [FC](fc.html)       Compare two files
*   [FIND](find.html)     Search for a text string in a file
*   [FINDSTR](findstr.html)  Search for strings in files
*   [FORFILES](forfiles.html) Batch process multiple files
*   [FSUTIL](fsutil.html)   File and Volume utilities
*   [FTP](ftp.html)      File Transfer Protocol
*   [FTYPE](ftype.html)    File extension file type associations•
*   [iCACLS](icacls.html)   Change file and folder permissions
*   [MD](md.html)       Create new folders•
*   [MOVE](move.html)     Move files from one folder to another•
*   [MKLINK](mklink.html)   Create a symbolic link (linkd)
*   [OPENFILES](openfiles.html) Query or display open files
*   [POPD](popd.html)     Return to a previous directory saved by PUSHD•
*   [PsFile](psfile.html)   Show files opened remotely
*   [PUSHD](pushd.html)    Save and then change the current directory•
*   [RECOVER](recover.html)  Recover a damaged file from a defective disk
*   [REN](ren.html)      Rename a file or files•
*   [REPLACE](replace.html)  Replace or update one file with another
*   [RD](rd.html)       Delete folder(s)•
*   [RMTSHARE](rmtshare.html) Share a folder or a printer
*   [ROBOCOPY](robocopy.html) Robust File and Folder Copy
*   [SetObjectSecurity](setobjectsecurity.html)  Set security for an object (file, directory, reg key etc)
*   [SHARE](share.html)    List or edit a file share or print share
*   [SHORTCUT](shortcut.html) Create a windows shortcut (.LNK file)
*   [SUBINACL](subinacl.html) Edit file and folder Permissions, Ownership and Domain
*   [TAKEOWN](takeown.html)  Take ownership of a file
*   [TOUCH](touch.html)    Change file timestamps
*   TREE     Graphical display of folder structure
*   [TYPE](type.html)     Display the contents of a text file•
*   [WHERE](where.html)    Locate and display files in a directory tree
*   [WINDIFF](windiff.html)  Compare the contents of two files or sets of files
*   [XCACLS](xcacls.html)   Change file and folder permissions
*   [XCOPY](xcopy.html)    Copy files and folders

Group Policy/Windows Installer
*   [DevCon](devcon.html)   Device Manager Command Line Utility 
*   [GPRESULT](gpresult.html) Display Resultant Set of Policy information
*   [GPUPDATE](gpupdate.html) Update Group Policy settings
*   [MSIEXEC](msiexec.html)  Microsoft Windows Installer
*   [PsInfo](psinfo.html)   List information about a system
*   [PsShutdown](psshutdown.html) Shutdown or reboot a computer
*   [REGSVR32](regsvr32.html) Register or unregister a DLL
*   [SHUTDOWN](shutdown.html) Shutdown the computer
*   [SLMGR](slmgr.html)    Software Licensing Management (Vista/2008)
*   [WUAUCLT](wuauclt.html)  Windows Update

Networking
*   [ARP](arp.html)      Address Resolution Protocol
*   [BROWSTAT](browstat.html) Get domain, browser and PDC info
    DNSSTAT  DNS Statistics
*   [GETMAC](getmac.html)   Display the Media Access Control (MAC) address
*   [IPCONFIG](ipconfig.html) Configure IP
*   [NET](net.html)      Manage network resources
*   [NETDOM](netdom.html)   Domain Manager
*   [NETSH](netsh.html)    Configure Network Interfaces, Windows Firewall & Remote access
*   [NBTSTAT](nbtstat.html)  Display networking statistics (NetBIOS over TCP/IP)
*   [NETSTAT](netstat.html)  Display networking statistics (TCP/IP)
*   [NMBIND](nmbind.html)   Manage Hyper-V network bindings
*   [NSLOOKUP](nslookup.html) Name server lookup
*   [PATHPING](pathping.html) Trace route plus network latency and packet loss
*   [PsPing](psping.html)   Measure network performance
*   [PING](ping.html)     Test a network connection
*   [ROUTE](route.html)    Manipulate network routing tables
*   [TRACERT](tracert.html)  Trace route to a remote host

Processes
*   [PATH](path.html)     Display or set a search path for executable files•
*   [PsExec](psexec.html)   Execute process remotely
*   [PsKill](pskill.html)   Kill processes by name or process ID
*   [PsList](pslist.html)   List detailed information about processes
*   [PsGetSid](psgetsid.html) Display the SID of a computer or a user
*   [PsSuspend](pssuspend.html) Suspend processes
*   [SCHTASKS](schtasks.html) Schedule a command to run at a specific time
*   [SYSMON](sysmon.html)   Monitor and log system activity to the Windows event log
*   [TASKLIST](tasklist.html) List running applications and services
*   [TASKKILL](taskkill.html) End a running process
*   [TSKILL](tskill.html)   End a running process
*   [TLIST](tlist.html)    Task list with full path

Printing
*   [MODE](mode.html)     Configure a system device
*   [PRINT](print.html)    Print a text file
*   [PRINTBRM](printbrm.html) Print queue Backup/Recovery
*   [RUNDLL32](rundll32.html) Run a DLL command (add/remove print connections)

Recovery
*   [BOOTREC](bootrec.html)  Repair or replace a partition boot sector (WinRE).
*   [BCDBOOT](bcdboot.html)  Create or repair a system partition.
*   [BCDEDIT](bcdedit.html)  Manage Boot Configuration Data.
*   [WPEUTIL](wpeutil.html)  Run commands during a Windows Preinstallation Environment (WinPE) session.

Registry
*   [REG](reg.html)      Registry: Read, Set, Export, Delete keys and values
*   [REGEDIT](regedit.html)  Import or export registry settings
*   [REGINI](regini.html)   Change Registry Permissions

Remote Desktop
*   [CHANGE](change.html)   Change Terminal Server Session properties
*   [Query Process](query-process.html)    Display processes (TS/Remote Desktop)
*   [Query Session](query-session.html)    Display all sessions (TS/Remote Desktop)
*   [Query TermServer](query-termserver.html) List all servers (TS/Remote Desktop)
*   [Query User](query-user.html)       Display user sessions (TS/Remote Desktop)
*   [MSTSC](mstsc.html)    Terminal Server Connection (Remote Desktop Protocol)
*   [RASDIAL](rasdial.html)  Manage RAS connections
*   [RASPHONE](rasphone.html) Manage RAS connections
*   [Reset Session](reset-session.html) - Delete a Remote Desktop Session
*   [TSDISCON](tsdiscon.html) Disconnect a Remote Desktop Session
*   [WINRM](winrm.html)    Windows Remote Management
*   [WINRS](winrs.html)    Windows Remote Shell

Services
*   [CASPOL](caspol.html)   Code Access Security Policy Tool.
*   [PORTQRY](portqry.html)  Display the status of ports and services
*   [PsService](psservice.html) View and control services
    [SC](sc.html)       Service Control

System Information
*   [CHANGEPK](changepk.html) Upgrade device Edition/Product Key
*   [DATE](date.html)     Display or set the date•
*   [HELP](help.html)     Online Help
*   [LOGMAN](logman.html)   Manage Performance Monitor logs
*   [MBSAcli](mbsacli.html)  Baseline Security Analyzer
*   [MSINFO32](msinfo32.html) System Information
*   [NOW](now.html)      Display the current Date and Time 
*   [NTRIGHTS](ntrights.html) Edit user account rights
*   [PsLogList](psloglist.html)  Event log records
*   [SFC](sfc.html)      System File Checker
*   [SXSTRACE](sxstrace.html) Diagnose side-by-side problems.
*   [SYSMON](sysmon.html)   Monitor and log system activity to the Windows event log
*   [SYSTEMINFO](systeminfo.html) List system configuration
*   [TIME](time.html)     Display or set the system time•
*   [TypePerf](typeperf.html) Write performance data to a log file
*   [VER](ver.html)      Display version information•
*   [VERIFY](verify.html)   Verify that files have been saved•
*   [WHOAMI](whoami.html)   Output the current UserName and domain

User Administration
*   [ADDUSERS](addusers.html) Add or list users to/from a CSV file
*   [CERTREQ](certreq.html)  Request certificate from a certification authority
*   [CleanMgr](cleanmgr.html) Automated cleanup of Temp files, recycle bin
*   [CON2PRT](con2prt.html)  Connect or disconnect a Printer
*   [CMDKEY](cmdkey.html)   Manage stored usernames/passwords
*   [DELPROF](delprof.html)  Delete user profiles
*   [DIRUSE](diruse.html)   Display disk usage
*   [LOGOFF](logoff.html)   Log a user off
*   [MOVEUSER](moveuser.html) Move a user from one domain to another
*   [MSG](msg.html)      Send a message
*   [PERMS](perms.html)    Show permissions for a user
*   [POWERCFG](powercfg.html) Configure power settings
*   [PsLoggedOn](psloggedon.html) Who's logged on (locally or via resource sharing)
*   [PsPasswd](pspasswd.html)   Change account password
*   [SUBST](subst.html)    Associate a path with a drive letter

Commands marked • are _Internal_ commands only available within the CMD shell.  
All other commands (not marked with •) are _external_ commands.  
External commands may be used under the CMD shell, [PowerShell](https://ss64.com/nt/ps/), or directly from [Start ➞ Run].

See also:

[An A-Z Index of the Windows CMD command line](https://ss64.com/nt/)  
Microsoft Help pages: [Windows Commands 8.1-10 / Windows Server 2008-2012](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/windows-commands)  
[Ss64 Discussion forum](https://ss64.org/)  
[Links to other sites, books etc...](../links/windows.html)





/. nt/syntax-args.html
========================================================

    Parameters / Arguments - Windows CMD - SS64.com

How-to: Pass Command Line arguments (Parameters) to a Windows batch file.
=========================================================================

A command line argument (or parameter) is any value passed into a batch script:

C:> MyScript.cmd January 1234 "Some value"

Arguments can also be passed to a subroutine with CALL:

CALL :my_sub 2468

You can get the value of any argument using a % followed by it's numerical position on the command line. The first item passed is always %1 the second item is always %2 and so on.

%* in a batch script refers to all the arguments (e.g. %1 %2 %3 %4 %5 ...%255)  
only arguments %1 to %9 can be referenced by number.

If the argument being passed contains any spaces, then surround it with double quotes.  
If there is any chance that an argument may be NULL or a zero length string, then surround it with double quotes. This will keep the parameter numbers (%1 %2 etc) consistent.

Parameter Extensions
--------------------

> When an argument is used to supply a filename then the following extended syntax can be applied:  
> We are using the variable %1 (but this works for any argument, including FOR parameters).
> 
> %~f1  Expand %1 to a Fully qualified path name - C:\utils\MyFile.txt  
>   
> %~d1  Expand %1 to a Drive letter only - C:  
>   
> %~p1  Expand %1 to a Path only e.g. \utils\ this includes a trailing \ which will be interpreted as an [escape character](syntax-esc.html#escape) by some commands.  
>   
> %~n1  Expand %1 to a file Name without file extension or path - MyFile  
> or if only a path is present, with no trailing backslash, the last folder in that path.  
>   
> %~x1  Expand %1 to a file eXtension only - .txt  
>   
> %~s1  Change the meaning of f, n, s and x to reference the Short 8.3 name (if it exists.)  
>   
> %~1   Expand %1 removing any [surrounding quotes](syntax-dequote.html) (")  
>   
> %~a1  Display the file attributes of %1  
>   
> %~t1  Display the date/time of %1  
>   
> %~z1  Display the file size of %1  
>   
> %~$PATH:1  Search the PATH environment variable and expand %1 to the fully qualified name of the first match found.

The modifiers above can be combined:

> %~dp1 Expand %1 to a drive letter and path only.
> 
> %~sp1 Expand %1 to a path shortened to 8.3 characters.  
>   
> %~nx2 Expand %2 to a file name and extension only.

These parameter/ argument variables are always denoted with a single leading %  
This is unlike regular [variables](syntax-variables.html) which have both leading and trailing %'s such as %variable%, or [FOR](for.html) command variables which use a single leading % on the command line or a double leading %% when used in a batch file.

When used as part of a [FOR](for.html) command in a batch file, two %'s are required:

    Set _file=C:\Program Files\SS64\Demo.exe  
    For %%G in ("%_file%") DO echo Drive=%%~dG Path=%%~pG Name=%%~nG Ext=%%~xG

Parameter expansion will treat a Full Stop within a directory name as a file extension, so for a name like "Sample 2.6.4" the output of %~n1 will be truncated to "Sample 2.6" to return the whole folder name use %1 or %~nx1

If the output of DIR, or a filename with no drive letter/path is expanded to display a Full pathname %~f1 the command shell will assume; often incorrectly; that the file resides in the [current](cd.html) directory. The CMD shell does not read file descriptors, or work with filesystem objects the way that PowerShell does, it is processing a simple list of text strings.

When writing batch scripts it's a good idea to store the values in a named variable SET _LogFile=%~dp1, the rest of the script can then refer to the easy-to-read variable name %_LogFile% This will also make life easier if you later need to change around the order of the parameters.

Tokenization
------------

> Tokenization of the command line arguments is not always done by the cmd.exe shell. Most often the tokenization is done by the newly formed processes' runtime, at the OS level, Windows passes a command line untokenized as a single string to the new process. You can read more about the low-level details of the batch language/cmd escaping from the excellent answers by jeb and dbenham on [this StackOverflow question](https://stackoverflow.com/questions/4094699/how-does-the-windows-command-interpreter-cmd-exe-parse-scripts).

Passing by Reference
--------------------

> In addition to passing numeric or string values on the command line, it is also possible to pass a [variable](syntax-variables.html) name and then use the variable to transfer data between scripts or subroutines. Passing by reference is a slightly more advanced technique but can be essential if the string contains characters that are CMD [delimiters](syntax-esc.html#delimiters) or quotes, otherwise passing a string like _Start & middle:"and & End_ is likely to break something.

Drag and Drop
-------------

> If you drag and drop one or more files or folders onto a batch file, the batch will be executed and the filenames (or folder names) will be passed to the batch file as arguments:  
> %1 = "first file", %2 = "second file" etc  
> Quotes are automatically added to long file names. This also happens if you drag a file into a CMD window, the full quoted filename will appear at the prompt.  
> If you need to drag and drop more than 9 files, use the [SHIFT](shift.html) command inside the script.

Links relative to the Batch Script
----------------------------------

> You can get the pathname of the batch script itself with %0, parameter extensions can be applied to this so %~dp0 will return the Drive and Path to the batch script e.g. W:\scripts\ and %~f0 will return the full pathname W:\scripts\mybatch.cmd
> 
> You can refer to other files in the same folder as the batch script by using this syntax:
> 
>   CALL %0\..\SecondBatch.cmd
> 
> This can even be used in a [subroutine](call.html), Echo %0 will give the call label but, echo "%~nx0" will give you the filename of the batch script.
> 
> When the %0 variable is expanded, the result is enclosed in quotation marks.

Use %~a1 to display the Extended Attributes of a file.
------------------------------------------------------

> FOR's %%~aI recognizes 9 NTFS file [attributes](attrib.html). The expansion of a file attribute produces a series of 9 dashes, with each recognized attribute replacing a dash with a letter. A file with no recognized attributes or with none set will expand to 9 dashes like this: ---------
> 
>  Attribute                    Expansion 
>  FILE_ATTRIBUTE_DIRECTORY     d-------- 
>  FILE_ATTRIBUTE_READONLY      -r------- 
>  FILE_ATTRIBUTE_ARCHIVE       --a------ 
>  FILE_ATTRIBUTE_HIDDEN        ---h----- 
>  FILE_ATTRIBUTE_SYSTEM        ----s---- 
>  FILE_ATTRIBUTE_COMPRESSED    -----c--- 
>  FILE_ATTRIBUTE_OFFLINE       ------o-- 
>  FILE_ATTRIBUTE_TEMPORARY     -------t- 
>  FILE_ATTRIBUTE_REPARSE_POINT --------l
>  FILE_ATTRIBUTE_NORMAL        --------- 
> 
> Other NTFS attributes not recognised by %%~aI can be read using [FSUTIL usn command](attrib.html#attributes):  
> FILE_ATTRIBUTE_ENCRYPTED  
> FILE_ATTRIBUTE_NOT_CONTENT_INDEXED  
> FILE_ATTRIBUTE_SPARSE_FILE
> 
> Example: Expansion of a file with the Hidden and System attributes:  
> ---hs----

Maximum line length
-------------------

> The maximum length of any command line (or variable) within CMD is [8191](https://support.microsoft.com/en-gb/kb/830473) characters.

Terminology: Command-line Argument or Parameter?
------------------------------------------------

> In mathematical terms a **parameter** is _"a numerical or other measurable factor"_ so typically a number.
> 
> In programming terminology:  
> A parameter represents a value that the procedure expects you to pass when you call it.  
> An argument represents the actual value that you pass to a procedure.
> 
> In practice the phrases _argument_ and _parameter_ tend to be used interchangeably, CMD batch files do not perform any type checking.

FOR parameters
--------------

> The [FOR](for.html) command creates parameter variables which are identified with a letter rather than a number (e.g. %%G).  
> The Parameter Expansions described above can also be applied to these.  
> To avoid confusion between the two sets of letters, avoid using the letters (a, d, f, n, p, s, t, x, z) as FOR parameters or just choose a FOR parameter letter that is UPPER case.  
> So for example in a reference like %%~fG the %%G is the FOR parameter, and the ~f is the Parameter Expansion.

### Examples

Pass parameters from one batch to another:

    MyBatch.cmd SMITH 100

Or as part of a [CALL](call.html) :

    CALL MyBatch.cmd SMITH 100

Get the file size of C:\demo\sample.xlsx using the %~z parameter extension:  

    @Echo off
    For %%G in ("C:\demo\sample.xlsx") do set _var=%%~zG
    Echo File size is %_var%

Passing values from one part of a script to another:

    :: Using [CALL](call.html) to jump to a subroutine
    CALL :s_staff SMITH 100

    :: Calling a subroutine from a [FOR](for.html) command
    FOR /F %%G IN ('DIR /b *.*') DO call :s_subroutine %%G

_“I came here for a good argument, No you didn’t, you came here for an argument” ~ [Monty Python](https://www.youtube.com/watch?v=ohDB5gbtaEQ)_

### Related commands

[CALL](call.html) - Call one batch program from another.  
[CMD](cmd.html) - Start a new DOS shell (cmd.exe).  
[IF](if.html) - Test that required inputs are in place (not NULL).  
[FOR](for.html) - Conditionally perform a command several times.  
[SETLOCAL](setlocal.html) - Control the visibility of environment variables.  
[SHIFT](shift.html) - Shift the position of replaceable parameters in a batch file.  
How-to: [Escape chars](syntax-esc.html), delimiters and quotes.  
PowerShell equivalent: Cast a pathname string to [System.IO.FileInfo]  
[StackOverflow](https://stackoverflow.com/a/8162578/1720814) - Script to parse optional arguments by Dave Benham.  
[How Command Line Parameters are Parsed](https://web.archive.org/web/20171224100252/http://daviddeley.com/autohotkey/parameters/parameters.htm) by David Deley.  
[StackOverflow](https://stackoverflow.com/questions/4094699/how-does-the-windows-command-interpreter-cmd-exe-parse-scripts/4095133#4095133) - How does the Windows Command Interpreter (CMD.EXE) parse scripts?  
Equivalent bash command (Linux): [dirname](../bash/dirname.html) - Convert a full pathname to just a path.



/. nt/syntax-arrays.html
========================================================

    Arrays (pseudo-arrays) - Windows CMD - SS64.com

How-to: Create and use Arrays (pseudo-arrays) in Windows CMD.
=============================================================

Unlike PowerShell, which [fully supports arrays](../ps/syntax-arrays.html), there is no built in support for array variables within the CMD shell. However with some effort you can replicate this functionality using a series of separate variables, named to represent the array:

    Set elem[1]=First element  
    Set elem[2]=Second one  
    Set elem[3]=The third one

To perform array indexing operations with these, use [EnableDelayedExpansion](delayedexpansion.html) and a reference like !elem[%var%]!  
this is explained fully in [this StackOverflow Q/A](https://stackoverflow.com/questions/10166386/arrays-linked-lists-and-other-data-structures-in-cmd-exe-batch-script/10167990#10167990).

Example of building and then reading an array of values:

> @echo off
> Setlocal EnableDelayedExpansion
> 
> Set _folder=c:\pictures
> Set _count=1
> 
> :: Store each filename in a pseudo-array named like "_pic[0], _pic[1]..."
> For /r "%_folder%" %%A in (*.jpg) do (
>    Set _pic[!_count!]=%%~A
>    Set /a _count+=1
> )
> Set /a _count-=1
> Echo The number of files is %_count%
> 
> Echo:
> Echo Now enumerating the array:
> For /L %%G in (1,1,%_count%) Do (
> Echo Array item _pic[%%G] is !_pic[%%G]!
> )

Credits: bluesxman, adapted from this forum thread: [Pick random file from a folder](https://ss64.org/viewtopic.php?f=2&t=9).

"There are only two hard things in Computer Science: cache invalidation and naming things" ~ Phil Karlton

### Related commands

How-to: [Variables and Operators](syntax-variables.html) - Create variable, add to value, subtract, divide.  
How-to: [Environment variables](syntax-variables.html) - Windows environment variables Env:  
How-to: [Functions](syntax-functions.html) - How to package blocks of code.  
PowerShell equivalent: [Create and use PowerShell Arrays](../ps/syntax-arrays.html)



/. nt/syntax-variables.html
========================================================

    Windows Environment Variables - Windows CMD - SS64.com

How-to: Windows Environment Variables
=====================================

Environment variables are mainly used within batch files, they can be created, modified and deleted for a session using the [SET](set.html) command. To make permanent changes, use [SETX](setx.html)  
  
Variables can be displayed using either [SET](set.html) or [ECHO](echo.html).

Variables have a percent sign on both sides: %ThisIsAVariable%  
The variable name can include spaces, punctuation and mixed case: %_Another Ex.ample%  
(This is unlike [Parameter variables](syntax-args.html) which only have one % sign and are always one character long: %A )

A variable name may include any of the following characters:  
A-Z, a-z, 0-9, # $ ' ( ) * + , - . ? @ [ ] _ \` { } ~  
The first character of the name must [not be numeric](syntax-percent.html).

Standard (built-in) Variables default value
-----------------------------

Standard (built-in) Variables default value assuming the system drive is C:


01.  ALLUSERSPROFILE 

    C:\ProgramData
    Predefined machine-wide system variable.

02.  APPDATA 

    C:\Users_{username}_\AppData\Roaming

03.  CD 

    The current directory (string).

04.  ClientName 

    Terminal servers only - the ComputerName of a remote host.

05.  CMDEXTVERSION 

    The current Command Processor Extensions version number. (NT = "1", Win2000+ = "2".)

06.  CMDCMDLINE 

    The original command line that invoked the [Command Processor](cmd.html).

07.  CommonProgramFiles 

    C:\Program Files\Common Files

08.  COMMONPROGRAMFILES(

    C:\Program Files (x86)\Common Files

09.  COMPUTERNAME 

    {_computername_}

10.  COMSPEC 

    C:\Windows\System32\cmd.exe or if running a 32 bit [WOW](syntax-64bit.html) - C:\Windows\SysWOW64\cmd.exe

    Comspec is used whenever the command shell spawns a new process, e.g. the [FOR](for.html) command, if comspec is not defined those processes will fail to launch.

11.  DATE 

    The current date using same region specific format as [DATE](date.html).

12.  ERRORLEVEL 

    The current ERRORLEVEL value, automatically set when a program exits.

13.  FPS_BROWSER_APP_PROFILE_STRING
    FPS_BROWSER_USER_PROFILE_STRING 

    Internet Explorer  
    Default  
    These are undocumented variables for the Edge browser in Windows 10.

14.  HighestNumaNodeNumber 

    The highest [NUMA](https://docs.microsoft.com/en-gb/windows/desktop/ProcThread/numa-support) node number on this computer.

15.  HOMEDRIVE 

    C:

16.  HOMEPATH 

    \Users_{username}_

17.  HOMESHARE 

    Network home folder.

18.  LOCALAPPDATA 

    C:\Users_{username}_\AppData\Local

19.  LOGONSERVER 

    \{domain_logon_server}

20.  NUMBER_OF_PROCESSORS 

    The Number of processors running on the machine.

21.  OneDrive 

    OneDrive synchronisation folder.

22.  OS 

    Operating system on the user's workstation.

23.  [PATH]

    C:\Windows\System32\;C:\Windows\;C:\Windows\System32\Wbem;_{plus program paths}_

24.  PATHEXT 

    .COM; .EXE; .BAT; .CMD; .VBS; .VBE; .JS ; .WSF; .WSH; .MSC

    Determine the default executable file extensions to search for and use, and in which order, left to right.
    The syntax is like the PATH variable - semicolon separators.

25.  PROCESSOR_ARCHITECTURE 

    AMD64/IA64/x86 This doesn’t tell you the architecture of the processor but only of the current process, so it returns "x86" for a 32 bit [WOW](syntax-64bit.html) process running on 64 bit Windows. See [detecting OS 32/64 bit](syntax-64bit.html)

26.  PROCESSOR_ARCHITEW6432 

    =%PROCESSOR_ARCHITECTURE% (but only available to 64 bit processes)

27.  PROCESSOR_IDENTIFIER 

    Processor ID of the user's workstation.

28.  PROCESSOR_LEVEL 

    Processor level of the user's workstation.

29.  PROCESSOR_REVISION 

    Processor version of the user's workstation.

30.  ProgramData 

    C:\ProgramData

31.  ProgramFiles 

    [C:\Program Files or C:\Program Files (x86)](syntax-64bit.html)

32.  ProgramFiles(

    C:\Program Files (x86)   (but only available when running under a 64 bit OS)

33.  ProgramW6432 

    =%ProgramFiles%(but only available when running under a 64 bit OS)

34.  PROMPT 

    C:>
    Code for current command [prompt](prompt.html) format,usually $P$G

35.  PSModulePath 

    %SystemRoot%\system32\WindowsPowerShell\v1.0\Modules\

36.  Public 

    C:\Users\Public

37.  [RANDOM]

    A random integer number, anything from 0 to 32,767 (inclusive).

38.  %SessionName%

    Terminal servers only - for a terminal server session, SessionName is a combination of the connection name, followed by #S_essionNumber_. For a console session, SessionName returns "Console".

39.  SYSTEMDRIVE 

    C:

40.  SYSTEMROOT 

    The main Windows system folder. By default, **C:\Windows**
    Windows can be installed to a different drive letter or (rarely) a different folder.
    systemroot is a predefined machine-wide read-only system variable that will resolve to the correct location.  
    Defaults in early Windows versions are C:\WINNT, C:\WINNT35 and C:\WTSRV

41.  TEMP and [TMP](https://devblogs.microsoft.com/oldnewthing/?p=44213) 

    C:\Users_{Username}_\AppData\Local\Temp

42.  TIME 

    The current time using same format as [TIME](time.html). In some locales, this will include a comma separator which is also a command delimiter.

43.  [UserDnsDomain](https://blogs.msdn.microsoft.com/tihot/2004/05/28/getting-the-dns-domain/) 

    Set if a user is a logged on to a domain and returns the fully qualified DNS domain that the currently logged on user's account belongs to.

44.  USERDOMAIN 

    {userdomain}

45.  USERDOMAIN_roamingprofile 

    The user domain for RDS or standard roaming profile paths. Windows 8/10/2012.

46.  USERNAME 

    Defined as "SYSTEM", resolves as _{username}_

47.  USERPROFILE 

    %SystemDrive%\Users_{username}_

    This is equivalent to the $HOME environment variable in Unix/Linux

48.  WINDIR 

    Set by default as windir=%SystemRoot%

    %WinDir% pre-dates Windows NT, its use in many places has been replaced by the system variable: %SystemRoot%

49.  ZES_ENABLE_SYSMAN 

    System Resource Management library, Windows 11. Enables driver initialization and dependencies for system management. Set to 0 to disable.

Standard (built-in) Variables
-----------------------------

| Variable | Dynamic (update every time used) | Volatile (Set at Logon) | Shell Variable | User Environment Variable ([SETX]) | System Environment Variable ([SETX /M]) |
|----------|----------------------------------|-------------------------|----------------|------------------------------------|-----------------------------------------|
| ALLUSERSPROFILE |  |  | Y |  |  | 
| APPDATA |  | Y | Y |  |  |
| CD | Y |  | Y |  |  |
| ClientName |  | Y | Y |  |  |
| CMDEXTVERSION | Y |  | Y |  |  |
| CMDCMDLINE | Y |  | Y |  |  |
| CommonProgramFiles |  |  | Y |  |  |
| COMMONPROGRAMFILES(x86) |  |  | Y |  |  |
| COMPUTERNAME |  |  | Y |  |  |
| COMSPEC |  |  |  |  | Y | 
| DATE | Y |  | Y |  |  |
| ERRORLEVEL | Y |  | Y |  |  |
| FPS_BROWSER_APP_PROFILE_STRING  
| FPS_BROWSER_USER_PROFILE_STRING |   |  |Y |  | 
| HighestNumaNodeNumber | Y (hidden)|  | Y |  |  |
| HOMEDRIVE |  | Y | Y |  |  |
| HOMEPATH |  | Y | Y |  |  |
| HOMESHARE |  | Y |  |  |  |
| LOCALAPPDATA |  | Y | Y |  |  |
| LOGONSERVER |  | Y | Y |  |  |
| NUMBER_OF_PROCESSORS |  |  |  |  | Y |
| OneDrive |  |  |  | Y |  |
| OS |  |  |  |  | Y |
| PATH |  |  |  | Y | Y |
| PATHEXT |  ||  |  | Y | 
| PROCESSOR_ARCHITECTURE |  |  |  |  | Y |
| PROCESSOR_ARCHITEW6432 |  |  |  |  |  |
| PROCESSOR_IDENTIFIER |  |  |  |  | Y |
| PROCESSOR_LEVEL |  |  |  |  | Y |
| PROCESSOR_REVISION |  |  |  |  | Y |
| ProgramData |  |  | Y |  |  |
| ProgramFiles |  |  | Y |  |  |
| ProgramFiles(x86)➊ |  |  | Y |  |  |
| ProgramW6432 |  |  |  |  |  |
| PROMPT |  |  | Y |  |  | 
| PSModulePath |  |  |  |  | Y |
| Public |  |  | Y |  |  |
| RANDOM | Y |  |  |  |  |
| %SessionName% |  |  |  |  |  |
| SYSTEMDRIVE |  |  | Y |  |  |
| SYSTEMROOT |  |  | Y |  |  | 
| TEMP and TMP |  |  |  | Y | Y |
| TIME | Y |  |  |  |  |
| UserDnsDomain |  | Y |  | Y |  |
| USERDOMAIN |  | Y | Y |  |  |
| USERDOMAIN_roamingprofile |  | Y |  |  |  |
| USERNAME |  | Y |  |  | Y |
| USERPROFILE |  | Y | Y |  |  |
| WINDIR |  |  |  |  | Y |
| ZES_ENABLE_SYSMAN➊ |  |  |  |  |  |

    ➊ Only on [64 bit systems](syntax-64bit.html), is used to store 32 bit programs.

Environment variables are stored in the registry:

> User Environment Variables: HKCU\Environment  
> System Environment Variables: HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment

By default, files stored under **Local Settings** do not roam with a roaming profile.

**Dynamic** environment variables are computed each time the variable is expanded, this makes them inherently read-only.  
When all variables are listed with SET, these will not appear in the list.

**Volatile** variables are defined under the registry: HKCU\Volatile Environment  
Do not attempt to directly SET a volatile variable, while you could change them, the system will overwrite them with newly derived values. The majority of volatile variables are **CMD shell** variables, so like all CMD shell variables they are stored in memory only.

### Example

Get the full pathname of a file in Program Files, this will return the correct result even on machines which have Program Files on a different drive:  

    For /f "delims=" %%G in ('dir /s /b "**%ProgramFiles%**\demo.exe"') Do set _filename="%%G"  
    Echo %_filename%

Precedence
----------

> When a new process is started, the variables will be loaded in the following order:

1.  System Environment Variables
2.  Shell Variables (per user)
3.  User Environment Variables
4.  Shell Variables (other)

> After the process has started, additional shell variables can be defined with [SET](set.html), these will be available only to the current CMD shell session, but they will take precedence over any environment variables with the same name.
> 
> For example, if the [SET](set.html) command is used to modify the [PATH](path.html), or if it is removed completely with PATH ; that will affect the current process, but not any other programs or CMD sessions opened before or after the current one.
> 
> This precedence is important to understand because if you try to set a **System** Environment variable PATH = %APPDATA%;C:\Windows, it will fail because the %APPDATA% Shell variable is [not created until after](https://docs.microsoft.com/en-us/previous-versions/technet-magazine/jj853254(v=msdn.10)) the System environment variables are imported to the session.  
> However, you can use %APPDATA% to build a **User** environment variable PATH.
> 
> Running the SET command with no options will display all Shell variables plus all User and System Environment variables, in other words every variable available to be read by that session. In PowerShell the same list is available via the env: drive  

Undocumented Dynamic variables (read only)
------------------------------------------

> %__APPDIR__%   The directory path to the current application .exe, terminated with a trailing backslash. (Global) - [discuss](https://ss64.org/viewtopic.php?t=338)  
> %__CD__%   The current directory, terminated with a trailing backslash. (Global)  
> %=C:%   The current directory of the C: drive. ( See Raymond Chen's [explanation of this](https://devblogs.microsoft.com/oldnewthing/20100506-00/?p=14133).)  
> %=D:%   The current directory of the D: drive if drive D: has been accessed in the current CMD session.  
> %DPATH%   Related to the (deprecated) [DPATH](path.html#dpath) command.  
> %=ExitCode%   The most recent exit code returned by an external command, such as CMD /C EXIT _n_, converted to **hex**.  
> %=ExitCodeAscii%   The most recent exit code returned by an external command, as [ASCII](../ascii.html). (Values 0-32 do not display because those map to ASCII control codes.)  
> %FIRMWARE_TYPE% The boot type of the system: Legacy, UEFI, Not implemented, Unknown Windows 8/2012.  
> %KEYS%   Related to the (deprecated) KEYS command.
> 
> It is impossible to use SET to define or alter these variables because SET does not allow '=' in a variable name.  
> More detail on these undocumented variables can be found in [this stackoverflow answer](https://stackoverflow.com/questions/20156490/why-cant-i-access-a-variable-named-cd-on-windows-7/20169219#20169219) from Dave Benham.

Undocumented Dynamic variables (read/write)
-------------------------------------------

> %__COMPAT_LAYER%   Set the ExecutionLevel to either RunAsInvoker (asInvoker), RunAsHighest(highestAvailable) or RunAsAdmin(requireAdministrator) for more see [elevation](syntax-elevate.html) and [Q286705](https://support.microsoft.com/en-us/kb/286705) / [Application Compatibility Toolkit](https://www.microsoft.com/en-us/download/details.aspx?id=7352) for other Compatibility Layers (colours,themes etc).

Pass variables between batch scripts
------------------------------------

> There are several ways to pass values between batch files, or between a batch file and the command line, see the [CALL](call.html) and [SETLOCAL](setlocal.html) pages for full details.
> 
> A child process by default inherits a copy of all environment variables from its parent, this makes environment variables unsuitable for storing _secret_ information such as API keys or user passwords, especially in rare occasions like crashes where a crash log will often include the full OS environment at the time of the crash. PowerShell/Get-Credential is a more secure approach.

If [Command Extensions](cmd.html) are disabled, the following dynamic variables will be not accessible:  
%CD% %DATE% %TIME% %RANDOM% %ERRORLEVEL% %CMDEXTVERSION% %CMDCMDLINE% %HIGHESTNUMANODENUMBER%

“Men may be convinced, but they cannot be pleased against their will. But though taste is obstinate, it is very variable, and time often prevails when arguments have failed” ~ Samuel Johnson

### Related commands

How-to: [Array Variables in CMD](syntax-arrays.html).  
How-to: [User Shell Folders - Profile, Start Menu](syntax-folders.html) - Location of user profile folders.  
How-to: [Detecting 32 vs 64 bit Windows](syntax-64bit.html).  
[CALL](call.html) - Evaluate environment variables.  
[SET](set.html) - View environment variables, set local variables.  
[SETX](setx.html) - Set environment variables.  
[How the environment-building process works](https://docs.microsoft.com/en-us/previous-versions/technet-magazine/jj853254(v=msdn.10)) - Raymond Chen [MSFT].  
PowerShell equivalent: [Working with Environment variables](../ps/syntax-env.html).  
[Q100843](https://web.archive.org/web/20140307091135/https://support.microsoft.com/kb/100843) - The four types of environment variable.  
[Q286705](https://web.archive.org/web/20120104081656/http://support.microsoft.com:80/kb/286705) - Set compatibility variables in a batch file.  
[Q242557](https://support.microsoft.com/en-us/help/242557/) - Registry Settings for Folder Redirection.  
[StackOverflow](https://stackoverflow.com/questions/6379619/explain-how-dos-batch-newline-variable-hack-works) - Storing a Newline in a variable.



/. nt/syntax-functions.html
========================================================

    Functions - Windows CMD - SS64.com

How-to: Create and use a Batch file Function.
=============================================

Packaging up code into a discrete functions, each with a clear purpose is a very common programming technique. Re-using known, tested code, means you can solve problems very quickly by just bolting together a few functions.

The CMD shell does not have any documented support for functions, but you can fake it by passing [arguments/parameters](syntax-args.html) to a subroutine and you can use [SETLOCAL](setlocal.html) to control the visibility of variables.

A common first attempt at building a function:  
:myfunct  
SETLOCAL  
SET _var1=%1  
SET _var2="%_var1%--%_var1%--%_var1%"  
SET _result=%_var2%  
ENDLOCAL  
  
but there is a problem, the ENDLOCAL command will throw away the _result variable and so the function returns nothing.

:myfunct2  
SETLOCAL  
SET _var1=%1  
SET _var2="%_var1%--%_var1%--%_var1%"  
ENDLOCAL  
SET _result=%_var2%

This version is getting close, but it still fails to return a value, this time because ENDLOCAL will throw away the _var2 variable  
  
The solution to this is to take advantage of the fact that the CMD shell evaluates variables on a line-by-line basis - so placing ENDLOCAL **on the same line** as the SET statement(s) gives the result we want. This technique is known as 'tunneling' and works for both functions and entire batch scripts:

:myfunct3  
SETLOCAL  
SET _var1=%1  
SET _var2="%_var1%--%_var1%--%_var1%"  
ENDLOCAL [&](syntax-redirection.html) SET _result=%_var2%  
  
In examples above there are just 2 local variables (_var1 and _var2) but in practice there could be far more, by turning the script into a function with SETLOCAL and ENDLOCAL we don’t have to worry if any variable names will clash.

In other words you can do this, the variables _var1 and _var2 refer to completely different values inside and outside the subroutine:

@ECHO OFF  
SET _var1=64  
SET _var2=123  
CALL :myfunct3 SomeText  
echo _var1 is %_var1%  
echo _var2 is %_var2%  
echo Final result %_result%  
goto :eof  
  
:myfunct3  
SETLOCAL  
SET _var1=%1  
SET _var2="%_var1%--%_var1%--%_var1%"  
ENDLOCAL [&](syntax-redirection.html) SET _result=%_var2%

When working with functions it can be useful to use [Filename Parameter Extensions](syntax-args.html) against the function name, %0 will contain the call label, %~nx0 the file name, see [Rob Hubbards blog](https://rhubbarb.wordpress.com/2009/06/17/batch-func-param-filename/) for an example. Note that if you have two scripts one calling another, this will not reveal the location of the 'calling' script.

“A complex system that works is invariably found to have evolved from a simple system that worked. A complex system designed from scratch never works and cannot be patched up to make it work. You have to start over with a working simple system.” ~ John Gall (Gall's Law)

### Related commands

[CALL](call.html) - Call one batch program from another.  
How-to: [Macros](syntax-macros.html) - Embed blocks of code in a variable.  
[SETLOCAL](setlocal.html) - Control the visibility of environment variables.  
[SHIFT](shift.html) - Shift the position of replaceable parameters in a batch file.  
[DosTips.com](https://www.dostips.com/DtCodeCmdLib.php) - A collection of CMD functions.



/. nt/syntax-conditional.html
========================================================

    Conditional Execution AND OR IF - Windows CMD - SS64.com

How-to: Conditional Execution
=============================

Syntax


if command1 succeeds then execute command2 (IF)

> command1 **&&** command2

Execute command1 and then execute command2 (AND)

> command1 **&** command2

Execute command2 only if command1 fails (OR)

> command1 **||** command2

Success is defined as returning an [%ERRORLEVEL%](errorlevel.html) = 0

Care must be taken in using this syntax to read and SET variables as by default variables are expanded [one line at a time](syntax-variables.html).

### Examples

Show a message if a file copy succeeds:

    COPY H:\share\TNSnames.ora C:\Oracle\ **&&** ECHO The Copy succeeded

Use conditional execution to test the success of several commands:

  Dir C:\Test1 && Dir C:\Test2 || Echo One or more of the commands failed.

Note that in the above example, if the first DIR fails then the second will not be run at all.

“Conditional cooperation is like adulterated cement which does not bind” ~ Mohandas K. Gandhi

### Related commands

[IF](if.html) - Conditionally perform a command.  
How-to: [Command redirection](syntax-redirection.html)



/. nt/syntax-loops.html
========================================================

    Loops (batch file) - Windows CMD - SS64.com

How-to: Use Loops and subroutines in a batch file.
==================================================

There are 2 ways to conditionally process commands in a batch file.  
  
[IF](if.html) xxx ELSE yyy - will conditionally perform a command (or a set of commands)  
  
[FOR](for.html) aaa **DO** xxx - will conditionally perform a command several times (for a set of data, or a set of files)  
  
Either of these can be combined with the [CALL](call.html) command to run a subroutine like this:

    @echo off
    IF EXIST C:\pagefile.sys **CALL** :s_page_on_c
    IF EXIST D:\pagefile.sys **CALL** :s_page_on_d
    GOTO :eof
  
    :s_page_on_c
    echo pagefile found on C: drive
    GOTO :eof
 
    :s_page_on_d
    echo pagefile found on D: drive

Without the **:** a second batch file will be called ...

    @ECHO off
    IF EXIST C:\pagefile.sys **CALL** Second_Batch.cmd

If the code does not need to return then use the [GOTO](goto.html) statement like this:

    @ECHO off
    IF EXIST C:\pagefile.sys **GOTO** s_page_on_c 
    ECHO pagefile not found
    GOTO :eof
   
    :s_page_on_c
    ECHO pagefile found

To call a second batch file in a separate shell use [CMD](cmd.html) An important difference between CALL and CMD is the exit behaviour if an error occurs.

    @ECHO off
    IF EXIST C:\pagefile.sys **CMD /C** Second_Batch.cmd

"I knew of one little DO loop that ran for 48 hours, cost $14,000 and did nothing" ~ Richard Keeler

### Related commands

How-to: [Parameters](syntax-args.html) - Command Line Parameters %1 %~f1  
How-to: [Functions](syntax-functions.html) - How to package blocks of code.



/. nt/syntax-macros.html
========================================================

    Batch file macros | cmd - Windows CMD - SS64.com

How-to: Create Batch file macros
================================

A macro allows you to embed blocks of code in a variable. Like calling a [subroutine](call.html) or [function](syntax-functions.html) this allows reusing the same block of code multiple times, the difference is that by placing the code in a variable the performance will be much faster.

This is an advanced technique but can be very useful in scripts that include large blocks of code or looping commands where the performance of other methods is too slow.

A macro which runs [exit /b](exit.html)

set _ex=exit /b

You can then exit a subroutine with:

%_ex%

A macro which lists all the .XLS files in a folder:

Set _macro=Dir c:\demo*.xls

We can now run the Macro like this:  

%_macro%

So far so like the [DOSKEY](doskey.html) command, but to make this more powerful you will want to pass arguments to the macro, in the example above you might want to pass the name of the folder/file to be listed.

We can use a placeholder character, (in this case #) and then use [variable String Substitution](syntax-replace.html) to swap that out at runtime:

SET _macroDir=Dir # /s

We can now run the Macro to get a file listing including subdirectories like this:  

%_macroDir:#=c:\demo*.xlsx%
  
%_macroDir:#=c:\work*.txt%

Another example which counts numbers:

SET "_macroCount=FOR /L %%G in (1, 1, #) DO (Echo %%G)"  

Calling that macro and passing 3

%_macroCount:#=3%  

Will output:

1
2
3

Passing multiple arguments to a macro is a little more complex, the method discovered by [Jeb](https://www.dostips.com/forum/viewtopic.php?f=3&t=2518), is to place a [For /L](for_l.html) command within the macro, set to run 2 steps each time the macro is run:

*   In the first step the arguments are stored in a variable (argv)
*   In the second step the main body of the macro runs and can (optionally) read the variable

The basic structure of the macro definition:  

Set _macro=For /l %%n in (1 1 2) do if %%n==2 (Echo Main MACRO goes here.) else setlocal enableDelayedExpansion ^& Set argv=, 

%_macro% arg1 arg2

 :: The macro will expand to:
 :: for /l %%n in (1 1 2) do if %%n==2 (Echo Main MACRO goes here.) else setlocal enableDelayedExpansion & Set argv=, arg1 arg2

 :: which is equivalent to:
 ::    setlocal enableDelayedExpansion
 ::    Set argv= arg1 arg2
 ::    Echo Main MACRO goes here.

**Examples:**  

@echo off
cls
setlocal DisableDelayedExpansion
set LF=^


::Above 2 blank lines are required - do not remove
set ^"\n=^^^%LF%%LF%^%LF%%LF%^^"

set _macrodemo=for /L %%n in (1 1 2) do if %%n==2 **(**%\n%
      for /F "tokens=1 delims=, " %%G in ("!argv!") do (%\n%
         echo _argument1=%%G %\n%
         set "_argument1=!%%~G!"%\n%
         dir !_argument1!***.xls**%\n%
      ) %\n%
**)** ELSE setlocal enableDelayedExpansion ^& set argv=,

set "_testfolder=**c:\demo**"
%_macrodemo% _testfolder

In a macro where more than one argument need to be passed, these will become tokens 2,3,4... in the FOR / F command.

A library of macros can be defined by running a single MACROS.CMD batch file, allowing the library macros to be used in multiple batch files.

Credits: [Ed Dyreen](https://ss64.org/oldforum/profile.php?id=539), [Jeb](https://ss64.org/search.php?author_id=294&sr=posts) and [Dave Benham](https://ss64.org/oldforum/profile.php?id=2650), the original dostips forum threads are [here](https://www.dostips.com/forum/viewtopic.php?f=3&t=1827) (basic concepts) and [here](https://www.dostips.com/forum/viewtopic.php?f=3&t=2518) (macros with parameters).

_“Macro dictionary definition: 1. Large 2. Long 3. Inclusive” ~ from the Greek 'makros'_

### Related commands

How-to: [functions](syntax-functions.html) - How to package blocks of code.  
[CALL](call.html) - Call one batch program/subroutine from another.  
[How the %LF% newline variable hack works](https://stackoverflow.com/questions/6379619/explain-how-dos-batch-newline-variable-hack-works) - StackOverflow.  
[DOSKEY](doskey.html) - Edit command line, recall commands, and create macros.



/. nt/syntax-redirection.html
========================================================

    Command Redirection, Pipes - Windows CMD - SS64.com

How-to: Redirection
===================

> _command_ **>** _filename  
> command_ **>**&_n_  
>  
> 
> Redirect _command_ output to a file  
> Redirect _command_ output to the input of handle _n_  
>  
> 
> _command_ **>>** _filename_  
>  
> 
> APPEND into a file  
>  
> 
> _command_ **<** _filename  
> command_ **<**&_n_  
>  
> 
> [Type](type.html) a text file and pass the text to _command_.  
> Read input from handle _n_ and write it to _command_.  
>  
> 
> _commandA_ **|** _commandB_  
>  
> 
> Pipe the output from _commandA_ into _commandB_  
>  
> 
> _commandA_ **&** _commandB_
> 
> Run _commandA_ and then run _commandB_
> 
> _commandA_ **&&** _commandB_
> 
> Run _commandA_, if it succeeds then run _commandB_
> 
> _commandA_ **||** _commandB_
> 
> Run _commandA_, if it fails then run _commandB_
> 
> _commandA_ **&&** _commandB_ **||** _commandC_
> 
>     If _commandA_ succeeds run _commandB,_ if _commandA_ fails run _commandC_  
>     Note that if _commandB_ fails, that will also trigger running _commandC_.

Success and failure are based on the Exit Code of the _command_.  
In most cases the Exit Code is the same as the [ErrorLevel](errorlevel.html)

For clarity the syntax on this page has spaces before and after the redirection operators, in practice you may want to omit those to avoid additional space characters being added to the output. Echo Demo Text> Demofile.txt  

Numeric handles:  

STDIN  = **0**  Keyboard input
STDOUT = **1**  Text output
STDERR = **2**  Error text output
UNDEFINED = 3-9 (In PowerShell 3.0+ these [are defined](../ps/syntax-redirection.html))

When redirection is performed without specifying a numeric handle, the the default < redirection input operator is zero (0) and the default > redirection output operator is one (1). This means that '>' alone will not redirect error messages.  

    _command_ 2> _filename_       Redirect any error message into a file
    _command_ 2>> _filename_      Append any error message into a file
    (_command_)2> _filename_       Redirect any CMD.exe error into a file
    _command_ > _file_ 2>&1       Redirect errors and output to one file
    _command_ > _file_A 2> _fileB_  Redirect output and errors to separate files

    _command_ 2>&1 >_filename_    This will fail!

Redirect to [NUL](nul.html) (hide errors)

    _command_ 2> nul            Redirect error messages to NUL
    _command_ >nul 2>&1         Redirect error and output to NUL
    _command_ >_filename_ 2> _nul_  Redirect output to file but suppress error
    (_command_)>_filename_ 2> _nul_  Redirect output to file but suppress CMD.exe errors

Any long filenames must be surrounded in "double quotes".  
A CMD error is an error raised by the command processor itself rather than the program/command.  
  
Redirection with > or 2> will overwrite any existing file.  
  
You can also redirect to a printer with > PRN or >LPT1

To prevent the > and < characters from causing redirection, [escape](syntax-esc.html) with a caret: ^> or ^<

Redirection - issues with trailing numbers
------------------------------------------

> Redirecting a string (or variable containing a string) will fail to work properly if there is a single numeral at the end, anything from 0 to 9.  
> e.g. this will fail:  
> Set _demo=abc 5  
> Echo %_demo%>>demofile.txt
> 
> One workaround for this is to add a space before the '>>' but that space will end up in the output.  
> Moving the redirection operator to the front of the line avoids this issue, but is undocumented syntax.
> 
> Set _demo=abc 5  
> >>demofile.txt Echo %_demo%

Create a new file
-----------------

> Create an empty file using the NUL device:
> 
> Type NUL >EmptyFile.txt  
> or  
> Copy NUL EmptyFile.txt

Multiple commands on one line
-----------------------------

> In a batch file the default behaviour is to read and expand variables **one line** at a time, if you use & to run multiple commands on a single line, then any variable changes will not be visible until execution moves to the next line. For example:
> 
>  SET /P _cost="Enter the price: " & ECHO %_cost%
> 
> This behaviour can be changed using [SETLOCAL EnableDelayedExpansion](setlocal.html)  

Redirect multiple lines
-----------------------

> Redirect multiple lines by [bracketing](syntax-brackets.html) a set of commands:
> 
> (
>   Echo sample text1
>   Echo sample text2
> ) **>** c:\logfile.txt

Unicode
-------

> The CMD Shell can redirect ASCII/ANSI (the default) or Unicode (UCS-2 le) but not UTF-8.  
> This can be selected by launching CMD /A or CMD /U
> 
> In Windows 7 and earlier versions of Windows, the redirection operator '>' would strip many Extended [ASCII](../ascii.html) /Unicode characters from the output. Windows 10 no longer does this.

Pipes and CMD.exe
-----------------

> You can redirect and execute a batch file into [CMD.exe](cmd.html) with:
> 
> CMD < sample.cmd
> 
> Surprisingly this will work with any file extension (.txt .xls etc) if the file contains text then CMD will attempt to execute it. No sanity checking is performed.
> 
> When a command is piped into any [external](syntax-internal.html) command/utility ( _command_ | _command_ ) this will instantiate a new CMD.exe instance.  
> e.g.  
> TYPE test.txt | FIND "Smith"
> 
> Is in effect running:
> 
> TYPE test.txt | [cmd](cmd.html).exe /S /D /C FIND "Smith"
> 
> This has a couple of side effects:  
> If the items being piped (the left hand side of the pipe) include any caret [escape](syntax-esc.html#escape) characters ^ they will need to be doubled up so that they survive into the new CMD shell.  
> Any newline ([CR/LF](https://devblogs.microsoft.com/oldnewthing/?p=40193)) characters in the first _command_ will be turned into & operators. (see [StackOverflow](https://stackoverflow.com/questions/8192318#8194279))
> 
> On modern hardware, starting a new CMD shell has no noticable effect on performance.
> 
> For example, this syntax works, but would fail if the second or subsequent (piped) lines were indented with a space:  
> @Echo Off  
> echo abc def |^  
> find "abc" |^  
> find "def"> outfile.txt
> 
> Multi-line single commands with lots of parameters, can be indented as in this example:
> 
> Echo abc def ^  
>   ghi jkl ^  
>   mno pqr

Exit Codes
----------

> If the _filename_ or _command_ is not found then redirection will set an Exit Code of 1

When redirecting the output of DIR to a file, you may notice that the output file (if in the same folder) will be listed with a size of 0 bytes. The command interpreter first creates the empty destination file, then runs the DIR command and finally saves the redirected text into the file.

The maximum number of consecutive pipes is [2042](https://www.dostips.com/forum/viewtopic.php?f=3&t=6442)

### Examples

    DIR **>**MyFileListing.txt
   
    DIR /o:n **>**"Another list of Files.txt"

    DIR C:\ **>**List_of_C.txt **2>**errorlog.txt

    DIR C:\ **>**List_of_C.txt **&** DIR D:\ **>**List_of_D.txt

    ECHO y**|** DEL *.txt

    ECHO Some text **^**<html tag**^**> more text

    COPY nul empty.txt

    MEM /C **>>**MemLog.txt

    Date /T **>>**MemLog.txt

    SORT **<** MyTextFile.txt

    SET _output=%_missing% **2>**nul
   
    FIND /i "Jones" **<** names.txt **>**logfile.txt

    (TYPE logfile.txt >> newfile.txt) 2>nul

_“Stupidity, outrage, vanity, cruelty, iniquity, bad faith, falsehood,  
we fail to see the whole array when it is facing in the same direction as we” ~ Jean Rostand (French Historian)_

### Related commands

conIN$ and conOUT$ behave like stdin and stdout, or 0 and 1 streams but only with internal commands.  
[SORT](sort.html) - Sort input.  
[CMD Syntax](syntax.html)  
[TYPE](type.html) - Display the contents of one or more text files.  
[Command Redirection](https://web.archive.org/web/20171225062127/http://www.microsoft.com:80/resources/documentation/windows/xp/all/proddocs/en-us/redirection.mspx?mfr=true) - Microsoft Help page (archived)  
[Successive redirections explained](https://stackoverflow.com/questions/9878007/how-to-permanently-redirect-standard-error-back-to-the-console-again) (1>&3 ) - Stack Overflow.  
Equivalent PowerShell: [Redirection](../ps/syntax-redirection.html) - Spooling output to a file, piping input.  
Equivalent bash command (Linux): [Redirection](../bash/syntax-redirection.html) - Spooling output to a file, piping input.



/. nt/syntax-services.html
========================================================

     Windows 10 Services - Windows CMD - SS64.com

![Services](services.png) Windows 10 Services
=============================================

A list of the default services in Windows 10 (21H2).

| Service Display Name | Service (Registry Key) | Description | Default Status |
|----------------------|------------------------|-------------|----------------|
| ActiveX Installer (AxInstSV) | [AxInstSV] | UAC validation to control the installation of Active-X controls via the internet. | Manual
| Agent Activation Runtime_????? | [AarSvc_?????] | Chatbot Runtime for activating Conversational agent applications - Clippy returns. | Manual
| AllJoyn Router Service | [AJRouter] | IoT integration. | Manual (Trigger Start)
| App Readiness | [AppReadiness] | Runs at first logon to prepare apps for use. | Manual
| Application Identity | [AppIDSvc] | Verify Application identity, used by AppLocker. | Manual (Trigger Start)
| Application Information | [Appinfo] | Facilitates running applications with additional administrative privileges. If disabled those additional privileges will not be available. | Manual (Trigger Start, Running)
| Application Layer Gateway Service | [ALG] | Enables plugins for the now ancient internet connection sharing. | Manual
| Application Management | [AppMgmt] | Required for Group Policy software management, Not Available in Win 10 home. | Manual
| AppX Deployment Service (AppXSVC) | [AppXSvc] | Windows Store integration. Cannot be disabled. | Manual
| AssignedAccessManager Service | [AssignedAccessManagerSvc] | Kiosk mode, Not Available in Win 10 home. | Manual
| Auto Time Zone Updater | [tzautoupdate] | Automatically set the Time Zone. | Disabled
| AVCTP service | [BthAvctpSvc] | Audio Video Control TP service - Bluetooth / Wireless. | Manual (Trigger Start)
| Background Intelligent Transfer Service | [BITS] | Transfer files. | Manual or Automatic (Delayed Start, Running)
| Background Tasks Infrastructure Service | [BrokerInfrastructure] | Cannot be disabled. | Automatic (Running)
| Base Filtering Engine | [BFE] | Manage Windows Firewall and IPsec policies and implements user mode filtering. Do not disable. | Automatic (Running)
| BitLocker Drive Encryption Service | [BDESVC] | Secure startup and volume encryption. | Manual (Trigger Start)
| Block Level Backup Engine Service | [wbengine] | Used by Windows Backup. | Manual
| Bluetooth Audio Gateway Service | [BTAGService] | Bluetooth Audio - Wireless headsets. | Manual (Trigger Start)
| Bluetooth Support Service | [bthserv] | Discovery of Bluetooth devices. | Manual (Trigger Start)
| Bluetooth User Support Service_????? | [BluetoothUserService_?????] | Bluetooth features. | Manual (Trigger Start)
| BranchCache | [PeerDistSvc] | Used by Windows Update for download sharing on the local subnet. | Manual
| Capability Access Manager Service | [camsvc] | Manage UWP apps. | Manual
| CaptureService_????? | [CaptureService_?????] | Screen Capture Service via the Windows.Grapics.Capture API. | Manual
| Cellular Time | [autotimesvc] | Set the time based on NITZ messages from a mobile network. | Manual
| Certificate Propagation | [CertPropSvc] | Manage certificates for Smart Card login. | Manual (Trigger Start)
| Client License Service (ClipSVC) | [ClipSVC] | Support for Microsoft store, cannot be disabled. | Manual (Trigger Start)
| Clipboard User Service_????? | [cbdhsvc_?????] | Clipboard. | Manual
| CNG Key Isolation | [KeyIso] | Secure long lived keys for cryptographic operations. | Manual (Trigger Start, Running)
| COM+ Event System | [EventSystem] | COM Event notification service, required for COM+ | Manual
| COM+ System Application | [COMSysApp] | Network discovery of systems on local network. | Manual (Trigger Start)
| Connected Devices Platform Service | [CDPSvc] | Connected Devices Platform. | Automatic (Delayed Start, Trigger Start)
| Connected Devices Platform User Service_????? | [CDPUserSvc_?????] | Connected Devices Platform. | Automatic (Running)
| Connected User Experiences and Telemetry | [DiagTrack] | Feedback and Diagnostics. | Automatic (Running)
| ConsentUX_????? | [ConsentUxUserSvc_?????] | Connect and pair WiFi and Bluetooth devices, ConnectUX. | Manual
| Contact Data_????? | [PimIndexMaintenanceSvc_?????] | Indexes contact data for fast contact searching. | Manual
| CoreMessaging | [CoreMessagingRegistrar] | Cannot be disabled. Manages communication between system components. | Automatic (Running)
| Credential Manager | [VaultSvc] | Secure storage and retrieval of credentials. Control Panel: Credential Manager. | Manual
| CredentialEnrollmentManagerUserSvc_????? | [CredentialEnrollmentManagerUserSvc_?????] | Credential Enrolment Manager. | Manual
| Cryptographic Services | [CryptSvc] | Manage root certificates. | Automatic (Running)
| Data Sharing Service | [DsSvc] | Data brokering between applications. | Manual (Trigger Start)
| Data Usage | [DusmSvc] | Network data usage,data limit/metered networks. | Automatic (Running)
| DCOM Server Process Launcher | [DcomLaunch] | Required for COM and DCOM object activation requests. | Automatic (Running)
| Delivery Optimization | [DoSvc] | Content delivery Optimisation. | Automatic (Delayed Start)
| Device Association Service | [DeviceAssociationService] | Pairing between the system and wired or wireless devices. | Manual (Trigger Start)
| Device Install Service | [DeviceInstall] | Recognise new hardware, do not disable. | Manual (Trigger Start)
| Device Management Enrollment Service | [DmEnrollmentSvc] | Device enrolment/management. | Manual
| Device Management Wireless Application Protocol (WAP) Push message Routing Service | [dmwappushservice] | WAP - Sync device sessions. | Manual
| Device Setup Manager | [DsmSvc] | Install device drivers. | Manual (Trigger Start)
| DeviceAssociationBroker_????? | [DeviceAssociationBrokerSvc_?????] | Pair devices. | Manual
| DevicePicker_????? | [DevicePickerUserSvc_?????] | Manage Miracast DLNA and DIAL UI. | Manual
| DevicesFlow_????? | [DevicesFlowUserSvc_?????] | Connect and pair WiFi and Bluetooth devices, ConnectUX/PC settings. | Manual
| DevQuery Background Discovery Broker | [DevQueryBroker] | Enable apps to discover devices with a background task. | Manual (Trigger Start)
| DHCP Client | [Dhcp] | Allocate an IP address to this computer automatically. | Automatic (Running)
| Diagnostic Execution Service | [diagsvc] | Enable troubleshooting support. | Manual (Trigger Start)
| Diagnostic Policy Service | [DPS] | Enable problem detection, troubleshooting and resolution for Windows components. | Automatic (Running)
| Diagnostic Service Host | [WdiServiceHost] | Diagnostics for Local Services. | Manual (Running)
| Diagnostic System Host | [WdiSystemHost] | Diagnostics for the Local System. | Manual
| DialogBlockingService | [DialogBlockingService] | DialogBlockingService | Disabled
| Display Enhancement Service | [DisplayEnhancementService] | Brightness. | Manual (Trigger Start)
| Display Policy Service | [DispBrokerDesktopSvc] | Connection and configuration of local and remote displays. | Automatic (Delayed Start)
| Distributed Link Tracking Client | [TrkWks] | Attempt to maintain valid links between NTFS files across a network. | Automatic (Running)
| Distributed Transaction Coordinator | [MSDTC] | Co-ordinate transactions between resource managers, database, file and message queues. | Manual
| DNS Client | [Dnscache] | Cache DNS queries and register the computername. | Automatic (Trigger Start, Running)
| Downloaded Maps Manager | [MapsBroker] | Windows/Bing maps. | Automatic (Delayed Start)
| Embedded Mode | [embeddedmode] | Activate background applications. | Manual (Trigger Start)
| Encrypting File System (EFS) | [EFS] | Allow storage of encrypted files on NTFS file systems. | Manual (Trigger Start)
| Enterprise App Management Service | [EntAppSvc] | Cannot be disabled. Enterprise Application management. | Manual
| Extensible Authentication Protocol | [Eaphost] | Network Authentication - VPN NAP and Wireless. | Manual
| File History Service | [fhsvc] | Used by Windows Backup. | Manual (Trigger Start)
| Function Discovery Provider Host | [fdPHost] | Network discovery and Web Service discovery. | Manual
| Function Discovery Resource Publication | [FDResPub] | Publish this computer and resources over the network. | Manual (Running)
| GameDVR and Broadcast User Service_????? | [BcastDVRUserService_?????] | Game recordings and Live broadcasts. Cannot be disabled. | Manual (Trigger Start)
| Geolocation Service | [lfsvc] | Manage Geofences - a geographic location with associated events. | Manual (Trigger Start, Running)
| GraphicsPerfSvc | [GraphicsPerfSvc] | Monitor graphics performance. | Manual (Trigger Start)
| Group Policy Client | [gpsvc] | Cannot be disabled. Apply admin settings through group policy. | Automatic (Trigger Start)
| Human Interface Device Service | [hidserv] | Activate and maintain hot buttons on keyboards and other controls. | Manual (Trigger Start)
| HV Host Service | [HvHost] | Hyper-V interface for performance counters. | Manual (Trigger Start)
| Hyper-V Data Exchange Service | [vmickvpexchange] | Hyper-V interface for data exchange. | Manual (Trigger Start)
| Hyper-V Guest Service Interface | [vmicguestinterface] | Hyper-V interface for VM services. | Manual (Trigger Start)
| Hyper-V Guest Shutdown Service | [vmicshutdown] | Hyper-V interface for VM shutdown. | Manual (Trigger Start)
| Hyper-V Heartbeat Service | [vmicheartbeat] | Hyper-V identify frozen VMs. | Manual (Trigger Start)
| Hyper-V PowerShell Direct Service | [vmicvmsession] | Hyper-V interface for PowerShell. | Manual (Trigger Start)
| Hyper-V Remote Desktop Virtualization Service | [vmicrdv] | Hyper-V desktop interface. Not Available in Win 10 home. | Manual (Trigger Start)
| Hyper-V Time Synchronization Service | [vmictimesync] | Hyper-V time sync. | Manual (Trigger Start)
| Hyper-V Volume Shadow Copy Requestor | [vmicvss] | Hyper-V shadow copy/backup. | Manual (Trigger Start)
| IKE and AuthIP IPsec Keying Modules | [IKEEXT] | Internet Key exchange. | Manual (Trigger Start)
| Internet Connection Sharing (ICS) | [SharedAccess] | Provides NAT/name resolution for small office networks. Very rarely needed. | Manual (Trigger Start)
| IP Helper | [iphlpsvc] | IPv6 translation. | Automatic (Running)
| IP Translation Configuration Service | [IpxlatCfgSvc] | IPv6 translation. | Manual (Trigger Start)
| IPsec Policy Agent | [PolicyAgent] | Network level peer authentication. Enforces IPsec policies. | Manual (Trigger Start)
| KtmRm for Distributed Transaction Coordinator | [KtmRm] | Co-ordinates distributed transactions. MSDTC/KTM. | Manual (Trigger Start)
| Language Experience Service | [LxpSvc] | Deployment infrastructure for configuring additional languages. | Manual
| Link-Layer Topology Discovery Mapper | [lltdsvc] | Creates a Network map describing each PC and device. | Manual
| Local Profile Assistant Service | [wlpasvc] | Profile management for local subscriber identity modules. | Manual (Trigger Start)
| Local Session Manager | [LSM] | Cannot be disabled. Manage local user sessions. | Automatic (Running)
| MessagingService_????? | [MessagingService_?????] | Text Messaging. | Manual (Trigger Start)
| Microsoft (R) Diagnostics Hub Standard Collector Service | [diagnosticshub.standardcollector.service] | Collect real-time Event Tracing for Windows (ETW) events. | Manual
| Microsoft Account Sign-in Assistant | [wlidsvc] | Running if using MS account to log in to computer. | Manual (Trigger Start)
| Microsoft App-V Client | [AppVClient] | Manage App-V users and virtual applications. Not Available in Win 10 home. | Disabled
| Microsoft iSCSI Initiator Service | [MSiSCSI] | Manage iSCSI devices. | Manual
| Microsoft Keyboard Filter | [MsKeyboardFilter] | Control keystroke filtering and mapping. | Not Installed (Disabled)
| Microsoft Passport | [NgcSvc] | Process isolation for cryptographic keys. Cannot be disabled. | Manual (Trigger Start)
| Microsoft Passport Container | [NgcCtnrSvc] | Manage Local user identity keys and smartcard access. Cannot be disabled. | Manual (Trigger Start)
| Microsoft Software Shadow Copy Provider | [swprv] | Volume Shadow Copy. Used by Windows Backup. | Manual (Runs at boot, then stops)
| Microsoft Storage Spaces SMP | [smphost] | Manage storage pools with multiple disks (WSS). | Manual
| Microsoft Store Install Service | [InstallService] | Microsoft Store. | Manual
| Microsoft Windows SMS Router Service. | [SmsRouter] | Route messages. | Manual (Trigger Start)
| Natural Authentication | [NaturalAuthentication] | Signal aggregator service for automatic device lock/unlock. | Manual (Trigger Start)
| Net.Msmq/Net.Pipe/Net.Tcp Listener Adapter | NetMsmqActivator/NetPipeActivator/NetTcpActivator|  | Not installed
| Net.Tcp Port Sharing Service |   | Provides ability to share TCP ports over net.tcp | Disabled
| Netlogon | [Netlogon] | Connect to a domain controller. | Manual
| Network Connected Devices Auto-Setup | [NcdAutoSetup] | Discover and install qualified devices. | Manual (Trigger Start, Running)
| Network Connection Broker | [NcbService] | Broker connections between Windows store apps and the internet. | Manual (Trigger Start, Running)
| Network Connections | [Netman] | Manage network and Dial-up connections. | Manual
| Network Connectivity Assistant | [NcaSvc] | DirectAccess status notification. | Manual (Trigger Start)
| Network List Service | [netprofm] | Identify networks. | Manual (Running)
| Network Location Awareness | [NlaSvc] | Notify changes in the network configuration. | Automatic (Running)
| Network Setup Service | [NetSetupSvc] | Manage installation and configuration of network drivers. | Manual (Trigger Start)
| Network Store Interface Service | [nsi] | Network notifications for user mode clients. | Automatic (Running)
| Offline Files | [CscService] | Perform offline maintenance on the offline files cache. Not Available in Win 10 home. | Manual (Trigger Start)
| OpenSSH Authentication Agent | [ssh-agent] | Agent to hold private keys used for public key authentication. | Manual
| Optimize drives | [defragsvc] | Optimise file storage by defragmenting on disc. | Manual
| Parental Controls | [WpcMonSvc] | Enforces parental controls in Windows. | Manual
| Payments and NFC/SE Manager | [SEMgrSvc] | Manage payments and Near Field Communication (NFC) based secure elements. | Manual (Trigger Start)
| Peer Name Resolution Protocol | [PNRPsvc] | Enable serverless peer name resolution over the internet (Remote Assistance). | Manual
| Peer Networking Grouping | [p2psvc] | Enables multi-party communication using peer-peer grouping. (Home Group). | Manual
| Peer Networking Identity Manager | [p2pimsvc] | Identity services for peer Name resolution and peer-peer grouping services. | Manual
| Performance Counter DLL Host | [PerfHost] | Enable remote users and 64 bit processes to query perf counters provided by 32-bit DLLs. | Manual
| Performance Logs & Alerts | [pla] | Collect performance data from local or remote computers. | Manual
| Phone Service | [PhoneSvc] | Manage the telephony state. | Manual (Trigger Start)
| Plug and Play | [PlugPlay] | Recognise new hardware. Do not disable. | Manual (Running)
| PNRP Machine Name Publication Service | [PNRPAutoReg] | Publish a machine name using Peer name resolution protocol. | Manual
| Portable Device Enumerator Service | [WPDBusEnum] | Enforce group policy for removable mass storage devices. Enables transferring and synchronising content. | Manual (Trigger Start)
| Power | [Power] | Manage power policy and power policy notifications. | Automatic (Running)
| Print Spooler | [Spooler] | Spool print jobs. Do not disable. | Automatic (Running)
| Printer Extensions and Notifications | [PrintNotify] | Open custom printer dialogue boxes and handle notifications from a remote print server or printer. | Manual
| PrintWorkflow_????? | [PrintWorkflowUserSvc_?????] | Print Workflow. Cannot be disabled. | Manual
| Problem Reports and Solutions Control Panel Support | [wercplsupport] | System level problem reports. | Manual
| Program Compatibility Assistant Service | [PcaSvc] | Program Compatibility Assistant (PCA) | Automatic (Running)
| Quality Windows Audio Video Experience | [QWAVE] | Platform for A/V streaming applications on IP home networks. | Manual
| Radio Management Service | [RmSvc] | Radio Management and Airplane Mode - wireless comms / Bluetooth. | Manual
| Recommended Troubleshooting Service | [TroubleshootingSvc] | Automatic mitigation for known problems and recommended troubleshooting options. | Manual
| Remote Access Auto Connection Manager | [RasAuto] | Automatically connect to a remote network whenever a DNS name is used. | Manual
| Remote Access Connection Manager | [RasMan] | Manage Dial-Up and VPM connections. | Manual
| Remote Desktop Configuration | [SessionEnv] | Remote Desktop related activities, temporary folders,themes and certificates. | Manual
| Remote Desktop Services | [TermService] | Allow users to connect interactively with a remote computer. To prevent remote use of this computer clear the checkboxes on the Remote tab of the system properties control panel item. | Manual
| Remote Desktop Services UserMode Port Redirector | [UmRdpService] | Allow redirection of Printers/Drivers/Ports for RDP connections. | Manual
| Remote Procedure Call (RPC) | [RpcSs] | Object activation for COM and DCOM. Cannot be disabled. | Automatic (Running)
| Remote Procedure Call (RPC) Locator | [RpcLocator] | No functionality in Windows 10, this is provided for Application Compatibility. | Manual
| Remote Registry | [RemoteRegistry] | Enable remote users to modify the registry on this computer. | Disabled
| Retail Demo Service | [RetailDemo] | Allows running the Retail Demo mode which will erase all files and restore Windows to a factory default. You may prefer to disable this. | **Manual**
| Routing and Remote Access | [RemoteAccess] | LAN and WAN routing to other businesses. | Disabled
| RPC Endpoint Mapper | [RpcEptMapper] | Resolve RPC interface identifiers to a transport endpoint. Cannot be disabled. | Automatic (Running)
| Runtime Broker | [RuntimeBroker] | Microsoft core process, manages permissions for all universal (Windows Store) apps. | Automatic (Running)
| Secondary Logon | [seclogon] | Enable starting processes under alternate credentials. | Manual
| Secure Socket Tunneling Protocol Service | [SstpSvc] | SSTP VPN Capability. | Manual
| Security Accounts Manager | [SamSs] | Allows SAM to accept request from other services. | Automatic (Running)
| Security Center | [wscsvc] | Monitor and report security health settings: Firewall, Anti-Virus,Anti-Spyware. | Automatic (Delayed Start, Running)
| Sensor Data Service | [SensorDataService] | Delivers data from a variety of sensors. | Manual (Trigger Start)
| Sensor Monitoring Service | [SensrSvc] | Monitor sensors to expose data and user state e.g. Adjust brightness. | Manual (Trigger Start)
| Sensor Service | [SensorService] | Manage Simple Device Orientation (SDO) and History for sensors. Reports device orientation changes. | Manual (Trigger Start)
| Server | [LanmanServer] | File, Print and named pipe sharing over the network. | Automatic (Running)
| Shared PC Account Manager | [shpamsvc] | Manage profiles and accounts on a SharedPC configured device. | Disabled
| Shell Hardware Detection | [ShellHWDetection] | Autoplay notification. | Automatic (Running)
| Smart Card | [SCardSvr] | Support for Smart Card login/logout. | Disabled
| Smart Card Device Enumeration Service | [ScDeviceEnum] | Support for Smart Card login/logout. | Manual (Trigger Start)
| Smart Card Removal Policy | [SCPolicySvc] | Support for Smart Card login/logout. | Manual
| SNMP Trap | [SNMPTRAP] | Handle Simple Network Management Protocol (SNMP) agent messages. | Manual
| Software Protection | [sppsvc] | Download and install Digital Licences. Cannot be disabled. | Automatic (Delayed Start,Trigger Start)
| Spatial Data Service | [SharedRealitySvc] | Virtual Reality data manager. | Manual
| Spot Verifier | [svsvc] | Verify potential file system corruptions. | Manual (Trigger Start)
| SSDP Discovery | [SSDPSRV] | Discover UPnP /SSDP devices. Enables SSDP device discovery. Can be disabled. | Manual (Running)
| State Repository Service | [StateRepository] | Reports Application State. Cannot be disabled. | Manual (Running)
| Still Image Acquisition Events | [WiaRpc] | Launch applications associated with still image acquisition. | Manual
| Storage Service | [StorSvc] | Adds 'System Volume Information' folder to external USB memory devices. Required for Windows Store. | Manual (Trigger Start)
| Storage Tiers Management | [TieringEngineService] | Optimise the placement of data in storage tiers on all tiered storage spaces. | Manual
| Sync Host_????? | [OneSyncSvc_?????] | Sync mail, contacts calendar and other user data. | Automatic (Delayed Start)
| SysMain | [SysMain] | Tune system performance over time. | Automatic (Running)
| System Event Notification Service | [SENS] | Monitor system events and notify COM+ subscribers. | Automatic (Running)
| System Events Broker | [SystemEventsBroker] | Co-ordinates background work for WinRT. Cannot be disabled. | Automatic (Trigger Start, Running)
| System Guard Runtime Monitor Broker | [SgrmBroker] | Attests to Windows platform integrity. | Automatic (Delayed Start, Running)
| Task Scheduler | [Schedule] | Schedule Automated Tasks. Cannot be Stopped or disabled. | Automatic (Running)
| TCP/IP NetBIOS Helper | [lmhosts] | Provides NetBIOS over TCP/IP (NetBT) Enables sharing Files, Printers and logon to the network. | Manual (Trigger Start, Running)
| Telephony | [TapiSrv] | Support for programs that control telephony devices. | Manual
| Themes | [Themes] | User Theme Management. | Automatic (Running)
| Time Broker | [TimeBrokerSvc] | Background work for WinRT application. | Manual (Trigger Start, Running)
| Touch Keyboard and Handwriting Panel Service | [TabletInputService] | Enables touch keyboard and handwriting panel pan and ink functionality. | Manual (Trigger Start)
| Update Orchestrator Service | [UsoSvc] | Manages Windows Updates. | Manual (Running)
| UPnP Device Host | [upnphost] | Allows UPnP devices to be hosted on this computer. | Manual
| User Data Access_????? | [UserDataSvc_?????] | Provides apps access to structured user data, including contact info, calendars, messages. Cannot be disabled. | Manual (Running)
| User Data Storage_????? | [UnistoreSvc_?????] | Handles storage of structured user data, including contact info, calendars, messages.Cannot be disabled. | Manual (Running)
| User Experience Virtualization Service | [UevAgentService] | Support for the roaming of OS and application settings. Not Available in Win 10 home. | Disabled
| User Manager | [UserManager] | Support for Multi-User interaction. | Automatic (Trigger Start, Running)
| User Profile Service | [ProfSvc] | Loading and unloading of user profiles. | Automatic (Running)
| Virtual Disk | [vds] | Magagement of disks and volumes. | Manual
| Volume Shadow Copy | [VSS] | Manages and implements Volume Shadow copies used for backup and other purposes. | Manual
| Volumetric Audio Compositor Service | [VacSvc] | Hosts spacial analysis for mixed reality audio simulation. | Not Installed
| WalletService | [WalletService] | Objects used by clients of the wallet. | Manual
| WarpJITSvc | [WarpJITSvc] | JIT out of process service for Windows Advanced Rasterization Platform (WARP) when running with Arbitrary Code Guard (ACG) enabled. | Manual (Trigger Start)
| Web Account Manager | [TokenBroker] | Provide single sign on to apps and services. | Manual (Running)
| WebClient | [WebClient] | Enable Windows based programs to create access and modify internet based files. | Manual (Trigger Start)
| Wi-Fi Direct Services Connection Manager Service | [WFDSConMgrSvc] | Connect to wireless display and/or dock. | Manual (Trigger Start)
| Windows Audio | [Audiosrv] | Manage Audio. | Automatic (Running)
| Windows Audio Endpoint Builder | [AudioEndpointBuilder] | Manage Audio devices. | Automatic (Running)
| Windows Backup | [SDRSVC] | Windows Backup. | Manual
| Windows Biometric Service | [WbioSrvc] | Capture and edit biometric data without gaining direct access to any biometric hardware or samples. | Manual (Trigger Start)
| Windows Camera Frame Server | [FrameServer] | Access video frames from camera devices. | Manual (Trigger Start)
| Windows Connect Now - Config Registrar | [wcncsvc] | Wireless Protected Setup (WPS) protocol. | Manual
| Windows Connection Manager | [Wcmsvc] | Makes automatic connect/disconnect decisions based on the network connectivity options currently available to the PC. | Automatic (Trigger Start, Running)
| Windows Defender Advanced Threat Protection Service | [Sense] | Security event monitor. Not Available in Win 10 home | Manual
| Windows Defender Antivirus Network Inspection Service | [WdNisSvc] | Anti-Virus Cannot be disabled. | Manual (Running)
| Windows Defender Antivirus Service | [WinDefend] | Malware detection. Cannot be disabled. | Automatic (Running)
| Windows Defender Firewall | [mpssvc] | Firewall. Cannot be disabled. | Automatic (Running)
| Windows Encryption Provider Host Service | [WEPHOSTSVC] | Exchange Active Sync (EAS) policies for Email encryption with 3rd parties. | Manual (Trigger Start)
| Windows Error Reporting Service | [WerSvc] | Allows errors to be reported. | Manual (Trigger Start)
| Windows Event Collector | [Wecsvc] | Remote event log management. | Manual
| Windows Event Log | [EventLog] | Manage and query event logs. | Automatic (Running)
| Windows Font Cache Service | [FontCache] | Cache font data. | Automatic (Running)
| Windows Image Acquisition (WIA) | [stisvc] | Image acquisition for scanners and cameras. | Manual
| Windows Insider Service | [wisvc] | Used only for Windows insider - beta testing of new versions of Windows. | Manual (Trigger Start)
| Windows Installer | [msiserver] | Install applications from an .MSI or .MSP package. Cannot be disabled. | Manual
| Windows License Manager Service | [LicenseManager] | Windows Store. | Manual (Trigger Start)
| Windows Management Instrumentation | [Winmgmt] | Windows Management Instrumentation (WMI). | Automatic (Running)
| Windows Management Service | [WManSvc] | Provisioning and enrolment services. | Manual
| Windows Media Player Network Sharing Service | [WMPNetworkSvc] | Share Windows Media Player libraries with other devices using PnP. | Disabled
| Windows Mixed Reality OpenXR Service | [MixedRealityOpenXRSvc] | Enable Mixed reality OpenXR runtime. | Manual
| Windows Mobile Hotspot Service | [icssvc] | Share a Mobile Data Connection with another device. | Manual (Trigger Start)
| Windows Modules Installer | [TrustedInstaller] | Windows Update, installer service. | Manual
| Windows Perception Service | [spectrum] | Virtual Reality Service. | Manual (Trigger Start)
| Windows Perception Simulation Service | [perceptionsimulation] | Enables spatial perception simulation - camera and spatial input simulation. | Manual
| Windows Presentation Foundation Font Cache 3.0.0.0 | [FontCache3.0.0.0] | Optimise the performance of WPF applications by caching commonly used files. | Not Installed (Manual)
| Windows Push Notifications System Service | [WpnService] | Push Notifications. | Automatic (Running)
| Windows Push Notifications User Service_????? | [WpnUserService_?????] | Local and push notifications: tile, toast and raw. | Automatic (Running)
| Windows PushToInstall Service | [PushToInstall] | Windows Store. | Manual
| Windows Remote Management (WS-Management) | [WinRM] | Remote Management. | Manual
| Windows Search | [WSearch] | Search content indexing. | Automatic (Delayed Start, Running)
| Windows Security Service | [SecurityHealthService] | Device protection. | Manual
| Windows Time | [W32Time] | Date and Time Synchronisation. | Manual (Trigger Start)
| Windows Update | [wuauserv] | Windows Update. | Manual (Trigger Start)
| Windows Update Medic Service | [WaaSMedicSvc] | Remediation and protection of Windows Update components. | Manual
| WinHTTP Web Proxy Auto-Discovery Service | [WinHttpAutoProxySvc] | Web Proxy Auto-Discovery over HTTP. | Manual (Running)
| Wired AutoConfig | [dot3svc] | IEEE 802.1 authentication over Ethernet. | Manual
| WLAN AutoConfig | [WlanSvc] | Connect and Disconnect from a Wireless LAN, it is strongly recommended that this service is left set to Automatic if a Wireless Card is installed. | Automatic
| WMI Performance Adapter | [wmiApSrv] | Provide performance information from WMI providers to clients on the network. | Manual
| Work Folders | [workfolderssvc] | Sync files with the Work Folders server enabling you to use the files on any PC where you have setup Work Folders. | Manual
| Workstation | [LanmanWorkstation] | Connect to remote servers using SMB 2.0 or 3.0 | Automatic (Running)
| WWAN AutoConfig | [WwanSvc] | Manages Mobile [Broadband](https://virginmedia-is-evil.com/) Data Connections (GSM and CDMA) by auto-configuring the network. | Manual
| Xbox Accessory Management Service | [XboxGipSvc] | Xbox Accessories. | Manual (Trigger Start)
| Xbox Live Auth Manager | [XblAuthManager] | Xbox Authentication. | Manual
| Xbox Live Game Save | [XblGameSave] | Xbox sync with game server. | Manual (Trigger Start)
| Xbox Live Networking Service | [XboxNetApiSvc] | Xbox API. | Manual

The links above will open a Google search for the service name targeted at Microsoft.com, this will often find a more detailed description of what the service does.

Per-User Services
-----------------

> Some of the services listed above are _per-user_ services, indicated by ????? at the end of the service name, this represents a locally unique identifier (LUID), a 4 to 7 digit string thats unique to each user of the computer.
> 
> Per-user services are created when a user signs into Windows and are stopped and deleted when that user signs out.

Svchost.exe
-----------

> Svchost.exe is a generic host process name for services that run from dynamic-link libraries.
> 
> Many Windows services run from a .DLL file rather than a .EXE which can be launched directly. Svchost.exe is a reusable shell used to launch a DLL file and startup the relevant service. The task manager in Windows 10 lists these processes under _Service Host: Name of Service_.

Disabling Services
------------------

> It is inadvisable to _disable_ a service without being aware of the consequences, always start by setting the service to _manual,_ reboot and test for any problems.
> 
> A service set to _manual_ will be automatically restarted if another service is dependent on it.  
> A service set to _disabled_ will not restart even if it's required to boot the machine!
> 
> If a service crashes the machine at startup, you can DISABLE it using the [recovery console](syntax-recovery.html).
> 
> Stopping or disabling a service will generally save a small amount of memory and will reduce the number of software interrupts (cpu message queue.) The main reason for tinkering with services is to harden the system against security vulnerabilities. Disable everything that you don’t need or use - then any future problems with those services cannot affect the machine.
> 
> To document all the services currently installed:
> 
> [SC QUERY](sc.html) state= all |findstr "DISPLAY_NAME STATE" >my_services.csv
> 
> Many services communicate and send data directly to Microsoft servers, while this is not generally something to lose sleep over. Managing the running of these services might be a consideration if confidentiality or anonymity is highly important to you.

Remove a service completely
---------------------------

> To delete a service use the [SC DELETE](sc.html) command:  
> SC delete _NameofServiceTodelete_

Built-in Service Accounts
-------------------------

> In addition to other [Default User & Group accounts](syntax-security_groups.html) there are 3 built-in accounts, designed for running background services.
> 
> _Local Service Account_ (NT AUTHORITY\LOCAL SERVICE) - has the same level of access to resources and objects as members of the Users group. This limited access helps safeguard the system if individual services or processes are compromised. Services that run as the Local Service account access network resources as a null session without credentials. (This account is not supported for running SQL Server services.)
> 
> _Network Service Account_ (NT AUTHORITY\NETWORK SERVICE) - has more access to resources and objects than members of the Users group. Services that run as the Network Service account access network resources by using the credentials of the computer account.
> 
> _Local System Account_ (NT AUTHORITY\SYSTEM) - a very high-privileged built-in account. It has extensive privileges on the local system and acts as the computer on the network.
> 
> The security group All Services (NT SERVICES\ALL SERVICES) includes all service processes that are configured on the system. Membership of this group is controlled by the OS.

_Managed Service Accounts_ provide automatic password management and simplified service principal name (SPN) management.  
(Primarily intended for IIS). Managed Service accounts are created in PowerShell with [New-ADServiceAccount](../ps/new-adserviceaccount.html)

Files:  
windows\system32\drivers\etc\services

“The service we render to others is really the rent we pay for our room on this earth. It is obvious that man is himself a traveler; that the purpose of this world is not 'to have and to hold' but ’to give and serve.' There can be no other meaning” - Sir Wilfred T. Grenfell

### Related commands

[SC](sc.html) - Service Control.  
[TASKLIST](tasklist.html) - List running tasks and services.  
[MSINFO32](msinfo32.html) - Windows System Information.  
[PORTQRY](portqry.html) - Enumerate local services, SQL Server instances, Local ports, and the DLL modules loaded.  
How-to: [ServiceStatus.ps1](../ps/syntax-servicestatus.html) - List all services (PowerShell).  
Safe Mode - Press **F8** during bootup to start with minimal services running.  
[WMIC SERVICE](wmic.html) - WMI access to services.  
[DComCnfg](https://web.archive.org/web/20140105064501/https://support.microsoft.com/kb/176799/EN-US/) - Disable/configure Component Services.  
[Revert Service Defaults](http://revertservice.com/) - List of default Services.  
[Q137890](https://support.microsoft.com/en-us/help/137890/) - SRVANY - create an NT Service from any executable. Not supported on current OS's use a [Scheduled Task](../ps/scheduler.html) instead.



/. nt/syntax-brackets.html
========================================================

    Parenthesis/Brackets - Windows CMD - SS64.com

How-to: Use parentheses/brackets to group expressions in a Windows batch file.
==============================================================================

Parenthesis can be used to split commands across multiple lines. This can make code more readable.  
Variables will be evaluated for the code block just as if the command was a single line.

Parenthesis are most commonly used for the _command_ action in a [FOR](for.html) loop or an [IF](if.html) conditional.

      (command)

      (
       command
       command )

Example  

    IF EXIST C:\pagefile.sys **(**
        ECHO pagefile found on C: drive**)**

If the command will fit on a single line, then the parentheses can be omitted e.g.  
  
IF EXIST data.xls Echo The file was found.

vs

IF EXIST data.xls **(**
    Echo The file was  found.
**)**

Using variables within parentheses
----------------------------------

> The CMD shell will expand [read into memory] all the [variables](syntax-variables.html) at the beginning of a code block and use those values even if the variable’s value is changed within the code block. Turning on [DelayedExpansion](delayedexpansion.html) will force the shell to read variables at the start of every line.
> 
> Code blocks can be used to expand variables in places where they would not otherwise be accepted such as the "tokens" parameter of the [FOR](for.html) command:
> 
> @echo off
> set tknz="tokens=1-2"
> **(**
>    for /f %tknz% %%A in ('echo') do (
>      echo %%B
>      echo %%A
>    )
> **)**

Things that break inside parentheses
------------------------------------

> The CMD shell does not use any great intelligence when evaluating parentheses, so for example the command below will fail:
> 
> > IF EXIST MyFile.txt **(**ECHO Some(more**)**Potatoes)
> > 
> > This version will work:
> > 
> > IF EXIST MyFile.txt **(**ECHO Some[more]Potatoes**)**
> > 
> > You could also [escape](syntax-esc.html) the extra parenthesis like **(**ECHO Some^(more^)Potatoes**)**  
> > Or use quotes; though they will appear in the output **(**ECHO "Some(more)Potatoes"**)**
> > 
> > Although parenthesis are legal in NTFS pathnames, they are often misinterpreted.
> 
> Chaining to a second batch file (without using [CALL](call.html)) will normally exit the first batch file completely, but if you do this from a code block within parentheses then execution will return to the first batch file and continue where it left off.
> 
> This action appears to be very similar to just using CALL, but in some cases; particularly using parentheses within the DO section of a FOR loop; the behaviour becomes buggy. A recommended coding style is to always explicitly use CALL when running a second batch file.
> 
> The CMD shell will read the entire content of a code block in parentheses into memory at once. That code will always be executed unless you break out of the block by executing a goto :_label_ or goto :eof  
> 
> A [GOTO](goto.html) command inside a bracketed code block will break the parentheses context and may cause errors. For example within a For-Do Loop, a GOTO command will exit the entire loop not just the current iteration.
> 
> The interpretation of [comments](rem.html)/Labels within a code block is problematic, so put all comments outside the parentheses.

Testing Numeric values
----------------------

> Do not use parentheses or quotes if you are comparing numeric values with an [IF](if.html) command.  
> For example  
> IF (2) GEQ (15) echo "bigger"  
> or  
> IF "2" GEQ "15" echo "bigger"  
> Will perform a **character** comparison and will echo "bigger"
> 
> however the commands:  
> IF 2 GEQ 15 echo "bigger"  
> or  
> IF (2 GEQ 15) echo "bigger"  
> Will perform a **numeric** comparison and return the correct result.
> 
> This behaviour is opposite to the [SET](set.html) /a command where quotes _are_ required.

The maximum number of nested expressions in parentheses is [256](https://www.dostips.com/forum/viewtopic.php?f=3&t=6438) (more will cause a buffer overrun).

_“Yes, we are the richest major nation. But because so much of our national income is concentrated in relatively few hands, large numbers of Americans are worse off economically than their counterparts in other advanced countries” - [Paul Krugman](https://www.nytimes.com/2002/10/20/magazine/for-richer.html)_

### Related commands

[DelayedExpansion](delayedexpansion.html) - Force the shell to read variables at the start of every line.  
[IF](if.html) - conditional command, also IF...[ELSE](else.html).



/. nt/delayedexpansion.html
========================================================

    EnableDelayedExpansion - Windows CMD - SS64.com

EnableDelayedExpansion
======================

Delayed Expansion will cause variables within a batch file to be expanded at execution time rather than at parse time, this option is turned on with the [SETLOCAL](setlocal.html) EnableDelayedExpansion command.

Variable expansion means replacing a variable (e.g. %windir%) with its value C:\WINDOWS

*   By default expansion will happen just once, as each **line** is parsed and executed.  
    In this case, a "line" includes bracketed expressions even if they are formatted to run over several lines.  
      
    
*   Parse-time expansion also applies to the [%errorlevel%](errorlevel.html) variable, so within a bracketed expression any change to the %errorlevel% will only be visible after the brackets have been closed.  
      
    
*   When !delayed! expansion is turned on, the variables will be expanded each time the line is executed, or for each loop in a FOR looping command.

With loop commands like FOR, [compound](syntax-redirection.html) or bracketed expressions, Delayed Expansion will allow you to always **read** the current value of the variable.

You can **write** new variable values with or without Delayed Expansion.

Without delayed expansion you can swap the value of two variables in one line:  
Set "var1=%var2%" & set "var2=%var1%"

When Delayed Expansion is in effect, variables can be immediately read using !variable_name!  
You can set two variables to the same thing in one line:  
Set "var3=April" & set "var4=!var3!"  
you can still read and use %variable_name% and that will continue to show the initial value (expanded at the beginning of the line).

An alternative to enabling delayed expansion, is to avoid using brackets to group commands and instead [call](call.html) or [goto](goto.html) a separate subroutine, see the example below.

### Examples

Save this as a batch file e.g. demo.cmd and then execute (demo) to see the result:

@echo off  
SETLOCAL  
Set "_var=first"  
Set "_var=second" **& Echo %_var%**  
  
This will output: first  
The value of %_var% was read into memory BEFORE the Set command which changes it.

Now repeating this with Delayed Expansion:

@echo off  
SETLOCAL **EnableDelayedExpansion**  
Set "_var=first"  
Set "_var=second" **& Echo %_var% !_var!**

This will output: first second  
The value of the !_var! variable is evaluated as late as possible while the %_var% variable works just as before.

FOR Loops
---------

> Delayed variable expansion is often useful when working with FOR Loops, normally an entire FOR loop is evaluated as a single command even if it spans multiple lines of a batch script.  
> This is the default behaviour of a FOR loop:
> 
> @echo off
> setlocal
> :: count to 5 storing the results in a variable
> set _tst=0
> FOR /l %%G in (1,1,5) Do (echo [**%_tst%**] & set /a _tst+=1)
> echo Total = %_tst%
> 
> C:> demo_batch.cmd
> [0]
> [0]
> [0]
> [0]
> [0]
> Total = 5
> 
> Notice that when the FOR loop finishes we get the correct total, so the variable correctly increments, but during each iteration of the loop the variable will stubbornly display it's initial value of 0 even as we set new values.
> 
> The same script with **EnableDelayedExpansion**, gives the same final result but also displays the intermediate values:
> 
> @echo off
> setlocal EnableDelayedExpansion 
> :: count to 5 storing the results in a variable
> set _tst=0
> FOR /l %%G in (1,1,5) Do (echo [**!_tst!**] & set /a _tst+=1)
> echo Total = %_tst%
> 
> C:> demo_batch.cmd
> [0]
> [1]
> [2]
> [3]
> [4]
> Total = 5
> 
> Notice that within the for loop we use !variable! instead of %variable%.
> 
> An alternative way to write this is by calling a subroutine, because this breaks out of the loop it does not need Delayed Expansion
> 
> @echo off
> setlocal
> :: count to 5 storing the results in a variable
> set _tst=0
> FOR /l %%G in (1,1,5) Do (**call :sub %%G**)
> echo Total = %_tst%
> goto :eof
> 
> :sub
> echo [%1] & set /a _tst+=1
> goto :eof
> 
> C:> demo_batch.cmd
> [1]
> [2]
> [3]
> [4]
> [5]
> Total = 5

Using %var% and !var!
---------------------

> With delayed expansion a single variable can hold two values:
> 
> @echo off
> Setlocal **EnableDelayedExpansion**
> Set "_var=Old"
> [For /L](for_l.html) %%G in (1,1,3) Do (
>   Set "_var=New"
>   Echo [%_var%] is now [!_var!]
> )
> 
> Will output:
> 
> [Old] is now [New]  
> [Old] is now [New]  
> [Old] is now [New]
> 
> Notice that the variable reverts to the old value in each iteration of the loop, there is no need for Set _var=%_var%  
> This is because each iteration of the FOR loop will launch a new batch file context along with any specified parameters.

Other effects - Punctuation  

------------------------------

> Because DelayedExpansion expands variables later, that means that any [escape characters](syntax-esc.html) (^) and [redirection characters](syntax-redirection.html) in your expressions will be evaluated before the variable expansion and this can be very useful:
> 
> @echo off
> Setlocal
> Set _html=Hello^>World
> Echo %_html%
> 
> In the above, the Echo command will create a text file called 'world' - not quite what we wanted! This is because the variable is expanded at parse time, so the last line is executing Echo Hello > World and the > character is interpreted as a redirection operator.
> 
> If we now try the same thing with EnableDelayedExpansion:
> 
> Setlocal EnableDelayedExpansion  
> Set _html=Hello^>World  
> Echo !_html!
> 
> With delayed expansion, the variable (including the > ) is only expanded at execution time so the > character is never interpreted as a redirection operator.  
> This makes it possible to work with HTML and XML formatted strings in a variable.
> 
> When delayed expansion is enabled AND at least one exclamation mark in a line is present, then any carets will be interpreted as an escape and so will disappear from the output:
> 
> Setlocal EnableDelayedExpansion  
> Echo "Hello^World"  
> Echo "Hello^World**!**"
> 
> The above will output:
> 
> "Hello^World"  
> "HelloWorld"  
> 
> Even if you double the carets ^^, which normally would act as an escape, or add an escape just before the exclamation mark, the presence of an exclamation mark anywhere in the line will still have this effect.

More Examples
-------------

> Set and then Echo the same variable within a FOR command:
> 
> Setlocal EnableDelayedExpansion  
> for /f %%G in ("abc") do ( set _demo=%%G & echo !_demo!)  
> 
> [Replace](syntax-replace.html) a variable_name using values from another variable:
> 
> @echo off
> setlocal EnableDelayedExpansion
> Set var1=Hello ABC how are you
> Set var2=ABC
> Set result=!var1:%var2%=Beautiful!
> Echo [!result!]
> 
> Another method for replacing a variable named with the content of another is [CALL SET](call.html#advanced)

Some unexpected behaviours when using delayed variable expansion
----------------------------------------------------------------

> If _DelayedExpansion_ is used in conjunction with a FOR command looping through a set of files, if any file in the set has an exclamation mark '!' in the [filename](syntax-filenames.html), that will be interpreted like a !variable!.  
> Although this is not a common character used in filenames, it can cause scripts to fail. This happens because the parameter expansion (%%P) happens just before the delayed expansion phase tries to interpret my!filen!ame.txt
> 
> When _DelayedExpansion_ is used inside a _code block_ (one or several commands grouped between parentheses) whose output is [_Piped_](syntax-redirection.html), the [variable expansion will be skipped](https://stackoverflow.com/questions/8192318/why-does-delayed-expansion-fail-when-inside-a-piped-block-of-code).  
> When you use a pipe, both parts of the pipe will be executed in a new cmd.exe instance and these instances are started by default with disabled delayed expansion.

Why this behaviour?
-------------------

> The SET command was first introduced with MS-DOS 2.0 in March 1983, at that time memory and CPU were very limited and the expansion of variables once per line was enough.  
> Delayed Expansion was introduced some 16 years later in 1999 by which time millions of batch files had been written using the earlier syntax. Retaining immediate expansion as the default preserved backwards compatibility with existing batch files.
> 
> This is not how anyone would design a language if starting from scratch, indeed PowerShell behaves like this:
> 
> PS C:> $demo = "First"  
> PS C:> $demo = "Second" ; echo $demo  
> Second

Default behaviour
-----------------

> EnableDelayedExpansion is Disabled by default.  
> EnableDelayedExpansion can also be enabled by starting [CMD](cmd.html) with the /v switch.
> 
> After being turned on, Delayed Expansion can be turned off again with SETLOCAL DisableDelayedExpansion
> 
> EnableDelayedExpansion can be set as the default in the registry under HKLM or HKCU:
> 
> [HKEY_CURRENT_USER\Software\Microsoft\Command Processor]  
> "DelayedExpansion"= (REG_DWORD)  
> 1=enabled 0=disabled (default)
> 
> Changing this default is not recommended.  
> Unless every batch script you run begins with an appropriate SETLOCAL DisableDelayedExpansion or SETLOCAL EnableDelayedExpansion command, then it is likely that changing the default will break some scripts.

“At times it is folly to hasten at other times, to delay. The wise do everything in its proper time” - Ovid

### Related commands

[Forum discussion](https://ss64.org/viewtopic.php?f=2&t=27) - EnableDelayedExpansion (many thanks to Jeb and Aacini for clarifying quite a few points).  
[OldNewThing](https://devblogs.microsoft.com/oldnewthing/?p=29993) - Longer explanation of EnableDelayedExpansion.  
[SETLOCAL](setlocal.html) - Start localisation of environment changes in a batch file.



/. nt/syntax-esc.html
========================================================

    Quotes, Escape Characters, Delimiters - Windows CMD - SS64.com

How-to: Escape Characters, Delimiters and Quotes at the Windows command line.
=============================================================================

Delimiters
----------

> Delimiters separate one [parameter](syntax-args.html) from the next - they split the command line up into words.
> 
> Parameters are most often separated by spaces, but any of the following are also valid delimiters:
> 
> > Comma (,)  
> > Semicolon (;)  
> > Equals (=)  
> > Space ( )  
> > Tab (    )
> 
> If you are passing a parameter to a batch file that contains any of these delimiter characters, it will split the parameter into two parameters unless you surround the whole thing with double quotes: "this is;one=param,"
> 
> Consecutive delimiters will be treated as one, even if they are different characters.
> 
> Notice that although / and - are commonly used to separate command options, they are absent from the list above. This is because batch file parameters are passed to CMD.exe which can accept it's own parameters (which are invoked using / and - )  
>   
> The default token delimiters in a [FOR](for.html) IN() clause are the same as on the command line but the delims= option is available to specify something different. When [FOR /F](for_f.html) is used to process a string, the default delimters are Space and TAB.
> 
> When using the TAB character as a delimiter be aware that many text editors will insert a TAB as a series of SPACEs.  
>   
> If you use %* to refer to all parameters, the value returned will include the delimiters.

Escape Character
----------------

>   ^  Escape character.
> 
> Adding the escape character before a command symbol allows it to be treated as ordinary text. These characters which normally have a special meaning can be escaped and then treated like regular characters  : & \ < > ^ |
> 
> e.g. Echo THIS ^& THAT
>      Echo Heading1 ^| heading2 ^| heading3
>      Echo The Escape character looks like this ^^

Escape and the pipeline
-----------------------

> When [piping or redirecting](syntax-redirection.html) text, applying an escape character gets a little more complex, a pipe will start two new [cmd.exe](cmd.html) instances, each of these cmd processes are passed one side of the pipe and will parse their part once again (with the cmd-line parser, not with the batch-line-parser).
> 
> Knowing this you might try:  
> Echo THIS ^^& THAT | subroutine  
> So the new cmd instance would be passed THIS ^& THAT and everything would work? Not so fast, with two carets together, the first will escape the second, meaning that the & is no longer escaped at all.
> 
> Echo This ^^^& That | subroutine  
> In this version, the first caret escapes the second caret '^', the third caret escapes the '&' so now the new cmd instance inherits ^&  
> (Many thanks to Jeb who explained this over in the [forum](https://ss64.org/) better than I could.)
> 
> When ECHOing a string with an odd number (or just an unknown number) of embedded quotes through the pipeline, the outer quotes should be escaped:
> 
> ECHO "abc"def" | FIND "def"
> 
> ECHO ^"abc"def^" | FIND "def"

Escaping CR/LF line endings.
----------------------------

> The ^ escape character can be used to make long commands more readable by splitting them into multiple lines and escaping the Carriage Return + Line Feed (CR/LF) at the end of a line:
> 
> ROBOCOPY \FileServ1\e$\users ^
>  \FileServ2\e$\BackupUsers ^
>  /COPYALL /B /SEC /MIR ^
>  /R:0 /W:0 /LOG:MyLogfile.txt /NFL /NDL
> 
> Mark Yocom [MSFT] has more on this technique [here](https://docs.microsoft.com/en-gb/archive/blogs/myocom/making-your-scripts-look-prettier).
> 
> A couple of things to be aware of:
> 
> *   A stray space at the end of a line (after the ^) will break the command, this can be hard to spot unless you have a text editor that displays spaces and tab characters.  
>     
> *   If you want to comment something out with REM, then EVERY line needs to be prefixed with REM.  
>     Alternatively if you use a double colon :: as a [REM comment](rem.html), that will still parse the caret at the end of a line, so in the example above changing the first line to :: ROBOCOPY… will comment out the whole multi-line command.
> 
> Some commands (e.g. REG and FINDSTR) use the standard escape character of \ (as used by C, Python, SQL, bash and many other languages.)  
> The \ escape can cause problems with quoted directory paths that contain a trailing backslash because the closing quote " at the end of the line will be escaped \".
> 
> To save a directory path with a trailing backslash (\) requires adding a second backslash to 'escape the escape'  
> so for example instead of "C:\My Docs\" use "C:\My Docs\"
> 
> To be sure that a path includes a trailing backslash, you can test for it:
> 
> Set _prog=C:\Program Files\SS64 App  
> IF %_prog:~-1% NEQ \ (Set _prog=%_prog%****)  
> Echo "%_prog%"

Escaping Percents
-----------------

> The % character has a special meaning for [command line parameters](syntax-args.html), [variable](syntax-variables.html) names and [FOR](for.html) parameters.  
> To treat a percent as a regular character, double it:
> 
> %%  
>   
> Many characters such as \ = ( ) do not need to be escaped when they are used within a "quoted string" these are characters you might find in a filename/path. The % character is one exception to this rule, it is a valid NTFS filename character but also will be evaluated as a variable name even within a quoted string.
> 
> Escaping Exclamation marks
> --------------------------
> 
> When the shell is running in [EnableDelayedExpansion](delayedexpansion.html) mode the ! character is used to denote a variable and so must be escaped (twice) if you wish to treat it as a regular character:
> 
> ^^!

Escape the Escape character
---------------------------

> The escape character can be used to escape itself ^^ (so the first ^ will escape the second):
> 
> The characters in bold get escaped: 
>     ^**&**  =>   &  
>     ^**^**  =>   ^  
>   "^^"  => "^^"
>   ^**^**^**&**  =>  ^&  
>   ^**^**^**^**  =>  ^^
> ^**^**^**^**^**&**  => ^^&
> 
> This changes slightly if you are running with [DelayedExpansion](delayedexpansion.html) of variables: if any part of the command line includes an '!' then CMD will escape a second time, so ^^^^ will become ^ [[source](https://www.dostips.com/forum/viewtopic.php?p=6188#p6188)] Quoted carets passed to CALL are a [special case](https://ss64.org/viewtopic.php?f=2&t=133).

Special Cases
-------------

> A small number of commands follow slightly different rules, FINDSTR, REG and RUNAS all use \ as an escape character instead of ^

Using "Double Quotes"
---------------------

> If a single parameter contains spaces, you can pass it as one item by surrounding in "quotes" - this works well for long filenames.
> 
> In many places, e.g. the [FIND](find.html) comand, a " quote can be escaped by doubling it to ""  
>   
> If a parameter is used to supply a filename like this:
> 
>     MyBatch.cmd "C:\Program Files\My Data File.txt"
> 
> The parameters will be:
> 
>    %0 =MyBatch  
>    %1 ="C:\Program Files\My Data File.txt"
> 
> To launch a batch script with spaces in the script Path and other parameters, all requiring quotes:
> 
> [CMD](cmd.html) /k **"**"c:\batch files\test.cmd" "Parameter 1 with space" "Parameter2 with space"**"**
> 
> Double quotes in a command line with a backslash escape:
> 
> powershell.exe -command "&{$m = \"hello world\";write-host $m}"
> 
> This can also be written with 3 quotes:
> 
> powershell.exe -command "&{$m = "**"**"hello world"**"**";write-host $m}"
> 
> or more simply with [powershell's single quotes](../ps/syntax-esc.html#quotes):
> 
> powershell.exe -command "&{$m = 'hello world';write-host $m}"
> 
> or for SQL:
> 
> sqlplus.exe user/**\"**"password with spaces"**\"**@service

Removing Quotes
---------------

> Several methods for removing quotes are listed on the [dequote page](syntax-dequote.html).

Working without Quotes
----------------------

> Without surrounding quotes, a long filename will be passed as %1 %2 %3...
> 
>    MyBatch C:\Program Files\My Data File.txt
> 
> To refer to the pathname above use %* rather than %1 %2 %3 - the %* will cover all parameters - even if there are more than %9
> 
> You can apply [Extended Filename](syntax-args.html) syntax to %* by passing the value to a subroutine:

  @ECHO OFF
  SET _params=%*

  :: pass params to a subroutine
  CALL :sub "%_params%" 
  GOTO :eof

  :sub 
  :: Now display just the filename (not path)
  ECHO %~n1

_“All the best stories in the world are but one story in reality - the story of escape. It is the only thing which interests us all and at all times, how to escape” ~ A. C. Benson_

### Related commands

[SETLOCAL EnableDelayedExpansion](delayedexpansion.html) - More examples, particularly for HTML.  
How-to: [Long Filenames and NTFS](syntax-filenames.html) - Valid characters in filenames.  
[FINDSTR Escapes](https://ss64.com/nt/findstr-escapes.html) and Length limits.  
How-to: [Parameters](syntax-args.html) - Command Line Arguments %1 %~f1.  
PowerShell equivalent: [PowerShell Escape Character](../ps/syntax-esc.html)  
In bash use \ to escape a line ending.  
[How does the Windows Command Interpreter (CMD.EXE) parse scripts?](https://stackoverflow.com/questions/4094699/how-does-the-windows-command-interpreter-cmd-exe-parse-scripts?lq=1) - StackOverflow.  
[Why is the DOS path character "\"?](https://web.archive.org/web/20100612035120/http://blogs.msdn.com/b/larryosterman/archive/2005/06/24/432386.aspx) - Larry Osterman



/. nt/set.html
========================================================

    Set - Environment Variable - Windows CMD - SS64.com

SET
===

Display, set, or remove CMD environment variables. Changes made with SET will remain only for the duration of the current CMD session.

Syntax

      SET _variable_
      SET _variable_=_string_
      SET "_variable_=_string_"
      SET "_variable_="

      SET /A _"variable_=_expression_"
      SET /P _variable_=[_promptString_]
      SET "

Key
    _variable_   A new or existing environment variable name e.g. _num
    _string_     A text string to assign to the variable.
    /A         Arithmetic expression see full details [below](#expressions).
    /P         Prompt for user input.

Variable names are not case sensitive but the contents can be.

It is good practice to avoid using any [delimiter](syntax-esc.html#delimiters) characters (spaces, commas etc) in the variable _name_.

Delimiter characters can be used in the _value_ if the complete assignment is surrounded with double quotes to prevent the delimiter being interpreted.

Any extra spaces around either the variable name or the _string_, will **not** be ignored, SET is not forgiving of extra spaces like many other scripting languages. So use SET alpha=beta, not SET alpha = beta

The first character of the name must [not be numeric](syntax-percent.html). It is a common practice to prefix variable names with either an undescore or a dollar sign _variable or $variable, these prefixes are not required but help to prevent any confusion with the standard built-in [Windows Environment variables](syntax-variables.html) or any other other command strings.

The CMD shell will fail to read an environment variable if it contains more than [8,191](https://support.microsoft.com/en-gb/help/830473/) characters.

Display a variable:
-------------------

> In most contexts, surround the variable _name_ with %'s and the variable's _value_ will be used  
> e.g. To display the value of the _department variable with the ECHO command:  
> ECHO %_department%
> 
> If the variable name is not found in the current environment then SET will set %ERRORLEVEL% to 1 .  
> This can be detected using [IF](if.html) ERRORLEVEL ...
> 
> Including extra characters can be useful to show any white space:  
> ECHO [%_department%]  
> ECHO "%_department%"  
> 
> Type SET without parameters to display all the current environment variables.  
>   
> Type SET with a variable name to display that variable  
> SET _department  
>   
> The SET command invoked with a string (and no equal sign) will display a wildcard list of all matching variables  
>   
> Display variables that begin with 'P':  
> SET p  
> Display variables that begin with an underscore  
> SET _

Set a variable:
---------------

> Example of storing a text string:  
>   
> C:> SET _dept=Sales and Marketing  
> C:> set _  
> _dept=Sales and Marketing
> 
> Set a variable that contains a [redirection](syntax-redirection.html) character, note the position of the quotes which are not saved:
> 
> SET "_dept=Sales & Marketing"
> 
> One variable can be based on another, but this is not dynamic  
> E.g.
> 
> C:> set "xx=fish"  
> C:> set "msg=%xx% chips"  
> C:> set msg  
> msg=fish chips
> 
> C:> set "xx=sausage"  
> C:> set msg  
> msg=fish chips
> 
> C:> set "msg=%xx% chips"  
> C:> set msg  
> msg=sausage chips
> 
> Avoid starting variable names with a number, this will avoid the variable being mis-interpreted as a [parameter](syntax-args.html)  
> %123_myvar% < > %1 23_myvar  
>   
> To display undocumented system variables:
> 
>    SET "

Values with Spaces - using Double Quotes
----------------------------------------

> Although it is advisable, there is no requirement to add quotation marks when assigning a value that includes spaces:
> 
> SET _variable=one two three
> 
> For special characters like & surround the entire expression with quotation marks.  
> The variable contents will **not** include the surrounding quotes:
> 
> SET **"**_variable=one & two**"**
> 
> n.b. if you only place quotation marks around the value, then those quotes will be stored:
> 
> SET _variable=**"**one & two**"**

Variable names with spaces
--------------------------

> A variable can contain spaces and also the variable name itself can contain spaces, therefore the following assignment:  
> SET _var =MyText  
> will create a variable called "_var " ← note the trailing space.

Prompt for user input
---------------------

> The /P switch allows you to set a variable equal to a line of input entered by the user.  
> The Prompt string is displayed before the user input is read.
> 
> @echo off
> Set /P _ans=Please enter Department: || Set _ans=NothingChosen
> :: remove &'s and quotes from the answer (via string [replace](syntax-replace.html))
> Set _ans=%_ans:&=%
> Set _ans=%_ans:"=%
>   
> If "%_ans%"=="NothingChosen" goto sub_error  
> If /i "%_ans%"=="finance" goto sub_finance  
> If /i "%_ans%"=="hr" goto sub_hr
> goto:eof
> 
> :sub_finance
> echo You chose the finance dept
> goto:eof
> 
> :sub_hr
> echo You chose the hr dept  
> goto:eof
> 
> :sub_error
> echo Nothing was chosen
> 
> Both the Prompt string and the answer provided can be left empty. If the user does not enter anything (just presses return) then the variable will be unchanged and the [errorlevel](errorlevel.html) will be set to 1.
> 
> The script above strips out any '&' and " characters but may still break if the string provided contains both.  
> For user provided input, it is a good idea to fully [sanitize any input string](syntax-sanitize.html) for potentially problematic characters (unicode/smart quotes etc).
> 
> The [CHOICE](choice.html) command is an alternative for user input, CHOICE accepts only one character/keypress, when selecting from a limited set of options it will be faster to use.  

Echo a string with no trailing CR/LF
------------------------------------

> The standard ECHO command will always add a CR/LF to the end of each string displayed, returning the cursor to the start of the next line.  
> SET /P does not do this, so it can be used to display a string. Feed a NUL character into SET /P like this, so it doesn’t wait for any user input:
> 
> Set /P _scratch="This is a message to the user " <nul

Place the first line of a file into a variable:
-----------------------------------------------

> Set /P _MyVar=<MyFilename.txt  
> Echo %_MyVar%
> 
> The second and any subsequent lines of text in the file will be discarded.
> 
> In very early versions of CMD, any carriage returns/new lines (CR+LF) before the first line containing text were ignored.

Delete a variable
-----------------

> Type SET with just the variable name and an equals sign:  
>   
> SET _department=  
>   
> Better still, to be sure there is no trailing space after the = place the expression in parentheses or quotes:  
> (SET _department=)  
>   or  
> SET "_department="

Arithmetic expressions (SET /a)
-------------------------------

> Placing expressions in "quotes" is optional for simple arithmetic but required for any expression using logical operators.
> 
> When refering to a variable in your expression, SET /A allows you to omit the %'s so _myvar instead of %_myvar%
> 
> Any SET /A calculation that returns a fractional result will be rounded down to the nearest whole integer.
> 
> The expression to be evaluated can include the following operators:  
> For the Modulus operator use (%) on the command line, or in a batch script it must be [doubled up](syntax-percent.html) to (%%) as below.  
> This is to distinguish it from a [FOR](for.html) parameter.
> 
>    +   Add                set /a "_num=_num+5"
>    +=  Add variable       set /a "_num+=5"
>    -   Subtract           set /a "_num=_num-5"
>    -=  Subtract variable  set /a "_num-=5"
>    *   Multiply           set /a "_num=_num*5"
>    *=  Multiply variable  set /a "_num*=5"
>    /   Divide             set /a "_num=_num/5"
>    /=  Divide variable    set /a "_num/=5"
>    %%  [Modulus](https://www.geeksforgeeks.org/difference-between-modulo-and-modulus/)            set /a "_num=17%%5"
>    %%= Modulus            set /a "_num%%=5"
>    !   Logical negation  0 (FALSE) ⇨ 1 (TRUE) and any non-zero value (TRUE) ⇨ 0 (FALSE)
>    ~   Bitwise invert
>    &   AND                set /a "_num=5&3"    0101 AND  0011 = 0001 (decimal 1)
>    &=  AND variable       set /a "_num&=3"
>    |   OR                 set /a "_num=5|3"    0101 OR 0011 = 0111 (decimal 7)
>    |=  OR variable        set /a "_num|=3"
>    ^   XOR                set /a "_num=5^3"    0101 XOR 0011 = 0110 (decimal 6)
>    ^=  XOR variable       set /a "_num=^3"
>    <<  Left [Shift](https://www.bbc.co.uk/bitesize/guides/z6qqmsg/revision/4).    (sign bit ⇨ 0) An arithmetic shift.
>    >>  Right [Shift](https://www.bbc.co.uk/bitesize/guides/z6qqmsg/revision/4).   (Fills in the sign bit such that a negative number always remains negative.)
>                        Neither ShiftRight nor ShiftLeft will detect overflow.
>    <<= Left Shift variable     set /a "_num<<=2"
>    >>= Right Shift variable    set /a "_num>>=2"
> 
>   ( )  Parenthesis group expressions  set /a "_num=(2+3)*5"
>    ,   Commas separate expressions    set /a "_num=2,_result=_num*5"
> 
> If a variable name is specified as part of the expression, but is not defined in the current environment, then SET /a will use a value of 0.
> 
> SET /A arithmetic shift operators do not detect overflow which can cause problems for any non-trivial math, e.g. the bitwise invert often incorrectly reverses the + / - sign of the result.  
>   
> See [SET /a examples](#expressions) below and [this forum thread](https://ss64.org/viewtopic.php?f=2&t=336) for more.  
> also see [SetX](setx.html), [VarSearch](syntax-replace.html) and [VarSubstring](syntax-substring.html) for more on variable manipulation.
> 
> SET /A should work within the full range of 32 bit signed integer numbers (-2,147,483,648 through 2,147,483,647) but in practice for negative integers it will not go below -2,147,483,647 because the correct two's complement result 2,147,483,648 would cause a positive overflow.
> 
> **Examples:**
> 
> SET /A "_result=2+4"  
> (=6)  
>   
> SET /A "_result=5"  
> (=5)  
> SET /A "_result**+=**5"  
> (=10)  
>   
> SET /A "_result=2**<<**3"  
> (=16) { 2 Lsh 3 = binary 10 Lsh 3 = binary 10000 = decimal 16 }  
>   
> SET /A "_result=5**%%**2"  
> (=1) { 5/2 = 2 + 2 remainder 1 = 1 }  
>   
> SET /A "_var1=_var2=_var3=10"  
> (sets 3 variables to the same value - undocumented syntax.)
> 
> SET /A will treat any character string in the expression as an environment variable name. This allows you to do arithmetic with environment variables without having to type any % signs to get the values. SET /A "_result=5 + _MyVar"
> 
> Multiple calculations can be performed in one line, by separating each calculation with commas, for example:
> 
> Set "_year=1999"  
> Set /a "_century=_year/100, _next=_century+1"
> 
> The numbers must all be within the range of 32 bit signed integer numbers (-2,147,483,648 through 2,147,483,647) to handle larger numbers use [PowerShell](/ps/) or [VBScript](/vb/).
> 
> You can also store a math expression in a variable and substitute in different values, rather like a [macro](syntax-macros.html).
> 
> SET "_math=(#+6)*5"  
> SET /A _result="%_math:#=4%  
> Echo %_result%  
> SET /A _result="%_math:#=10%  
> Echo %_result%

Leading Zero will specify Octal
-------------------------------

> Numeric values are decimal numbers, unless prefixed by  
> **0x** for hexadecimal numbers,  
> **0** for octal numbers.  
>   
> So 0x10 = 020 = 16 decimal  
>   
> The octal notation can be confusing - all numeric values that start with zeros are treated as octal but 08 and 09 are not valid octal digits.  
> For example SET /a "_month=07" will return the value 7, but SET /a "_month=09" will return an error.

Permanent changes
-----------------

> Changes made using the SET command are NOT permanent, they apply to the current CMD prompt only and remain only until the CMD window is closed.  
> To permanently change a variable at the command line use [SetX](setx.html)  
> or with the GUI: Control Panel ➞ System ➞ Environment ➞ System/User Variables  
>   
> Changing a variable permanently with SetX will not affect any CMD prompt that is already open.  
> Only new CMD prompts will get the new setting.  
>   
> You can of course use SetX in conjunction with SET to change both at the same time:
> 
> Set _Library=T:\Library\  
> SetX _Library T:\Library\ /m

Change the environment for other sessions
-----------------------------------------

> Neither SET nor SetX will affect other CMD sessions that are already running on the machine . This as a good thing, particularly on multi-user machines, your scripts won’t have to contend with a dynamically changing environment while they are running.
> 
> It is possible to add permanent environment variables to the registry (HKCU\Environment), but this is an undocumented (and likely unsupported) technique and still it will not take effect until the users next login.
> 
> System environment variables can be found in the registry here:  
> HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment

CALL SET
--------

> The CALL SET syntax will expand any variables passed on the same line, which is useful if you need to set one variable based on the value of another variable. CALL SET can also evaluate a [variable substring](syntax-substring.html), the [CALL](call.html) page has more detail on this technique, though in many cases a faster to execute solution is to use Setlocal [EnableDelayedExpansion](delayedexpansion.html).

Autoexec.bat
------------

> Any SET statement in c:\autoexec.bat will be parsed at boot time  
> Variables set in this way are not available to 32 bit gui programs - they won’t appear in the control panel.  
> They will appear at the CMD prompt.  
>   
> If autoexec.bat CALLS any secondary batch files, the additional batch files will NOT be parsed at boot.  
> This behaviour can be useful on a dual boot PC.

Errorlevels
-----------

> When [CMD Command Extensions](cmd.html) are enabled (the default):
> 
> [Errorlevel](errorlevel.html)
> 
> If the variable was successfully changed
> 
> _unchanged_, typically this will be 0 but if a previous command set an errorlevel, that will be preserved (this is a bug).
> 
> SET No variable found or invalid name.  
> SET _var=value when _var name starts with "/" and not enclosed in quotes.  
> SET /P Empty response from user.
> 
> 1
> 
> SET /A Unbalanced parentheses
> 
> 1073750988
> 
> SET /A Missing operand
> 
> 1073750989
> 
> SET /A Syntax error
> 
> 1073750990
> 
> SET /A Invalid number
> 
> 1073750991
> 
> SET /A Number larger than 32-bits
> 
> 1073750992
> 
> SET /A Division by zero
> 
> 1073750993

SET is an [internal](syntax-internal.html) command.  
If [Command Extensions](cmd.html) are disabled all SET commands are disabled other than simple assignments like: _variable=MyText

\# I got my mind set on you  
\# I got my mind set on you... - Rudy Clark ([James Ray](https://www.youtube.com/watch?v=k68Fob0QA_k)/[George Harrison](https://www.youtube.com/watch?v=_71w4UA2Oxo))

### Related commands

[Syntax - VarSubstring](syntax-substring.html) Extract part of a variable (substring).  
[Syntax - VarSearch](syntax-replace.html) Search & replace part of a variable.  
[Syntax - Environment Variables](syntax-variables.html) - List of default variables.  
[CALL](call.html) - Evaluate environment variables.  
[CHOICE](choice.html) - Accept keyboard input to a batch file.  
[ENDLOCAL](endlocal.html) - End localisation of environment changes, use to return values.  
[EXIT](exit.html) - Set a specific ERRORLEVEL.  
[PATH](path.html) - Display or set a search path for executable files.  
[REG](reg.html) - Read or Set Registry values.  
[SETLOCAL](setlocal.html) - Begin localisation of environment variable changes.  
[SETX](setx.html) - Set an environment variable permanently.  
[Parameters](syntax-args.html) - get a full or partial pathname from a command line variable.  
[StackOverflow](https://stackoverflow.com/questions/6379619/explain-how-dos-batch-newline-variable-hack-works) - Storing a Newline in a variable.  
Equivalent PowerShell: [Set-Variable](../ps/set-variable.html) - Set a variable and a value (set/sv).  
Equivalent PowerShell: [Read-Host](../ps/read-host.html) - Prompt for user input.  
Equivalent bash command (Linux): [env](../bash/env.html) - Display, set, or remove environment variables.



/. nt/syntax-substring.html
========================================================

    variable substring - Windows CMD - SS64.com .code { color: #660099; font-weight: bold; }

How-to: Extract part of a variable (substring)
==============================================

It is possible to retrieve specific characters from a string variable.

Syntax

      %variable:~_start_index_%
      %variable:~_start_index_,_end_index_%

This can include negative numbers:

      %variable:~_start_index_, **-**_end_index_%
      %variable:~**-**_start_index_,_end_index_%
      %variable:~**-**_start_index_,_**-**end_index_%

_start_index_ Defines the starting point for the string returned, for positive numbers this is the number of characters skipped.  
A negative number will count backwards from the end of the string.

_end_index_ Defines the end point for the string returned, for positive numbers this is the number of characters to return after the _start_index_.  
A negative number will count backwards from the end of the string.

This syntax adds a little extra flexibility compared to a standard Mid() function, which is best illustrated by the examples below.

**Examples**  
  
The variable **_test** is used for all the following examples:

SET "_test=123456789abcdef0"

::Extract only the first 5 characters

 SET "_result=%_test:~0,5%"
 ECHO %_result%          =12345

::Skip 7 characters and then extract the next 5

 SET "_result=%_test:~7,5%"
 ECHO %_result%          =89abc

::Skip 7 characters and then extract everything else

 SET "_result=%_test:~7%"
 ECHO %_result%          =89abcdef0

::Extract only the last 7 characters

 SET "_result=%_test:~-7%"
 ECHO %_result%          =abcdef0

::Extract everything BUT the last 7 characters

 SET "_result=%_test:~0,-7%"
 ECHO %_result%          =123456789

::Extract between 7 from the front and 5 from the end

 SET "_result=%_test:~7,-5%"
 ECHO %_result%          =89ab

::Go back 7 from the end then extract 5 towards the end

 SET "_result=%_test:~-7,5%"
 ECHO %_result%          =abcde

::Extract between 7 from the end and 5 from the end

    SET "_result=%_test:~-7,-5%"
    ECHO %_result%        =ab

This variable substring syntax only works for CMD environment variables, like %MYVAR%, it will not work with FOR parameter variables, like %%G, however a simple workaround is to set a variable first: Set MYVAR=%%G and then find the substring of the new variable.

If you need to access the _current_ value of a variable within a [FOR](for.html) loop, then you may need to use [delayed expansion](delayedexpansion.html). By default variable expansion will happen just once at the start of each loop.

The _start_index_ may be omitted, defaulting to zero, though many prefer to include it to help document what the command is doing.

**Advanced Usage of :~**  
  
You can use the :~ syntax and provide each of the parameters from other variables, for example if you have  
  
Set "_donor=88477"  
Set "_digit=2"  
  
To extract digit # 2 from %_donor% you might try

 SET "_substring=%_donor:~%_digit%,1%"

Unfortunately this will not work because the :~ syntax expects a value not a variable. To get around this use the [CALL](call.html) command like this:

@Echo Off
SET _donor=884777
SET _startchar=2
SET _length=1
CALL SET "_substring=%%_donor:~%_startchar%,%_length%%%"
ECHO (%_substring%) 

:: Credits:  
:: Clay Calvert - [alt.msdos.batch.nt](https://groups.google.com/forum/#!msg/alt.msdos.batch.nt/pcsZ7LcQCMM/3fxDMb8jNJIJ)  
:: Ritchie Lawrence - [alt.msdos.batch.nt](https://groups.google.com/forum/#!topic/alt.msdos.batch.nt/7WIB4Fg81HE)

_#Substitute Me for him, Substitute My Coke for gin, Substitute You for my mum, At least I'll get my washing done# ~ The Who (Substitute)_

### Related commands

How-to: [VarSearch](syntax-replace.html) - Search & replace part of a variable.  
How-to: [strlen.cmd](syntax-strlen.html) - Get string length.  
PowerShell equivalent: [Substring()](../ps/substring.html) - Return part of a longer string.



/. nt/syntax-replace.html
========================================================

    CMD Variable edit replace - Windows CMD - SS64.com

How-to: Edit/Replace text within a Variable
===========================================

Use the syntax below to edit and replace the characters assigned to a string variable, also known as String Substitution.

Syntax

      %_variable_:_StrToFind_=_NewStr_%

      %~[_param_ext_]$_variable_:_Param_

Key
    _StrToFind_    : The characters we are looking for (not case sensitive).
    _NewStr_       : The chars to replace with (if any).
    _variable_     : The environment variable.
    _param_ext_    : Any filename [Parameter Extension](syntax-args.html).
    _Param_        : A command line parameter (e.g. 1).

This Edit/Replace syntax can be used anywhere that you would use the %variable% such as ECHOing the variable to screen or setting one variable = another.

_param_ext_ cannot be %* which typically represents a whole set of parameters, but this is easily worked around by setting a variable=%*  
  
"_StrToFind_" can **begin** with an asterisk, in which case it will replace all characters to the left of "StrToFind".

_NewStr_ can be left blank to delete characters, alternatively include [ECHO:](echo.html) in _NewStr_ if you need to generate a CR/newline in the output:  
  
In all cases the string matching is NOT case sensitive, so the string ABC will match abc.

Using both an asterisk and setting _NewStr_=null will enable you to construct a left$() or right$() function using this syntax.  
  
**Examples:  
**The variable _test containing 12345abcabc is used for all the following examples:

::Replace '12345' with 'Hello '
    SET "_test=12345abcABC"
    SET "_result=%_test:12345=Hello %"
    ECHO %_result%          =Hello abcABC

::Replace the character string 'ab' with 'xy'
    SET "_test=12345abcABC"
    SET "_result=%_test:ab=xy%"
    ECHO %_result%          =12345xycxyC

::Delete the character string 'ab'
    SET "_test=12345abcABC"
    SET "_result=%_test:ab=%"
    ECHO %_result%          =12345cC

::Delete the character string 'ab' and everything before it
    SET "_test=12345abcabc"
    SET "_result=%_test:*ab=%"
    ECHO %_result%          =cabc

::Replace the character string 'ab' and everything before it with 'XY'
    SET "_test=12345abcabc"
    SET "_result=%_test:*ab=XY%"
    ECHO %_result%          =XYcabc

:: To remove characters from the right hand side of a string is 
:: a two step process and requires the use of a [CALL](call.html) statement
:: e.g.

    SET _test=The quick brown fox jumps over the lazy dog

    :: To delete everything _after_ the string 'brown'  
    :: first delete 'brown' and everything before it
    SET "_endbit=%_test:*brown=%"
    Echo We dont want: [%_endbit%]

    ::Now remove this from the original string
    CALL SET "_result=**%%**_test:%_endbit%=**%%**"
    echo %_result%

The examples above assume the default Expansion of variables, if you are using [DelayedExpansion](delayedexpansion.html) then you can modify variables within a single loop/expression. Use the syntax: !_variable! instead of %_variable%

> Rename a set of files (fred001.txt – fred999.txt) with a different prefix, this is similar to but more flexible than a [wildcard](syntax-wildcards.html) [rename](ren.html),  
> via [Raymond Chen](https://devblogs.microsoft.com/oldnewthing/20210714-00/?p=105439)  
> Setlocal EnableDelayedExpansion  
> for %%i in (fred*.txt) do set "_=%%i" & ren "%%i" "!_:fred=wilma!"
> 
> One other advantage of DelayedExpansion is that it will allow you to replace the % character, it will still have to be [escaped](syntax-esc.html) as %% but the replace action will then treat it like any other character:
> 
> Replace the letter P with a percent symbol:  
> Setlocal EnableDelayedExpansion  
> _demo=somePdemoPtextP  
> _demo=!_demo:P=**%%**!

Remove spaces from a text string
--------------------------------

> To delete space characters use the same syntax as above:  
>   
> SET "_no_spaces=%_some_var: =%"  

Boolean Test "does string exist ?"
----------------------------------

> To test for the existence of a value we can use a temporary variable, delete the string we are looking for (if it exists) and then compare the two variables with [EQU](if.html)  
>   
> Example: test for the existence of the string "London" in a variable containing text (that could be in any order) "Aberdeen, London, Edinburgh"  
>   
> Set "_cities=Aberdeen, London, Edinburgh"  
> :: Remove London if found  
> Set "_dummy=%_cities:London=%"  
> IF NOT %_dummy% == %_cities% (ECHO London was found.) ELSE (ECHO London was not found.)  

Finding items within the PATH environment variable
--------------------------------------------------

> The %PATH% variable contains a list of folder names.  
>   
> If you have a parameter containing a valid 'folder' this can be compared with the PATH variable.  
>   
> This is done using the syntax: $variable:parameter  
>   
> **Example**
> 
> %PATH% = C:\Windows\system32;C:\Windows;C:\utils\jdk\bin  
> batch parameter %1 = C:\utils\jdk\bin  
>   
> To get the drive and Path  
> ECHO %~dp$PATH:1  
> This will either return "C:\utils\jdk\bin" or a NULL if the item is not found in the %PATH%  
>   
> If the batch parameter was supplied as %2 then this would be: ECHO %~dp$PATH:2  
>   
> This syntax can be applied where:
> 
> *   The parameter is any valid parameter (%1 %2 %G) but it must contain a Full [Path](path.html) (not a pathname)
> *   The variable is %PATH% or any other variable that contains one or more Paths or pathnames separated by semicolons ;
> *   If nothing is found by the search, then this will return an empty string (NULL)
> 
> Be wary of using the syntax on this page to **modify** the PATH - the User path can be edited, but the System path remains read-only for most users.

Advanced Usage of %_variable_:
------------------------------

> You can use the %_variable_: syntax and provide each of the parameters from other variables, for example if you have  
>   
> SET "_FullString=The ballad of John and Yoko"  
> SET "_Search=John"  
>   
> To remove the %_search% string from the%_FullString% you might try:
> 
>  SET "_result=%_FullString:~%_Search%=%"
> 
> Unfortunately this will not work because the : syntax expects a value not a variable.  
> To work around this use the [CALL](call.html) command, in this case the CALL replaces the variable shown in bold with its value:
> 
> SET "_FullString=The ballad of John and Yoko"
> SET "_Search=John"
> CALL SET "_result=%%_FullString:**%_Search%**=%%"  
> :: If nothing was removed then the search string was not found.
> If /i "%_result%"=="%_FullString%" (Echo String not found) ELSE (Echo String found)

“A phony smile will never replace honest integrity” ~ Bob Martinelli

### Related commands

[PATH](path.html) - Display or set a search path for executable files.  
How-to: [SUBSTRING](syntax-substring.html) of a variable :~  
How-to: [PARAMETERS](syntax-args.html) - Filename Parameter Extensions.  
How-to: [strlen.cmd](syntax-strlen.html) - Get string length.  
How-to: [ToLower.cmd](syntax-tolower.html) - Lower case a String.



/. nt/syntax-random.html
========================================================

    Random Numbers - Windows CMD - SS64.com

How-to: Generate Random Numbers
===============================

The Windows CMD shell contains a [built-in variable](syntax-variables.html) called %RANDOM% that can be used to generate random numbers.

%RANDOM% generates a random integer from 0 to 32,767 (inclusive)  
  
 0 ≤ %RANDOM% ≤ 32767

The range of numbers can be made smaller than 32767 with a little arithmetic:  
Dividing %RANDOM% by 32768 will produce a random number between 0 and almost 1 (0.999969) notice we are dividing by 327**68** rather than 32767, so we should never get 1 which would give us an uneven distribution of numbers.

Two commonly given ways to generate a random number in batch:

Set /a _rand=(%RANDOM%%%(max-min+1))+min  
Set /a _rand=(%RANDOM%*(max-min+1)/32768)+min

The [Set /a](set.html) will always round down.

For example to generate a random number ranging from 1 to 500:

@Echo Off  
Set /a _rand=(%RANDOM%***500**/32768)+1  
Echo Random number %_rand%

Limited range of numbers when using %Random%
--------------------------------------------

> If you try, it may look as though a larger range than 32767 will work, but doing this will produce gaps, for example changing 500 in the example above to 65536 will result in a sequence of "random" numbers which only consists of odd numbers.

Random vs Pseudorandom numbers
------------------------------

> A pseudorandom sequence is not truly random but is determined by a small set of initial values (state), the initial seed is often based on the clock time. In the case of the CMD %RANDOM% the seed is based on the clock time when the CMD session started. This can be problematic when running a batch file, if the script always takes about the same time to run before calling %RANDOM% then the number returned will always lie within a small predictable range.
> 
> As an example create a file numbers.cmd:
> 
> @Echo off  
> Echo %RANDOM%
> 
> Then call the above with
> 
> CMD /c numbers.cmd  
> CMD /c numbers.cmd  
> CMD /c numbers.cmd

Raymond Chen [MSFT] has a detailed description of [Why cmd.exe's %RANDOM% isn’t so random](https://devblogs.microsoft.com/oldnewthing/20100617-00/?p=13673)

Johannes Baagøe has published a comparison of [better](https://web.archive.org/web/20120802042822/http://baagoe.org/en/w/index.php/Better_random_numbers_for_javascript) random numbers for javascript. The [fastest](https://jsperf.com/pseudo-random-number-generators) of these is Alea(), which you can find a copy of below. This has a number of advantages, you can create much larger numbers, it will create a lot of numbers quickly and if you call it passing a seed number then the results become repeatable - you can create exactly the same sequence of random numbers again at a later date.

// random.js

// call this from the command line with:
// C:> [cscript](../vb/cscript.html) /nologo random.js

// or from PowerShell
// PS C:> $myrandom = & cscript /nologo "c:\batch\random.js"
// will create an array of 10 random numbers which you can then treat like any array variable:
// PS C:> $myrandom[4]

// Calling without a seed, the current time will be used as a seed
var srandom=Alea();

// Calling with a seed will return the same value for the same seed
//var seed=1234
//var srandom=Alea(seed);

var i=0

  // Return 10 random numbers
while ( i < 10 ) {
  // Return a number between 1 and 500 million
  WScript.echo(Math.floor((srandom()*500000000)+1) );
  i++;
} 

function Mash() {
  var n = 0xefc8249d;

  var mash = function(data) {
    data = data.toString();
    for (var i = 0; i < data.length; i++) {
      n += data.charCodeAt(i);
      var h = 0.02519603282416938 * n;
      n = h >>> 0;
      h -= n;
      h *= n;
      n = h >>> 0;
      h -= n;
      n += h * 0x100000000; // 2^32
    }
    return (n >>> 0) * 2.3283064365386963e-10; // 2^-32
  };

  mash.version = 'Mash 0.9';
  return mash;
}

function Alea() {
  return (function(args) {
    // Johannes Baagoe <baagoe@baagoe.com>, 2010
    var s0 = 0;
    var s1 = 0;
    var s2 = 0;
    var c = 1;

    if (args.length == 0) {
      args = [+new Date];
    }
    var mash = Mash();
    s0 = mash(' ');
    s1 = mash(' ');
    s2 = mash(' ');

    for (var i = 0; i < args.length; i++) {
      s0 -= mash(args[i]);
      if (s0 < 0) {
        s0 += 1;
      }
      s1 -= mash(args[i]);
      if (s1 < 0) {
        s1 += 1;
      }
      s2 -= mash(args[i]);
      if (s2 < 0) {
        s2 += 1;
      }
    }
    mash = null;

    var random = function() {
      var t = 2091639 * s0 + c * 2.3283064365386963e-10; // 2^-32
      s0 = s1;
      s1 = s2;
      return s2 = t - (c = t | 0);
    };
    random.uint32 = function() {
      return random() * 0x100000000; // 2^32
    };
    random.fract53 = function() {
      return random() + 
        (random() * 0x200000 | 0) * 1.1102230246251565e-16; // 2^-53
    };
    random.version = 'Alea 0.9';
    random.args = args;
    return random;

  } (Array.prototype.slice.call(arguments)));
};

/* licensed according to the [MIT - Expat license](https://tldrlegal.com/license/mit-license):

Copyright (C) 2010 by Johannes Baagoe <baagoe@baagoe.org>

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE. */

“Anyone who attempts to generate random numbers by deterministic means is, of course, living in a state of sin” ~ John von Neumann

### Related commands

PowerShell Equivalent: [Get-Random](../ps/get-random.html)  
VBScript: [Rnd](../vb/rnd.html) - Return a pseudorandom number.  
[Comparing the distribution of random numbers](https://www.reddit.com/r/Batch/comments/kq2c6h/modulus_arithmetic_is_better_than_multiplying_and/) - Generate a random number in batch.  
[Random.org](https://www.random.org/) - Generate true random numbers online.



/. nt/syntax-wildcards.html
========================================================

    Wildcards - Windows CMD - SS64.com

How-to: Match filenames with Wildcards
======================================

The * wildcard will match any sequence of characters
               (0 or more, including NULL characters)

The ? wildcard will match a single character
               (or a NULL at the end of a filename)

A few quirks affect the operation of wildcards which are best illustrated by example:  
  
To match the filename BAR.TXT any of the following patterns will match:  
?AR.TXT  
BAR.*  
??R.TXT  
B?R.???  
BA?.TXT  
BA??.TXT  
  
However the following will fail to match with BAR.TXT  
??AR.TXT  
?BAR.TXT  
B??AR.TXT

Wildcard matching rules
-----------------------

> * Generally matches any 0 or more characters, with one exception (see next rule). The non-greedy wildcard is free to match as many or as few characters as are necessary for the remainder of the mask to match.
> 
> * At end of mask matches any 0 or more characters except for {dot}. In actuality, the rule applies with any number of {dot} and {space} characters between the * and terminal {dot}. The regular expression for this term is `[*][. ]*[.]$`
> 
> ? Match 0 or one character, except for {dot}.  
> The only time it matches 0 characters is when it matches the end of the name, or the position before a {dot}.  
> The question mark can also be used more than once to match more than one character.

Wildcards match both the Short and Long filename
------------------------------------------------

> The command DIR /X will reveal short filenames if they exist, where many similar names exist in the same folder the short file name (SFN) will not always be an obvious contraction of the long name. e.g.
> 
> DIR /X
> 
>       2019-05-12 01:12 96 DIABLO~1 diablo1640
>       2019-05-12 01:12 96 DIABLO~2 diablo1641
>       2019-05-12 01:12 96 DIABLO~3 diablo1642
>       2019-05-12 01:12 96 DIABLO~4 diablo1643
>       2019-05-12 01:12 96 DI**E359**~1 diablo1644
>       2019-05-12 01:12 96 DI**C49C**~1 diablo1648
>       2019-05-12 01:12 96 DI**F2E9**~1 diablo1740
>       2019-05-12 01:12 96 DI**E2EF**~1 diablo1649
> 
> As you can see, the first four short filenames follow the usual numeric tails (~1, ~2, ~3, ~4).  
> Then, from fifth and more files with similar beginning, the short names have four hex digits in the middle. This is actually a hex [checksum of the long filename](https://tomgalvin.uk/blog/gen/2015/06/09/filenames/). (If you need a true file checksum look at [CertUtil -hashfile](certutil.html#hashfile))
> 
> Wildcards are supported by the following commands:  
> [ATTRIB](attrib.html), [CACLS](cacls.html), [CIPER](cipher.html), [COMPACT](compact.html), [COPY](copy.html), [DEL](del.html), [DIR](dir.html), [EXPAND](expand.html), [EXTRACT](extract.html), [FIND](find.html), [FINDSTR](findstr.html), [FOR](for.html), [FORFILES](forfiles.html), [FTP](ftp.html), [ICACLS](icacls.html), [IF](if.html) EXIST, [MORE](more.html), [MOVE](move.html), MV, [NET](net.html) (*=Any Drive), [PERMS](perms.html), [PRINT](print.html), [REN](ren.html), [REPLACE](replace.html), [ROBOCOPY](robocopy.html), [ROUTE](route.html), [TAKEOWN](takeown.html), [TYPE](type.html), [WHERE](where.html), [XCACLS](xcacls.html), [XCOPY](xcopy.html)
> 
> The commands [COPY](copy.html) and [REN](ren.html) accept two sets of wildcards, there are some subtle differences between how these are treated, see the [REN](ren.html) page for details.
> 
> The wildcards used by [FORFILES](forfiles.html) are non-standard, but are similar to the wildcards used in PowerShell.

Undocumented Wildcards
----------------------

> The two undocumented wildcards, < and > can be used with commands like DIR and COPY, or to supply a command name but only if quoted: DIR /b "<demo<"
> 
> < Matches any 0 or more characters in either the base name or the extension, but never both.  
> Unlike the * wildcard, a single < cannot match characters in both the base name and the extension.  
> The {dot} is considered to be part of the base name, not the extension. There is one exception - If the name consists solely of an extension, without a base name, then the {dot} is considered to be part of the extension. This non-greedy wild card is free to match as many or as few characters as are necessary for the remainder of the mask to match.
> 
> > Is identical to ?. The only difference is that it can be placed after a {dot} to prevent the {dot} from matching the end of the name.
> 
> Examples at [Dostips](https://www.dostips.com/forum/viewtopic.php?f=3&t=6207 "props to Dave Benham for unpicking this syntax,")
> 
> The < and > wildcards work with the following commands: [CACLS](cacls.html), [CIPHER](cipher.html), [COPY](copy.html), [DEL](del.html), [DIR](dir.html), [FINDSTR](findstr.html), [IF](if.html) EXIST, [MOVE](move.html), [TYPE](type.html)

Numeric Comparisons
-------------------

> There are several contexts where CMD.EXE will parse a string as a numeric expression:
> 
> > [IF](if.html) comparisons - [EQU](equ.html), [NEQ](neq.html), [LSS](lss.html), [LEQ](leq.html), [GEQ](geq.html), [GTR](gtr.html)  
> > [SET /A](set.html)  
> > [variable substring expansion](syntax-substring.html) - %var:~_n,m_%  
> > FOR /F "TOKENS=_n_"  
> > FOR /F "SKIP=_n_"  
> > [FOR /L](for_l.html) %%A in (_n1 n2 n3_)
> 
> For many purposes a 4 byte signed integer value ranging from -2,147,483,648 to 2,147,483,647 will suffice, but in the above contexts it is also possible to express the numbers in hexadecimal or octal notation.
> 
> e.g. Octal: 00, 07 Hex: 0x00, 0xFF
> 
> There are a number of subtle differences (Negative numbers, command, version of Windows) which affect how these numbers are parsed and these are described in the DosTips forum thread [Rules for how CMD.EXE parses numbers](https://www.dostips.com/forum/viewtopic.php?f=3&t=3758).

_“We usually see only the things we are looking for, so much that we sometimes see them where they are not” ~ Eric Hoffer_

### Related commands

[FINDSTR](findstr.html)  
[REN](ren.html) - Rename files.  
How-to: [Long and short filename issues](syntax-filenames.html)  
[How did wildcards work in MS-DOS?](https://devblogs.microsoft.com/oldnewthing/20071217-00/?p=24143) - Raymond Chen



/. nt/syntax-keyboard.html
========================================================

    Windows command prompt Keyboard shortcuts - Windows CMD - SS64.com

How-to: General Windows 11 Keyboard shortcuts plus [CMD/PowerShell shortcuts](#cmd) and [Windows Terminal shortcuts](#terminal).
================================================================================================================================

General Windows shortcuts (⊞ = Windows Key).
--------------------------------------------

> Open or Close the Start Menu.
> 
> ⊞
> 
> Launch a Start Menu app 'As Admin'
> 
> ⇧ + Ctrl + click app
> 
> Select all items in a document or window.
> 
> Ctrl + A
> 
> Open the Action Center.
> 
> ⊞ + A
> 
> Copy the selected item.
> 
> Ctrl + C (or Ctrl + Insert)
> 
> Activate Cortana listening mode.
> 
> ⊞ + C
> 
> Delete the selected item and move it to the Recycle Bin.
> 
> Ctrl + D (or Delete)
> 
> Delete the selected item immediately, without moving it to the Recycle Bin.
> 
> Shift + Delete
> 
> Show Desktop / Minimize all. Press a second time to restore.
> 
> ⊞ + D
> 
> Open Search (in most apps).
> 
> Ctrl + E
> 
> Open Windows File Explorer.
> 
> ⊞ + E
> 
> Open the Feedback Hub.
> 
> ⊞ + F
> 
> Open Find computers.
> 
> ⊞ + Ctrl + F
> 
> Open Game bar ➞ capture = record video of the screen.
> 
> ⊞ + G
> 
> Open Dictation tool, (speech to text).
> 
> ⊞ + H
> 
> Open Settings.
> 
> ⊞ + I
> 
> Open Connect.
> 
> ⊞ + K
> 
> Switch the keyboard layout when multiple keyboard layouts are available.
> 
> Ctrl + Shift
> 
> Lock the PC.
> 
> ⊞ + L
> 
> Minimize all windows.
> 
> ⊞ + M
> 
> Restore windows that were minimized with ⊞ +M.
> 
> ⊞ + ⇧ + M
> 
> Presentation display mode.
> 
> ⊞ + P
> 
> Open the "Run Program Or File" Window.
> 
> ⊞ + R
> 
> Search.
> 
> ⊞ + S
> 
> Open the Ease of Access center. Reverse with ⊞+⇧ Shift+V (Win 1810+)
> 
> ⊞ + U
> 
> Ctrl + V (or Shift + Insert)
> 
> Paste the selected item.
> 
> Cycle through notifications/Clipboard History.  
> First enable it in Settings ➞ System ➞ Clipboard ➞ toggle "Clipboard History"
> 
> ⊞ + V
> 
> Quick link menu (like right clicking on START).
> 
> ⊞ + X
> 
> Shutdown Windows (press Windows key + X, followed by U, then U again)
> 
> ⊞ + X , U, U
> 
> Restart Windows
> 
> ⊞ + X , U, R
> 
> Hibernate Windows
> 
> ⊞ + X , U, H
> 
> Sleep Windows
> 
> ⊞ + X , U, S
> 
> Shutdown/Restart Windows (GUI prompt).  
> If possible, close all other apps first.
> 
> Alt + F4  
> or  
> Ctrl-Alt-Del then click Power icon (or Ctrl + click Power for an Emergency Restart)
> 
> Redo an action.
> 
> Ctrl + Y
> 
> Undo an action.
> 
> Ctrl + Z
> 
> Open the app that is pinned to taskbar position _#_ where 1 is the left-most icon.
> 
> ⊞ + _#_  
> ⊞ +1, ⊞ + 2...
> 
> Open the Emoji panel.
> 
> ⊞ + . (or ⊞ + ; )
> 
> Switch between open apps.
> 
> Alt + Tab  
> to reverse use:  
> Ctrl + Alt + Tab
> 
> Cycle through items in the order in which they were opened.
> 
> Alt + Esc
> 
> Open Start Menu.
> 
> Ctrl + Esc
> 
> Open the Task view.
> 
> ⊞ + Tab ↹
> 
> Open Task Manager.
> 
> ⇧ + Ctrl + Esc
> 
> Minimize all but the active desktop window.
> 
> ⊞ + Home
> 
> Snap the active window to the right or left of the screen.
> 
> ⊞ + →  
> ⊞ + ←
> 
> Maximize or Minimize the active window.
> 
> ⊞ + ↑  
> ⊞ + ↓
> 
> Stretch the desktop window to the top and bottom of the screen.
> 
> ⊞ + ⇧ + ↑  
> ⊞ + ⇧ + ↓
> 
> Auto-correct a display issue/lockup.
> 
> ⊞ + Ctrl ⇧ B
> 
> Opens properties of My Computer
> 
> ⊞ + Pause  
> or ⊞+Break
> 
> Open Windows Help.
> 
> ⊞ + F1
> 
> Rename the selected item.
> 
> F2
> 
> Refresh the active window.
> 
> F5 (or Ctrl + R)
> 
> Cycle through screen elements in a window or on the desktop.
> 
> F6
> 
> Show your password on the sign-in screen.
> 
> Alt + F8
> 
> Activate the Menu bar in the active app.
> 
> F10
> 
> Display the shortcut menu for the selected item.
> 
> Shift + F10
> 
> Perform the command for that letter.
> 
> Alt + underlined letter
> 
> Display properties for the selected item.
> 
> Alt + Enter
> 
> Open the shortcut menu for the active window.
> 
> Alt + Spacebar
> 
> Go forward/back.
> 
> Alt + →  
> Alt + ←  
> 
> Move the cursor to the beginning/end of the next word.  
> or Resize the Start menu when it's open.
> 
> Ctrl + →  
> Ctrl + ←
> 
> Select more than one item in a window or on the desktop, or selecting text.
> 
> Shift + any arrow key
> 
> Select multiple individual items in a window or on the desktop.  
> Use the arrow to move and Spacebar to select.
> 
> Ctrl + → + Spacebar
> 
> Move up/down one screen.
> 
> Alt + Pg Up  
> Alt + Pg Down
> 
> Move the cursor to the beginning/end of the previous paragraph.
> 
> Ctrl + ↑  
> Ctrl + ↓
> 
> Zoom in.
> 
> ⊞ **+** [Magnifier](https://support.microsoft.com/en-us/help/4040990/windows-10-how-to-use-magnifier)
> 
> Zoom out.
> 
> ⊞ **-** [Magnifier](https://support.microsoft.com/en-us/help/4040990/windows-10-how-to-use-magnifier)
> 
> Open a quick look at the desktop.
> 
> ⊞ + ,
> 
> Screenshot region of screen (snipping tool).
> 
> ⊞ + ⇧ + S
> 
> Stop or leave the current task.
> 
> Esc
> 
> Save a full screen screenshot to the clipboard.  
> You can change this shortcut so it also opens screen snipping, to edit the screenshot.  
> Select Start ➞ Settings ➞ Accessibility ➞ Keyboard  
> and set Use the Print Screen button to open screen snipping to On.
> 
> PrtScn
> 
> Save a screenshot of the active window to the clipboard.
> 
> Alt + PrtScn
> 
> Close the active document (in apps with a multiple document interface).
> 
> Ctrl + F4
> 
> Close the active item, or exit the active app.
> 
> Alt + F4

Keyboard shortcuts for the Windows CMD shell and [PowerShell](../ps/).

> Switch to/from full screen mode.
> 
> Alt + ENTER
> 
> Cancel the current command (if nothing is selected).
> 
> Ctrl + C
> 
> Enter Mark mode.
> 
> Ctrl + M
> 
> Select text in mark mode.
> 
> Shift + ←/→
> 
> Copy the selected text.
> 
> Ctrl + C  
> or Ctrl + Insert
> 
> Paste the selected text.
> 
> Ctrl + V  
> or Shift + Insert
> 
> Move the cursor in the direction specified.
> 
> Arrow keys ↑→↓←
> 
> Move the cursor by one page up.
> 
> Page up
> 
> Move the cursor by one page down.
> 
> Page down
> 
> Move the cursor to the beginning of the buffer.
> 
> Ctrl + Home (Mark mode)
> 
> Move the cursor to the end of the buffer.
> 
> Ctrl + End (Mark mode)
> 
> Autocomplete folder/file name.
> 
> [Tab]
> 
> Scroll through history of typed commands.
> 
> ↓ / ↑
> 
> Toggle full screen.
> 
> Alt + Enter or F11
> 
> Clear command line.
> 
> ESC
> 
> Toggle Insert/Overwrite.
> 
> INSERT
> 
> Erase line to the left.
> 
> Ctrl + Home
> 
> Erase line to the right.
> 
> Ctrl + End
> 
> Move one word to the left (backward).
> 
> Ctrl + ←
> 
> Move one word to the right (forward).
> 
> Ctrl + →
> 
> Erase character to the left.
> 
> ⌫
> 
> Move to beginning of line.
> 
> [Home]
> 
> Move to end of line.
> 
> [End]
> 
> Scroll window up.
> 
> ⇧ + PgUp
> 
> Scroll window Down.
> 
> ⇧ + PgDn

New [Windows Terminal](wt.html) Keyboard shortcuts
--------------------------------------------------

> **Application-level shortcuts:**
> 
>  
> 
> Find.
> 
> Ctrl + ⇧ + F
> 
> Open the dropdown.
> 
> Ctrl + ⇧ + Space
> 
> Open settings files.
> 
> Ctrl ,
> 
> Open settings files.
> 
> Ctrl + Alt ,
> 
> **Tab management shortcuts:**
> 
>  
> 
> New tab.
> 
> Ctrl + ⇧ + T
> 
> New tab.
> 
> Ctrl + ⇧ + 1 thru 9
> 
> Duplicate tab.
> 
> Ctrl + ⇧ + D
> 
> Open next tab.
> 
> Ctrl + Tab
> 
> Open previous tab.
> 
> Ctrl + ⇧ + Tab
> 
> Open a specific tab.
> 
> Ctrl + Alt 1 thru 9
> 
> **Pane management shortcuts:**
> 
>  
> 
> Move pane focus.
> 
> Alt + ↑→↓←
> 
> Resize a pane.
> 
> Alt + ⇧ + ↑→↓←
> 
> Split a pane.
> 
> Alt + ⇧ + D  
> The control the split direction with:  
> Alt + ⇧ **-**  
> or Alt + ⇧ **+**
> 
> Close pane.
> 
> Ctrl + ⇧ + W
> 
> **Clipboard integration:**
> 
>  
> 
> Copy the selected text.
> 
> Ctrl + C  
> or Ctrl + ⇧ + C  
> or Ctrl + Insert
> 
> Paste the selected text.
> 
> Ctrl + V  
> or Ctrl + ⇧ + V  
> or Shift + Insert
> 
> **Scrollback:**
> 
>  
> 
> Scroll up/Down.
> 
> Ctrl + ⇧ + ↑  
> Ctrl + ⇧ + ↓
> 
> Scroll up one page.
> 
> Ctrl + ⇧ + Pg Up
> 
> Scroll down one page.
> 
> Ctrl + ⇧ + Pg Dn
> 
> **Visual adjustment:**
> 
>  
> 
> Adjust font size.
> 
> Ctrl + =
> 
> Adjust font size.
> 
> Ctrl + **-**
> 
> Reset font size.
> 
> Ctrl + 0
> 
> Toggle High Visibility screen mode.[](https://support.microsoft.com/en-us/help/4040990/windows-10-how-to-use-magnifier)
> 
> Left Alt + Left ⇧ + PrtScn

CMD shell Command History shortcuts:
------------------------------------

> F1  > Print characters of the previous command one by one.
> 
> F2 _Z_  > Repeat part of the previous command; up to character _Z_
> 
> F3  > Repeat the previous command.
> 
> F4 _Z_  > Beginning from the current cursor position, delete up to character _Z_.
> 
> F5  > Scroll through history of typed commands (↑).
> 
> Ctrl ↑ / ↓ > Scroll the screen up or down one line.
> 
> F7  > Show history of previous commands.
> 
> ALT + F7  > Clear command history.
> 
> F8  > Move backwards through the command history, but only display commands matching the current text at the command prompt.
> 
> F9  > Run a specific command from the command history.
> 
> Ctrl + Z  > Signal end-of-file.

Virtual Desktops
----------------

> Create a new virtual desktop. .
> 
> ⊞ + Ctrl D
> 
> Switch between virtual desktops.
> 
> ⊞ + Ctrl + ←  
> ⊞ + Ctrl + →
> 
> Switch Monitors.
> 
> ⊞ + Shift + ←  
> ⊞ + Shift + →
> 
> Close the active virtual desktop.
> 
> ⊞ + Ctrl + F4
> 
> Task View/Timeline, press ⊞ + Tab then Right-click an app to show across all desktops.  
> With multiple monitors, ⊞ + Tab shows which apps are open on each monitor
> 
> ⊞ + Tab

Group Policy GPO
----------------

> F5 > Mark all settings on the page as "green" (apply all).
> 
> F6 > Mark current settings on the page as "green" (apply this setting).
> 
> F7 > Mark current settings as "red" (don’t apply this setting).
> 
> F8 > Mark all settings on the page as "red" (don’t apply).
> 
> F3 > Display a list of available variables.

Enable/disable NumLock:
-----------------------

> Fn + F11 (Acer, Toshiba, Samsung)  
> Ctrl + F11  
> Fn + F11 + Scroll lock  
> Fn + Num Lock (Sony, Gateway)  
> ⇧ + Num Lock  
> Fn + Num Lock (Lenovo, ASUS)  
> Fn + ⇧ + Num Lock  
> Fn + F8 (HP)  
> Fn + F4 (Dell)

⇧ is the Shift key  
⌫ is the Backspace key  
⊞ is the Windows Key

Add Custom shortcut keys
------------------------

> If you have a shortcut anywhere on the Start Menu or Desktop you can create a keyboard shortcut for it.
> 
> For example if you have a shortcut to the traditional Control Panel in the Start Menu, right click it and choose _More ➞ Open file location_. Right click on the shortcut file and select _Properties_. Under _Shortcut ➞ Shortcut Key_ you can assign a hotkey,  
> pressing Ctrl+C will assign the shortcut Ctrl+Alt+C.

How to disable one or more ⊞ (Windows Key) Keyboard Shortcuts:

> In the Windows registry add a new String Value called “DisabledHotkeys" under HKCU\Software\Microsoft\CurrentVersion\Explorer\Advanced
> 
> Set the value data for this key to the hotkey characters you want to disable.  
> For example: to disable the hotkeys Win + X and Win + R, set the value to RX  
> (n.b. This will also affect other modifier key combinations like Win + Shift + X)
> 
> Restart Explorer or Logoff/reboot and the new settings will apply to this user account.
> 
> The hotkeys specified will be disabled and unassigned and thus available to any third party app which allows you to assign global hotkeys.

"If NumLock is on, pressing a key on the numeric keypad while holding SHIFT overrides NumLock and instead generates an arrow key" ~ [OldNewThing](https://devblogs.microsoft.com/oldnewthing/20040906-00/?p=37953)

### Related commands

[MMCs](syntax-mmc.html) - Shortcuts to popular Microsoft Management Consoles.  
Default the NUMLOCK key to be ON or OFF at login - see examples on the [REGEDIT](regedit.html) page.  
[EXPLORER](explorer.html) - Open Windows Explorer.  
[Windows Start ➞ Run commands](run.html)  
[CompSci superbasics](https://superbasics.beholder.uk/) - Using the keyboard and command line.  
[Keyboard shortcuts in Windows](https://support.microsoft.com/en-us/help/12445/windows-keyboard-shortcuts) - Microsoft.com  
[Doskey /history](doskey.html) - Show history of previous commands.  
[Microsoft Keyboard Layout Creator](https://www.microsoft.com/en-us/download/details.aspx?id=102134) - Remap keys. (see also remapkey.exe in the [Windows 2003 resource Kit](https://www.microsoft.com/en-us/download/details.aspx?id=17657))  
Equivalent [bash Keyboard shortcuts](../bash/syntax-keyboard.html)



/. nt/run.html
========================================================

    Start ➞ Run Commands for Windows - Windows CMD - SS64.com

Windows Start ➞ Run commands
============================

| Description | Run Command |
|-------------|-------------|
Accessibility Options

    utilman  
    or  
    control access.cpl

Add Hardware Wizard

    hdwwiz

Programs and Features  
(Add New Programs)  
(Add Remove Windows Components)  
(Set Program Access & Defaults )

    appwiz.cpl  
    control appwiz.cpl,,1  
    control appwiz.cpl,,2  
    control appwiz.cpl,,3

Administrative Tools

    control admintools

Advanced User Accounts Control Panel

    netplwiz

Authorization Manager

    azman.msc

Automatic Update

    control wuaucpl.cpl

Backup and Restore Utility

    sdclt

Bluetooth Transfer Wizard

    fsquirt

Calculator

    calc

Certificate Manager

    certmgr.msc

Character Map

    charmap

Check Disk Utility

    [chkdsk](chkdsk.html)

Clear Type (tune or turn off)

    cttune

Color Management

    colorcpl.exe

Command Prompt

    [cmd](cmd.html)

Component Services

    dcomcnfg  
    or  
    comexp.msc

Computer Management

    CompMgmtLauncher.exe  
    or  
    compmgmt.msc  

Control Panel

    control

Credential (passwords) Backup and Restore Wizard

    credwiz

Data Execution Prevention

    SystemPropertiesDataExecutionPrevention

Date and Time Properties

    timedate.cpl

Device Manager

    hdwwiz  
    or  
    devmgmt.msc  

Device Pairing Wizard

    DevicePairingWizard

Digitizer Calibration Tool (Tablets/Touch screens)

    tabcal

Direct X Control Panel (if installed)

    directx.cpl

Direct X Troubleshooter

    dxdiag

Disk Cleanup Utility

    [cleanmgr](cleanmgr.html)

Disk Defragmenter

    dfrgui  
    [defrag](defrag.html)  

Disk Management

    diskmgmt.msc

Disk Partition Manager

    diskpart

Display Color Calibration

    dccw

Display DPI / Text size

    dpiscaling

Display Properties (Themes, Desktop, Screensaver)

    control desktop

Display Properties (Resolution, Orientation)

    desk.cpl

Display Properties (Color & Appearance)

    control color

Documents (open 'My Documents' folder)

    documents

Downloads (open 'Downloads' folder)

    downloads

Driver Verifier Utility

    verifier

DVD Player

    dvdplay

Edit Environment Variables

    rundll32.exe sysdm.cpl,EditEnvironmentVariables

Encrypting File System Wizard (EFS)

    rekeywiz

Event Viewer

    eventvwr.msc

File Signature Verification Tool (Device drivers)

    sigverif

Files and Settings Transfer Tool

    %systemroot%\system32\migwiz\migwiz.exe

Firewall Control Panel

    firewall.cpl

Folders Properties

    control folders

Fonts list  

    control fonts  

Font preview

    fontview arial.ttf

Game Controllers

    joy.cpl

Local Group Policy Editor

    gpedit.msc

Internet Properties

    inetcpl.cpl

IP Configuration

    [ipconfig](ipconfig.html)

iSCSI Initiator configuration

    iscsicpl

Keyboard Properties

    control keyboard

Language Pack Installer

    lpksetup

Local Security Policy

    secpol.msc

Local Users and Groups

    lusrmgr.msc

Log out

][logoff](logoff.html)

Microsoft Malicious Software Removal Tool

    mrt

Microsoft Management Console

    mmc

Access (Microsoft Office)

    msaccess

Excel (Microsoft Office)

    Excel

Powerpoint (Microsoft Office)

    powerpnt

Word (Microsoft Office)

    winword

Microsoft Paint

    mspaint

Microsoft Support Diagnostic Tool

    msdt

Mouse Properties

    control mouse  
    or  
    main.cpl

Network Connections

    control netconnections  
    or  
    ncpa.cpl

Projector:  
Connect to Network Projector  
Switch projector display

    netproj  
  
    displayswitch

Notepad

    notepad

ODBC Data Source Admin  
Default ODBC driver:  
32-bit ODBC driver under 64-bit platform:  

  
    C:\windows\system32\odbcad32.exe  
    C:\windows\sysWOW64\odbcad32.exe  

ODBC configuration - Install/configure MDAC drivers

    odbcconf

On Screen Keyboard

    osk

OOB Getting Started

    gettingstarted

Password - Create a Windows Password Reset Disk (USB)

    "C:\Windows\system32\rundll32.exe" keymgr.dll,PRShowSaveWizardExW

Password - Change Password

    C:\Windows\explorer.exe shell:::{2559a1f2-21d7-11d4-bdaf-00c04f60b9f0}

Pen and Touch (Tablet/Pen input configuration)

    tabletpc.cpl

Performance Monitor

    perfmon.msc ('perfmon [/rel](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/perfmon)' for the Reliability Monitor)

Phone and Modem Options

    telephon.cpl

Phone Dialer

    dialer

Power Configuration

    powercfg.cpl and [powercfg.exe](powercfg.html)

Presentation Settings

    PresentationSettings

**Problem Steps Recorder**

    [psr](https://windows.microsoft.com/en-gb/windows7/how-do-i-use-problem-steps-recorder)

Program Access and Computer Defaults - browser / email / media

    computerdefaults

Printers and Faxes

    control printers

Print Management (.msc)

    PrintManagement

Printer Migration (backup/restore)

    printbrmui and [printbrm.exe](printbrm.html)

Printer user interface (List all printui.dll options)

    printui

Private Character Editor

    eudcedit

Regional Settings - Language, Date/Time format, keyboard locale.

    intl.cpl

Registry Editor

    [regedit](regedit.html)

Remote Assistance

    msra

**Remote Desktop**

    [mstsc](mstsc.html)

Resource Monitor

    resmon

Resultant Set of Policy

    rsop.msc

Settings (Windows 10)

    [ms-settings:](syntax-settings.html)

Scheduled Tasks

    control schedtasks

Screenshot Snipping Tool

    snippingtool

Security Center

    wscui.cpl

Services

    [services.msc](syntax-services.html)

Shared Folder Wizard

    shrpubw

Shared Folders

    fsmgmt.msc

Shut Down Windows

    [shutdown](shutdown.html)

Software Licensing/Activation

    slui

Sounds and Audio

    mmsys.cpl

    Windows 系统上使用 24-bit 48Khz 采样可能导致 ASIO4ALL 驱动问题，
    一个现象是：关闭 ASIO4ALL 或者同时开启多个媒体播放程序时冲突，导致右声道
    全是噪声，可以通过修改声音播放设备恢复正常。操作步骤：运行 mmsys.cpl 打开
    声音设备管理器，打开扬声器属性，进入高级选项卡，修改默认格式为 24-bit 44Khz。

Sound Recorder

    soundrecorder

Sound Volume

    sndvol

Syncronization Tool (Offline files)

    mobsync

System Configuration Utility

    msconfig

System File Checker Utility (Scan/Purge)

    [sfc](sfc.html)

System Information

    [msinfo32](msinfo32.html)

System Properties  

    sysdm.cpl SystemProperties  
    or  
    sysdm.cpl DisplaySYSDMCPL  

System Properties - Performance

    SystemPropertiesPerformance

System Properties - Hardware

    SystemPropertiesHardware

System Properties - Advanced

    SystemPropertiesAdvanced

System Repair - Create a System Repair Disc

    recdisc

System Restore

    rstrui.exe

Task Manager

    taskmgr

Task Scheduler

    taskschd.msc

Telnet Client

    telnet

Trusted Platform Module Initialization Wizard

    tpmInit

  
User Accounts (Autologon)

    control userpasswords2

User Account Control (UAC) Settings

    UserAccountControlSettings

User Profiles - Edit/Change type

    C:\Windows\System32\rundll32.exe sysdm.cpl,EditUserProfiles

Windows Disc Image Burning Tool

    isoburn C:\movies\madmax.iso

[Windows Explorer](explorer.html)

    explorer.exe  
    explorer.exe .  Will open at the current directory

Windows Features

    optionalfeatures

Windows Firewall  
Windows Firewall with Advanced Security

    firewall.cpl  
    wf.msc

Windows Image Acquisition (scanner)

    wiaacmgr

Windows Magnifier

    magnify

Windows Management Infrastructure

    wmimgmt.msc

Windows Memory Diagnostic Scheduler

    mdsched

Windows Mobility Center (Mobile PCs only)

    mblctr

Windows [PowerShell](../ps/)

    powershell

Windows PowerShell ISE

    powershell_ise

Windows Security Action Center

    wscui.cpl

Windows Script Host([VBScript](../vb/))

    wscript _NAME_OF_SCRIPT_.VBS

Windows System Security Tool. Encrypt the SAM database.  
(boot password.)

    syskey

Windows Update

    wuapp

Windows Update Standalone Installer

    wusa

Windows Version ([About Windows](syntax-settings.html))

    winver

WordPad

    write

Unless indicated otherwise, all the commands above work in all versions of Windows from Vista upwards.  
Most of these utilities can be found in %systemroot%\System32\

_“The Macintosh uses an experimental pointing device called a 'mouse.' There is no evidence that people want to use these things” ~ John Dvorak_

### Related commands

How-to: [ms-settings](syntax-settings.html) - Shortcuts to settings.  
How-to: [Shell: folder](shell.html) - Shortcuts to key folders.  
How-to: [Keyboard shortcuts](syntax-keyboard.html) For CMD, PowerShell and Windows.  
How-to: [MMC Snap-ins](syntax-mmc.html) - Admin commands.  
How-to: [ProfileFolders](syntax-folders.html) - Location of user profile folders.  
How-to: [Run a script](syntax-run.html) - How to create and run a batch file.  
[START](start.html) - Start a program, command or batch file.  
[EXPLORER](explorer.html) - Open Windows Explorer.



/. nt/syntax-mmc.html
========================================================

    MMC Admin command lines - Windows CMD - SS64.com

How-to: Shortcut commands to open Management Console Snap-ins
=============================================================

System Administrator command line shortcuts to popular Microsoft Management Consoles (MMCs).

| Admin Snap-in | Command | Category |
|---------------|---------|----------|

| Quality of Service Control Management | ACSsnap.msc | Network |
| ADSI Edit | ADSIedit.msc | AD Configuration |
| Authorization manager | AZman.msc | Security |
| Certificates Management - Local machine | Certlm.msc | Security |
| Certificates Management - Current user | Certmgr.msc | Security |
| Certification Authority Management | Certsrv.msc | Security |
| Certificate Templates | Certtmpl.msc | Security |
| Failover cluster Manager | Cluadmin.exe | Disc, File
| Component Services | Comexp.msc |  |
| **Computer Management** | Compmgmt.msc |  |
| Device Manager | Devmgmt.msc | Hardware |
| Notifications/Start menu/policy | DevModeRunAsUserConfig.msc |  |
| Disk Defragmenter | [Defrag.exe](defrag.html) (formerly Dfrg.msc) | Disc, File |
| Distributed File Service Mgmt | DFSmgmt.msc | Disc, File |
| Disk Manager | DiskMgmt.msc | Disc, File |
| DNS Manager | DNSmgmt.msc | Network |
| AD Domains and Trusts | Domain.msc | AD Configuration |
| AD Users and Computers | DSA.msc | Security |
| AD Sites and Services | DSsite.msc | AD Configuration |
| Embedded Lockdown Manager | EmbeddedLockdown.msc | Security |
| **Event Viewer** | Eventvwr.msc |  |
| Shared Folders open files | FSmgmt.msc | Disc, File |
| File Server Resource manager | FSRM.msc | Disc, File |
| Local Group Policy Editor | GPedit.msc | Policy |
| Group Policy Management | GPmc.msc | Policy |
| Group Policy Management Editor | GPme.msc | Policy |
| Group Policy Starter GPO Editor | GPTedit.msc | Policy |
| Local Users and Groups Manager | LUsrMgr.msc | Security |
| Teminal Services RDP | MSTSC | Remote Access
| Teminal Services RDP to Console | MSTSC /v:[server] /console | Remote Access
| NAP client configuration | NapCLCfg | Network
| **Performance Monitor** | PerfMon.msc |  |
| Print Management | PrintManagement.msc | Print |
| Resultant Set of Policy | RSOP.msc | Policy |
| Local Security Settings Manager | SecPol.msc | Policy |
| **Server Roles, Features** | ServerManager.msc |  |
| Services Management | Services.msc |  |
| SQL Server configuration Manager | SQLServerManager11.msc |  |
| Storage Mgmt | StorageMgmt.msc | Disc, File |
| Telephony Management | TAPImgmt.msc | Phone/Modem |
| Task Scheduler | TaskSchd.msc |  |
| Trusted Platform Module | TPM.msc | Security |
| Terminal Server Manager | TSadmin.exe | Remote Access
| Remote Desktop | TSmmc.msc | Remote Access |
| Windows Mangement Instrumentation | WmiMgmt.msc |  |
| Windows Server Backup (Local+Remote) | WBadmin.msc | Disc, File |
| Windows Local Backup | WLBadmin.msc | Disc, File |
| Windows Firewall | WF.msc | Remote Access |

The commands above can be entered from START ➞ Run, or from the command line.  
Availability will vary by OS and by the features installed.

“I don’t do anything in order to cause trouble. It just so happens that what I do naturally causes trouble.  
 I'm proud to be a troublemaker” ~ Sinead O'Connor

### Related commands

How-to: [ms-settings](syntax-settings.html) - Shortcuts to settings.  
How-to: [Run Commands](syntax-run.html)  
How-to: [Keyboard shortcuts](syntax-keyboard.html) For CMD, PowerShell and Windows.



/. nt/syntax-settings.html
========================================================

    ms-settings - Windows CMD - SS64.com

How-to: Quickly open control panel applets with ms-settings
===========================================================

These URI's can be used in the [Start ➞ Run](run.html) box, in the Windows Explorer address bar, in a [Shortcut](shortcut.html)  
or from the command line: [START](start.html) ms-settings:_settingName_ or in PowerShell [Start-Process](../ps/start-process.html) ms-settings:_settingName_

| Settings page | Uri / Setting Name | Category |
|---------------|--------------------|----------|
| Edge web browser | microsoft-edge:_url_ |Apps
| Home page for Settings | ms-settings: | Windows
| About (device name/specification) | ms-settings:about | Windows
| Activation | ms-settings:activation | Security
| Apps & features | ms-settings:appsfeatures | Apps
| Apps for websites | ms-settings:appsforwebsites | Apps
| App volume and device preferences (1903) | ms-settings:apps-volume | Audio
| Set up a kiosk | ms-settings:assignedaccess | Security
| AutoPlay | ms-settings:autoplay | Apps
| Backup | ms-settings:backup | Storage
| Battery Saver | ms-settings:batterysaver | Power
| Battery Saver - settings | ms-settings:batterysaver-settings | Power
| Battery Saver - usage | ms-settings:batterysaver-usagedetails | Power
| Bluetooth & Connected Devices | ms-settings:bluetooth | Network
| Clipboard | ms-settings:clipboard | Apps
| Connect to a wireless display | ms-settings-connectabledevices:devicediscovery | Display
| Bluetooth & Connected Devices | ms-settings:connecteddevices | Network
| Cortana | ms-settings:cortana | Search
| Cortana permissions | ms-settings:cortana-permissions | Search
| Cortana more details | ms-settings:cortana-moredetails | Search
| Windows Search | ms-settings:cortana-windowssearch | Search
| Shared experiences | ms-settings:crossdevice | Network
| Data Sense | ms-settings:datausage | Storage
| Date & Time | ms-settings:dateandtime | Region & Language
| Default apps | ms-settings:defaultapps | Apps
| Delivery Optimization | ms-settings:delivery-optimization | Windows
| For developers | ms-settings:developers | Apps
| Device Encryption (where available) | ms-settings:deviceencryption | Security
| Touchpad | ms-settings:devices-touchpad | Devices
| Display | ms-settings:display | Display
| Graphics Advanced scaling settings | ms-settings:display-advanced | Display
| Graphics performance preference | ms-settings:display-advancedgraphics | Display
| Ease of Access Audio (build 17035+) | ms-settings:easeofaccess-audio | Accessibility
| Closed Captioning | ms-settings:easeofaccess-closedcaptioning | Accessibility
| Color Filters (build 17025+) | ms-settings:easeofaccess-colorfilter | Accessibility
| Adaptive Color Filters Link | ms-settings:easeofaccess-colorfilter-adaptivecolorlink | Accessibility
| Text Cursor | ms-settings:easeofaccess-cursor | Accessibility
| Mouse Pointer (Cursor & pointer, build 17040+) | ms-settings:easeofaccess-cursorandpointersize | Accessibility
| Display Text scaling (build 17025+) | ms-settings:easeofaccess-display | Accessibility
| Eye Control (build 17035+) | ms-settings:easeofaccess-eyecontrol | Accessibility
| High Contrast | ms-settings:easeofaccess-highcontrast | Accessibility
| Keyboard | ms-settings:easeofaccess-keyboard | Devices
| Magnifier | ms-settings:easeofaccess-magnifier | Accessibility
| Mouse | ms-settings:easeofaccess-mouse | Accessibility
| Mouse Pointer (Cursor & pointer, build 17040+) | ms-settings:easeofaccess-mousepointer | Accessibility
| Narrator | ms-settings:easeofaccess-narrator | Audio
| Start Narrator after sign-in | ms-settings:easeofaccess-narrator-isautostartenabled | Audio
| Other options | ms-settings:easeofaccess-otheroptions | Accessibility
| Speech recognition (build 17035+) | ms-settings:easeofaccess-speechrecognition | Accessibility
| Email & app accounts | ms-settings:emailandaccounts | Security
| Family & other users | ms-settings:family-group | Security
| Find My Device | ms-settings:findmydevice | Security
| Fonts (build 17083+) | ms-settings:fonts | Customisation
| Lock screen | ms-settings:lockscreen | Security
| Offline Maps | ms-settings:maps | Apps
| Download maps | ms-settings:maps-downloadmaps | Apps
| Mouse & Touchpad Devices | ms-settings:mousetouchpad | Devices
| Multitasking | ms-settings:multitasking | Display
| Network & Internet | ms-settings:network | Network
| Airplane mode (wireless/bluetooth) | ms-settings:network-airplanemode | Network
| Cellular Network | ms-settings:network-cellular | Network
| Dial-up Network | ms-settings:network-dialup | Network
| DirectAccess | ms-settings:network-directaccess | Network
| Ethernet Network | ms-settings:network-ethernet | Network
| Mobile Hotspot | ms-settings:network-mobilehotspot | Network
| Proxy (Network) | ms-settings:network-proxy | Network
| Network Status | ms-settings:network-status | Network
| VPN | ms-settings:network-vpn | Network
| Wi-Fi | ms-settings:network-wifi | Network
| Manage known Wi-Fi | ms-settings:network-wifisettings | Network
| Night light settings | ms-settings:nightlight | Customisation
| Notifications and Actions | ms-settings:[notifications](https://support.microsoft.com/en-us/window change-notification-and-quick-settings-in-windows-11-ddcbbcd4-0a02-f6e4-fe14-6766d850f294) | Customisation
| Optional features | ms-settings:optionalfeatures | Apps
| Family & other users | ms-settings:otherusers | Security
| Personalization | ms-settings:personalization | Customisation
| Backgrounds | ms-settings:personalization-background | Customisation
| Colors | ms-settings:personalization-colors  || ms-settings:colors | Customisation
| Start Menu | ms-settings:personalization-start | Customisation
| Start Menu (choose which folders appear) | ms-settings:personalization-start-places | Customisation
| Power & Sleep | ms-settings:powersleep | Power
| Printers | ms-settings:printers | Devices
| Privacy | ms-settings:privacy | Privacy
| Account info (share between apps) | ms-settings:privacy-accountinfo | Privacy
| Activity history (build 17040+) | ms-settings:privacy-activityhistory | Privacy
| App diagnostics (share between apps) | ms-settings:privacy-appdiagnostics | Privacy
| Automatic online file downloads | ms-settings:privacy-automaticfiledownloads | Apps
| Background apps | ms-settings:privacy-backgroundapps | Apps
| File System (share between apps) | ms-settings:privacy-broadfilesystemaccess | Privacy
| Calendar (share between apps) | ms-settings:privacy-calendar | Privacy
| Call history (share between apps) | ms-settings:privacy-callhistory | Privacy
| Contacts (share between apps) | ms-settings:privacy-contacts | Privacy
| Unpaired devices (share between apps) | ms-settings:privacy-customdevices | Privacy
| Document Library (share between apps) | ms-settings:privacy-documents | Privacy
| Email (share between apps) | ms-settings:privacy-email | Privacy
| Eye tracker (requires eyetracker hardware) | ms-settings:privacy-eyetracker | Privacy
| Feedback & diagnostics (privacy) | ms-settings:privacy-feedback | Security
| Send Diagnostic Data to Microsoft | ms-settings:privacy-feedback-telemetryviewergroup | Privacy
| Location (share between apps) | ms-settings:privacy-location | Privacy
| Messaging (share between apps) | ms-settings:privacy-messaging | Privacy
| Microphone (share between apps) | ms-settings:privacy-microphone | Privacy
| Motion (share between apps) | ms-settings:privacy-motion | Privacy
| Notifications (share between apps) | ms-settings:privacy-notifications | Privacy
| Picture Library (share between apps) | ms-settings:privacy-pictures | Privacy
| Radio (share between apps) | ms-settings:privacy-radios | Privacy
| Online Speech recognition | ms-settings:privacy-speech | Privacy
| Remember typing patterns | ms-settings:privacy-speechtyping | Privacy
| Tasks (share between apps) | ms-settings:privacy-tasks | Privacy
| Video Library (share between apps) | ms-settings:privacy-videos | Privacy
| Voice activation (apps can listen) | ms-settings:privacy-voiceactivation | Privacy
| Webcam (share between apps) | ms-settings:privacy-webcam | Privacy
| Projecting to this PC | ms-settings:project | Display
| Airplane mode (wireless/bluetooth) | ms-settings:proximity | Network
| Focus assist (build 17074+) | ms-settings:quiethours  || OR ms-settings:quietmomentshome | Apps
| Recovery - Reset/Advanced startup | ms-settings:recovery | Windows
| Region | ms-settings:regionformatting | Region & Language
| Region & language | ms-settings:regionlanguage | Region & Language
| Remote Desktop | ms-settings:remotedesktop | Network
| Default Save Locations | ms-settings:savelocations | Storage
| Display Screen rotation | ms-settings:screenrotation | Display
| Search details | ms-settings:search-moredetails | Search
| Search Permissions & search history | ms-settings:search-permissions | Search
| Sign-in options | ms-settings:signinoptions | Security
| Dynamic Lock | ms-settings:signinoptions-dynamiclock | Security
| Windows Hello face setup | ms-settings:signinoptions-launchfaceenrollment | Security
| Windows Hello fingerprint setup | ms-settings:signinoptions-launchfingerprintenrollment | Security
| Security Key setup | ms-settings:signinoptions-launchsecuritykeyenrollment | Security
| Sound (build 17063+) | ms-settings:sound | Audio
| Manage sound devices (disable/test) | ms-settings:sound-devices | Audio
| Speech | ms-settings:speech | Audio
| Startup (build 17017+) | ms-settings:startupapps | Customisation
| Storage Sense configuration | ms-settings:storagepolicies | Storage
| Storage Sense | ms-settings:storagesense | Storage
| Sync your settings | ms-settings:sync | Network
| Tablet mode | ms-settings:tabletmode | Customisation
| Taskbar | ms-settings:taskbar | Apps
| Themes | ms-settings:themes | Customisation
| Troubleshoot - Fix Windows Update | ms-settings:troubleshoot | Windows
| Typing | ms-settings:typing | Accessibility
| USB | ms-settings:usb | Devices
| Video playback (build 16215+) | ms-settings:videoplayback | Display
| Windows Security (Defender) | ms-settings:windowsdefender | Security
| Windows Insider Program (beta's) | ms-settings:windowsinsider | Windows
| Windows Update | ms-settings:windowsupdate | Security
| WinUpdate - Check for updates | ms-settings:windowsupdate-action | Security
| WinUpdate - Active Hours | ms-settings:windowsupdate-activehours | Security
| WinUpdate - Update history | ms-settings:windowsupdate-history | Security
| WinUpdate - Optional updates | ms-settings:windowsupdate-optionalupdates | Security
| WinUpdate - Advanced options | ms-settings:windowsupdate-options | Security
| WinUpdate - Restart options | ms-settings:windowsupdate-restartoptions | Security
| Access work or school | ms-settings:workplace | Network
| Your info (Microsoft account) | ms-settings:yourinfo | Security
| Software Center (SCCM) | softwarecenter: | Apps
| Windows Security at a glance | windowsdefender: | Security

To create a desktop shortcut to any Windows settings page:  
Right-click an empty section of the desktop and select New ➞ Shortcut  
In the empty text field, copy and paste the URI from the list above.

“The greater danger for most of us lies not in setting our aim too high and falling short; but in setting our aim too low, and achieving our mark” ~ Michelangelo

### Related commands

How-to: [Windows Start ➞ Run commands](run.html)  
How-to: [Shell: folder](shell.html) - Shortcuts to key folders.  
[EXPLORER](explorer.html) - Open Windows Explorer.  
How-to: [Keyboard shortcuts](syntax-keyboard.html) For CMD, PowerShell and Windows.  
How-to: [MMCs](syntax-mmc.html) - Shortcuts to popular Microsoft Management Consoles.  
How-to: [ProfileFolders](syntax-folders.html) - Location of User profile folders.  
How-to: [PowerShell script to open Settings.](../ps/syntax-settings.html)  
[Launch the Windows Settings app](https://docs.microsoft.com/en-us/windows/uwp/launch-resume/launch-settings-app) - List of ms-settings from Microsoft.com.



/. nt/shell.html
========================================================

    Shell folder shortcuts - Windows CMD - SS64.com

Shell: folder shortcuts
=======================

Shell folder shortcuts can be used directly in the Windows File Explorer Address bar:  shell:Desktop  
or from the Start Menu: Start ➞ Run ➞ shell:Desktop

| Description | Shell: folder shortcut | Equivalent | System | User |
|-------------|------------------------|------------|--------|------|

| Display installed Windows Updates  | shell:AppUpdatesFolder |
Control Panel ➞ Programs and Features ➞ Installed updates

System folder

  

| Open the user’s Start Menu\Administrative Tools folder (if any)  | shell:Administrative Tools |
%LocalAppData%\Microsoft\Windows\Start Menu\Programs\Administrative Tools\  
= C:\Users\<username>\AppData\Local\Microsoft\Windows\Start Menu\Programs\Administrative Tools

 

User folder

| Open All Users Start Menu\Administrative Tools folder  | shell:Common Administrative Tools |
%ProgramData%\Microsoft\Windows\Start Menu\Programs\Administrative Tools\  
=C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Administrative Tools

System Folder

  

| Open the Public Application Data folder  | shell:Common AppData |
[%ProgramData%](syntax-variables.html)  
= C:\ProgramData

System folder

  

| Open the user’s Application Data folder  | shell:AppData |
[%AppData%](syntax-variables.html) = C:\Users\<username>\AppData\Roaming\

 

User folder

| Open the user’s Application Data folder  | shell:Local AppData |
[%LocalAppData%](syntax-variables.html) = C:\Users\<username>\AppData\Local\

 

User folder  

| Apps folder  | shell:appsFolder |
 

 

 

| Open the Temporary Internet Files folder  | shell:Cache |
%LocalAppData%\Microsoft\Windows\iNetCache\  
= C:\Users\<username>\AppData\Local\Microsoft\Windows\iNetCache

Internet Explorer

User folder  

| Open the user’s certificates folder  | shell:SystemCertificates |
%AppData%\Microsoft\System Certificates\  
= C:\Users\<username>\AppData\Roaming\Microsoft\System Certificates

 

User folder

| Open the Client Side Cache Offline Files folder, if supported  | shell:CSCFolder |
Client Side Cache, if enabled

 

User folder  

| Open the folder where files are stored before being burned to disc  | shell:CD Burning |
%LocalAppData%\Microsoft\Windows\Burn\Burn\  
= C:\Users\<username>\AppData\Local\Microsoft\Windows\Burn\Burn

 

User folder  

| Open the user’s Windows Contacts folder  | shell:Contacts |
%UserProfile%\Contacts\ = C:\Users\<username>\Contacts

 

User folder

| Open the Internet Explorer Cookies folder  | shell:Cookies |
%LocalAppData%\Microsoft\Windows\iNetCookies\  
= C:\Users\<username>\AppData\Local\Microsoft\Windows\iNetCookies

Internet Explorer

User folder

| Open the user’s Credentials folder  | shell:CredentialManager |
%AppData%\Microsoft\Credentials\  
= C:\Users\<username>\AppData\Roaming\Microsoft\Credentials

User folder

User folder

| Open the list of Network Connections  | shell:ConnectionsFolder |
Control Panel ➞ Network Connections

Control Panel

  

| Display the Control Panel  | shell:ControlPanelFolder |
Control Panel

Control Panel

  

| Open the user’s encryption keys folder  | shell:Cryptokeys |
%AppData%\Microsoft\Crypto\  
= C:\Users\<username>\AppData\Roaming\Microsoft\Crypto

 

User folder

| Open the user’s desktop folder  | shell:Desktop |
Desktop merged from %UserProfile%\Desktop + %Public%\Desktop\

Public folder

User folder

| Open the Public Desktop  | shell:Common Desktop |
%Public%\Desktop\  
= C:\Users\Public\Desktop

System folder

  

| Opens the user’s AppData\Roaming\Microsoft\Protect folder  | shell:DpAPIKeys |
%AppData%\Microsoft\Protect\  
= C:\Users\<username>\AppData\Roaming\Microsoft\Protect

 

User folder

| Open the Public Documents folder  | shell:Common Documents |
%Public%\Documents\  
= C:\Users\Public\Documents

System folder

  

| Open the user’s downloads folder  | shell:Downloads |
%UserProfile%\Downloads\ = C:\Users\<username>\Downloads

 

User folder

| Open the Public Downloads folder  | shell:CommonDownloads |
%Public%\Downloads\  
= C:\Users\Public\Downloads

System folder

  

| Open the Internet Explorer Favorites folder  | shell:Favorites |
%UserProfile%\Favorites\  
= C:\Users\<username>\Favorites

 

User folder

| Open the Fonts folder  | shell:Fonts |
%SystemRoot%\Fonts  
= C:\Windows\Fonts

System folder

  

| Open the user folder of downloaded Sidebar Gadgets  | shell:Gadgets |
 

Internet Explorer

  

| Open the default Sidebar Gadgets folder  | shell:Default Gadgets |
 

System folder

  

| Open the Games folder  | shell:Games |
 

System folder

  

| Open the user’s Game Explorer folder  | shell:GameTasks |
%LocalAppData%\Microsoft\Windows\GameExplorer\  
= C:\Users\<username>\AppData\Local\Microsoft\Windows\GameExplorer

 

User folder  

| Open the user’s History folder  | shell:History |
%LocalAppData%\Microsoft\Windows\History\  
= C:\Users\<username>\AppData\Local\Microsoft\Windows\History

 

User folder  

| Open the HomeGroup folder  | shell:HomeGroupFolder |
 

System folder

  

| Open the HomeGroup folder for the currently logged-on user (if any)  | shell:HomeGroupCurrentUserFolder |
 

System folder

  

| Launches Internet Explorer Applets and applications  | shell:InternetFolder |
 

Internet Explorer

  

| Open the hidden ImplicitAppShortcuts folder  | shell:ImplicitAppShortcuts |
%AppData%\Microsoft\InternetExplorer\ImplicitAppShortcuts\  
= C:\Users\<username>\AppData\Roaming\Microsoft\Internet Explorer\ImplicitAppShortcuts

Internet Explorer

User folder

| Open the Libraries folder  | shell:Libraries |
Libraries

Library

  

| Open the Documents library  | shell:DocumentsLibrary |
Libraries\Documents

Library

  

| Display public libraries, if any  | shell:PublicLibraries |
%Public%\Libraries\ = C:\Users\Public\Libraries

Library

  

| Display your Music library  | shell:MusicLibrary |
Libraries\Music

Library

  

| Open the Public Music folder  | shell:CommonMusic |
%Public%\Music\ = C:\Users\Public\Music

Multimedia

  

| Open the user’s Music folder  | shell:My Music |
%UserProfile%\Music\ = C:\Users\<username>\Music

 

User folder

| Open the Sample Music folder  | shell:SampleMusic |
%Public%\Music\Sample Music\ = C:\Users\Public\Music\SampleMusic

Multimedia

  

| Open the user’s Pictures\Slide Shows folder (if present)  | shell:PhotoAlbums |
 

 

 

| Account Pictures  | Shell:AccountPictures |
%AppData%\Microsoft\Windows\Account Pictures\  
= C:\Users\<username>\AppData\Roaming\Microsoft\Windows\Account Pictures

 

 

| Display your Pictures library  | shell:PicturesLibrary |
Libraries\Pictures (previously My Pictures)  
= C:\Users\<username>\Pictures

Library

User folder  

| Open the Public Pictures folder  | shell:CommonPictures |
%Public%\Pictures\ = C:\Users\Public\Pictures

Multimedia

  

| Open the Sample Pictures folder  | shell:SamplePictures |
%Public%\Pictures\Sample Pictures\ = C:\Users\Public\Pictures\Sample Pictures

Multimedia

  

| Open the Windows Photo Gallery Original Images folder, if installed  | shell:Original Images |
 

Multimedia

  

| Display your Videos library  | shell:VideosLibrary |
Libraries\Videos

Library

  

| Open the user’s Links folder  | shell:Links |
%UserProfile%\Links\ = C:\Users\<username>\Links

 

User folder

| Open the Computer folder  | shell:MyComputerFolder |
"This PC"

System folder

  

| Open the user’s Network Places folder  | shell:NetHood |
%AppData%\Microsoft\Windows\Network Shortcuts\  
= C:\Users\<username>\AppData\Roaming\Microsoft\Windows\Network Shortcuts

 

User folder

| Open the Network Places folder  | shell:NetworkPlacesFolder |
"Network"

System folder

  

| Display links provided by your PC manufacturer (if any)  | shell:OEM Links |
 

System folder

  

| Open the user’s Documents folder  | shell:Personal |
%UserProfile%\Documents\ = C:\Users\<username>\Documents

 

User folder

| Open the user’s printer shortcuts folder  | shell:PrintHood |
%AppData%\Microsoft\Windows\Printer Shortcuts\  
= C:\Users\<username>\AppData\Roaming\Microsoft\Windows\Printer Shortcuts

 

User folder

| Open the user’s profile folder  | shell:Profile |
[%UserProfile%](syntax-variables.html) = C:\Users\<username>

 

User folder

| Access shortcuts pinned to the Start menu or Taskbar  | shell:User Pinned |
%AppData%\Microsoft\Internet Explorer\Quick Launch\User Pinned\  
= C:\Users\<username>\AppData\Roaming\Microsoft\Internet Explorer\Quick Launch\User Pinned

 

User folder

| Open the user’s \Music\Playlists folder  | shell:Playlists |
 

 

 

| Open the folder holding all user profiles  | shell:UserProfiles |
C:\Users

System folder

  

| Open the Printers folder  | shell:PrintersFolder |
Control Panel ➞ Printers

System folder

  

| Open the user’s Start Menu Programs folder  | shell:Programs |
%AppData%\Microsoft\Windows\Start Menu\Programs\  
= C:\Users\<username>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs

 

User folder

| Open the Public Start Menu Programs folder  | shell:Common Programs |
%ProgramData%\Microsoft\Windows\Start Menu\Programs\  
=C:\ProgramData\Microsoft\Windows\Start Menu\Programs

System folder

  

| Open the Control Panel "Install a program from the network" applet  | shell:AddNewProgramsFolder |
Control Panel ➞ Get Programs from the network

Control Panel

  

| Open the Control Panel "Uninstall or change a program" applet  | shell:ChangeRemoveProgramsFolder |
Control Panel ➞ Uninstall or change a program

Control Panel

  

| Open the Program Files folder  | shell:ProgramFiles |
[%ProgramFiles%](syntax-variables.html)  
= C:\Program Files

System folder

  

| Open the Program Files\Common Files folder  | shell:ProgramFilesCommon |
%ProgramFiles%\Common Files\  
= C:\Program Files\Common Files

System folder

  

Display 32-bit programs stored on 64-bit Windows,  
| or the \Program Files folder on 32-bit Windows  | shell:ProgramFilesX86 |
%ProgramFiles(x86)% = C:\ProgramFiles (x86)

System folder

  

Open the Common Files for 32-bit programs stored on 64-bit Windows,  
| Or the Program Files\Common Files folder on 32-bit Windows  | shell:ProgramFiles**Common**X86 |
%ProgramFiles(x86)%\Common Files\  
= C:\ProgramFiles (x86)\Common Files

Internet Explorer

  

| Open the Public Game Explorer folder  | shell:PublicGameTasks |
%ProgramData%\Microsoft\Windows\GameExplorer\  
=C:\ProgramData\Microsoft\Windows\GameExplorer

System folder

  

| Open the Users\Public folder (Shared files)  | shell:Public |
[%Public%](syntax-variables.html) = C:\Users\Public

Public folder

  

| Open the Quick Launch folder (disabled by default)  | shell:Quick Launch |
%AppData%\Microsoft\Internet Explorer\Quick Launch\  
= C:\Users\<username>\AppData\Roaming\Microsoft\Internet Explorer\Quick Launch

 

User folder

| Open the user’s Recent Documents folder  | shell:Recent |
%AppData%\Microsoft\Windows\Recent\  
= C:\Users\<username>\AppData\Roaming\Microsoft\Windows\Recent

 

User folder

| Open the Recycle Bin  | shell:RecycleBinFolder |
"Recycle Bin"

System folder

  

| Open the Windows Resources folder (themes are stored here)  | shell:ResourceDir |
%SystemRoot%\Resources\ = C:\Windows\Resources

System folder

  

| Display the user's Ringtones folder  | shell:Ringtones |
%LocalAppData%\Microsoft\Windows\Ringtones\  
= C:\Users\<username>\AppData\Local\Microsoft\Windows\Ringtones

 

User folder  

| Open the Public ringtones folder.  | shell:CommonRingtones |
%ProgramData%\Microsoft\Windows\Ringtones\  
=C:\ProgramData\Microsoft\Windows\Ringtones

System folder

  

| Open the Saved Games folder  | shell:SavedGames |
%UserProfile%\Saved Games\ = C:\Users\<username>\Saved Games

 

User folder

| Open the saved searches folder  | shell:Searches |
%UserProfile%\Searches\ = C:\Users\<username>\Searches

 

User folder

| Open the Windows Search tool  | shell:SearchHomeFolder |
Windows Explorer Search box

System folder

  

| Open the user’s Send To folder  | shell:SendTo |
%AppData%\Microsoft\Windows\SendTo\  
= C:\Users\<username>\AppData\Roaming\Microsoft\Windows\SendTo

 

User folder

| Open the user’s Start Menu folder  | shell:[Start Menu](syntax-folders.html) |
%AppData%\Microsoft\Windows\Start Menu\  
= C:\Users\<username>\AppData\Roaming\Microsoft\Windows\Start Menu

 

User folder

| Open the Public Start Menu folder  | shell:Common [Start Menu](syntax-folders.html) |
%ProgramData%\Microsoft\Windows\Start Menu\  
=C:\ProgramData\Microsoft\Windows\Start Menu

System folder

  

| Open the user’s Startup folder  | shell:Startup |
%AppData%\Microsoft\Windows\Start Menu\Programs\Startup\  
= C:\Users\<username>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup

 

User folder

| Open the Public Startup folder  | shell:Common Startup |
%ProgramData%\Microsoft\Windows\Start Menu\Programs\Startup\  
=C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup

System folder

  

| Display Sync Centre  | shell:SyncCenterFolder |
Control Panel ➞ Sync Centre

Windows Sync Centre

  

| Display Sync Centre Conflicts  | shell:ConflictFolder |
Control Panel ➞ Sync Conflicts

Windows Sync Centre

  

| Display Sync Centre Results  | shell:SyncResultsFolder |
Control Panel ➞ Sync Results

Windows Sync Centre

  

| Open the Sync Centre Setup options  | shell:SyncSetupFolder |
Control Panel ➞ Setup new Sync Partnerships

Windows Sync Centre

  

| Open the Windows System folder  | shell:System |
%SystemRoot%\System32\ = C:\Windows\System32

System folder

  

Open the Windows System folder for 32-bit files on 64-bit Windows,  
| Or \Windows\System32 on 32-bit Windows  | shell:Systemx86 |
%SystemRoot%\SysWOW64\ = C:\Windows\SysWOW64

System folder

  

| Open the user’s Templates folder  | shell:Templates |
%AppData%\Microsoft\Windows\Templates\  
= C:\Users\<username>\AppData\Roaming\Microsoft\Windows\Templates

 

User folder

| Open the Public Templates folder  | shell:Common Templates |
%ProgramData%\Microsoft\Windows\Templates\  
=C:\ProgramData\Microsoft\Windows\Templates

System folder

  

| Display further user tiles  | shell:Roaming Tiles |
%LocalAppData%\Microsoft\Windows\Roaming Tiles\  
= C:\Users\<username>\AppData\Local\Microsoft\Windows\RoamingTiles

 

User folder

| Display your user tiles (the images you can use for your account)  | shell:UserTiles |
%UserProfile%\AppData\Roaming\Microsoft\Windows\AccountPictures\  
= C:\Users\<username>\AppData\Roaming\Microsoft\Windows\AccountPictures

 

User folder  

| Open the Public user tiles folder  | shell:PublicUserTiles |
%ProgramData%\Microsoft\User Account Pictures\  
= C:\ProgramData\Microsoft\User Account Pictures\

System folder

  

| Open the user’s Videos folder  | shell:My Video |
%UserProfile%\Videos\ = C:\Users\<username>\Videos

 

User folder

| Open the Public Video folder  | shell:CommonVideo |
%Public%\Videos\ = C:\Users\Public\Videos

Multimedia

  

| Open the Sample Videos folder  | shell:SampleVideos |
%Public%\Videos\Sample Videos\ = C:\Users\Public\Videos\Sample videos

Multimedia

  

| Open the Windows installation folder (usually \Windows)  | shell:Windows |
[%SystemRoot%](syntax-variables.html) = C:\Windows

System folder

  

Unless indicated otherwise, all the shortcuts above work in all versions of Windows from Vista upwards.

Command Line
------------

> From the command line shell: shortcuts can be passed to [Explorer.exe](explorer.html):  
> C:> explorer.exe shell:desktop
> 
> You can also pass a [variable](syntax-variables.html) or string:
> 
> C:> explorer.exe %ProgramFiles%
> 
> The [START](start.html) command also accepts shell: shortcuts with spaces but they have to be quoted like so:
> 
> C:> start "" "shell:my music"
> 
> C:> start "" %UserProfile%\Music\
> 
> In PowerShell:  
> [Environment]::GetFolderPath('MyVideos')  
> Where 'MyVideos' may be any of the constants defined under: [Enum]::GetNames([System.Environment+SpecialFolder])

Shortcuts
---------

> To create a shortcut to any of the shell folders above: Right click the Desktop > New Shortcut and set the location/target to explorer.exe followed by the shell:_option_  
> For example:
> 
>   explorer.exe shell:PrintersFolder
> 
> Alternatively you can use a variable/string:
> 
>   explorer.exe "%ProgramData%\Microsoft\Windows\Start Menu\"
> 
> Non admin users will find it difficult to create a Shell: shortcut directly on the Task bar, it can be done but requires creating the shortcut in: %USERPROFILE%\AppData\Roaming\Microsoft\Internet Explorer\Quick Launch\User Pinned\TaskBar  
> It can then be dragged into the taskbar.
> 
> Create a 'God mode' shortcut (a full set of Control Panel options) by setting the shortcut target to:
> 
> %WinDir%\explorer.exe shell:::{ED7BA470-8E54-465E-825C-99712043E01C}

“You go away for a long time and return a different person - you never come all the way back” ~ Paul Theroux

### Related commands

How-to: [ms-settings](syntax-settings.html) - Shortcuts to settings.  
How-to: [RUN commands](run.html) Start ➞ Run commands.  
[EXPLORER](explorer.html) - Open Windows Explorer.  
How-to: [User Shell Folders - Profile, Start Menu](syntax-folders.html) - Location of user profile folders.  
How-to: [Env. Variables](syntax-variables.html) - List of environment variables.



/. nt/syntax-folders.html
========================================================

    User Shell Folders - Windows CMD - SS64.com

How-to: Enumerate _User Shell Folders_ to determine the Profile/Start Menu folder locations.
============================================================================================

Roaming Profile Folder Extensions
---------------------------------

> OS version
> 
> Local Profile folder %userprofile%
> 
> Roaming Profile Folder
> 
> Windows XP/ 2003
> 
> C:\Documents and Settings_username_
> 
> _fileshare__username_
> 
> Windows Vista /7
> 
> C:\Users_username_
> 
> _fileshare__username_.**V2**
> 
> Windows 10 (2015)
> 
> C:\Users_username_
> 
> _fileshare__username_.V5
> 
> Windows 10 Anniversary Edition (2016) and newer
> 
> C:\Users_username_
> 
> _fileshare__username_.**V6**

Profile Subfolders
------------------

> The folders for _Personal/Profile_ settings in Windows 10 / 2012 R2 and later:
> 
> %USERPROFILE%\AppData\Roaming
> %USERPROFILE%\AppData\Local\Microsoft\Windows**INetCookies**
> %USERPROFILE%\AppData\Local\Microsoft\Windows\History
> %USERPROFILE%\AppData\Local
> %USERPROFILE%\Documents
> %USERPROFILE%\AppData\Roaming\Microsoft\Windows\Network Shortcuts
> %USERPROFILE%\AppData\Roaming\Microsoft\Windows\Printer Shortcuts
> %USERPROFILE%\AppData\Roaming\Microsoft\Windows**Recent Items**
> %USERPROFILE%\AppData\Roaming\Microsoft\Windows\SendTo
> %USERPROFILE%\AppData\Roaming\Microsoft\Windows\Start Menu
> %USERPROFILE%\AppData\Roaming\Microsoft\Windows\Templates
> %USERPROFILE%\AppData\Local\Microsoft\Windows**INetCache**

'All Users' Shell Folders
-------------------------

> The folders for _All Users_ settings in Windows 10 / 2012 R2 and later:
> 
> %ProgramData%
> %ProgramData%\Microsoft\Windows\Start Menu\Programs  *
> %ProgramData%\Microsoft\Windows\Start Menu  *
> %ProgramData%\Microsoft\Windows\Start Menu\Programs\Startup  *
> %ProgramData%\Microsoft\Windows\Templates  
> %PUBLIC%**Public Desktop**
> %PUBLIC%**Public Documents**

PowerShell:
-----------

> In PowerShell we can retrieve many of these from the list of Environment[.SpecialFolders](https://docs.microsoft.com/en-us/dotnet/api/system.environment.specialfolder?view=netcore-3.1)
> 
> $myDesktop = [Environment]::GetFolderPath('Desktop')  
> $myDocs = [environment]::getfolderpath('mydocuments')  
> $myPrograms = [environment]::getfolderpath('Programs')  
> $myRecent = [environment]::getfolderpath('Recent')  
> $mySendTo = [environment]::getfolderpath('SendTo')  
> $myStartMenu = [environment]::getfolderpath('StartMenu')
> 
> $commonDesktop = [environment]::getfolderpath('CommonDesktopDirectory')  
> $commonDocuments = [environment]::getfolderpath('CommonDocuments')  
> $commonPrograms = [environment]::getfolderpath('CommonPrograms')  
> $commonStartMenu = [environment]::getfolderpath('CommonStartMenu')  
> $commonStartUp = [environment]::getfolderpath('CommonStartup')
> 
> You can also Get or Set the Special Folders with [a script](https://stackoverflow.com/questions/25709398/set-location-of-special-folders-with-powershell).

Start Menu Folders*
--------------------

> Your Start Menu: %AppData%\Microsoft\Windows\Start Menu\Programs  
> Typically: C:\Users_YourUsername_\AppData\Microsoft\Windows\Start Menu\Programs  
>   
> All users Start Menu: %ProgramData%\Microsoft\Windows\Start Menu\Programs  
> Typically: C:\ProgramData\Microsoft\Windows\Start Menu\Programs
> 
> In Windows 10 the Start Menu shortcuts are automatically copied into a [database](https://arstechnica.com/gadgets/2015/07/review-windows-10-is-the-best-version-yet-once-the-bugs-get-fixed/) via a background service to improve performance. The database is also used for Cortana Search. Any non-shortcut files in the start menu folders are ignored.  
> This database is stored under C:\Users_accountname_\AppData\Local\TileDataLayer this is proprietary, non user editable and limited to 512 shortcuts.  
> The entire database can be copied between accounts, along with all the shortcuts, this is a not very flexible 'all or nothing' option.

Making changes via Group Policy or PowerShell
---------------------------------------------

> There are definitions for all the above in the registry, however: _I implore you to exercise restraint and not rely on this new key. Just use the function SHGetFolderPath, which returns the path to whatever folder you want. Let the "User Shell Folders" key rest in peace._ - [Raymond Chen](https://devblogs.microsoft.com/oldnewthing/?p=41973) (MSFT)
> 
> To modify these values, either use Group Policy (User Configuration ➞ Windows Settings ➞ Folder Redirection)  
> or the PowerShell functions: [Get-KnownFolderPath & Set-KnownFolderPath](../ps/syntax-knownfolders.html) which use _SHGetFolderPath_.  
> These use the latest [Known FolderID constants](https://docs.microsoft.com/en-us/windows/win32/shell/knownfolderid#constants) (GUIDs) and so work for ALL the Special folders.
> 
> The older [ShellSpecialFolderConstants](https://docs.microsoft.com/en-gb/windows/desktop/api/shldisp/ne-shldisp-shellspecialfolderconstants) do still work but only contain a subset of the Special Folders. Here are a couple of [PowerShell](shell-folders-ps.txt) and [VBScript](shell-folders-vbs.txt) examples which just echo the values. There are some differences in the names, the old Special Folder constant 'Personal' is now known as 'Documents' (though the registry key is still called 'Personal').
> 
> If you must delve into the Registry here are the locations, again the sub keys may vary by [locale/language](../locale.html):
> 
> > Registry locations (REG_EXPAND_SZ)  
> > HKEY_**CURRENT_USER**\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders
> > 
> > By default these all resolve to subfolders below %USERPROFILE%.
> > 
> > Registry locations for ALL Users (REG_EXPAND_SZ)  
> > HKEY_**LOCAL_MACHINE**\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders
> > 
> > On a brand new install of Windows some of the keys may not exist (typically the fonts entry) Registry entries can appear in both the older Shell Folders subkey and the User Shell Folders in both HKLM and HKCU. The entries that appear in User Shell Folders take precedence over those in Shell Folders. Which is maintained for backwards compatibility with Windows NT 4.  
> > The entries that appear in HKCU take precedence over those in HKLM.

Folder Redirection
------------------

> Although it is possible to redirect any of these folders with Group Policy, not all options are fully supported,  
> for example redirecting favorites/cookies will result in [very slow](https://devblogs.microsoft.com/oldnewthing/?p=593) performance.

### Examples

Find the location of the Start Menu folder in CMD:

For /f "tokens=3*" %%G in ('[REG QUERY](reg.html) "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders" /v "Start Menu" ^|Find "REG_"') do Call Set _startmenu=%%H  
Echo %_startmenu%

“There are no shortcuts to any place worth going” ~ Beverly Sills

### Related commands

How-to: [Shell: folder](shell.html) shortcuts to key folders.  
How-to: [Windows Environment Variables](syntax-variables.html)  
[RoamingProfile.vbs](../vb/syntax-profile.html) - Cleardown files to improve logon and logoff times.  
PowerShell: [Get-StartApps](../ps/get-startapps.html) - Get the names and IDs of apps installed on the Start Menu.  
[WshShell.SpecialFolders](../vb/special.html) - VBScript to obtain the path to special Windows folders.  
[Managing Roaming User Data Deployment Guide](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-vista/cc766489(v=ws.10)) - docs.microsoft.com  
[Q886549](https://support.microsoft.com/en-gb/help/886549/) - User Shell Folders.



/. nt/syntax-run.html
========================================================

    How to Run a script - Windows CMD - SS64.com

How-to: Create and Run a CMD batch file
=======================================

To prepare a new batch script, save the file as plain ASCII text with the file extension .CMD

It is also possible to run batch scripts with the .BAT extension, but this is not recommended unless you need compatibility with Windows 95 (.BAT files will set [ERRORLEVEL](errorlevel.html) following inconsistent MS-DOS style rules).

Run a batch file
----------------

> A batch file can be run by double clicking it in Windows explorer, or by typing the name/path at the command line, optionally passing any [parameters](syntax-args.html) needed.
> 
> From the start menu: START ➞ RUN c:\path_to_scripts\my_script.cmd, OK
> 
> If the filename includes any spaces, then you will need to surround the command with quotes:
> 
> "c:\path to scripts\my script.cmd"
> 
> Open a new CMD prompt by choosing START ➞ RUN cmd, OK
> 
> From the command line, enter the name of the script and press return.  
>   
> C:\Batch> Demo.cmd  
> or  
> C:\Batch> c:\path_to_scripts\my_script.cmd param1 param2
> 
> This can be made easier by creating a [shortcut](shortcut.html) for the start menu or taskbar.
> 
> To run a batch file from within another batch file, use the [CALL](call.html) command, otherwise the first script will start the second script and immediately exit, so any further commands in the first script will not run.

View the startup command line
-----------------------------

> The environment Variable %CmdCmdLine% will expand into the original command line passed to CMD.EXE
> 
> When a batch file is launched from the command line %CmdCmdLine% will return:  
> C:\WINDOWS\system32\cmd.exe _param1_
> 
> When a batch file is launched by double clicking in Windows Explorer or START ➞ RUN, %CMDCMDLINE% will return:  
> C:\WINDOWS\system32\cmd.exe **/c** ""C:\demo\batch.cmd _param1_
> 
> The /c can be used to detect the start mode:  
> Echo %CmdCmdLine% | findstr /c:" /c " >nul && Echo Started with a double click.

Run a PowerShell script
-----------------------

> To run a PowerShell script from the CMD shell:
> 
> C:> powershell -file "c:\batch\demo.ps1"
> 
> With arguments:  
> 
> C:> powershell -file "c:\batch\demo.ps1" filename1.txt Testing
> 
> If the arguments need quotes you will need to triple them so they are escaped:  
> 
> C:> powershell -file "c:\batch\demo.ps1" """\Path To\filename1.txt""" """A Test string"""
> 
> When calling PowerShell from CMD be aware that a comma is a CMD delimiter, this makes it [impossible](https://stackoverflow.com/questions/48957580/passing-string-from-batch-file-which-contains-double-quotes-to-powershell) to pass an array of comma separated values to PowerShell. item1,item2,item3 is treated the same as item1 item2 item3

Run a VBScript file
-------------------

> To run a VBScript from the CMD shell:
> 
> C:> cscript c:\batch\demo.vbs

“The method of the enterprising is to plan with audacity and execute with vigor” ~ John Christian Bovee

### Related commands

[START](start.html) - Start a program, command or batch file.  
How-to: [Run with elevated permissions](syntax-elevate.html) "As Admin"  
[RUN commands](run.html) Start ➞ Run commands.  
How-to: [Run a script from PowerShell](../ps/syntax-run.html)  
How-to: [Run a script from VBScript](../vb/syntax-run.html)



/. nt/syntax-banner.html
========================================================

    Banner Text - Windows CMD - SS64.com 

How-to: Display a string of text in extra large letters - Banner.cmd
====================================================================

Display a string of text in extra large letters, similar to banner printing on a dot matrix printer.  
This can be useful when you need to read the output from a distance. or to flag an error.

To generate a fixed message, run the script below and then copy the output, prefixing each of the 7 lines with [ECHO](echo.html).

Sample:

 Echo #### ###  ###   ##  ### 
 Echo #    #  # #  # #  # #  #
 Echo #    #  # #  # #  # #  #
 Echo ###  ###  ###  #  # ### 
 Echo #    # #  # #  #  # # # 
 Echo #    #  # #  # #  # #  #
 Echo #### #  # #  #  ##  #  #


@Echo off&SETLOCAL
IF [%1] NEQ [] goto s_start
Echo   Syntax  
Echo       BANNER _string_
Echo           Where _string_ is the text or numbers to be displayed
Echo:
GOTO :eof
    :s_start
      SET _length=0
      SET _sentence=%*

      :: Get the length of the sentence
      SET _substring=%_sentence%
    :s_loop
      IF not defined _substring GOTO :s_result
      ::remove the first char from _substring (until it is null)
      SET _substring=%_substring:~1%
      SET /A _length+=1
      GOTO s_loop
      
    :s_result
      SET /A _length-=1

      :: Truncate text to fit the window size
      :: assuming average char is 6 digits wide
      for /f "tokens=2" %%G in ('mode ^|find "Columns"') do set/a _window=%%G/6
      IF %_length% GTR %_window% set _length=%_window% 

      :: Step through each digit of the sentence and store in a set of variables
      FOR /L %%G IN (0,1,%_length%) DO call :s_build %%G

    :: Now Echo all the variables
    Echo:
    Echo:%_1%
    Echo:%_2%
    Echo:%_3%
    Echo:%_4%
    Echo:%_5%
    Echo:%_6%
    Echo:%_7%
    Echo:
    GOTO :EOF

    :s_build
      :: get the next character
      CALL SET _digit=%%_sentence:~%1,1%%%
      :: Add the graphics for this digit to the variables
      IF "%_digit%"==" " (CALL :s_space) ELSE (CALL :s_%_digit%)
    GOTO :EOF
   
    :s_0
    ::  Pad digits to -->< this ensures the next digit will align.
      (SET _1=%_1% ####)
      (SET _2=%_2% #  #)
      (SET _3=%_3% #  #)
      (SET _4=%_4% #  #)
      (SET _5=%_5% #  #)
      (SET _6=%_6% #  #)
      (SET _7=%_7% ####)
    GOTO :EOF
   
    :s_1
      (SET _1=%_1%  ## )
      (SET _2=%_2%   # )
      (SET _3=%_3%   # )
      (SET _4=%_4%   # )
      (SET _5=%_5%   # )
      (SET _6=%_6%   # )
      (SET _7=%_7% ####)
    GOTO :EOF
   
    :s_2
      (SET _1=%_1% ####)
      (SET _2=%_2% #  #)
      (SET _3=%_3%    #)
      (SET _4=%_4% ####)
      (SET _5=%_5% #   )
      (SET _6=%_6% #  #)
      (SET _7=%_7% ####)
    GOTO :EOF
   
    :s_3
      (SET _1=%_1% ####)
      (SET _2=%_2%    #)
      (SET _3=%_3%    #)
      (SET _4=%_4% ####)
      (SET _5=%_5%    #)
      (SET _6=%_6%    #)
      (SET _7=%_7% ####)
    GOTO :EOF
   
    :s_4
      (SET _1=%_1% #  #)
      (SET _2=%_2% #  #)
      (SET _3=%_3% #  #)
      (SET _4=%_4% ####)
      (SET _5=%_5%    #)
      (SET _6=%_6%    #)
      (SET _7=%_7%    #)
    GOTO :EOF
   
    :s_5
      (SET _1=%_1% ####)
      (SET _2=%_2% #   )
      (SET _3=%_3% #   )
      (SET _4=%_4% ####)
      (SET _5=%_5%    #)
      (SET _6=%_6% #  #)
      (SET _7=%_7% ####)
    GOTO :EOF
   
    :s_6
      (SET _1=%_1% ##  )
      (SET _2=%_2% #   )
      (SET _3=%_3% #   )
      (SET _4=%_4% ####)
      (SET _5=%_5% #  #)
      (SET _6=%_6% #  #)
      (SET _7=%_7% ####)
    GOTO :EOF
   
    :s_7
      (SET _1=%_1% ####)
      (SET _2=%_2% #  #)
      (SET _3=%_3%    #)
      (SET _4=%_4%   ##)
      (SET _5=%_5%   # )
      (SET _6=%_6%   # )
      (SET _7=%_7%   # )
    GOTO :EOF
   
    :s_8
      (SET _1=%_1% ####)
      (SET _2=%_2% #  #)
      (SET _3=%_3% #  #)
      (SET _4=%_4% ####)
      (SET _5=%_5% #  #)
      (SET _6=%_6% #  #)
      (SET _7=%_7% ####)
    GOTO :EOF
   
    :s_9
      (SET _1=%_1% ####)
      (SET _2=%_2% #  #)
      (SET _3=%_3% #  #)
      (SET _4=%_4% ####)
      (SET _5=%_5%    #)
      (SET _6=%_6%    #)
      (SET _7=%_7%    #)
    GOTO :EOF
   
    :s_-
      (SET _1=%_1%     )
      (SET _2=%_2%     )
      (SET _3=%_3%     )
      (SET _4=%_4% ####)
      (SET _5=%_5%     )
      (SET _6=%_6%     )
      (SET _7=%_7%     )
    GOTO :EOF
   
    :s_.
      (SET _1=%_1%     )
      (SET _2=%_2%     )
      (SET _3=%_3%     )
      (SET _4=%_4%     )
      (SET _5=%_5%     )
      (SET _6=%_6%     )
      (SET _7=%_7%  #  )
    GOTO :EOF
   
    :s_a
      (SET _1=%_1%  ## )
      (SET _2=%_2% #  #)
      (SET _3=%_3% #  #)
      (SET _4=%_4% ####)
      (SET _5=%_5% #  #)
      (SET _6=%_6% #  #)
      (SET _7=%_7% #  #)
    GOTO :EOF
   
    :s_b
    ::  Pad digits to -->
      (SET _1=%_1% ### )
      (SET _2=%_2% #  #)
      (SET _3=%_3% #  #)
      (SET _4=%_4% ####)
      (SET _5=%_5% #  #)
      (SET _6=%_6% #  #)
      (SET _7=%_7% ### )
    GOTO :EOF
   
    :s_c
      (SET _1=%_1%  ## )
      (SET _2=%_2% #  #)
      (SET _3=%_3% #   )
      (SET _4=%_4% #   )
      (SET _5=%_5% #   )
      (SET _6=%_6% #  #)
      (SET _7=%_7%  ## )
    GOTO :EOF
   
    :s_d
      (SET _1=%_1% ### )
      (SET _2=%_2% #  #)
      (SET _3=%_3% #  #)
      (SET _4=%_4% #  #)
      (SET _5=%_5% #  #)
      (SET _6=%_6% #  #)
      (SET _7=%_7% ### )
    GOTO :EOF
   
    :s_e
      (SET _1=%_1% ####)
      (SET _2=%_2% #   )
      (SET _3=%_3% #   )
      (SET _4=%_4% ### )
      (SET _5=%_5% #   )
      (SET _6=%_6% #   )
      (SET _7=%_7% ####)
    GOTO :EOF
   
    :s_f
      (SET _1=%_1% ####)
      (SET _2=%_2% #   )
      (SET _3=%_3% #   )
      (SET _4=%_4% ### )
      (SET _5=%_5% #   )
      (SET _6=%_6% #   )
      (SET _7=%_7% #   )
    GOTO :EOF

    :s_g
      (SET _1=%_1%  ## )
      (SET _2=%_2% #  #)
      (SET _3=%_3% #   )
      (SET _4=%_4% #   )
      (SET _5=%_5% # ##)
      (SET _6=%_6% #  #)
      (SET _7=%_7%  ## )
    GOTO :EOF

    :s_h
      (SET _1=%_1% #  #)
      (SET _2=%_2% #  #)
      (SET _3=%_3% #  #)
      (SET _4=%_4% ####)
      (SET _5=%_5% #  #)
      (SET _6=%_6% #  #)
      (SET _7=%_7% #  #)
    GOTO :EOF

    :s_i
      (SET _1=%_1%  # )
      (SET _2=%_2%  # )
      (SET _3=%_3%  # )
      (SET _4=%_4%  # )
      (SET _5=%_5%  # )
      (SET _6=%_6%  # )
      (SET _7=%_7%  # )
    GOTO :EOF

    :s_j
      (SET _1=%_1% ####)
      (SET _2=%_2%   # )
      (SET _3=%_3%   # )
      (SET _4=%_4%   # )
      (SET _5=%_5%   # )
      (SET _6=%_6%   # )
      (SET _7=%_7% ##  )
    GOTO :EOF

    :s_k
      (SET _1=%_1% #   )
      (SET _2=%_2% #  #)
      (SET _3=%_3% # # )
      (SET _4=%_4% ##  )
      (SET _5=%_5% ##  )
      (SET _6=%_6% # # )
      (SET _7=%_7% #  #)
    GOTO :EOF

    :s_l
      (SET _1=%_1% #   )
      (SET _2=%_2% #   )
      (SET _3=%_3% #   )
      (SET _4=%_4% #   )
      (SET _5=%_5% #   )
      (SET _6=%_6% #   )
      (SET _7=%_7% ####)
    GOTO :EOF

    :s_m
      (SET _1=%_1% #   #)
      (SET _2=%_2% ## ##)
      (SET _3=%_3% # # #)
      (SET _4=%_4% # # #)
      (SET _5=%_5% #   #)
      (SET _6=%_6% #   #)
      (SET _7=%_7% #   #)
    GOTO :EOF

    :s_n
      (SET _1=%_1% #   #)
      (SET _2=%_2% ##  #)
      (SET _3=%_3% ##  #)
      (SET _4=%_4% # # #)
      (SET _5=%_5% #  ##)
      (SET _6=%_6% #  ##)
      (SET _7=%_7% #   #)
    GOTO :EOF

    :s_o
      (SET _1=%_1%  ## )
      (SET _2=%_2% #  #)
      (SET _3=%_3% #  #)
      (SET _4=%_4% #  #)
      (SET _5=%_5% #  #)
      (SET _6=%_6% #  #)
      (SET _7=%_7%  ## )
    GOTO :EOF

    :s_p
      (SET _1=%_1% ### )
      (SET _2=%_2% #  #)
      (SET _3=%_3% #  #)
      (SET _4=%_4% ### )
      (SET _5=%_5% #   )
      (SET _6=%_6% #   )
      (SET _7=%_7% #   )
    GOTO :EOF

    :s_q
      (SET _1=%_1%  ## )
      (SET _2=%_2% #  #)
      (SET _3=%_3% #  #)
      (SET _4=%_4% #  #)
      (SET _5=%_5% #  #)
      (SET _6=%_6% # ##)
      (SET _7=%_7%  # #)
    GOTO :EOF

    :s_r
      (SET _1=%_1% ### )
      (SET _2=%_2% #  #)
      (SET _3=%_3% #  #)
      (SET _4=%_4% ### )
      (SET _5=%_5% # # )
      (SET _6=%_6% #  #)
      (SET _7=%_7% #  #)
    GOTO :EOF

    :s_s
      (SET _1=%_1%  ###)
      (SET _2=%_2% #   )
      (SET _3=%_3% #   )
      (SET _4=%_4%  ## )
      (SET _5=%_5%    #)
      (SET _6=%_6%    #)
      (SET _7=%_7% ### )
    GOTO :EOF

    :s_t
      (SET _1=%_1% ###)
      (SET _2=%_2%  # )
      (SET _3=%_3%  # )
      (SET _4=%_4%  # )
      (SET _5=%_5%  # )
      (SET _6=%_6%  # )
      (SET _7=%_7%  # )
    GOTO :EOF

    :s_u
      (SET _1=%_1% #  #)
      (SET _2=%_2% #  #)
      (SET _3=%_3% #  #)
      (SET _4=%_4% #  #)
      (SET _5=%_5% #  #)
      (SET _6=%_6% #  #)
      (SET _7=%_7%  ## )
    GOTO :EOF

    :s_v
      (SET _1=%_1% #   #)
      (SET _2=%_2% #   #)
      (SET _3=%_3% #   #)
      (SET _4=%_4% #   #)
      (SET _5=%_5% #   #)
      (SET _6=%_6%  # # )
      (SET _7=%_7%   #  )
    GOTO :EOF

    :s_w
      (SET _1=%_1% #  #  #)
      (SET _2=%_2% #  #  #)
      (SET _3=%_3% #  #  #)
      (SET _4=%_4% #  #  #)
      (SET _5=%_5% #  #  #)
      (SET _6=%_6% #  #  #)
      (SET _7=%_7%  ## ## )
    GOTO :EOF

    :s_x
      (SET _1=%_1%      )
      (SET _2=%_2% #   #)
      (SET _3=%_3%  # # )
      (SET _4=%_4%   #  )
      (SET _5=%_5%   #  )
      (SET _6=%_6%  # # )
      (SET _7=%_7% #   #)
    GOTO :EOF

    :s_y
      (SET _1=%_1% #   #)
      (SET _2=%_2%  # # )
      (SET _3=%_3%   #  )
      (SET _4=%_4%   #  )
      (SET _5=%_5%   #  )
      (SET _6=%_6%   #  )
      (SET _7=%_7%   #  )
    GOTO :EOF

    :s_z
      (SET _1=%_1% #####)
      (SET _2=%_2%     #)
      (SET _3=%_3%    # )
      (SET _4=%_4%   #  )
      (SET _5=%_5%  #   )
      (SET _6=%_6% #    )
      (SET _7=%_7% #####)
    GOTO :EOF

    :s_space
      (SET _1=%_1%      )
      (SET _2=%_2%      )
      (SET _3=%_3%      )
      (SET _4=%_4%      )
      (SET _5=%_5%      )
      (SET _6=%_6%      )
      (SET _7=%_7%      )
    GOTO :EOF

_“No matter how sophisticated you may be, a large granite mountain cannot be denied - it speaks in silence to the very core of your being” ~ Ansel Adams_

### Related commands

How-to: [Display DPI](syntax-dpi.html) - Monitor size settings.  
[ECHO](echo.html) - Display message on screen.  
[FIGlet](http://www.figlet.org/) - A cross-platform program for making large letters out of ordinary text ([fonts](https://github.com/xero/figlet-fonts)).



/. nt/syntax-elevate.html
========================================================

    Run with elevated permissions UAC - Windows CMD - SS64.com

How-to: Run with elevated permissions
=====================================

> The CMD shell, [START](start.html) and [RUNAS](runas.html) commands have no built-in options to elevate or run individual commands 'As Admin' (elevated).
> 
> When using the Start Menu, hold down [Shift+Ctrl](syntax-keyboard.html) when launching an application to launch it 'As Admin' (elevated) this has the same effect as if you right click and select Run as local Administrator.
> 
> To run an item on the Start menu / Search /Desktop elevated, select it and then press Ctrl+Shift+Enter on the keyboard.
> 
> It is also possible to right click CMD.exe (or it's Start menu shortcut) and run a new session 'As Admin'.
> 
> Shortcuts can be edited to always run as Admin via Properties ➞ Shortcut ➞ Advanced ➞ then tick ▢ Run as administrator.
> 
> To elevate from the command line will require running either [VBScript](../vb/syntax-elevate.html) or [PowerShell](../ps/syntax-elevate.html), this does not have to involve completely rewriting existing scripts, you can use a couple of lines of either VBScript or PowerShell to launch an elevated CMD.exe and that will run a batch file elevated.
> 
> Another approach is to use a third party utility that will elevate permissions.
> 
> When a script is run with elevated permissions several aspects of the user environment will change: The [current directory](../nt/cd.html), the current TEMP folder and any mapped drives will be disconnected.

Testing for Elevation
---------------------

> Testing if the current session is elevated can be done with the FSUTIL command (via [StackOverflow](https://stackoverflow.com/a/21295806/1720814)).  
> Just paste the following into the top of your batch file:  
> 
> fsutil dirty query %SYSTEMDRIVE% >nul 2>&1
> If %errorLevel% NEQ 0 (
>    Echo Failure, please rerun this script from an elevated command prompt. Exiting...
>    Ping 127.0.0.1 2>&1 > nul
>    Exit /B 1
> ) 
> Echo Success: this script is running elevated.
> 
> An alternative method is to run [CACLS](cacls.html) agains a protected folder, either method will work on both 32 and [64 bit](syntax-64bit.html) systems/processes:
> 
> "%SYSTEMROOT%\system32\cacls.exe" "%SYSTEMROOT%\system32\config\system" >nul 2>&1
> If %errorLevel% NEQ 0 (
>    Echo Failure, please rerun this script from an elevated command prompt. Exiting...
>    Ping 127.0.0.1 2>&1 > nul
>    Exit /B 1
> ) 
> Echo Success: this script is running elevated.
> 
> To prompt the user to immediately elevate the script and then continue [here](../vb/syntax-elevate.html) is a small VBScript that will do that.

Run without Elevation
---------------------

> In some cases you may wish to run an application without elevation, this will restrict what the application can do.
> 
> The undocumented [environment](syntax-variables.html#undocumented) variable __COMPAT_LAYER can be used to lower the ExecutionLevel to RunAsInvoker
> 
> @Echo Off  
> SETLOCAL  
> Set __COMPAT_LAYER=RunAsInvoker  
> regedit.exe
> 
> The example above will run [REGEDIT](regedit.html) using the user's native permissions, attempting to modify any protected area of the registry (such as HKLM) within this session will produce an error. Without this, by default Regedit will run elevated.

Setting the current directory
-----------------------------

> When a script is elevated, it runs in a new elevated session and the script current directory will default to \Windows\System32\
> 
> When writing a script that will be elevated, either hard code the path to any files that you reference, or use pushd "[%~dp0](syntax-args.html)" at the start of the script to set the current directory to the location of the .ps1 script.

Scheduled Tasks
---------------

> If a scheduled task invokes a UAC prompt, then the task will fail to run unattended.  
> To run a task elevated, select the check box 'Run With Highest Privileges':
> 
> ![Elevate Scheduled task](elevate.png)

“A man in public life expects to be sneered at – it is the fault of his elevated situation, and not of himself” ~ Charles Dickens

### Related commands

How-to: [Compatibility](syntax-compatibility.html) - Backwards compatibility - runas admin / color - this can also force elevation.  
[ShellRunAs](shellrunas.html) - Run a command under a different user account (SysInternals).  
PowerShell: [Run with Elevated Permissions](../ps/syntax-elevate.html)  
VBScript: [Run with Elevated Permissions](../vb/syntax-elevate.html)  
[SS64 Forum thread](https://ss64.org/viewtopic.php?t=40) on UAC detection.  
[Why can’t I bypass the UAC prompt?](https://web.archive.org/web/20130720015150/http://blogs.msdn.com/b/aaron_margosis/archive/2007/06/29/faq-why-can-t-i-bypass-the-uac-prompt.aspx) - Aaron Margosis.  
Technet [Elevation blog](https://docs.microsoft.com/en-us/archive/blogs/elevationpowertoys/) (2010)  
[elevate](https://code.kliu.org/misc/elevate/) - Command-Line UAC Elevation Utility.



/. nt/syntax-datemath.html
========================================================

    Date Math - Add or subtract days - Windows CMD - SS64.com

How-to: Add or subtract days from any date - DateMath.cmd
=========================================================

To add or subtract days from any date, copy the script below or download [here](datemath.txt) and save as DateMath.cmd

    @ECHO off
    SETLOCAL
    :: DateMath, a general purpose date math routine
   
    :: If DateMath detects an error, variable _dd_int is set to 999999.
    SET v_dd_int=0
    SET v_mm_int=0 
    SET v_yy_int=0
    SET v_ymd_str=
    SET v_mm_str=
    SET v_dd_str=
   
    IF "%3"=="" goto s_syntax
    IF "%4"=="+" goto s_validate_year
    IF "%4"=="-" goto s_validate_year
    IF "%4"=="" goto s_validate_year
   
    :s_syntax
    echo:
    echo DATEMATH SYNTAX:
    echo _______________
    echo:
    echo DateMath will set the variables as listed below
    echo 'str' variables include leading zeros e.g. "01"
    echo 'int' variables leading zeros are stripped e.g. "1"
    echo:
    echo CALL DateMath YYYY MM DD - YYYY2 MM2 DD2 
    echo:
    echo Will set variable _dd_int to the signed difference
    echo between the 2 dates (measured in days)
    echo:
    echo:
    echo CALL DateMath YYYY MM DD +/- Days 
    echo:
    echo Will set the following variables to the result of 
    echo adding or substracting days from the initial date:
    echo    _ymd_str, _yy_int
    echo    _mm_str, _mm_int,
    echo    _dd_str, _dd_int
    echo:
    echo _yy_int is in YYYY format, even if YY format was originally supplied.
    echo:

    ENDLOCAL & SET /a _dd_int=999999
    goto :eof

    :s_validate_year
    ::strip leading zeros
    SET v_yy=%1
    if %v_yy:~0,1% EQU 0 set v_yy=%v_yy:~1%

    :: Check for Y2K
    IF %v_yy% LSS 100 IF %v_yy% GEQ 80 SET /A v_yy += 1900
    IF %v_yy% LSS 80 SET /A v_yy += 2000
    
    :: at this point v_yy contains a 4 digit year

    ::validate month and day
    if %2 GTR 12 goto s_syntax
    if %3 GTR 31 goto s_syntax

    SET v_mm=%2
    SET v_dd=%3

    ::strip leading zeros
    if %v_mm:~0,1% EQU 0 set v_mm=%v_mm:~1%
    if %v_dd:~0,1% EQU 0 set v_dd=%v_dd:~1%

    :: Set the int variables
    SET /a v_dd_int=%v_dd%
    SET /a v_yy_int=%v_yy%
    SET /a v_mm_int=%v_mm%

    :: Determine which function to perform - ADD, SUBTRACT or CONVERT

    If not "%6"=="" goto s_validate_2nd_date 
    if "%4"=="" goto s_convert_only

    :: Add or subtract  days to a date
    SET /a v_number_of_days=%5
    goto s_add_or_subtract_days

    :s_convert_only

    SET /a v_dd_int=%v_dd%
    IF %v_dd% LEQ 9 (SET v_dd_str=0%v_dd%) ELSE (SET v_dd_str=%v_dd%)
    IF %v_mm% LEQ 9 (SET v_mm_str=0%v_mm%) ELSE (SET v_mm_str=%v_mm%)
    SET v_ymd_str=%v_yy%%v_mm_str%%v_dd_str%

    ECHO DATEMATH - Convert date only (no maths)
    goto s_end
    ::::::::::::::::::::::::::::::::::::::::::::::::::
   
    :s_validate_2nd_date
    If "%4"=="+" goto s_syntax
    :: Subtracting one date from another ::::::
    :: strip leading zero
    SET v_yy2=%5
    if %v_yy2:~0,1% EQU 0 set v_yy2=%v_yy2:~1%

    if %v_yy2% GTR 99 goto s_validate2nd_month
    if %v_yy2% GTR 49 goto s_prefix_2_1950_1999
    if %v_yy2% LSS 10 goto s_prefix_2_2000_2009
    SET v_yy2=20%v_yy2%
    goto s_validate2nd_month

    :s_prefix_2_2000_2009
    SET v_yy2=200%v_yy2%
    goto s_validate2nd_month

    :s_prefix_2_1950_1999
    SET v_yy2=19%v_yy2%

    :s_validate2nd_month
    ::strip leading zeros
    ::SET /a v_yy2=%v_yy2%
    if %v_yy2:~0,1% EQU 0 set v_yy2=%v_yy2:~1%
    ::v_yy2 now contains a 4 digit year

    if %6 GTR 12 goto s_syntax
    SET v_mm2=%6

    if %7 GTR 31 goto s_syntax
    SET v_dd2=%7

    ::strip leading zeros
    ::SET /a v_mm2=%v_mm2%
    if %v_mm2:~0,1% EQU 0 set v_mm2=%v_mm2:~1%
    ::SET /a v_dd2=%v_dd2%
    if %v_dd2:~0,1% EQU 0 set v_dd2=%v_dd2:~1%

    call :s_julian_day %v_yy_int% %v_mm_int% %v_dd_int%
    SET v_sumdays1=%v_JulianDay%

    call :s_julian_day %v_yy2% %v_mm2% %v_dd2%
    SET v_sumdays2=%v_JulianDay%
   
    SET /a v_dd_int=%v_sumdays1% - %v_sumdays2%
   
    ECHO DATEMATH - Subtracting one date from another = days difference
    ECHO ~~~~~~
    ECHO %v_dd_int%
    ECHO ~~~~~~
    goto s_end_days
    ::::::::::::::::::::::::::::::::::::::::::::::::::
   
    :s_add_or_subtract_days
    if /i "%4"=="+" goto s_add_up_days

    :: Subtract all days ::::::
    SET /a v_dd=%v_dd% - %v_number_of_days%
   
    :s_adjust_month_year
    if %v_dd% GEQ 1 goto s_add_subtract_days_DONE
    SET /a v_mm=%v_mm% - 1
    if %v_mm% GEQ 1 goto s_add_days_%v_mm%
    SET /a v_yy=%v_yy% - 1
    SET /a v_mm=%v_mm% + 12
    goto s_add_days_%v_mm%
   
    :s_add_days_2
    SET /a v_dd=%v_dd% + 28
    SET /a v_leapyear=%v_yy% / 4
    SET /a v_leapyear=%v_leapyear% * 4
    if %v_leapyear% NEQ %v_yy% goto s_adjust_month_year
    SET /a v_dd=%v_dd% + 1
    goto s_adjust_month_year
    
    :s_add_days_4
    :s_add_days_6
    :s_add_days_9
    :s_add_days_11
    SET /a v_dd=%v_dd% + 30
    goto s_adjust_month_year

    :s_add_days_1
    :s_add_days_3
    :s_add_days_5
    :s_add_days_7
    :s_add_days_8
    :s_add_days_10
    :s_add_days_12
    SET /a v_dd=%v_dd% + 31
    goto s_adjust_month_year
 
    :s_add_up_days
    :: add all days ::::::
    SET /a v_dd=%v_dd% + %v_number_of_days%
   
    :s_subtract_days_
    goto s_subtract_days_%v_mm%
     
    :s_adjust_mth_yr
    SET /a v_mm=%v_mm% + 1
    if %v_mm% LEQ 12 goto s_subtract_days_%v_mm%
    SET /a v_yy=%v_yy% + 1
    SET /a v_mm=%v_mm% - 12
    goto s_subtract_days_%v_mm%

    :s_subtract_days_2
    SET /a v_leapyear=%v_yy% / 4
    SET /a v_leapyear=%v_leapyear% * 4
    If %v_leapyear% EQU %v_yy% goto s_subtract_leapyear

    if %v_dd% LEQ 28 goto s_add_subtract_days_DONE
    SET /a v_dd=%v_dd% - 28
    goto s_adjust_mth_yr
   
    :s_subtract_leapyear
    if %v_dd% LEQ 29 goto s_add_subtract_days_DONE
    SET /a v_dd=%v_dd% - 29
    goto s_adjust_mth_yr
   
    :s_subtract_days_4
    :s_subtract_days_6
    :s_subtract_days_9
    :s_subtract_days_11
    if %v_dd% LEQ 30 goto s_add_subtract_days_DONE
    SET /a v_dd=%v_dd% - 30
    goto s_adjust_mth_yr

    :s_subtract_days_1
    :s_subtract_days_3
    :s_subtract_days_5
    :s_subtract_days_7
    :s_subtract_days_8
    :s_subtract_days_10
    :s_subtract_days_12
    if %v_dd% LEQ 31 goto s_add_subtract_days_DONE
    SET /a v_dd=%v_dd% - 31
    goto s_adjust_mth_yr
   
    :s_add_subtract_days_DONE
    SET /a v_dd_int=%v_dd%
    SET /a v_mm_int=%v_mm%
    SET /a v_yy_int=%v_yy%
    IF %v_dd% GTR 9 (SET v_dd_str=%v_dd%) ELSE (SET v_dd_str=0%v_dd%)
    IF %v_mm% GTR 9 (SET v_mm_str=%v_mm%) ELSE (SET v_mm_str=0%v_mm%)
    SET v_ymd_str=%v_yy%%v_mm_str%%v_dd_str%
   
    ECHO DATEMATH - add or subtract days from a date = new date
    goto s_end
    ::::::::::::::::::::::::::::::::::::::::::::::::::

    :s_julian_day
    SET v_year=%1
    SET v_month=%2
    SET v_day=%3
   
    SET /a v_month=v_month
    SET /a v_day=v_day
   
    SET /A a = 14 - v_month
    SET /A a /= 12
    SET /A y = v_year + 4800 - a
    SET /A m = v_month + 12 * a - 3
    SET /A m = 153 * m + 2
    SET /A m /= 5
    SET /A v_JulianDay = v_day + m + 365 * y + y / 4 - y / 100 + y / 400 - 32045
   
    ECHO The Julian Day is [%v_JulianDay%]
    goto :eof
    ::::::::::::::::::::::::::::::::::::::::::::::::::
   
    :s_end
    ECHO ~~~~~~~~~~~~
    ECHO [%v_ymd_str%] YY=[%v_yy_int%] MM=[%v_mm_str%] DD=[%v_dd_str%]
    ECHO ~~~~~~~~~~~~
    :s_end_days
    ENDLOCAL&SET /a _yy_int=%v_yy_int%&SET /a _mm_int=%v_mm_int%&SET /a _dd_int=%v_dd_int%&SET _ymd_str=%v_ymd_str%&SET _mm_str=%v_mm_str%&SET _dd_str=%v_dd_str%

In other languages, performing basic math on date values is much easier, PowerShell has [.addDays](../ps/syntax-variables.html), VBScript has [DateAdd](https://ss64.com/vb/dateadd.html), both of which accept negative numbers for subtractions.

### Examples

D:> datemath 2021 05 08  
DATEMATH - Convert date only (no maths)  
\~~~~~~~~~~~~  
[20210508] YY=[2021] MM=[05] DD=[08]  
\~~~~~~~~~~~~

D:> datemath 2027 12 01 - 2002 11 02  
The Julian Day is [2461741]  
The Julian Day is [2452581]  
DATEMATH - Subtracting one date from another = days difference  
\~~~~~~  
9160  
\~~~~~~

D:> datemath 2002 11 02 + 9160  
DATEMATH - add or subtract days from a date = new date  
\~~~~~~~~~~~~  
[20271201] YY=[2027] MM=[12] DD=[01]  
\~~~~~~~~~~~~

D:> datemath 2012 09 08 - 2011 09 08  
The Julian Day is [2456179]  
The Julian Day is [2455813]  
DATEMATH - Subtracting one date from another = days difference  
\~~~~~~  
366  
\~~~~~~

_“We were having one of those great first dates you can only have when it's not an actual date” ~ Sarah Jessica Parker_

### Related commands

[tdiff.cmd](syntax-tdiff.html) - Calculate the difference in Hours/Mins between two time values.  
[SetLocal](setlocal.html) - Control the visibility of environment variables in a batch file.  
How-to: [PowerShell variables](../ps/syntax-variables.html) - these support Math operations out of the box (.addDays)  
[Rules for how CMD.EXE parses numbers](https://www.dostips.com/forum/viewtopic.php?f=3&t=3758&sid=55e9f79e64b263c04396ff6c0235089b) - DosTips forum (Dave Benham).



/. nt/syntax-dequote.html
========================================================

    Dequote - remove quotes - Windows CMD - SS64.com

How-to: Remove Quotes from a string
===================================

Several routines that can be used to remove quotes from the contents of a variable.

In the majority of cases running any current version of Windows, the simplest method is to use [%~1](syntax-args.html) [Parameter Extensions](syntax-args.html) to remove the quotes automatically

    @ECHO OFF
    Set _string=%~1
    Echo the string passed to this script is %_string% 

(you may also want to test [IF the variable is empty/NULL](if.html#exist))

This is equivalent to the following, which can be used to remove _outer_ quotes from **any** string, not just a parameter string:

    :: Remove quotes
    SET _string=###%_string%###
    SET _string=%_string:"###=%
    SET _string=%_string:###"=%
    SET _string=%_string:###=%

If you just want to remove ALL quotes from a string, this can be done in one line with [variable replace](syntax-replace.html) syntax:

    Set _somevariable=%_somevariable:"=%

File and folder names cannot (legally) contain quotes so the above is often all that's needed.

A one line function, using a FOR command to run parameter expansion and remove quotes (the %~A removes the quotes), this is a good approach when you need to dequote multiple strings, just call the function with each string:

::::::::: one line Dequote example ::::::::::::  
@Echo Off  
Setlocal  
Set _mypath="C:\Program Files\ss64\"  
CALL :dequote _mypath  
Echo %_mypath%  
Goto :eof  
  
:DeQuote  
**for /f "delims=" %%A in ('echo %%%1%%') do set %1=%%~A**  
Goto :eof

The above will turn "C:\Program Files\ss64\" into C:\Program Files\ss64\

If the line in bold is saved as a single line batch file DeQuote.cmd, then it can be called from other batch scripts:

[CALL](call.html) DeQuote.cmd VariableName

There may be cases when you only want to affect the string if it both starts and ends with a quote and raise an error or some other action if mismatched quotes are found. Some more complex scripts to handle this can be found [here in the forum](https://ss64.org/viewtopic.php?t=337).

“One look is worth a thousand words” ~ Fred R. Barnard

### Related commands

[SetLocal](setlocal.html) - EnableDelayedExpansion.  
How-to: [Long Filenames and NTFS](syntax-filenames.html) - Valid characters in filenames.



/. nt/syntax-delolder.html
========================================================

    Delolder - Delete files older than - Windows CMD - SS64.com

How-to: Delete files older than _N_ days
========================================

There are several ways to do this

1) Using [ForFiles](forfiles.html) to delete files over 7 days old:  
  
C:> forfiles /p "C:\source_folder" /s /m *.* /c "cmd /c Del @path" /d -**7**  

2) Using Robocopy /Move to delete files over 7 days old:

C:> set _robodel=%TEMP%\~robodel  
C:> MD %_robodel%  
C:> ROBOCOPY "C:\source_folder" %_robodel% /move /minage:**7**  
C:> del %_robodel% /q

3) Using [DateMath.cmd](syntax-datemath.html) and [Getdate.cmd](syntax-getdate.html), download [DelOlder.cmd](delolder.txt)

4) With PowerShell delete files over 7 days old:  
PS C:> $now = get-date  
PS C:> dir "C:\source_folder\" | [where](../ps/where-object.html) {$_.LastWriteTime -le $now.AddDays(-**7**)} | [del](../ps/remove-item.html) [-whatif](../ps/common.html)

PowerShell also has .AddHours if you want to delete more recent files.

_“We were having one of those great first dates you can only have when it's not an actual date” - Sarah Jessica Parker_

### Related commands

[SetLocal](setlocal.html) - Control the visibility of environment variables in a batch file.  
PowerShell Equivalent: [PowerShell methods](../ps/syntax-methods.html) - Math operations (.addDays)



/. nt/syntax-empty.html
========================================================

    Is a folder empty? | Windows batch file - Windows CMD - SS64.com

How To: Find out if a directory is empty
========================================

CMD Batch script to show if a folder is empty.

@Echo off
Setlocal
Set _folder="C:\Demo"
For /F %%A in ('dir /b /a %_folder%') Do (
    Echo The folder is NOT empty
    goto :ok
)
Echo The folder is empty
:ok

The script above will scan all files in the folder, which may be slow if there are many thousands of files, but it does not recursively scan through all the subfolders, if a single subfolder is found, empty or not, that is read as the parent folder is not empty.

To determine if a folder exists at all:  

Set _folder="C:\Demo"
if not exist %_folder% (Echo The folder does not exist)

“The difference between false memories and true ones is the same as for jewels: it is always the false ones that look the most real, the most brilliant” ~ Salvador Dalí

**Related:**

[DELTREE](deltree.html) - Delete a folder and all subfolders/files.  
[Delete only empty folders](https://ss64.org/viewtopic.php?f=2&t=37) and log results.  
[RD](rd.html) - Remove (or Delete) a Directory.  
[IF command](if.html)



/. nt/syntax-genchr.html
========================================================

    GenChr.cmd - generate an ASCII/Unicode character - Windows CMD - SS64.com

How-to: Generate any ASCII/Unicode character - GenChr.cmd
=========================================================

Generate the ASCII/Unicode character for any byte value.

The output is a file: _bytevalue_.chr

  :: This code creates one single byte. Parameter: 0-255
  :: Teamwork of carlos, penpen, aGerman, dbenham, bluesxman, sst
  :: Tested under Win2000, XP, Win7, Win8, Win10
  :: Fixed issue on environments with dbcs codepage

  @echo off
  setlocal enableextensions
  set "USAGE=echo:Usage: Supply an integer 0-255& goto :EOF"
  if "%~1" equ "" %USAGE%
  set /a "val=%~1" 2>nul
  if "%~1" neq "%val%" %USAGE%
  if %~1 lss 0    %USAGE%
  if %~1 gtr 255  %USAGE%

  for /f "tokens=*" %%a in ('chcp') do for %%b in (%%a) do set "cp=%%~nb"
  set "options=/d compress=off /d reserveperdatablocksize=26"
  set "cmd=cmd /d /c"
  mode con cp select=437 >nul
  if %~1 neq 26  (type nul >%~1.tmp
  [makecab](makecab.html) %options% /d reserveperfoldersize=%~1 %~1.tmp %~1.chr >nul
  type %~1.chr | (
  (for /l %%N in (1 1 38) do pause)>nul&findstr "^">%~1.tmp)
  >nul %cmd% copy /y %~1.tmp /a %~1.chr /b
  del %~1.tmp
  ) else (%cmd% copy /y nul + nul /a 26.chr /a >nul)
  mode con cp select=%cp% >nul

Written via the teamwork of carlos, penpen, aGerman, dbenham, bluesxman & sst- see [forum thread](https://ss64.org/viewtopic.php?f=2&t=119)

**Examples**

Create the 0 or NUL character (file 0.chr)  
genchr.cmd 0

Create the 9 or tab character. (file 9.chr)  
genchr.cmd 9

Create all 256 characters/files:  
for /l %a in (0,1,255) do start "" cmd /c genchr %a

_“When the character of a man is not clear to you, look at his friends” ~ Japanese Proverb_

### Related commands

[ASCII table](../ascii.html)  
[MAKECAB](makecab.html) Create .CAB files.



/. nt/syntax-getdate.html
========================================================

    GetDate - Windows CMD - SS64.com

How-to: Get the current Date - GetDate.cmd
==========================================

Display the date and time independent of OS Locale, Language or the users chosen date format (Control Panel ➞ Regional Settings).

If all you need is the current date and time in **local** format, you can just use the built in variables %date% and %time%, the more difficult problem is making this work for _any_ locale so that it can be used across international networks.

**Method 1** - Calling a VBScript [getdate.vbs](../vb/syntax-getdate.html)

> @Echo off
> :: GetDate1.cmd
> :: Display date and time independent of OS Locale, Language or date format.
> Setlocal  
> For /f %%A in ('cscript /nologo **getdate.vbs**') do set _dtm=%%A
> Set _yyyy=%_dtm:~0,4%
> Set _mm=%_dtm:~4,2%
> Set _dd=%_dtm:~6,2%
> Set _hh=%_dtm:~8,2%
> Set _nn=%_dtm:~10,2%
> Echo The current date/time is: %_yyyy%-%_mm%-%_dd%@%_hh%:%_nn%
> 
> :: Save the date/time in [ISO 8601](../dates.html) format:
> Endlocal&Set _dtm=%_YYYY%-%_mm%-%_dd%@%_hh%-%_nn%

**Method 2** - Calling [Robocopy](robocopy.html)  

> @Echo off
> :: GetDate2.cmd
> :: Display date and time independent of OS Locale, Language or date format.
> Setlocal
> For /f "tokens=1-6 delims=/: " %%A in ('robocopy "|" . /njh ^| find ":"') do  (
>     set "_YYYY=%%A" & set "_month=%%B" & set "_day=%%C" 
>     set "_hour=%%D" & set "_min=%%E"   & set "_sec=%%F"
> )
> Echo The current date/time is: %_YYYY%-%_month%-%_day%@%_hour%:%_min%:%_sec%
> 
> :: Save the date/time in [ISO 8601](../dates.html) format:
> Endlocal&Set _dtm=%_YYYY%-%_month%-%_day%@%_hour%-%_min%
> 
> :: Based on the lengthy forum threads [here](https://ss64.org/viewtopic.php?f=2&t=54) and [here](https://www.dostips.com/forum/viewtopic.php?f=3&t=4555&start=90#p43568).
> 
> Extending this to rename a file is as simple adding the variable where needed - see [StampMe.cmd](syntax-stampme.html):  
> REN "somefile.txt" "somefile%_dtm%.txt"

**Method 3** - Calling [date /t](date.html), this provides the date only.

> @Echo off
> :: GetDate3.cmd
> :: Display date independent of OS Locale, Language or date format.
> Setlocal
> Set t=2&if "%date%z" LSS "A" set t=1
> For /f "skip=1 tokens=2-4 delims=(-)" %%A in ('echo/^|date') do (
>   for /f "tokens=%t%-4 delims=.-/ " %%J in ('date/t') do (
>     set %%A=%%J&set %%B=%%K&set %%C=%%L)
> )
> Echo The current date is year: %yy% month:%mm% day: %dd%
> Endlocal&set _yyyy=%yy%&set _mm=%mm%&set _dd=%dd%
> 
> :: Adapted from Ritchie Lawrence [GetDate](https://github.com/ritchielawrence/batchfunctionlibrary/tree/master/Date%20and%20Time%20Functions)  

**Method 4** - Calling DOFF.exe  

> @Echo off
> :: GetDate4.cmd
> :: Display date and time independent of OS Locale, Language or date format.
> For /f %%A in ('DOFF.exe yyyy-mm-dd@hh-min') do set _dtm=%%A
> Echo The current date/time is: %_dtm%
> 
> Calling a 3rd party executable even a freeware one, has the disadvantage that you need to install it and make sure it's available, but this does have the advantage that it won’t unpredictably change format with a Windows upgrade. See below for links to DOFF.exe.

**Method 5** - Calling PowerShell.exe, this can be slow to launch as PowerShell requires **.Net** to be loaded.  

> @Echo off
> :: GetDate5.cmd
> :: Display date and time independent of OS Locale, Language or date format.
> For /f "delims=" %%A in ('powershell get-date -format "{yyyy-MMM-dd@HH:mm}"') do @set _dtm=%%A
> Echo The current date/time is: %_dtm%
> 
> :: Adapted from npocmaka's [answer](https://stackoverflow.com/a/19799236/1720814) on Stack overflow.

_"I've been on the calendar, but never on time" ~ Marilyn Monroe_

### Related commands

[datetime.vbs](../vb/syntax-getdatetime.html) - Get Date, Time and daylight savings (VB Script).  
[DOFF.exe](../links/doff10.zip) - Print a formatted date and time by [John Fitzgibbon](https://web.archive.org/web/20070223071919/http://www.jfitz.com/dos/index.html), optional date offset e.g. -1 prints yesterday. ([source](../links/doff10_source.zip) + BSD licence).  
How-to: [Standard date and time notation](../dates.html) - ( YYYY-MM-DD )  
PowerShell equivalent: [get-date](../ps/get-date.html) -format yyyy-MM-ddTHH-mm-ss-ff  
[Date/Time scripts](https://www.robvanderwoude.com/datetiment.php) - Rob van der Woude.  
[Date/Time scripts](https://ritchielawrence.github.io/batchfunctionlibrary/#date-and-time-functions) - Ritchie Lawrence.



/. nt/syntax-gettime.html
========================================================

    GetTime - Windows CMD - SS64.com

How-to: Return the current Time - GetTime.cmd
=============================================

Returns the current time into the variable %_time%

  @echo off
  SETLOCAL
  For /f "tokens=1-3 delims=1234567890 " %%a in ("%time%") Do set "delims=%%a%%b%%c"
  For /f "tokens=1-4 delims=%delims%" %%G in ("%time%") Do (
    Set _hh=%%G
    Set _min=%%H
    Set _ss=%%I
    Set _ms=%%J
  )
  :: Strip any leading spaces
  Set _hh=%_hh: =%

  :: Ensure the hours have a leading zero
  if 1%_hh% LSS 20 Set _hh=0%_hh%

  Echo The time is:   %_hh%:%_min%:%_ss%
  ENDLOCAL&Set _time=%_hh%:%_min%

Although the default TIME delimiter is either . or : users can change the delimiter to just about any character they like. It is rare, but some people will change it.

Based on the discussion thread [here](https://ss64.org/viewtopic.php?f=2&t=54), this script always returns HH:MM no matter which time delimiter has been set in the control panel. Thanks to avery_larry and bluesxman for their improvements. To include Milliseconds just tack on the %_ms% variable.

_“What may be done at any time will be done at no time” ~ Scottish Proverb_

### Related commands

How-to: [DateTime](../vb/syntax-getdatetime.html) - Get Date, Time and daylight savings (VB Script).  
%TIME% - variable containing current time.  
[TIME](time.html) - Set the time (list of default time formats for different countries).  
[GetDate.cmd](syntax-getdate.html) - Get todays date (any region, any OS).  
[tdiff.cmd](syntax-tdiff.html) - Time difference in Hours/Minutes.  
[Commandline.co.uk](https://ritchielawrence.github.io/batchfunctionlibrary/#date-and-time-functions) - date/time scripts.  
[Rob Vanderwoude](https://www.robvanderwoude.com/datetiment.html) - date/time scripts.



/. nt/syntax-gmt.html
========================================================

    GMT Time - Windows CMD - SS64.com

How-to: Calculate Greenwich Mean Time - GMT.cmd
===============================================

Display the current date and time adjusted to [Greenwich Mean Time](../timezones.html), this can be useful when comparing events across multiple time zones.

The WMIC tool is [deprecated](https://docs.microsoft.com/en-us/windows/deployment/planning/windows-10-deprecated-features) in Windows 10, version 21H1 and the 21H1 semi-annual channel release of Windows Server.  
In PowerShell, this can be done with just: (Get-Date).ToUniversalTime()

::gmt.cmd  Display the current date and time in GMT (World Time)
@echo off
Setlocal EnableDelayedExpansion
call :get_local_time
call :get_utc_time

:: Add leading zeros
Set gmt_minute=0%gmt_minute%
Set gmt_minute=%gmt_minute:~-2%
Set gmt_day=0%gmt_day%
Set gmt_day=%gmt_day:~-2%
Set gmt_month=0%gmt_month%
Set gmt_month=%gmt_month:~-2%
Set local_minute=0%local_minute%
Set local_minute=%local_minute:~-2%
Set local_day=0%local_day%
Set local_day=%local_day:~-2%
Set local_month=0%local_month%
Set local_month=%local_month:~-2%

:: Display result
Echo  GMT Date/Time: %gmt_year%-%gmt_month%-%gmt_day% %gmt_hour%:%gmt_minute%
Echo  Local Date/Time: %local_year%-%local_month%-%local_day% %local_hour%:%local_minute%
goto :eof

:get_local_time
for /f "tokens=1,2 delims==" %%G in ('**WMIC** path Win32_LocalTime get /value ^| find "="') do (call :setVars %%G %%H)
goto :eof

:setVars
    Set _var=%1
    Set _value=%2
    Set local_!_var!=!_value!
goto :eof

:get_utc_time
for /f "tokens=1,2 delims==" %%G in ('**WMIC** path Win32_UTCTime get /value ^| find "="') do (call :setUTCvars %%G %%H)
goto :eof

:setUTCvars
    Set _var=%1
    Set _value=%2
    Set gmt_!_var!=!_value!
goto :eof

“Time is like money, the less we have of it to spare, the further we make it go” ~ Josh Billings

### Related commands

[datetime.vbs](../vb/syntax-getdatetime.html) - Get Date, Time and daylight savings (VB Script).  
[GetTime.cmd](syntax-gettime.html) - Get the time now.  
[TIME](time.html) - Set the time (list of default time formats for different countries).  
[Rob Vanderwoude](https://www.robvanderwoude.com/datetiment.html) - date/time scripts.



/. nt/syntax-isdirectory.html
========================================================

    Is Directory - Windows CMD - SS64.com

How-to: IsDirectory.cmd
=======================

Check if a given path leads to a folder or a file:

@Echo off
SETLOCAL
Set _attr=%~a1
Set _isdir=%_attr:~0,1%
If /I "%_isdir%"=="d" (
 Echo %1 is a directory
 Exit /b 0
)
Echo %1 is NOT a directory
Exit /b 2

Adapted from [this](https://stackoverflow.com/a/3728742/1720814) StackOverflow answer.

### Examples

c:> IsDirectory.cmd "C:\docs\example folder"  
"C:\docs\example folder" is a directory

c:> IsDirectory.cmd C:\demo >NUl  
c:> If %errorlevel% EQU 2 Echo Demo folder not found

_“The time you enjoy wasting is not wasted time” ~ Bertrand Russell_

### Related commands

How-to: [Parameters](syntax-args.html) - Command Line Arguments %1 %~f1  
[ATTRIB](attrib.html) - Extended Attributes.  
PowerShell: [Get-ChildItem -directory](../ps/get-childitem.html)



/. nt/syntax-sanitize.html
========================================================

    Sanitize user input - Windows CMD - SS64.com

How-to: sanitize user input - sanitize.cmd
==========================================

Sanitize an input string omitting any non-approved characters from the output.

@ECHO OFF
Setlocal
:: Sanitize an input string omitting any non-approved characters from the output
CALL Set "_string=%%%~1%%"
Set "_sanitizedString="

:sanitizeLoopStart
IF "%_string%"=="" (GOTO :sanitizeLoopEnd)
FOR %%A IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z a b c d e f g h i j k l m n o p q r s t u v w x y z 1 2 3 4 5 6 7 8 9 0 ' . - # $ + ? @ [ ] { } ~ ) DO (
    IF "%_string:~0,1%"=="%%A" (
      Set "_sanitizedString=%_sanitizedString%%%A"
    )
)
Set "_string=%_string:~1%"
GOTO :sanitizeLoopStart

:sanitizeLoopEnd
ENDLOCAL & Set "_sanitizedResult=%_sanitizedString%"

Credits: Michael Wright/Simon Sheppard, see [forum thread](https://ss64.org/viewtopic.php?f=2&t=471)

**Examples**

Prompt for input and then sanitise:  
  
Set /P _ans=Please enter a Department:

:: remove &'s and quotes from the answer (via string [replace](syntax-replace.html))  
Set _ans=%_ans:&=%  
Set _ans=%_ans:"=%  
  
:: Sanitize  
CALL sanitize.cmd _ans  
Echo %_sanitizedResult%"

_“I quite like post-apocalyptic films, things like 'Mad Max' for instance, because they are so full on and there is something quite cleansing about the post-apocalyptic because you can see where we all think we're heading” ~ Anthony Daniels_

### Related commands

[SET /p](set.html) - Prompt for user input.  
[CHOICE](choice.html) - Accept keyboard input to a batch file.



/. nt/syntax-stampme.html
========================================================

    StampMe.cmd - rename a file with todays date and time - Windows CMD - SS64.com

How-to: Rename a file with the DATE/Time - StampMe.cmd
======================================================

Rename a file (or folder) by appending the current date and time to the existing filename:

  @ECHO off
  SETLOCAL
  IF [%1] NEQ [] goto s_start

  Echo StampMe.cmd
  Echo Rename a file with the DATE/Time
  Echo:
  Echo Syntax
  Echo    STAMPME TestFile.txt
  Echo:
  Echo    STAMPME "Test File.txt"
  Echo:
  Echo    STAMPME "c:\docs\Test File.txt"
  Echo:
  Echo    Will rename the file in the format "Test File-2014-12-30@16-55-01.txt"
  Echo:
  Echo    In a batch file use CALL STAMPME ...
  GOTO :eof
  
  :s_start
  Set _file=%~n1%
  Set _pathname=%~f1%
  Set _ext=%~x1%

  For /f "tokens=1-6 delims=/: " %%a in ('robocopy "|" . /njh ^| find ":"') do (
    set "_YYYY=%%a" & set "_month=%%b" & set "_day=%%c" 
    set "_hour=%%d" & set "_min=%%e"   & set "_sec=%%f"
  )

  Echo %_YYYY%-%_month%-%_day%@%_hour%:%_min%:%_sec%
  :: Save the date/time in ISO 8601 format:
  Set _datetimestamp=%_YYYY%-%_month%-%_day%@%_hour%-%_min%-%_sec%

  :: Rename the file
  REN "%_pathname%" "%_file%-%_datetimestamp%%_ext%"

The last line of the batch file does the [REName](ren.html). Based on the lengthy forum threads [here](https://ss64.org/viewtopic.php?f=2&t=54) and [here](https://www.dostips.com/forum/viewtopic.php?f=3&t=4555&start=90#p43568).

If you save this as a batch script (stampme.cmd) on the desktop, you can drag and drop any file, from a local drive or UNC path, and drop it onto the icon - that will rename the file without moving it from the original location.

**Examples**

c:> StampMe "sample file.txt"  
c:> StampMe "C:\logs\data\errorlog.txt"  
c:> StampMe "C:\docs\example folder"

An alternative 'quick and dirty' way to do the same thing in one line is shown below, this does work but is less robust as the results will vary according to regional/control panel settings.

c:> REN "sample file.txt" "* %Date:/= % %Time::=.%.*"

_“The time you enjoy wasting is not wasted time” ~ Bertrand Russell_

### Related commands

[Standard date and time notation](../dates.html) - YYYY-MM-DD.  
How-to: [DelOlder.cmd](syntax-delolder.html) - Delete files more than n days old.  
How-to: [GetDate](syntax-getdate.html) and [GetTime](syntax-gettime.html) scripts.  
How-to: [Stampme.ps1](../ps/syntax-stampme.html) - Rename files with PowerShell.



/. nt/syntax-strlen.html
========================================================

    String Length - Windows CMD - SS64.com

How-to: Get the length of a String - strlen.cmd
===============================================

This function can be used to return the length of a string.

goto:eof
:**strlen  StrVar  [RtnVar]**
  setlocal EnableDelayedExpansion
  set "s=#!%~1!"
  set "len=0"
  for %%N in (4096 2048 1024 512 256 128 64 32 16 8 4 2 1) do (
    if "!s:~%%N,1!" neq "" (
      set /a "len+=%%N"
      set "s=!s:~%%N!"
    )
  )
  endlocal&if "%~2" neq "" (set %~2=%len%) else echo %len%
exit /b

Copy the function above to the end of your batch file and then call it like this:

Set "_demo=some example string"  
Call :strlen _demo _length  
Echo String is %_length% characters long

Source/credits: Dave Benham and others from the DosTips forum see [SS64 forum thread](https://ss64.org/viewtopic.php?t=17) with some alternative string length functions.

“You can’t do anything about the length of your life, but you can do something about its width and depth” ~ Henry Louis Mencken

### Related commands

How-to: [VarSubstring](syntax-substring.html) - Extract part of a variable (substring)  
How-to: [VarSearch](syntax-replace.html) - Search & replace part of a variable.  
How-to: [ToLower.cmd](syntax-tolower.html) - Upper or Lower case a String.



/. nt/syntax-tolower.html
========================================================

    ToLower ToUpper lower case a String - Windows CMD - SS64.com

How-to: Upper or Lower case a String
====================================

The examples on this page utilise some advanced techniques to make a string UPPER or lower case:

*   By passing a variable, they are able to handle many [special](syntax-esc.html) punctuation/unicode characters which are often mangled if passed as a raw text string.
*   Using [CALL SET](call.html#advanced) to unwrap the value of the given variable.
*   Explicitly replacing one character with another, allows for replacing Umlauts and potentially other punctuation.
*   Replacing each letter of the alphabet rather than each letter of the input string means that an input string of > 27 characters will not take a long time to convert. For short strings performance is unlikely to be an issue.
*   Creating a script which generates [L33T](https://en.wikipedia.org/wiki/Leet) text or [Alt caps](https://en.wikipedia.org/wiki/Alternating_caps) is left as an exercise for the reader.

This function can be used to return a string converted to be lower case.

> @Echo off
> :toLower str -- Converts uppercase characters to lowercase
> ::              Converts the supplied environment variable (%1) to lowercase.
> if not defined %~1 EXIT /b
> for %%a in ("A=a" "B=b" "C=c" "D=d" "E=e" "F=f" "G=g" "H=h" "I=i"
>             "J=j" "K=k" "L=l" "M=m" "N=n" "O=o" "P=p" "Q=q" "R=r"
>             "S=s" "T=t" "U=u" "V=v" "W=w" "X=x" "Y=y" "Z=z" "Ä=ä"
>             "Ö=ö" "Ü=ü") do (
>     call set %~1=%%%~1:%%~a%%
> )
> Echo Results saved to variable [%%%1%%]
> Call echo %%%1%%
> EXIT /b
> :$source [dostips.com](https://www.dostips.com/DtTipsStringOperations.php#Function.toLower)

### Examples

@Echo off  
Setlocal  
Set "_myvar=This is A DEMO STrIng!"  
Call **ToLower.cmd** _myvar  
Echo [%_myvar%]  

C:> this is a demo string!

Upper case a String - ToUpper.cmd
---------------------------------

This function can be used to return a string converted to be upper case.

> @Echo off
> :toUpper str -- converts lowercase character to uppercase
> ::           -- str [in,out] - valref of string variable to be converted
> if not defined %~1 EXIT /b
> for %%a in ("a=A" "b=B" "c=C" "d=D" "e=E" "f=F" "g=G" "h=H" "i=I"
>             "j=J" "k=K" "l=L" "m=M" "n=N" "o=O" "p=P" "q=Q" "r=R"
>             "s=S" "t=T" "u=U" "v=V" "w=W" "x=X" "y=Y" "z=Z" "ä=Ä"
>             "ö=Ö" "ü=Ü") do (
>     call set %~1=%%%~1:%%~a%%
>     
> )
> Echo Results saved to variable [%%%1%%]
> Call echo %%%1%%
> EXIT /b
> 
> :$source [dostips.com](https://www.dostips.com/DtTipsStringOperations.php#Function.toUpper)

### Example  

@Echo off  
Setlocal
Set "_var=some example @$']£ TEXT 123!"
Call **ToUpper.cmd** _var
SOME EXAMPLE @$']£ TEXT 123!

“Phrasing is the idea of finding sentences and using punctuation in speech. I often look at the score to see what's written in by the composer to see if I can find clues to those directions, like what direction did the composer have in mind, and I try to incorporate those things as much as possible” ~ Hilary Hahn

### Related commands

How-to: [VarSubstring](syntax-substring.html) - Extract part of a variable (substring)  
How-to: [VarSearch](syntax-replace.html) - Search & replace part of a variable.  
How-to: [StrLen](syntax-strlen.html) - Calculate the length of a string.  
[String Manipulation](https://ss64.org/viewtopic.php?f=2&t=83) - Split, indexof, lastindexof, reverse, endsWith, startsWith - SS64 forum  
PowerShell: $var[.ToLower()](../ps/syntax-methods.html) or $var[.ToUpper()](../ps/syntax-methods.html)  
[Tail/Head](https://ss64.org/viewtopic.php?f=2&t=92) - SS64 forum  
[ToUpper /Lower](https://www.dostips.com/DtTipsStringOperations.php#Function.toUpper) - DosTips function library.



/. nt/syntax-tdiff.html
========================================================

    tdiff - Time difference - Windows CMD - SS64.com

How-to: Calculate a time difference with tdiff.cmd
==================================================

Given two time values in hours, minutes and seconds, calculate the time difference between them.

@Echo off
Setlocal
if "%~1" EQU "" goto s_syntax

:: Convert start and end times to hundredths of a second
Call :s_calc_timecode %1
Set _start_timecode=%errorlevel%

Call :s_calc_timecode %2
Set _stop_timecode=%errorlevel%

:: Calculate the difference in hundredths
Set /a _diff_timecode=_stop_timecode - _start_timecode

:: Midnight rollover
if %_diff_timecode% LSS 0 set /a _diff_timecode+=(24 * 60 * 60 * 100)
Echo %_diff_timecode% hundredths of a second

:: Split out Hours, Mins etc and return the result
set /a hs=_diff_timecode %% 100
set /a _diff_timecode/=100
set /a ss=_diff_timecode %% 60
set /a _diff_timecode/=60
set /a mm=_diff_timecode %% 60
set /a _diff_timecode/=60
set /a hh=_diff_timecode

set hh=0%hh%
set mm=0%mm%
set ss=0%ss%
set hs=0%hs%

set _tdiff=%hh:~-2%:%mm:~-2%:%ss:~-2%.%hs:~-2%

Echo HH:MM:ss.hs
Echo %_tdiff%
endlocal & set _tdiff=%_tdiff%
goto :EOF


:s_calc_timecode
    :: Remove delimiters and convert to hundredths of a second.
  setlocal

  For /f "usebackq tokens=1,2,3,4 delims=:." %%a in ('%1') Do (
      set hh=00%%a
      set mm=00%%b
      set ss=00%%c
      set hs=00%%d
  )
    set hh=%hh:~-2%
    set mm=%mm:~-2%
    set ss=%ss:~-2%
    set hs=%hs:~-2%
    set /a hh=((%hh:~0,1% * 10) + %hh:~1,1%) * 60 * 60 * 100
    set /a mm=((%mm:~0,1% * 10) + %mm:~1,1%) * 60 * 100
    set /a ss=((%ss:~0,1% * 10) + %ss:~1,1%) * 100
    set /a hs=((%hs:~0,1% * 10) + %hs:~1,1%)
   
    set /a _timecode=hh + mm + ss + hs

Endlocal & Exit /b %_timecode%

:s_syntax
    Echo:
    Echo Syntax: tdiff.cmd StartTime StopTime
    Echo:
    Echo    The times can be given in the format:
    Echo    HH  or  HH:MM  or  HH:MM:ss  or  HH:MM:ss.hs
    Echo:
    Echo    so for example:  tdiff %%time%% 23
    Echo    will give the time difference between now and 23:00:00.00
    Echo:
    Echo The result is returned in variable %%_tdiff%%
Exit /b 1

### Examples

c:> tdiff 14:30 23:15  
c:> tdiff 14:30:05 16:45:12

“God, grant me the serenity to accept the things I cannot change, the courage to change the things I can, and the wisdom to know the difference” ~ Reinhold Niebuhr

### Related commands

How-to: [DateMath.cmd](syntax-datemath.html) - Add or subtract days from any date.  
How-to: [DelOlder.cmd](syntax-delolder.html) - Delete files more than n days old  
How-to: [GetTime](syntax-gettime.html) script  
How-to: [timer.cmd](syntax-timer.html) - Measure the run time of a script.



/. nt/syntax-timer.html
========================================================

    Timer.cmd - Windows CMD - SS64.com

How-to: Measure the time elapsed with Timer.cmd
===============================================

This script by bluesxman on the [forum](https://ss64.org/viewtopic.php?f=2&t=15) can be used to accurately measure the time elapsed by some other process or script.

Start the timer with CALL timer.cmd Start, then run the process/script and then CALL timer.cmd Stop when finished.

@echo off
setlocal

:: Last update 2019-06-27
:: Updated to handle Indonesian locale

set time=%~2
set time=%time: =0%

set stamp.file=%temp%\%~n0.stamp

:: Call a subroutine to either Start, Stop or Lap the timer.
if /i "%~1" EQU "start" call :make.stamp
if /i "%~1" EQU "stop"  call :read.stamp stop
if /i "%~1" EQU "lap"   call :read.stamp lap
if    "%~1" EQU ""      call :status

endlocal
goto :EOF

:status
:: If no parameters are passed display the status, either the timer is running or not.
:: raises an errorlevel if not running.

 if exist "%stamp.file%" (
  if /i "%~1" NEQ "/q" echo:Timer is active.
  exit /b 0
 )

 echo:Timer is not active.
 exit /b 1

:make.stamp
:: Start the timer
:: Create the stamp.file and write the current time to it.

 if exist "%stamp.file%" call :read.stamp stop
 set start.time=%time%

 (echo:%start.time%) > "%stamp.file%"
 echo:Timer started %start.time%
 goto :EOF

:read.stamp
:: Read the timer
:: retrieve the start time from the stamp.file and compare with current time.

 call :status /q
 if errorlevel 1 goto :EOF
 set stop.time=%time%
 set /p start.time=< "%stamp.file%"

 echo:Timer started %start.time%
 echo:Timer %1ped %stop.time%

 if %1 EQU stop del "%stamp.file%"

 call :calc.time.code "%start.time%"
 set start.time.code=%errorlevel%

 call :calc.time.code "%stop.time%"
 set stop.time.code=%errorlevel%

 set /a diff.time.code=stop.time.code - start.time.code

 if %diff.time.code% LSS 0 set /a diff.time.code+=(24 * 60 * 60 * 100)

 setlocal

 set /a hs=diff.time.code %% 100
 set /a diff.time.code/=100
 set /a ss=diff.time.code %% 60
 set /a diff.time.code/=60
 set /a mm=diff.time.code %% 60
 set /a diff.time.code/=60
 set /a hh=diff.time.code

 set hh=0%hh%
 set mm=0%mm%
 set ss=0%ss%
 set hs=0%hs%

 endlocal & set diff.time=%hh:~-2%:%mm:~-2%:%ss:~-2%.%hs:~-2%

 echo %diff.time.code% hundredths of a second
 echo %diff.time%

 goto :EOF

:calc.time.code
:: Accept a formatted string containing the time.
:: Extract the numeric parts for hour, minute,second, millisecond and combine
:: into one numeric variable time.code
:: The delims are to account for different regional [time](time.html) settings.

 if not defined t_delims for /f "tokens=1,2,3,4,5 delims=0123456789" %%v in ("%~1") do set "t_delims=%%v%%w%%x%%y%%z"

 setlocal

 for /f "tokens=1,2,3,4 delims=%t_delims% " %%a in ("%~1") do (
    set hh=%%a
    set mm=%%b
    set ss=%%c
    set hs=%%d
 )

 set /a hh=((%hh:~0,1% * 10) + %hh:~1,1%) * 60 * 60 * 100
 set /a mm=((%mm:~0,1% * 10) + %mm:~1,1%) * 60 * 100
 set /a ss=((%ss:~0,1% * 10) + %ss:~1,1%) * 100
 set /a hs=((%hs:~0,1% * 10) + %hs:~1,1%)

 set /a time.code=hh + mm + ss + hs
 endlocal & exit /b %time.code%

When measuring short time periods run the timer several times and take an average, this will smooth out the effect of any background processes and hard drive variations.

“You go away for a long time and return a different person ~ you never come all the way back” ~ Paul Theroux

### Related commands

How-to: [StrLen](syntax-strlen.html) - Calculate the length of a string.  
How-to: [tdiff.cmd](syntax-tdiff.html) - Time difference in Hours/Minutes.  
[Chronometer/Timer app](https://ss64.org/viewtopic.php?t=15) - SS64 Forum.  
Equivalent PowerShell cmdlet: [Measure-Command](../ps/measure-command.html)



/. nt/syntax-which.html
========================================================

    Which.cmd - Windows CMD - SS64.com

How-to: Show the full path to an executable file.
=================================================

Show the full path to an executable file.

:: Which.cmd  
:WHICH  CommandName  [ReturnVar]
::
::  Determines the full path of the file that would execute if
::  CommandName were executed.
::
::  The result is stored in variable ReturnVar, or else it is
::  echoed to stdout if ReturnVar is not specified.
::
::  If no file is found, then an error message is echoed to stderr.
::
::  The ERRORLEVEL is set to one of the following values
::    0 - Success: A matching file was found
::    1 - CommandName is an internal command
::    2 - No file was found and CommandName is not an internal command
::    3 - Improper syntax - no CommandName specified
::
@echo off
setlocal disableDelayedExpansion

set "file=%~1"
setlocal enableDelayedExpansion

if not defined file (
  >&2 echo Syntax error: No CommandName specified
  exit /b 3
)


:: test for internal command
echo(!file!|findstr /i "[^abcdefghijklmnopqrstuvwxyz]" >nul || (
  set "empty=!temp!\emptyFolder"
  md "!empty!" 2>nul
  del /q "!empty!*" 2>nul >nul
  setlocal
  pushd "!empty!"
  set path=
  (call )
  !file! /? >nul 2>nul
  if not errorlevel 9009 (
    >&2 echo "!file!" is an internal command
    popd
    exit /b 1
  )
  popd
  endlocal
)


:: test for external command
set "noExt="
if "%~x1" neq "" if "![PATHEXT](syntax-variables.html):%~x1=!" neq "!PATHEXT!" set noExt="";
set "modpath=.\;!PATH!"
@for %%E in (%noExt%%PATHEXT%) do @for %%F in ("!file!%%~E") do (
  setlocal disableDelayedExpansion
  if not "%%~$modpath:F"=="" if not exist "%%~$modpath:F\" (
    endlocal & endlocal & endlocal
    if "%~2"=="" (echo %%~$modpath:F) else set "%~2=%%~$modpath:F"
    exit /b 0
  )
  endlocal
)
endlocal


>&2 echo "%~1" is not a valid command
exit /b 2

:: Credits:
:: Dave Benham :: [forum thread](https://ss64.org/viewtopic.php?t=20) :: [StackOverflow](https://stackoverflow.com/a/21146630/1720814) answer

### Related commands

[WHERE](where.html) - Locate and display files in a directory tree.  
[whereis utility](http://www.flounder.com/whereis.htm) - Flounder.com.



/. nt/syntax-xlong.html
========================================================

    xlong filename 256 character limit - Windows CMD - SS64.com

How-to: List files that exceed the 256 character limit
======================================================

It is possible to create [very long filenames/pathnames](syntax-filenames.html) on NTFS that exceed the 260 character Windows API limit. This typically happens when a folder which is part of a deep hierarchy gets renamed. Very long filenames will often create errors in applications that attempt to open them (even Windows Explorer.)

The maximum Windows API MAX_Path is 260 characters, subtract 3 characters for the drive and colon: and 1 character for a terminating NULL and you have a maximum 256 characters that can be used for the pathname.

All .Net applications enforce the Windows API pathname limit including Windows Explorer and PowerShell.

To access very long paths use [Robocopy](robocopy.html), [SUBST](subst.html) or the \?_UNCPATH_\ syntax.

The script below will list any files that exceed this limit.

@Echo off
Setlocal EnableDelayedExpansion
:: Report all file / folder paths that exceed the 256 character limit
If {%1}=={} Echo Syntax: XLong DriveLetter&goto :EOF
Set wrk=%1
Set wrk=%wrk:"=%

For /F "Tokens=*" %%a in ('dir %wrk% /b /s /a') do (
 set name=%%a
 if not "!name:~255,1!"=="" echo Extra long name: "%%a"
)
Endlocal

### Examples

Check the whole of the D: drive  
c:> xlong D:\

Check the current directory on the C: drive:  
c:> xlong C:

Check the S:\workgroups\ folder:  
c:> xlong S:\workgroups\

_“This report, by its very length, defends itself against the risk of being read” ~ Winston Churchill_

### Related commands

How-to: [Long Filenames](syntax-filenames.html) - NTFS long filenames (>260 chars)  
How-to: [Which.cmd](syntax-which.html) - Display full path to any command.  
Bash equivalent: find . | awk '{print length($0) " " $0}' | sort -n | tail -n 15



/. nt/syntax-ansi.html
========================================================

    Use ANSI colors in the terminal - Windows CMD - SS64.com

How-to: Use ANSI colors in the terminal
=======================================

ANSI colors are available by default in Windows version 1909 or newer. See below for older versions.

Specify the color codes in a batch file by [ECHO](echo.html)ing the foreground and/or background [COLOR](color.html) codes (from the following table) followed by the text to be formatted, followed by the ANSI default (Esc[0m) to reset the terminal back to the default colors.  
These codes are the same as those used in a Unix/Linux/VT 100 terminal though the colors may be slightly different shades.

| Color ｜ Foreground ｜ Background ｜ COLOR equivalent |
|-------------------------------------------------------|
| Default | Esc[0m |   |    
| █ Black BLACK | Esc[30m | Esc[40m |  0 
| █ Red DARK_RED | Esc[31m | Esc[41m |  4 
| █ Green DARK_GREEN | Esc[32m | Esc[42m |  2 
| █ Yellow DARK_YELLOW | Esc[33m | Esc[43m |  6 
| █ Blue DARK_BLUE | Esc[34m | Esc[44m |  1 
| █ Magenta DARK_MAGENTA | Esc[35m | Esc[45m |  5 
| █ Cyan DARK_CYAN | Esc[36m | Esc[46m |  3 
| █ Light gray DARK_WHITE | Esc[37m | Esc[47m |  7 
| █ Dark gray BRIGHT_BLACK | Esc[90m | Esc[100m |  8 
| █ Light red BRIGHT_RED | Esc[91m | Esc[101m |  C 
| █ Light green BRIGHT_GREEN | Esc[92m | Esc[102m |  A 
| █ Light yellow BRIGHT_YELLOW | Esc[93m | Esc[103m |  E 
| █ Light blue BRIGHT_BLUE | Esc[94m | Esc[104m |  9 
| █ Light magenta BRIGHT_MAGENTA | Esc[95m | Esc[105m |  D 
| █ Light cyan BRIGHT_CYAN | Esc[96m | Esc[106m |  B 
| █ White WHITE | Esc[97m | Esc[107m |  F 
| Bold | Esc[1m |   |   
| Underline | Esc[4m |   |   
| No underline | Esc[24m |   |   
| Reverse text | Esc[7m |   |   
| Positive text (not reversed) | Esc[27m |   |   

> The Esc character in the above table must be entered with the key combination Ctrl+[  
> In some text editors this will appear as ^[ or Esc[

Many basic text editors do not provide a method of entering an ANSI Esc character (n.b. do not confuse this with the CMD [Escape](syntax-esc.html) character) to work around this, either enter Esc at the command line or use an editor like Notepad++ which allows copy and paste.

The actual colors displayed are dependent on the Terminal color scheme which can be set using [ColorTool.exe](https://github.com/Microsoft/Terminal/tree/master/src/tools/ColorTool) The new default color scheme is called campbell.ini. This was first introduced in Windows 10 **clean-install** [version](ver.html) build 16257 (1709).

The color swatches on this page are based on the new [COLOR](color.html) defaults.

ANSI color codes do also support [redirection](syntax-redirection.html) to a text file. You may then use [TYPE](type.html) to display such an output file complete with colors. However if you want to easily access the raw text without any color codes e.g. for further manipulation/sorting then avoid applying any color codes until after that has been done.

PowerShell 7.2 added a new automatic variable, $PSStyle, and changes to the PowerShell engine to support the output of ANSI-decorated text. See [about_ANSI_Terminals](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_ansi_terminals?view=powershell-7.2) for more.

Enabling ANSI colors in older versions of Windows
-------------------------------------------------

> To use ANSI colours in the Windows terminal requires setting VirtualTerminalLevel.
> 
> VirtualTerminalLevel = 1 is now set [by default](https://github.com/microsoft/terminal/pull/2824) for the terminal and in [ConPTY](https://github.com/microsoft/terminal/commit/1c412d42b3ac7fbaaf75324936211f4b4ed0e86f).  
> In Windows [versions](ver.html) 1511 through to 1903 this had to be enabled in the registry at:
> 
> [HKEY_CURRENT_USER\Console]  
> "VirtualTerminalLevel"=dword:00000001
> 
> Alternatively it can be enabled by calling the SetConsoleMode API with the ENABLE_VIRTUAL_TERMINAL_PROCESSING flag.

24 bit color
------------

> The latest W10 Console has full 24-bit color support, this is primarily for Linux compatibility so the console properties page and the default Windows color mappings still use just 16 colors, there is [no plan](https://github.com/Microsoft/WSL/issues/1118) to add additional console colors to the Win32 API.
> 
> To take advantage of the new colors use [ColorTool.exe](https://github.com/Microsoft/Terminal/tree/main/src/tools/ColorTool) and install a theme, or use the VT100 sequences described [here](https://docs.microsoft.com/en-us/windows/console/console-virtual-terminal-sequences?redirectedfrom=MSDN#extended-colors).  
> When the VT100 sequences are used with a version of the Windows Console that supports 24-bit colors they will display the desired RGB color, older consoles will choose the nearest appropriate color from the existing 16 color table.

### Examples

@Echo off  
Echo ¤[91m This text will display in Red ¤[0m

In the above ¤ represents the Esc character.

A batch file to display the ANSI colors: [EchoANSI.CMD](echoansi.txt)

Output:

> ![ANSI colors](ansicols.png)

_“In nature, light creates the color; in the picture, color creates light.  
 Every color shade emanates a very characteristic light — no substitute is possible” ~ Hans Hofmann_

### Related commands

[ECHO](echo.html) - Display a message on screen.  
[TYPE](type.html) - Display the contents of a text file.  
How-to: [256 Colors for XTerm](../bash/syntax-colors.html) (Linux)  
In [MS-DOS](https://www.computerhope.com/jargon/m/msdos.htm) ANSI support could be installed by loading ansi.sys at startup.  
[ConPTY](https://devblogs.microsoft.com/commandline/windows-command-line-introducing-the-windows-pseudo-console-conpty/) - Blog post describing the Windows Pseudo Console.  
[Console Virtual Terminal Sequences](https://docs.microsoft.com/en-us/windows/console/console-virtual-terminal-sequences) - Full list of VT 100 codes, positioning, colors, modes, RGB (for non Windows consoles).  
[Dracula Theme](https://github.com/dracula/powershell) - A dark theme for the Windows 10 Console.  
[WT.exe](wt.html) - Windows Terminal  
[CSS/HTML Colour codes](https://emw3.com/colour.html)



/. nt/syntax-autoexec.html
========================================================

    Autoexec and AutoRun - Windows CMD - SS64.com

How-to: Autoexec commands
=========================

To run a command as soon as the **command prompt** is opened, this can be useful for loading [DOSKEY](doskey.html) macros:

> Add an entry in either:
> 
> *   Registry (Current user): HKCU\Software\Microsoft\Command Processor\AutoRun
> *   Registry (All users): HKLM\Software\Microsoft\Command Processor\AutoRun
> 
> This will also run if a CMD.exe session is initiated by drag and drop onto a batch file or by a [FOR /F command](for_cmd.html) which calls a sub-process.
> 
> The AutoRun entry can contain a string value (REG_SZ or REG_EXPAND_SZ) which will be executed. These AutoRun keys are rarely used and don't exist by default.
> 
> Things not to do: if you set a Command Processor AutoRun which outputs any text, that is likely to mess up any scripts using the FOR /F command. If you set a Command Processor AutoRun to launch CMD.exe that will recursively launch new CMD sessions until the machine runs out of memory.

To run a command as soon as **a user logs in**:

> *   The STARTUP folder (Start Menu) – [%appdata%](syntax-variables.html)\Microsoft\Windows\Start Menu\Programs\Startup\
> *   Registry: HKCU\Software\Microsoft\Windows\CurrentVersion\Run
> *   Registry: HKCU\Software\Microsoft\Windows NT\CurrentVersion\Run

To run a command as soon as **any user** logs in:

> *   The all users STARTUP folder (Start Menu) – [%ProgramData%](syntax-variables.html)\Microsoft\Windows\Start Menu\Programs\StartUp\
> *   Registry: HKLM\Software\Microsoft\Windows\CurrentVersion\Run
> *   Registry: HKLM\Software\Microsoft\Windows NT\CurrentVersion\Run

The \Microsoft\Windows NT\ keys exist largely for backwards compatibility, but are still supported.  
There are also equivalent [RunOnce keys](https://learn.microsoft.com/en-us/windows/win32/setupapi/run-and-runonce-registry-keys) which will execute just once and then be removed from the registry.

To run a command **as soon as the machine powers up**, (like AUTOEXEC.BAT in MS-DOS), use the [Windows Task Scheduler](schtasks.html) - choosing the option:

> Run a task:  
> When my computer starts (before a user logs on)

Autoexec.bat file
=================

> The autoexec.bat file was an MS-DOS feature. Under Windows there is a still a degree of backwards compatibility - if the file (C:\autoexec.bat) exists, any SET statements within it will be parsed at boot time.  
> Variables set in this way are not available to gui programs - they will be visible from the CMD prompt but don’t appear in the control panel. All other commands in autoexec.bat will be ignored. This behaviour is to allow old DOS applications to install correctly.

Scripts running at Windows startup
----------------------------------

> To see exactly what is running (or running slowly) at windows startup/login, set the following registry key:
> 
> [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\policies\system]  
> "verbosestatus"=dword:00000001

AutoRun
-------

> Autorun events are (mostly) restricted to drives of type DRIVE_CDROM. The default behaviour is to invoke AutoPlay. The NoAutoRun registry entry can be used to disable the AutoPlay and/or AutoRun feature on individual drives. This can be set in the registry under HKCU and/or HKLM. (If both are set then HKLM will take priority.)
> 
> The NoDriveTypeAutoRun registry entry disables or enables the AutoRun feature on all drives of the _type_ specified. It can be set in the registry under HKCU and/or HKLM. (If both are set then HKLM will take priority.)
> 
> Values:  
> 0xFF=Disable AutoRun on all types of drive  
> 0x91=Disable AutoRun on network drives,  
> 0x95=Disable AutoRun on removable + network drives.
> 
> The NoDriveAutoRun registry entry disables or enables the AutoRun feature on individual _drives_. It can be set in the registry under HKCU and/or HKLM. (If both are set then HKLM will take priority.)
> 
> In all cases the registry keys are set under:  
> \Software\Microsoft\Windows\CurrentVersion\Policies\Explorer
> 
> The registry key HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\MountPoints2 contains cached information about every removable device seen so far. This cache can bypass the registry settings above which can leave a machine vulnerable. See [Q967715](https://support.microsoft.com/en-gb/help/967715/) for patches that address this issue. Alternatively the iniFileMapping method described below will disable AutoRun completely.
> 
> To effectively disable AutoRun in all versions of Microsoft Windows, import the following registry value (source: US-Cert [Alert TA09-020A](https://www.us-cert.gov/ncas/alerts/TA09-020A)) this applies to any autorun.inf in any location and on any drive:
> 
> REGEDIT4  
> [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\IniFileMapping\Autorun.inf]  
> @="@SYS:DoesNotExist"

“The real danger is not that machines will begin to think like men, but that men will begin to think like machines” ~ Sydney J. Harris

### Related commands

[DOSKEY](doskey.html) - Edit command line, recall commands, and create macros.  
[SC](sc.html) - Service Control.  
[SET](set.html) - Display, set, or remove Windows environment variables.  
[Q967715](https://support.microsoft.com/en-gb/help/967715/) - How to disable the Autorun functionality in Windows.  
[Q137890](https://support.microsoft.com/en-us/help/137890/) - SRVANY - create an NT Service from any executable. Not supported on current OS's use a [Scheduled Task](../ps/scheduler.html) instead.



/. nt/syntax-cmd.html
========================================================

    CMD syntax - Windows CMD - SS64.com

How-to: CMD Shell
=================

Notes on working with the Windows [CMD](cmd.html) shell.

Pausing or stopping a batch script
----------------------------------

> Execution of any batch script can be paused by pressing CTRL-S this also works for pausing a single command such as a [DIR](dir.html) listing. Pressing any key will resume the operation.Execution of any batch script can be canceled by pressing CTRL-C  
>   
> If one batch file [CALL](call.html)s another batch file CTRL-C will exit both batch scripts.  
> If CMD /c is used to call one batch file from another then CTRL-C will cause only one of the batch scripts to terminate. (see also [EXIT](exit.html))

Copy and Paste / QuickEdit
--------------------------

> In Windows 10 the standard Ctrl-X & Ctrl-C shortcuts are supported.
> 
> For earlier versions of Windows you can enable QuickEdit cut and paste at the Command Prompt as follows:
> 
> Activate the control menu at the top left of the current cmd window, go to Properties, Options tab and then tick against QuickEdit Mode. Now you can select text with the mouse and hit Enter (or right click) to copy it to the clipboard. Paste anywhere using Control+V (or Right Click) or via the menu.
> 
> ESC will cancel any selection and return to editing mode.  
> When copying between windows, you need one click to select the window and a second click to paste.

Command Line Auto Completion
----------------------------

> Pressing TAB once at the command line will display the first matching file/folder, pressing TAB again and you will cycle through the other matching files and sub-directories. TAB can be used half way through typing a command, wherever you need the filename to appear.
> 
> If you type the beginning of a file/folder name, then the [TAB completion](https://blogs.msdn.microsoft.com/ddysart/2006/08/03/windows-command-line-auto-completion/) will be limited to only show matching names:
> 
> DIR c:\pro <TAB>
> 
> At the command prompt Ctrl-D gives fol**d**er name completion and Ctrl-F gives **F**ile and folder name completion.  
>   
> Adding SHIFT to Ctrl will move through the list backwards.

History of Previous Commands
----------------------------

> Pressing the UP arrow will list previous commands entered at the command prompt.  
> Other [DOSKEY](doskey.html) function keys are loaded by default (F7, F8, F9)

"Quote" Characters in a command
-------------------------------

> If /C or /K is specified, then the remainder of the command line is interpreted as a command and the following logic is used to process quote (") characters:  
>   
> 1\. If all of the following conditions are met, then quote characters on the command line are preserved:
> 
> > - No /S switch (Strip quotes)  
> > - Exactly two quote characters  
> > - No _special_ characters between the two quote characters, where _special_ is one of: & < >( ) @ ^ |  
> > - There are one or more whitespace characters between the the two quote characters  
> > - The string between the two quote characters is the name of an executable file.
> 
> 2\. Otherwise, old behavior is to see if the first character is a quote character and if so, strip the leading character and remove the last quote character on the command line, preserving any text after the last quote character. To negate this behaviour use a double set of quotes "" at the start and end of the command line.
> 
> CMD /c ""c:\work\my reports\profit ^& Loss.doc""

Command.com vs CMD.exe
----------------------

> All the commands on these pages assume you are running the 32 bit or 64 bit command line (cmd.exe)  
>   
> The old 16 bit command processor command.com is supplied to provide backward compatibility for 16 bit DOS applications. Command.com has very limited functionality compared to cmd.exe e.g. it will fail to set an %errorlevel% after many commands.  
>   
> If you name your batch scripts with the extension .CMD rather than .BAT then they will not run under command.com even if copied to a Windows 95 machine.  
>   
> The %COMSPEC% environment variable will show if you are running CMD.EXE or command.com  
> 
> One key difference between .CMD and .BAT scripts (running under CMD.EXE) is that with extensions enabled, commands like PATH/APPEND/PROMPT/SET/ASSOC will reset ERRORLEVEL to 0 if they succeed. In the old style .BAT file, the ERRORLEVEL will not be changed unless there is a new error ([source](https://groups.google.com/forum/#!msg/microsoft.public.win2000.cmdprompt.admin/XHeUq8oe2wk/LIEViGNmkK0J)).
> 
> On 64 bit versions of Windows, the 32 bit CMD.exe can be found at %windir%\SysWoW64\cmd.exe To reduce compatibility issues, the WOW64 subsystem isolates 32-bit binaries from 64-bit binaries by redirecting registry calls and some file system calls.

Registry Keys:
--------------

> Allow UNC paths at command prompt
> [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Command Processor]
> "DisableUNCCheck"=dword:00000001
> 
> Run a command when CMD.exe starts
> [HKEY_LOCAL_MACHINE\Software\Microsoft\Command Processor]
> "AutoRun"=-
> 
> Activate Automatic Completion (this is on by default for all recent versions of Windows)
> [HKEY_LOCAL_MACHINE\Software\Microsoft\Command Processor]
> "CompletionChar"=0x9
> 
> For Windows 7: Add an elevated 'Open CMD prompt here (Admin)' option to the 
> context menu for file system folders:
> [HKEY_CLASSES_ROOT\Directory\shell\runas]  
> @="Open CMD prompt here (Admin)"
> [HKEY_CLASSES_ROOT\Directory\shell\runas\command]
> @="cmd.exe /k pushd %L"
> 
> For Windows 7: Add an elevated 'Open CMD prompt here (Admin)' option to the 
> My Computer context menu:
> [HKEY_CLASSES_ROOT\CLSID\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\shell\runas]
> @="Open CMD prompt here (Admin)"
> [HKEY_CLASSES_ROOT\CLSID\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\shell\runas\command]
> @="cmd.exe"
> 
> For Windows 10  
> See [this article on TenForums](https://www.tenforums.com/tutorials/59686-open-command-window-here-administrator-add-windows-10-a.html)

Running multiple instances of CMD.exe
-------------------------------------

> At the command line or in a batch script CMD will start a new instance of CMD.exe which will appear in the same window. The [EXIT](exit.html) command will close the second CMD instance and return to the previous shell.  
>   
> A method of calling one Batch script from another is to run a command like CMD /c C:\docs\myscript.cmd  
>   
> The output of CMD can be redirected into a text file. When CMD /c is used, the EXIT command is not required.  
>   
> 
> The native version of CMD.exe is always in %windir%\system32, on 64 bit operating systems there is also a 32 bit CMD.exe in %windir%\SysWOW64

Long Commands and long filenames
--------------------------------

> The maximum length of any command line (or variable) within CMD is [8191](https://support.microsoft.com/en-gb/help/830473/) characters.  
> For all versions of Windows, NTFS and FAT allows [pathnames](path.html) of up to 260 characters.  
>   
> A workaround for the limited pathname length is to prefix \?\  
> for example:  
> \?\C:\TEMP\Long_Directory\Long_Filename.txt

The environment Variable %CmdCmdLine% will expand into the original command line calling CMD.EXE or a [batch script](syntax-run.html).

“The method of the enterprising is to plan with audacity and execute with vigor” ~ John Christian Bovee

### Related commands

[CMD](cmd.html) - Start a new CMD shell.  
How-to: [Run a script](syntax-run.html) - How to create and run a batch file.  
How-to: [CMD Internal](syntax-internal.html) - Commands that are Internal to the CMD shell.  
[Clink](https://mridgers.github.io/clink/) - Powerful Bash-style command line editing/auto-complete for cmd.exe  
[ConEmu-Maximus5](https://conemu.github.io/) - a Windows console emulator with tabs.



/. nt/syntax-internal.html
========================================================

    Internal commands - Windows CMD - SS64.com

How-to: Internal commands
=========================

The Windows CMD shell [CMD.exe](cmd.html) contains a number of 'internal' commands, additional 'external' commands are also supplied as separate executable files. External commands are generally stored in the C:\WINDOWS\System32 folder, this folder is part of the system [PATH](path.html) .

This arrangement means that both internal and external commands are always available no matter what your [current directory](cd.html) happens to be.

ASSOC, BREAK, CALL ,CD/CHDIR, CLS, COLOR, COPY, DATE, DEL, DIR, DPATH, ECHO, ENDLOCAL, ERASE, EXIT, FOR, FTYPE, GOTO, IF, KEYS, MD/MKDIR, MKLINK (vista and above), MOVE, PATH, PAUSE, POPD, PROMPT, PUSHD, REM, REN/RENAME, RD/RMDIR, SET, SETLOCAL, SHIFT, START, TIME, TITLE, TYPE, VER, VERIFY, VOL

In the main [A-Z list of CMD commands](index.html) the internal commands are indicated with a •

When you are working from any other shell, such as PowerShell then none of the internal commands are available unless you first open a CMD shell.

Passing arguments
-----------------

> Arguments can be passed to an internal command, just like an external command, e.g. COPY /Y  
> In some cases (when the command is being parsed by CMD.exe) the space before each argument can be omitted e.g. COPY/Y this can save time when working at the command line, but for scripts and scheduled tasks it is better to include the space.
> 
> for example from PowerShell:
> 
> PS C: > cmd /c date /t
> 
> will launch a CMD shell, run the DATE /T command and then exit back to PowerShell. Of course in many cases this is not neccessary, (PowerShell has its own Date command) but can be useful if you need to run something 'the old way'.

It is possible for a system to have an internal command and an external command with the same name. If you have a command called DATE.exe and want to run that in preference to the internal DATE command, use the full pathname to the file e.g. C:\utils\date.exe even if your current directory is C:\utils\

“Tongues, like governments, have a natural tendency to degeneration; we have long preserved our constitution, let us make some struggles for our language” - Samuel Johnson: Preface to the Dictionary

### Related commands

[Which.cmd](syntax-which.html) - Show full path to executable.  
How-to: [Escape Characters, Delimiters and Quotes](syntax-esc.html)



/. nt/syntax-compatibility.html
========================================================

    App Compatibility - Windows CMD - SS64.com

How-to: App compatibility
=========================

To run old applications in Windows 10 it is possible to set the compatibility options under **File Properties ➞ Compatibility**.

This is a per user setting stored in the registry, so it will only work for executables on the local hard drive not on a network drive. It also will not work for protected files delivered as part of the OS such as notepad.exe. It is possible to make a copy of a system file and set the properties on that, or to create a shortcut and set the shortcut properties.

All of the settings in the Compatibility tab can also be set directly via the registry:

HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers  
or for all users:  
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers

*   The value (not the data) is the full path/filename of the application that needs to be modified.
*   The data is a syntax string as enumerated below.  
    Each entry is a string (REG_SZ) value.

It is important to specify the options in the correct order, the sequence in which the options are displayed in the compatibility tab.

**Syntax** Windows 10:  
   ~ [Privilege Level] + [Settings (value(s) with space between)] + [Compatibility Mode (only one)]

Privilege Level (pick only one or none) :  

    ELEVATECREATEPROCESS  = Launch a child program as Administrator  ([Vista only](https://docs.microsoft.com/en-us/previous-versions/bb756937(v=msdn.10)))  
    RUNASADMIN            = RUN AS ADMINISTRATOR

Settings:  

    256COLOR     = Reduce color mode (8-bit 256 colors)
    16BITCOLOR   = Reduce color mode (16-BIT 65536 colors)
    640X480      = RUN IN 640X480 RESOLUTION
     
    PERPROCESSSYSTEMDPIFORCEOFF  Override system [DPI](syntax-dpi.html) @Windows logon  (Win10 build 17063)
    PERPROCESSSYSTEMDPIFORCEON   Override system [DPI](syntax-dpi.html) @Application start  (Win10 build 17063)
    HIGHDPIAWARE       Disable Display Scaling on High [DPI](syntax-dpi.html) Settings - Scaling performed by: Application
    DPIUNAWARE         Scaling performed by: Application   (Win10 build 15002+)
    GDIDPISCALING DPIUNAWARE     Scaling performed by: System (Enhanced)  (Win10 build 15002+)

Compatibility Mode (pick only one) :  

    WIN95
    WIN98
    WINXPSP2
    VISTARTM
    VISTASP1
    VISTASP2
    WIN7RTM
    WIN8RTM

### Examples

Set WinXP compatibility for a program running under Windows 10 and Run as Admin (elevate):

~ RUNASADMIN WINXPSP2

“It's a poor sort of memory that only works backwards” - Lewis Carroll

### Related commands

How-to: [Elevate](syntax-elevate.html) - Run with elevated permissions (As Admin).[](syntax-esc.html)



/. nt/errorlevel.html
========================================================

    Errorlevel - Windows CMD - SS64.com

Errorlevel and Exit codes
=========================

Almost all applications and utilities will set an Exit Code when they complete/terminate.

The exit codes that are set do vary, in general a code of 0 (false) will indicate successful completion.  
By default SCCM will only consider 0 a success, but commands like Robocopy may return success Exit Codes from 0 to 7.

The exit codes set by resource kit utilities are not always consistent, they can vary between machines with different Service packs/Resource kit updates applied. Some utilities will return negative numbers as an exit code.

If you attempt to execute a non-existent command %ERRORLEVEL% will be set to 9009

Detecting Errorlevels
---------------------

> There are two different methods of checking an errorlevel, the first syntax provides compatibility with old .bat batch files from the era of MS-DOS
> 
> The errorlevel is made available via IF ERRORLEVEL ... or the %ERRORLEVEL% variable.
> 
> [IF](if.html) ERRORLEVEL _n_ statements should be read as IF _Errorlevel_ >= _number_  
> i.e.  
> IF ERRORLEVEL 0 will return TRUE whether the errorlevel is 0, 1 or 5 or 64  
> IF ERRORLEVEL 1 will return TRUE whether the errorlevel is 1 or 5 or 64  
> IF NOT ERRORLEVEL 3 means if ERRORLEVEL is less than 3 ( 2, 1, 0 or a negative number).
> 
> To check for a specific error level _N_, you can use the following construct:
> 
> IF ERRORLEVEL _N_ IF NOT ERRORLEVEL _N+1_ _COMMAND_
> 
> This is not very readable or user friendly and does not account for negative error numbers.
> 
> A preferred method of checking Errorlevels is to use the %ERRORLEVEL% pseudo variable:
> 
> IF %ERRORLEVEL% NEQ 0 Echo An error was found  
> IF %ERRORLEVEL% EQU 0 Echo No error found
> 
> IF %ERRORLEVEL% EQU 0 (Echo No error found) ELSE (Echo An error was found)  
> IF %ERRORLEVEL% EQU 0 Echo No error found [||](syntax-conditional.html) Echo An error was found
> 
> This allows you to trap errors that can be negative numbers, you can also test for specific errors:  
> IF %ERRORLEVEL% EQU 64 ...
> 
> When ending a [subroutine](call.html), you can use [EXIT /b _N_](exit.html) to set a specific ERRORLEVEL _N_.
> 
> Raymond Chen [MSFT] explains: ERRORLEVEL is [not the same as](https://devblogs.microsoft.com/oldnewthing/?p=20743) the %ERRORLEVEL% environment variable.

Error Message/Error Stream
--------------------------

> In addition to setting an ERRORLEVEL, many utilities will output an error message on the error stream (STDERR), by default these messages will appear on the console, but they can be [redirected](syntax-redirection.html) with 2>.
> 
> Many utilities set an ERRORLEVEL and also output some error text, some utilities set an ERRORLEVEL but don’t display error text and some will display error text without setting an ERRORLEVEL. Some utilities behave differently depending on the severity of the error.
> 
> Error messages are likely to be different for each language/[locale](../locale.html) so it is generally more robust to just test the ERRORLEVEL rather than any text message output.

Error level vs Exit code
------------------------

> When an external command is run by CMD.EXE, it will detect the executable's Return or Exit Code and set the %ERRORLEVEL% to match.  
> In the majority of cases [command extensions](cmd.html#commandextensions) are enabled and so the %ERRORLEVEL% will be the same as the Exit code. It is possible to break this by manually creating a user variable called %ERRORLEVEL%.
> 
> An Exit Code can be detected directly with [redirection operators](syntax-redirection.html) Success=0 or Failure<>0. This is equivalent to IF ERRORLEVEL 1.

Old style .bat Batch files vs .cmd Batch scripts.
-------------------------------------------------

> Although the differences are minor, there are no advantages to the .BAT extension, so I recommend using .CMD exclusively.
> 
> There is a key difference between the way .CMD and .BAT batch files set errorlevels:
> 
> A .CMD batch script will set/reset the ERRORLEVEL after every command that you run [[source]](https://groups.google.com/forum/#!msg/microsoft.public.win2000.cmdprompt.admin/XHeUq8oe2wk/LIEViGNmkK0J) Mark Zbikowski (MSFT).  
> 
> > A .BAT batch script running the internal commands: APPEND, ASSOC, PATH, PROMPT, FTYPE and SET will only change the ERRORLEVEL if an error occurs. Other internal and external commands do not follow this rule.
> > 
> > So if you have two commands in a .BAT script and the first command fails but the second succeeds, the ERRORLEVEL may or may not remain set depending on which command was run.
> > 
> > This lack of consistency in the ERRORLEVELs raised makes debugging a .BAT script more difficult than an equlvalent .CMD script.

Even in the CMD shell, some commands don’t follow the rules
-----------------------------------------------------------

> Even though a CMD batch script should set or reset ERRORLEVEL after every command, there are a few exceptions:
> 
> Commands that do NOT affect the ERRORLEVEL:  
> BREAK, ECHO, ENDLOCAL, FOR, IF, PAUSE, REM, RD/RMDIR, TITLE
> 
> Commands that will set but not clear an ERRORLEVEL:  
> CLS, GOTO, KEYS, POPD, SHIFT
> 
> Commands that set an Exit Code but not the ERRORLEVEL:  
> RD/RMDIR
> 
> Commands that set an ERRORLEVEL but not the Exit Code ([SO explanation](https://stackoverflow.com/questions/34936240/batch-goto-loses-errorlevel/34937706#34937706)):  
> MD/MKDIR

Set or Force an exit code
-------------------------

> You can make a [batch file](syntax-run.html) return a non-zero exit code by using the [EXIT](exit.html) command.
> 
> Exit 0  
> Exit /B 5
> 
> To force an ERRORLEVEL of 1 to be set _without_ exiting, run a small but invalid command like [COLOR](color.html) 00 or run (CALL) which does nothing other than set the ERRORLEVEL to 1.
> 
> To clear the ERRORLEVEL back to 0, run (call ), which does nothing except set the ERRORLEVEL to 0.
> 
> You should never attempt to [SET](set.html) the %ERRORLEVEL% because that will create a user variable named %ERRORLEVEL% which then takes precedence over the internal pseudo variable %ERRORLEVEL%.  
> You can clear any such user variable with the following command but really the best practice is to never set a variable with that name in the first place:  
> Set "errorlevel="  

PowerShell
----------

> In PowerShell $? contains True if last operation succeeded and False otherwise.
> 
> The exit code of the last Win32 executable execution is stored in the automatic variable $LASTEXITCODE
> 
> To read exit codes (other than 0 or 1) launch the PowerShell script and return the $LASTEXITCODE in a single line like this:
> 
> [powershell.exe](../ps/powershell.html) -noprofile C:\scripts\script.ps1; exit $LASTEXITCODE  

“I’d rather wake up in the middle of nowhere than in any city on earth” ~ Steve McQueen

### Related commands

[Robocopy exit codes](robocopy-exit.html)  
[Conditional Execution](syntax-conditional.html) - if command1 succeeds then execute command2  
HowTo: [Error Handling in a batch file](syntax-error.html)  
List of [ERRORLEVEL values](https://stackoverflow.com/questions/34987885/what-are-the-errorlevel-values-set-by-internal-cmd-exe-commands/34987886#34987886) set by internal cmd.exe commands - Stackoverflow /Aacini.  
[ERRORLEVEL is not %ERRORLEVEL%](https://devblogs.microsoft.com/oldnewthing/?p=20743) - The old new thing blog.



/. nt/syntax-error.html
========================================================

    Error Handling in a batch file - Windows CMD - SS64.com

How-to: Error Handling in a batch file
======================================

When an executable program runs and completes a task, it will return an [Exit Code](errorlevel.html) indicating success or failure. A batch file or batch subroutine can also emulate this behaviour by setting an exit code with [EXIT /b](exit.html)

A popular way to branch on an error, is to use the [redirection](syntax-redirection.html) operators for success && and failure || as shown below:

@Echo off  
_SomeCommand_ && (  
  Echo success  
) || (  
  Echo failed/error  
)

The code stub above can be expanded, instead of just an ECHO statement, you could [CALL](call.html) a subroutine or use [EXIT /b](exit.html) to close the script immediately. This will also work to test the ERRORLEVEL within a [parenthesized](syntax-brackets.html) block of code.

There is one [gotcha](https://stackoverflow.com/a/17085933/1720814) which is that the success/failure state is evaluated on each line, so if you have multiple lines/commands and the last command in the success branch raises an error, then the error branch will fire. To avoid that make sure that last command in the success branch is (call ), which does nothing except set the ERRORLEVEL to 0.

A second problem with the redirection operators is that they make the assumption that a successful operation will return an ERRORLEVEL of 0 and a failure will return some non-zero exit code. This is not always the case, the DEL command will return zero even when it fails to delete and the ROBOCOPY command will return non zero exit codes even when it does a successful copy.

To test for a specific ERRORLEVEL, use an IF command with the %ERRORLEVEL% variable. n.b. Some errors may return a negative number.

@Echo off  
_SomeCommand_  
IF %ERRORLEVEL% [NEQ](if.html) 0 (Echo An error was found &Exit /b 1)

If the batch file is being executed as a [scheduled task](schtasks.html), then exiting with an error code will be logged as a failed task.  
You can monitor the event log to discover those failures.

“If error is corrected whenever it is recognised as such, the path of error is the path of truth.” ~ Hans Reichenbach

### Related commands

[Errorlevel](errorlevel.html) - CMD's handing of Exit codes and the %ERRORLEVEL% variable.  
[Robocopy exit codes](robocopy-exit.html)  
How-to: [Conditional Execution](syntax-conditional.html) - if command1 succeeds then execute command2  
List of [ERRORLEVEL values](https://stackoverflow.com/questions/34987885/what-are-the-errorlevel-values-set-by-internal-cmd-exe-commands/34987886#34987886) set by internal cmd.exe commands - Stackoverflow /Aacini.



/. nt/slow_browsing.html
========================================================

    Slow Network Browsing - Windows CMD - SS64.com

Slow network browsing issues in Windows
=======================================

This page was written for Windows 7 when the insecure and deprecated [SMB1](https://aka.ms/stopusingsmb1) protocol was still in widespread use. The same issues do, in some cases, affect performance for Windows 10 clients using mapped drives or UNC connections, but not to the same catastrophic extent.

1) Listing the contents of a shared folder is slow - Desktop.ini
----------------------------------------------------------------

> The file permissions set on desktop.ini files can slow down browsing the folder structure.  
> 
> When listing a directory, Windows will search for and parse Desktop.ini files. This will noticably affect performance when a large number of subfolders are involved, it does this for the current folder and one level down the directory tree.
> 
> Desktop.ini can be used to provide a custom icon, thumbnail view, and can make a normal file folder appear as a 'Special Folder'.  
> Standard folders where this is often used: Fonts, History, Temporary Internet Files, "My Music", "My Pictures", and "My Documents".
> 
> In the case of "My Documents" navigation can be difficult when you have thousands of folders all displaying the same thing.
> 
> Desktop.ini files are only visible in Windows Explorer if you first un-check "Hide protected operating system files" (under Tools, Options, View).
> 
> To see the read/write [file locks created by this process](syntax-share-modes.html), run the following command on the file server, while a client is (slowly) listing a large directory:  
> NET FILE | Find "desktop.ini"
> 
> To resolve this issue either remove the READ_ONLY permission from the folder or simply delete the non-essential desktop.ini files from the top level of the users home drives:
> 
> $UserFolders = Get-ChildItem ("\fileserver\users") | Where-Object {$_.PSIsContainer} | Foreach-Object {$_.FullName}
> Foreach ($User in $UserFolders) {
> 	$iniFile = $User + "\desktop.ini"
> 	Remove-Item -Path $iniFile -Force -whatIf
> }

2) Explorer randomly locks files
--------------------------------

> There are [reports](https://www.techspot.com/community/topics/windows-explorer-becomes-very-slow-and-or-stops-responding.48091/) that Windows Explorer can run very slowly or stop responding if some of the profile permissions get corrupted.
> 
> To fix this logout and login with a different (Administrator level) account and rename this folder:
> 
> C:\Users\<_profilename_>\AppData\Local\Microsoft\Windows
> 
> When you login again the folder will be re-created with the correct permissions.

3) ) Network Shortcuts on the Start menu and Desktop
----------------------------------------------------

> Placing a shortcut to a network resource in either the Start menu or Desktop (including the recycle bin) can drastically slow down system response, particularly when the network resource is unavailable. Shortcuts to _Domains_ or _Machines_ don’t suffer from these problems as they always have the same icon.
> 
> A sensible routine for managing desktop shortcuts can be found [here](https://ask.metafilter.com/172010/Shortcuts-and-Memory#2474481).
> 
> An alternative workaround is to create a shortcut to [Explorer.exe](explorer.html) and pass the UNC name of the resource.  
> explorer /e, \Server\FileShare

"Total world oil reserves amount to one thousand billion barrels, yearly consumption is 27 billion barrels" ~ BP Amoco

### Related commands

[CleanRoamingProfile.vbs](../vb/syntax-profile.html) - VBScript to delete selected files from a roaming profile.  
[SysInternals](https://docs.microsoft.com/en-gb/archive/blogs/markrussinovich/an-explosion-of-audit-records) - Mark Russinovich - Desktop.ini files fill up the audit event log.  
[Q822219](https://support.microsoft.com/en-gb/help/822219/) - Slow File Server Performance.  
[Q814112](https://support.microsoft.com/en-gb/help/829700/) - Network shares open slowly SMB/AntiVirus scanning .  
[Q326549](https://support.microsoft.com/en-gb/help/326549/) - Read-only & System attributes for folders.  
[Q321281](https://support.microsoft.com/en-gb/help/321281/) - Desktop.ini does not work correctly when you customise the Default Profile.  
[Q320829](https://web.archive.org/web/20130621234159/https://support.microsoft.com/kb/320829) - Increase the _Request Size Buffer_ on the file server - (try between 32 and 64 Kb)  
[Q319470](https://web.archive.org/web/20100302083831/https://support.microsoft.com/kb/319470/) - Office2000: Screen response is slow in Save As dialog box in Word.  
[Q312403](https://support.microsoft.com/en-gb/help/312403/) - Distributed Link Tracking.  
[CleanMgr](cleanmgr.html) - Automated cleanup of Temp files, recycle bin.  



/. nt/syntax-ntlm.html
========================================================

    .low { background-color: #C00000; text-align: center; } .med { background-color: #95B3D7; text-align: center; } .high { background-color: #92D050; text-align: center; } .na { text-align: center; } table { border: 2px; border-collapse: collapse; } td, th{ border: 1px solid #999; padding: 6px 8px; margin: 0; } th{ background-color: #aaa; vertical-align: top;} NTLM - Windows CMD - SS64.com

How-to: Windows LAN Manager authentication level
================================================

This setting affects how a Windows computer handles NTLM authentication both as a client and as an authenticating server.

The default level of (3) for current OS's allows Domain Controllers to be compatible with old clients going back to Windows 2000.

LMCompatibilityLevel:

*  L0  Send LM & NTLM responses  
*  L1  Send LM & NTLM - use NTLMv2 session security if negotiated.
*  L2  Send NTLM response only  
*  L3  **Send NTLMv2 response only**  
*  L4  Send NTLMv2 response only/refuse LM  
*  L5  Send NTLMv2 response only/refuse LM & NTLM

This level is the default for these OS's:

*  L0 - Windows 2000/XP
*  L2 - Windows 2003
*  L3 - Windows 7 / 2008 and above.

|   | L0 | L1 | L2 | L3 | L4 | L5 |
|---|----|----|----|----|----|----|
| Clients Receive: LM | Yes | Yes | No | No | No | No
| Clients Receive: NTLM | Yes | Yes | Yes | No | No | No
| Clients Receive: NTLMv2 | No | Negotiated | Negotiated | Yes + Session Security | Yes + Session Security | Yes + Session Security
| DCs accept: LM | Yes | Yes | Yes | Yes | No | No
| DCs accept: NTLM | Yes | Yes | Yes | Yes | Yes | No
| DCs accept: NTLMv2 | Yes | Yes | Yes | Yes | Yes | Yes 

Best practices are dependent on your specific security and authentication requirements.

If LMCompatibilityLevel on a server is increased to 4 or 5 for better security, any Windows XP/2000 user who tries to authenticate will experience a logon failure that has a bad password and increments the bad password count. If account lock-out is configured, the user will eventually be locked out.

Increasing the LMCompatibilityLevelabove 3 on a client will make no difference, but it can be lowered if there is a need to communicate with very old servers.

The NTLM version (0-5) is stored in the registry (as a DWORD):  
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\LSA\LMCompatibilityLevel  
  
or it can be set in the local Security policy (secpol.msc)  
under: Local policies\Security Options\Network Security: LAN Manager Authentication level

“When a deep injury is done us, we never recover until we forgive” ~ Alan Paton

### Related commands

[LAN Manager authentication level](https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-lan-manager-authentication-level) - Docs.Microsoft.com  
[NTLM authentication](https://docs.microsoft.com/en-us/previous-versions/technet-magazine/cc160954(v=msdn.10)?redirectedfrom=SS64) - The most misunderstood Windows security setting of all time by Jesper Johansson.  
[NTLM protocol](http://davenport.sourceforge.net/ntlm.html) - In depth detail of the protocol and related Security Support Provider (SSP ) - Eric Glass.



/. nt/syntax-logon-types.html
========================================================

    Logon Types - Windows CMD - SS64.com

How-to: Windows Logon Types
===========================

Windows [Event ID 4624](https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4624) displays a numerical value for the type of login that was attempted.

*  2 Interactive logon.

    A user logged on to this computer. A type 2 logon is logged when you log on (or attempt to log on) at a Windows computer’s local keyboard and screen. Credentials in memory and cached credentials. This event can also be generated using RunAs.

*  3 Network logon.

    A user or computer logged on to this computer from the network. This logon occurs when you access remote file shares or printers. Credentials don’t get stored in lsass or on disk. Most logons to Internet Information Services (IIS) are classified as network logons, other than IIS logons that use the basic authentication protocol (logon type 8).

*  4 Batch logon.

    Used for scheduled tasks, where processes may be executing on behalf of a user without their direct intervention. The Windows Scheduler service creates a new logon session when starting a scheduled task. Credentials hit disk and memory. LSA secrets are stored in an encrypted form in the registry, HKEY_LOCAL_MACHINE/Security/Policy/Secrets key.

*  5 Service logon.

    Services and service accounts that log on to start a service. Credentials hit disk and memory. LSA secrets are stored in an encrypted form in the registry, HKEY_LOCAL_MACHINE/Security/Policy/Secrets key. When a service starts, Windows first creates a logon session for the user account that is specified in the service configuration.

*  7 Unlock.

    The workstation was unlocked. Lack of a 7 event does not mean there was no unlock.

*  8 Network clear text logon.

    A user logged on to this computer from the network. The user's password was passed to the authentication package in its unhashed form. The built-in authentication packages all hash credentials before sending them across the network. The credentials do not traverse the network in plaintext (also called cleartext). Also when using basic authentication to an IIS server. IPSec can mitigate.

*  9 New credentials-based logon.

    This is used when you run an application using the RunAs command and specify the /netonly switch. When you start a program with RunAs using /netonly, the program starts in a new logon session that has the same local identity (this is the identity of the user you are currently logged on with), but uses different credentials (the ones specified in the runas command) for other network connections. Without /netonly, Windows runs the program on the local computer and on the network as the user specified in the runas command, and logs the logon event with type 2.

*  10 Remote Interactive logon.

    A user logged on to this computer remotely using an RDP-based application like Terminal Services or Remote Desktop. 3rd party software like virtualization consoles and screen share can also generate it. Credentials were in memory (lsass) and also hit cached credentials.

*  11 Cached Interactive logon.

    A user logged on to this computer with network credentials that were stored locally on the computer. The domain controller was not contacted to verify the credentials. Windows supports logon using cached credentials to ease the life of mobile users and users who are often disconnected. Cached Credentials are stored in mscache2 format which contrary to popular belief can be cracked.

“You own everything that happened to you.  
  Tell your stories. If people wanted you to write warmly about them, they should have behaved better” ~ Anne Lamott

### Related commands

[NTRIGHTS](ntrights.html) - Edit user account rights.  
[RUNAS](runas.html) - Execute a program under a different user account.  
[WEVTUTIL](wevtutil.html) - Retrieve information about event logs.  
[Windows Event IDs](../ps/syntax-eventids.html) - Event Log.



/. nt/syntax-filenames.html
========================================================

    Long filenames - Windows CMD - SS64.com .notallowed {color: ##8c0376;}

How-to: Long filenames, NTFS and legal filename characters
==========================================================

Path Names and Normalisation
----------------------------

> If a filename or pathname contains spaces you must surround it with double quotes: "my file.txt" , "\My Files\demo.txt"  
> Names that include single quotes or parenthesis (') are legal filenames but they can cause issues with batch files where these characters have special meaning.
> 
> The Win32 file API has a string normalisation process which consists of: Replacing any forward slashes (/) with backslashes (\), Collapsing repeated backslash separators into one, Resolving relative paths replacing any . or .. and lastly Triming any trailing spaces and periods.
> 
> PowerShell does a better job of supporting these than CMD, so DIR C:/demo/sample.txt will work in PowerShell but not in CMD.

| Type | Example |
|------|---------|
| Absolute Drive Path  | `C:\demo\sample.txt`
| Relative to current drive/directory  | `\demo\sample.txt   .sample.txt   [..](cd.html)\sales.txt`
| Relative to current Directory  | `CD \demo   E:   C:sample.txt`
| UNC path  | `\server64\demo\sample.txt`
| Device path (normalized)  | `\.\C:\demo\sample.txt`
| Device path (literal)  | `\?\C:\demo\sample.txt`

Illegal Characters
------------------

The following characters are **not** permitted:
 
> Windows File/Directory names  
> NTFS / OneDrive / SharePoint online  
> / NETBIOS Computer name 

    / >  \ :  * ? " < > |
    Leading and/or trailing spaces. (see note below)

> 8.3 format Filename

    / \ : ; , * ? " | [  ] =
    any space

> SMB Share Name

    / \ : ; , * ? " < > | [ ] + = 
    Leading and/or trailing spaces.


> sAMAccountName or logon name

    / \ : ; , * ? " < > | [ ] = +

> DNS Host name or Domain name

    { } : ~ , @ ! ' ( )  # $ % ^ & _ .
    any space

> Active Directory

    \ ; , " < > #  +
    Leading and/or trailing spaces.


> *   Windows Explorer will not create files with a period (.) as the first, last or only character in the filename, although NTFS (and many command-line tools) do support such files.
> *   The period character, ".", is also allowed for sAMAccountName / logon name/ computer name, but it cannot be the final character in a sAMAccountName.
> *   The colon : is reserved for use to indicate an Alternate Data Stream.
> *   Any name that the target file system does not allow will not be created. [[source](https://docs.microsoft.com/en-us/windows/win32/fileio/naming-a-file)]
> *   The control characters whose integer representations are in the range from [0 through 31](../ascii.html), including the [ASCII](../ascii.html) NUL character are only supported for alternate data streams.
> *   Legal characters in an NTFS filename include any character in the current code page, including Unicode characters,  
>     so the following are all valid [ ] . ; = ( ) ☺
> *   Active Directory allows a wide range of punctuation and spaces in object names. To allow easy scripting, prefer alphanumerics, dash and underscore, so Sales-Directors or SalesDirectors rather than "Sales Directors".
> *   Windows NTFS allows spaces at the beginning of names, but not at the end.  
>     Windows File Explorer will not create files with trailing spaces, but some applications may. Trailing spaces can be removed with a wildcard rename or using third party software e.g. 7Zip.
> 
> Characters which can be used any filename: A-Z, a-z, 0-9 ! - ( ) + _ {  } ~
> 
> A path name may be no more than 2,048 characters in length. Individual components in the path can be a maximum of 255 characters in length.
> 
> NTFS supports paths up to 32,768 characters in length, but only when using the Unicode APIs.  
>   
> When using very long path names, prefix the path with the characters \?\ and use the Unicode versions of the C Runtime functions.

Win32 Device Namespaces
-----------------------

> The "\.\" prefix will access the Win32 **device** namespace instead of the Win32 **file** namespace. This allows access to physical disks and volumes is accomplished directly, (where the API supports this type of access).
> 
> e.g.  
> "\.\COM1"  
> "\.\COM56"  
> `"\.\C:\demo\sample.txt`"
> 
> The NTFS file system supports long paths and file names up to 32,767 unicode characters, normally this is restricted by the 260 character* MAX_PATH limit enforced by the Windows Win32 API. This means it is possible, when moving files and directories around, or [mapping](../vb/syntax-mapdrive.html) drives, to create a pathname which is too long for Win32 to process.
> 
> The "\?\" Literal device prefix to a path string tells the Windows APIs to [disable](https://stackoverflow.com/q/25090101/1720814) all string normalisation and to send the string that follows it straight to the file system. This is useful for accessing very long filenames:
> 
> dir "\?\Z:\Teams\Personnel\some - very - long - file - name.txt"
> 
> dir "\?\UNC\Server64\Teams\Personnel\some - very - long - file - name.txt"
> 
> Because it turns off automatic expansion of the path string, the "\?\" prefix also allows the use of ".." and "." in the path names, which can be useful if you are attempting to perform operations on a file with these otherwise reserved relative path specifiers as part of the fully qualified path. This syntax can be used in both CMD and PowerShell.
> 
> Starting in Windows 10, version 1607, MAX_PATH limitations have been removed from common Win32 file and directory functions. However, you must [opt-in to](https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file) the new behavior.
> 
> * The 260 character limit has a couple of caveats, it includes a null terminator character and every folder must be able to hold a file that is 8.3 characters long (8+3+'.' = 12 characters). This means that the longest _FOLDER_ you can create is 260 - 12 - 1 = **247** characters.
> 
> This syntax can be used to get around many of the naming limitations inherent in Win32 (which are listed at the bottom of this page) while this can be useful to access otherwise unreadable data, it is also sometimes used to obfuscate files and directories.
> 
> See the [DEL](del.html) page for more on deleting very long filenames.

Short file names (8.3)
----------------------

> Prior to Windows 95 in 1995, Windows only supported short 8.3 filenames.
> 
> Short filenames are compatible with MS-DOS and other legacy operating systems and have between 1 and 8 characters in the file name followed by a file name extension of between zero and three characters long.
> 
> The name must start with a letter or a number. A period separates the file name from the file name extension.
> 
> Microsoft disabled the generation of short filenames (8.3) by default starting with Windows 8 / Server 2012. If they exist you can use the [parameter extensions](syntax-args.html) %~sp1 to expand %1 to return an 8.3 pathname.
> 
> In any directory containing more than 25,000 files there is a [significant performance](https://www.linkedin.com/pulse/dont-forget-disable-short-filenames-83-servers-folders-wes-brown/) cost ~ 6,000 files per hour vs 2 million files per hour.
> 
> If it exists, the old short 8.3 filename can be used to bypass the 260 character pathname limit e.g. to delete a very long file.
> 
> The order in which you create files will affect short 8.3 names  
> e.g.  
> echo abc > "a long file 1.txt"  
> echo abc > "a long file 3.txt"  
> echo abc > "a long file 2.txt"  
> DIR /x  
> :: will produce this:  
> ALONGF~1.TXT "a long file 1.txt"  
> ALONGF~3.TXT "a long file 2.txt"  
> ALONGF~2.TXT "a long file 3.txt"  
>   
> If these files are now copied to another folder the 8.3 filenames will change, this is most likely to happen when upgrading server storage or restoring data from a backup.
> 
> Similarly for folders  
> md "a long folder 1"  
> md "a long folder 3"  
> md "a long folder 2"  
> DIR /x  
> :: will produce this:  
> ALONGF~1 "a long folder 1"  
> ALONGF~3 "a long folder 2"  
> ALONGF~2 "a long folder 3"  
>   
> Again copying these to somewhere else will change the 8.3 names to:  
> ALONGF~1 "a long folder 1"  
> ALONGF~2 "a long folder 2"  
> ALONGF~3 "a long folder 3"  
> 
> See the [Wildcards](syntax-wildcards.html) page for more long/short filename issues.
> 
> Some characters are invalid in 8.3 format filenames but are valid in NTFS filenames and are also valid [Delimiters](syntax-esc.html) Typically the Windows GUI will silently change the 8.3 name for such files where necessary, for example DE=MO.TXT will become DE_MO~1.TXT
> 
> You can use long file names in both NTFS and FAT volumes (typically removable flash drives and memory cards).

Enable or Disable 8.3 filenames in NTFS
---------------------------------------

> For backwards compatibility, Windows has an option to generate an 8.3 equivalent short filename for every long filename.  
> If a filename is already 8.3 characters or less, this is not needed, but for a file like "**My long filename.txt**" it will generate a (largely hidden) second name such as **MYLONG~1.TXT**
> 
> If 8.3 equivalent filenames are disabled, ancient 16 bit software (like WordPerfect 3) will still be able to read/write short filenames, but won’t see a short equivalent for long filenames.
> 
> Fresh Windows installations now have the generation of 8.3 equivalent filenames turned OFF by default.  
> Disabling 8.3 filenames will provide a small improvement in directory enumeration performance.
> 
> The SQL Server FILESTREAM feature [recommends](https://support.microsoft.com/en-gb/help/2160002/recommendations-and-guidelines-for-improving-sql-server-filestream-per) that 8.3 filename support is turned OFF along with the "last access time" property.
> 
> Disable the creation of 8.3 equivalent filenames:
> 
> [FSUTIL.exe](fsutil.html) behavior set disable8dot3 1
> 
> Enable the creation of 8.3 equivalent filenames:
> 
> [FSUTIL.exe](fsutil.html) behavior set disable8dot3 0
> 
> or this can be done in the registry (see [Q121007](https://support.microsoft.com/en-gb/help/121007/how-to-disable-8-3-file-name-creation-on-ntfs-partitions)) Disable:  
>   
> [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem]  
> NtfsDisable8dot3NameCreation=1
> 
> Enable:  
> [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem]  
> NtfsDisable8dot3NameCreation=0

Batch files .BAT or .CMD ?
--------------------------

> Batch files can be saved with the extension .BAT or .CMD  
> The .BAT extension will run under Windows 95/MSDOS or later but the .CMD extension will only run under NT, XP or later.
> 
> One key difference between .CMD and .BAT scripts (running under CMD.EXE) is that with extensions enabled, commands like PATH/APPEND/PROMPT/SET/ASSOC will reset ERRORLEVEL to 0 if they succeed. In the old style .BAT file, the ERRORLEVEL will not be changed unless there is a new error ([source](https://groups.google.com/forum/#!msg/microsoft.public.win2000.cmdprompt.admin/XHeUq8oe2wk/LIEViGNmkK0J)).
> 
> The old behaviour where some commands will reset the ERRORLEVEL and some don’t is not considered helpful and is likely to result in buggy code - you test for one error but actually pick up a different unrelated error.

Reserved Names
--------------

> Do not use the following reserved names for the name of a file or folder:  
> CON, PRN, AUX, NUL, conIN$ , conOUT$  
> COM0, COM1, COM2, COM3, COM4, COM5, COM6, COM7, COM8, COM9,  
> LPT0, LPT1, LPT2, LPT3, LPT4, LPT5, LPT6, LPT7, LPT8, LPT9.
> 
> Also avoid these names followed immediately by any extension; for example, NUL.txt is not permitted. Sources: [[x](https://devblogs.microsoft.com/oldnewthing/20031022-00/?p=42073)] [[x](https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file)] [[x](https://twitter.com/Foone/status/1058676834940776450)]

Maximum lengths
---------------

> sAMAccountName or NT4 logon name = 20 characters.  
> Logon name = 104 characters. However, it isn't practical to use logon names that are longer than 64 characters.  
> NETBIOS Computer name = 15 characters.  
> DNS computer name: Minimum length = 2 characters, Maximum length = 63 characters.

“Tongues, like governments, have a natural tendency to degeneration; we have long preserved our constitution, let us make some struggles for our language” ~ Samuel Johnson: Preface to the Dictionary

### Related commands

[FSUTIL file](fsutil.html) - Make the file contents of a folder Case Sensitive.  
How-to: [xlong.cmd](syntax-xlong.html) - Find filenames that exceed the 260 char pathname limit.  
How-to: [Escape Characters, Delimiters and Quotes](syntax-esc.html)  
[RFC 2253](https://www.ietf.org/rfc/rfc2253.txt) - Special LDAP characters.  
[Active Directory](https://social.technet.microsoft.com/wiki/contents/articles/11216.active-directory-requirements-for-creating-objects.aspx) - Requirements for creating objects (Richard Mueller).  
[docs.microsoft.com](https://docs.microsoft.com/en-GB/troubleshoot/windows-server/identity/naming-conventions-for-computer-domain-site-ou) - Naming conventions in Active Directory for computers, domains, sites, and OUs.



/. nt/syntax-dpi.html
========================================================

    DPI display settings - Windows CMD - SS64.com

How-to: DPI display settings
============================

The DPI setting of a display monitor is a measure of the number of dots that are visible in a single inch (Dots-per-Inch or Pixels-per-inch).

DPI is not the same as resolution. (Resolution is the number of horizontal and vertical pixels. For example, 1024 x 768 pixels).  
An image with 100 x 100 pixel resolution would be 1 x 1 inch when printed at 100 DPI.

When a display DPI is chosen in Microsoft Windows, you are telling the system how the attached monitor will display images, Windows will then rescale to take this into account.

For example changing from 96 DPI to 120 DPI, Windows will assume that you now have a display with closely packed (dense) pixels that make everything 20% smaller, so to compensate will scale everything to be 25% larger.

The changes made by adjusting DPI are more subtle than changing screen resolution, but setting DPI correctly can be important for preventing eye strain when using high pixel density displays.

The ideal* DPI for a display can be calculated using [pythagoras](https://www.mathsisfun.com/pythagoras.html) as follows:

Given:  
W = Width in Pixels  
H = Height in Pixels  
S = Diagonal Size in Inches (display size)

Then the DPI = √(W2 + H2) / S  
examples  
An iPad with a 9.7" screen √(10242 + 7682) / 9.7= 132 DPI  
An IBM Thinkpad with a 15" screen √(19202 + 12002) / 15.4= 147 DPI

* In practice you should select DPI based on individuals eyesight/preference.  
It is not advisable to set a DPI lower than 96 as the majority of Windows fonts are not hinted to display correctly at very small sizes.

Windows 10 DPI settings:
------------------------

> 96 to 500 DPI  
> Settings ➞ Display ➞ Scale and Layout ➞ Advanced scaling Settings ➞ Custom scaling (100-500%)  
> or  
> Settings ➞ Display ➞ Change the size of Text (DPI)  
>   
> For custom sizes, tick: “Use Windows XP style DPI Scaling”
> 
> The option to 'fix apps so they're not blurry' will turn off full scaling of non-DPI aware applications, which can cause fonts to become blurry.
> 
> When Windows SETUP is run to install Windows, the DPI will be set according to the capabilities of the attached monitor.  

Citrix and Terminal servers
---------------------------

> Setting the DPI for individual users connected to a terminal server (or Citrix) can only be done in the registry, if the DPI is changed in the Control Panel as above, then the change will apply to only the currently logged in user.
> 
> Registry settings for Per-User DPI setting (tested for Windows 2003/2008):
> 
> [Small 96 DPI](dpi-small-96.txt)  
> [Medium 120 DPI](dpi-medium-120.txt)  
> [Large 144 DPI](dpi-large-144.txt)  
> [Default 96 DPI](dpi-default-96.txt) (includes AppliedDPI value)

_“There are three classes of people: those who see. Those who see when they are shown. Those who do not see” ~ Leonardo da Vinci_

### Related commands

[Q2726399](https://support.microsoft.com/en-gb/help/2726399/) - Cannot change the DPI setting through an RDP session.  
[REGEDIT](regedit.html) - Import or export registry settings.  
[DPI Calculator](https://dpi.lv/) & list of common display sizes.  
[Detect your monitor DPI](https://www.infobyip.com/detectmonitordpi.php)



/. nt/syntax-share-modes.html
========================================================

    File Sharing modes - Windows CMD - SS64.com .read {background-color: #6DCE82 !important;} .write {background-color: #95b9df !important;} table {max-width:1000px;}

How-to: File Sharing modes
==========================

When an application creates a new file or opens an existing file, it must specify whether it wants to share the file for reading, writing, both, or neither. This is known as the _sharing mode_.

In the table below, on the left hand side select the row with the Generic Read and /or Write access that your process requires, then select the column with the File Sharing mode to see what other activity will then be able to co-exist with your process.

The file sharing is a two way street - to be compatible, both processes must have FILE_SHARE settings that are compatible with whatever the other process needs. If they don’t have compatible sharing modes then the file will be locked by the first process.

For example if your process needs GENERIC_WRITE access to a file and you want it to co-exist with other processes that have FILE_SHARE_READ sharing mode, then you can see that this will work providing those other processes share the file with a GENERIC_READ process that in turn has enabled FILE_SHARE_WRITE.

  

FILE_SHARE_READ

FILE_SHARE_WRITE

FILE_SHARE_READ +  
FILE_SHARE_WRITE

< The file_share bits indicate what you want to allow _other_ processes to do.

GENERIC_READ

Share with any READ process that has File_Share_Read

Share with any WRITE process that has File_Share_Read

Share with any other process that has File_Share_Read

  

GENERIC_WRITE

Share with any READ process that has File_Share_Write

Share with any WRITE process that has File_Share_Write.

Share with any other process that has File_Share_Write

  

GENERIC_READ +  
GENERIC_WRITE

Share with any READ process that has File_Share_Read + File_Share_Write

Share with any WRITE process that has File_Share_Read + File_Share_Write

Share with any other process that has File_Share_Read + File_Share_Write

  

^ The Generic_access bits indicate what _your_ process needs to do.

  

  

  

  

Each row in the table above has the same permission, the only tricky part is remembering the difference between GENERIC_READ and FILE_SHARE_READ etc.

"plus ça change, plus c'est la même chose (The more things change, the more they are the same)” ~ Jean-Baptiste Alphonse Karr 1849.

### Related commands

[Creating and Opening Files](https://docs.microsoft.com/en-us/windows/win32/fileio/creating-and-opening-files) - docs.microsoft.com  
[How do the FILE_SHARE_* bits interact with the desired access bits?](https://devblogs.microsoft.com/oldnewthing/20040511-00/?p=39403) - Raymond Chen [MSFT]



/. nt/syntax-shares.html
========================================================

    Organising File Shares / Document Libraries - Windows CMD - SS64.com .style1 {font-weight: bold}

How-to: Organise File Shares / Document Libraries
=================================================

Some thoughts on how to arrange shared files. Here we discuss the _what_ rather than the _how_ - there is a [separate page](syntax-groups.html) covering the technical aspects of folder sharing. Although this was originally written from the perspective of simple file shares, the same approach can be used with SharePoint Document Libraries.

Awareness
---------

> A key consideration in organising shared files is making sure that all the people in a team are aware exactly which data of theirs is being shared with other teams.
> 
> Take an example of an HR Team and a Finance team, it might seem reasonable to share the HR folder with Finance staff so they can get figures on annual workforce costs, but if one of the many HR subfolders has information about redundancies that may eventually affect the Finance team then they certainly don’t want that to be shared.

Listing what is available
-------------------------

> When a list of folders is shared, you have a choice of hiding all folders for which the user does not have permission. First seen in Novell Netware (Q303758), all recent versions of Windows now have [Access-based Enumeration](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/dd772681(v=ws.10)?redirectedfrom=SS64) (ABE) available.  
> [Turn this on with [Set-SmbShare](../ps/set-smbshare.html) -Name "Share64" -FolderEnumerationMode AccessBased ]  
> This simplifies navigating the folder structure for end users, but does have a [performance cost](https://techcommunity.microsoft.com/t5/ask-the-directory-services-team/access-based-enumeration-abe-concepts-part-1-of-2/ba-p/400435). ABE works well for hundreds or a few thousand file shares, but will slow down or fail when parsing tens of thousands of shared folders. Use it for departmental shares but not for individual user home folders.

Shared with everyone drives
---------------------------

> One approach to sharing files is to have a file server area that is open and read/write to everyone. This is a common approach in small organisations with little need for security.
> 
> With no clear ownership, file shares like this tend to become disorganised fairly quickly. Tidying this up typically involves some kind of cleardown or reorg but this is never a popular approach and is likely to result in data loss at some point.

Team only shares
----------------

> This is very common in larger organisations, shared areas where the access is limited to only members of one team or another. This access control means that when any need arises to share documents with people _not_ in that team they have to use email or some other means of sharing.

Split Folder Sharing
--------------------

> An approach to address these issues is to setup TWO sets of shared folders, and corresponding mapped drives. For each Team there is one shared folder that’s only available within the team and a second that is shared with other teams.
> 
> S: Shared – users will typically have access to multiple folders, here, including their own teams shared folder.  
> All folders are **[visible](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/dd772681(v=ws.10)?redirectedfrom=SS64)**.
> 
> T: Team only – each user will have access to one and only one folder in this share corresponding to their own Team. Other folders are **hidden** from view.
> 
> ![Shared S: and T: drives](shared.png)
> 
> With this arrangement, users can save the files they want to share with other teams into their shared folder.
> 
> Because the Team Only and Shared areas are delivered to the end users via two separate drive mappings, any drag-and-drop movement of files between them will by default be a COPY rather than a move, and so will retain the desired permissions.
> 
> You may be tempted to Map drive T: directly to each users Team folder, allowing work to be saved in T:\file.doc rather than T:\TeamName\file.doc but there are good reasons for keeping the name of the team folder visible:
> 
> *   If they try to email a link to a T: file or folder, to someone in a different team, they will quickly see that the other team doesnt have access to that folder, so they will realise and use the S: shared folder instead.  
>       
>     In contrast, they are quite likely to be completely baffled as to why a link to T:\file.doc doesn’t appear for the other person, it's not intuitive.  
>       
>     
> *   It acts as a reminder of their teams Folder Name.  
>       
>     
> *   Login scripts are easy to setup, everyone gets exactly the same two drive mappings.  
>       
>     
> *   In Windows explorer and many other places, they can switch between their Team and Shared folders, by just changing T: to S:
> 
> Some teams may store their work almost exclusively in the shared area, other teams may mostly work using their Team-only folder. It places decisions about document sharing with individual users and means that shared access is both visible and can be done on a per-file basis without having to involve the IT department at all.
> 
> For ease of use, the team folder names should be kept short - think 16 characters or less, that leaves ~ 240 characters for all the filenames within the group folder.

Access Permissions on the shared folders
----------------------------------------

> Granting read-only access to everyone across all shared folders makes it simple and clear that shared items are visible to everyone, but the ownership is still held by one team.
> 
> Alternatively you may want to allow multiple teams to work collaboratively with read/write access to the same shared folder. The same logic would apply - shared items are read/write to _selected other teams_, but the ownership is still held by one team.
> 
> It is likely to be worth setting up two [AD groups](syntax-groups.html) for each team, one for the team members T: drive and one that grants permissions to the S: drive for other people/teams. That gives complete flexibility about who can access the Shared folder.

Project work
------------

> One flaw in this arrangement is that while it works well for people in two teams sharing data, the structure may not work so well for large project folders shared by many teams or sharing between a mish mash of people dotted around the organisation.
> 
> For those cases - create a new shared folder for the project, just like an actual team using the T: and S: structure.
> 
> If you setup every file share the same consistent way, it simplifies management, some T: drives might never be seen or used, but having them ensures you are covered for the case where a new hire is allocated to work on that project and nothing else.

Home Folders
------------

> In addition to the above, every user typically has a home folder. Either a file share or OneDrive storage.
> 
> If a large proportion of users need to work with files that are kept private, map the Home directory/OneDrive to H: so it appears at the top of the list. Conversely, mapping the Home directory to U: will put it at the bottom of the list.
> 
> For software packages like Microsoft Office, consider where the default save folder should be set to.  
> In some organisations the home folder may get very little use and so not require a drive mapping at all.

Every organisation is different
-------------------------------

> The arrangement described above may not work for every organisation, but hopefully it will give you ideas to improve and simplify the management of your shared files. It will not eliminate the need for custom share permissions but may help to reduce the number and complexity of changes that need to be managed.
> 
> In secure environments there is a tendency to say – _"you can’t share document X with any other teams, therefore we can’t share any folders._ The fallback option for users then becomes email, which is more difficult to monitor and control.
> 
> Even in the most complex environments, with many permissions to consider, there is often value to be found in providing a file storage area that everyone understands will never be shared with any other teams.

Sub-folders
-----------

> It can be helpful to provision each new team storage folder with a small number of default sub-folders to suit common requirements for the organisation, without this many users struggle with understanding file hierarchies and will use folder names like 'New Folder (2)'
> 
> e.g.
> 
> > Admin  
> > Documentation  
> > Meetings  
> > Photos  
> > Presentations  
> > Projects  
> > Resources  
> > Staff  
> > Templates

_“The sky is filled with stars, invisible by day” ~ Henry Wadsworth Longfellow_

### Related commands

[Naming conventions for UserNames](../ps/new-aduser.html#naming).  
How-to: [Groups](syntax-groups.html) - Full description of AD Local Domain groups, Global and Universal groups.  
How-to: [Built-in Groups](syntax-security_groups.html) - Built-In Users and Security Groups.  
How-to: [NoDrives](syntax-nodrives.html) - Hide mapped drives from Windows Explorer.  
How-to: [MapDrive](../vb/syntax-mapdrive.html) - Map a Drive letter to a network file share, non-persistent (VBScript).



/. nt/syntax-nodrives.html
========================================================

    NoDrives - Windows CMD - SS64.com TD {text-align: center;} function calculate() { var intResult = 0; var tbox; for (var i = 1; i < 27; i++) { //passwordHash(sites[i].seed, mypass); check ='d' + [i]; tbox = document.getElementById(check); // tbox2 = document.getElementById("d2"); if (tbox.checked) {intResult = +intResult + +tbox.value;} } document.getElementById("result").setAttribute('value', intResult); }

How-to: Hide drive letters from Windows Explorer - "NoDrives"
=============================================================

Hide drive letters in Windows Explorer and the standard File, Open dialog box.

| A: | B: | C: | D: | E: | F: | G: | H: | I: | J: | K: | L: | M: | None |
|----|----|----|----|----|----|----|----|----|----|----|----|----|------|
| 1  | 2  | 4  | 8  | 16 | 32 | 64 | 128 | 256 | 512 | 1024 | 2048 | 4096 | 0    |
| N: | O: | P: | Q: | R: | S: | T: | U: | V: | W: | X: | Y: | Z: | ALL
|----|----|----|----|----|----|----|----|----|----|----|----|----|------|
| 8192 | 16384 | 32768 | 65536 | 131072 | 262144 | 524288 | 1048576 | 2097152 | 4194304 | 8388608 | 16777216 | 33554432 | 67108863

User Key:  
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer]  
  
System Key:  
[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer]

Value Name: NoDrives  
Data Type: DWORD

After changing the registry, [logoff](shutdown.html) or reboot so that it takes effect.

This entry stores the setting of the '[Hide these specified drives](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc938267(v=technet.10))' in My Computer Group Policy. Group Policy adds this entry to the registry when you enable the policy. If you disable the policy or set it to Not configured, Group Policy deletes this entry from the registry, and the system behaves as though the value is 0x0.

Drive mappings hidden with a nodrives registry setting are still available, just type the drive letter into the Windows explorer address bar.

This page can also be used to calculate other bitmask values used in various places in the Widows registry.

Hide the color disk space bar in Windows explorer  

----------------------------------------------------

> By default, the "This PC" view in Windows Explorer will show each drive with a colour bar: blue for normal and red for space < 10%
> 
> This can be hidden by editing the Registry:
> 
> HKEY_LOCAL_MACHINE\Software\Classes\Drive
> 
> Edit the **TileInfo** key and remove the phrase System.PercentFull;
> 
> Before:  prop:*System.PercentFull;System.Computer.DecoratedFreeSpace;System.Volume.FileSystem  
> After:   prop:*System.Computer.DecoratedFreeSpace;System.Volume.FileSystem

“The dream is the small hidden door in the deepest and most intimate sanctum of the soul, which opens to that primeval cosmic night that was soul long before there was conscious ego and will be soul far beyond what a conscious ego could ever reach” ~ Carl Jung

### Related commands

[Convert](../convert.html) - Convert between Decimal and Binary.  
[REG](reg.html) - Registry: Read, Set, Export, Delete keys and values.  
[REGEDIT](regedit.html) - Import or export registry settings.



/. nt/syntax-percent.html
========================================================

    Percent symbols - % - Windows CMD - SS64.com

How-to: Double %% symbols, why are they needed in a batch file?
===============================================================

A common question asked by new batch file programmers is "_why do we need to double the percent symbols when writing a FOR command?_". On the command line %A works fine, so why does a batch need %%A?

To answer this we need to consider all the things in the batch language which use the % symbol:

*   Firstly [command line parameters](syntax-args.html) %0 %1 %2 %3 ...  
     
*   Next the [FOR](for.html) command, while most people will sensibly choose parameter letters like %A or %F or %Z, it is perfectly possible to choose numbers %1 %2 %3 ...  
      
    Try this at the command line:  
      
    FOR /L %6 in (1,1,5) Do Echo %6  
      
    It will work and give you a nice list of numbers from 1 to 5.  
    

Now you see the problem this presents, you can have two different types of variable with identical names and the CMD command shell parser needs a way to separate them.

How the CMD shell command line parser evaluates variables:
----------------------------------------------------------

> The CMD shell reads through each line of a batch file once from left to right, when it finds a percent sign it checks the next character and proceeds as follows:
> 
> *   If the next character is another percent sign (%), CMD replaces the two with a single percent sign and then reads the third character evaluating it either as a FOR parameter or, if not in a [FOR](for.html) loop, just treating it as the plain character '%'.  
>     %%G => somevalue  
>     %%Hello => %Hello 
> *   If the next character is a digit (0-9) CMD replaces the percent sign and digit with the value of the corresponding command line [parameter](syntax-args.html). Also if the character is a tilde (~) then [Parameter Extensions](syntax-args.html) will be applied.  
>     %1 => somevalue  
>      
> *   If the next character is anything else (so not a number or a % symbol) CMD treats everything up to the next percent sign as the name of a [variable](syntax-variables.html) and replaces it with the value of that variable.  
>     %_somevariable% => somevalue
> 
> When working at the command line (not in a batch script) there is no possibility of any batch file parameters %1, %2 etc so the logic above is not followed and hence FOR parameters on the command line only need a single %.
> 
> One other place where a percent character is used is as the modulus operator in the [SET /A](set.html) command, in a batch file this should always be passed as a pair of double %%'s.

Variable Names
--------------

> It is worth also considering how this affects normal variables - this does not make for readable code, but just to prove a point, lets try to create a standard variable with a variable name that is numeric:  
>   
> SET 1=Hello
> 
> You might expect that to create the variable %1%, but in a batch file it will Fail.
> 
> Even if the script was called without passing any parameter %1, the parameters take precedence, so %1% is evaluated as %1 plus an extra % at the end. Remember the command line is parsed left to right only once, so the %1 is evaluated before the second % is even read.  
> You can of course do SET 1=Hello at the command line and it will work!

Summary
-------

> So what have we learned from all this:
> 
> *   Never try to start a variable name with a number, a common practice is to prefix all variables with an _underscore, if you make a habit of that you will never be bitten by the invalid numeric name issue.  
>      
> *   Don’t use numbers as FOR parameter variables, it may work but it will confuse people (and is undocumented).  
>      
> *   If you want to use a plain % symbol _anywhere_ in a batch file, you need to double the %'s  
>       
>     Echo "This includes a 50%% discount"  
>     > This includes a 50% discount  
>       
>     This includes references to filenames, the % is a legal character for a filename, but to access it from a batch file you need to double it:  
>       
>     Start "C:\my work\Demo %% calc.xlsx"  
>     Will open the file Demo % calc.xlsx
> 
> If you are aghast at the insanity of all these arcane rules, you should be learning [PowerShell](../ps/), it's awesome!

### Related commands

The [caret symbol](syntax-esc.html) ^ as the CMD Escape character, has to be doubled both within Batch files and at the command line.  
[The Batch Line Parser](https://stackoverflow.com/a/4095133/1720814) explained on Stack Overflow by Jan Erik (jeb) and Dave Benham, also more on [% Expansion](https://stackoverflow.com/a/7970912/1720814) (same thread).  
How-to: [Parameters](syntax-args.html) - Command Line Arguments %1 %~f1  
How-to: [Environment variables](syntax-variables.html) - Windows environment variables Env:



/. nt/syntax-printing.html
========================================================

    Printing, Printer Connections, Share names, Updating Drivers - Windows CMD - SS64.com

How-to: Configure Windows Network Printing
==========================================

Print Drivers and the Print$ share
----------------------------------

> Every Print Server has a hidden file share (called Print$) that is used to deliver print Drivers to Windows clients.  
>   
> When a PC connects to a Print Share the drivers on the server and client are compared, if the client is missing the driver; or has an older version; then it will be automatically downloaded.  
>   
> The achilles heel of this system is version control: consider that you have two similar printers on two different print servers. One server has a driver version 26.232 the other has version 26.234, in theory the client will download the latest driver and use it for both printers, in practice the results are less predictable - the worst case being a driver download every time the user prints.  
>   
> Whenever a new driver is installed on a **print server**, you can force all users who have a connection to that print queue, to download the updated driver. To force this update, change the Print _Share_ name on the server [Press Apply] Then change back to the original _Share_ Name [Press Apply again].  
> E.g.  
> Change the printer _MyPrintShare_ to _MyPrintShare_X [Apply] then change back to _MyPrintShare_.
> 
> If you can arrange that each user connects to only one print server, management becomes much easier. If you have multiple print servers, consider duplicating queues so that no user has to access more than one print server.

Printer Migration - bulk changes
--------------------------------

> The Microsoft Print Migrator has now [been](https://blogs.technet.com/b/askperf/archive/2008/10/17/why-printmig-3-1-is-retired.aspx) superseded by [PRINTBRM](printbrm.html) which can backup and restore Print Queues.

Client Printer connections (Print Map)
--------------------------------------

> To update client printer connections, use [qchange](../vb/syntax-qchange.html) this will not only change the clients connection to a different Print Queue but will also also preserve the user's **default** printer.
> 
> List all the print queues currently shared on a server with
> 
> net view \MyServer >file_print_shares.txt

_Printer_ Name vs _Print Share_ Name
------------------------------------

> Every shared printer has both a Printer name and a Share name - these appear in different places:
> 
> Browsing Network Neighborhood (NetBios UNC Name) = _ShareName_  
> Add Printer Wizard (DNS) = _PrinterName_  
> Find Printer Wizard (DNS) = _PrinterName_
> 
> Active Directory and the Control Panel will display the _PrinterName_ in most places.
> 
> A key difference between these two names is what happens when you rename them:
> 
> Changing the _ShareName_ on the server, clients stay connected.
> 
> Changing the _PrinterName_ on the server, clients will lose their connection. The control panel status will display "Printer not found on server, unable to connect"
> 
> The Contol Panel ➞ Printers folder for all users can be opened with Start ➞ Run ➞ [shell](shell.html):PrintersFolder
> 
> The printer connections for the current user can be opened with Start ➞ Run ➞ [shell](shell.html):PrintHood
> 
> For example:
> 
> > Create Printer called **HP1** and share it as _Share1_
> > 
> > Connect a client to the printer
> > 
> > Now turn off the print Share on the server (set to _Not Shared_)
> > 
> > Create Printer called **KYO2** and share it as _Share1_, you might expect the client to now connect to this new queue, but it will still point to the old one (and will fail).
> > 
> > Now Rename HP1 to HPold and rename KYO2 (still shared as _Share1_) to HP1  
> > The client will now connect to _Share1_ successfully.

Naming conventions
------------------

> As you have probably figured by now; it pays to keep things simple and make the printer's SHARE Name and PRINTER Name identical.
> 
> I recommend short printer names (8 characters or less) with no spaces, for example a simple naming convention with 2 characters and a number (AA1, ZZ9...) will support 6,760 print queues. This is likely more than you will want to host on a single Print Server.
> 
> \London\RS7
> 
> Short Printer Names without spaces are portable and easy to script. If you choose to use long names with spaces, expect that some third party software can have problems.
> 
> Over time Teams tend to move around different offices and buildings. Over time Printers tend to also move around, either due to maintenance or to satisfy demand. This means that 'meaningful' printer names such as _HPLJ14_ or _FirstFloor21_ or _FinanceTeam_ tend to get out-of-date and become unhelpful.
> 
> Details such as the printer model and features (colour/duplex etc) should be placed in the Print Queue DESCRIPTION field.
> 
> Filling in the LOCATION field will allow the _Find Printer Wizard_ to display all the relevant printers for a team or site.
> 
> Attach a large physical label to the printer with it's share name, this will save on paper, user frustration and helpdesk calls.

Deploying Printer Location with Active Directory
------------------------------------------------

> This feature helps users to find a printer by storing PC and Printer locations in Active Directory.  
> For example with 500 printers you might define 10 locations with 50 printers in each. Groups of computers are then allocated to appropriate Locations, and Windows will pre-populate the Find Printer Wizard with the 50 nearest printers.
> 
> This is a good feature for large organisations following the trend to consolidate multiple print/file servers.

Default Printer
---------------

> The default Printer connection is _per user_, and will travel with roaming profiles. it can be changed with Defptr, [WMIC](wmic.html) or [WSH](../vb/setdefaultprinter.html).
> 
> If the default printer is a local printer, then roaming to a different PC without an identical local printer, will change the default to the next available printer.

Delete a printer
----------------

> If a local printer is added for **All Users** and then removed for the current user, it will not be possible to re-add it with the same name, throwing error: “_Unable to install printer. Another printer or printers share with this name already exists._"
> 
> To delete a printer in the registry:
> 
> *   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print\Printers  
>     Look for a sub key matching the printer name, and delete it.
> *   Restart the “Print Spooler“ [Service](syntax-services.html).

Print to File
-------------

> In the Printers folder, click Add Printer.  
> Click My Computer, and then Next.  
> Click "Local printer attached to this computer"  
> (don’t tick automatically detect) ➞ Next  
> Click Create a new Port. ➞ Next  
> When prompted for a local port name, type a path and file name for the file.  
> Choose the Generic/Text print driver.

Local Printers
--------------

> Any PC with a _shared_ local printer will also setup a Print$ share - acting as a source of driver DLL's for other machines. This presents a possible security risk that needs to be understood and managed. If the printer is never accessed by other machines don’t share the printer.  
>   
> Printer connections are normally _per user_, and roam with roaming profiles. Local shared printers and roaming profiles are generally not a good mix. (They don’t cause problems but do confuse users who roam.)
> 
> It is possible to create printer connections _per machine_ with [rundll32](rundll32.html) - these will not follow a roaming profile.  
>   
> Windows workstations will support a maximum of 10 users per Share (This applies to both file and print shares) for more than this you will need a server licence.

Windows Printing features
-------------------------

> Location-aware printing - mobile computers can automatically switch default printer according to the connected network.
> 
> Automatic selection of a default printer.
> 
> The NextGen print spool file uses human-readable XAML, an XML-based declarative programming language.  
> This opens up possibilities such as including multiple documents in a single print job.

LPR - Line Printers
-------------------

> The Line Printer protocol LPR is a useful method of printing to a character printer, typically used with monospaced fonts for printing over pre-printed stationary such as cheques.  
> LPR print jobs are sent direct to the printer, this allows the application to manage/send printer control codes, (page feed etc).  
> LPR can also be used to send print jobs to a UNIX Print Server.
> 
> The "Microsoft TCP/IP Printing service (UNIX)" provides a TCP/IP-based printing service using the Line Printer protocol. This is not installed by default.  
>   
> To create an LPR printer, Select Control Panel - Add Printer - My Computer - Add Port - LPR port.  
> At the prompt type the host name or IP Address of the printer (or remote Unix host).  
>   
> Once installed, the LPR protocol will use the [Service](syntax-services.html): LPDSVC

Printer Options
---------------

> _Priority_: The priority sliding bar sets the default priority for documents printed.  
> A common approach is to create one printer for the majority of users with a default priority of 1  
> then create a separate 'high priority' printer that sends output to the same printing device but with a higher priority setting.  
>   
> _Spool print documents so program finishes printing faster_  
> (& Start printing immediately) - preferred option for most applications.  
>   
> _Print directly to the printer_ - this sends documents directly to the printer. This gives the fastest time-to-output but you lose the ability to use the PC while the print job is in progress.  
>   
> _Print spooled documents first_ - if you disable this option, high priority jobs will interrupt lower priority jobs that are already printing. (so the pages get mixed up)

Print Processor
---------------

> The default Print Processor is WINPRINT.DLL, (this can be replaced for advanced DTP work)  
> This Print Processor supports several data formats:  
>   
> _Raw_: [default] This datatype indicates that the job is in a ready-to-print format in the printing device’s native language. (Good for PostScript printing).  
>   
> _Raw [FF Appended]_: As RAW but appends a form-feed character to the end of the print job.  
>   
> _Text_: This indicates a print job that consists of ANSI text.  
>   
> _PSCRIPT_ (PostScript support for Macintosh clients using non-PostScript printer)  
>   
> _EMF_: A Windows application will partially rendered the job and the print driver then completes the rendering process. EMF takes advantage of print server CPU resources, EMF files sizes are smaller than RAW which reduces network congestion.  
> (Good formost PCL-based laser printers)

Printer Pools
-------------

> A printer pool allows multiple physical printing devices to appear as a single'virtual' printer. When print jobs are sent to a printer pool, Windows routes the job to the first availabledevice.  
>   
> In a busy printing environment pooling will allow more efficent and faster printing but does not provide any failure resilience e.g. Windows cannot redirect a job from a failed port, so when a printer is offline the printer pool will continue to send jobs to that port.  
>   
> To enable Printer pooling, go to Printer properties - Ports, check the 'Enable printer pooling' tickbox  
> Note: it's quite possible to have individual print queues in addition to the printer pool queue.

Printing requires the Spooler service to be running

### Related commands

[NET PRINT](net-share.html) - View and Delete print jobs.  
[NET SHARE](net-share.html) - Create file share.  
[qchange.vbs](../vb/syntax-qchange.html) - Connect to a different Printer Queue.  
[PRNCNFG](prncnfg.html) - Configure or rename a printer.  
[PRNMNGR](prnmngr.html) - Add, delete, list printers and printer connections.  
[RMTSHARE](rmtshare.html) - List or edit a file share or print share.  
[RUNDLL32](rundll32.html) - Add/remove print _connections_.  
[SHARE](share.html) - List or edit a file share or print share.  
[WMIC PRINTER](wmic.html) - Set printing options through WMI.  
[Print Management Snap-in](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc731058(v=ws.11)?redirectedfrom=SS64) - docs.microsoft.com  
[Q234270](https://support.microsoft.com/en-gb/help/234270/) - Group Policies to Control Printers.  
[Q888744](https://support.microsoft.com/en-gb/help/888744/) - Printer driver not updated on the client.  
Print Notification - this is set under Control Panel, Printers, File, Server Properties, Advanced.  
Equivalent bash command (Linux): [printf](../bash/printf.html) - Format and print data.



/. nt/syntax-recovery.html
========================================================

    Recovery Recovery Environment, Safe mode and Win PE - Windows CMD - SS64.com

How-to: Windows Recovery Environment (WinRE), Safe mode and Win PE.
===================================================================

A successor to the Windows Recovery Console, Windows Recovery Environment (WinRE) is a set of tools based on Windows Preinstallation Environment (Win PE). Windows PE utility ([Wpeutil](wpeutil.html)) is a command-line tool that enables you to run commands during a Windows PE session

Boot to Safe Mode
-----------------

> When dealing with a Blue Screen of Death or other critical errors - one option is to boot into [Safe Mode](https://support.microsoft.com/en-us/windows/start-your-pc-in-safe-mode-in-windows-10-92c27cff-db89-8644-1ce4-b3e5e56fe234).
> 
> 1.  On the Windows sign-in screen, press and hold **SHIFT** while you select Power ➞ Restart.
> 2.  After the PC restarts to the Choose an option screen, Troubleshoot ➞ Advanced options ➞ Startup Settings ➞ Restart.  
>     You may be asked to enter your BitLocker recovery key.
> 3.  After your PC restarts, you'll see a list of options. Select 4 or F4 to start your PC in safe mode. Or if you'll need to use the Internet, select 5 or F5 for Safe Mode with Networking.
> 
> From safe mode you can run a system restore with %systemroot%\system32\restore\rstrui.exe

Boot to Windows Recovery Environment (winRE).
---------------------------------------------

> To do this, you will repeatedly turn your device off, then on:

1.  Hold down the power button for 10 seconds to turn off your device.
2.  Press the power button again to turn on your device.
3.  On the first sign that Windows has started (for example, some devices show the manufacturer’s logo when restarting) hold down the power button for 10 seconds to turn off your device.
4.  Press the power button again to turn on your device.
5.  When Windows restarts, hold down the power button for 10 seconds to turn off your device.
6.  Press the power button again to turn on your device.
7.  Allow your device to fully restart. You will enter winRE and have access to [Bootrec](bootrec.html).

Boot to Windows PE
------------------

> WinPE most often runs from an external USB device like a memory stick. This can be used to disable services or replace system files until you are able to boot into safe mode.
> 
> 1.  Connect the device.
> 2.  Turn on the PC, and use the boot menus to select the Windows PE drive. Typically this requires pressing a hardware button or a key, such as the Esc key. For UEFI-based PCs, you might need to find an option to manually select the UEFI boot files, for example, USBDrive01\EFI\BOOT\BOOTX64.EFI.
> 3.  Windows PE starts automatically. After the command window appears, the wpeinit command runs automatically. This might take a few minutes.

WinPE drive letter assignments change each time you boot
--------------------------------------------------------

> myscript.cmd  
> 
> @echo off
> For %%G in (C D E F G H I J K L M N O P Q R S T U V W X Y Z) do (
>    if exist %%G:_myscript_.cmd (
>       Echo WinPE is running on drive: %%G
>       REM other commands
>    )
> )

Setup local account security questions on Windows 10
----------------------------------------------------

> To Set or Reset your local account password or security questions on Windows 10:
> 
> Settings ➞ Accounts ➞ Sign-in options ➞ Password ➞ Update your security questions.

How to sign in using security questions/answers
-----------------------------------------------

> Attempt to Sign-in using an incorrect password.  
> Click OK and click Reset Password.  
> Type the correct answer to each of the security questions and press Enter.  
> Type a new password and press Enter.

Create a new Admin account and password.
----------------------------------------

> On machines with Windows Defender, this procedure may [not](https://www.bleepingcomputer.com/news/security/windows-defender-can-detect-accessibility-tool-backdoors/) work, [see here for an alternative](https://4sysops.com/archives/reset-windows-10-password-by-disabling-windows-defender/) using SAFE mode and RoboCopy.

1.  Boot from a [Windows 10 bootable DVD or USB](https://support.microsoft.com/en-us/windows/create-installation-media-for-windows-99a58364-8c02-206f-aa6f-40c3b507420d). (Alternatively boot into into Windows PE if setup.)
2.  If the computer does not have BitLocker, when WINDOWS SETUP appears, press SHIFT+F10 to launch a CMD window.  
    If the computer has BitLocker, start the SETUP and choose REPAIR, it will ask you for the BitLocker recovery key and then let you open a command prompt.
3.  Type:  
    REN d:\windows\system32\utilman.exe utilman.exe.bak  
    and press the ENTER key.
4.  Type:  
    COPY d:\windows\system32\cmd.exe d:\windows\system32\utilman.exe  
    and press the ENTER key.
5.  Exit the Windows 10 setup (power down) and Boot normally to your hard drive.
6.  At the Login Screen click the EASE OF ACCESS icon (beside the Power icon in the bottom right corner of the screen). Because of step 4, this will launch a CMD window.
7.  Type NET user ss64 _password1_ /add and press the ENTER key
8.  Type NET localgroup administrators ss64 /add and press the ENTER key. Press ALT+F4 to close the CMD prompt. This creates a local administrator named ss64.
9.  Type wpeutil reboot to reboot the machine (alternatively click the Power icon (bottom right) and select RESTART.
10.  Sign in as ss64 with the password _password1_.
11.  If you are on a domain use the username .\ss64.
12.  Once logged in, replace the original file type:  
    REN d:\windows\system32\utilman.exe.bak utilman.exe and press the ENTER key.

“When a deep injury is done us, we never recover until we forgive” ~ Alan Paton

### Related commands

[Q12415](https://support.microsoft.com/en-gb/help/12415/windows-10-recovery-options) - Recovery options in Windows 10.  
[BCDBOOT](bcdboot.html) - Create or repair a system partition.  
[BCDEDIT](bcdedit.html) - Manage Boot Configuration Data.  
[BOOTREC](bootrec.html) - Repair or replace a partition boot sector (WinRE).  
[SYSPREP](https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/sysprep--generalize--a-windows-installation?view=windows-11) - (Generalize) a Windows installation.  
[WPEUTIL](wpeutil.html) - Run commands during a Windows Preinstallation Environment (WinPE)  
[Recovery /Reset options in Windows](https://support.microsoft.com/en-us/windows/recovery-options-in-windows-31ce2444-7de3-818c-d626-e3b5a3024da5#bkmk_reset_pc&ID0EDD=Windows_10) - Microsoft support.  
[WinPE Intro](https://docs.microsoft.com/en-gb/windows-hardware/manufacture/desktop/winpe-intro) - Microsoft help page.  
[Windows Recovery](https://docs.microsoft.com/en-us/answers/questions/187973/windows-recovery-cmd.html) - Create a new Admin user.  
[List of Windows Services](syntax-services.html)



/. nt/syntax-reghacks.html
========================================================

    Windows 10 registry - user interface settings - Windows CMD - SS64.com

How-to: Windows 10 registry - user interface settings
=====================================================

Registry settings for user interface settings and options under Windows 10.  
On a domain most of these settings can be controlled via Group Policy.  

Windows Registry Editor Version 5.00
; Win10.REG

; Usual disclaimers apply - don’t edit the registry unless you know what you are doing and
; BACKUP THE REGISTRY FIRST


; Comment lines are prefixed with ;  ([REGEDIT](regedit.html) will ignore them)
; so uncomment the parts you want to run.


; ============ Login ===========
; Disable the lock screen, which appears just before the Windows 10 sign-in screen
;  [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization]
;  "NoLockScreen"=dword:00000001

; ============ Start menu ===========

;Start menu speed - the default is 400
;  [HKEY_CURRENT_USER\Control Panel\Desktop]
;  "MenuShowDelay"="50"

; ============ Taskbar ===========

;No Glomming (keep every icon on the taskbar separate)
;  [HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer]
;  "TaskbarGlomming"=dword:00000000

;Glomming enabled
;  [HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer]
;  "TaskbarGlomming"=dword:00000001

;Always combine Taskbar icons + hide labels
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced]
;  "TaskbarGlomLevel"=dword:00000000

;Combine icons when taskbar is full (default)
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced]
;  "TaskbarGlomLevel"=dword:00000001

;Never combine Taskbar icons
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced]
;  "TaskbarGlomLevel"=dword:00000002

;TaskBar left/right grouping by age (oldest first) (default).
;  [HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer]
"TaskbarGroupSize"=dword:00000000
;or group by size largest first
;  "TaskbarGroupSize"=dword:00000001
;or group all with 2 or more, or 3 or more:
;  "TaskbarGroupSize"=dword:00000002
;  "TaskbarGroupSize"=dword:00000003
;or prevent grouping altogether
;  "NoTaskGrouping"=dword:00000001

;Don't hide the log-off option from the Start Menu
;(setting to 0 does not prevent users from using other methods to log off.)
;  [HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer]
;  "StartMenuLogOff"=dword:00000001

;Don't hide the Themes tab in Control Panel Personalisation
;  [HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer]
;  "NoThemesTab"=dword:00000000

; Remember my Explorer views
;  [HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer]
;  "NoSaveSettings"=dword:00000000

; ============ System Tray ===========

; System Tray - Show all icons (The default for this can be set under HKLM)
; [HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Explorer]
; "EnableAutoTray"=dword:00000000

; or hide inactive icons 
; [HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Explorer]
; "EnableAutoTray"=dword:00000001
;

; ============ Explorer / General ===========

;Remove the '[OneDrive](https://support.office.com/en-GB/article/Turn-off-or-uninstall-OneDrive-f32a17ce-3336-40fe-9c38-6efb09f944b0)' Icon from Windows Explorer for the current user
; [-HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\{018D5C66-4533-4307-9B53-224DE2ED1FE6}]

;Remove the OneDrive icon for all users, this no longer works if the key above is present.
;  [HKEY_CLASSES_ROOT\CLSID\{018D5C66-4533-4307-9B53-224DE2ED1FE6}]
;  "System.IsPinnedToNameSpaceTree"=dword:00000000
;  [HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{018D5C66-4533-4307-9B53-224DE2ED1FE6}]
;  "System.IsPinnedToNameSpaceTree"=dword:00000000

;Don't tie new shortcuts to a specific PC
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer]
;  "LinkResolveIgnoreLinkInfo"=dword:00000001

;Don't use Windows NTFS link tracking to resolve existing shortcuts.
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer]
;  "NoResolveTrack"=dword:00000001

;Don't hide any local Drives
;  "[NoDrives](syntax-nodrives.html)"=dword:00000000

;Don't add "-Shortcut" text to the name of newly created shortcuts.
;  [HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer]
;  "link"=hex:00,00,00,00
;or Restore the default adding "-Shortcut" text to the name of newly created shortcuts.
;  "link"=hex:1e,00,00,00

;Show all folders in Explorer including Recycle Bin, Desktop, Control Panel
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced]
;  "NavPaneShowAllFolders”=dword:00000001
;or only show current folder path in Explorer
;  "NavPaneShowAllFolders”=dword:00000000

;Add Right Click "Open PowerShell window here" Context Menu
; see [this article on TenForums](https://www.tenforums.com/tutorials/59686-open-command-window-here-administrator-add-windows-10-a.html)

;Disable Telemetry in Microsoft Office.
;  [HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\16.0\osm]
;  "Enablelogging"=dword:00000000
;  "EnableUpload"=dword:00000000
;  [HKEY_CURRENT_USER\Software\Microsoft\Office\Common\ClientTelemetry]
;  "DisableTelemetry"=dword:00000001

; ============ Explorer\Advanced ===========

;Show hidden files and folders
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced]
;  "Hidden"=dword:00000001

;or Don't show hidden files and folders:
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced]
;  "Hidden"=dword:00000002

;Don't Hide file extensions
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced]
;  "HideFileExt"=dword:00000000

;Don't hide recently opened Programs from the Start menu /Start Run
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced]
;  "Start_TrackProgs"=dword:00000001

;Don't hide recently opened Documents from the Start menu /Start Run
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced]
;  "Start_TrackDocs"=dword:00000001

;Don't add a Games shortcut to the start menu
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced]
;  "Start_ShowMyGames"=dword:00000000

;Don't slow down search by including all public folders
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced]
;  "Start_SearchFiles"=dword:00000001

;Don't show notifications/adverts (OneDrive & new feature alerts) in Windows Explorer
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced]
;  "ShowSyncProviderNotifications"=dword:00000001

;Don't change the upper/lower case of filenames
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced]
;  "DontPrettyPath"=dword:00000000

;Disable Bing in Windows 10 Start Menu and Search
;  [HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Explorer]
;  "DisableSearchBoxSuggestions"=dword:00000001

; ============ Personalization ===========


;Allow changing Windows Color
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System]
;  "NoDispAppearancePage"=dword:00000000

;Allow Color scheme changes
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System]
;  "NoColorChoice"=dword:00000000

;Allow changing the font size
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System]
;  "NoSizeChoice"=dword:00000000

;Change desktop background (any wallpaper will override this)
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System]
;  "NoDispBackgroundPage"=dword:00000000

;Allow changing the Screen Saver
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System]
;  "NoDispScrSavPage"=dword:00000000

;Allow changing the Display
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System]
;  "NoDispCPL"=dword:00000000

;Allow changing the Display Settings
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System]
;  "NoDispSettingsPage"=dword:00000000

;Allow changing the wallpaper
;If a wallpaper value is set here (or via policy) it will override the users choice
;in the control panel (HKCU\Control Panel\Desktop) so delete the key to allow changes:

;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System]
;  "Wallpaper"=-


; ============ Control Panel / Add-Remove Programs ===========
;
;Don't hide any Control Panel applets see [Q207750](https://web.archive.org/web/20121130055942/https://support.microsoft.com/kb/207750/)
;  [HKEY_CURRENT_USER\Control Panel\don’t load]
;  "appwiz.cpl"=-

;These keys make sure you can install or uninstall programs:
;  [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Programs]
;  "NoProgramsAndFeatures"=-
;  "NoProgramsCPL"=-

; or disallow access:
;  "NoProgramsAndFeatures"=dword:00000001

; ============ Windows Update [**HKLM**] ===========

; These affect all users [HKLM] and would typically be set via Group Policy
;  [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update]
;Download and install
;  "AUOptions"=dword:00000004

;Download but don’t install 
;  "AUOptions"=dword:00000003

;Check but don’t download 
;  "AUOptions"=dword:00000002

;Don't check
;  "AUOptions"=dword:00000001

;Disable P2P uploads/downloads (Windows Update>Advanced>Choose how updates are delivered)
;  [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization\Config]
;  "DODownloadMode"=dword:00000000


; ============ Misc [**HKLM**] All users ===========
;
;Set the Screen Saver grace period (this only works if a valid screensaver is set)
;an alternative is adjusting the power / hibernate settings for the display.
;  [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon]
;  "ScreenSaverGracePeriod"="5"

;When opening files with an unknown extension, dont prompt to 'Look for an app in the Store'
;  [HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Explorer]
;  "NoUseStoreOpenWith"=dword:00000001

;this can also be set for all users
;  [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer]
;  "NoUseStoreOpenWith"=dword:00000001

;Display verbose messages during login (Group policy, profile loading etc)
;  [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System]
;  "verbosestatus"=dword:00000001

;Disable Cortana (Windows 10 Anniversary+)
;  [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search]
;  "AllowCortana"=dword:00000000

Many of the On/Off registry values above can be toggled between TRUE (00000001) and FALSE (00000000)

If any of the above settings could have been modified by Group Policy, use RSOP.msc (GUI utility) to see the policy settings that have been applied to the current user, or run [GPRESULT /z](gpresult.html) to see the full details of registry keys set.

If you are running DISM then equivalent settings for All Users can be found under [HKEY_LOCAL_MACHINE**WIM_Default**\Software\Microsoft\Windows\CurrentVersion\Explorer\

Windows 10 Themes can be found under:  
%userprofile%\AppData\Local\Microsoft\Windows\Themes  

"It's not like I let people do things for me, so I guess you can call me a control freak, or you can call me passionate" ~ Courteney Cox

### Related commands

[TenForums](https://www.tenforums.com/tutorials/) - Tutorials on Windows 10 personalization.  
[AskVG](https://www.askvg.com/collection-of-windows-10-hidden-secret-registry-tweaks/) - Windows 10 Hidden Secret Registry Tweaks.  
[Winaero Tweaker](https://winaero.com/winaero-tweaker/) - Free app to set various Windows 11Registry Tweaks



/. nt/syntax-security_groups.html
========================================================

 Windows Built-in Users, Default Groups and Special Identities - Windows CMD - SS64.com   

How-to: Windows Built-in Users, Default Groups and Special Identities
=====================================================================

Special identities are _implicit_ placeholders, they are not listed in **Active Directory** but are available when applying permissions – membership is automatically calculated by the OS.

Default Group

**Default User** or Session owner

Special Identity

Description

Access Control Assistance Operators

 

 

Remotely query authorization attributes and permissions for resources on the computer.  
BuiltIn Local.  
Default User Rights: None  

Account Operators

 

 

Grants limited account creation privileges to a user. Members of this group can create and modify most types of accounts, including those of users, local groups, and global groups, and members can log in locally to domain controllers.

Members of the Account Operators group cannot manage the Administrator user account, the user accounts of administrators, or the Administrators, Server Operators, Account Operators, Backup Operators, or Print Operators groups. Members of this group cannot modify user rights.  
Default [User Rights](ntrights.html): Allow log on locally: SeInteractiveLogonRight

 

Administrator

 

A user account for the system administrator. This account is the first account created during operating system installation. The account cannot be deleted or locked out. It is a member of the Administrators group and cannot be removed from that group.  
[](https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/active-directory-security-groups#bkmk-admins)

Administrators

 

 

A built-in group . Grants complete and unrestricted access to the computer, or if the computer is promoted to a domain controller, members have unrestricted access to the domain.

This group cannot be renamed, deleted, or moved. This built-in group controls access to all the domain controllers in its domain, and it can change the membership of all administrative groups. Membership can be modified by members of the following groups: the default service Administrators, Domain Admins in the domain, or Enterprise Admins.

The group is the default owner of any object that is created by a member of the group.  
[Default User Rights for Administrators](https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/active-directory-security-groups#bkmk-admins)

Allowed RODC Password Replication Group

 

 

Manage a RODC password replication policy. The _Denied RODC Password Replication Group_ group contains a variety of high-privilege accounts and security groups. The Denied RODC Password Replication group supersedes the Allowed RODC Password Replication group.  
Default [User Rights](ntrights.html): None

 

 

Anonymous Logon

A user who has logged on anonymously. This identity allows anonymous access to resources, such as a web page that is published on corporate servers.  
Default [User Rights](ntrights.html): None

 

 

Authenticated Users

A group that includes all users whose identities were authenticated when they logged on. Membership is controlled by the operating system. This identity allows access to shared resources within the domain, such as files in a shared folder that should be accessible to all the workers in the organization.  
Default [User Rights](ntrights.html):  
Access this computer from the network: SeNetworkLogonRight  
Add workstations to domain: SeMachineAccountPrivilege (Often removed in environments that have an IT administrator.)  
Bypass traverse checking: SeChangeNotifyPrivilege

Backup Operators

 

 

A built-in group. By default, the group has no members. Backup Operators can back up and restore all files on a computer, regardless of the permissions that protect those files. Backup Operators also can log on to the computer and shut it down.  
Default [User Rights](ntrights.html):  
Allow log on locally: SeInteractiveLogonRight  
Back up files and directories: SeBackupPrivilege  
Log on as a batch job: SeBatchLogonRight  
Restore files and directories: SeRestorePrivilege  
Shut down the system: SeShutdownPrivilege

 

 

Batch

Any user or process that accesses the system as a batch job (or through the batch queue) has the Batch identity. This identity allows batch jobs to run scheduled tasks, such as a nightly cleanup jobMembership is controlled by the operating system.  
Default [User Rights](ntrights.html): None

Certificate Service DCOM Access

 

 

Members of this group are allowed to connect to certification authorities in the enterprise.  
Default [User Rights](ntrights.html): None

Cert Publishers

 

 

A global group that includes all computers that are running an enterprise certificate authority. Cert Publishers are authorized to publish certificates for User objects in Active Directory.  
Default [User Rights](ntrights.html): None

Cert Server Admins

 

 

Certificate Authority Administrators - authorized to administer certificates for User objects in Active Directory. (Domain Local)

Cert Requesters

 

 

Members can request certificates (Domain Local)

Cloneable Domain Controllers

 

 

Members of the Cloneable Domain Controllers group that are domain controllers may be cloned. Default User Rights: None

Cryptographic Operators

 

 

Members of this group are authorized to perform cryptographic operations. This security group was added in Windows Vista Service Pack 1 (SP1) to configure Windows Firewall for IPsec in Common Criteria mode. Default User Rights: None

 

 

Creator Group

The person who created the file or the directory is a member of this special identity group. Windows Server operating systems use this identity to automatically grant access permissions to the creator of a file or directory. A placeholder security identifier (SID) is created in an inheritable access control entry (ACE). When the ACE is inherited, the system replaces this SID with the SID for the primary group of the object’s current owner.  
The primary group is used only by the Portable Operating System Interface for UNIX (POSIX) subsystem.  
Default [User Rights](ntrights.html): None

 

 

Creator Owner

The person who created the file or the directory is a member of this special identity group. Windows Server operating systems use this identity to automatically grant access permissions to the creator of a file or directory. A placeholder SID is created in an inheritable ACE. When the ACE is inherited, the system replaces this SID with the SID for the object’s current owner.

Denied RODC Password Replication Group

 

 

Members of the Denied RODC Password Replication group cannot have their passwords replicated to any Read-only domain controller. The purpose of this security group is to manage a RODC password replication policy. This group contains a variety of high-privilege accounts and security groups.  
Default [User Rights](ntrights.html): None

Device Owners

 

 

This group is not currently used in Windows.

Default [User Rights](ntrights.html):  
Allow log on locally: SeInteractiveLogonRight  
Access this computer from the network: SeNetworkLogonRight  
Bypass traverse checking: SeChangeNotifyPrivilege  
Change the time zone: SeTimeZonePrivilege

 

 

Dialup

Any user who accesses the system through a dial-up connection has the Dial-Up identity. This identity distinguishes dial-up users from other types of authenticated users.

 

 

Digest Authentication

Default [User Rights](ntrights.html): None

Distributed COM Users

 

 

Members of the Distributed COM Users group are allowed to launch, activate, and use Distributed COM objects on the computer.  
Default [User Rights](ntrights.html): None

DnsAdmins (installed with DNS)

 

 

Members of this group have administrative access to the DNS Server service. The default permissions are as follows: Allow: Read, Write, Create All Child objects, Delete Child objects, Special Permissions. This group has no default members.  
Default [User Rights](ntrights.html): None

DnsUpdateProxy (installed with DNS)

 

 

Members of this group are DNS clients that can perform dynamic updates on behalf of other clients, such as DHCP servers. This group has no default members. Default [User Rights](ntrights.html): None

Domain Admins

 

 

A global group whose members are authorized to administer the domain. By default, the Domain Admins group is a member of the Administrators group on all computers that have joined a domain, including the domain controllers. Domain Admins is the default owner of any object that is created in the domain's Active Directory by any member of the group. If members of the group create other objects, such as files, the default owner is the Administrators group.  
Default [User Rights](ntrights.html): as Administrators

Domain Computers

 

 

A global group that includes all computers that have joined the domain, excluding domain controllers. Default User Rights: None

Domain Controllers

 

 

A global group that includes all domain controllers in the domain. New domain controllers are added to this group automatically. Default Default [User Rights](ntrights.html): None

Domain Guests

 

 

A global group that, by default, has only one member, the domain's built-in Guest account.  
Default [User Rights](ntrights.html): See 'Guests'

Domain Users

 

 

A global group that, by default, includes all user accounts in a domain. When you create a user account in a domain, it is added to this group automatically.  
Default [User Rights](ntrights.html): See 'Users'

Enterprise Admins

 

 

A group that exists only in the root domain of an Active Directory forest of domains. It is a universal group if the domain is in native mode, a global group if the domain is in mixed mode. The group is authorized to make forest-wide changes in Active Directory, such as adding child domains. By default, the only member of the group is the Administrator account for the forest root domain.  
Default [User Rights](ntrights.html):  
See Administrators  
See Denied RODC Password Replication Group

Enterprise Key Admins

 

 

Members of this group can perform administrative actions on key objects within the forest. The Enterprise Key Admins group was introduced in Windows Server 2016. Default [User Rights](ntrights.html): None

Enterprise Read-Only Domain Controllers

 

 

Members of this group are Read-Only Domain Controllers in the enterprise. Except for account passwords, a Read-only domain controller holds all the Active Directory objects and attributes that a writable domain controller holds.  
Default [User Rights](ntrights.html): None

 

 

Enterprise Domain Controllers

A group that includes all domain controllers an Active Directory directory service forest of domains. Membership is controlled by the operating system.  
Default [User Rights](ntrights.html):  
Access this computer from the network: SeNetworkLogonRight  
Allow log on locally: SeInteractiveLogonRight

Event Log Readers

 

 

Members of this group can read event logs from local computers. The group is created when the server is promoted to a domain controller. Default [User Rights](ntrights.html): None

 

 

Everyone

All interactive, network, dial-up, and authenticated users are members of the Everyone group. This special identity group gives wide access to system resources. Whenever a user logs on to the network, the user is automatically added to the Everyone group. On computers running Windows 2000 and earlier, the Everyone group included the Anonymous Logon group as a default member, but as of Windows Server 2003, the Everyone group contains only Authenticated Users and Guest; and it no longer includes Anonymous Logon by default (although this can be changed). Membership is controlled by the operating system.  
Default [User Rights](ntrights.html):  
Access this computer from the network: SeNetworkLogonRight  
Act as part of the operating system: SeTcbPrivilege  
Bypass traverse checking: SeChangeNotifyPrivilege

Group Policy Creators Owners

 

 

A global group that is authorized to create new Group Policy objects in Active Directory. By default, the only member of the group is Administrator. The default owner of a new Group Policy object is usually the user who created it. If the user is a member of Administrators or Domain Admins, all objects that are created by the user are owned by the group. Owners have full control of the objects they own. Default [User Rights](ntrights.html): See 'Denied RODC Password Replication Group'.

 

Guest

 

A user account for people who do not have individual accounts. This user account does not require a password. By default, the Guest account is disabled.

Guests

 

 

A built-in group. By default, the only member is the Guest account. The Guests group allows occasional or one-time users to log on with limited privileges to a computer's built-in Guest account. When a member of the Guests group signs out, the entire profile is deleted. This includes everything that is stored in the %userprofile% directory, including the user's registry hive information, custom desktop icons, and other user-specific settings. This implies that a guest must use a temporary profile to sign in to the system.  
Default [User Rights](ntrights.html): None

Hyper-V Administrators

 

 

Members of the Hyper-V Administrators group have complete and unrestricted access to all the features in Hyper-V. Adding members to this group helps reduce the number of members required in the Administrators group, and further separates access.  
Introduced in Windows Server 2012. Default [User Rights](ntrights.html): None

IIS_IUSRS

 

 

IIS_IUSRS is a built-in group that is used by Internet Information Services beginning with IIS 7.0. A built-in account and group are guaranteed by the operating system to always have a unique SID. IIS 7.0 replaces the IUSR_MachineName account and the IIS_WPG group with the IIS_IUSRS group to ensure that the actual names that are used by the new account and group will never be localized.  
Default [User Rights](ntrights.html): None

Incoming Forest Trust Builders

 

 

Members of the Incoming Forest Trust Builders group can create incoming, one-way trusts to this forest. Active Directory provides security across multiple domains or forests through domain and forest trust relationships. This group cannot be renamed, deleted, or moved. Default [User Rights](ntrights.html): None

Key Admins

 

 

Members of this group can perform administrative actions on key objects within the domain.  
Default [User Rights](ntrights.html): None

 

 

Interactive

Any user who is logged on to the local system has the Interactive identity. This identity allows only local users to access a resource. Whenever a user accesses a given resource on the computer to which they are currently logged on, the user is automatically added to the Interactive group. Membership is controlled by the operating system.  
Default [User Rights](ntrights.html): None

 

KRBTGT

 

A service account that is used by the Key Distribution Center (KDC) service.

 

 

Local Service

The Local Service account is similar to an Authenticated User account. The Local Service account has the same level of access to resources and objects as members of the Users group. This limited access helps safeguard your system if individual services or processes are compromised. Services that run as the Local Service account access network resources as a null session with anonymous credentials. The name of the account is NT AUTHORITY\LocalService. This account does not have a password.  
Default [User Rights](ntrights.html):  
Adjust memory quotas for a process: SeIncreaseQuotaPrivilege  
Bypass traverse checking: SeChangeNotifyPrivilege  
Change the system time: SeSystemtimePrivilege  
Change the time zone: SeTimeZonePrivilege  
Create global objects: SeCreateGlobalPrivilege  
Generate security audits: SeAuditPrivilege  
Impersonate a client after authentication: SeImpersonatePrivilege  
Replace a process level token: SeAssignPrimaryTokenPrivilege

 

 

Local System

This is a service account that is used by the operating system. The LocalSystem account is a powerful account that has full access to the system and acts as the computer on the network. If a service logs on to the LocalSystem account on a domain controller, that service has access to the entire domain. Some services are configured by default to log on to the LocalSystem account. Do not change the default service setting. The name of the account is LocalSystem. This account does not have a password.  
Default User Rights: None

 

 

Network

This group implicitly includes all users who are logged on through a network connection. Any user who accesses the system through a network has the Network identity. This identity allows only remote users to access a resource. Whenever a user accesses a given resource over the network, the user is automatically added to the Network group. Membership is controlled by the operating system.  
Default [User Rights](ntrights.html): None

 

 

Network Service

The Network Service account is similar to an Authenticated User account. The Network Service account has the same level of access to resources and objects as members of the Users group. This limited access helps safeguard your system if individual services or processes are compromised. Services that run as the Network Service account access network resources by using the credentials of the computer account. The name of the account is NT AUTHORITY\NetworkService. This account does not have a password.  
Default [User Rights](ntrights.html):  
Adjust memory quotas for a process: SeIncreaseQuotaPrivilege  
Bypass traverse checking: SeChangeNotifyPrivilege  
Create global objects: SeCreateGlobalPrivilege  
Generate security audits: SeAuditPrivilege  
Impersonate a client after authentication: SeImpersonatePrivilege  
Restore files and directories: SeRestorePrivilege  
Replace a process level token: SeAssignPrimaryTokenPrivilege

Network Configuration Operators

 

 

Members of this group can make changes to TCP/IP settings, Rename/Enable/disable LAN connections,Delete/rename remote access connections, enter the PIN unblock key (PUK) for mobile broadband devices that support a SIM card and renew and release TCP/IP addresses on domain controllers in the domain. This group has no default members.  
Default [User Rights](ntrights.html): None

 

 

NTLM Authentication

Default [User Rights](ntrights.html): None

 

 

Other Organization

This group implicitly includes all users who are logged on to the system through a dial-up connection. Membership is controlled by the operating system. Default [User Rights](ntrights.html): None

Performance Monitor Users

 

 

Members of this group can monitor performance counters on domain controllers in the domain, locally and from remote clients without being a member of the Administrators or Performance Log Users groups.  
Default [User Rights](ntrights.html): None

Performance Log Users

 

 

Members of this group can manage performance counters, logs and alerts on domain controllers in the domain, locally and from remote clients without being a member of the Administrators group.  
Default [User Rights](ntrights.html): Log on as a batch job: SeBatchLogonRight

Power Users

 

 

By default, members of this group have no more user rights or permissions than a standard user account.  
The Power Users group did once grant users specific admin rights and permissions in previous versions of Windows.

Pre-Windows 2000 Compatible Access

 

 

A backward compatibility group which allows read access on all users and groups in the domain. By default, the special identity Everyone is a member of this group. Add users to this group only if they are running Windows NT 4.0 or earlier.  
Default [User Rights](ntrights.html):  
Access this computer from the network: SeNetworkLogonRight  
Bypass traverse checking: SeChangeNotifyPrivilege

 

 

Principal Self  
or  
Self

This identify is a placeholder in an ACE on a user, group, or computer object in Active Directory. When you grant permissions to Principal Self, you grant them to the security principal that is represented by the object. During an access check, the operating system replaces the SID for Principal Self with the SID for the security principal that is represented by the object.  
Default [User Rights](ntrights.html): None

Print Operators

 

 

A built-in group that exists only on domain controllers. By default, the only member is the Domain Users group. Print Operators can manage printers and document queues. They can also manage Active Directory printer objects in the domain. Members of this group can locally sign in to and shut down domain controllers in the domain.  
Because members of this group can load and unload device drivers on all domain controllers in the domain, add users with caution. This group cannot be renamed, deleted, or moved.  
Default [User Rights](ntrights.html):  
Allow log on locally: SeInteractiveLogonRight  
Load and unload device drivers: SeLoadDriverPrivilege  
Shut down the system: SeShutdownPrivilege

Protected Users

 

 

Members of the Protected Users group are afforded additional protection against the compromise of credentials during authentication processes. This security group is designed as part of a strategy to effectively protect and manage credentials within the enterprise. Members of this group automatically have non-configurable protection applied to their accounts. Membership in the Protected Users group is meant to be restrictive and proactively secure by default. The only method to modify the protection for an account is to remove the account from the security group. This group was introduced in Windows Server 2012 R2.  
Default [User Rights](ntrights.html): None

RAS and IAS Servers

 

 

Servers in this group are permitted access to the remote access properties of users. A domain local group . By default, this group has no members. Computers that are running the Routing and Remote Access service are added to the group automatically. Members of this group have access to certain properties of User objects, such as Read Account Restrictions, Read Logon Information, and Read Remote Access Information. Default [User Rights](ntrights.html): None

RDS Endpoint Servers

 

 

Servers that are members in the RDS Endpoint Servers group can run virtual machines and host sessions where user RemoteApp programs and personal virtual desktops run. This group needs to be populated on servers running RD Connection Broker. Session Host servers and RD Virtualization Host servers used in the deployment need to be in this group.  
Default [User Rights](ntrights.html): None

RDS Management Servers

 

 

Servers that are members in the RDS Management Servers group can be used to perform routine administrative actions on servers running Remote Desktop Services. This group needs to be populated on all servers in a Remote Desktop Services deployment. The servers running the RDS Central Management service must be included in this group. Default [User Rights](ntrights.html): None

RDS Remote Access Servers

 

 

Servers in the RDS Remote Access Servers group provide users with access to RemoteApp programs and personal virtual desktops. In Internet facing deployments, these servers are typically deployed in an edge network. This group needs to be populated on servers running RD Connection Broker. RD Gateway servers and RD Web Access servers that are used in the deployment need to be in this group. Default [User Rights](ntrights.html): None

Read-Only Domain Controllers

 

 

This group is comprised of the Read-only domain controllers in the domain. A Read-only domain controller makes it possible for organizations to easily deploy a domain controller in scenarios where physical security cannot be guaranteed, such as branch office locations, or in scenarios where local storage of all domain passwords is considered a primary threat, such as in an extranet or in an application-facing role. Default User Rights See 'Denied RODC Password Replication Group'.

Remote Desktop Users

 

 

The Remote Desktop Users group on an RD Session Host server is used to grant users and groups permissions to remotely connect to an RD Session Host server. This group cannot be renamed, deleted, or moved. It appears as a SID until the domain controller is made the primary domain controller and it holds the operations master role (also known as flexible single master operations or FSMO).  
Default [User Rights](ntrights.html): None

 

 

Remote Interactive Logon

This identity represents all users who are currently logged on to a computer by using a Remote Desktop connection. This group is a subset of the Interactive group. Access tokens that contain the Remote Interactive Logon SID also contain the Interactive SID.  
Default [User Rights](ntrights.html): None

Remote Management Users

 

 

Members of the Remote Management Users group can access WMI resources over management protocols (such as WS-Management via the Windows Remote Management service). This applies only to WMI namespaces that grant access to the user. The Remote Management Users group is generally used to allow users to manage servers through the Server Manager console, whereas the WinRMRemoteWMIUsers_ group is allows remotely running Windows PowerShell commands.  
Default User Rights: None

Replicator

 

 

Computers that are members of the Replicator group support file replication in a domain. Windows Server operating systems use the File Replication service (FRS) to replicate system policies and logon scripts stored in the System Volume (SYSVOL).

The DFS Replication service is a replacement for FRS, and it can be used to replicate the contents of a SYSVOL shared resource, DFS folders, and other custom (non-SYSVOL) data. You should migrate all non-SYSVOL FRS replica sets to DFS Replication.  
Default [User Rights](ntrights.html): None

 

 

Restricted

Users and computers with restricted capabilities have the Restricted identity. This identity group is used by a process that is running in a restricted security context, such as running an application with the RunAs service. When code runs at the Restricted security level, the Restricted SID is added to the user’s access token.  
Default [User Rights](ntrights.html): None

 

 

SChannel Authentication

Default [User Rights](ntrights.html): None

Schema Admins

 

 

A group that exists only in the root domain of an Active Directory forest of domains. It is a universal group if the domain is in native mode , a global group if the domain is in mixed mode . The group is authorized to make schema  changes in Active Directory. By default, the only member of the group is the Administrator account for the forest root domain. Because this group has significant power in the forest, add users with caution.  
Default [User Rights](ntrights.html): See 'Denied RODC Password Replication Group'.

Server Operators

 

 

A built-in group that exists only on domain controllers. By default, the group has no members. Server Operators can log on to a server interactively; create and delete network shares; start and stop services; back up and restore files; format the hard disk of the computer; and shut down the computer.  
Default [User Rights](ntrights.html):  
Allow log on locally: SeInteractiveLogonRight  
Back up files and directories: SeBackupPrivilege  
Change the system time: SeSystemTimePrivilege  
Change the time zone: SeTimeZonePrivilege  
Force shutdown from a remote system: SeRemoteShutdownPrivilege  
Restore files and directories SeRestorePrivilege  
Shut down the system: SeShutdownPrivilege

 

 

Service

Any service that accesses the system has the Service identity. This identity group includes all security principals that are signed in as a service. This identity grants access to processes that are being run by Windows Server services. Membership is controlled by the operating system.  
Default [User Rights](ntrights.html):  
Create global objects: SeCreateGlobalPrivilege  
Impersonate a client after authentication: SeImpersonatePrivilege

Storage Replica Administrators

 

 

Members of this group have complete and unrestricted access to all features of Storage Replica.  
Default [User Rights](ntrights.html): None

System Managed Accounts Group

 

 

Members of this group are managed by the system.  
Default [User Rights](ntrights.html): None

Terminal Server License Servers

 

 

Members of the Terminal Server License Servers group can update user accounts in Active Directory with information about license issuance. This is used to track and report TS Per User CAL usage. A TS Per User CAL gives one user the right to access a Terminal Server from an unlimited number of client computers or devices. This group appears as a SID until the domain controller is made the primary domain controller and it holds the operations master role (also known as flexible single master operations or FSMO).  
Default [User Rights](ntrights.html): None

 

 

Terminal Server Users

Any user accessing the system through Terminal Services has the Terminal Server User identity. This identity allows users to access Terminal Server applications and to perform other necessary tasks with Terminal Server services. Membership is controlled by the operating system.  
Default [User Rights](ntrights.html): None

 

 

This Organization

Default [User Rights](ntrights.html): None

Users

 

 

A built-in group. After the initial installation of the operating system, the only member is the Authenticated Users group. When a computer joins a domain, the Domain Users group is added to the Users group on the computer. Users can perform tasks such as running applications, using local and network printers, shutting down the computer, and locking the computer. Users can install applications that only they are allowed to use if the installation program of the application supports per-user installation.  
This group cannot be renamed, deleted, or moved.  
Default [User Rights](ntrights.html): None

Windows Authorization Access Group

 

 

Members of this group have access to the computed token GroupsGlobalAndUniversal attribute on User objects. Some applications have features that read the token-groups-global-and-universal (TGGAU) attribute on user account objects or on computer account objects in Active Directory Domain Services.  
Default [User Rights](ntrights.html): None

 

 

Window Manager\Window Manager Group

Default [User Rights](ntrights.html):  
Bypass traverse checking: SeChangeNotifyPrivilege  
Increase a process working set: SeIncreaseWorkingSetPrivilege

WinRMRemoteWMIUsers_

 

 

In Windows 8 and in Windows Server 2012, a Share tab was added to the Advanced Security Settings user interface. This tab displays the security properties of a remote file share. To view this information, you must have the following permissions and memberships, as appropriate for the version of Windows Server that the file server is running.

The WinRMRemoteWMIUsers_ group allows running PowerShell commands remotely whereas the 'Remote Management Users' group is generally used to allow users to manage servers by using the Server Manager console. This security group was introduced in Windows Server 2012.  
Default [User Rights](ntrights.html): None

Default Admin Users and Groups:
===============================

![Admin Groups in AD](syntax-admins.jpg)

### Related commands

How-to: [Understand the different types of Active Directory group](syntax-groups.html), Local Domain, Global and Universal.  
[Q271876](https://web.archive.org/web/20120327173217/https://support.microsoft.com/kb/271876) - Large Numbers of ACEs in ACLs Impair Directory Service Performance.  
[Q243330](https://support.microsoft.com/en-us/help/243330/) - Well-known security identifiers (sids) in Windows operating systems.  
[Q277752](https://web.archive.org/web/20090221162529/https://support.microsoft.com/kb/277752) - Security Identifiers for built-in groups are unresolved when modifying group policy.  
[AdminSdHolder FAQ](https://docs.microsoft.com/en-gb/archive/blogs/askds/five-common-questions-about-adminsdholder-and-sdprop) - High-privilege accounts (Admins and Account Operators) are [protected](https://specopssoft.com/blog/troubleshooting-user-account-permissions-adminsdholder/) from inadvertent modification.  
[Active Directory Security Groups](https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/active-directory-security-groups) - docs.microsoft.com



/. nt/syntax-groups.html
========================================================

    Local Domain groups, Global groups and Universal groups. - Windows CMD - SS64.com .yesbox {background-color:#c6e7cb!important;} .localbox {background-color:#98dfe6;} /* Dark mode */ @media (prefers-color-scheme: dark) { .localbox { background-color: #198b5b; color: whitesmoke; } } { max-width: 1200px; }

How-to: Understand the different types of Active Directory group.
=================================================================

This page describes the different types of Active Directory group, group scope and nesting permissions within and across WANS and domains.

Types of Groups
---------------

> _Security_ groups are used to control access to resources.  
> Security groups can also be used as email distribution lists.
> 
> _Distribution_ groups can be used only for email distribution lists, or simple administrative groupings.  
> Distribution groups cannot be used for access control because they are not "security enabled."

Group Scope
-----------

> Assuming a Native-mode enterprise.
> 
> _**Universal groups**_  
> Provide a simple 'does everything' group suitable mainly for small networks. Typically, organizations using WANs should use Universal groups only for relatively static groups in which memberships change rarely. Changes in membership will impose global catalog replication throughout an entire enterprise. Value: 8 (0x00000008)
> 
> _**Global groups**_  
> Provide domain-centric membership, place all user accounts into Global groups. Global groups can be nested within other Global groups, this can be particularly useful when delegating OU administrative functionality.  
>   
> It can be useful to give each Global group a name that is meaningful to the staff involved, i.e. matching the name of a Team or a Project, particularly if the group is also to be used as an email distribution list. Value: 2 (0x00000002)
> 
> _**Domain Local groups**_  
> Used for the direct assignment of access permissions on files, printer queues, and other such resources.
> 
> It can be useful to give each Domain Local group a name that is meaningful to the IT administrators e.g. if a group assigns rights to a shared folder on a specific server then the group name might include a prefix or suffix indicating the server name. Value: 4 (0x00000004)
> 
> _**Local groups**_  
> Stored on the local SAM (Local Computer) use for security settings that apply just to this one machine.  
> Local groups will work even if the network becomes unavailable, e.g. during a disaster recovery exercise.
> 
> The numeric values can be used to build [LDAP filters](https://web.archive.org/web/20210304201643/https://social.technet.microsoft.com/wiki/contents/articles/5392.active-directory-ldap-syntax-filters.aspx) to query Active Directory.
> 
> Other Group-Type attribute values:  
> A group that is created by the system: 1 (0x00000001)  
> An APP_BASIC group for Windows Server Authorization Manager: 16 (0x00000010)  
> An APP_QUERY group for Windows Server Authorization Manager: 32 (0x00000020)  
> A security group. If this flag is not set, then the group is a distribution group 2147483648 (0x80000000)

Best Practice
-------------

> Place users in Global groups, nest those inside Domain Local groups which in turn are used to apply permissions, as shown below. This will also maximise performance in a multi-domain forest.
> 
> ![Groups - Global Domain local and Universal.](syntax-groups.jpg)
> 
> Group membership is evaluated when a user logs on to a domain. To be sure that any membership changes have taken effect, ask the users to log-off. In contrast ACL changes or permissions applied directly to User accounts will take place immediately.  
> Granting permissions using a group from a different domain is only possible where a _trust relationship_ exists between the domains.

Single Domains
--------------

> In a single domain the _scope_ of groups will have no effect on performance. Global groups can be used for everything but you can nest groups and use Domain Local Groups to simplify management.
> 
> The fact that you cannot add a **Domain Local** group to a **Global** group is very useful to enforce the correct inheritance of rights. A common mistake is adding group permissions the wrong way around. e.g. a resource group (such as one for color printers) is added to an organisational group (such as the personnel dept) if at a later date you add someone else to the colour printers group then they will also be able to read all the personnel files.
> 
> If all organisational groups are Global and resource groups are Domain Local then it is not possible to add group permissions the wrong way around. Within a single domain individual User accounts can join either type of group, so in the above example if one extra user needed access to the printers they could still be added directly to the Domain Local colour printer group.

Separating People and Resources
-------------------------------

> It is tempting to use the same groups to hold users and also apply resource permissions but this seemingly simple setup will involve more effort to maintain.
> 
> For example, you have a finance department with 25 accountants and clerks, they need access to the Crest system, they also need editor permissions on the intranet and they need access to all the shared Account_Balances spreadsheets.
> 
> A common way to deal with this is to create 3 groups and add the 25 people to each:
> 
>     25       25           25
>  [CREST] [INTRANET] [ACCOUNT_BALANCES]
> 
> The extra work starts when someone changes job or a new hire arrives, now someone has to remember and sort out which groups each of these people needs to be added to or removed from.
> 
> The better way of managing this, is to still create the 3 groups as before but also create a group called Accounting, put the 25 people into the Accounting group, and make all the resources available to the _group_ rather than to individuals.
> 
>              25
>         [ACCOUNTING Group]
>  [res_CREST] [res_INTRANET] [res_ACCOUNT_BALANCES]
> 
> Now when a new hire arrives we add them to the accounting group and they will automatically get everything they need. Similarly when someone changes job we remove them from the accounting group and add them to a different group appropriate to their new role. Also note that this arrangement only requires 28 permissions to be set instead of 75.
> 
> Separating people and resources also makes it easy to temporarily remove access e.g. during maintenance downtime. In the above example you could just remove the Accounting group from the res_Crest group. This is much easier than having to either remove (and then later accurately replace) a bunch of individual user accounts, or having to edit the actual permissions applied to files/printers/databases.
> 
> Compare how many resource permissions are being applied in the two diagrams below:
> 
> ![Nested Groups](syntax-groups-nested.jpg)
> 
> With a flat permission structure there are fewer **groups** to maintain.  
> With separate groups for users and resources, there are fewer **permissions** to manage (the arrows in the diagram above).

Nesting one Group within another with a different scope
-------------------------------------------------------

> Rules that govern when a group can be added to another group (same domain):
> 
> *   Global groups can be nested within Domain Local groups, Universal groups and within other Global groups in the same domain.
> *   Universal groups can be nested within Domain Local groups and within other Universal groups in any domain.
> *   A Domain Local group cannot be nested within a Global or a Universal group.
> 
> > ![Group nesting](syntax-groupnesting.png)
> 
> Rules that govern when a group can be added to another group (different domain):
> 
> *   Domain Local groups can _grant access_ to resources on the same domain. For example a Domain Local group named Sales on the SS64.local domain can only grant access to resources on that domain, and not on SS64.com
> *   Domain Local groups can _accept_ anything, except for Domain Local groups from another domain. Domain Local groups accept user accounts from any domain.
> *   Global groups can _grant access_ to anything, including files/folders in any domain.
> *   Global groups cannot be nested across domains. You cannot take a Global group from SS64.local, and nest it within another Global group in SS64.com.
> *   A user or computer account from one domain cannot be nested within a Global group in another domain.
> *   Universal groups accept user/computer accounts from any domain. A Global group can also be nested within a Universal group (from any domain).
> *   A Universal group can be nested within another Universal group or Domain Local group in any domain.

Naming conventions
==================

> Active directory does allow a wide range of punctuation and spaces in group names, but to allow easy scripting stick to alphanumerics, dash and underscore, so Sales-Directors or SalesDirectors rather than "Sales Directors".
> 
> For those Global Groups which are likely to be requested by end users, it can be useful to assign a standard prefix to indicate that it is a Group/Team and not a User account, Mailbox or something else. So G-Sales-Directors, T-Sales-Managers etc.  
> This will also prevent any possibility of naming clashes with default/built-in groups.

Members - who can join each type of group:
==========================================

Group Scope

Location

Local Users can join?

Domain Users can join?

User accounts from another domain?

Local Computer accounts

Domain Computer accounts

Computer accounts from another domain

Machine Local groups can join?

Domain Local groups can join?

Global groups can join?

Universal groups can join?

Machine Local

Stored in local sam database

Yes

Yes

 

No

No

 

No

Yes

Yes

Yes

Domain Local

Stored in AD

No

Yes

Yes

No

Yes

Yes

No

Yes  
(same domain)

Yes

Yes

Global

Stored in AD

No

Yes

No

No

Yes

No

No

No

Yes  
(same domain)

No

Universal

Stored in AD

No

Yes

Yes

No

Yes

Yes

No

No

Yes

Yes

Machine local groups cannot become members of any other group, but all domain groups can become members of a Machine Local group.

Resources that a group can grant access to:
===========================================

Group Scope

Location

Can act as distribution list?

File Permissions local machine

File Permissions Domain File Server

File/Printer SHARE permissions

Can be Mail enabled

Can use to assign Mailbox permissions

Permissions on Active Directory objects

Machine Local

Stored in local sam database

No

Yes

No

Yes  
(same machine only)

No

No

No

Domain Local

Stored in AD

Yes

Yes

Yes

Yes

Yes

Yes

Yes*

Global

Stored in AD

Yes

Yes

Yes*

Yes*

Yes

Yes

Yes

Universal

Stored in AD

Yes

Yes

Yes*

Yes*

Yes

Yes

Yes

* Possible but not recommended by Microsoft.

**Admin rights**

To modify groups in AD, you must be a member of the _Account Operators_ group, the _Domain Admins_ group, or the _Enterprise Admins_ group, or you must have been delegated the appropriate authority.

“In the long history of humankind (and animal kind, too) those who learned to collaborate and improvise most effectively have prevailed” ~ Charles Darwin

### Related commands

[NET localgroup](net-useradmin.html) / [NET localgroup /domain](net-useradmin.html) / [NET group /domain](net-useradmin.html) - Create new groups.  
How-to: [Built-in Groups](syntax-security_groups.html) - Built-In Users and Security Groups.  
How-to: [circular.ps1](../ps/syntax-circular.html) - Script to find circular nested AD groups.  
[The Golden Rules of Permissions Administration](https://web.archive.org/web/20150705052045/http://networkadminkb.com/KB/a5/the-golden-rules-of-permissions-administration.aspx) ([pt2](https://web.archive.org/web/20140520093818/http://networkadminkb.com/KB/a10/axioms-of-permissions-administration.aspx)) - NetworkAdminkb.com  
[ServerFault](https://serverfault.com/questions/538688/is-there-a-performance-impact-of-direct-ad-universal-groups-assignment) - Performance impact of AD Universal groups assignment.  
Microsoft.com - [Naming conventions in Active Directory.](https://docs.microsoft.com/en-GB/troubleshoot/windows-server/identity/naming-conventions-for-computer-domain-site-ou)  
[Scripting Guy! Blog](https://web.archive.org/web/20141215152411/https://blogs.technet.com/b/heyscriptingguy/archive/2014/04/22/remediate-active-directory-members-that-don-39-t-support-lvr.aspx) - PowerShell script to remediate pre 2003 AD groups that don’t support linked-value replication.  
[Q231273](https://web.archive.org/web/20101113004132/https://support.microsoft.com/kb/231273) - Group Type and Scope Usage.  
[Q328889](https://support.microsoft.com/en-us/help/328889/) - Users who are members of more than 1,015 groups may fail logon authentication.  
[Q271876](https://web.archive.org/web/20120327173217/https://support.microsoft.com/kb/271876) - Large Numbers of ACEs in ACLs Impair Directory Service Performance (slow logon times.)  
[Q909264](https://support.microsoft.com/en-us/help/909264/) - Naming conventions in Active Directory for computers, domains, sites, and OUs.



/. nt/syntax-64bit.html
========================================================

    Detect 64 vs 32 bit OS or Process - Windows CMD - SS64.com

How-to: Detecting 64 bit vs 32 bit
==================================

Before starting to look at this, its important to be clear about what you mean by "64 bit".  
You can have a 64 bit CPU, a 64 bit operating system and a 64 bit process running.

Here are the possible combinations:

>  
> 
> CPU Hardware
> 
> Operating System
> 
> Process
> 
> 32 bit hardware
> 
> 32
> 
> 32
> 
> 32
> 
> 32 bit OS
> 
> **64**
> 
> 32
> 
> 32
> 
> 32 bit application
> 
> **64**
> 
> **64**
> 
> 32 (WOW)
> 
> Full 64 bit
> 
> **64**
> 
> **64**
> 
> **64**

Detect 64 bit processor hardware
--------------------------------

> There are a number of promising looking options in WMI and [Systeminfo](systeminfo.html), but they all pertain to the OS not the CPU.  
> Obviously a 64 bit OS must be running 64 bit hardware, but a 32 bit OS could also be running on 64 bit hardware.  
> There is currently no known way of detecting this.

Detect a 64 bit Operating System
--------------------------------

> In Vista and greater, you can use [WMIC OS](wmic.html) get osarchitecture, or in WMI/CIM Win32_ComputerSystem/OSArchitecture
> 
> In batch:
> 
> > :: Installed OS  
> > Set _os_bitness=64  
> > IF %PROCESSOR_ARCHITECTURE% == x86 (  
> >   IF NOT DEFINED PROCESSOR_ARCHITEW6432 Set _os_bitness=32  
> >   )  
> > Echo Operating System is %_os_bitness% bit
> > 
> > Via David Wang’s blog post: [Detect OS Bitness](https://blogs.msdn.microsoft.com/david.wang/2006/03/27/howto-detect-process-bitness/)
> > 
> > Windows 10 on ARM includes an x86-on-ARM64 emulation, so the possible values for PROCESSOR_ARCHITECTURE are: AMD64 or IA64 or ARM64 or (for 32 bit) x86
> 
> In PowerShell (3.0+) we can use:
> 
> [system.environment]::Is64BitOperatingSystem

Detect a 64 bit Process
-----------------------

> We can detect this with the PROCESSOR_ARCHITEW6432 variable, AMD64 = a 32 bit process under WOW64 mode:
> 
> If "%PROCESSOR_ARCHITEW6432%" == "AMD64" ECHO 32 bit process
> 
> Alternatively:
> 
> If exist [%SystemRoot%](syntax-variables.html)\SysNative\cscript.exe Echo 32 bit process
> 
> You may often see incorrect suggestions that testing for the existence of files in \windows\SysWOW64 or \windows\System32 can be used to detect 32 bit or 64 bit, but this will not work - the redirector will make both locations appear present to 32 bit and 64 bit processes.
> 
> In PowerShell (1.0+):  
> if ($env:PROCESSOR_ARCHITEW6432 -eq "AMD64") {"32 bit process"}
> 
> In PowerShell (3.0+) we can use:
> 
> [system.environment]::Is64BitProcess
> 
> e.g.
> 
> [bool]$is64 = [system.environment]::Is64BitProcess  
> If ($is64 -eq $True) {echo "64 bit process"}  

System Folders
--------------

> 64 bit versions of Windows have dynamic system folders C:\Windows\sys* to support both 64 and 32 bit programs.  
> PowerShell.exe, CMD.exe and many other programs are available as both 32 bit or 64 bit.
> 
> The dynamic sys folders will appear differently to a 32 bit session and a 64 bit session:

>  
> 
> 32 bit folder
> 
> 64 bit folder
> 
> 32 bit session
> 
> C:\Windows\system32\
> 
> C:\Windows\sysNative\
> 
> 64 bit session
> 
> C:\Windows\sysWOW64\
> 
> C:\Windows\system32\
> 
>   
> By default a 32 bit session will launch 32 bit executables from C:\Windows\System32\ but, if the OS is 64 bit, then you can still choose to launch 64 bit executables by specifying SysNative. A 32 bit session can also access 32 bit files by directly referencing the sysWOW64 folder (though there is generally no need to do that).
> 
> By default a 64 bit session will launch 64bit executables also from C:\Windows\System32\ but you can still choose to launch 32 bit executables by specifying sysWOW64.
> 
> The sysNative alias is not visible to 64 bit processes or programs and so cannot been seen in Windows Explorer.
> 
> The PROCESSOR_ARCHITEW6432 environment variable. If it’s set, then you’re in a 32-bit process on 64-bit Windows, and can use SysNative. If it’s not set, then you’re either in a 32-bit process on 32-bit Windows, or in a 64-bit process on 64-bit Windows. In that case, you can use System32.

File location environment variables
-----------------------------------

> %ProgramFiles%     = 32 bit programs on 32 bit systems "C:\Program Files"
> %ProgramFiles%     = 64 bit programs on 64 bit systems "C:\Program Files"
> %ProgramFiles(x86)% = 32 bit programs on 64 bit systems "C:\Program Files (x86)"
> 
> %SystemRoot% = Windows installation folder, typically "C:\Windows"

Run a 32 bit program
--------------------

> To run a 32 bit program or utility on a 64 bit OS, the 32 bit executable file must be called from %SystemRoot%\SysWOW64\
> 
> So for example to run a VBScript as a 32 bit process, use:
> 
> %SystemRoot%\SysWoW64\cscript.exe C:\scripts\demo.vbs
> 
> Running %SystemRoot%\SysWOW64\cmd.exe will launch a 32 bit instance of CMD.exe even if the OS is 64 bit.  
> 
> When you run a 32 bit shell (such as C:\windows\syswow64\cmd.exe) and then try to launch a command from that shell, it will always look for a 32 bit version of the command, even if you explicitly use a full path to system32, Windows will redirect to the 32 bit equivalent in syswow64 (if no 32 bit version of the command is found, then the new process will fail to launch.)
> 
> So the following will also run a 32 bit VBScript:
> 
> C:\windows\syswow64\cmd.exe  
> cscript.exe C:\scripts\demo.vbs

Run a 64 bit program from a 32 bit process
------------------------------------------

> To run a 64 bit program from a 32 bit process use the virtual folder C:\Windows\sysnative  
> 
> In many cases this is not needed as most utilities (e.g. ping.exe) have both a 32 bit and 64 bit version, however a few utilities (nbtstat, bcdedit) are only available as a 64-bit executable.  

Most of the time you don't have to think about any of this, by default, running for example "CMD" from the start menu on a 64 bit version of Windows will launch a 64 bit process (C:\Windows\System32\cmd.exe). On a 32 bit version of Windows, running "CMD" from the start menu will launch an equivalent 32 bit process. Only in cases where a utility is not available in the needed bitness (usually 64 bit) do you need to consider calling the other version.

“It's not so much that we're afraid of change or so in love with the old ways, but it's that place in between that we fear... it's like being between trapezes” ~ Marilyn Ferguson

### Related commands

How-to: [Environment Variables](syntax-variables.html) - Documented (standard) and undocumented environment variables.  
[WMIC](wmic.html) OS - Get OSArchitecture.  
[Q556009](https://web.archive.org/web/20181213052158/https://support.microsoft.com/en-gb/help/556009) - How to check if a computer is running a 32 bit or 64 bit Operating System (archived link from 2018).  
[Q896458](https://support.microsoft.com/en-us/help/896458/) - 64-bit Windows does not support 16-bit applications.



/. nt/accesschk.html
========================================================

    AccessChk.exe - Windows CMD - SS64.com

AccessChk.exe ([Sysinternals](https://learn.microsoft.com/en-us/sysinternals/downloads/accesschk))
==================================================================================================

Read the security descriptor for just about any type of Windows securable object (files, directories, registry keys, event logs, services, SMB shares, etc).

Syntax (file or printer share)
      accesschk [-s][-e][-u][-r][-w][-n][-v]-[f _account_,...] **-h** [-o [-t _object_type_]] [-d]
         **[**[-l [-i]] | [_username_]**]** _file, directory, object_

Syntax (Registry)
      accesschk [-s][-e][-u][-r][-w][-n][-v]-[f _account_,...] **-k** [-d]
         **[**[-l [-i]] | [_username_]**]** _registry_key_

Syntax (process)
      accesschk [-s][-e][-u][-r][-w][-n][-v]-[f _account_,...] **-p** [-f] [-t]] [-d]
         **[**[-l [-i]] | [_username_]**]** _process_name_

Syntax (Windows Account)
      accesschk [-s][-e][-u][-r][-w][-n][-v]-[f _account_,...] **-a** [-d]
         **[**[-l [-i]] | [_username_]**]** _right_

Syntax (Windows Service)
      accesschk [-s][-e][-u][-r][-w][-n][-v]-[f _account_,...] **-c** [-d]
         **[**[-l [-i]] | [_username_]**]** _service_name_

Key:
    -a   _right_ is a [Windows Account Right](ntrights.html). Specify "*" as the name to show all rights assigned to a user.
        When you specify a specific right, only groups and accounts directly assigned to the right are displayed.

    -c   _service_name_ is a Windows Service, e.g. ssdpsrv. Specify "*" as the name to show all services
        and scmanager to check the security of the Service Control Manager.

    -d   Only process directories or top-level keys

    -e   Only show explicitly set-Integrity Levels (Windows Vista and higher only)

    -f   If following -p, shows full process token information including groups and privileges.
        Otherwise is a list of comma-separated accounts to filter from the output.

    -h   Name is a file or printer share. Specify "*" as the name to show all shares.

    -i   Ignore objects with only inherited ACEs when dumping full access control lists.

    -k   _registry_key_ is a Registry key, e.g. hklm\software

    -l   Show full security descriptor (SDDL). Add -i to ignore inherited ACEs.

    -n   Show only objects that have no access

    -o   Name is an object in the Object Manager namespace (default is root).
        To view the contents of a directory, specify the name with a trailing backslash or add -s.
        Add -t and an object type (e.g. section) to see only objects of a specific type.

    -p   _process_name_ is a process name or PID, e.g. cmd.exe (specify "*" as the name to show all processes).
        Add -f to show full process token information, including groups and privileges.
        Add -t to show threads.

    -q   Omit Banner

    -r   Show only objects that have read access

    -s   Recurse

    -t   Object type filter, e.g. "section"

    -u   Suppress errors

    -v   Verbose, includes Windows Vista Integrity Level and any specific accesses granted to an account.

    -w   Show only objects that have write access

As a part of ensuring that they've created a secure environment Windows administrators often need to know what kind of accesses specific users or groups have to resources including files, directories, Registry keys, global objects and Windows services. AccessChk quickly answers these questions with an intuitive interface and output.

If you specify a user or group name and path, AccessChk will report the effective permissions for that account; otherwise it will show the effective access for accounts referenced in the security descriptor.

By default, the path name is interpreted as a file system path (use the "\pipe\" prefix to specify a named pipe path).

For each object, AccessChk prints **R** if the account has read access, **W** for write access, and nothing if it has neither.

To install, download and copy AccessChk into a folder on your executable [path](path.html).

**Example:**  

Report the accesses that the 'Power Users' account has to files and directories in \Windows\System32:  

C:> accesschk "power users" c:\windows\system32

Show which Windows services members of the 'Users' group have write access to:  

C:> accesschk users -cw *

See what Registry keys under HKLM\CurrentUser a specific account has no access to:  

C:> accesschk -kns ss64dom\mruss hklm\software

See the security on the HKLM\Software key:  

C:> accesschk -k hklm\software

See all files under \Users\Mark on Vista that have an explicit integrity level:  

C:> accesschk -e -s c:\users\mark

See all global objects that Everyone can modify:  

C:> accesschk -wuo everyone \basednamedobjects

### Related commands

[CACLS](../nt/cacls.html) - Change file and folder permissions (ACLs).  
[iCACLS](icacls.html) - Change file and folder permissions (ACLs).  
[XCACLS](xcacls.html) - Display or modify Access Control Lists (ACLs) for files and folders.  
[SetObjectSecurity](setobjectsecurity.html) - Set security for an object (file, directory, reg key etc).  
Equivalent bash command (Linux): [cp](../bash/cp.html) - Copy one or more files to another location.



/. nt/addusers.html
========================================================

    AddUsers - Add multiple user accounts - Windows CMD - SS64.com

ADDUSERS.exe ([Windows 2000 Resource Kit](../links/windows.html#kits))
======================================================================

Automate the creation of a large number of users. This utility is now unsupported, consider using a PowerShell script with [New-ADUser](../ps/new-aduser.html), [Set-ADAccountPassword](../ps/set-adaccountpassword.html), [Add-ADPrincipalGroupMembership](../ps/add-adprincipalgroupmembership.html) and [Enable-ADAccount](../ps/enable-adaccount.html)

Syntax


  Create Users:
            AddUsers /c _filename_ [/s:x] [/?] _Domain_ _Password_options_
  Dump to file:
            AddUsers /d{:u} _filename_ [/s:x] [/?] _Domain_ _Password_options_
  Erase Users:
            AddUsers /e _filename_ [/s:x] [/?] _Domain_ _Password_options_
key

    _Filename_   - The **comma-delimited** file that AddUsers uses for data.

    /s:_x_       - Change the delimiter character used in _filename_ to _x_.
                e.g. /s:~ would make the delimiter "~" 
 
    _Domain_     - Query the Primary Domain Controller (PDC) of _domain_.
                You can also use \Servername to specify the machine where user accounts are created or read. 
                AddUsers will use the local computer by default (if you do not specify _Domain_)

    /c         - Create user accounts, local groups, and global groups as specified by _filename_.

    /d{:u}     - Dump user accounts, local groups, and global groups to _filename_.

> The (:u) is an optional switch that causes current accounts to be written to the specified file in Unicode text format. Choosing to dump current user accounts does not save the account's passwords or any security information for the accounts.  
> Note: Password information is not saved in a user account dump and if you use the same file to create accounts, all passwords of newly created accounts will be empty. To back up security information for accounts, use a Tape Backup.

    /e         - Erase the user accounts specified in the file name. 
                CAUTION: Be careful when erasing user accounts, as it is not possible to recreate
                an account with the same SID. This option will not erase built-in accounts. 

 _Password_options_
    /p:        - Set account creation options, used along with any combination of the following:
      * l     - Users do not have to change passwords at next logon.
      * c     - Users cannot change passwords.
      * e     - Passwords never expire. (implies l option)
      * d     - Accounts disabled.
                By default, all created users are required to change their password at logon.

### Examples

Create a comma-delimited text file, which contains the new users to be created. Following the Syntax as follows:

[Users.txt]  
User Name,Full name, Password, Description, HomeDrive, Homepath, Profile, Script

e.g.

[Users.txt]  
jimmye,James Edward Phillip II,,,,,,  
alexd,Alex Denuur,,,E:\,E:\users\alexd,,  
ronj,Ron Jarook,ChangeThis,,E:\,E:\users\ronj,,  
sarahs,Sarah Smith,,,,,,  
u0123,Mike Olarte,,,,,,

Save the file as C:\Users.txt and execute the command

AddUsers MyDomain /c c:\Users.txt /p:e

“That’s two hours I’ll never get back, is a favorite thing for an angry person to say about a movie he hates. But the thing is, every two hours are two hours he’ll never get back” - Charlie Kaufman

### Related commands

[DSADD](dsadd.html) - Add user (computer, group..) in active directory.  
[CSVDE](csvde.html) - Import and export from Active Directory.  
Equivalent bash command (Linux): [useradd](../bash/useradd.html) - Create new user accounts.



/. nt/admodcmd.html
========================================================

    ADmodcmd - ADmodify - Windows CMD - SS64.com

ADmodcmd.exe
============

Active Directory Bulk Modify Tool ([Command Line Version](https://blogs.technet.com/b/exchange/archive/2004/08/04/208045.aspx)) There is also a GUI for this tool called admodify.exe

Syntax

      admodcmd [-dn _BaseDN_] [-p _pagesize_] [-s] [-server _servername_]
        [-f _LDAPFilter_] [_modification_]

Key
    -dn _BaseDN_      Base DN to begin the LDAP query.

    _modification_    Modification to perform:
                   [Terminal Server Attributes](admodcmd-ts.html) ➞ [Exchange Related Attributes](admodcmd-ex.html)
                   [Mailbox Rights](admodcmd-mail.html) ➞ [User Account Settings](admodcmd-user.html) ➞ [Custom Attributes](admodcmd-custom.html)                  

    -p _pagesize_     LDAP Page size to use for query.

    -s              Perform a subtree search 
                   (Default = one level search)

    -server _servername_
                   The server to make the changes to.
                   by default, changes  are made locally if on a DC.
                   If on a member, DNS is used to find a DC.

    -f _LDAPFilter_   A Valid LDAP filter to use when enumerating objects
                   The default filter is (objectClass=user).   

Changes made with ADModcmd can be undone, as long as the xml log file that logged the changes still exists. These log files are typically located in the same folder as the admodify executable.

Syntax:
      admodcmd [-dn _BaseDN_] [-p _pagesize_] [-s] [-server _servername_]
         -undo _logfilename_ -server _servername_]

Key: 
    _logfilename_     The log file that contains the changes to be undone.

    servername      The DC to write the changes to.
                   by default, changes  are made locally if on a DC.
                   If on a member, DNS is used to find a DC.

For information on users that were skipped during an undo process, refer to the undo.log file.

_“A free people claim their rights as derived from the laws of nature, and not as the gift of their magistrate” - Thomas Jefferson_

### Related commands

[DSQuery](dsquery.html) - Search for items in active directory ([user](dsquery-user.html) [group](dsquery-group.html) [computer](dsquery-computer.html))  
[DSMod](dsmod.html) - Modify items in active directory ([user](dsmod-user.html) [group](dsmod-group.html) [computer](dsmod-computer.html))



/. nt/arp.html
========================================================

    Arp - Address Resolution Protocol - Windows CMD - SS64.com

ARP.exe
=======

ARP - Address Resolution Protocol.  
  
Display and modify the IP-to-Physical address translation tables used by address resolution protocol.

Syntax

    View the contents of the local ARP cache table 
      ARP -a [_ip_addr_] [-N _if_addr_]

    Add a static Arp entry for frequent accessed hosts 
      ARP -s _ip_addr_ _eth_addr_ [_if_addr_]

    Delete an entry 
      ARP -d _ip_addr_ [_if_addr_]

Key
    -a           Display current ARP entries.
                Can include more than one network interface.
                If ip_addr is specified, the IP and Physical
                addresses for only the specified computer are displayed. 
    -g           Same as -a.

    -N _if_addr_   Display the ARP entries for the network interface specified
                by if_addr.

    -d _ip_addr_   Delete the host specified by ip_addr.
                -d *  will delete all hosts.

    -s           Add the host and associates the Internet address ip_addr
                with the Physical address eth_addr.  The Physical address is
                given as 6 hexadecimal bytes separated by hyphens. The entry
                is permanent.

    _eth_addr_     Specifies a physical address.

    _if_addr_      If present, this specifies the Internet address of the
                interface whose address translation table should be modified.
                If not present, the first applicable interface will be used.

If two hosts on the same sub-net cannot ping each other successfully, try running ARP -a to list the addresses on each computer to see if they have the correct MAC addresses.

A host's MAC address can be checked using [IPCONFIG](ipconfig.html). If another host with a duplicate IP address exists on the network, the ARP cache might have had the MAC address for the other computer placed in it. ARP -d is used to delete an entry that is incorrect.

### Examples

Display the ARP cache tables for all interfaces:

C:> arp -a

Display the ARP cache table for the interface on IP address 10.1.4.99:

C:> arp -a -N 10.1.4.99

Add a static ARP cache entry on IP addr 10.1.4.77 to the physical address 00-AA-21-4A-2F-9A:

C:> arp -s 10.1.4.77 00-AA-21-4A-2F-9A

_“One resolution I have made, and try always to keep, is this: To rise above little things” ~ John Burroughs_

### Related commands

[ROUTE](route.html) - Manipulate network routing tables.



/. nt/assoc.html
========================================================

    Assoc - File extension and Type - Windows CMD - SS64.com

ASSOC
=====

Display or change the association between a file extension and a fileType

Syntax


    Read file associations:
    ASSOC
    ASSOC ._ext_

    Set a file association:
    ASSOC ._ext_ = [_fileType_]

    Remove _a_ file association:
    ASSOC .ext =

Key
    ._ext_      : The file extension
    fileType  : The type of file 

A file extension is the last few characters in a FileName after the period.  
So a file called JANUARY.HTML has the file extension .HTML  
  
The File extension is used by Windows to determine the type of information stored in the file and therefore which application(s) will be able to display the information in the file. File extensions are not case sensitive and are not limited to 3 characters.  
  
More than one file extension can be associated with the same File Type.  
e.g. both the extension .JPG and the extension .JPEG can be associated with the File Type "jpegfile"  
  
At any one time a given file extension can only be associated with one File Type.

So the path is: File Extension >> File Type >> executable program  
e.g. .TXT > txtfile >> \system32\NOTEPAD.EXE

Here is a list of [Common File Extensions and FileTypes](syntax-extensions.html).

If you change the extension .JPG so it is associated with the File Type "txtfile" then it's normal association with "jpegfile" will disappear. Removing the association to "txtfile" does not restore the association to "jpegfile", but if you restore the association to "jpegfile" with ASSOC that will automatically restore the link for .JPG files back to the original executable program.  
  
The command ASSOC followed by just a file extension will display the current File Type for that extension.  

An association can be set for files with no file extension using .=

e.g. associate all no-extension files with notepad:  
ASSOC .=txtfile  

Tamper protection
-----------------

> Per user file associations are stored in the registry under HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts  
> Starting with Windows 8, Microsoft introduced “tamper protection” into the registry to prevent any unauthorized changes to file associations (changes not made via the Windows API).
> 
> In most cases use of the ASSOC command will result in, the first time opening a file with that extension will prompt the user:  
> _How do you want to open this file?_ / Keep using this app or _An app default was reset_
> 
> One way to work with these new restrictions is to create the desired file associations manually, and then [export](https://answers.microsoft.com/en-us/windows/forum/windows_10-files/windows-file-association-explained-for-desktop/cfa62c00-82e0-4d05-b302-3444ab930bb7) that file via a [DISM](dism.html) command:  
> Dism /Online /Export-DefaultAppAssociations:C:\demo\AppAssoc.xml
> 
> The exported file can then be specified in group policy, and applied to client machines where it will supersede any choice the user may have manually set.

GUI
---

> File Types can be displayed in Windows Settings under:  
> Apps ➞ Default apps ➞ Choose default apps by file type  
>   
> The Settings pane will only display installed applications (FileTypes) and/or an option to install apps from the Windows store. There is no option to manually add a non-Windows store application using the GUI, but you can do this with [FTYPE](ftype.html) on the command line.

Errorlevels
-----------

> When [CMD Command Extensions](cmd.html) are enabled (the default)
> 
> If the file Association was successfully changed [%ERRORLEVEL%](errorlevel.html) = unchanged, typically this will be 0 but if a previous command set an errorlevel, that will be preserved (this is a bug).  
> If the File Association could not be changed [%ERRORLEVEL%](errorlevel.html) = 1

ASSOC is an [internal](syntax-internal.html) command.  
If [Command Extensions](cmd.html) are disabled, the ASSOC command will not function.

### Examples

View the current file association for .csv files:  
  
C:> ASSOC .csv  
.csv=Excel.csv  
  
Opening .csv files directly in Excel may be harmful, better to select _Data > From text file_ and run the import wizard.  
So instead we can associate .csv files with txtfile (the default text editor, typically notepad):  
  
C:> ASSOC .csv=txtfile

List all the current file associationa and back them up to a text file:

C:> ASSOC >backup.txt  
  
Delete a file association:  
  
C:> ASSOC .html=

Repair .REG and .EXE file associations:

C:> ASSOC .EXE=exefile  
C:> ASSOC .REG=regfile

Digging through CLASSES_ROOT entries often reveals more than one shell for the same application, for example [open] and [play] these can have subtle differences, changing the default action for a file extension can even invoke a different executable.

“Of all forms of caution, caution in love is perhaps the most fatal to true happiness” - Bertrand Russell

### Related commands

[FTYPE](ftype.html) - Edit file types (used in file extension associations).  
Batch file to list the [application associated](fassoc.txt) with a file extension.  
[SetUserFTA](https://kolbi.cz/blog/2017/10/25/setuserfta-userchoice-hash-defeated-set-file-type-associations-per-user/) - Utility to set the file type association.  
[Raymond Chen](https://devblogs.microsoft.com/oldnewthing/20170517-00/?p=96175) - Why do my PDF file associations get reset every time I restart?  
[Editing Shell entries & Context Menu handlers](https://enderman.ch/blog/the-windows-context-menu/) - Edit the context menu.  
[Q162059](https://support.microsoft.com/en-us/help/162059/) - Associate Internet Explorer with MS Office files.



/. nt/attrib.html
========================================================

    Attrib - Edit file attributes - Windows CMD - SS64.com

ATTRIB.exe
==========

Display or change file attributes.

Syntax

      ATTRIB [ + _attribute_ | - _attribute_ ] [_pathname_] [/S [/D]] [/L]

Key
     +    : Turn an attribute ON
     -    : Clear an attribute OFF

 _pathname_ : Drive and/or filename e.g. C:*.txt
    /S    : Search the pathname including all subfolders.
    /D    : Process folders as well
    /L    : Work on the attributes of the symbolic link versus the target of the Symbolic link.

    _attributes_: 
        R  Read-only (1)
        A  Archive (32)
        S  System (4)
        H  Hidden (2)

    _extended attributes_:
        B  SMB Blob Attribute (Windows 10)
        E  Encrypted
        C  Compressed (128:read-only)
        I  Not content-indexed

        N  Normal (0: cannot be used for file selection)
        O  Offline
        P  Pinned Attribute (Windows 10) This refers to the "Always available on this device" setting for OneDrive files.
        T  Temporary 
        X  No scrub file attribute (Windows 8+)
        U  Unpinned Attribute (Windows 10)
        V  Integrity attribute (Windows 8+)

The numeric values can be used when changing [attributes with VBS/WSH](https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-basic-6/aa242866(v=vs.60))  
If no attribute is specified attrib will return the current attribute settings.  
Used with just the /S option ATTRIB will quickly search for a particular filename.  
In older versions of Windows, Explorer would display 'p' to indicate a 'sparse' file.

Hidden and System attributes take priority.
-------------------------------------------

> If a file has both the Hidden and System attributes set, you can clear both attributes only with a single ATTRIB command.  
>   
> For example, to clear the Hidden and System attributes for the RECORD.TXT file, type:  
> ATTRIB -S -H RECORD.TXT
> 
> If a file has the System or Hidden attribute set, you must clear that attribute before you can change any other attributes with ATTRIB.

Wildcards
---------

> You can use wildcards (? and *) with the _pathname_ parameter to display or change the attributes for a group of files.

Directory Attributes
--------------------

> You can display or change _some_ attributes for a directory/folder.
> 
> The Read-only attribute (R) does [not apply](https://support.microsoft.com/en-us/help/326549/) to a folder. This is because unlike a file, a folder object does not contain any content that can be edited. The Name of a folder can be changed but that is a _rename_ operation not an _edit_ of the contents.
> 
> The Read-only attribute of a folder can be set or cleared in Windows Explorer as a fast method of setting/clearing the Read-only attribute of all files within the folder. It does not actually set the attribute on the folder itself.
> 
> To use ATTRIB with a directory, you must explicitly specify the directory name; you cannot use wildcards to work with directories.  
> So the following command would affect only files, not directories:  
> ATTRIB +H C:*.*
> 
> To hide the directory C:\SECRET:  
> ATTRIB +H C:\SECRET  
> 
> Detect [whether a path points to a file or a directory](syntax-isdirectory.html) by [reading](syntax-args.html) the Extended Attribute for 'Directory' (as listed below).
> 
> The System attribute is used by Windows to determine that a folder is a _special_ folder, such as My Documents, Favorites, Fonts, etc.  

Archive attribute
-----------------

> The Archive attribute (A) is used to mark files that have changed since they were previously backed up.  
> The (A) flag is automatically updated by Windows as the file is saved.  
> If the (A) flag is present - the file is new or has been changed since the last backup.  
>   
> The MSBACKUP, RESTORE, and XCOPY commands use these Archive attributes, as do most 3rd party backup solutions.

Temporary attribute
-------------------

> DFSR will [not replicate](https://social.technet.microsoft.com/Forums/en/winserverfiles/thread/9164f02c-b81b-477a-b9b3-e71dcd10248e) files if they have the Temporary attribute set.  
> The temporary attribute can be removed by using PowerShell to subtract 0x100:
> 
> PS C:> Get-childitem D:\Data -recurse | ForEach-Object -process {if (($_.attributes -band 0x100) -eq 0x100) {$_.attributes = ($_.attributes -band 0xFEFF)}}

Extended Attributes
-------------------

> Extended Attributes are only available on NTFS volumes. File attributes can be read with [FSUTIL](fsutil.html) usn readdata _filename.ext_
> 
> Constants - the following attribute values are returned by the [GetFileAttributes](https://docs.microsoft.com/en-gb/windows/desktop/FileIO/file-attribute-constants) function:
> 
> Attribute
> 
> Constant
> 
> Dec
> 
> Hex
> 
> **(R) Read-only file**. Applications can read the file, but cannot write to it or delete it. This attribute is not honored on directories.
> 
> FILE_ATTRIBUTE_READONLY  
> 
> 1
> 
> 0x1
> 
> **(H) Hidden**. The file or directory is hidden. It is not included in an ordinary directory listing.
> 
> FILE_ATTRIBUTE_HIDDEN  
> 
> 2
> 
> 0x2
> 
> **(S) System.** A file or directory that the operating system uses a part of, or uses exclusively.
> 
> FILE_ATTRIBUTE_SYSTEM  
> 
> 4
> 
> 0x4
> 
> **Directory**. The handle that identifies a directory.
> 
> FILE_ATTRIBUTE_DIRECTORY  
> 
> 16
> 
> 0x10
> 
> **(A) Archive**. A file or directory that is an archive file or directory. Applications typically use this attribute to mark files for backup or removal .
> 
> FILE_ATTRIBUTE_ARCHIVE  
> 
> 32
> 
> 0x20
> 
> **Device.** This value is reserved for system use.
> 
> FILE_ATTRIBUTE_DEVICE
> 
> 64
> 
> 0x40
> 
> **Normal**. A file that does not have other attributes set. This pseudo attribute is considered to be set if all other attributes (including the extended attributes) are reset.
> 
> FILE_ATTRIBUTE_NORMAL
> 
> 128
> 
> 0x80
> 
> **(T) Temporary.** A file that is being used for temporary storage. The OS will prefer cache memory for files marked as temporary.
> 
> FILE_ATTRIBUTE_TEMPORARY
> 
> 256
> 
> 0x100
> 
> **Sparse file.** A file that is a sparse file. A sparse file has an attribute that causes the I/O subsystem to allocate only meaningful (nonzero) data. Nonzero data is allocated on disk, and non-meaningful data (large strings of data composed of zeros) is not.
> 
> FILE_ATTRIBUTE_SPARSE_FILE  
> 
> 512
> 
> 0x200
> 
> **Reparse point**. A file or directory that has an associated reparse point, or a file that is a symbolic link.
> 
> FILE_ATTRIBUTE_REPARSE_POINT  
> 
> 1024
> 
> 0x400
> 
> **(C) Compressed** file or directory that is compressed. For a file, all of the data in the file is compressed. For a directory, compression is the default for newly created files and subdirectories.
> 
> FILE_ATTRIBUTE_COMPRESSED  
> 
> 2048
> 
> 0x800
> 
> **(O) Offline.** The data of a file is not available immediately. This attribute indicates that the file data is physically moved to offline storage. This attribute is used by Remote Storage, which is the hierarchical storage management software. Applications should not arbitrarily change this attribute.
> 
> FILE_ATTRIBUTE_OFFLINE  
> 
> 4096
> 
> 0x1000
> 
> **(I) Not Indexed**. The file or directory is not to be indexed by the content indexing service.
> 
> FILE_ATTRIBUTE_NOT_CONTENT_INDEXED  
> 
> 8192
> 
> 0x2000
> 
> **(E) Encrypted** file or directory. For a file, all data streams in the file are encrypted. For a directory, encryption is the default for newly created files and subdirectories.
> 
> FILE_ATTRIBUTE_ENCRYPTED
> 
> 16,384
> 
> 0x4000
> 
> **Integrity**. The directory or user data stream is configured with 'integrity' (only supported on ReFS volumes) which gives ReFS the ability to reliably detect file corruption.. It is not included in an ordinary directory listing.
> 
> FILE_ATTRIBUTE_INTEGRITY_STREAM
> 
> 32,768
> 
> 0x8000
> 
> **Virtual.** This value is reserved for system use.
> 
> FILE_ATTRIBUTE_VIRTUAL
> 
> 65,536
> 
> 0x10000
> 
> **(X) No Scrub.** The user data stream not to be read by the background data integrity scanner (AKA scrubber) for proactive error correction. When set on a directory it only provides inheritance. This flag is only supported on Storage Spaces and ReFS volumes. It is not included in an ordinary directory listing.
> 
> FILE_ATTRIBUTE_NO_SCRUB_DATA
> 
> 131,072
> 
> 0x20000
> 
> **(U) UnPinned.**
> 
> FILE_ATTRIBUTE_UNPINNED
> 
> 1,048,576
> 
> 0x00100000
> 
> **(P) Pinned.** This refers to the "Always available on this device" setting for OneDrive files.
> 
> FILE_ATTRIBUTE_PINNED
> 
> 524,288
> 
> 0x00080000
> 
> **(M) Recall on Data Access.** When this attribute is set, it means that the file or directory is not fully present locally. For a file that means that not all of its data is on local storage (e.g. it may be sparse with some data still in remote storage). For a directory it means that some of the directory contents are being virtualized from another location. Reading the file / enumerating the directory will be more expensive than normal, e.g. it will cause at least some of the file/directory content to be fetched from a remote store. Only kernel-mode callers can set this bit.
> 
> FILE_ATTRIBUTE_RECALL_ON_DATA_ACCESS
> 
> 4,194,304
> 
> 0x00400000
> 
> For example, a file attribute of 0x120 indicates the Temporary + Archive attributes are set (0x100 + 0x20 = 0x120.)

OneDrive status combinations
----------------------------

> Always available  
> PINNED : **True**  
> UNPINNED : False  
> FILE_ATTRIBUTE_RECALL_ON_DATA_ACCESS : False
> 
> Online-only  
> PINNED : False  
> UNPINNED : **True**  
> FILE_ATTRIBUTE_RECALL_ON_DATA_ACCESS : **True**
> 
> Locally available  
> PINNED : False  
> UNPINNED : False  
> FILE_ATTRIBUTE_RECALL_ON_DATA_ACCESS : False

"The moral sense of conscience is by far the most important.. it is the most noble of all the **attributes** of man" - Charles Darwin

### Related commands

[CACLS](cacls.html) - Change file permissions.  
An alternative way to display extended attributes is using [FOR parameter attributes](syntax-args.html#attributes)  
[FSUTIL](fsutil.html) - File and Volume utilities.  
[Show superhidden file extensions.](superhidden.html)  
[Q326549](https://support.microsoft.com/en-us/help/326549/) - Read-only & System attributes for folders.  
PowerShell equivalent:([Get-Item](../ps/get-item.html) 'example.txt').Attributes / [Get-ItemProperty](../ps/get-itemproperty.html) / [Set-ItemProperty](../ps/set-itemproperty.html) - [Example script](../ps/syntax-attrib.html)  
Equivalent bash command (Linux): [chmod](../bash/chmod.html) - Change access permissions.



/. nt/bcdboot.html
========================================================

    BCDBOOT - Windows CMD - SS64.com

BCDBOOT.exe
===========

Set up a system partition, repair the boot environment located on the system partition. BCDBoot can create a Boot Configuration Data (BCD) store on the system partition using the latest version of the Windows files.

Syntax

      BCDBOOT _source_ [/l _locale_] [/s _volume-letter_ [/f _firmware_]] [/v]
         [/vbcd] [/m [{_OS_Loader_GUID_}]] [/addlast] [/p] [/bcdclean [full]] [/c]

Options

    source  The location of the Windows directory to use as the source for
           copying boot-environment files.

    /l      The locale to use when initialising the BCD store. default = US English.

    /s      Optional. Specifies the volume letter of the system partition.
           This option should not be used in typical deployment scenarios.
           Use this setting to specify a system partition when you are configuring a drive that will
           be booted on another computer, such as a USB flash drive or a secondary hard drive.
           The default is the system partition identified by the firmware.

    /v      Enable verbose mode.

    /vbcd   Enable BCD Logging.

    /m      If an _OS_Loader_GUID_ is specified, merge the given loader object within
           the system template to produce a bootable entry.
           Otherwise, by default, merge only global objects.

    /d      Preserve the existing default Windows Boot entry.

    /f      Used with /S, specifies the firmware type of the target system partition
           Options for _firmware_ are 'UEFI', 'BIOS', or 'ALL'

           If you specify 'ALL', BCDBoot will create both the \Boot and the \Efi\Microsoft\Boot
           directories, and will copy all required boot-environment files for BIOS and UEFI.

  /addlast  Specifies that the Windows Boot Manager firmware entry should be added last.
           The default behavior is to add it first. Cannot be used with /p.

  /bcdclean Clean the BCD Store. By default, simply removes any duplicate entries in
           the BCD. Can be followed by 'full'. In this case, each entry is scanned
           If the corresponding device for that entry does not exist, the entry is deleted.

    /p      Specifies that the existing Windows Boot Manager firmware entry position should be
           preserved in the UEFI boot order. If the entry does not exist, a new entry is
           added in the first position. Cannot be used with /addlast.

           By default, during an upgrade BCDBoot moves the Windows Boot Manager to be
           the first entry in the UEFI boot order.

    /c      Specifies that any existing BCD elements should not be migrated.
           By default, during an upgrade, BCD elements such as debugsettings or flightsigning are preserved.

BCDboot can also be run from Windows PE (Preinstallation Environment).

### Examples

Initialize the system partition by using BCD files from the C:\Windows folder:

C:> bcdboot C:\Windows

Set the default BCD locale to Japanese, and copy BCD (Boot Configuration Data) files to drive S:

C:> bcdboot C:\Windows /l ja-jp /s S:

Merge the OS loader in the current BCD store identified with the given GUID in the new BCD store:

C:> bcdboot c:\windows /m {d58d10c6-df53-11dc-878f-00064f4f4e08}

“When all the world is young, lad, / And all the trees are green / And every goose a swan, lad / And every lass a queen / Then hey for boot and horse, lad, / And round the world away / Young blood must have its course, lad, / And every dog his day” - Charles Kingsley

### Related commands

[BCDEDIT](bcdedit.html) - Manage Boot Configuration Data.  
[BOOTREC](bootrec.html) - Repair or replace a partition boot sector (WinRE).  
[WPEUTIL](wpeutil.html) - Run commands during a Windows Preinstallation Environment (WinPE) session.  
[FSUTIL](fsutil.html) - File and Volume utilities.



/. nt/bcdedit.html
========================================================

    BCDEDIT - Windows CMD - SS64.com

BCDEDIT.exe
===========

Manage Boot Configuration Data (BCD) data stores.

Syntax

      BCDEdit /Command [_Argument1_] [_Argument2_] ...

Key
      /? _commmand_   To display detailed help for a particular command, run bcdedit /? _command_,
                    where _command_ is the name of the command you are searching for more information about.
                    e.g. bcdedit /? createstore

    Store commands:

      /createstore  Creates a new empty boot configuration data store.
                    The created store is not a system store.

      /export       Export the contents of the system store into a file.
                    This file can be used later to restore the state of the system store.
                    Valid only for the system store.

      /import       Restore the state of the system store by using a backup data file
                    previously generated with /export.
                    This command deletes any existing entries in the system store before
                    the import takes place. Valid only for the system store.

      /store        This option can be used with most BCDedit commands to specify
                    the store to be used. If this option is not specified, then
                    BCDEdit operates on the system store.
                    Running the bcdedit /store command by itself is equivalent to running
                    the bcdedit /enum active command.

      /sysstore     Set the system store device. This only affects EFI-based systems.
                    It does not persist across reboots, and is only used in cases where the system
                    store device is ambiguous.

    Operating on entries in a store:

      /copy         Make a copy of a specified boot entry in the same system store.

      /create       Create a new entry in the boot configuration data store.
                    If a well-known identifier is specified, then the /application, /inherit, and
                    /device options cannot be specified. If an identifier is not specified or not well
                    known, an /application, /inherit, or /device option must be specified. 

      /delete       Delete an element from a specified entry.

      /mirror       Create a mirror of entries in the store.

    Changing entry options:

      /deletevalue  Delete a specified element from a boot entry.

      /set          Set an entry option value.

    List current settings:

      /enum [_type_ | _id_] [/v]
                    List entries in a store.
                    _Type_s: ACTIVE, FIRMWARE, BOOTAPP, BOOTMGR, OSLOADER, RESUME, INHERIT, ALL
                    The /enum option is the default value for BCEdit, so running
                    the bcdedit command without options is equivalent to running the bcdedit /enum active command.

      /v            Verbose mode.
                    Usually, any well-known entry identifiers are represented by their friendly shorthand form.
                    Specifying /v as a command-line option displays all identifiers in full.
                    Running the bcdedit /v command by itself is equivalent to running the bcdedit /enum active /v command.

    Controlling the boot manager:

      /bootsequence Specifies a one-time display order to be used for the next boot.
                    This command is similar to the /displayorder option, except that it is used only the
                    next time the computer starts. Afterwards, the computer reverts to the original
                    display order.
      /default      Specifies the default entry that the boot manager selects when the timeout expires.

      /displayorder Specifies the display order that the boot manager uses when displaying boot options
                    to a user.
      /timeout      Specifies the time to wait, in seconds, before the boot manager selects the default entry.

      /toolsdisplayorder  Specifies the display order for the boot manager to use when displaying the Tools menu.

    Emergency Management Services options:

      /bootems      Enable or disable Emergency Management Services (EMS) for the specified entry.

      /ems          Enable or disable EMS for the specified operating system boot entry.

      /emssettings  Set the global EMS settings for the computer.
                    /emssettings does not enable or disable EMS for any particular boot entry.

    Debugging:

      /bootdebug    Enable or disable the boot debugger for a specified boot entry.
                    Although this command works for any boot entry, it is effective only for boot applications.

      /dbgsettings  Specifies or displays the global debugger settings for the system.
                    This command does not enable or disable the kernel debugger; use the /debug option for
                    that purpose. To set an individual global debugger setting, use the
                    bcdedit /setdbgsettings type value command.

      /debug        Enable or disable the kernel debugger for a specified boot entry.

      /hypervisorsettings  Set the hypervisor parameters.

    Undocumented:

      /loglevel _level_ [/raw]

                 _level_ is one of the following:
                     t  : trace (stdout)
                     i  : info (stdout)
                     w  : warning (stderr)
                     e  : error (stderr)

                 /raw   : Display extra details for the device and osdevice fields.

                 Normal display:
                 device                  partition=\Device\HarddiskVolume2
                 osdevice                partition=C:

                 With /raw
                 device                  PartEx 2800000 HD MBR Sig:151767d7
                 osdevice                PartEx 3ed200000 HD MBR Sig:151767d7

BCDEdit is a command-line tool for managing Boot Configuration Data (BCD). BCD files provide a store that is used to describe boot applications and boot application settings.

A normal shutdown and reboot is necessary to ensure that any modified BCDEdit settings are flushed to disk.

BCDEdit is included in the %WINDIR%\System32 folder.  
BCDEdit is limited to the standard data types and is designed primarily to perform single common changes to BCD.

Some common BCD operations, such as recovering a partition or setting up a new PC's system partition, may be more easily accomplished by using [BCDBOOT](bcdboot.html).

Administrative privileges are required to use BCDEdit to modify Boot Configuration Data.

### Examples

This command will enable the system to trust Windows Insider Preview builds that are signed with certificates that are not trusted by default:

Bcdedit /set {bootmgr} flightsigning on  
Bcdedit /set flightsigning on

Reboot after running the command.  
  
To turn off flightsigning:

Bcdedit /set {bootmgr} flightsigning off  
Bcdedit /set flightsigning off

“I’d rather wake up in the middle of nowhere than in any city on earth” - Steve McQueen

### Related commands

[BCDBOOT](bcdboot.html) - Create or repair a system partition.  
[BOOTREC](bootrec.html) - Repair or replace a partition boot sector (WinRE).  
[WPEUTIL](wpeutil.html) - Run commands during a Windows Preinstallation Environment (WinPE).  
[Windows Recovery Environment (WinRE), Safe mode and Win PE.](syntax-recovery.html)



/. nt/bitsadmin.html
========================================================

    BITSADMIN - Background Intelligent Transfer Service - Windows CMD - SS64.com

BITSADMIN
=========

Manage the Background Intelligent Transfer Service (BITS). The BITS Service can be used to transfer large files from remote hosts. BITS supports throttled and asynchronous transfer of files between machines using idle network bandwidth. This service is used by Windows Update, SUS, SMS and many third party packages.

BITSADMIN is deprecated in Windows 7 / 2008 R2 and above, it is superceeded by the new PowerShell [BITS cmdlets](../ps/bits.html).

Syntax

      BITSADMIN [/RAWRETURN] [/WRAP | /NOWRAP] _command_

The following commands are available:

    /UTIL /?          Print the list of utilities commands
    /PEERCACHING /?   Print the list of commands to manage Peercaching
    /CACHE /?         Print the list of cache management commands
    /PEERS /?         Print the list of peer management commands

    /LIST    [/ALLUSERS] [/VERBOSE]     List the jobs
    /MONITOR [/ALLUSERS] [/REFRESH sec] Monitor the copy manager
    /RESET   [/ALLUSERS]                Delete all jobs in the manager

    /TRANSFER _job name_ [type] [/PRIORITY priority] [/ACLFLAGS _flags_]
          _remote_url local_name_
                                       Transfer one of more files.
       [type] can be /DOWNLOAD or /UPLOAD; default is download
       Multiple URL/file pairs can be specified.
       Unlike most commands, _job name_ can only be a name and not a GUID.

    /CREATE [type] _job name_             Create a job
       [type] can be /DOWNLOAD, /UPLOAD, or /UPLOAD-REPLY; default is download
       Unlike most commands, _job name_ can only be a name and not a GUID.

    /INFO _job_ [/VERBOSE]                Display information about the job

    /ADDFILE _job remote_url local_name_  Add a file to the job

    /ADDFILESET _job textfile_            Add multiple files to the job
      Each line of _textfile_ lists a file's remote name and local name, separated
      by spaces.  A line beginning with '#' is treated as a comment.
      Once the file set is read into memory, the contents are added to the job.

    /ADDFILEWITHRANGES  _job remote_url local_name range_list_
      Like /ADDFILE, but BITS will read only selected byte ranges of the URL.
      _range_list_ is a comma-delimited series of offset and length pairs.
      For example,

       0:100,2000:100,5000:eof

      instructs BITS to read 100 bytes starting at offset zero, 100 bytes starting
      at offset 2000, and the remainder of the URL starting at offset 5000.

    /REPLACEREMOTEPREFIX _job old_prefix new_prefix_
       All files whose URL begins with _old_prefix_ are changed to use _new_prefix_

      Note that BITS currently supports HTTP/HTTPS downloads and uploads.
      It also supports UNC paths and file:// paths as URLS

    /LISTFILES _job_                     List the files in the job
    /SUSPEND _job_                       Suspend the job
    /RESUME _job_                        Resume the job
    /CANCEL _job_                        Cancel the job
    /COMPLETE _job_                      Complete the job

    /GETTYPE _job_                       Retrieve the job type
    /GETACLFLAGS _job_                   Retrieve the ACL propagation flags

    /SETACLFLAGS _job ACL_flags_         Set the ACL propagation flags for the job
     O - OWNER       G - GROUP
     D - DACL        S - SACL 

     Examples:
         bitsadmin /setaclflags MyJob OGDS
         bitsadmin /setaclflags MyJob OGD

    /GETBYTESTOTAL _job_                 Retrieve the size of the job
    /GETBYTESTRANSFERRED _job_           Retrieve the number of bytes transferred
    /GETFILESTOTAL _job_                 Retrieve the number of files in the job
    /GETFILESTRANSFERRED _job_           Retrieve the number of files transferred
    /GETCREATIONTIME _job_               Retrieve the job creation time
    /GETMODIFICATIONTIME _job_           Retrieve the job modification time
    /GETCOMPLETIONTIME _job_             Retrieve the job completion time
    /GETSTATE _job_                      Retrieve the job state
    /GETERROR _job_                      Retrieve detailed error information
    /GETOWNER _job_                      Retrieve the job owner
    /GETDISPLAYNAME _job_                Retrieve the job display name
    /SETDISPLAYNAME _job display_name_   Set the job display name
    /GETDESCRIPTION _job_                Retrieve the job description
    /SETDESCRIPTION _job description_    Set the job description
    /GETPRIORITY    _job_                Retrieve the job priority
    /SETPRIORITY    _job priority_       Set the job priority
      Priority usage choices:
         FOREGROUND
         HIGH
         NORMAL
         LOW
    /GETNOTIFYFLAGS _job_                Retrieve the notify flags
    /SETNOTIFYFLAGS _job notify_flags_   Set the notify [flags](https://docs.microsoft.com/en-gb/windows/desktop/api/bits/nf-bits-ibackgroundcopyjob-setnotifyflags)
    /GETNOTIFYINTERFACE _job_            Determines if notify interface is registered
    /GETMINRETRYDELAY _job_              Retrieve the retry delay in seconds
    /SETMINRETRYDELAY _job retry_delay_  Set the retry delay in seconds
    /GETNOPROGRESSTIMEOUT _job_          Retrieve the no progress timeout in seconds
    /SETNOPROGRESSTIMEOUT _job timeout_  Set the no progress timeout in seconds
    /GETMAXDOWNLOADTIME _job_            Retrieve the download timeout in seconds
    /SETMAXDOWNLOADTIME _job timeout_    Set the download timeout in seconds
    /GETERRORCOUNT _job_                 Retrieve an error count for the job

    /SETPROXYSETTINGS _job usage_        Set the proxy usage
      usage choices:
       PRECONFIG   - Use the owner's IE defaults.
       AUTODETECT  - Force autodetection of proxy.
       NO_PROXY    - Do not use a proxy server.
       OVERRIDE    - Use an explicit proxy list and bypass list.
                     Must be followed by a proxy list and a proxy bypass list.
                     NULL or "" can be used for an empty proxy bypass list.

Examples:
      bitsadmin /setproxysettings MyJob PRECONFIG
      bitsadmin /setproxysettings MyJob AUTODETECT
      bitsadmin /setproxysettings MyJob NO_PROXY
      bitsadmin /setproxysettings MyJob OVERRIDE proxy1:80 "_local_"
      bitsadmin /setproxysettings MyJob OVERRIDE proxy1,proxy2,proxy3 NULL

    /GETPROXYUSAGE _job_                 Retrieve the proxy usage setting
    /GETPROXYLIST _job_                  Retrieve the proxy list
    /GETPROXYBYPASSLIST _job_            Retrieve the proxy bypass list

    /TAKEOWNERSHIP _job_                 Take ownership of the job

    /SETNOTIFYCMDLINE _job program_name_ [program_parameters]
       Sets a program to execute for notification, and optionally parameters.
       The program name and parameters can be NULL.
       IMPORTANT: if parameters are non-NULL, then the program name should be the
                  first parameter.

     Examples:
       bitsadmin /SetNotifyCmdLine MyJob c:\windows\system32\notepad.exe  NULL
       bitsadmin /SetNotifyCmdLine MyJob c:\foo.exe "c:\foo.exe parm1 parm2"
       bitsadmin /SetNotifyCmdLine MyJob NULL NULL

    /GETNOTIFYCMDLINE _job_               Return the job's notification command line

    /SETCREDENTIALS _job target scheme username password_
     Adds credentials to a job.
     _target_ can be either SERVER or PROXY
     _scheme_ can be BASIC, DIGEST, NTLM, NEGOTIATE, or PASSPORT.

    /REMOVECREDENTIALS _job target scheme_
     Removes credentials from a job.
    /GETCUSTOMHEADERS _job_                        Get the Custom HTTP Headers
    /SETCUSTOMHEADERS _job header1 header2 ..._    Set the Custom HTTP Headers
    /GETCLIENTCERTIFICATE _job_                    Get the job's Client Certificate Information
    /SETCLIENTCERTIFICATEBYID _job store_location store_name hexa-decimal_cert_id_
     Set a client authentication certificate to a job.
     _store_location_    can be
       1(CURRENT_USER), 2(LOCAL_MACHINE), 3(CURRENT_SERVICE),
       4(SERVICES), 5(USERS), 6(CURRENT_USER_GROUP_POLICY),
       7(LOCAL_MACHINE_GROUP_POLICY) or 8(LOCAL_MACHINE_ENTERPRISE).

    /SETCLIENTCERTIFICATEBYNAME _job store_location store_name subject_name_
     Set a client authentication certificate to a job.
     _store_location_ can be
       1(CURRENT_USER), 2(LOCAL_MACHINE), 3(CURRENT_SERVICE),
       4(SERVICES), 5(USERS), 6(CURRENT_USER_GROUP_POLICY),
       7(LOCAL_MACHINE_GROUP_POLICY) or 8(LOCAL_MACHINE_ENTERPRISE).

    /REMOVECLIENTCERTIFICATE _job_                Remove the Client Certificate Information from the job

    /SETSECURITYFLAGS _job value_
      Set the HTTP security flags for URL redirection and checks performed on the server cert. during the transfer.
      The value is an unsigned integer with the following interpretation for the bits in the binary representation.
        Enable CRL Check                                 : Set the least significant bit
        Ignore invalid common name in server certificate : Set the 2nd bit from right
        Ignore invalid date in  server certificate       : Set the 3rd bit from right
        Ignore invalid certificate authority in server
          certificate                                    : Set the 4th bit from right
        Ignore invalid usage of certificate              : Set the 5th bit from right
        Redirection policy                               : Controlled by the 9th-11th bits from right
            0,0,0  - Redirects will be automatically allowed.
            0,0,1  - Remote name in the IBackgroundCopyFile interface will be updated if a redirect occurs.
            0,1,0  - BITS will fail the job if a redirect occurs.

        Allow redirection from HTTPS to HTTP             : Set the 12th bit from right

    /GETSECURITYFLAGS _job_   
      Report the HTTP security flags for URL redirection and checks performed on the server certificate during the transfer.

    /SETVALIDATIONSTATE _job file-index true|false_
          starts from 0         
       Set the content-validation state of the given file within the job.

    /GETVALIDATIONSTATE  _job file-index_
          starts from 0         
       Report the content-validation state of the given file within the job.

    /GETTEMPORARYNAME  _job file-index_
      _file-index_ starts from 0         
       Report the temporary filename of the given file within the job.

The following options control peercaching of a particular job:

    /SETPEERCACHINGFLAGS  _job value_
       Sets the flags for the job's peercaching behavior.
       The value is an unsigned integer with the following interpretation for the bits in the binary representation.
           Allow the job's data to be downloaded from a peer : Set the least significant bit
           Allow the job's data to be served to peers        : Set the 2nd bit from right

    /GETPEERCACHINGFLAGS  _job_               
       Report the flags for the job's peercaching behavior.

The following options are valid for UPLOAD-REPLY jobs only:

    /GETREPLYFILENAME _job_        Get the path of the file containing the server reply
    /SETREPLYFILENAME _job path_   Set the path of the file containing the server reply
    /GETREPLYPROGRESS _job_        Get the size and progress of the server reply
    /GETREPLYDATA     _job_        Dump the server's reply data in hex format

The following options can be placed before the command:
    /RAWRETURN                     Return data more suitable for parsing
    /WRAP                          Wrap output around console (default)
    /NOWRAP                        Don’t wrap output around console

    The /RAWRETURN option strips new line characters and formatting.
    It is recognized by the /CREATE and /GET* commands.

Commands that take a _job_ parameter will accept either a job name or a job ID GUID inside braces.

BITSADMIN reports an error if a name is ambiguous.

BITSADMIN does not work with relative paths.  
  
Many commands are only compatible with Microsoft IIS servers (e.g. upload).

BITSADMIN is deprecated in Windows 7 / 2008 R2 and above, it is superceeded by the new PowerShell [BITS cmdlets](../ps/bits.html).

### Examples

Create a new download job:  
C:> Bitsadmin /create /download SS64  
  
Add a file that we want to download to the job and specify a location where the downloaded file will be stored:  
C:> Bitsadmin /addfile SS64 https://download.sysinternals.com/files/SysinternalsSuite.zip c:\PSTools.zip  
C:> Bitsadmin /resume SS64  
  
Check if a download job has finished and if so complete the job:  
C:> Bitsadmin /info SS64 /verbose | find "STATE: TRANSFERRED"  
C:> IF %ERRORLEVEL% EQU 0 bitsadmin /complete SS64

“Downloading is definitely on the rise, but not because it's free - that's probably third on the list - but because it's immediate and the selection is virtually unlimited” ~ Don Rose

### Related commands

[Certutil.exe](certutil.html) -urlcache -split - Intended for downloading certificates, but will download any file.  
[ROBOCOPY](robocopy.html) - Robust File and Folder Copy.  
[FTP](ftp.html)- File Transfer Protocol.  
Equivalent PowerShell: [Bits cmdlets](../ps/bits.html)  
Equivalent bash command (Linux): wget - Retrieve web pages or files, curl - Transfer data to or from a server.



/. nt/bootrec.html
========================================================

    BOOTREC - - Windows CMD - SS64.com

BOOTREC.exe ([Windows RE](syntax-recovery.html))
================================================

Repair or replace a partition boot sector.

Syntax  
      BOOTREC /FIXMBR      Write an MBR to the system partition.

      BOOTREC /FIXBOOT     Writes a new boot sector onto the system partition.

      BOOTREC /SCANOS      Scans all disks for Windows installations and display entries not currently in the BCD store.

      BOOTREC /REBUILDBCD  Scans all disks for Windows installations and provide a choice of which entries to add to the BCD store.

/FixMbr does not overwrite the existing partition table. Use this option when you must resolve MBR corruption issues, or when you have to remove nonstandard code from the MBR.

Use /FixBoot if The boot sector was damaged or replaced.

### Examples

Use Bootrec.exe to troubleshoot a "Bootmgr Is Missing" error.  
If rebuilding the BCD store doesn’t resolve the startup issue, you can export and delete the BCD store and then run this option again. By doing this, you make sure that the BCD store is completely rebuilt. To do this, type the following commands at the Windows RE command prompt:

bcdedit /export C:\BCD_Backup  
c:  
cd boot  
attrib bcd -s -h -r  
ren c:\boot\bcd bcd.old  
bootrec /RebuildBcd

_“If you want a picture of the future, imagine a boot stamping on a human face — forever” ~ George Orwell (1984)_

### Related commands

[BCDBOOT](bcdboot.html) - Create or repair a system partition.  
[BCDEDIT](bcdedit.html) - Manage Boot Configuration Data.  
[SYSPREP](https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/sysprep--generalize--a-windows-installation?view=windows-11) - (Generalize) a Windows installation.  
[WPEUTIL](wpeutil.html) - Run commands during a Windows Preinstallation Environment (WinPE) session.



/. nt/break.html
========================================================

    BREAK - Do nothing - Windows CMD - SS64.com

BREAK
=====

Do nothing, successfully.  

Syntax

      BREAK

In the old MS-DOS operating system, the break command would set or clear extended Ctrl-C checking. Under Microsoft Windows the command has no effect, but can be a useful no-op command.

On the command line, BREAK will produce a new line, in a batch file it does not.

BREAK is an [internal](syntax-internal.html) command.

### Examples

Do nothing:

C:> break

Read, but do not display a file:

C:> Type demo.txt | break

Run an echo command without displaying anything:

C:> echo Hello | break

Create an empty file:

C:> break > EmptyFile.txt

_“Better bend than break” ~ Scottish Proverb_

### Related commands

How-To: [Redirecting NULL](syntax-redirection.html)  
Equivalent bash command (Linux): [true](../bash/true.html) - Do nothing, successfully.



/. nt/browstat.html
========================================================

    Browstat - Get domain, browser and PDC info. - Windows CMD - SS64.com

BROWSTAT.exe ([NT4/2000 Resource Kit](../links/windows.html#kits))
==================================================================

Get NetBIOS browser and PDC information.  
NetBIOS was deprecated in Windows 2000 and above, BROWSTAT is not supported on Server 2008 R2.

Syntax

      BROWSTAT _option_

Options:

 BROWSTAT Dumpnet
 BROWSTAT dn                  : Display the transports bound to browser

 BROWSTAT GetPdc _Transport Domain_
 BROWSTAT gp _Transport Domain_ : List the PDC name (via NetBIOS)

 BROWSTAT GetMaster _Transport Domain_ 
 BROWSTAT gm _Transport Domain_ : List the remote Master Browser name(via NetBIOS)

 BROWSTAT Getblist _Transport_        
 BROWSTAT gb _Transport_        : List the backup DNS Servers.

 BROWSTAT ListWfw
 BROWSTAT wfw                 : WindowsForWorkgroups servers running browser.

 BROWSTAT Stats \_ServerName_    
 BROWSTAT sts \_ServerName_    : List all browser statistics

 BROWSTAT Status              : Display Transport,Primary DNS
 BROWSTAT sta                   and Backup DNS servers.

 BROWSTAT Status -v _domain_    : Verbose Status Display
 BROWSTAT sta -v _domain_         include Server OS and active browsers.

 BROWSTAT Tickle
 BROWSTAT Tic                 : Force remote master to stop.

 BROWSTAT Elect
 BROWSTAT el                  : Force election on remote domain

 BROWSTAT View _Transport_
 BROWSTAT vw _Transport_
 BROWSTAT vw _Transport ‹domain›_
 BROWSTAT vw _Transport \Server_
 BROWSTAT vw _Transport \‹Server›_ /DOMAIN ‹_DomainToQuery_›

The VIEW options can enumerate server services running across a server or domain. Other Browstat features will only work only within a single network subnet. To span subnets/routers across a domain, run browstat via [psexec](psexec.html).  
  
In the list displays, the following flags are used:

 W  = _Workstation_             NT  = Windows NT
 S  = Server                  W95 = Windows95
SQL = SQLServer               WFW = WindowsForWorkgroups
SS  = StandardServer          MFPN= MS Netware
PDC = PrimaryDomainController NV  = Novell
BDC = BackupDomainController  XN  = Xenix

TS  = Time Source
MBC = Member Server
PQ  = Print Queue Server
DL  = Dial-in Server
AFP = AFP Server
OSF = OSF Server
VMS = VMS Server

PBR = Potential Browser
BBR = Backup Browser,
MBR = Master Browser
DMB = DomainMaster Browser
DFS = Distributed File System

### Examples

Display transports:

C:>browstat dn  
  
List of transports currently bound to the browser  
  
1 \Device\NetBT_Tcpip_{B1AFFCA2-6410-4644-9FE7-BA6C274FD4F3}

List the backup DNS servers for transport #1:

C:>browstat gb 1

Browser: \PC00096  
Browser: \PC00082

List Print queues for transport #1:  
  
C:> BROWSTAT vw 1 |find "PQ"

_“If your experiment needs statistics, you ought to have done a better experiment” - Ernest Rutherford_

### Related commands

[Q188305](https://support.microsoft.com/en-us/help/188305/) - Troubleshooting the Browser Service.  
DNSSTAT - DNS Statistics.  
[NETSTAT](netstat.html) - Display networking statistics (TCP/IP).



/. nt/cacls.html
========================================================

    Cacls - Modify Access Control List - Windows CMD - SS64.com

CACLS.exe
=========

Display or modify Access Control Lists (ACLs) for files and folders.

This command has been deprecated, use [icacls](icacls.html) instead.  
  
Access Control Lists apply only to files stored on an NTFS formatted drive, each ACL determines which users (or groups of users) can read or edit the file. When a new file is created it normally inherits ACL's from the folder where it was created.

Syntax

      CACLS _[pathname](path.html#pathname)_ [_options_]

Options:

    /T   Search the pathname including all subfolders. (/TREE)
    /E   Edit ACL, leave existing rights unchanged (/EDIT)
    /C   Continue on access denied errors. (/CONTINUE)
    /L   Work on the Symbolic Link itself versus the target (/LINK)
    /M   Change ACLs of volumes mounted to a directory (/MOUNT)

    /G _user_:_permission_
        Grant access rights (/GRANT), permision can be:
          R  Read 
          W  Write
          C  Change (read/write) 
          F  Full control

    /R _user_
        Revoke specified user's access rights, only valid with /E. (/REVOKE)

    /P _user_:_permission_
        Replace access rights (/RE**P**LACE), permission can be: 
          R  Read
          W  Write
          C  Change (read/write) 
          F  Full control
          N  None

    /D _user_
        Deny access to _user_. (/DENY)

    /S
        Display the SDDL string for the DACL. (/SSDL)
    /S:_sddl_
        Replace the ACL(s) with those specified in the SDDL string
        (not valid with /E, /G, /R, /P, or /D).

    (The long /aliases in brackets are undocumented)

In all the options above "_user_" can be a UserName or a group (either local or global)

You can specify more than one _user:permission_ in a single command.

[Wildcards](syntax-wildcards.html) can be used to specify multiple files.

If a UserName or GroupName includes spaces then it must be surrounded with quotes e.g. "Authenticated Users"  
  
If no options are specified CACLS will display the ACLs for the file(s)

Setting Deny permission (/D) will deny access to a user even if they also belong to a group that grants access.

Limitations
-----------

> If the file/folder is currently open (locked) it may not be possible to change the permissions without first closing the file locks. This can be done in Computer Management ➞ Shared Folders ➞ Open files.
> 
> Cacls cannot set the following permissions: _Change permissions, Take ownership, Execute, Delete_, use [XCACLS](xcacls.html) to set any of these.

Using CACLS
-----------

*   The CACLS command does not provide a /Y switch to automatically answer 'Y' to the Y/N prompt. However, you can [pipe](syntax-redirection.html) the 'Y' character into the CACLS command using [ECHO](echo.html), use the following syntax:  
      
    ECHO Y| CACLS _filename_ /g _username_:_permission_  
      
    
*   To edit a file you must have the "Change" ACL (or be the file's owner)  
    
*   To use the CACLS command and change an ACL requires "FULL Control"  
    
*   File "Ownership" will always override all ACL's - you always have Full Control over files that you create.  
    
*   If CACLS is used without the /E switch all existing rights on [pathname] will be replaced, any attempt to use the /E switch to change a [user:permission] that already exists will raise an error. To be sure the CACLS command will work without errors use /E /R to remove ACL rights for the user concerned, then use /E to add the desired rights.  
    
*   The /T option will only traverse subfolders below the **current** directory

> If no options are specified CACLS will display the current ACLs  
> To display the current folder:  
> CACLS .  
>   
> Display permissions for one file:  
> CACLS MyFile.txt  
>   
> Display permissions for multiple files:  
> CACLS *.txt  
>   
> Inherited folder permissions are displayed as:
> 
>  OI - Object inherit    - This folder and files. (no inheritance to subfolders)
>  CI - Container inherit - This folder and subfolders.
>  IO - Inherit only      - The ACE does not apply to the current file/directory
>  ID - Inherited         - The ACE was inherited from the parent directory's ACL.
> 
> These can be combined as follows:
>  (OI)(CI)      This folder, subfolders, and files.
>  (OI)(CI)(IO)  Subfolders and files only.
>      (CI)(IO)  Subfolders only.
>  (OI)    (IO)  Files only. 
> 
> So BUILTIN\Administrators:(OI)(CI)F means that both files and Subdirectories will inherit 'F' (Fullcontrol)  
> similarly (CI)R means Directories will inherit 'R' (Read folders only = List permission)
> 
> To actually change the inheritance of a folder/directory use [iCACLS /grant](icacls.html) or [iCACLs /deny](icacls.html)
> 
> When cacls is applied to the current folder only there is no inheritance and so no output.

Errors when changing permissions
--------------------------------

> If a user or group has a permission on a file or folder and you grant a second permission to the same user/group on the same folder, NTFS will sometimes produce the error message "The parameter is incorrect" To fix this (or prevent it happening) revoke the permission first /e /r and then apply a fresh grant /e /g
> 
> No mapping between account names and security IDs was done  
> This error indicates that cacls looked up the group or username given in Active Directory and didn’t find anything, often this means that you need to prefix the name with a domain name ss64dom\user64 or (for a local account) the name of the machine pc64\localUser2 also check for simple typos.

### Examples

Add Read-Only permission to a single file  
CACLS myfile.txt /E /G "Power Users":R

Add Full Control permission to a second group of users  
CACLS myfile.txt /E /G "FinanceUsers":F

Now revoke the Read permissions from the first group  
CACLS myfile.txt /E /R "Power Users"  
  
Now give the first group Full-control:  
CACLS myfile.txt /E /G "Power Users":F

Give the Finance group Full Control of a folder and all sub folders  
CACLS c:\docs\work /E /T /C /G "FinanceUsers":F

“It's easier to ask forgiveness than it is to get permission” ~ Rear Admiral Grace Hopper

### Related commands

[ATTRIB](attrib.html) - Display or change file attributes.  
[iCACLS](icacls.html) - Change file and folder permissions (ACLs).  
[XCACLS](xcacls.html) - Change file and folder permissions (ACLs).  
[DIR /Q](dir.html) - Display the owner for a list of files (try it for Program files).  
[PERMS](perms.html) - Show permissions for a user.  
[FSUTIL](fsutil.html) - File System Options.  
[NTRIGHTS](ntrights.html) - Edit user account rights.  
[SetObjectSecurity](setobjectsecurity.html) - Set security for an object (file, directory, reg key etc).  
[TAKEOWN](takeown.html) - Take ownership of files.  
[AccessEnum](https://www.microsoft.com/technet/sysinternals/FileAndDisk/AccessEnum.mspx) - GUI to browse a tree view of user privs.  
[Q271876](https://web.archive.org/web/20120327173217/https://support.microsoft.com/kb/271876) - Complex ACLs impair directory service performance.  
[Permissions](syntax-permissions.html) explained.  
PowerShell equivalent: [Get-Acl](../ps/get-acl.html) / [Set-Acl](../ps/set-acl.html) - Set permissions.  
Equivalent bash command (Linux): [chmod](../bash/chmod.html) - Change access permissions.



/. nt/call.html
========================================================

    Call - Windows CMD - SS64.com

CALL
====

Call one batch program from another, or call a subroutine.

Syntax


      CALL [_drive_:][_path_]_filename_ [_[parameters](syntax-args.html)_]

      CALL :_label_ [_[parameters](syntax-args.html)_]

      CALL _internal_cmd_

Key:
    pathname     The batch program to run.

    parameters   Any command-line arguments.

    :_label_       Jump to a label in the current batch script.

    _internal_cmd_ Run an [internal](syntax-internal.html) command, first expanding any variables in the argument.

The Microsoft help for the CALL command states: "_Calls one batch program from another without stopping the parent batch program_" to expand on this, it is true that the parent does not STOP, but it does PAUSE while the second script runs.

### Examples

CALL a second batch file
------------------------

> The CALL command will launch a new batch file context along with any specified parameters. When the end of the second batch file is reached (or if EXIT is used), control will return to just after the initial CALL statement.
> 
> Arguments can be passed either as a simple string or using a variable:
> 
> CALL MyScript.cmd "1234"  
> CALL OtherScript.cmd %_MyVariable%
> 
> Example
> 
> ::----------start main.cmd-----------  
> @Echo off  
> CALL function.cmd 10 first  
> Echo %_description% - %_number%  
>   
> CALL function.cmd 15 second  
> Echo %_description% - %_number%  
> ::----------end main.cmd-------------  
>   
> ::----------start function.cmd---------  
> @Echo off  
> :: Add 25 to %1  
> SET /a _number=%1 + 25  
> :: Store %2  
> SET _description=[%2]  
> ::----------end function.cmd-----------
> 
> In many cases you will also want to use [SETLOCAL](setlocal.html) and [ENDLOCAL](endlocal.html) to keep variables in different batch files completely separate, this will avoid any potential problems if two scripts use the same variable name.
> 
> If you execute a second batch file _without_ using CALL you may run into some buggy behaviour: if both batch files contain a label with the same name and you have previously used CALL to jump to that label in the first script, you will find execution of the second script starts at the same label. Even if the second label does not exist this will still raise an error _"cannot find the batch label"_. This bug can be avoided by always using CALL.

CALL a subroutine (:label)
--------------------------

> The CALL command will pass control to the statement after the label specified along with any specified parameters.  
> To exit the subroutine specify GOTO:eof this will transfer control to the end of the current subroutine.
> 
> A label is defined by a single colon followed by a name:
> 
> :myShinyLabel
> 
> If placed inside [brackets](syntax-brackets.html), the label must be followed by at least one valid command, even just an ECHO or REM command.  
> The maximum length for a label is 127 characters, no spaces.
> 
> This is the basis of a batch file [function](syntax-functions.html).
> 
> CALL :sub_display 123  
> CALL :sub_display 456  
> ECHO All Done  
> GOTO :eof
> 
> :sub_display  
> ECHO The result is %1  
> EXIT /B  
>   
> At the end of the subroutine an [EXIT /B](exit.html) will return to the position where you used CALL  
> (GOTO :eof can also be used for this)

Call and optionally continue
----------------------------

> In some cases you may want to call a second batch file (or subroutine) and continue only if it succeeded.
> 
> CALL SecondScript.cmd [||](syntax-redirection.html) goto :eof
> 
> This will [goto:eof](goto.html) if SecondScript.cmd returns an [errorlevel](errorlevel.html) greater than zero, you can force an errorlevel by using [Exit /b 1](exit.html)

Passing by Reference
--------------------

> In addition to passing numeric or string values on the command line, it is also possible to pass a [variable](syntax-variables.html) name and then use the variable to transfer data between scripts or subroutines. Passing by reference is a slightly more advanced technique but can be essential if the string contains characters that are CMD [delimiters](syntax-esc.html#delimiters) or quotes, otherwise passing a string like _Start & middle:"and & End_ is likely to break something.

    @Echo off
    Echo:
    Set "var1=Red Pippin"
    Set "var2=St Edmunds Pippin"
    Set "var3=Egremont Russet"

    Echo: before: var1=%var1%  var2=%var2% var3=%var3%
    call **:myGetFunc** var1 var2 var3
    Echo: after: var1=%var1%  var2=%var2% var3=%var3%

    Echo:&pause&goto:eof

    ::----------------------------------------------
    ::-- Function section starts below
    ::----------------------------------------------

    **:myGetFunc**    - passing a variable by reference
    Set "%~1=return64"
    Set "%~3=return65"
    EXIT /B

Buggy behaviour when using CALL
-------------------------------

> [Redirection](syntax-redirection.html) via a pipe '|' does not always work as expected.  
> This will work:  
> CALL :function >file.txt  
> This will fail:  
> CALL :function | more  
> More details can be found in this SO question: [Why does delayed expansion fail when inside a piped block of code?](https://stackoverflow.com/q/8192318/1720814)  
> 
> If the CALL command contains a caret character within a quoted string "test^ing" , the carets will be [doubled](https://stackoverflow.com/a/4095133/1720814).

Advanced usage - CALLing internal commands
------------------------------------------

    CALL _command_ [_command_parameters_]

> CALL _command_ can be used to run an executable or a second batch file, but can also be used to run any [internal](syntax-internal.html) command (SET, ECHO etc) with the exception of FOR and IF. CALL will expand any variables passed on the same line.  
>   
> CALL [REM](rem.html) only partly works: [redirection](syntax-redirection.html) operators, conditional execution operators and [brackets](syntax-brackets.html) will be not remarked.
> 
> This is undocumented behaviour, in fact whenever CALL is run without a : prefix, it will always search disk for a batch file/executable called _command_ before running the internal command. The effect of this extra disc access is that CALL SET is significantly slower than CALL, its use in loops or with a large number of variables should be avoided.  
>   
> Example
> 
>  @Echo off
>  SETLOCAL
>  set _server=frodo
>  set _var=_server
>  **CALL SET** _result=**%%**%_var%**%%**
>  echo %_result%
> 
> The line shown in bold has the '%' symbols tripled, CALL will expand this to: SET _result=frodo
> 
> Each CALL does one substitution of the variables. (You can also do CALL CALL... for multiple substitutions)
> 
> In many cases, [DelayedExpansion](delayedexpansion.html) is a better/faster method:
> 
>  @Echo Off
>  Setlocal EnableDelayedExpansion
>  Set _server=frodo
>  Set _var=_server
>  Set _result=!**%_var%**!
>  Echo %_result%

Errorlevels
-----------

> If you run CALL SET this will reset [ERRORLEVEL](errorlevel.html) = 0 even though normally SET ... will fail to reset an ERRORLEVEL  
> If you CALL a subroutine, the ERRORLEVEL will be left _unchanged_  
> If you CALL a subroutine, with a label that does not exist ERRORLEVEL will be set to 1  
> (call ) will set the [ERRORLEVEL](errorlevel.html) to 0.  
> (call) will set the [ERRORLEVEL](errorlevel.html) to 1.

If you CALL an executable or resource kit utility make sure it's available on the machine where the batch will be running, test for it's existence with an [IF](if.html) command and throw an error if missing.

CALL is an [internal](syntax-internal.html) command, (internally it is closely related to GOTO).  
If [Command Extensions](cmd.html) are disabled, the CALL command will not accept batch labels.

“My mother never saw the irony in calling me a son-of-a-bitch” ~ Jack Nicholson

### Related commands

How To: [Functions](syntax-functions.html) - How to package blocks of code.  
[CMD](cmd.html) - can be used to call a subsequent batch and ALWAYS return even if errors occur.  
[GOTO](goto.html) - jump to a label or GOTO :eof  
[ScriptRunner](scriptrunner.html) - Run one or more scripts in sequence.  
[START](start.html) - Start a separate window to run a specified program or command.  
Equivalent bash command (Linux): [. (source)](../bash/source.html) - Run a command script in the current shell, [builtin](../bash/builtin.html) - Run a shell builtin.



/. nt/certreq.html
========================================================

    Certreq Request certificate - Windows CMD - SS64.com

CERTREQ
=======

Request certificate from a certification authority (CA), retrieve a response to a previous request from a CA, create a new request from an .inf file, accept and install a response to a request, construct a cross-certification or qualified subordination request from an existing CA certificate or request, or to sign a cross-certification or qualified subordination request.

Syntax

      Certreq [-submit] [-retrieve _RequestID_] [-new] [-accept] [-policy] [-sign]
                 [-attrib AttributeString] [-binary] [-config _CAMachineName__CAName_]
                    [-crl] [-rpc] [-cert CertID]
                       [_RequestFileIn_ | _CertChainFileIn_ | _FullResponseFileIn_ | _CertFileIn_ | _PolicyFileIn_]
                          [_RequestFileOut_ | _CertChainFileOut_ | _FullResponseFileOut_ | _CertFileOut_ | _PKCS10FileOut_]
 
Key
    -submit
          Submit a request to a CA.

    -retrieve _RequestID_
          Retrieve a response to a previous request from a CA.

    -new
          Create a new request from an .inf file.

    -accept
          Accept and install a response to a certificate request.

    -policy
          Set the policy for a request.

    -sign
          Sign a cross-certification or qualified subordination request.

    -attrib _AttributeString
_          The Name and Value string pairs, separated by a colon.
          Separate Name and Value string pairs with \n (for example, Name1:Value1\nName2:Value2).

    -binary
          Format output files as binary instead of base64-encoded.

    -config _CAMachineName__CAName_
          Process the operation using the CA specified in the configuration
          string, which is CAMachineName\CAName.

    -crl
          Include certificate revocation lists (CRLs) in the output to the base64-encoded
          PKCS #7 file specified by CertChainFileOut or to the base64-encoded file
          specified by RequestFileOut.

    -rpc
          Instructs Active Directory Certificate Services (AD CS) to use a 
          remote procedure call (RPC) server connection instead of Distributed COM.

    -cert CertID
          The signing certificate by common name, serial number, Secure Hash Algorithm
          (SHA-1) key, or certificate hash.

    CertChainFileIn
          The base64-encoded or binary certificate chain input file to use.

    FullResponseFileIn
          The base64-encoded or binary full response input file to use.

    CertFileIn
          The base64-encoded or binary certificate input file to use.

    RequestFileIn
          The base64-encoded or binary input file to use.
          The file can be a PKCS #10 certificate request, a PKCS #7 certificate renewal
          request, a KEYGEN tag format certificate request, a Certificate Management protocol
          using Cryptographic Message Syntax (CMS) request (this protocol is also known as CMC),
          or a certificate file of the CA that you want to cross-certify.

    PolicyFileIn
          The .inf input file that contains the extension definitions to use to qualify a request.

    RequestFileOut
          The base64-encoded file to which you want to send output.

    PKCS10FileOut
          The base64-encoded PKCS #10 file to which you want to send output.

    CertFileOut
          The binary or base64-encoded X.509 v3 file to which you want to send output.

    CertChainFileOut
          The binary or base64-encoded PKCS #7 file to which you want to send output.

    FullResponseFileOut
          The binary or base64-encoded full response file to which you want to send output.

    -?     Display a list of certreq commands.

You must specify the _CAComputerName_ or _CAName_ in -config _CAComputerName__CAName_. Otherwise, the Select Certificate Authority dialog box appears and displays a list of all CAs that are available.

To retrieve the certificate after the CA has actually issued it use certreq -retrieve _RequestID_, you can also use this command to retrieve any certificate that has ever been issued by the CA, including revoked or expired certificates, without regard to whether the certificate's request was ever in the pending state.

If you submit a request to the CA, the policy module of the CA might temporarily leave the request in a pending state and return the _RequestID_ for display. Eventually, the CA’s administrator will issue the certificate or deny the request.

### Examples

Sample request.inf

;----------------- request.inf

[Version]  
Signature="$Windows NT$

[NewRequest]  
Subject = "CN=dc01.ss64.com" ; must be the FQDN of domain controller  
;EncipherOnly = FALSE  
Exportable = FALSE ; TRUE = Private key is exportable  
KeyLength = 1024 ; Common key sizes: 512, 1024, 2048,  
; 4096, 8192, 16384  
KeySpec = 1 ; Key Exchange  
KeyUsage = 0xA0 ; Digital Signature, Key Encipherment  
MachineKeySet = True  
ProviderName = "Microsoft RSA SChannel Cryptographic Provider"  
ProviderType = 12  
RequestType = CMC  
  
; Omit entire section if CA is an enterprise CA  
[EnhancedKeyUsageExtension]  
OID=1.3.6.1.5.5.7.3.1 ; Server Authentication  
  
[RequestAttributes]  
CertificateTemplate = WebServer ;Omit line if CA is a stand-alone CA  
;SAN="dns=dc01.ss64.com&dns=.ss64.com&dns=ldap.ss64.com"  
;-----------------

Create a new request from an .inf file:

certreq -new request.inf result.txt

Supply the text of result.txt to your CA to obtain a signed certificate (and an intermediate CA certificate, if applicable.)

Submit a request to a CA:

certreq -submit result.txt certificate.cer

Retrieve a response to a previous request from a CA:

certreq -retrieve [-binary] [-config CAMachineName\CAName] [-crl] [-rpc] RequestID [CertFileOut [CertChainFileOut [FullResponseFileOut]]]

Accept and install a response to a certificate request:

certreq -accept c:\certificates\certificate.cer

Construct a cross-certification or qualified subordination request from an existing CA certificate or request:

certreq -policy [-attrib AttributeString] [-binary] [-cert CertID] [RequestFileIn [PolicyFileIn [RequestFileOut [PKCS10FileOut]]]]

Sign a cross-certification or qualified subordination request:

certreq -sign [-binary] [-certCertID] [-crl] [RequestFileIn [RequestFileOut]]

“The certified quality of person's actual education reflects in the degree of respect he employs in his words while talking with others” ~Anuj Somany

### Related commands

[SLMGR](slmgr.html) - Software Licensing Management.  
[CERTUTIL](certutil.html) - Utility for certification authority (CA) files and services.  
PowerShell cmdlet: [Get-Certificate](../ps/get-certificate.html)



/. nt/certutil.html
========================================================

    CertUtil Certification Authority Utility - Windows CMD - SS64.com

CERTUTIL
========

Dump and display certification authority (CA) configuration information, configure Certificate Services, back up and restore CA components, verify certificates, key pairs or certificate chains.

Syntax:

  **Dump (read config information) from a certificate file**
  CertUtil [_Options_] [[**-dump**](#dump)] [_File_]
    Options:  [-f] [-silent] [-split] [-p _Password_] [-t _Timeout_]

  **Parse ASN.1 file**
  CertUtil [Options] [**-asn**](#asn) _File_
    Options:  [-f] [_decoding_type_]

  **Decode a Hex-encoded file to binary**
  CertUtil [-f] [-v] **[-decodehex](#decodehex)** _InFile OutFile_
 
  **Decode Base64-encoded file to binary**
  CertUtil [-f] [-v] **[-decode](#decode)** _InFile OutFile_

  **Encode _a_ binary file to Base64**
  CertUtil [-f] [-v] **[-encode](#encode)** _InFile OutFile_ [-UnicodeText]

  **Encode a file as Hex**
  CertUtil [-f] [-v] **[-encodehex](#encodehex)** _InFile OutFile_ _Format_
     Hex encoded files are around 3x larger than base64
     Examples of the [Hex formats](https://docs.microsoft.com/en-gb/windows/desktop/api/wincrypt/nf-wincrypt-cryptbinarytostringa):
       certutil -encodehex -f strings64.exe strings12.hex 12 -  One line HEX value without spaces, columns, addresses,
       certutil -encodehex -f strings64.exe strings5.hex 5   -  without addresses.
       certutil -encodehex -f strings64.exe strings2.hex 2   -  pure binary (rarely used).
       certutil -encodehex -f strings64.exe strings1.hex 1  - base64 without certificate headers.
       certutil -encodehex -f strings64.exe strings0.hex 0  - base64 with certificate headers.
       certutil -encodehex -f strings64.exe strings4.hex 4  - in columns with spaces, without the characters and the addresses.
       certutil -encodehex -f strings64.exe strings7.hex 7  - base64 - X509 without headers (slightly bigger than the normal b64)
       certutil -encodehex -f strings64.exe strings8.hex 8  - base64 - x509 with headers.

  **Deny pending request**
  CertUtil [_Options_] **[-deny](#deny)** _RequestId_ 
    Options:  [-v] [-config _Machine__CAName_]

  **Resubmit pending request**
  CertUtil [_Options_] **[-resubmit](#resubmit)** _RequestId_
    Options:  [-v] [-config _Machine__CAName_]

  **Set attributes for pending request**
  CertUtil [_Options_] **[-setattributes](#setattributes)** _RequestId AttributeString_
    Options:  [-v] [-config _Machine__CAName_]

> RequestId : Numeric Request Id of pending request.  
> AttributeString : Request Attribute name and value pairs.  
> Names and values are colon separated. Multiple name, value pairs are newline separated.  
> Example: "CertificateTemplate:User\nEMail:User@Domain.com"  
> Each "\n" sequence is converted to a newline separator.  

 **Set extension for pending request**
  CertUtil [_Options_] **[-setextension](#setextension)** _RequestId ExtensionName Flags_ {Long | Date | String | @InFile}
    Options:  [-v] [-config _Machine__CAName_]

> RequestId : Numeric Request Id of a pending request.  
> ExtensionName : ObjectId string of the extension.  
> Flags : 0 is recommended. 1 makes the extension critical, 2 disables it, 3 does both.  
> If the last parameter is numeric, it is taken as a Long. If it can be parsed as a date, it is taken as a Date.  
> If it starts with '@', the rest of the token is the filename containing binary data or an ascii-text hex dump.  
> Anything else is taken as a String.  

 **Revoke Certificate**
 CertUtil [_Options_] **[-revoke](#revoke)** _SerialNumber_ [_Reason_]
    Options:  [-v] [-config _Machine__CAName_]

    SerialNumber: Comma separated list of certificate serial numbers to revoke 
    Reason: numeric or symbolic revocation reason
     0: CRL_REASON_UNSPECIFIED: Unspecified (default)
     1: CRL_REASON_KEY_COMPROMISE: Key Compromise
     2: CRL_REASON_CA_COMPROMISE: CA Compromise
     3: CRL_REASON_AFFILIATION_CHANGED: Affiliation Changed
     4: CRL_REASON_SUPERSEDED: Superseded
     5: CRL_REASON_CESSATION_OF_OPERATION: Cessation of Operation
     6: CRL_REASON_CERTIFICATE_HOLD: Certificate Hold
     8: CRL_REASON_REMOVE_FROM_CRL: Remove From CRL
     -1: Unrevoke: Unrevoke

  **Display current certificate disposition**
  CertUtil [_Options_] **[-isvalid](#isvalid)** _SerialNumber_ | _CertHash_
    Options:  [-v] [-config _Machine__CAName_]

  **Get default configuration string**
  CertUtil [_Options_] **[-getconfig](#getconfig)**
    Options:  [-v] [-config _Machine__CAName_]

  **Ping Active Directory Certificate Services Request interface**
  CertUtil [_Options_] **[-ping](#ping)** [MaxSecondsToWait | CAMachineList]
    Options:  [-v] [-config _Machine__CAName_]

     Request interface CAMachineList -- Comma-separated CA machine name list
     For a single machine, use a terminating comma
     Displays the site cost for each CA machine

  **Ping Active Directory Certificate Services Admin interface**
  CertUtil [_Options_] **[-pingadmin](#pingadmin)** [MaxSecondsToWait | CAMachineList]
    Options:  [-v] [-config _Machine__CAName_]

     Request interface CAMachineList -- Comma-separated CA machine name list
     For a single machine, use a terminating comma
     Displays the site cost for each CA machine

  **Display CA Information**
  CertUtil [_Options_] **[-CAInfo](#cainfo)** [InfoName [_Index_ | _ErrorCode_]]
    Options:  [-v] [-config _Machine__CAName_]

> InfoName : indicates the CA property to display. Use "*" for all properties.  
> Index : optional zero-based property index  
> ErrorCode : numeric error code [-f] [-split] [-config _Machine__CAName_]  

  **Retrieve the CA's certificate** 
  CertUtil [_Options_] **[-ca.cert](#ca.cert)** _OutCACertFile_ [_Index_]
    Options:  [-f] [-v] [-split] [-config _Machine__CAName_]

    OutCACertFile: output file
    Index:   CA certificate renewal index (defaults to most recent)

  **Retrieve the CA's certificate chain** 
  CertUtil [_Options_] **[-ca.chain](#ca.chain)** _OutCACertChainFile_ [_Index_]
    Options:  [-f] [-v] [-split] [-config _Machine__CAName_]

    OutCACertChainFile: output file
    Index:     CA certificate renewal index (defaults to most recent)

  **Get CRL** 
  CertUtil [_Options_] **[-GetCRL](#getcrl)** _OutFile_ [_Index_] [_delta_]
    Options:  [-f] [-v] [-split] [-config _Machine__CAName_]

> Index : CRL index or key index (defaults to CRL for newest key)  
> delta : delta CRL (default is base CRL)  

  **Publish new CRLs [or delta CRLs only]**
  CertUtil [_Options_] **[-CRL](#crl)** [_dd_:_hh_ | republish] [delta]
    Options:  [-v] [-split] [-config _Machine__CAName_]

    _dd:hh_    -- new CRL validity period in days and hours
    republish -- republish most recent CRLs
    delta    -- delta CRLs only (default is base and delta CRLs)

  **Shutdown Active Directory Certificate Services**
  CertUtil [_Options_] **[-shutdown](#shutdown)**
    Options:  [-v] [-config _Machine__CAName_]

  **Install Certification Authority certificate** 
  CertUtil [_Options_] **[-installCert](#installcert)** [CACertFile]
    Options:  [-f] [-v] [-silent] [-config _Machine__CAName_]

  **Renew Certification Authority certificate** 
  CertUtil [_Options_] **[-renewCert](#renewcert)** [ReuseKeys] [_Machine__ParentCAName_]
    Options:  [-f] [-v] [-silent] [-config _Machine__CAName_]
    Use -f to ignore an outstanding renewal request, and generate a new request.

  **Dump Certificate Schema**
  CertUtil [_Options_] **[-schema](#schema)** [Ext | Attrib | CRL]
    Options:  [-v] [-split] [-config _Machine__CAName_]

> Ext : Extension table  
> Attrib : Attribute table  
> CRL : CRL table  
> Defaults to Request and Certificate table.  

  **Dump Certificate View**
  CertUtil [_Options_] **[-view](#view)** [Queue | Log | LogFail | Revoked | Ext | Attrib | CRL] [csv]
    Options:  [-v] [-silent] [-split] [-config _Machine__CAName_] [-restrict _RestrictionList_] [-out _ColumnList_]

> Queue : Request queue.  
> Log :  Issued or revoked certificates, plus failed requests.  
> LogFail : Failed requests.  
> Revoked : Revoked certificates.  
> Ext :  Extension table.  
> Attrib : Attribute table.  
> CRL :  CRL table.  
> csv :  Output as Comma Separated Values.
> 
> To display the StatusCode column for all entries: -out StatusCode  
> To display all columns for the last entry: -restrict "RequestId==$"  
> To display RequestId and Disposition for three requests:  
> -restrict "RequestId>=37,RequestId<40" -out "RequestId,Disposition"  
> To display Row Ids and CRL Numbers for all Base CRLs: -restrict "CRLMinBase=0" -out "CRLRowId,CRLNumber" CRL  
> To display Base CRL Number 3: -v -restrict "CRLMinBase=0,CRLNumber=3" -out "CRLRawCRL" CRL  
> To display the entire CRL table: CRL Use "Date[+|-dd:hh]" for date restrictions Use "now+dd:hh" for a date relative to the current time.  

  **Dump Raw Database**
  CertUtil [_Options_] **[-db](#db)**
    Options:  [-v] [-config _Machine__CAName_] [-restrict _RestrictionList_] [-out _ColumnList_]

  **Delete server database row**
  CertUtil [_Options_] **[-deleterow](#deleterow)** _RowId_ | Date [Request | Cert | Ext | Attrib | CRL] 
    Options:  [-f] [-v] [-config _Machine__CAName_]

> Request : Failed and pending requests (submission date)  
> Cert : Expired and revoked certificates (expiration date)  
> Ext :  Extension table Attrib: Attribute table  
> CRL :  CRL table (expiration date)
> 
> To delete failed and pending requests submitted by January 22, 2001: 1/22/2001 Request  
> To delete all certificates that expired by January 22, 2001: 1/22/2001 Cert  
> To delete the certificate row, attributes and extensions for RequestId 37: 37  
> To delete CRLs that expired by January 22, 2001: 1/22/2001 CRL [-f] [-config Machine\CAName]  

  **Backup Active Directory Certificate Services**
  CertUtil [_Options_] **[-backup](#backup)** _BackupDirectory_ [Incremental] [KeepLog]
    Options:  [-f] [-v] [-config _Machine__CAName_] [-p _Password_]

> BackupDirectory : directory to store backed up data  
> Incremental : perform incremental backup only (default is full backup)  
> KeepLog : preserve database log files (default is to truncate log files)  

  **Backup Active Directory Certificate Services database**
  CertUtil [_Options_] **[-backupDB](#backupdb)** BackupDirectory [Incremental] [KeepLog]
    Options:  [-f] [-v] [-config _Machine__CAName_]

> BackupDirectory : directory to store backed up data  
> Incremental : perform incremental backup only (default is full backup)  
> KeepLog : preserve database log files (default is to truncate log files)  

  **Backup Active Directory Certificate Services certificate and private key**
  CertUtil [_Options_] **[-backupKey](#backupkey)** _BackupDirectory_
    Options:  [-f] [-v] [-config _Machine__CAName_] [-p _Password_] [-t _Timeout_]

> BackupDirectory : directory to store backed up PFX file  

  **Restore Active Directory Certificate Services**
  CertUtil [_Options_] **[-restore](#restore)** _BackupDirectory_
    Options:  [-f] [-v] [-config _Machine__CAName_] [-p _Password_]

> BackupDirectory : directory containing data to be restored  

  **Restore Active Directory Certificate Services database**
  CertUtil [_Options_] **[-restoreDB](#restoredb)** _BackupDirectory_
    Options:  [-f] [-v] [-config _Machine__CAName_] [-p _Password_]

> BackupDirectory : directory containing database files to be restored  

  **Restore Active Directory Certificate Services certificate and private key**
  CertUtil [_Options_] **[-restoreKey](#restorekey)** _BackupDirectory_ | _PFXFile_
    Options:  [-f] [-v] [-config _Machine__CAName_] [-p _Password_]

> BackupDirectory : directory containing PFX file to be restored  
> PFXFile : PFX file to be restored  

  **Import certificate and private key**
  CertUtil [_Options_] **[-importPFX](#importpfx)** [_CertificateStoreName_] _PFXFile_ [_Modifiers_] [-csp _Provider_]
    Options:  [-f] [-v] [-user] [-p _Password_]

> CertificateStoreName : Certificate store name. See [-store](#store).  
> PFXFile :  PFX file to be imported  
> Modifiers : Comma separated list of one or more of the following:  
> AT_SIGNATURE : Change the KeySpec to Signature  
> AT_KEYEXCHANGE : Change the KeySpec to Key Exchange  
> NoExport : Make the private key non-exportable  
> NoCert :  Do not import the certificate  
> NoChain : Do not import the certificate chain  
> NoRoot :  Do not import the root certificate  
> Protect : Protect keys with password  
> NoProtect : Do not password protect keys  
> Defaults to personal machine store.  

  **Display dynamic file List**
  CertUtil [_Options_] **[-dynamicfilelist](#dynamicfilelist)**
    Options:  [-v] [-config _Machine__CAName_]

  **Display database locations**
  CertUtil [_Options_] **[-databaselocations](#databaselocations)**
    Options:  [-v] [-config _Machine__CAName_]

  **Generate and display cryptographic hash over a file.**
  CertUtil [_Options_] **[-hashfile](#hashfile)** _InFile_ [HashAlgorithm]
    Options:  [-v]

  **Dump certificate store** 
  CertUtil [_Options_] **[-store](#store)** [_CertificateStoreName_ **[**_CertId_ [_OutputFile_]**]**]
    Options:  [-f] [-v] [-enterprise] [-user] [-GroupPolicy] [-silent] [-split] [-dc _DCName_]

> CertificateStoreName : Certificate store name.  
> CertId :  Certificate or CRL match token. This can be a serial number, an SHA-1 certificate, CRL, CTL or public key hash, a numeric cert index (0, 1, and so on), a numeric CRL index (.0, .1, and so on), a numeric CTL index (..0, ..1, and so on), a public key, signature or extension ObjectId, a certificate subject Common Name, an e-mail address, UPN or DNS name, a key container name or CSP name, a template name or ObjectId, an EKU or Application Policies ObjectId, or a CRL issuer Common Name. These can result in multiple matches.  
> OutputFile :  File to save matching cert.
> 
> Use -user to access a user store instead of a machine store.  
> Use -enterprise to access a machine enterprise store.  
> Use -service to access a machine service store.  
> Use -grouppolicy to access a machine group policy store.  

  **Add certificate to store**
  CertUtil [_Options_] **[-addstore](#addstore)** _CertificateStoreName_ _InFile_
    Options:  [-f] [-v] [-enterprise] [-user] [-GroupPolicy] [-dc _DCName_]

> CertificateStoreName : Certificate store name. See -store.  
> InFile : Certificate or CRL file to add to store.  

  **Delete certificate from store**
  CertUtil [_Options_] **[-delstore](#delstore)** _CertificateStoreName CertId_
    Options:  [-f] [-v] [-enterprise] [-user] [-GroupPolicy] [-dc _DCName_]

> CertificateStoreName : Certificate store name. See -store.  
> CertId : Certificate or CRL match token. See -store.  

  **Verify certificate in store**
  CertUtil [_Options_] **[-verifystore](#verifystore)** _CertificateStoreName_ [_CertId_]
    Options:  [-f] [-v] [-enterprise] [-user]  [-GroupPolicy] [-silent] [-split] [-dc _DCName_] [-t _Timeout_]

> CertificateStoreName : Certificate store name. See -store.  
> CertId : Certificate or CRL match token. See -store.  

  **Repair key association or update certificate properties or key security descriptor**
  CertUtil [_Options_] **[-repairstore](#repairstore)** _CertificateStoreName CertIdList_ [_PropertyInfFile_ | _SDDLSecurityDescriptor_]
    Options:   [-f] [-v] [-enterprise] [-user] [-GroupPolicy] [-silent] [-split] [-csp _Provider_]

> CertificateStoreName : Certificate store name. See -store.  
> CertIdList : comma separated list of Certificate or CRL match tokens. See -store CertId description.  
> PropertyInfFile : INF file containing external properties:  

  **Dump certificate store**
  CertUtil [_Options_] **[-viewstore](#viewstore)** [_CertificateStoreName_ **[**_CertId_ [_OutputFile_]**]**]
    Options:   [-f] [-v] [-enterprise] [-user] [-GroupPolicy] [-dc _DCName_]

> CertificateStoreName : Certificate store name.  
> CertId : Certificate or CRL match token. This can be a serial number, an SHA-1 certificate, CRL, CTL or public key hash, a numeric cert index (0, 1, and so on), a numeric CRL index (.0, .1, and so on), a numeric CTL index (..0, ..1, and so on), a public key, signature or extension ObjectId, a certificate subject Common Name, an e-mail address, UPN or DNS name, a key container name or CSP name, a template name or ObjectId, an EKU or Application Policies ObjectId, or a CRL issuer Common Name. These can result in multiple matches.  
> OutputFile : file to save matching cert.
> 
> Use -user to access a user store instead of a machine store.  
> Use -enterprise to access a machine enterprise store.  
> Use -service to access a machine service store.  
> Use -grouppolicy to access a machine group policy store.  

  **Delete certificate from store**
  CertUtil [_Options_] **[-viewdelstore](#viewdelstore)** [_CertificateStoreName_ [_CertId_ [_OutputFile_]]] 
    Options:   [-f] [-v] [-enterprise] [-user] [-GroupPolicy] [-dc _DCName_]

> CertificateStoreName : Certificate store name.  
> CertId : Certificate or CRL match token. This can be a serial number, an SHA-1 certificate, CRL, CTL or public key hash, a numeric cert index (0, 1, and so on), a numeric CRL index (.0, .1, and so on), a numeric CTL index (..0, ..1, and so on), a public key, signature or extension ObjectId, a certificate subject Common Name, an e-mail address, UPN or DNS name, a key container name or CSP name, a template name or ObjectId, an EKU or Application Policies ObjectId, or a CRL issuer Common Name. These can result in multiple matches.  
> OutputFile :  File to save matching cert.
> 
> Use -user to access a user store instead of a machine store.  
> Use -enterprise to access a machine enterprise store.  
> Use -service to access a machine service store.  
> Use -grouppolicy to access a machine group policy store.  

  **Publish certificate or CRL to Active Directory**
  CertUtil [_Options_] **[-dsPublish](#dspublish)** _CertFile_ [NTAuthCA | RootCA | SubCA | CrossCA | KRA | User | Machine]
    Options:   [-f] [-v] [-user] [-dc _DCName_]

  CertUtil [_Options_] **[-dsPublish](#dspublish)** _CRLFile_ [DSCDPContainer [DSCDPCN]] [-f] [-user] [-dc _DCName_]
    Options:   [-f] [-v] [-user] [-dc _DCName_]

> CertFile : certificate file to publish  
> NTAuthCA : Publish cert to DS Enterprise store  
> RootCA : Publish cert to DS Trusted Root store  
> SubCA : Publish CA cert to DS CA object  
> CrossCA : Publish cross cert to DS CA object  
> KRA :  Publish cert to DS Key Recovery Agent object  
> User : Publish cert to User DS object  
> Machine : Publish cert to Machine DS object  
> CRLFile : CRL file to publish  
> DSCDPContainer : DS CDP container CN, usually the CA machine name  
> DSCDPCN : DS CDP object CN, usually based on the sanitized CA short name and key index  
> Use -f to create DS object.  

  **Display AD templates**
  CertUtil [_Options_] **[-ADTemplate](#adtemplate)** [_Template_] 
    Options:   [-f] [-v] [-user] [-ut] [-mt] [-dc _DCName_]

  **Display Enrollment Policy templates** 
  CertUtil [_Options_] **[-Template](#template)** [Template] 
    Options:   [-f] [-v] [-user] [-dc _DCName_] [-user] [-silent] [-PolicyServer _URLOrId_]
     [-Anonymous] [-Kerberos] [-ClientCertificate _ClientCertId_] [-UserName _UserName_] [-p _Password_]

  **Display CAs for template**
  CertUtil [_Options_] **[-TemplateCAs](#templatecas)** _Template_
    Options:   [-f] [-v] [-user] [-dc _DCName_]

  **Display templates for CA**
  CertUtil [Options] **[-CATemplates](#catemplates)** [Template] 
    Options:   [-f] [-v] [-user] [-ut] [-mt] [-config _Machine__CAName_] [-dc _DCName_]

  **Set, Verify or Delete CA site names**
  CertUtil [_Options_] **[-SetCASites](#setcasites)** [set] [_Sitename_]
  CertUtil [_Options_] **[-SetCASites](#setcasites)** verify [_Sitename_]
  CertUtil [_Options_] **[-SetCASites](#setcasites)** delete
    Options:   [-f] [-v] [-config _Machine__CAName_] [-dc _DCName_]

> Use the -config option to target a single CA (Default is all CAs)  
> _Sitename_ is allowed only when targeting a single CA  
> Use -f to override validation errors for the specified Sitename  
> Use -f to delete all CA site names  

  **Display, add or delete enrollment server URLs associated with a CA** 
  CertUtil [_Options_] **[-enrollmentServerURL](#enrollmentserverurl)** [URL _AuthenticationType_ [_Priority_] [_Modifiers_]]
  CertUtil [_Options_] **[-enrollmentServerURL](#enrollmentserverurl)** URL delete 
    Options:   [-f] [-config _Machine__CAName_] [-dc _DCName_]

> _AuthenticationType_: Specify one of the following client authentication methods while adding a URL:
> 
> > Kerberos : Use Kerberos SSL credentials.  
> > UserName : Use named account for SSL credentials.  
> > ClientCertificate : Use X.509 Certificate SSL credentials.  
> > Anonymous : Use anonymous SSL credentials.
> 
> delete : Delete the specified URL associated with the CA  
> Priority : Defaults to '1' if not specified when adding a URL  
> _Modifiers_ : Comma separated list of one or more of the following:
> 
> > AllowRenewalsOnly : Only renewal requests can be submitted to this CA via this URL  
> > AllowKeyBasedRenewal : Allow use of a certificate that has no associated account in the AD.  
> > This applies only with ClientCertificate and AllowRenewalsOnly Mode  

  **Display AD CAs**
  CertUtil [_Options_] **[-ADCA](#adca)** [_CAName_]
    Options:   [-f] [-split] [-dc _DCName_]

  **Display Enrollment Policy CAs**
  CertUtil [_Options_] **[-CA](#ca)** [_CAName_ | _TemplateName_]
    Options:   [-f] [-user] [-silent] [-split] [-PolicyServer _URLOrId_] 
     [-Anonymous] [-Kerberos] [-ClientCertificate _ClientCertId_] [-UserName _UserName_] [-p _Password_]

  **Display Enrollment Policy**
  CertUtil [_Options_] **[-Policy](#policy)** 
    Options:   [-f] [-user] [-silent] [-split] [-PolicyServer _URLOrId_] [-Anonymous]
     [-Kerberos] [-ClientCertificate _ClientCertId_] [-UserName _UserName_] [-p _Password_]

  **Display or delete Enrollment Policy Cache entries**
  CertUtil [Options] **[-PolicyCache](#policycache)** [delete] 
    Options:   [-f] [-user] [-PolicyServer _URLOrId_]

    delete: delete Policy Server cache entries 
        -f: use -f to delete all cache entries

  **Display, add or delete Credential Store entries**
  CertUtil [_Options_] **[-CredStore](#credstore)** [_URL_]

  CertUtil [_Options_] **[-CredStore](#credstore)** _URL_ **add** 

  CertUtil [_Options_] **[-CredStore](#credstore)** _URL_ **delete**

    Options:   [-f] [-user] [-silent] [-Anonymous] [-Kerberos]
        [-ClientCertificate _ClientCertId_] [-UserName _UserName_] [-p _Password_]

> _URL_ : target URL. Use * to match all entries. Use https://machine* to match a URL prefix.  
> add : add a Credential Store entry. SSL credentials must also be specified.  
> delete : delete Credential Store entries  
> -f : use -f to overwrite an entry or to delete multiple entries.  

  **Install default certificate templates**
  CertUtil [_Options_] **[-InstallDefaultTemplates](#installdefaulttemplates)** 
    Options:   [-f] [-v] [-dc _DCName_]

  **Display or delete URL cache entries**
  CertUtil [Options] **[-URLCache](#urlcache)** [_URL_ | CRL | * [delete]]
    Options:   [-f] [-v] [-split]

> _URL_ : Cached URL  
> CRL : Operate on all cached CRL URLs only  
> * : Operate on all cached URLs  
> delete : Delete relevant URLs from the current user's local cache  
> -f : Force fetch of a specific URL and update the cache.  
> -split : Dump the file to disk  
> -v : Will display the whole IE internet history and cache file locations (…\Content.IE5…)  
> e.g.  
> certutil.exe -urlcache -split -f "https://download.sysinternals.com/files/SysinternalsSuite.zip" pstools.zip  

  **Pulse autoenrollment events**
  CertUtil [_Options_] **[-pulse](#pulse)** 
    Options:   [-v] [-user]

  **Display Active Directory computer object information**
  CertUtil [_Options_] **[-MachineInfo](#machineinfo)** _DomainName__MachineName_$ 
    Options:   [-v] 

  **Display domain controller information**
  CertUtil [_Options_] [-DCInfo](#dcinfo) [Domain] [Verify | DeleteBad | DeleteAll]
    Options:   [-f] [-v] [-user] [-urlfetch] [-dc _DCName_] [-t _Timeout_]

> Default is to display DC certs without verification.  

  **Display Enterprise CA information**
  CertUtil [_Options_] **[-EntInfo](#entinfo)** _DomainName__MachineName_$
    Options:   [-f] [-v] [-user]

  **Display CA information**
  CertUtil [_Options_] **[-TCAInfo](#tcainfo)** [_DomainDN_ | -]
    Options:   [-f] [-v] [-enterprise] [-user] [-urlfetch] [-dc _DCName_] [-t _Timeout_]

 ** Display smart card information**
  CertUtil [_Options_] **[-SCInfo](#scinfo)** [_ReaderName_ [CRYPT_DELETEKEYSET]]
    Options:   [-v] [-silent] [-split] [-urlfetch] [-t _Timeout_]

> CRYPT_DELETEKEYSET : Delete all keys on the smart card  

  **Manage smart card root certificates**
  CertUtil [_Options_] **[-SCRoots](#scroots)** update [+][_InputRootFile_] [_ReaderName_]

  CertUtil [_Options_] **[-SCRoots](#scroots)** save @_OutputRootFile_ [_ReaderName_]

  CertUtil [_Options_] **[-SCRoots](#scroots)** view [_InputRootFile_ | _ReaderName_]

  CertUtil [_Options_] **[-SCRoots](#scroots)** delete [_ReaderName_] 

    Options:   [-f] [-split] [-p _Password_]

  **Verify public/private key set**
  CertUtil [Options] **[-verifykeys](#verifykeys)** [_KeyContainerName CACertFile_]
    Options:   [-f] [-v] [-user] [-silent] [-config _Machine__CAName_]

> KeyContainerName : Key container name of the key to verify. Defaults to machine keys. Use -user for user keys.  
> CACertFile : Signing or encryption certificate file  
> If no arguments are specified, each signing CA cert is verified against its private key.  
> This operation can only be performed against a local CA or local keys.  

  **Verify certificate, CRL or chain
**  CertUtil [Options] **[-verify](#verify)** _CertFile_ [_ApplicationPolicyList_ | - [_IssuancePolicyList_]]

  CertUtil [Options] **[-verify](#verify)** _CertFile_ [_CACertFile_ [_CrossedCACertFile_]]

  CertUtil [Options] **[-verify](#verify)** _CRLFile CACertFile_ [_IssuedCertFile_]

  CertUtil [Options] **[-verify](#verify)** _CRLFile CACertFile_ [_DeltaCRLFile_]

    Options:   [-f] [-v] [-enterprise] [-user] [-silent] [-split] [-urlfetch] [-t _Timeout_]

> CertFile : Certificate to verify Application  
> PolicyList : Optional comma separated list of required Application Policy ObjectIds  
> IssuancePolicyList : Optional comma separated list of required Issuance Policy ObjectIds  
> CACertFile : Optional issuing CA certificate to verify against  
> CrossedCACertFile : optional certificate cross-certified by CertFile  
> CRLFile :  CRL to verify IssuedCertFile: optional issued certificate covered by CRLFile  
> DeltaCRLFile : Optional delta CRL  
>   
> If ApplicationPolicyList is specified, chain building is restricted to chains valid for  
> the specified Application Policies.  
> If IssuancePolicyList is specified, chain building is restricted to chains valid for the  
> specified Issuance Policies.  
> If CACertFile is specified, fields in CACertFile are verified against CertFile or CRLFile.  
> If CACertFile is not specified, CertFile is used to build and verify a full chain.  
> If CACertFile and CrossedCACertFile are both specified, fields in CACertFile and CrossedCACertFile  
> are verified against CertFile.  
> If IssuedCertFile is specified, fields in IssuedCertFile are verified against CRLFile.  
> If DeltaCRLFile is specified, fields in DeltaCRLFile are verified against CRLFile.  

  **Verify AuthRoot or Disallowed Certificates CTL**
  CertUtil [Options] **[-verifyCTL](#verifyctl)** _CTLObject_ [_CertDir_] [_CertFile_] 
    Options:   [-f] [-user] [-split]

> _CTLObject_ : Identifies the CTL to verify:
> 
> > AuthRootWU : read AuthRoot CAB and matching certificates from the URL cache. Use -f to download from Windows Update instead.  
> > DisallowedWU : read Disallowed Certificates CAB and disallowed certificate store file from the URL cache. Use -f to download from Windows Update instead.  
> > AuthRoot : read registry cached AuthRoot CTL. Use with -f and a CertFile that is not already trusted to force updating the registry cached AuthRoot and Disallowed Certificate CTLs.  
> > Disallowed : read registry cached Disallowed Certificates CTL. -f has the same behavior as with AuthRoot.  
> > CTLFileName : file or http: path to CTL or CAB
> 
> CertDir : folder containing certificates matching CTL entries. An http: folder path must end with a path separator. If a folder is not specified with AuthRoot or Disallowed, multiple locations will be searched for matching certificates: local certificate stores, crypt32.dll resources and the local URL cache. Use -f to download from Windows Update when necessary.  
> Otherwise defaults to the same folder or web site as the CTLObject.  
> CertFile : file containing certificate(s) to verify. Certificates will be matched against CTL entries,  
> and match results displayed. Suppresses most of the default output.  

  **Re-sign CRL or certificate**
  CertUtil [_Options_] **[-sign](#sign)** _InFileList_|_SerialNumber_|CRL _OutFileList_ [_StartDate_+_dd_:_hh_]
     **[**+SerialNumberList | -SerialNumberList | -ObjectIdList | @ExtensionFile**]** [-nullsign]

  CertUtil [_Options_] **[-sign](#sign)** _InFileList_|_SerialNumber_|CRL _OutFileList_ [#HashAlgorithm]
     **[**+AlternateSignatureAlgorithm | -AlternateSignatureAlgorithm**]**  [-nullsign] 

    Options:   [-f] [-silent] [-Cert _CertId_]

> InFileList : comma separated list of Certificate or CRL files to modify and re-sign  
> SerialNumber : Serial number of certificate to create. Validity period and other options must not be present.  
> CRL :   Create an empty CRL. Validity period and other options must not be present.  
> OutFileList : comma separated list of modified Certificate or CRL output files. The number of files must match InFileList.  
>   
> StartDate+_dd_:_hh_ : new validity period: optional date plus; optional days and hours validity period;  
> If both are specified, use a plus sign (+) separator.  
> Use "now[+dd:hh]" to start at the current time. Use "never" to have no expiration date (for CRLs only).  
>   
> SerialNumberList : Comma separated serial number list to add or remove  
> ObjectIdList :  Comma separated extension ObjectId list to remove  
> @ExtensionFile : INF file containing extensions to update or remove:  
> HashAlgorithm : Name of the hash algorithm preceded by a # sign: #MD2 #MD4 #MD5 #SHA1 #SHA256 #SHA384 or #SHA512  
> AlternateSignatureAlgorithm : alternate Signature algorithm specifier  
>   
> A minus sign causes serial numbers and extensions to be removed. A plus sign causes serial numbers to be added to a CRL.  
> When removing items from a CRL, the list can contain both serial numbers and ObjectIds.  
> A minus sign before AlternateSignatureAlgorithm causes the legacy signature format to be used.  
> A plus sign before AlternateSignatureAlgorithm causes the alternature signature format to be used.  
> If AlternateSignatureAlgorithm is not specified then the signature format in the certificate or CRL is used.  

  **Create/delete web virtual roots and file shares**
  CertUtil [_Options_] **[-vroot](#vroot)** [delete]

  **Create/delete web virtual roots for OCSP web proxy**
  CertUtil [_Options_] **[-vocsproot](#vocsproot)** [delete]

  **Add an Enrollment Server application**
  CertUtil [_Options_] **[-addEnrollmentServer](#addenrollmentserver)** Kerberos | UserName | ClientCertificate [AllowRenewalsOnly] [AllowKeyBasedRenewal]
    Options:   [-f] [-config _Machine__CAName_]

> Add an Enrollment Server application and application pool if necessary, for the specified CA.  
> This command does not install binaries or packages.  
> One of the following authentication methods with which the client connects to a Certificate Enrollment Server.  
>   
> Kerberos : Use Kerberos SSL credentials  
> UserName : Use named account for SSL credentials  
> ClientCertificate : Use X.509 Certificate SSL credentials  
> AllowRenewalsOnly : Only renewal requests can be submitted to this CA via this URL  
> AllowKeyBasedRenewal : Allows use of a certificate that has no associated account in the AD.  
> This applies only with ClientCertificate and AllowRenewalsOnly mode.  

  **Delete an Enrollment Server application**
  CertUtil [_Options_] **[-deleteEnrollmentServer](#deleteenrollmentserver)** Kerberos | UserName | ClientCertificate
    Options:   [-f] [-config _Machine__CAName_]

> Delete an Enrollment Server application and application pool if necessary, for the specified CA.  
> This command does not remove binaries or packages.  
> One of the following authentication methods with which the client connects to a Certificate Enrollment Server.  
>   
> Kerberos : Use Kerberos SSL credentials  
> UserName : Use named account for SSL credentials  
> ClientCertificate : Use X.509 Certificate SSL credentials  

  **Add a Policy Server application**
  CertUtil [_Options_] **[-addPolicyServer](#addpolicyserver)** Kerberos | UserName | ClientCertificate [KeyBasedRenewal]

> Add a policy server application and application pool if necessary.  
> This command does not install binaries or packages.  
> One of the following authentication methods with which the client connects to a Certificate Policy Server.  
>   
> Kerberos : Use Kerberos SSL credentials.  
> UserName : Use named account for SSL credentials.  
> ClientCertificate : Use X.509 Certificate SSL credentials.  
> KeyBasedRenewal : Only policies that contain KeyBasedRenewal templates are returned to the client.  
> This flag applies only for UserName and ClientCertificate authentication.  

  **Delete a Policy Server application**
  CertUtil [_Options_] **[-deletePolicyServer](#deletepolicyserver)** Kerberos | UserName | ClientCertificate [KeyBasedRenewal]

> Delete a policy server application and application pool if necessary.  
> This command does not remove binaries or packages.  
> One of the following authentication methods with which the client connects to a Certificate Policy Server.  
>   
> Kerberos : Use Kerberos SSL credentials.  
> UserName : Use named account for SSL credentials.  
> ClientCertificate : Use X.509 Certificate SSL credentials.  
> KeyBasedRenewal : KeyBasedRenewal policy server.  

  **Display ObjectId or set display name**
  CertUtil [Options] **[-oid](#oid)** _ObjectId_ [_DisplayName_ | delete [_LanguageId_ [_Type_]]] [-f]

  CertUtil [Options] **[-oid](#oid)** _GroupId_

  CertUtil [Options] **[-oid](#oid)** _AlgId_ | _AlgorithmName_ [_GroupId_] [-f]

> ObjectId : ObjectId to display or to add display name  
> GroupId : Decimal GroupId number for ObjectIds to enumerate  
> AlgId :  Hexadecimal AlgId for ObjectId to look up  
> AlgorithmName : Algorithm Name for ObjectId to look up  
> DisplayName : Display Name to store in DS  
> delete :  Delete display name  
> LanguageId : Language Id (defaults to current: 1033)  
> Type :  DS object type to create: 1 for Template (default), 2 for Issuance Policy, 3 for Application Policy  
> Use -f to create DS object.  

  **Display error code message text**
  CertUtil [-v] **[-error](#error)** ErrorCode


  **Display registry value**
  CertUtil [_Options_] **[-getreg](#getreg)** [{ca|restore|policy|exit|template|enroll|chain|PolicyServers}\[_ProgId_\]] [_RegistryValueName_] 
    Options:   [-f] [-user] [-GroupPolicy] [-config _Machine__CAName_]

> ca :  Use CA's registry key  
> restore : Use CA's restore registry key  
> policy : Use policy module's registry key  
> exit :  Use first exit module's registry key  
> template : Use template registry key (use -user for user templates)  
> enroll : Use enrollment registry key (use -user for user context)  
> chain :  Use chain configuration registry key  
> PolicyServers : Use Policy Servers registry key  
> ProgId :  Use policy or exit module's ProgId (registry subkey name)  
> RegistryValueName : registry value name (use "Name*" to prefix match)  

  **Set registry value**
  CertUtil [_Options_] **[-setreg](#setreg)** [{ca|restore|policy|exit|template|enroll|chain|PolicyServers}\[_ProgId_\]]
     [_RegistryValueName_] _Value_
    Options:   [-f] [-user] [-GroupPolicy] [-config _Machine__CAName_]

> ca :  Use CA's registry key  
> restore : Use CA's restore registry key  
> policy : Use policy module's registry key  
> exit :  Use first exit module's registry key  
> template : Use template registry key (use -user for user templates)  
> enroll : Use enrollment registry key (use -user for user context)  
> chain :  Use chain configuration registry key  
> PolicyServers : Use Policy Servers registry key  
> ProgId : Use policy or exit module's ProgId (registry subkey name)  
> RegistryValueName : registry value name (use "Name*" to prefix match)  
>   
> Value : new numeric, string or date registry value or filename.  
> If a numeric value starts with "+" or "-", the bits specified in the new value are set or cleared in the existing registry value. If a string value  
> starts with "+" or "-", and the existing value is a REG_MULTI_SZ value, the string is added to or removed from the existing registry value.  
> To force creation of a REG_MULTI_SZ value, add a "\n" to the end of the string value. If the value starts with "@", the rest of the value is the name of the file containing the hexadecimal text representation of a binary value.  
> If it does not refer to a valid file, it is instead parsed as [Date][+|-][_dd_:_hh_] -- an optional date plus or minus optional days and hours.  
> If both are specified, use a plus sign (+) or minus sign (-) separator.  
> Use "now+_dd_:_hh_" for a date relative to the current time.  
> Use "chain\ChainCacheResyncFiletime @now" to effectively flush cached CRLs.  

  **Delete registry value**
  CertUtil [_Options_] **[-delreg](#delreg)** [{ca|restore|policy|exit|template|enroll|chain|PolicyServers}\[_ProgId_\]]
     [_RegistryValueName_]
    Options:   [-f] [-user] [-GroupPolicy] [-config _Machine__CAName_]

> ca :  Use CA's registry key  
> restore : Use CA's restore registry key  
> policy : Use policy module's registry key  
> exit :  Use first exit module's registry key  
> template : Use template registry key (use -user for user templates)  
> enroll : Use enrollment registry key (use -user for user context)  
> chain :  Use chain configuration registry key  
> PolicyServers : Use Policy Servers registry key  
> ProgId : Use policy or exit module's ProgId (registry subkey name)  
> RegistryValueName : registry value name (use "Name*" to prefix match)  

  **Import user keys and certificates into server database for key archival**
  CertUtil [_Options_] **[-ImportKMS](#importkms)** _UserKeyAndCertFile_ [_CertId_] 
    Options:   [-f] [-v] [-silent] [-split] [-config _Machine__CAName_] [-p _Password_] [-symkeyalg _SymmetricKeyAlgorithm_[,_KeyLength_]]

> UserKeyAndCertFile : Data file containing user private keys and certificates to be archived.  
> This can be any of the following:  
>    Exchange Key Management Server (KMS) export file  
>    PFX file  
> CertId : KMS export file decryption certificate match token. See -store.  
> Use -f to import certificates not issued by the CA.  

  **Import a certificate file into the database** 
  CertUtil [Options] **[-ImportCert](#importcert)** _Certfile_ [_ExistingRow_] 
    Options:   [-f] [-v] [-config _Machine__CAName_]

> Use ExistingRow to import the certificate in place of a pending request for the same key.  
> Use -f to import certificates not issued by the CA. The CA might also need to be configured to support foreign certificate import: certutil -setreg ca\KRAFlags +KRAF_ENABLEFOREIGN  

  **Retrieve archived private key recovery blob, generate a recovery script, or recover archived keys** 
  CertUtil [_Options_] **[-GetKey](#getkey)** _SearchToken_ [_RecoveryBlobOutFile_]

  CertUtil [_Options_] **[-GetKey](#getkey)** _SearchToken script OutputScriptFile_

  CertUtil [_Options_] **[-GetKey](#getkey)** _SearchToken_ retrieve | recover _OutputFileBaseName_

    Options:   [-f] [-v] [-UnicodeText] [-silent] [-config _Machine__CAName_] [-p _Password_]
                  [-ProtectTo _SAMNameAndSIDList_] [-csp _Provider_]

> script : generate a script to retrieve and recover keys (default behavior if multiple matching recovery candidates are found, or if  
> the output file is not specified).  
> retrieve : retrieve one or more Key Recovery Blobs (default behavior if exactly one  
> matching recovery candidate is found, and if the output file is specified)  
> recover : retrieve and recover private keys in one step (requires Key Recovery Agent  
> certificates and private keys)  
> SearchToken : Used to select the keys and certificates to be recovered.  
> any of the following:  
>   Certificate Common Name  
>   Certificate Serial Number  
>   Certificate SHA-1 hash (thumbprint)  
>   Certificate KeyId SHA-1 hash (Subject Key Identifier)  
>   Requester Name (domain\user)  
>   UPN (user@domain)  
>   
> RecoveryBlobOutFile : output file containing a certificate chain and an associated private key, still encrypted to one or more Key Recovery Agent certificates.  
> OutputScriptFile : output file containing a batch script to retrieve and recover private keys.  
> OutputFileBaseName : output file base name. For retrieve, any extension is truncated and a certificate-specific string and the .rec extension are appended for each key recovery blob. Each file contains a certificate chain and an associated private key, still encrypted to  
> one or more Key Recovery Agent certificates. For recover, any extension is truncated and the .p12 extension is appended.  
> Contains the recovered certificate chains and associated private keys, stored as a PFX file.  

  **Recover archived private key**
  CertUtil [_Options_] **[-RecoverKey](#recoverkey)** _RecoveryBlobInFile_ [PFXOutFile [RecipientIndex]]
    Options:   [-f] [-user] [-silent] [-split] [-p _Password_] [-ProtectTo _SAMNameAndSIDList_] [-csp _Provider_] [-t _Timeout_]

  **Merge PFX files**
  CertUtil [_Options_] **[-MergePFX](#mergepfx)** _PFXInFileList_ _PFXOutFile_ [ExtendedProperties]
    Options:   [-f] [-user] [-split] [-p _Password_] [-ProtectTo _SAMNameAndSIDList_] [-csp _Provider_]

> PFXInFileList : Comma separated PFX input file list  
> PFXOutFile : PFX output file  
> ExtendedProperties: Include extended properties  
>   
> The password specified on the command line is a comma separated password list.  
> If more than one password is specified, the last password is used for the output file.  
> If only one password is provided or if the last password is "*", the user will be prompted for  
> the output file password.  

  **Convert PFX files to EPF file**
  CertUtil [_Options_] **[-ConvertEPF](#convertepf)** _PFXInFileList EPFOutFile_ [cast | cast-] [V3CACertId][,Salt] 
    Options:   [-f] [-split] [-p _Password_] [-csp _Provider_]

> PFXInFileList : Comma separated PFX input file list  
> EPF : EPF output file  
> cast : Use CAST 64 encryption  
> cast- : Use CAST 64 encryption (export)  
> V3CACertId : V3 CA Certificate match token. See -store CertId description.  
> Salt: EPF output file salt string  
>   
> The password specified on the command line is a comma separated password list.  
> If more than one password is specified, the last password is used for the output file.  
> If only one password is provided or if the last password is "*", the user will be prompted for  
> the output file password.  

OPTIONS
These options must be entered on the command line **before** the main Verb

    -nullsign     Use hash of data as signature
    -f            Force overwrite
    -enterprise   Use local machine Enterprise registry certificate store
    -user         Use HKEY_CURRENT_USER keys or certificate store
    -GroupPolicy  Use Group Policy certificate store
    -ut           Display user templates
    -mt           Display machine templates
    -Unicode      Write redirected output in Unicode
    -UnicodeText  Write output file in Unicode
    -gmt          Display times as GMT
    -seconds      Display times with seconds and milliseconds
    -silent       Use silent flag to acquire crypt context
    -split        Split embedded ASN.1 elements, and save to files
    -v            Verbose operation
    -privatekey   Display password and private key data
    -pin PIN      Smart Card PIN
    -urlfetch     Retrieve and verify AIA Certs and CDP CRLs
    -config M_achine\CAName_  CA and computer name string
    -PolicyServer _URLOrId_   Policy Server URL or Id. For selection U/I, use -PolicyServer.
                           For all Policy Servers, use -PolicyServer *
    -Anonymous    Use anonymous SSL credentials
    -Kerberos     Use Kerberos SSL credentials
    -ClientCertificate _ClientCertId_   Use X.509 Certificate SSL credentials. For selection U/I, use -clientCertificate.
    -UserName _UserName_   Use named account for SSL credentials. For selection U/I, use -UserName.
    -Cert _CertId_  Signing certificate
    -dc _DCName_    Target a specific Domain Controller
    -restrict _RestrictionList_   Comma separated Restriction List. Each restriction consists
                 of a column name, a relational operator and a constant integer, string or date.
                 One column name can be preceded by a plus or minus sign to indicate the sort order.
                 Examples:  "RequestId = 47"    "+RequesterName >= a, RequesterName < b"
                            "-RequesterName > DOMAIN, Disposition = 21"
    -out _ColumnList_   Comma separated Column List
    -p _Password_   Password
    -ProtectTo _SAMNameAndSIDList_   Comma separated SAM Name/SID List
    -csp _Provider_ Provider
    -t _Timeout_    URL fetch timeout in milliseconds
    -symkeyalg _SymmetricKeyAlgorithm_[,_KeyLength_]   Name of Symmetric Key Algorithm with
                 optional key length, example: AES,128 or 3DES

Certutil is sensitive to the order of command-line parameters.

Certutil replaces the File Checksum Integrity Verifier (FCIV) found in earlier versions of Windows.

There are a some documentation inconsistencies between the command-line help (Certutil -?) and the various MSDN help pages.  
e.g. -encodehex is completely missing from the command-line help.  
The -decode option might not always restore spaces - see [forum thread](https://ss64.org/viewtopic.php?f=2&t=99).

### Examples

Display the SHA256 hash of a file:

certutil -hashfile c:\demo\anything.txt SHA256

Dump (read config information) from a certificate file:

certutil -dump c:\demo\sample.CER

Copy a certificate revocation list (CRL) to a file:

certutil -getcrl F:\ss64.crl

Purge local policy cache (Certificate Enrollment Policy Web Services):

certutil -f -policyserver * -policycache delete

View the content of the client computer’s Trusted Root Certification Authorities Enterprise certificate store:

certutil -enterprise -viewstore Root

Check the browsers Trusted Certificate list against the WindowsUpdate servers:

certutil -f -verifyCTL AuthRootWU

Stop Certificate Services:

certutil -shutdown

Convert a hex-encoded file to a binary executable. This is primarily intended for converting X.509 certificates from a human-readable format (.asn) into a computer-readable format (.bin):

certutil -decodehex hex.dat ss64.exe

_“And yet I do observe that audiences which used to be deeply affected by the inspiring sternness of the music of Livius and Naevius, now leap up and twist their necks and turn their eyes in time with our modern tunes” ~ Cicero (De Legibus II.39 c. 50 BCE) on the evils of modern music._

### Related commands

[CertMgr.MSC](run.html) - GUI for managing Certificates.  
[CERTREQ](certreq.html) - Request certificate from a certification authority.  
[How Certificate Revocation Works](https://social.technet.microsoft.com/wiki/contents/articles/34071.pki-certificate-revocation-process-explained.aspx) - TechNet.  
Equivalent PowerShell cmdlets: [Get-FileHash](../ps/get-filehash.html) - Compute the hash value for a file. [Get-Certificate](../ps/get-certificate.html) - Submit/retrieve certificate requests.  
Equivalent bash command: [cksum](../bash/cksum.html) - Print CRC checksum and byte counts. / [base64](../bash/base64.html) - encode/decode and print to StdOut.



/. nt/cd.html
========================================================

    CD Change Directory - Windows CMD - SS64.com

CD
==

Change Directory - Select a Folder (and drive)

Syntax

      CD [/D] [_drive_:][_path_]
      CD [..]

Key
    /D : change the current DRIVE in addition to changing folder.

CHDIR is a synonym for CD.

Tab Completion
--------------

> Tab completion allows changing the current folder by entering just part of the path and pressing TAB.
> 
>    C:> CD Prog [PRESS TAB] 
>    Will go to C:\Program Files\
> 
> Tab Completion is disabled by default, it has been known to create difficulty when using a batch script to process text files that contain TAB characters.  
>   
> Tab Completion is turned on by setting the registry value shown below:  
>   
> REGEDIT4  
> [HKEY_CURRENT_USER\Software\Microsoft\Command Processor]  
> "CompletionChar"=dword:00000009

A Current Directory for each drive?
-----------------------------------

> Originally in MS-DOS, each drive had its own current directory, for complex [historical reasons](https://devblogs.microsoft.com/oldnewthing/20101011-00/?p=12563).
> 
> Now in Win32, there is one global current directory, but at the command line the appearance is still maintained that each drive has its own current directory, this is a fake-out by cmd.exe.  
> The location for each drive is stored using the undocumented [environment variables](syntax-variables.html) =A:, =B:, =C: etc.
> 
> The only reason you need to be aware of this is that GUI Windows applications may have a different current directory than the command prompt. Similarly two CMD sessions can each have a different current directory.

Errorlevels
-----------

> If the Current directory was changed: [%ERRORLEVEL%](errorlevel.html) = 0  
> If the Directory does not exist or is not accessible or if a bad switch given: [%ERRORLEVEL%](errorlevel.html) = 1

CHDIR is a synonym for CD

CD is an [internal](syntax-internal.html) command.

### Examples

Change to the parent directory:  
C:\Work> CD ..  
  
Change to the grant-parent directory:  
C:\Work\backup\January> CD ..\..  
  
Change to the ROOT directory:  
C:\Work\backup\January> CD \  
  
Display the current directory in the specified drive:  
C:> CD D:  
  
Display the current drive and directory:  
C:\Work> CD  
  
Display the current drive and directory:  
C:\Work> ECHO "%CD%"  
  
In a batch file to display the location of the batch script file (%0)  
C:> ECHO "%~dp0"  
  
In a batch file to CD to the location of the batch script file (%0)  
C:> CD /d "%~dp0"  
  
Move down the folder tree with a full path reference to the ROOT folder...  
C:\windows> CD ****windows\java  
C:\windows\java>  
  
Move down the folder tree with a reference RELATIVE to the current folder...  
C:\windows> CD java  
C:\windows\java>  
  
Move up and down the folder tree in one command...  
C:\windows\java> CD ..\system32  
C:\windows\system32>

If [Command Extensions](cmd.html) are enabled, which they are by default, the CD command is enhanced as follows:

> The current directory string is not CASE sensitive.  
> So CD C:\wiNdoWs will set the current directory to C:\Windows  
>   
> CD does not treat spaces as delimiters, so it is possible to CD into a subfolder name that contains a space without surrounding the name with quotes.  
>   
> For example:  
> cd \My folder  
>   
> is the same as:  
> cd "\My folder"
> 
> An asterisk can be used to complete a folder name  
> e.g. C:> CD pro* will move to C:\Program Files

**Change the Current Drive**  
  
Enter the drive letter followed by a colon  
C:> E:  
E:>  
  
To change drive and directory at the same time, use CD with the /D switch  
C:> cd /D E:\utils  
E:\utils>

_“Change is the law of life. And those who look only to the past or the present are certain to miss the future” ~ John F. Kennedy_

### Related commands

[MD](md.html) - Create Directory.  
[pushd](pushd.html) - Change Directory.  
[RD](del.html) - Delete directory or entire directory tree.  
How-to: [Long filenames, NTFS and legal filename characters](syntax-filenames.html).  
[Q156276](https://web.archive.org/web/20150312195558/https://support.microsoft.com/en-us/kb/156276) - Cmd does not support UNC names as the current directory.  
Equivalent PowerShell: [Set-Location](../ps/set-location.html) - Set the current working location.  
Equivalent bash command (Linux): [cd](../bash/cd.html) - Change Directory.



/. nt/change.html
========================================================

    change - Terminal server - Windows CMD - SS64.com

CHANGE
======

Change Terminal Server Session properties, use when installing software on a terminal server.

Syntax

      CHANGE USER /_options_
      CHANGE LOGON /_options_
      CHANGE PORT /_options_

Options:
  To change .INI file mapping: (administrator rights required)

  CHANGE USER /INSTALL   Enable install mode. This command has to be run before
                         installing any new software on a Terminal Server.
                         This will create a .ini file for the application
                         in the TS system directory.

  CHANGE USER /EXECUTE   Enable execute mode (default)
                         Run this when an installation is complete.

  CHANGE USER /QUERY     Display current settings.

  To enable or disable terminal session logins:

  CHANGE LOGON /QUERY    Query current terminal session login mode.
  CHANGE LOGON /ENABLE   Enable user login from terminal sessions.
  CHANGE LOGON /DISABLE  Disable user login from terminal sessions.


  To list or change COM port mappings for the current session.
  This can allow DOS applications to access high numbered ports e.g. COM12

  CHANGE PORT portx=porty      Map port x to port y.
  CHANGE PORT /D portx         Delete mapping for port x.
  CHANGE PORT /QUERY           Display current mapping ports.

How .ini files work:

Installing an application will create a .ini file in the TS system directory.

The first time a user runs the application, the application looks in the home directory for its .ini file. If none is found then Terminal Server will copy the .ini file from the system directory to the users home directory.

Each user will have a unique copy of the application's .ini file in their home directory.

To learn more about what happens when the system is put into install mode run CHANGE USER /?

The CHANGE command replaces CHGLOGON, CHGUSER, and CHGPORT from Citrix Winframe.

“There are two ways to slide easily through life; to believe everything or to doubt everything. Both ways save us from thinking” ~ Alfred Korzybski

### Related commands

Other [Terminal Server commands](https://www.robvanderwoude.com/termserv.html)  
[INSTSRV](syntax-autoexec.html) - Install a Service.  
[LOGOFF](logoff.html) - Log a user off.  
[MSIEXEC](msiexec.html) - Microsoft Windows Installer.  
[Q243202](https://web.archive.org/web/20130422010343/https://support.microsoft.com/kb/243202) - TS Session Management Tools.  
Equivalent bash command (Linux): [who](../bash/who.html) - Print all usernames currently logged in.



/. nt/changepk.html
========================================================

    CHANGEPK - Windows CMD - SS64.com

CHANGEPK.exe
============

Upgrade device Product Key to a supported edition of Windows 10.  

Syntax

      CHANGEPK /ProductKey _NewProductKey_

This can be used to move from Home ➞ Pro Education, from Pro ➞ Education, from Pro ➞ Enterprise a full list of the supported Edition upgrades and downgrades is available on [docs.microsoft.com](https://docs.microsoft.com/en-us/windows/deployment/upgrade/windows-10-edition-upgrades)

You can also upgrade using [slmgr.vbs](slmgr.html) and a KMS client setup key.  

### Examples

Upgrade to Windows 10 Enterprise:

C:> Cscript.exe c:\windows\system32\slmgr.vbs /ipk NPPR9-FWDCX-D2C8J-H872K-2YT43

“When you think of shooting somebody in the back cause your scared? Think about that. They're running that way, away from YOU because they're scared and you shoot them because you're afraid for your life? That is the most cowardly. Truly weak. And a coward with a gun is the most dangerous thing in the world” ~ Toni Morrison

### Related commands

[SLMGR](slmgr.html) - Software Licensing Management.



/. nt/chcp.html
========================================================

    CHCP - Change Code Page - Windows CMD - SS64.com

CHCP.com
========

Change the active console [Code Page](https://www.computerhope.com/jargon/c/codepage.htm). The default code page is determined by the Windows [Locale](../locale.html).

Syntax

      CHCP _code_page_

Key
    _code_page_  A code page number (e.g. 437)  

This command is rarely required as most GUI programs and PowerShell now support Unicode. When working with characters outside the [ASCII](../ascii.html) range of 0-127, such as some [box characters](echo.html#box), the choice of code page will determine the set of characters displayed.

Programs that you start after you assign a new code page will use the new code page, however, programs (except Cmd.exe) that you started before assigning the new code page will use the original code page.

Code page

Country/ Region/ Language

 

437

United States

default code page in the US

850

Multilingual (Latin I)

default code page in most of Europe

852

Slavic (Latin II)

 

855

Cyrillic (Russian)

 

857

Turkish

 

860

Portuguese

 

861

Icelandic

 

863

Canadian-French

 

865

Nordic

 

866

Russian

 

869

Modern Greek

 

1252

West European Latin

 

65000

UTF-7 *

 

65001

UTF-8 *

 

* The 65000/1 code pages are encoded as UTF-7/8 to allow to working with unicode data in 7-bit and 8-bit environments, however

Even if you use CHCP to run the Windows Console in a unicode code page, many applications will assume that the default still applies, e.g. Java requires the-Dfile option: [java -Dfile.encoding=UTF-8](https://horstmann.com/unblog/2016-05-06/index.html)

Unicode characters will only display if the current console font contains the characters. So use a [TrueType font](../fonts.html) like Lucida Console instead of the CMD default Raster Font.

The CMD Shell (which runs inside the Windows Console)
-----------------------------------------------------

> [CMD.exe](cmd.html) only supports two character encodings Ascii and Unicode (CMD /A and CMD /U)
> 
> If you need full unicode support use [PowerShell](../ps/). There is still [VERY limited support](https://stackoverflow.com/questions/1259084/what-encoding-code-page-is-cmd-exe-using) for unicode in the CMD shell, piping, redirection and most commands are still ANSI only. The only commands that work are DIR, FOR /F and [TYPE](type.html), this allows reading and writing (UTF-16LE / BOM) files and filenames but not much else.

Code Pages
----------

> The number of supported code pages was greatly increased in Windows 7.  
> For a full list of code pages supported on your machine, run NLSINFO (Resource Kit Tools).
> 
> Files saved in Windows Notepad will be in [ANSI format](../ascii.html) by default, but can also be saved as Unicode UTF-16LE or UTF -8 and for unicode files, will include a BOM.  
> A BOM will make a batch file not executable on Windows, so batch files must be saved as ANSI, not Unicode.

### Examples

View the current code page:  
chcp

Change the code page to Unicode/65001:  
chcp 65001

“Remember that there is no code faster than no code” ~ Taligent's Guide to Designing Programs

### Related commands

[[Undocumented] CHCP](https://ss64.org/viewtopic.php?f=2&t=84) - Forum.  
[Transcoding to ANSI with CHCP](https://ss64.org/viewtopic.php?f=2&t=350) - Forum.  
[Full list of Code Page Identifiers](https://docs.microsoft.com/en-gb/windows/win32/intl/code-page-identifiers) - docs.microsoft.com  
[Windows Locale codes](../locale.html).  
[TYPE](type.html) - can print UTF-16LE files with a BOM regardless of the current codepage.  
[What every software developer must know about Unicode and Character Sets](https://www.joelonsoftware.com/articles/Unicode.html) ~ Joel Spolsky.  
Equivalent PowerShell: [[Console]::OutputEncoding](https://stackoverflow.com/questions/5796339/printing-unicode-characters-to-the-powershell-prompt/5808445#5808445), All text input is automatically converted to [Unicode.](../convert.html)  
Equivalent bash command (Linux): LANG - locale category environment variable & LC_* variables for locale category.



/. nt/cd.html
========================================================

    CD Change Directory - Windows CMD - SS64.com

CD
==

Change Directory - Select a Folder (and drive)

Syntax

      CD [/D] [_drive_:][_path_]
      CD [..]

Key
    /D : change the current DRIVE in addition to changing folder.

CHDIR is a synonym for CD.

Tab Completion
--------------

> Tab completion allows changing the current folder by entering just part of the path and pressing TAB.
> 
>    C:> CD Prog [PRESS TAB] 
>    Will go to C:\Program Files\
> 
> Tab Completion is disabled by default, it has been known to create difficulty when using a batch script to process text files that contain TAB characters.  
>   
> Tab Completion is turned on by setting the registry value shown below:  
>   
> REGEDIT4  
> [HKEY_CURRENT_USER\Software\Microsoft\Command Processor]  
> "CompletionChar"=dword:00000009

A Current Directory for each drive?
-----------------------------------

> Originally in MS-DOS, each drive had its own current directory, for complex [historical reasons](https://devblogs.microsoft.com/oldnewthing/20101011-00/?p=12563).
> 
> Now in Win32, there is one global current directory, but at the command line the appearance is still maintained that each drive has its own current directory, this is a fake-out by cmd.exe.  
> The location for each drive is stored using the undocumented [environment variables](syntax-variables.html) =A:, =B:, =C: etc.
> 
> The only reason you need to be aware of this is that GUI Windows applications may have a different current directory than the command prompt. Similarly two CMD sessions can each have a different current directory.

Errorlevels
-----------

> If the Current directory was changed: [%ERRORLEVEL%](errorlevel.html) = 0  
> If the Directory does not exist or is not accessible or if a bad switch given: [%ERRORLEVEL%](errorlevel.html) = 1

CHDIR is a synonym for CD

CD is an [internal](syntax-internal.html) command.

### Examples

Change to the parent directory:  
C:\Work> CD ..  
  
Change to the grant-parent directory:  
C:\Work\backup\January> CD ..\..  
  
Change to the ROOT directory:  
C:\Work\backup\January> CD \  
  
Display the current directory in the specified drive:  
C:> CD D:  
  
Display the current drive and directory:  
C:\Work> CD  
  
Display the current drive and directory:  
C:\Work> ECHO "%CD%"  
  
In a batch file to display the location of the batch script file (%0)  
C:> ECHO "%~dp0"  
  
In a batch file to CD to the location of the batch script file (%0)  
C:> CD /d "%~dp0"  
  
Move down the folder tree with a full path reference to the ROOT folder...  
C:\windows> CD ****windows\java  
C:\windows\java>  
  
Move down the folder tree with a reference RELATIVE to the current folder...  
C:\windows> CD java  
C:\windows\java>  
  
Move up and down the folder tree in one command...  
C:\windows\java> CD ..\system32  
C:\windows\system32>

If [Command Extensions](cmd.html) are enabled, which they are by default, the CD command is enhanced as follows:

> The current directory string is not CASE sensitive.  
> So CD C:\wiNdoWs will set the current directory to C:\Windows  
>   
> CD does not treat spaces as delimiters, so it is possible to CD into a subfolder name that contains a space without surrounding the name with quotes.  
>   
> For example:  
> cd \My folder  
>   
> is the same as:  
> cd "\My folder"
> 
> An asterisk can be used to complete a folder name  
> e.g. C:> CD pro* will move to C:\Program Files

**Change the Current Drive**  
  
Enter the drive letter followed by a colon  
C:> E:  
E:>  
  
To change drive and directory at the same time, use CD with the /D switch  
C:> cd /D E:\utils  
E:\utils>

_“Change is the law of life. And those who look only to the past or the present are certain to miss the future” ~ John F. Kennedy_

### Related commands

[MD](md.html) - Create Directory.  
[pushd](pushd.html) - Change Directory.  
[RD](del.html) - Delete directory or entire directory tree.  
How-to: [Long filenames, NTFS and legal filename characters](syntax-filenames.html).  
[Q156276](https://web.archive.org/web/20150312195558/https://support.microsoft.com/en-us/kb/156276) - Cmd does not support UNC names as the current directory.  
Equivalent PowerShell: [Set-Location](../ps/set-location.html) - Set the current working location.  
Equivalent bash command (Linux): [cd](../bash/cd.html) - Change Directory.



/. nt/chkdsk.html
========================================================

    chkdsk Check Disk - Windows CMD - SS64.com

chkdsk.exe
==========

Check Disk - check and repair disk problems

Syntax

      CHKDSK [drive:][[_path_]_filename_] [/F] [/V] [/R] [/L[:_size_]] 

Key
    [_drive_:]   The drive to check. Drive letter followed by a colon, mount point or volume name.
   
    _filename_   File(s) to check for fragmentation (FAT only). 
   
    /F         Automatically Fix file system errors on the disk.

    /X         Fix file system errors on the disk, Implies /F
              dismounts the volume first, closing all open file handles.
   
    /R         Scan for and attempt Recovery of bad sectors.
 
    /B         NTFS only: Re-evaluate bad clusters on the volume. Implies /R  ** Windows10+

    /V         Display the full path and name of every file on the disk. 
   
    /L:_size_    NTFS only: change the log file size to the specified number of kilobytes.   
              If size is not specified, displays the current log size and the drive type
              (FAT or NTFS).

    /C         NTFS only: Skip directory corruption checks. 

    /I         NTFS only: Skip corruption checks that compare directory entries to the
              file record segment (FRS) in the volume's master file table (MFT)

    /scan      NTFS only: Run an online scan on the volume.

    /forceOfflineFix
              NTFS only: Must be used with /scan
              Bypass all online repair; all defects found are queued for offline repair
              i.e. chkdsk /spotfix

    /perf      NTFS only: Must be used with /scan
              Uses more system resources to complete a scan as fast as possible. This may
              have a negative impact on other running tasks.

    /spotfix   NTFS only: Run spot fixing on the volume.

    /sdCleanup NTFS only: Garbage collect unneeded security descriptor data, implies /F

    /offlineScanandFix
              Run an offline scan and fix on the volume.
    /freeOrphanedChains
              FAT/FAT32/exFAT only: Free any orphaned cluster chains instead of recovering
              their contents.

    /markClean FAT/FAT32/exFAT only: Mark the volume clean if no corruption was detected even
              if /F was not specified.

### Examples

CHKDSK C: /F

**Fixing Errors /F**  
  
If the drive is the boot partition, you will be prompted to run the check during the next boot  
  
If you specify the /f switch, chkdsk will show an error if **open files** are found on the disk.

Chkdsk /f will lock the volume, making data unavailable until chkdsk is finished.  
  
If you use chkdsk /f on a disk with a very large number of files (millions), chkdsk can take a long time to complete.

When you delete a file or folder that has 'custom' permissions, the ACL is not deleted, it is cached. Chkdsk /f will remove ACLs that are no longer used. This is often the cause of the rather worrying message: _"Windows found problems with the file system. Run chkdsk with the /F (fix) option to correct these."_

It is normal for chkdsk /F to remove unused index entries and unused security descriptors every time you run it, these do not indicate a problem with the file system.  
  
**Scan only (without /f switch)**  
  
If a file needs to be fixed chkdsk will alert you with a message but will not fix the error(s).  
  
chkdsk can report lost allocation units on the disk - it will produce this report even if the files are in-use (open). If corruption is found, consider closing all files and repairing the disk with /F.

Running chkdsk on a data volume that is in use by another program or process can incorrectly report errors when none are present. To avoid this, close all programs or processes that have open handles to the volume.

On computers running Windows 2003 SP1 and later, chkdsk automatically creates a shadow copy, so you can check volumes that are 'in use' by another program or process. This enables an accurate report against a live file server. On earlier versions of Windows, chkdsk would always lock the volume, making data unavailable.

**Run at Bootup**

Running at bootup is often the easiest way to close all open file handles.

Use chkdsk, [chkntfs](chkntfs.html) or the [FSUTIL](fsutil.html) dirty commands to set or query the volumes 'dirty' bit so that Windows will run chkdsk when the computer is restarted. This setting is also found in the BootExecute value under HKLM\System\CurrentControlSet\Control\Session Manager

**Event Logs**

Chkdsk will log error messages in the Event Viewer - System Log.  
Chkdsk /f removes ACLs that are no longer used and reports this in the Event Viewer - Application Log.

**Cluster (or block) Size**  
  
CHKDSK produces a report that shows the the block /cluster size  
typically: "4096 bytes in each allocation unit."  
When the cluster size is greater than 4 KB on an NTFS volume, none of the NTFS compression functions are available.

**Exit codes**  
  
0 No errors were found  
1 Errors were found and fixed.  
2 Could not check the disk, did not or could not fix errors.

**Notes:**  
Consider the time required to run Chkdsk to repair any errors that occur. Chkdsk times are determined by the number of files on the volume and by the number of files in the largest folder. Chkdsk performance was improved by 30% under Windows 2003 and around 50% in 2008 R2.  
  
To issue chkdsk on a hard drive you must be a member of the Administrators group.

When CHKDSK is set to run at boot-up there is a delay to allow the check to be cancelled - this can be configured in the registry:  
  
HKLM\System\CurrentControlSet\Control\Session Manager  
REG_DWORD:AutoChkTimeOutData  
The value is the time in seconds that you want CHKDSK to wait (0 = no delay) default is 10 seconds.

Chkdsk is also available from the [Recovery Console](syntax-recovery.html) (with different parameters.)

**Disk Errors**

_"The file system structure on the disk is corrupt and unusable"_

If you have disk corruption, run the drive manufacturers diagnostics:  
[Toshiba](https://toshiba.semicon-storage.com/us/design-support/partnumber/storage-products.html) | [Hitachi/IBM](https://www.hgst.com/support/hard-drive-support/downloads) | [Seagate/Maxtor/Freeagent](https://www.seagate.com/gb/en/support-home/) | [Western digital](https://support.wdc.com/)

“I either want less corruption, or more chance to participate in it” ~ Ashleigh Brilliant

### Related commands

[CHKNTFS](chkntfs.html) - Schedule CHKDSK to run at boot time.  
[FSUTIL](fsutil.html) - Set options to control the operation of CHKDSK  
[FSUTIL dirty](fsutil.html) query C: - Is the drive dirty.  
[CleanMgr](cleanmgr.html) - Automated cleanup of Temp files, recycle bin etc.  
[Q187941](https://web.archive.org/web/20110217150433/https://support.microsoft.com/kb/187941) - New /C and /I Switches.  
[Q303079](https://web.archive.org/web/20110311183916/https://support.microsoft.com/kb/303079) - Locate and correct NTFS problems.  
[Q310747](https://support.microsoft.com/en-us/help/310747/) - System File Checker (Sfc.exe) .  
[Q327009](https://web.archive.org/web/20110105062708/https://support.microsoft.com/kb/327009) - Chkdsk Finds Incorrect Security IDs.  
[Q329394](https://web.archive.org/web/20100419050117/https://support.microsoft.com/kb/329394) - Long Delays Occur When You Run Chkdsk.exe  
[Ultimate Boot CD](https://www.ultimatebootcd.com/) - Recovery tool.  
[HDTune](https://www.hdtune.com/) - Performance & SMART Info. (Self-Monitoring Analysis and Reporting Technology).  
Equivalent bash command (Linux): [fsck](../bash/fsck.html) - filesystem consistency check and interactive repair.



/. nt/chkntfs.html
========================================================

    Chkntfs - Check the NTFS file system - Windows CMD - SS64.com

CHKNTFS.exe
===========

Check the NTFS file system with [CHKDSK](chkdsk.html)

Syntax

      CHKNTFS _drive_: [...]
      CHKNTFS /C _drive_: [...]
      CHKNTFS /X _drive_: [...]
      CHKNTFS /t[:_Time_]
      CHKNTFS /D

Key
    _drive_  Specifies a drive letter.  
    /C   Check - schedules chkdsk to be run at the next reboot.  
    /X   Exclude a drive from the default boot-time check. 
        Excluded drives are not accumulated between command invocations.

    /T   Change the Autochk.exe initiation countdown time (time in seconds)
        If you don’t specify Time: displays the current countdown time.  
    /D   Restore the machine to the default behavior; all drives are  
        checked at boot time and chkdsk is run on those that are dirty.
        This undoes the effect of the /X option.

If no switches are specified, CHKNTFS will display the status of the dirty bit for each drive.

“I don’t make no dirty movements” ~ Elvis

### Related commands

[CHKDSK](chkdsk.html) - Check Disk - check and repair disk problems.  
[FSUTIL](fsutil.html) - File and Volume utilities.  
[Q160963](https://support.microsoft.com/en-us/help/160963/) - ChkNTFS What you can use it for.  
[BCDEDIT](bcdedit.html) - Manage Boot Configuration Data.



/. nt/choice.html
========================================================

    Choice - Accept user input - Windows CMD - SS64.com

CHOICE.exe
==========

Accept user input to a batch file. Choice allows single key-presses to be captured from the keyboard.

    CHOICE [/c [choiceKeys]] [/N] [/CS] [/t _Timeout_ /D _Choice_] [/M _Text_]

key
    /C[:]_choiceKeys_  One or more keys the user can press. Default is YN.

    /N               Do not display _choiceKeys_ at the end of the prompt string.

    /CS              Make the _choiceKeys_ Case Sensitive.

    /T _Timeout_       Timeout in _Timeout_ seconds
                    If _Timeout_ is 0 there will be no pause and the
                    default will be selected.

    /D _choice   _     Default choice made on Timeout.

    /M "_text"_        Message string to describe the choices available.

ERRORLEVEL will return the numerical offset of choiceKeys.  

If you need to include a quotation mark within the message string, it needs to be [escaped](syntax-esc.html) by doubling it: "_message""withquote_"

CHOICE can be used to set a specific %errorlevel%  
for example to set the %errorlevel% to 6 :  
ECHO 6| CHOICE /C 123456 /N >NUL

### Examples

CHOICE /C CH /M "Select [C] CD or [H] Hard drive"  
IF [%ERRORLEVEL%](https://ss64.com/nt/if.html#errorlevel) EQU 2 goto sub_hard_drive  
IF %ERRORLEVEL% EQU 1 goto sub_cd

“If you limit your choices only to what seems possible or reasonable, you disconnect yourself from what you truly want, and all that is left is compromise” - Robert Fritz

### Related commands

[IF](../nt/if.html) - Conditionally perform a command.  
[CON](con.html) - Accept console input.  
[SET /P](set.html) - Prompt for user input (accepts a whole string instead of one keypress).  
[TIMEOUT](timeout.html) - Delay processing of a batch file/command.  
Equivalent PowerShell: [MessageBox](../ps/messagebox.html) - Display a message box. / [Read-Host](../ps/read-host.html) - Read a line of input from the console.  
Equivalent bash command (Linux): [case](../bash/case.html) / [select](../bash/select.html) - Accept keyboard input.



/. nt/cipher.html
========================================================

    cipher Encrypt or Decrypt files and folders - Windows CMD - SS64.com

CIPHER.exe
==========

Encrypt or Decrypt files and folders.  
Without parameters cipher will display the encryption state of the current folder and files. NTFS volumes only.

Syntax

  Encrypt/Decrypt:
      CIPHER [/e | /d] [/s:_directory_] [/b] [/h] [_pathname_ [...]]

  Display Cipher information:
      CIPHER /c [/s:_directory_] [/b] [/h] [_pathname_ [...]]

  Create a new Certificate/Key:
      CIPHER /k

  New Recovery agent certificate:
      CIPHER /r:_filename_ [/smartcard]

  Touch encrypted files to Update encryption key:
      CIPHER /u [/n]

  Remove data:
      CIPHER /w:_directory_

  Backup Keys:
      CIPHER /x[:_efsfile_] [_filename_]

  Display current EFS cert:
      CIPHER /y

  Add user to the file:
      CIPHER /adduser [/certhash:_hash_ | /certfile:_filename_] [/s:_directory_] [/b] [/h] [_pathname_ [...]]

  Remove user from the file:
      CIPHER /removeuser /certhash:_hash_ [/s:_directory_] [/b] [/h] [_pathname_ [...]]

  Update the files to use a new EFS key:
      CIPHER /rekey [_pathname_ [...]]

Options:

    /b    Abort if an error is encountered. By default, cipher continues to run even if errors are encountered.

    /c    Display information about the encrypted file.

    /d    Decrypt the files or directories.

    /e    Encrypt the files or directories.
         Directories are marked so that files that are added to the folder later are encrypted too.

    /h    Display files with hidden or system attributes.
         By default, these files are not encrypted or decrypted.

    /k    Create a new certificate and key for use with Encrypting File System (EFS) files.
         If /k is specified, all other parameters are ignored.

    /r:_filename_ [/smartcard]
         Generate an EFS recovery agent key and certificate, and write them to a .pfx file
         (containing certificate and private key) and a .cer file (containing only the certificate).
         If /smartcard is specified, it writes the recovery key and certificate to a smart card, and no .pfx file is generated.

    /s:_directory_
         Performs the operation in the folder and all subfolders.

    /u [/n]  Find all encrypted files on the local drive(s).
         If used with the /n parameter, no updates are made. If used without /n, /u compares the user's file encryption key
         or the recovery agent's key to the current ones, and updates them if they have changed. This parameter works only with /n.

    /w:_directory_
         Remove data from available unused disk space on the entire volume.
         If you use the /w parameter, all other parameters are ignored.
         The directory specified can be located anywhere in a local volume. If it is a mount point or points to a
         directory in another volume, the data on that volume is removed.

    /x[:_efsfile_] [_FileName_]
         Back up the EFS certificate and keys to the specified file name.
         If used with :efsfile, /x backs up the user's certificate(s) that were used to encrypt the file.
         Otherwise, the user's current EFS certificate and keys are backed up.

    /y    Display your current EFS certificate thumbnail on the local computer.

    /adduser [/certhash:_hash_ 	/certfile:_filename_] /rekey
         Update the specified encrypted file(s) to use the currently configured EFS key.

    /removeuser /certhash:_hash_
 	       Remove a user from the specified file(s).
         The Hash provided for /certhash must be the SHA1 hash of the certificate to remove.

  _PathName_
         A pattern, file, or folder.

    /?    Help

It is recommended that you always encrypt both the file and the folder in which it resides, this prevents an encrypted file from becoming decrypted when it is modified.

An administrator can add the contents of a .cer file to the EFS recovery policy to create the recovery agent for users, and then import the .pfx file to recover individual files.

Cipher cannot encrypt files that are marked as [read-only](attrib.html).  
Cipher will accept multiple folder names and wildcard characters.  
You must separate multiple parameters with at least one space.

### Examples

Display the encryption status of each of the files and subdirectories in the current directory, Encrypted files and directories will be prefixed with an E. Unencrypted files and directories will be prefixed with a U:

CIPHER

Enable encryption for the folder 'SS64' (assuming it exists below the current directory):

CIPHER /e SS64

List encrypted files in the reports folder:

CIPHER c:\reports*

Encrypt the Reports folder and all subfolders:

CIPHER /e /s:C:\reports

Back up the certificate and private key currently used to encrypt and decrypt EFS files to a file:

CIPHER /x c:\myefsbackup

To overwrite **all** deleted data on the C: volume, run cipher /w against any folder on that volume e.g. C:\demo:

Quit all programs, then  
CIPHER /W:c:\demo

This will cause all deallocated space on drive C: to be overwritten. If C:\demo is a Mount Point or points to a folder on another volume, all deallocated space on that volume will be cleaned. Data that isn’t allocated to files or folders is overwritten. The data is permanently removed. It can take a long time if you overwrite a large amount of space.

“He that would make his own liberty secure must guard even his enemy from oppression; for if he violates this duty he establishes a precedent that will reach to himself” ~ Thomas Paine

### Related commands

[FSUTIL](fsutil.html) - File and Volume utilities.  
[CMDKEY](cmdkey.html) - Manage stored usernames/passwords.  
[Q814599](https://docs.microsoft.com/en-US/troubleshoot/windows-server/windows-security/use-cipher-to-overwrite-deleted-data) - Use Cipher.exe to overwrite deleted data in Windows Server 2003  
Equivalent PowerShell: [ConvertTo-SecureString](../ps/convertto-securestring.html) - Convert to a secure string.



/. nt/cleanmgr.html
========================================================

    Cleanmgr - Delete Junk and Temp files - Windows CMD - SS64.com

CLEANMGR.exe
============

Automated cleanup of Temporary files, Internet files, downloaded files, recycle bin.

Syntax

      CLEANMGR [/d _drive_] /LOWDISK
      CLEANMGR [/d _drive_] /VERYLOWDISK
      CLEANMGR [/d _drive_] /SETUP
      CLEANMGR [/d _drive_] /Autoclean
      CLEANMGR [/d _drive_] /sageset:_n_
      CLEANMGR [/d _drive_] /sagerun:_n_

Key
       /D _drive_      The drive that you want Disk Cleanup to clean.
                     NOTE: The /d option is not utilized with /SAGERUN:_n_.
                     Specify the %systemroot% drive to see all the available options.

       /LOWDISK      Disk Cleanup will open with all options checked. 
                     Normally invoked when Windows notifies that of disk space is running out.

       /VERYLOWDISK  Disk Cleanup will open with all options checked, no user prompts.

       /SAGESET:_n_    Display the Disk Cleanup Settings dialog box and create
                     a registry key to store the settings you select.
                     REQUIRES [ELEVATION](syntax-elevate.html)
                     The _n_ value is stored in the registry and allows you to
                     specify different tasks for Disk Cleanup to run.
                     _n_ can be any integer from 0 to 9999.

       /SAGERUN:_n_    Run task '_n_'
                     All drives in the computer will be enumerated, and the
                     selected profile will be run against each drive. 

       /TUNEUP:_n_     Run /sageset and /sagerun for the same _n_

       /SETUP        Analyze the system files left over from a previous Windows version. [Undocumented]

       /Autoclean    Analyze the system files left over from a previous Windows version/in-place upgrade.
                     and also remove those files automatically. [Undocumented]

       /HELP         Display help
       /USAGE        Display help
       /?            Display help

If CLEANMGR is run without /sageset or /sagerun, it will start by calculating how much disk space could be saved. This makes the process slower to startup.

Although many of these files are often described as "junk" you should carefully evaluate what they do before deleting them. By default only the _Downloaded Program Files_ and _Temporary Internet Files_ will be selected.

Having a hard drive that is over 75% - 80% full will affect performance because file fragmentation (and automatic defragmentation) will increase. Also assuming you have the default 'system managed size' for the page file, that will automatically shrink to fit in the available space. For a drive that has more than 25% free space, deleting files will not make any difference to performance.

Some cleanup options require [elevation](syntax-elevate.html), when run without elevation the GUI will include an option [Clean up System Files] which will relaunch CLEANMGR in Elevated mode. When necessary CLEANMGR can take ownership of the files before deleting them.

To enable Cleanmgr on older servers of Windows Server, open Server Manager and choose Add feature, then select "Desktop Experience"  
After running cleanmgr on a server you may want to disable "Desktop Experience" again.

Cleanup Settings: Files to delete
---------------------------------

> The following options can be toggled on or off when running /SAGESET:_n_
> 
> Branch Cache  
> _Catalog Files for the Content Indexer  
> Compress Old Files_  
> Delivery Optimization Files  
> Diagnostic data viewer database files  
> DirectX Shader cache  
> Downloads   (Personal downloads folder)  
> Downloaded Program Files *  
> Language resources Files  
> _Offline Files_  
> Old Chkdsk Files  
> Recycle Bin * (empties the recycle bin to recover the disc space)  
> Retail Demo Offline Content  
> Setup Log files  
> System Error memory dump files  
> System Error minidump files  
> Temporary Files  
> Temporary Internet Files *  
> Temporary Setup Files  
> _Temporary Offline Files_  
> Thumbnails  
> Update package Backup Files  
> User file history  
> Windows Defender Antivirus  
> Windows error reports and feedback diagnostics  
> Windows Update Cleanup  
> Windows Upgrade log files  
> 
> Items marked with * have a [View Files] option in the GUI to view the individual files.  
> The Recycle Bin and _Catalog Files for the Content Indexer_ may appear for more than one drive.

Application Data
----------------

> The user's 'Application Data' folder is not available for cleanup in the above list. Many files in Application Data hold system data that should not be deleted. However if you have an application that leaves a significant number of temporary/junk files in App Data, these can be selectively removed from a roaming profile with a VBScript [like this](../vb/syntax-profile.html).

Recent files
------------

> The 'User Profile/Recent Items' folder can contain many more shortcuts than are useful. A very large number of these can affect logon/logoff times. To clear out the shortcuts:
> 
> CD %userprofile%\AppData\Roaming\Microsoft\Windows\Recent  
> Echo y| del *.*

Close Locked files by restarting Windows Explorer
-------------------------------------------------

> Save the following batch script:  
> @Echo off  
> [Taskkill](taskkill.html) /f /im Explorer.exe  
> Start Explorer.exe  
> Exit  
> Then to restart Windows Explorer, just run the batch file.

Registry
--------

> Registry settings for CLEANMGR are held in:  
> [HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VolumeCaches]
> 
> Here are a [set of registry entries](cleanmgr-registry.html) to turn on a typical selection of cleanmgr options, these can be used with [REG](reg.html) or [Regedit](regedit.html) to pre-populate the regisitry as a scriptable alternative to running /SAGESET

Log files for CLEANMGR are stored in:  
C:\Windows\System32\LogFiles\setupcln\

**Examples**  
  
Choose a set of options for cleanup (this will display the GUI) and Save as settings group #64:

 CLEANMGR /sageset:64

Run the saved settings group #64

 CLEANMGR /sagerun:64

To run Disk Cleanup this way regularly, you can create a shortcut which can be run from the Windows Startup folder or via a regular schedule. To run the saved settings group #64

%systemroot%\system32\cmd.exe /c CLEANMGR /sagerun:64

”Mrs. Joe was a very clean housekeeper, but had an exquisite art of making her cleanliness more uncomfortable and unacceptable than dirt itself“ ~ Charles Dickens

### Related commands

[DELPROF](delprof.html) - Delete user profiles and/or User Profile cache.  
[DEFRAG](defrag.html) - Defragment hard drive.  
[Q253597](https://support.microsoft.com/en-us/help/253597/) - Automating Disk Cleanup in Windows.  
Equivalent bash command (Linux):[watch](../bash/watch.html) - Execute/display a program periodically.



/. nt/clip.html
========================================================

    clip - Windows CMD - SS64.com

CLIP.exe
========

Copy the result of any command to the Windows clipboard.

Syntax

      _command_ | CLIP

      CLIP < _filename_.txt

When using clip.exe in a batch script you should warn the user that their clipboard is about to be overwritten.

### Examples

DIR | CLIPDATE /t | CLIP

hostname| clip  

“The stupid neither forgive nor forget, the naive forgive and forget, the wise forgive but do not forget” ~ Thomas Szasz (The second sin)

### Related commands

[SET](set.html) - Display, set, or remove Windows environment variables.  
Equivalent PowerShell: [Set-Clipboard](../ps/set-clipboard.html) - Set the current Windows clipboard entry.  
Equivalent bash command (Linux): [xsel](http://www.vergenet.net/%7Econrad/software/xsel/) - get and set the contents of an X-window selection. Or [Shift-Insert](https://unix.stackexchange.com/questions/11889/pasting-x-selection-not-clipboard-contents-with-keyboard).



/. nt/cls.html
========================================================

    CLS Clear the screen - Windows CMD - SS64.com

CLS
===

Clear the screen.

Syntax

      CLS

If CLS is redirected to file, console or executed through FOR /F it will print a line feed character ([ASCII](../ascii.html) 10).

Errorlevels
-----------

> If the screen is successfully cleared [%ERRORLEVEL%](errorlevel.html) will be unchanged, typically this will be 0 but if a previous command set an errorlevel, that will be preserved (this is a bug).
> 
> If a bad switch is given [%ERRORLEVEL%](errorlevel.html) ➞ 1

### Examples

Echo Hello  
CLS  
Echo You didnt see that

CLS is an [internal](syntax-internal.html) command.

“Let me be clear: America wants a strong, peaceful, and prosperous Russia” ~ Barack Obama

### Related commands

[ECHO](echo.html) - Display message on screen.  
Equivalent PowerShell: [Clear-Host](../ps/clear-host.html) - Clear the screen.



/. nt/cmd.html
========================================================

    CMD.exe (Command Shell) - Windows CMD - SS64.com

CMD.exe
=======

Start a new CMD shell and (optionally) run a command/executable program.

Syntax

      CMD [_charset_] [_options_]

      CMD [_charset_] [_options_] [/C _Command_] 

      CMD [_charset_] [_options_] [/K _Command_] 

Options   
    /C     Run _Command_ and then terminate

    /K     Run _Command_ and then remain open, at the CMD prompt.
          This is useful for testing, e.g. to examine variables.

    _Command_ : The command, program or batch script to be run.
             This can even be several commands separated with '[&](syntax-redirection.html)' 
             (the whole should also be surrounded by "quotes")

    /T:_fg_  Sets the foreground/background [colours](color.html) 
   
    /A     Output ANSI characters.
    /U     Output UNICODE characters (UCS-2 le).

          These options will affect [piping or redirecting](syntax-redirection.html) to a file.
          Most common text files are ANSI, use these switches when
          you need to convert the character set.

    /D     Ignore registry AutoRun commands
          HKLM | HKCU \Software\Microsoft\Command Processor\AutoRun

    /E:ON  Enable CMD Command Extensions (default)
    /X     Enable CMD Command Extensions (old switch for compatibility)
    /E:OFF Disable CMD Command Extensions
    /Y     Disable CMD Command Extensions (old switch for compatibility)

    /F:ON  Enable auto-completion of pathnames entered at the CMD prompt
    /F:OFF Disable auto-completion of pathnames entered at the CMD prompt (default)

> > At the command prompt Ctrl-D gives fol**d**er name completion and Ctrl-F gives **F**ile and folder name completion.  
> >   
> > These key-strokes will display the first matching path. Thereafter, repeated pressing of the same control key will cycle through the list of matching paths. Pressing SHIFT with the control key will move through the list backwards.

    /Q    Turn echo off

    /S    Strip " quote characters from _command.
_         If _command_ starts with a quote, the first and last quote chars in _command_
         will be removed, whether /s is specified or not.

    /V:ON Enable [delayed environment variable expansion](setlocal.html) 
         this allows a FOR loop to specify !variable! instead of %variable% 
         expanding the variable at execution time instead of at input time. 
   
    /V:OFF
         Disable delayed environment expansion.
         Delayed Environment expansion can also be set with [SETLOCAL](setlocal.html)

If /C or /K is specified, then the remainder of the command line is processed as an immediate command in the new shell. Multiple commands separated by the command separator '&' or '[&&](syntax-redirection.html)' are accepted if surrounded by quotes.

In Windows Explorer, you can type "cmd" in the address bar to open a prompt at the current location.  
For more detail about the CMD shell: QuickEdit, handing quotes, max line length etc, see the [CMD Syntax page](syntax-cmd.html).

If you start a second nested CMD shell (or PowerShell), this will be added to the [TITLE](title.html) of the CMD/terminal window, when you [EXIT](exit.html) back to the initial shell, the Title will also revert making it possible to track how many nested shells you have open.

ErrorLevel
----------

> CMD /C will return an errorlevel, for example CMD /c dir Z: where the drive Z: does not exist, will return %errorlevel% = 1 to the calling CMD shell.

Launching CMD/batch files from a UNC path
-----------------------------------------

> While most command line utilities do fully support UNC paths, they cannot be set as the [current directory](cd.html). Launching a batch file from a UNC path will implicitly run CMD.exe with that UNC path, this will often return the error: _path is an invalid current directory path. UNC paths are not supported. Defaulting to Windows directory._  
> This can be dangerous if your batch file makes any assumptions about the current directory,  
> e.g. if it includes the line DEL *.ico, that will delete .ico files from the Windows directory instead of the folder where the batch file resides.  
> If you are confident that the batch file won’t be affected by this, you can suppress the error in one of two ways: Add a [CLS](cls.html) command as the first line of the batch script, or add the registry key DisableUNCCheck as described in [Q156276](https://web.archive.org/web/20150312195558/https://support.microsoft.com/en-us/kb/156276)
> 
> Alternatively start the batch file with [pushd](pushd.html) "%~dp0"  
> That will change directory to your batch file location ([%0](syntax-args.html)), and for UNC paths it will auto-create a temporary drive map.  

Launching CMD/batch files from PowerShell
-----------------------------------------

> When calling CMD from PowerShell the --% operator can be used to control when $ symbols and quoted expressions will be interpreted/expanded by PowerShell:
> 
> cmd.exe **--%** /c dir "C:\financial $accounts\" /w
> 
> Anything to the left of --% will be expanded:
> 
> $folder = 'C:\financial $accounts\'  
> cmd.exe /c dir $folder **--%**/w

Inheritance
-----------

> A new CMD.exe session can be instantiated in several ways, explicitly starting a new CMD session from an existing CMD shell, CALLing a batch file or implicit instantiation caused by piping a command or running a [FOR /F](for_cmd.html) command.
> 
> In all these cases, only the [environment variable](syntax-variables.html) values are inherited by the new CMD session. Delayed expansion state, Command extension state and Echo state will all revert back to the default state based on the registry.  
> For more detail on inheritance and expansion see [this StackOverflow](https://stackoverflow.com/questions/8192318/why-does-delayed-expansion-fail-when-inside-a-piped-block-of-code) thread.

Command Extensions
------------------

> Disabling Command Extensions may affect the operation of CMD's [internal](syntax-internal.html) commands, and will also remove most [dynamic/volatile environment variables](syntax-variables.html) ( %CD% %DATE% %TIME% %RANDOM% %ERRORLEVEL% %CMDEXTVERSION% %CMDCMDLINE% %HIGHESTNUMANODENUMBER% )
> 
> Command Extensions are enabled by default.  
> This can be changed by setting a value in the registry: HKCU\Software\Microsoft\Command Processor\EnableExtensions  
> Command Extensions can also be turned on or off by running CMD /e:on or CMD /e:off  
> or run [SETLOCAL](setlocal.html) EnableExtensions (SetLocal will take precedence)
> 
> Forum thread: [Checking if command extensions are available](https://ss64.org/viewtopic.php?f=2&t=33).  
> StackOverflow: [Detail of the changes when disabling extensions](https://stackoverflow.com/q/71373925/1720814).

### Examples

Run a program and pass a Filename parameter:  
CMD /c write.exe c:\docs\sample.txt

Run a program and pass a Long Filename:  
CMD /c write.exe "c:\sample documents\sample.txt"

Spaces in Program Path:  
CMD /c ""c:\Program Files\Microsoft Office\Office\Winword.exe""

Spaces in Program Path + parameters:  
CMD /c ""c:\Program Files\demo.cmd"" Parameter1 Param2

Spaces in Program Path + parameters with spaces:  
CMD /k ""c:\batch files\demo.cmd" "Parameter 1 with space" "Parameter2 with space""  
  
CMD will strip the outer quotes if there is a double quote at the **start** and **end** so you can also cheat and write the above as:  
CMD /k @"c:\batch files\demo.cmd" "Parameter 1 with space" "Parameter2 with space"

Launch Demo1 and then Launch Demo2:  
CMD /c ""c:\Program Files\demo1.cmd" & "c:\Program Files\demo2.cmd""

“Those who can command themselves, command others” ~ Hazlitt

### Related commands

[CMD Shell](syntax-cmd.html) - Tips on working in the Windows CMD shell.  
[EXIT](exit.html) - Use this to close a CMD shell and return.  
[CALL](call.html) - Call one batch program from another.  
[START](start.html) - Run a program, command or batch file.  
[DOSKEY](doskey.html) - Edit command line, recall commands.  
[CMD Internal](syntax-internal.html) - Commands that are Internal to the CMD shell.  
[WT](wt.html) - Windows Terminal.  
[4NT](https://jpsoft.com/) - Terminal and Shell replacement for CMD.exe (not free).  
[Q156276](https://web.archive.org/web/20150110101407/https://support.microsoft.com/kb/156276) - Cmd does not support UNC names as the current directory.  
Equivalent PowerShell: You can run the CMD shell under PowerShell, Exit will return you to the PS prompt.  
Equivalent bash command (Linux): bash - run the bash shell (also csh, ksh, sh).



/. nt/cmdkey.html
========================================================

    CMDKEY - Windows CMD - SS64.com

CMDKEY.exe (Windows 2003+)
==========================

Create, list or delete stored user names, passwords or credentials.

Syntax

      cmdkey [{/add:_TargetName_|/generic:_TargetName_}]
         {/smartcard|/user:_UserName_ [/pass:Password]}
            [/delete{:_TargetName_|/ras}]
               /list:_TargetName_

Key:
    /add            Add a user name and password to the list.

    _TargetName_      The computer or domain name that this entry will be associated with.

    /generic        Add generic credentials to the list (used by [RDC](mstsc.html)).

    /smartcard      Retrieve the credential from a smart card.

    /user:_UserName_  The user or account name to store with this entry.
                   If UserName is not supplied, it will be requested.

    /pass:_Password_  The password to store with this entry. If Password is not supplied, it will be requested.

    /delete:        Delete a user name and password from the list.
                   If TargetName is specified, that entry will be deleted.
                   If /ras is specified, the stored remote access entry will be deleted.

    /list           Display the list of stored user names and credentials.
                   If _TargetName_ is not specified, all stored user names and credentials will be listed.

The credentials created by CMDKEY can also be created and edited in the GUI Control Panel ➞ Credential Manager

Credentials setup as type /generic:TERMSRV will be used by [Remote Desktop Connection](mstsc.html), so you will be able to connect as the given user without being prompted for a password. If the password is changed you will need to update the stored credential.

By default the credentials are stored in C:\users_username_\AppData\Roaming\Microsoft\Credentials\  
(around 400 bytes per credential)

If more than one smart card is found, cmdkey will prompt the user to specify which one to use.  
Once stored, passwords are not displayed by cmdkey.

### Examples

Display a list of stored user names and credentials:  
cmdkey /list

Add a generic TERMSRV credential for user PeteZ (on domain dom64) to access the computer Server64:  
cmdkey /generic:TERMSRV/_Server64_ /user:dom64\PeteZ /pass:p4g67hjyy23

Delete the stored TERMSRV credential for Server64:  
cmdkey /delete TERMSRV/Server64

Add a user name and password for user Kate to access computer Server64 with the password z5rd63hGtjH7:  
cmdkey /add:server64 /user:Kate /pass:z5rd63hGtjH7

Add a user name for user Kate to access computer Server64 and prompt for a password whenever Server64 is accessed:  
cmdkey /add:server64 /user:Kate

Delete the stored credential for Server64:  
cmdkey /delete:Server64

“The stupid neither forgive nor forget, the naive forgive and forget, the wise forgive but do not forget” ~ Thomas Szasz (The second sin)

### Related commands

[CIPHER](cipher.html) - Encrypt or Decrypt files/folders.



/. nt/color.html
========================================================

    Color - Foreground and Background colours - Windows CMD - SS64.com

COLOR
=====

Sets the default console foreground and background colours.

Syntax

      COLOR [_background_][_foreground_]

Colour attributes are specified by 2 of the following hex digits. There should be no space between the two color numbers.

Each digit can be any of the following values:

> 0 = Black  
> 8 = Gray  
>   
> 1 = Blue  
> 9 = Light Blue  
>   
> 2 = Green  
> A = Light Green  
>   
> 3 = Aqua  
> B = Light Aqua  
>   
> 4 = Red  
> C = Light Red  
>   
> 5 = Purple  
> D = Light Purple  
>   
> 6 = Yellow  
> E = Light Yellow  
>   
> 7 = White  
> F = Bright White

If no argument is given, COLOR restores the colour to what it was when CMD.EXE started.  
  
Colour values are assigned in the following order:  
  
The DefaultColor registry value.  
The [CMD](cmd.html) /T command line switch  
The current colour settings when cmd was launched  
  
The COLOR command sets ERRORLEVEL to 1 if an attempt is made to execute the COLOR command with a foreground and background colour that are the same.

The default terminal color is COLOR 07, white on black

The COLOR command will change the color of **all** the text in the window. To change the color of individual words/characters/paragraphs [ANSI color escapes](syntax-ansi.html) can be used. These are available in Windows [versions](ver.html) greater than 1511.

New default Color schemes
-------------------------

> In Windows 10 **clean-install** versions greater than build 16257 the [default colour scheme has been changed](https://devblogs.microsoft.com/commandline/updating-the-windows-console-colors/) to modernize the look of the Windows Console suitable for modern high-contrast LCD displays.  
>   
> Samples of the new colors can be found on the [ANSI color](syntax-ansi.html) page, you can also display them with [ColorTool.exe](https://github.com/Microsoft/Terminal/tree/main/src/tools/ColorTool) -c
> 
> If using ColorTool, you may want to [tinker with the new values](https://github.com/Microsoft/console/issues/23): "So up until very recently the console only supported 16 colours at a time. When the PowerShell team decided they wanted a very specific dark blue as the background colour, rather than altering the colour value for dark or light blue, they instead changed dark magenta to blue and used that as the background colour".

24 bit colors
-------------

> The new W10 Console also adds full 24-bit color support, this is primarily for Linux compatibility so the console properties page and the default Windows color mappings still use just 16 colors, there is [no plan](https://github.com/Microsoft/WSL/issues/1118) to add additional console colors to the Win32 API.
> 
> To take advantage of the new colors use [ColorTool.exe](https://github.com/Microsoft/Terminal/tree/main/src/tools/ColorTool) and install a theme, or use the VT100 sequences described [here](https://docs.microsoft.com/en-us/windows/console/console-virtual-terminal-sequences?redirectedfrom=MSDN#extended-colors).  
> When the VT100 sequences are used with a version of the Windows Console that supports 24-bit colors they will display the desired RGB color, older consoles will choose the nearest appropriate color from the existing 16 color table.

Errorlevels
-----------

> If the color was successfully changed [%ERRORLEVEL%](errorlevel.html) = 0  
> Background and foreground colors are the same (will fail) = 1  
> e.g. COLOR 00

COLOR is an [internal](syntax-internal.html) command.  
If [Command Extensions](cmd.html) are disabled, the COLOR command will not function.

### Examples

Set the color to White on Blue:

color 17

“How much more black could this be?" and the answer is "None...none more black” ~ Spinal Tap

### Related commands

[CMD](cmd.html) - Start a new CMD shell.  
[EXIT](exit.html) - Set a specific errorlevel.  
How-to: [Use ANSI colors in the terminal.](syntax-ansi.html)  
PowerShell: [Write-Host](../ps/write-host.html) - Write output to the screen (colour can be set for individual strings).  
[Colour codes](https://emw3.com/colour.html) - HTML/CSS.  
[Aaron Margosis](https://blogs.msdn.microsoft.com/aaron_margosis/2007/02/22/setting-color-for-all-cmd-shells-based-on-adminelevation-status/) - Change prompt colors for all Admin level prompts.  
[Paletton](https://paletton.com/) - Design colour themes.  
Equivalent bash command (Linux): [dircolors](../bash/dircolors.html) - Colour setup for 'ls'



/. nt/comp.html
========================================================

    Comp - Compare two files - Windows CMD - SS64.com

COMP.exe
========

Compare two files (or sets of files). Display items which do not match.

Syntax

      COMP [_pathname1_] [_pathname2_] [/D] [/A] [/L] [/N=_number_] [/C]

Key
    _pathname1_ The path and filename of the first file(s)  
    _pathname2_ The path and filename of the second file(s)  
    /D        Display differences in decimal format. (default)
    /A        Display differences in ASCII characters.  
    /L        Display line numbers for differences.

    /N=_number_ Compare only the first _number_ of lines in the file.

    /C        Do a Case insensitive string comparison

Running COMP with no parameters will result in a prompt for the 2 files and any options  
  
To compare sets of files, use wildcards in pathname1 and pathname2 parameters.  
  
When used with the /A option COMP is similar to the FC command but it displays the individual characters that differ between the files rather than the whole line.

To compare files of different sizes, use /N= to compare only the first _n_ lines (common portion of each file.)  
  
COMP will normally finish with a **Compare more files (Y/N)** prompt,  
to suppress this: ECHO n|COMP <options>

**Errorlevel**

COMP will return an [ErrorLevel](errorlevel.html) as follows:

> 0 Files are identical  
> 1 Files are different  
> 2 Cannot open one of the files or invalid arguments or invalid switch

“Shall I compare thee to a summer's day” ~ William Shakespeare

### Related commands

[FC](fc.html) - Compare two files and display any LINES which do not match.  
Equivalent PowerShell: [Compare-Object](../ps/compare-object.html) - Compare the properties of objects, e.g. compare content of files.  
Equivalent bash command (Linux): [cmp](../bash/cmp.html) - Compare two files.



/. nt/compact.html
========================================================

    Compact - Compress files - Windows CMD - SS64.com

COMPACT
=======

Display or alter the compression of files on NTFS partitions.

Syntax

      COMPACT [/C | /U] [/S[:_dir_]] [/A] [ /I] [/F] [/Q] [/EXE[:_algorithm_]]
         [/CompactOs[:_option_] [/WinDir:_dir_] [_filename_ [...]]

Key    
    /C        Compress the specified files.
             Directories will be marked so that files added afterward will be compressed.

    /U        Uncompress the specified files.
             Directories will be marked so that files added afterward will not be compressed.

    /S        Perform the specified operation on files in the given directory and all subdirectories.
             The default "_dir_" is the [current](cd.html) directory.

    /A        Display files with the hidden or system attributes. These files are omitted by default.

    /I        Continue performing the specified operation even after errors have occurred.
             By default, COMPACT will stop when an error is encountered.

    /F        Force the compress operation on all specified files, even those which are already
             compressed.  Already-compressed files are skipped by default.

    /Q        Report only the most essential information.

    /EXE      Use compression optimised for executable files which are read frequently and not modified,
             Supported _algorithms_ are:
               XPRESS4K (fastest) default
               XPRESS8K
               XPRESS16K
               LZX   (most compact)

    /CompactOs  Set or query the systems compression state.
             Supported _options_ are:
               query  - Query the systems compact state.
               always - Compress all OS binaries and set the system state to non-compact.
               never  - Uncompress all OS binaries and set the system state to compact which remains
                        unless an administrator changes it.

    /WinDir   Used with /CompactOs:query, when querying the offline OS. Specifies the directory where
             Windows is installed.

    _filename_  Specifies a pattern, file, or directory.

Used without parameters, COMPACT displays the compression state of the current directory and any files it contains.

You can use multiple filenames and wildcards. You must put spaces between multiple parameters.

“The truth includes all, and is compact just as much as space is compact" ~ Walt Whitman (_Leaves of Grass_)

### Related commands

[ATTRIB -](attrib.html) Change file attributes.  
[COMPRESS](compress.html) - Compress one or more files.  
[IEXPRESS](iexpress.html) - Create a self extracting ZIP file archive.  
[MAKECAB](makecab.html) - Create .CAB files.  
[TAR](tar.html) - Store, list or extract files in an archive.  
[Compress-Archive](../ps/compress-archive.html) - PowerShell.



/. nt/compress.html
========================================================

    Compress - Windows CMD - SS64.com

COMPRESS ([2003 Resource Kit](../links/windows.html))
=====================================================

Compress one or more files.

Syntax

      COMPRESS [-R] [-D] [-S] [ -Z | -ZX ] _Source Destination_

      COMPRESS -R [-D] [-S] [ -Z | -ZX ] _Source_ [_Destination_]

Key
    -R   Rename compressed files.

    -D   Update compressed files only if out of date.

    -S   Suppress copyright information.

    -ZX  LZX compression. This is default compression.  

    -Z   MS-ZIP compression.

 _Source_ Source file specification. Wildcards can be used.

_Destination_
        Destination file | path specification.
        Destination can be a directory.   

If _Source_ is multiple files and -r is not specified, _Destination_ must be a directory.

**Examples:**

COMPRESS demo.txt compressed.txt

COMPRESS -R *.*

COMPRESS -R *.exe *.dll compressed_dir

“In art, truth and reality begin when one no longer understands what one is doing or what one knows, and when there remains an energy that is all the stronger for being constrained, controlled and compressed” ~ Henri Matisse

### Related commands

[COMPACT](compact.html) - Compress files or folders on an NTFS partition.  
[IEXPRESS](iexpress.html) - Create a self extracting ZIP file archive.  
[MAKECAB](makecab.html) - Create .CAB files.  
[TAR](tar.html) - Store, list or extract files in an archive.  
[Compress-Archive](../ps/compress-archive.html) - PowerShell.  
[Zip a file](https://superuser.com/questions/110991/) - using only built-in Batch/VBS commands (Superuser.com)



/. nt/con.html
========================================================

    CON - Console input - Windows CMD - SS64.com

CON
===

CON (short for Console) is an input/output DEVICE, not a command.

Syntax

    Copy from the console to a new file:
      COPY CON filename.txt

    Type from the console to a new file:
      TYPE CON > Newfile.txt

    Type from the console to append to a file, if the file does not already exist it will be created:
      TYPE CON >> file.txt

    Copy a file to the console:
      COPY file.txt CON
    The console accepts this input and acts like \`TYPE file.txt\`

    Pass an Echo command as input to the console:
      Echo some text >CON
    Without context this may not look useful, but when used within a [redirected block](syntax-brackets.html),
    it allows one line to break out of the redirection and display on the screen:

  (
    Echo Start
    Echo Something happened >CON
    Echo end of demo
  ) >logfile.txt

After entering COPY CON or TYPE CON, type in the text required, note there is no prompt for this, then end the file by typing CTRL-Z, this will insert an EOF marker: [ASCII 0x1a](../ascii.html) (SUB).

When using COPY the CTRL-Z can be placed anywhere, but when using TYPE it is important that the CTRL-Z is only entered at the beginning of a new line, otherwise it will just be saved into the file and you will have two EOF markers in the same file.

Most basic text editors will stop reading after the first EOF marker.

Some commands e.g. CLS, do not work as expected when redirected to CON and will output extra control characters.

To read text from the console in PowerShell use the following function:

function copycon {  
[system.console]::in.readtoend()  
}

con is a [reserved filename](syntax-filenames.html#reserved).

A more advanced use of the console device is to redirect the console CON into FIND and then redirect the output from FIND into a file, this will make FIND discard any lines which do not contain the desired text. This can be useful for condensing large log files to return only the lines of interest.

### Examples

C:> FIND /i "Jones" <con > logfile.txt  
asdf  
asdf  
zz Jones 2  
asdf  
^Z  
  
C:> TYPE logfile.txt  
zz Jones 2

“One types the correct incantation on a keyboard, and a display screen comes to life, showing things that never were nor could be” ~ Fred Brooks (The Mythical Man-Month, 1975)

### Related commands

[COPY](copy.html) - Copy one or more files to another location.  
[CHOICE](choice.html) - Accept keyboard input to a batch file.  
[Redirection](syntax-redirection.html) - Spooling output to a file, piping input.  
Equivalent bash command (Linux): [read](../bash/read.html) - Read a line from standard input.



/. nt/convert.html
========================================================

    Convert FAT to NTFS - Windows CMD - SS64.com

CONVERT.exe
===========

Convert a FAT16 or a FAT32 DISK volume to NTFS.

Syntax

      convert [_Volume_] /fs:ntfs [/v] [/cvtarea:_FileName_] [/nosecurity] [/x]  
Key  
    _Volume_   The drive letter (followed by a colon), mount point,
            or volume name to convert to NTFS.

    /fs:ntfs Convert the volume to NTFS. Required.

    /v       Run convert in verbose mode, which displays all messages
            during the conversion process.

    /cvtarea:_FileName_
            Specifies that the Master File Table (MFT) and other NTFS metadata
            files are written to an existing, contiguous placeholder file.

            This file must be in the root directory of the file system to be converted.
            Use of the /cvtarea parameter can result in a less fragmented file system 
            after conversion.
            For best results, the size of this file should be 1 KB multiplied by the number of files
            and directories in the file system, although the convert utility accepts files of any size.
            
            Important You must create the placeholder file by using the [fsutil file createnew](fsutil.html) command
            prior to running convert. Convert does not create this file for you.
            Convert overwrites this file with NTFS metadata.
            After conversion, any unused space in this file is freed.

    /nosecurity
            The security settings on the converted files and directories allow access by all users.

    /x       Dismount the volume, if necessary, before it is converted.
            Any open handles to the volume will no longer be valid. 

    /?       Display help at the command prompt.

If convert cannot lock the drive (for example, the drive is the system volume or the current drive), you are given the option to convert the drive the next time you restart the computer. If you cannot restart the computer immediately to complete the conversion, plan a time to restart the computer and allow extra time for the conversion process to complete.

For volumes converted from FAT or FAT32 to NTFS:  
Due to existing disk usage, the MFT is created in a different location than on a volume originally formatted with NTFS, so volume performance might not be as good as on volumes originally formatted with NTFS. For optimal performance, consider recreating these volumes and formatting them with the NTFS file system. Volume conversion from FAT or FAT32 to NTFS leaves the files intact, but the volume might lack some performance benefits compared to volumes initially formatted with NTFS. For example, the MFT might become fragmented on converted volumes. In addition, on converted boot volumes, convert applies the same default security that is applied during Windows Setup.

### Examples

Convert the volume on drive E: to NTFS and display all messages during the conversion process:

C:> convert e: /fs:ntfs /v

"One resolution I have made, and try always to keep, is this: To rise above little things" ~ John Burroughs

### Related commands

[FSUTIL](fsutil.html) - File and Volume specific commands.



/. nt/copy.html
========================================================

    Copy files - Windows CMD - SS64.com

COPY
====

Copy one or more files to another location.

Syntax  
      COPY [_options_] [/A|/B] _source_ [/A|/B] [+ _source2_ [/A|/B]...] [_destination_ [/A|/B]]

      COPY _source1_ + _source2_.. _destination_ [_options_]

Key
    _source_  Pathname for the file or files to be copied.

    /A   ASCII text file, will copy up until the EOF marker.

    /B   Binary file copy, will copy all extended characters.
        A binary copy is the default unless merging multiple files.

    /D   Allow the destination file to be created decrypted.

    _destination_  Pathname for the new file(s).

    /V   [Verify](verify.html) that the destination file, once written, can be read.
        No comparison with the source files occurs. 

    /N   If at all possible, create only short filenames (8.3) in the destination.
        This option can help when copying between disks that are formatted differently
        e.g NTFS and VFAT, or when archiving data to an ISO9660 CDROM.

    /L   If _source_ is a symbolic link copy the link to the target
        instead of the actual file the source link points to.

    /Y   Suppress confirmation prompt, when overwriting files.

    /-Y  Enable confirmation prompt, when overwriting files.

    /Z   When this option is used, if the copy is interrupted part way through it will restart if possible
        and resume copying the remainder of the file on the next copy if /Z is used again.
        Also displays a '% complete' which counts up to 100%. 

    /?   Display help.

Combining files
---------------

> To combine files, specify a single file for the destination, but multiple files as the source. To specify more than one file use wildcards or list the files with a + in between each (file1+file2+file3).  
> When copying multiple files in this way the first file must exist or else the copy will fail, a workaround for this is:  
> COPY null + file1 + file2 dest1

Binary copies
-------------

> "COPY /B ... " will copy files in binary mode.
> 
> The /A and /B options can appear in multiple locations, with different meanings depending on location.  
> Before any _source_ - they will set the default mode for all _source_ and _destination_ files.  
> After a _source_ - they will set the mode for that _source_.  
> After the _destination_ - they will set the mode for the _destination_.

Copy from the console (accept user input)
-----------------------------------------

> COPY [CON](con.html) filename.txt  
> Then type the input text followed by ^Z (Control key & Z)

Prompt to overwrite destination file
------------------------------------

> The default action is to prompt on overwrite unless the command is being executed from within a batch script.  
> To force the overwriting of destination files use the COPYCMD environment variable:  
> SET COPYCMD=/Y

Errorlevels
-----------

> If the file(s) were successfully copied [%ERRORLEVEL%](errorlevel.html) = 0  
> If the file was not found or bad parameters given = 1

COPY will accept UNC pathnames.  
COPY is an [internal](syntax-internal.html) command.

### Examples

Copy a file in the current folder  
COPY source_file.doc newfile.doc  
  
Copy from a different folder/directory:  
COPY "C:\my work\some file.doc" "D:\New docs\newfile.doc"  
  
Specify the source only, with a wildcard will copy all the files into the current directory:  
COPY "C:\my work*.doc"  
  
Specify the source with a wildcard and the destination as a single file, this is generally only useful with plain text files.  
COPY "C:\my work*.txt" "D:\New docs\combined.txt"  
  
Create an empty (zero byte) file:  
COPY NUL EmptyFile.txt

Quiet copy (no feedback on screen)  
COPY source_file.doc newfile.doc >nul

Copy a file, but do not overwrite if the destination file already exists, this technique only works for a single file, no wildcards:

Echo n|COPY /-y c:\demo\source_file.txt c:\dir\dest.txt

“Success seems to be connected with action. Successful men keep moving. They make mistakes, but they don’t quit” ~ Conrad Hilton

### Related commands

[ROBOCOPY](robocopy.html) - Robust File and Folder Copy.  
[XCOPY](xcopy.html) - Copy files and folders.  
[MOVE](move.html) - Move a file from one folder to another.  
[Q126457](https://web.archive.org/web/20150621032628/https://support.microsoft.com/en-us/kb/126457) - VERIFY ON, COPY /V, XCOPY /V commands do not compare data.  
PowerShell equivalent: [Copy-Item](../ps/copy-item.html) - Copy an item from one location to another.  
Equivalent bash command (Linux): [cp](../bash/cp.html) - Copy one or more files to another location.



/. nt/coreinfo.html
========================================================

    COREINFO - Windows CMD - SS64.com

COREINFO ([Sysinternals](https://docs.microsoft.com/en-gb/sysinternals/downloads/sysinternals-suite))
=====================================================================================================

Show the mapping between logical processors and the physical processor, NUMA node, and socket on which they reside.

Syntax

      coreinfo [-c][-f][-g][-l][-n][-s][-m][-v] -c

Key:

    -c   Dump information on cores.
    -f   Dump core feature information.
    -g   Dump information on groups.
    -l   Dump information on caches.
    -n   Dump information on NUMA nodes.
    -s   Dump information on sockets.
    -m   Dump NUMA access cost.
    -v   Dump only virtualization-related features including support
        for second level address translation.
        (requires administrative rights on Intel systems).  

All options except -v are selected by default.

### Examples

Drop all the coreinfo data into a text file:

coreinfo.exe > coreinfo.txt

“Sing then the core of dark and absolute oblivion where the soul at last is lost in utter peace” ~ D.H. Lawrence

### Related commands

[PsInfo](psinfo.html) - List information about a system.  
[wmic cpu](wmic.html) get NumberOfCores.



/. nt/csccmd.html
========================================================

    CSCcmd - Windows CMD - SS64.com

CSCcmd - Client-side Caching command ([Q884739](https://docs.microsoft.com/en-us/troubleshoot/windows-client/networking/client-side-caching-command-line-options-v1dot1) - [Non Microsoft mirror](https://www.mountsutro.org/2006/07/16/381/))
==============================================================================================================================================================================================================================================

Run this utility on a client PC to configure offline files. Offline files (CSC) allow the client PC to access copies of network files while disconnected from the network/domain. Files can be synchronized with the network when connected.

Syntax

      CSCCMD _Options_

Options:
    /ENABLE    Enable Client-Side Caching (CSC) on this client. 
              Requires Local Administrator rights.

    /DISABLE   Disable CSC, ensure all offline files are closed first.

    /Enum[: \_Server__Share_ [_Path_]] [/RECURSE] 
              Display all the shares in the local cache.
              With the /RECURSE option, this will display the contents
              of the shares within a parent share.

    /DISCONNECT:\_Server_
    /DISCONNECT:\_Server__Share_ 
              Disconnect a server or share from CSC on this client. 

    /MOVESHARE:\_Server1__Share_ \_Server2__Share_ 
              Move files and folders from one share to another in the cache.
              This is useful if the local cache must point to a new/renamed server location.

    /RESID     Restamp all the entries in the Windows offline files (CSC) database
              with a new user security identifier (SID).
              useful when moving user accounts from an NT 4.0 domain to 2003.

    /ISENABLED Is CSC is enabled on this client PC. (synonym: /ISCSCENABLED) 

    /PIN2:\_server__share__path_ [/USER] [/SYSTEM] [/USERINHERIT] [/SYSTEMINHERIT]
              Pin shared resources:
              Use the PIN2: /USER option to pin a file. This has the same result
              as using the Offline Files dialog box to cache the file.
              Use PIN2: /SYSTEM to specify that the share will be pinned via Group Policy.
              /USERINHERIT and /SYSTEMINHERIT] will determine how the pin data is inherited.

    /PIN2:_filename_ /FILELIST [/UNICODE] [/USER] [/SYSTEM] [/USERINHERIT] [/SYSTEMINHERIT] 
              Use a file to describe the objects to pin
              The file contains the UNC path of each object to pin.
              /FILELIST = the objects are separated by a carriage return/linefeed.

    /UNPIN2:\_server__share__path_ [/USER] [/SYSTEM] [/USERINHERIT] [/SYSTEMINHERIT] [/RECURSE] 
              UnPin a shared resource or remove a shared resource from the local cache.
              with /RECURSE, CSCCMD will unpin all children of the path.
              with /RECURSE2, CSCCMD will unpin the path and children of the path.

    /UNPIN2:_filename_ /FILELIST [/UNICODE] [/USER] [/SYSTEM] [/USERINHERIT] [/SYSTEMINHERIT]
              UnPin specific shared resources listed in _filename_. 
              /FILELIST = the objects are separated by a carriage return/linefeed.

    /FILL:\_Server__Share__Path_ 
              Copy server-side data to the local cache.

    /FILL:_FileName_ /FILELIST [/UNICODE] 
              Copy server-side data to the local cache using a file.

    /DELETE:\_Server__Share__Path_ [/RECURSE] [/RECURSE2] 
              Delete a file, a directory, or a share from the local cache.
              Ensure that the directory/share is empty before you use this switch.
              with /RECURSE, CSCCMD tool only operates on the children of the path.
              with /RECURSE2, CSCCMD operates on the path and children of the path.

    /ISSERVEROFFLINE:\_Server_ 
              Does CSC consider \_server_ to be offline.
              To get a reliable response from this switch, you must first open a
              share/file/directory from the local cache for \_server _ 

    /SETSPACE:_Bytes_  
              Specify the disk space in bytes to allocate to temporary offline files.
              These files are nonpinned, auto-cached files.
              This is similar to the function provided in the Offline Files dialog box.

    /CHECKDB [/QUICK] 
              Examine the CSC database and display any database error flags.
              /QUICK will skip the enumeration and just display database errors.

    /EXTRACT[:\_Server__Share_[_Path_]] /TARGET:_Path_ [/RECURSE] [/ONLYMODIFIED] [/STOPONERROR]
              Extract a file, a directory, or a directory tree from the local cache. 
              This requires Local Administrator permissions
              /TARGET will specify a destination.(which need not already exist)
              /ONLYMODIFIED, extract only files that have been modified offline.
              /STOPONERROR, stop the extract if an error occurs.

Offline files are most often used with laptops to provide access to data when on the move. Folder redirection can be setup to place the users **My Documents** on a server share, and then Offline Files can be set to copy and cache the data to the laptops C: drive.  
This arrangement allows faster synchronisation of files than a full roaming profile (which also synchronises other things you probably don’t need on a laptop.)

The /PIN2 switch does not copy the content of the shared resource into the local cache. Pinning is not sufficient to make the files available offline. After you use the /PIN2 switch, you must run CSCCMD /FILL to copy the content of the shared resource to the local cache.

When using FILELIST, any white space at the start of a file is ignored.  
With the /UNICODE option, CSCCMD will create or read a file list in Unicode text format.

To view Offline files: My Computer ➞ Tools ➞ Folder Options ➞ Offline files Tab ➞ View files…

CSC is available for Windows 2000/XP/2003.

**Examples**

Move a server share:  
csccmd /MOVESHARE:\oldserver\share \newserver\share  
csccmd /RESID

“I think the laptop is very good. It helps us to find some words, like our teacher will teach us... The things we didn’t know, we go check on the laptop” - One Laptop per child project, Abuja, Nigeria

### Related commands

[Q252509](https://web.archive.org/web/20150228064819/https://support.microsoft.com/kb/252509) - PST and MDB files cannot be made available offline.  
[Q884739](https://support.microsoft.com/en-us/help/884739/) - CSCcmd Version 1.1  
mobsync /logon - Synchronization Manager.



/. nt/csvde.html
========================================================

    CSVDE and LDIFDE - Windows CMD - SS64.com

CSVDE / LDIFDE (installable option via [RSAT](../links/windows.html) /AD DS)
============================================================================

Import or Export Active Directory data to a file. The syntax of these two commands is identical, the difference being that one works with CSV files and one with LDIF files.

Syntax


    Export to file:
             CSVDE [-f _FileName_] [_options_]
            LDIFDE [-f _FileName_] [_options_]  
    Import from File:
             CSVDE **-i** [-f _FileName_] [_options_]
            LDIFDE **-i** [-f _FileName_] [_options_]
Key
     -f  _Filename_     Input or Output filename
     -s  _servername_   The server to bind to
     -c  _FromDN ToDN_  Replace occurrences of _FromDN_ to _ToDN_
     -v               Verbose
     -j  _Path _        Folder to store log files
     -t  _Port_Number_  (default = 389)
     -?               Help

Export options
     -d _RootDN_        The root of the LDAP search (Default to Naming Context)
     -r _Filter_        [LDAP search](../ps/syntax-ldap.html) filter (Default to "(objectClass=*)")
     -p _SearchScope_   Search Scope (Base/OneLevel/Subtree)
     -l _list_          Attributes to look for in an **L**DAP search
                      (comma separated List)
     -o _list_          Attributes  to **o**mit from input
                      (comma separated list)
     -g               Disable Paged Search
     -m               Enable the SAM logic on export
     -n               Do not export binary values
  
 Import options
     -k               Ignore 'Constraint Violation' and 'Object Already Exists' errors.

                      To successfully import a file it must contain as a minimum:
                      The DN(distinguished name), DisplayName and ObjectClass

Username/Password credentials
     -a      Set the command to run using the supplied user distinguished name
             and password. For example: "cn=yourname,dc=yourcompany,dc-com password"

     -b      Set the command to run as username domain/password.

     The default is to run using the credentials of the currently logged on user.

CSV (comma-separated value) format files can be read with MS Excel and are easily modified with a batch script.  
LDIF files (Ldap Data Interchange Format) are a cross-platform standard. This provides a method to populate Active Directory with data from other directory services. (e.g. Oracle Directory Server, [eDirectory](https://www.netiq.com/products/edirectory/))

**Passwords  
**For security reasons neither of these tools will export passwords. When you import an account it is given a null password, if the domain has a password length policy, then the account will be disabled (You can [re-enable accounts in bulk with a script](https://www.computerperformance.co.uk/ezine/ezine23/))

### Examples

Export the whole domain  
CSVDE -f MyDomain.csv  
  
Export a single OU:  
CSVDE -d "OU=NewYork,DC=SS64,DC=com" -f C:\Demo\exportOU.csv

Export all users with a particular surname:  
CSVDE -f MyUsers.csv -r (and(objectClass=User)(sn=_Surname_))

Import the whole domain and create C:\MyLogfiles\csv.log and C:\MyLogfiles\csv.err  
CSVDE -i -f MyDomain.csv -j C:\MyLogfiles\

“Give me your tired, your poor, Your huddled masses yearning to breathe free,  
The wretched refuse of your teeming shore.  
Send these, the homeless, tempest-tossed to me, I lift my lamp beside the golden door!” ~ Emma Lazarus

### Related commands

[Q327620](https://web.archive.org/web/20050322224525/https://support.microsoft.com/?id=327620) - Import contacts and users with CSVDE.  
[Q263991](https://support.microsoft.com/en-us/help/263991/) - How to set a user's password with Ldifde.  
PowerShell equivalent: [New-AdUser](../ps/new-aduser.html)  
Equivalent bash command (Linux): ldapadd - Add LDAP information.



/. nt/curl.html
========================================================

    CURL - Windows CMD - SS64.com

CURL.exe
========

Transfer data from or to a server, using one of the supported protocols (HTTP, HTTPS, FTP, FTPS, SCP, SFTP, TFTP, DICT, TELNET, LDAP or FILE). CURL was added to Windows 10 (1803) from build [17063](ver.html) or later.

Syntax

      curl [_options_...] _url_

Options:
These options are 'Case Sensitive' which is typical for Unix utilities but unusual for Microsoft Windows.

     --abstract-unix-socket _path_ Connect via abstract Unix domain socket
     --anyauth       Pick any authentication method
 -a, --append        Append to target file when uploading
     --basic         Use HTTP Basic Authentication
 -A, --user-agent _name_  Send User-Agent _name_ to server
     --cacert _CA certificate_ CA certificate to verify peer against
     --capath _dir_    CA directory to verify peer against
 -B, --use-ascii     Use ASCII/text transfer
 -E, --cert _certificate[:password]_ Client certificate file and password
     --cert-status   Verify the status of the server certificate
     --cert-type _type_ Certificate file type (DER/PEM/ENG)
     --ciphers  SSL ciphers to use
     --compressed    Request compressed response
 -K, --config _file_   Read config from a file
     --connect-timeout _seconds_  Maximum time allowed for connection
     --connect-to _HOST1:PORT1:HOST2:PORT2_  Connect to host
 -C, --continue-at _offset_  Resumed transfer offset
 -b, --cookie _data_   Send cookies from string/file
 -c, --cookie-jar _filename_  Write cookies to _filename_ after operation
     --create-dirs   Create necessary local directory hierarchy
     --crlf          Convert LF to CRLF in upload
     --crlfile _file_    Get a CRL list in PEM format from the given file
 -d, --data _data_       HTTP POST data
     --data-ascii _data_ HTTP POST ASCII data
     --data-binary _data_ HTTP POST binary data
     --data-raw _data_   HTTP POST data, '@' allowed
     --data-urlencode _data_  HTTP POST data url encoded
     --delegation _LEVEL_   GSS-API delegation permission
     --digest        Use HTTP Digest Authentication
 -q, --disable       Disable .curlrc
     --disable-eprt  Inhibit using EPRT or LPRT
     --disable-epsv  Inhibit using EPSV
     --dns-interface _interface_ Interface to use for DNS requests
     --dns-ipv4-addr _address_   IPv4 address to use for DNS requests
     --dns-ipv6-addr _address_   IPv6 address to use for DNS requests
     --dns-servers _addresses_   DNS server addrs to use
 -D, --dump-header _filename_    Write the received headers to _filename_
     --egd-file _file_   EGD socket path for random data
     --engine _name_   Crypto engine to use
     --expect100-timeout _seconds_  How long to wait for 100-continue
 -f, --fail          Fail silently (no output at all) on HTTP errors
     --fail-early    Fail on first transfer error, do not continue
     --false-start   Enable TLS False Start
 -F, --form _name=content_  Specify HTTP multipart POST data
     --form-string _name=string_  Specify HTTP multipart POST data
     --ftp-account _data_  Account data string
     --ftp-alternative-to-user _command_  String to replace USER [name]
     --ftp-create-dirs  Create the remote dirs if not present
     --ftp-method _method_  Control CWD usage
     --ftp-pasv         Use PASV/EPSV instead of PORT
 -P, --ftp-port _address_  Use PORT instead of PASV
     --ftp-pret         Send PRET before PASV
     --ftp-skip-pasv-ip  Skip the IP address for PASV
     --ftp-ssl-ccc      Send CCC after authenticating
     --ftp-ssl-ccc-mode _active/passive_  Set CCC mode
     --ftp-ssl-control  Require SSL/TLS for FTP login, clear for transfer
 -G, --get              Put the post data in the URL and use GET
 -g, --globoff       Disable URL sequences and ranges using {} and []
 -I, --head          Show document info only
 -H, --header _header/@file_ Pass custom header(s) to server
 -h, --help          This help text
     --hostpubmd5 _md5_  Acceptable MD5 hash of the host public key
 -0, --http1.0       Use HTTP 1.0
     --http1.1       Use HTTP 1.1
     --http2         Use HTTP 2
     --http2-prior-knowledge  Use HTTP 2 without HTTP/1.1 Upgrade
     --ignore-content-length  Ignore the size of the remote resource
 -i, --include       Include protocol response headers in the output
 -k, --insecure      Allow insecure server connections when using SSL
     --interface _name_  Use network INTERFACE (or address)
 -4, --ipv4          Resolve names to IPv4 addresses
 -6, --ipv6          Resolve names to IPv6 addresses
 -j, --junk-session-cookies  Ignore session cookies read from file
     --keepalive-time _seconds_ Interval time for keepalive probes
     --key _key_      Private key file name
     --key-type _type_  Private key file type (DER/PEM/ENG)
     --krb _level_    Enable Kerberos with security _level_
     --libcurl _file_  Dump libcurl equivalent code of this command line
     --limit-rate _speed_  Limit transfer speed to RATE
 -l, --list-only     List only mode
     --local-port _num/range_  Force use of RANGE for local port numbers
 -L, --location      Follow redirects
     --location-trusted  Like --location, and send auth to other hosts
     --login-options _options_  Server login options
     --mail-auth _address_  Originator address of the original email
     --mail-from _address_  Mail from this address
     --mail-rcpt _address_  Mail from this address
 -M, --manual         Display the full manual
     --max-filesize _bytes_  Maximum file size to download
     --max-redirs _num_  Maximum number of redirects allowed
 -m, --max-time _time_   Maximum time allowed for the transfer
     --metalink        Process given URLs as metalink XML file
     --negotiate       Use HTTP Negotiate (SPNEGO) authentication
 -n, --netrc           Must read .netrc for user name and password
     --netrc-file _filename_  Specify FILE for netrc
     --netrc-optional Use either .netrc or URL
 -:, --next           Make next URL use its separate set of options
     --no-alpn        Disable the ALPN TLS extension
 -N, --no-buffer      Disable buffering of the output stream
     --no-keepalive   Disable TCP keepalive on the connection
     --no-npn         Disable the NPN TLS extension
     --no-sessionid   Disable SSL session-ID reusing
     --noproxy _no-proxy-list_  List of hosts which do not use proxy
     --ntlm          Use HTTP NTLM authentication
     --ntlm-wb       Use HTTP NTLM authentication with winbind
     --oauth2-bearer _token_  OAuth 2 Bearer Token
 -o, --output _file_   Write to file instead of stdout
     --pass _phrase_   Pass phrase for the private key
     --path-as-is    Do not squash .. sequences in URL path
     --pinnedpubkey _hashes_ FILE/HASHES  Public key to verify peer against
     --post301       Do not switch to GET after following a 301
     --post302       Do not switch to GET after following a 302
     --post303       Do not switch to GET after following a 303
     --preproxy [protocol://]host[:port]  Use this proxy first
 -#, --progress-bar  Display transfer progress as a bar
     --proto _protocols_  Enable/disable PROTOCOLS
     --proto-default _protocol_  Use PROTOCOL for any URL missing a scheme
     --proto-redir _protocols_  Enable/disable PROTOCOLS on redirect
 -x, --proxy [protocol://]host[:port]  Use this proxy
     --proxy-anyauth      Pick any proxy authentication method
     --proxy-basic        Use Basic authentication on the proxy
     --proxy-cacert _file_  CA certificate to verify peer against for proxy
     --proxy-capath _dir_   CA directory to verify peer against for proxy
     --proxy-cert _cert[:passwd]_  Set client certificate for proxy
     --proxy-cert-type _type_  Client certificate type for HTTS proxy
     --proxy-ciphers _list_  SSL ciphers to use for proxy
     --proxy-crlfile _file_  Set a CRL list for proxy
     --proxy-digest        Use Digest authentication on the proxy
     --proxy-header _header/@file_  Pass custom header(s) to proxy
     --proxy-insecure      Do HTTPS proxy connections without verifying the proxy
     --proxy-key _key_       Private key for HTTPS proxy
     --proxy-key-type _type_ Private key file type for proxy
     --proxy-negotiate     Use HTTP Negotiate (SPNEGO) authentication on the proxy
     --proxy-ntlm          Use NTLM authentication on the proxy
     --proxy-pass _phrase_   Pass phrase for the private key for HTTPS proxy
     --proxy-service-name _name_  SPNEGO proxy service name
     --proxy-ssl-allow-beast  Allow security flaw for interop for HTTPS proxy
     --proxy-tlsauthtype _type_  TLS authentication type for HTTPS proxy
     --proxy-tlspassword _string_  TLS password for HTTPS proxy
     --proxy-tlsuser _name_  TLS username for HTTPS proxy
     --proxy-tlsv1       Use TLSv1 for HTTPS proxy
 -U, --proxy-user _user:password_  Proxy user and password
     --proxy1.0 _host[:port]_  Use HTTP/1.0 proxy on given port
 -p, --proxytunnel       Operate through a HTTP proxy tunnel (using CONNECT)
     --pubkey _key_        SSH Public key file name
 -Q, --quote             Send command(s) to server before transfer
     --random-file _file_  File for reading random data from
 -r, --range _range_       Retrieve only the bytes within RANGE
     --raw               Do HTTP "raw"; no transfer decoding
 -e, --referer _URL_       Referrer URL
 -J, --remote-header-name  Use the header-provided filename
 -O, --remote-name       Write output to a file named as the remote file
     --remote-name-all   Use the remote file name for all URLs
 -R, --remote-time       Set the remote file's time on the local output
 -X, --request _command_   Specify request command to use
     --request-target    Specify the target for this request
     --resolve _host:port:address_  Resolve the host+port to this address
     --retry _num_         Retry request if transient problems occur
     --retry-connrefused Retry on connection refused (use with --retry)
     --retry-delay _seconds_  Wait time between retries
     --retry-max-time _seconds_  Retry only within this period
     --sasl-ir           Enable initial response in SASL authentication
     --service-name _name_  SPNEGO service name
 -S, --show-error        Show error even when -s is used
 -s, --silent            Silent mode
     --socks4 _host[:port]_  SOCKS4 proxy on given host + port
     --socks4a _host[:port]_ SOCKS4a proxy on given host + port
     --socks5 _host[:port]_  SOCKS5 proxy on given host + port
     --socks5-basic       Enable username/password auth for SOCKS5 proxies
     --socks5-gssapi      Enable GSS-API auth for SOCKS5 proxies
     --socks5-gssapi-nec  Compatibility with NEC SOCKS5 server
     --socks5-gssapi-service _name_  SOCKS5 proxy service name for GSS-API
     --socks5-hostname _host[:port]_  SOCKS5 proxy, pass host name to proxy
 -Y, --speed-limit _speed_  Stop transfers slower than this
 -y, --speed-time _seconds_ Trigger 'speed-limit' abort after this time
     --ssl                Try SSL/TLS
     --ssl-allow-beast    Allow security flaw to improve interop
     --ssl-no-revoke   Disable cert revocation checks (WinSSL)
     --ssl-reqd        Require SSL/TLS
 -2, --sslv2           Use SSLv2
 -3, --sslv3           Use SSLv3
     --stderr          Where to redirect stderr
     --suppress-connect-headers  Suppress proxy CONNECT response headers
     --tcp-fastopen    Use TCP Fast Open
     --tcp-nodelay     Use the TCP_NODELAY option
 -t, --telnet-option _opt=val_  Set telnet option
     --tftp-blksize _value_     Set TFTP BLKSIZE option
     --tftp-no-options   Do not send any TFTP options
 -z, --time-cond _time_    Transfer based on a time condition
     --tls-max _VERSION_   Use TLSv1.0 or greater
     --tlsauthtype _type_  TLS authentication type
     --tlspassword       TLS password
     --tlsuser _name_      TLS user name
 -1, --tlsv1         Use TLSv1.0 or greater
     --tlsv1.0       Use TLSv1.0
     --tlsv1.1       Use TLSv1.1
     --tlsv1.2       Use TLSv1.2
     --tlsv1.3       Use TLSv1.3
     --tr-encoding   Request compressed transfer encoding
     --trace _file_    Write a debug trace to FILE
     --trace-ascii _file_  Like --trace, but without hex output
     --trace-time    Add time stamps to trace/verbose output
     --unix-socket _path_  Connect through this Unix domain socket
 -T, --upload-file _file_  Transfer local FILE to destination
     --url _url_       URL to work with
 -B, --use-ascii     Use ASCII/text transfer
 -u, --user _user:password_  Server user and password
 -A, --user-agent _name_  Send User-Agent _name_ to server
 -v, --verbose       Make the operation more talkative
 -V, --version       Show version number and quit
 -w, --write-out _format_  Use output FORMAT after completion
     --xattr         Store metadata in extended file attributes

The curl command is designed to work without user interaction.  
curl is a powerful tool, please use it [responsibly](https://stackoverflow.com/questions/13314123/curl-and-ddos-problems).

### Examples

The example.com domain is used for these examples, it contains simple demonstration text and allows both HTTP and HTTPS connections.

Retrieve a web page, display the status code and all the raw content of the page:

C:> curl https://example.com
StatusCode        : 200
StatusDescription : OK
Content           : <!doctype html>
                    <html>...

Retrieve a web page, display the status code and header information only:

C:> curl -I https://example.com
HTTP /1.1 200 OK
Content-Encoding: gzip
...

Retrieve a web page, passing a specific User-Agent HTTP header (some websites use this to sniff the browser used):

C:> curl -A "Mozilla FireFox(72.0)" https://example.com

Download the home page of example.com as a file (testing.html):

C:> curl -o C:\demo\testing.html https://example.com/

Retrieve a file listing from an FTP server (null password):

C:> curl ftp://anonymous@speedtest.tele2.net

_“Let us curl, my lady. Let us throw and sweep between until the heavens themselves droop their jaws in wonder and envy” - Homer Simpson (Boy Meets Curl)_

### Related commands

KB5025221 - update to curl.exe April 2023.  
[FTP](ftp.html) - File Transfer Protocol.  
[SSH](ssh.html) - OpenSSH remote login client.  
[Curl project downloads](https://curl.se/download.html) - Official source which may be more up to date than other packaged copies.



/. nt/date.html
========================================================

    Date - Display or change date - Windows CMD - SS64.com

DATE
====

Display or change the date.

Syntax


to display the date   
      DATE /T

to set the system date
      DATE
or
      DATE <_date_today_>

The default output from DATE /T in the United States is "1/23/1997" but this is dependent on the country/locale.  
The default short date and time formats for a selection of countries are as follows:

 **Country/language  CountryCode [Locale](../locale.html) Date_format  Time_format**
  
    Argentina-Spanish     054   2C0A   23/01/1997   9:45:30 am
    Australia             061   0C09   23/01/1997   9:45:30 AM
    Austria               043   0C07   23.01.1997  **09**:45:30
    Brazil-Portuguese     055   0416   23/01/1997  **09**:45:30
    Belgium-French        032   080C   23/01/1997  **09**:45:30
    Belgium-Dutch         032   0813   23/01/1997   **9**:45:30
    Canada-French         002   0C0C   1997-01-23  **09**:45:30
    Canada-English        002   1009   01/23/1997   9:45:30 AM
    China/PRC-Chinese     086   0804   1997/1/23    **9**:45:30
    China/HK-Chinese Trad 852   0C04   23/1/1997    **9**:45:30
    Czech Republic        042   0405   23.1.1997    **9**:45:30 
    Denmark               045   0406   23-01-1997  **09**.45.30
    Finland               358   040B   23.1.1997    **9**:45:00
    France                033   040C   23/01/1997  **09**:45:30
    Germany               049   0407   23.01.1997  **09**:45:30
    Greece                030   0408   23/01/1997   9:45:30 μμ
    Hungary               036   040E   1997.01.23.  **9**:45:30 
    India-Hindi           091   0439   23-01-1997  **09**:45:30
    India-Bengali         091   0445   23-01-97    **09**.35.00 
    India-Telugu          091   044A   23-01-97    **09**:45:30 
    Italy                 039   0410   23/01/1997  **09**.45.30 
    Japan                 081   0411   1997/01/23   **9**:45:30
    Netherlands           031   0413   23-01-1997   **9**:45:30 
    Norway                047   0414   23.01.1997  **09**:45:30 
    Poland                048   0415   1997-01-23  **09**:45:30 
    Portugal              351   0816   23-01-1997  **09**:45:30 
    Spain                 034   0C0A   23/01/1997   **9**:45:30 
    Sweden                046   041D   1997-01-23  **09**.45.30
    Switzerland-French    041   100C   23.01.1997  **09**:45:30
    Switzerland-German    041   0807   23.01.1997  **09**:45:30
    Switzerland-Italian   041   0810   23.01.1997  **09**:45:30
    United Kingdom        044   0809   23/01/1997  **09**:45:30
    United States         001   0409   1/23/1997    9:45:30 AM

                                      **Bold** = 24 hour time

Prior to the year 2000, the default short date format for many countries used a 2 digit year.

Other date and time formats
---------------------------

> The dates and time above are only _default_ settings, in the Control Panel users can change the date and time format including the date separator, 12/24 hour time and leading/trailing characters. Take care not make cultural assumptions about the users chosen date or time format.
> 
> The ISO standard [8601](../dates.html) defines a date and time format that can be used internationally: YYYY-MM-DD to avoid the confusion that is often caused by differences in language and local custom. ISO 8601 also recommends that 24 hour times have a leading zero (09:45), but not all countries follow this convention.

Errorlevels
-----------

> If the Date was successfully changed (or not given) [%ERRORLEVEL%](errorlevel.html) = 0  
> If the user lacks admin privileges = 1

Date Formats in the registry
----------------------------

> Short Date Format  
> HKCU\Control Panel\International\sShortDate
> 
> Date Separator  
> HKCU\Control Panel\International\sDate
> 
> Country Code  
> HKCU\Control Panel\International\iCountry  
> 
> Locale  
> HKCU\Control Panel\International\Locale  

DATE is an [internal](syntax-internal.html) command. In early versions of Windows, disabling [Command Extensions](cmd.html) will disable the /T switch.

_“Carpe Diem - Seize the day” ~ Horace_

### Related commands

%DATE% - [variable](syntax-variables.html) containing current Date.  
[GetDate.cmd](syntax-getdate.html) - Get todays Date (any region, any OS)  
[datetime.vbs](../vb/syntax-getdatetime.html) - Get Date, Time and daylight savings (VB Script).  
[GetLocale](../vb/getlocale.html) - VBScript.  
[NOW](now.html) - Display Message with Current Date and Time.  
[NET](net.html) TIME - Display the Date in US Format (mm-dd-yy).  
[REG](reg.html) - Read, Set or Delete registry keys and values.  
[TIME](time.html) - Display or set the system time.  
[TOUCH](touch.html) - Change file timestamps.  
[National Language Support Reference](https://web.archive.org/web/20140204035919/https://www.microsoft.com/resources/msdn/goglobal/default.mspx).  
PowerShell: [Set-ADUser -Country](../ps/set-aduser.html) - Change a users Country Code and other settings.  
PowerShell: [Set-Date](../ps/set-date.html) - Change the computer system time.  
Equivalent bash command (Linux): [date](../bash/date.html) - Display or change the date.



/. nt/defrag.html
========================================================

    Defrag - Defragment hard drive - Windows CMD - SS64.com

DEFRAG.exe (Windows 10/ Server 2012/ 2012R2/ 2016)
==================================================

Defragment hard drive volumes.

Syntax

      Perform analysis only:
      DEFRAG_s_ **/A**  _vol_to_defrag_ [_Options_]

      Defragment (default operation)
      DEFRAG [**/D**] _vol_to_defrag_ [_Options_]

      Perform the proper optimization for each media type:
      DEFRAG **/O** _vol_to_defrag_ [_Options_]

      Perform free space consolidation:
      DEFRAG **/X** _vol_to_defrag_ [_Options_]

      Track an operation already in progress on a volume:
      DEFRAG **/T** _volume_

_vol_to_defrag_:

    This can be any of:
  
    _volume_  The drive letter or mount point path of the volume(s) to be defragmented or analyzed.
            To specify multiple volumes separate the names with spaces.
    /C      Perform the operation on _all_ volumes.
    /E _volume_name(s)_   Perform the operation on _all_ volumes Except those specified.

Options:
    /G      Optimize the storage tiers on the specified volumes.
    /H      Run the operation at normal priority (default is low).
    /I _n_    Run Tier optimization for at most _n_ seconds on each volume.
    /K      Perform slab consolidation on the specified volumes.
    /L      Perform retrim on the specified volumes.
    /M [_n_]  Run the operation on each volume in parallel in the background.
                At most _n_ threads optimize the storage tiers in parallel.
    /U      Print the progress of the operation on the screen.
    /V      Print verbose output containing the fragmentation statistics.

Defrag has an undocumented option/b (boot optimisation) which will clear out the Windows\Prefetch directory. Deleting prefetch files will make the machine [boot more slowly](https://blogs.msdn.microsoft.com/ryanmy/2005/05/25/misinformation-and-the-the-prefetch-flag/) so this is not recommended.

A volume must have at least 15% free space for defrag to completely and adequately defragment it. defrag uses this space as a sorting area for file fragments.

Supported file systems: NTFS, ReFS, Fat or Fat32.

To run Defrag, you must be a member of the Administrators group on the local computer, or have been delegated the appropriate authority. When working defrag will display a blinking cursor.

On a tiered volume traditional defrag (/D) is performed only on the Capacity tier. (See [FSUTIL tiering](fsutil.html))

Some file system volumes or drives cannot be defragmented:

*   Volumes that the file system has locked.
*   Volumes that the file system has marked as dirty, which indicates possible corruption. Run [CHKDSK](chkdsk.html) on a dirty volume to resolve this.  
    Use the [fsutil dirty query](fsutil.html) command to determine if a volume is dirty.

Volume names can be given either using the assigned drive letter (C:\) or the full volume name/path (\?\Volume{...)  

To obtain a list of _volume_name_s using PowerShell:

PS C:> [Get-CimInstance](../ps/get-ciminstance.html) Win32_Volume | Format-Table **Name**, Label, FreeSpace, Capacity

Free space consolidation (/X) takes all free sectors on the volume and arranges them together so they are contiguous. This is normally done only when you intend to re-size the volume with [DISKPART SHRINK](diskpart.html) to make it smaller.  
Ensure you have a good a backup before running any consolidate/shrink process as this has a tendency to fail.

Defrag's scheduled task runs as a maintenance task and by default is scheduled to run every 7 days at 2am. An Administrator can change the frequency using **Optimize Drives** application.

### Examples

Analyse drive C: to see if it needs to be defragmented:

DEFRAG /A C:

Defragment drive c with verbose output saved to a file:  
  
DEFRAG c: /U /V > FileName.txt

Defragment two drives in parrallel:  
  
DEFRAG C: D: /M

_“How can you expect to govern a country that has two hundred and forty-six kinds of cheese?” ~ Charles de Gaulle_

### Related commands

[CleanMgr](cleanmgr.html) - Automated cleanup of Temp files, Internet files, downloaded files, recycle bin.  
[DISKPART](diskpart.html) - Partition manager.  
[Contig](https://docs.microsoft.com/en-gb/sysinternals/downloads/contig) - Single-file defragmenter (SysInternals/Microsoft).  
pagefileconfig.vbs - PageFile Configuration.



/. nt/del.html
========================================================

    Del - Delete Files - Windows CMD - SS64.com

DEL
===

Delete one or more files.

Syntax

      DEL [_options_] [/A:_file_attributes_] _files_to_delete_

Key
    _files_to_delete_ : A filename or a list of files, may include wildcards.

    options:
      /P  Give a Yes/No Prompt before deleting. 
      /F  Ignore read-only setting and delete anyway (FORCE) 
      /S  Delete from all Subfolders (DELTREE)
      /Q  Quiet mode, do not give a Yes/No Prompt before deleting.

      /A  Select files to delete based on _file_attributes_
            file_attributes:
              R  Read-only    -R  NOT Read-only
              A  Archive      -A  NOT Archive
              S  System       -S  NOT System
              H  Hidden       -H  NOT Hidden
              I  Not content indexed  -I  content indexed files
              L  Reparse points       -L  NOT Reparse points

              X  No scrub file attribute  -X  Scrub file attribute   (Windows 8+)
              V  Integrity attribute      -V  NO Integrity attribute (Windows 8+)

    [Wildcards](syntax-wildcards.html): These can be combined with part of a filename

      *  Match any characters
      ?  Match any ONE character

If a folder name is given instead of a file, all files in the folder will be deleted, but the folder itself will not be removed.

Errorlevels: DEL will return an [Errorlevel](errorlevel.html) of 0, irrespective if the delete succeeds or fails for any reason.  
Also a deletion failure will not fire for [||](syntax-redirection.html) unless the DEL arguments are invalid.  
If you delete files using PowerShell then a True/False return code ($?) will be set correctly.

Errorlevels
-----------

> If the files were successfully deleted [%ERRORLEVEL%](errorlevel.html) = 0  
> If the files failed to delete, or don’t exist to be deleted [%ERRORLEVEL%](errorlevel.html) = 0  
> Bad or no parameters given [%ERRORLEVEL%](errorlevel.html) = 1

Undeletable Files
-----------------

> Files are sometimes created with a very long filename or a trailing period or with reserved names (CON, AUX, COM1, COM2, COM3, COM4, LPT1, LPT2, LPT3, PRN, NUL) and as a result they become impossible to delete with Windows Explorer.
> 
> To delete such files use the [Device Path](syntax-filenames.html): DEL "\?\path to file"  
> 
> e,g,  
> DEL "\?\C:\some folder\AZH64GT."  
> 
> Alternatively for long filenames, you can reduce the total path length by using [SUBST](subst.html) to map a drive letter to the folder containing the file.
> 
> It is also possible to delete long paths using [RoboCopy](robocopy.html) - Copy/Move the required files to a temporary folder and then delete the folder, one gotcha with that technique is RoboCopy's tendency to follow symbolic links which can cause files outside the source folder to be moved/ deleted.
> 
> If a file is still 'undeletable' this may be caused by the indexing [service](syntax-services.html), temporarily stop the service and then delete the file.
> 
> **Thumbs.db**
> 
> If you are unable to delete thumbs.db using Windows Explorer or while Explorer is open, this is a bug in the thumbnail view for images. This issue can occur for folders which don't even contain any images.  
> To resolve, open Explorer, select View ➞ Options, open the "View" tab and uncheck "Display file icon on thumbnails".  
> For a more permanent [registry fix](thumbsdb.txt), you can disable thumbnail caching completely.

Permanent deletion
------------------

> Deleting a file will not prevent third party utilities from un-deleting it again. Secure file deletion utilities are available, however for casual use, you can turn any file into a zero-byte file to destroy the file allocation chain like this:  
>   
> TYPE nul > C:\examples\MyFile.txt  
> DEL C:\examples\MyFile.txt

Delete Locked files
-------------------

> Typically this is caused by the Offline Cache or Internet Explorer temp files.
> 
> Close all applications  
> Open a command prompt  
> Click Start, and then Shut Down  
> Simultaneously press CTRL+SHIFT+ALT.  
> While you keep these keys pressed, click Cancel in the Shut Down Windows dialog box.  
> In the command prompt window, navigate to the cache location, and delete all files from the folder (DEL /s)  
> At the command prompt, type explorer, and then press ENTER.

**DELTREE** - Older versions of Windows had the DELTREE command to delete all files and sub folders. This can be replicated with a script as shown on the [DELTREE](deltree.html) page.

### Examples

Delete "Hello World.txt"

DEL "Hello World.txt"

Delete 3 named files:

DEL file1.txt file2.txt "C:\demo\file3.txt"

Delete all files that start with the letter A

DEL A*  
  
Delete all files that end with the letter A

DEL *A.*

Delete all files with a .doc extension:

DEL *.doc  
  
Delete all read only files:

DEL /a:R *  
  
Delete all files including any that are read only:

DEL /F *

Normally DEL will display a list of the files deleted, if [Command Extensions](cmd.html) are disabled; it will instead display a list of any files it cannot find.

DEL is an [internal](syntax-internal.html) command. ERASE is a synonym for DEL

“But over all things brooding slept, The quiet sense of something lost” ~ Alfred Tennyson

### Related commands

[CIPHER /w](cipher.html) - Overwrite data in a directory (secure delete).  
[DELPROF](delprof.html) - Delete user profiles.  
[DELTREE](deltree.html) - Script to Delete a folder and all subfolders/files.  
[RD](rd.html) - Delete folders or entire folder trees.  
[CleanMgr](cleanmgr.html) - Automated cleanup of Temp files, Internet files, downloaded files, recycle bin.  
[FORFILES](forfiles.html) - Delete files older than X days.  
[INUSE](https://web.archive.org/web/20050921194716/https://support.microsoft.com/?id=228930) - updated file replacement utility (may not preserve file permissions).  
[Q120716](https://web.archive.org/web/20120215131526/http://support.microsoft.com:80/kb/120716/EN-US) - Remove Files with Reserved Names.  
[Q320081](https://support.microsoft.com/en-us/help/320081/) - You cannot delete a file or folder.  
[Q159199](https://web.archive.org/web/20050213173509/https://support.microsoft.com/?id=159199) - A file cannot be deleted (NTFS).  
PowerShell: [Remove-Item](../ps/remove-item.html) - Delete the specified items.  
Equivalent bash command (Linux): [rmdir](../bash/rmdir.html) / [rm](../bash/rm.html) - Remove folders/ files.



/. nt/delprof.html
========================================================

    Delprof - Delete profile - Windows CMD - SS64.com

DELPROF (XP/[2003 Server Resource Kit](../links/windows.html#kits) - [download](https://www.microsoft.com/en-gb/download/details.aspx?id=5405))
===============================================================================================================================================

Delete windows user profiles. Does not work with Windows 7 or later.  

Syntax

      DELPROF [_options days_]

Key
    /Q      Quiet, no confirmation.

    /I      Ignore errors and continue deleting.

    /P      Prompts for confirmation before deleting each profile.

    /C:\_computer_name_
           Delete profiles on a remote computer.

    /D:_Number_of_days_
           Only delete profiles that have been inactive for
           'X' Number of days (or greater)

    /R      Delete roaming profile cache only

**Alternatives**

List local profiles:

> Get-CimInstance -ClassName Win32_UserProfile -Filter "Special=False AND Loaded=False" | Select SID,localpath

Delete a user profile on a remote machine with PowerShell [via [adamtheautomator.com](https://adamtheautomator.com/powershell-delete-user-profile/)]:

> PS C:> Get-CimInstance -ComputerName '**workstation64**' -Class Win32_UserProfile | Where-Object { $_.LocalPath.split('\')[-1] -eq '**User64**' } | Remove-CimInstance
> 
> The LocalPath of the profile will normally end in the username but if a user account is renamed the path will not update and will retain the old name.

[Helge Klein's Delprof2](https://helgeklein.com/free-tools/delprof2-user-profile-deletion-tool/), Delprof2 is syntax compatible with the original Delprof by Microsoft but does have issues with UWP (Windows Store) apps on Windows 10.  
To run Delprof2 on a remote PC (with PowerShell):

> PS> [Invoke-command](../ps/invoke-command.html) -computername 'workstation64' -scriptblock {& "C:\utils\delprof2.exe" '/q'}

In the Windows 10 GUI right-click My Computer ➞ Properties ➞ Advanced System Settings ➞ User Profiles ➞ _account_ ➞ Delete

_“The best way to destroy the capitalist system is to debauch the currency” ~ John Keynes_

### Related commands

[WMI/PowerShell script to delete user profiles](https://community.idera.com/database-tools/powershell/powertips/b/tips/posts/remove-user-profiles-via-dialog) - Idera.  
[Delprof2](https://helgeklein.com/free-tools/delprof2-user-profile-deletion-tool/) - Delete Profiles Utility (Helge Klein).  
[DELTREE](del.html) - Delete a folder and all subfolders.  
[RD](rd.html) - Delete folders or entire folder trees.



/. nt/deltree.html
========================================================

    Deltree - Delete files and folders - Windows CMD - SS64.com

DELTREE - Delete all subfolders and files.
==========================================

Very old versions of Windows (Windows 95 and earlier) had the DELTREE command to delete all sub-folders and files. Newer versions of Windows do not have this command, but we can easily write a short batch script to do the same thing.

Deleting from the command line is significantly faster than using Windows Explorer, often seconds instead of minutes, there is no running calculation of file sizes and no recycle bin. This does mean there is no possibility of an undo other than restoring a backup.

In many cases, simply running [RD](rd.html) from the command line will be orders of magnitude faster than using Windows Explorer. However for very large deletes (roughly 100,000 files [plus](https://superuser.com/questions/19762/mass-deleting-files-in-windows/289399#289399)) an additional significant time saving can be achieved by using a two pass approach: first deleting the files and then the folders.

The two key commands required are DEL /s to delete all files including hidden and system files, followed by RD /s to remove the now empty folders.

**WARNING:** if you have any [directory junctions](mklink.html) DEL will delete the destination directory and not the junction. Be very careful not to run these commands unless you know there are no junctions inside the target directory.

> When iterating through thousands of files, supressing the output of DEL *.* by redirecting it to NUL, will make the process run a little faster.
> 
> :: DelTree.cmd
> :: Delete a folder plus all files and subfolders
> @Echo Off
> Set _folder=%1
> if [%_folder%]==[] goto:eof
> 
> PUSHD %_folder%
> ::  If this fails, exit, we dont want to delete from the wrong folder.
> If %errorlevel% NEQ 0 goto:eof
> 
> Del /f /q /s *.* >NUL
> CD \
> RD /s /q %_folder%
> :: Repeat because RD is sometimes buggy and leaves a few files
> if exist %_folder% RD /s /q %_folder%
> Popd
> 
> ### Examples
> 
> Supply the full path to the folder to be deleted surrounded in quotes:  
> deltree.cmd "c:\demo\some folder to delete"
> 
> In PowerShell this can be done as a one-liner:  
> [Remove-Item](../ps/remove-item.html) -LiteralPath 'c:\demo\some folder to delete' -Force -Recurse

Delete only Empty folders
-------------------------

> Delete all folders and subfolders below the **current** folder.  
> Copy the script below to a folder and double click it.
> 
> :: DelEmpty.cmd  
> :: Remove all empty folders and subfolders  
> @Echo off  
> Set _folder="%~dp0"  
>   
> PUSHD %_folder%  
> :: If this fails, exit, we dont want to delete from the wrong folder.  
> If %errorlevel% NEQ 0 goto:eof  
>   
> Echo remove empty folders from %_folder% ?  
> pause  
> For /f "delims=" %%d in ('dir /s /b /ad %_folder% ^| sort /r') do RD "%%d" 2>nul
> 
> Alternative [PowerShell](../ps/remove-item.html) one-liner to delete empty folders:  
> PS C:> Get-ChildItem -Recurse . | where { $_.PSISContainer -and @( $_ | Get-ChildItem ).Count -eq 0 } | Remove-Item

Delete the Current Folder & subfolders
--------------------------------------

> This script deletes all contents of the current folder. Copy the script to a folder and double click it.  
> This version also does not delete the root folder itself. To avoid deleting itself, the script sets the read-only [Attribute](attrib.html).  
> 
> :: FastDel.cmd
> :: Remove all files and subfolders
> @Echo Off
> cls
> Set _folder="%~dp0"
> Attrib +R %0
>   
> PUSHD %_folder%  
> :: If this fails, exit, we dont want to delete from the wrong folder.
> If %errorlevel% NEQ 0 goto:eof  
> ECHO Delete all contents of the folder: %_folder% ?
> Pause
> :: Delete the files
> Del /f /q /s /a:-R %_folder% >NUL
> :: Delete the folders
> For /d %%G in (%_folder%*) do RD /s /q "%%G"
> Attrib -R %0
> Popd
> 
> If you use this on a UNC path like \Server64\share1\somefolder the CMD shell will not be able to set a current directory. To avoid an automatic fallback to C:\Windows\ the script uses %~dp0 to grab the location and then [pushd](pushd.html) will, if needed, map a temporary drive.

“However beautiful the strategy, you should occasionally look at the results” ~ Sir Winston Churchill

### Related commands

[RD](rd.html) - Delete folders or entire folder trees.  
[DELPROF](delprof.html) Delete NT user profiles.  
[DEL](del.html) - Delete files.  
PowerShell: [Remove-Item](../ps/remove-item.html) - Delete the specified items.  
Equivalent bash command (Linux): [rmdir](../bash/rmdir.html) / [rm](../bash/rm.html) - Remove folders/ files.



/. nt/devcon.html
========================================================

    Devcon - Windows CMD - SS64.com

DEVCON.exe
==========

Device Manager.

Syntax

      devcon.exe [-r] [-m:\_machine_] _command_ [_arg_...]
      devcon.exe help _command_

DevCon was originally released by Microsoft as a 'code sample', newer utilities, primarily [PnPUTIL](pnputil.html), have since been created to add new capabilities. Microsoft now recommend replacing DevCon usage with the newer utilities, listed below.

Key
    -r       Reboot the machine after command is complete, if needed.

    _machine_  Name of target machine.

    _command_  The command to perform (see below).

    _arg_...   One or more arguments if required by command.

Commands: 
  classfilter    Allow modification of class filters.
  classes        List all device setup classes. Use [PNPUTIL /enum-classes](pnputil.html)
  disable        Disable device. Use [PNPUTIL /disable-device](pnputil.html)
  driverfiles    List driver files installed for devices. Use [PNPUTIL /enum-drivers /files](pnputil.html)
  drivernodes    List driver nodes of devices. Use [PNPUTIL /enum-devices /drivers](pnputil.html)
  dp_add         Add (install) a third-party (OEM) driver package. Use [PNPUTIL /add-driver _INF_Name_](pnputil.html)
  dp_delete      Delete a third-party (OEM) driver package. Use [PNPUTIL /delete-driver](pnputil.html)
  dp_enum        List the third-party (OEM) driver packages installed. Use [PNPUTIL /enum-drivers](pnputil.html)
  enable         Enable devices. Use [PNPUTIL /enable-device](pnputil.html)
  find           Find devices. Use [PNPUTIL /enum-devices /connected](pnputil.html)
  findall        Find devices including those that are not present. Use [PNPUTIL /enum-devices](pnputil.html)
  help           Display this information.
  hwids          List hardware ID's of devices. Use [PNPUTIL /enum-devices /deviceids](pnputil.html)
  install        Manually install a device. Use [PNPUTIL /add-driver _INF_name_ /install](pnputil.html)
  listclass      List all devices for a setup class. Use [PNPUTIL /enum-devices /class _Name_or_GUID_](pnputil.html)
  reboot         Reboot local machine. Use [SHUTDOWN](shutdown.html) in preference to this.
  remove         Remove devices that match the specific hardware/instance ID. Use [PNPUTIL /remove-device](pnputil.html)
  rescan         Scan for new hardware. Use [PNPUTIL /scan-devices](pnputil.html)
  resources      List hardware resources of devices. Use [PNPUTIL /enum-devices /resources](pnputil.html)
  restart        Restart devices that match the specific hardware/instance ID. Use [PNPUTIL /restart-device](pnputil.html)
  SetHwID        Add, delete, and change the order of hardware IDs of root-enumerated devices.
  stack          List expected driver stack of devices. Use [PNPUTIL /enum-devices /stack](pnputil.html)
  status         List running status of devices. Use [PNPUTIL /enum-devices](pnputil.html)
  update         Manually update a device. Use [PNPUTIL /add-driver _INF_name_ /install](pnputil.html)
  UpdateNI       Manually update a device without user prompt. Use [PNPUTIL /add-driver _INF_name_ /install](pnputil.html)

Wildcard matching is not supported in DevCon. As an alternative, many [PnPUTIL](pnputil.html) commands offer the option to perform bulk operations on devices that exactly match a hardware or compatible ID.

Download via [Windows Driver Kit](https://www.microsoft.com/en-us/download/details.aspx?id=11800) or [.cab download.](https://superuser.com/questions/1002950/quick-method-to-install-devcon-exe) DevCon is not redistributable. It is provided for use as a debugging and development tool i.e. not intended for production use.

### Examples

List all known PCI devices on the computer pc64.

devcon -m:\pc64 find pci*

Install a new instance of the Microsoft loopback adaptor and restart if required. This creates a new root-enumerated device node with which you can install a "virtual device," such as the loopback adaptor.

devcon -r install %WINDIR%\Inf\Netloop.inf *MSLOOP

List all known setup classes. Displays both the short name and the descriptive name.

devcon classes

Lists files that are associated with each device in the ports setup class.

devcon driverfiles =ports

Disable all devices that have a hardware ID that ends in "MSLOOP" (including "*MSLOOP").

devcon disable *MSLOOP

List all compatible drivers for the device ROOT\PCI_HAL\PNP0A03. This can be used to determine why an integral device information (.inf) file was chosen, instead of a third-party .inf file.

devcon drivernodes @ROOT\PCI_HAL\PNP0A03

Enable all devices that have a hardware ID of "*MSLOOP". The single quotation mark indicates that the hardware ID must be taken literally (in other words, the asterisk ["*"] actually is an asterisk; it is not a wildcard character).

devcon enable '*MSLOOP

List device instances of all devices that are present on the local computer.

devcon find *

List all known peripheral component interconnect (PCI) devices that are on the local computer (this command assumes that a device is PCI if it has a hardware ID that is prefixed by "PCI\").

devcon find pci*

List devices that are a member of the ports setup class and that contain "PNP" in their hardware ID.

devcon find =ports *pnp*

List devices that are present that are a member of the ports setup class and that are in the "root" branch of the enum tree (the instance ID is prefixed by "root\"). Note that you should not make any programmatic assumption about how an instance ID is formatted. To determine root devices, you can look at device status bits. This feature is included in DevCon to aid in debugging.

devcon find =ports @root*

List "nonpresent" devices and devices that are present for the ports class. This includes devices that have been removed, devices that have been moved from one slot to another and, in some cases, devices that have been enumerated differently due to a BIOS change.

devcon findall =ports

List all devices that are present for each class named (in this case, USB and 1394).

devcon listclass usb 1394

Remove all USB devices. Devices that are removed are listed with their removal status.

devcon remove @usb*

Rescan for new Plug and Play devices.

devcon rescan

List the resources that are used by all devices in the ports setup class.

devcon resources =ports

Restart the loopback adaptor ROOT*MSLOOP\0000. The single quotation mark in the command indicates that the instance ID must be taken literally.

devcon restart =net @'ROOT*MSLOOP\0000

List all hardware IDs of mouse class devices on the system.

devcon hwids=mouse

Assign the hardware ID, beep, to the legacy beep device.

devcon sethwid @ROOT\LEGACY_BEEP\0000 := beep

List the status of each device present that has an instance ID that begins with "pci\".

devcon status @pci*

List the status of an Advanced Configuration and Power Interface (ACPI)-enumerated serial port.

devcon status @ACPI\PNP0501\1

List the status of all COM ports.

devcon status *PNP05*

**Errorlevels** returned by DevCon.exe:  
0 = success.  
1 - restart is required.  
2 = failure.  
3 = syntax error.

“I've learned that people will forget what you said, people will forget what you did, but people will never forget how you made them feel” ~ Maya Angelou

### Related commands

[DISKPART](diskpart.html) - Disk Administration.  
[PNPUtil.exe](pnputil.html) - Plug-and-Play Utility.  
[FSUTIL](fsutil.html) - File and Volume utilities.  
[DriverQuery](driverquery.html) Display installed device drivers.  
[TechNet](https://social.technet.microsoft.com/wiki/contents/articles/182.how-to-obtain-the-current-version-of-device-console-utility-devcon-exe.aspx?PageIndex=2) - How to obtain the current version of Device Console utility (DevCon.exe).  
[DevCon](https://docs.microsoft.com/en-gb/windows-hardware/drivers/devtest/devcon) - docs.microsoft.com



/. nt/dir.html
========================================================

    DIR - list files and folders - Windows CMD - SS64.com

DIR
===

Display a list of files and subfolders.

Syntax

      DIR [_pathname(s)_] [_display_format_] [_file_attributes_] [_sorted_] [_time_] [_options_]

Key
    [_pathname_] The drive, folder, and/or files to display,   
              this can include wildcards:  
                 *   Match any characters  
                 ?   Match any ONE character  
  
    [_display_format_]
    /P   Pause after each screen of data.
    /W   Wide List format, sorted horizontally.
    /D   Wide List format, sorted by vertical column.
  
    [_file_**a**ttributes_] **/A**[:]_attribute_   
  
    /A:D  Folder         /A:-D  NOT Folder
    /A:R  Read-only      /A:-R  NOT Read-only 
    /A:H  Hidden         /A:-H  NOT Hidden
    /A:A  Archive        /A:-A  NOT Archive
    /A:S  System file    /A:-S  NOT System file
    /A:I  Not content indexed Files  /A:-I  NOT content indexed
    /A:L  Reparse Point  /A:-L  NOT Reparse Point (symbolic link)

    /A:X  No scrub file  /A:-X  Scrub file    (Windows 8+)
    /A:V  Integrity      /A:-V  NOT Integrity (Windows 8+)

    /A    Show all files  
    Several attributes can be combined e.g. /A:HD-R  
  
    [s**o**rted]   Sorted by **/O**[:]_sortorder_  
  
    /O:N   Name                  /O:-N   Name  
    /O:S   file Size             /O:-S   file Size
    /O:E   file Extension        /O:-E   file Extension  
    /O:D   Date & time           /O:-D   Date & time
    /O:G   Group folders first   /O:-G   Group folders last
    several attributes can be combined e.g. /O:GEN  
  
    [_**t**ime_] **/T:**  the time field to display & use for sorting  
    /T:C   Creation
    /T:A   Last Access
    /T:W   Last Written (default)  
  
    [_options_]
    /S     include all subfolders.
    /R     Display alternate data streams.
    /B     Bare format (no heading, file sizes or summary).
    /L     use Lowercase.
    /Q     Display the owner of the file.

    /N     long list format where filenames are on the far right.
    /X     As for /N but with the short filenames included.  
    /C     Include thousand separator in file sizes.   
    /-C    Don’t include thousand separator in file sizes.

    /4     Display four-digit years.
          In most recent builds of Windows this switch has no effect.
          The number of digits shown is determined by the [ShortDate](date.html) format
          set in the Control Panel.

The switches above can be preset by adding them to an [environment](syntax-variables.html) variable called DIRCMD.  
For example: SET DIRCMD=/O:N /S  
  
Override any preset DIRCMD switches by prefixing the switch with -  
For example: DIR *.* /-S

When listing the contents of a **One Drive** folder, the file sizes for files which are only in the cloud, i.e. not yet synced to the local computer, will be shown in (parenthesis).

Sorting
-------

> The default Sort Order, if you don’t specify anything with /O, on an NTFS drive will be in [sort-of-alphabetical order](https://devblogs.microsoft.com/oldnewthing/20140304-00/?p=1603) or on a FAT USB thumb drive, then the order will be based on the order in which files were created and deleted and the lengths of their names.

Upper and Lower Case filenames:
-------------------------------

> Filenames longer than 8 characters - will always display the filename with mixed case as entered.  
> Filenames shorter than 8 characters - can display the filename in upper or lower case - this can vary from one client to another (registry setting)
> 
> To obtain a bare DIR format (no heading or footer info) but retain all the details, pipe the output of DIR into FIND, this assumes that your [date](date.html) separator is /
> 
> DIR c:\temp*.* | FIND "/"

Listing the full path
---------------------

> The command DIR /b will return just a list of filenames, when displaying subfolders with DIR /b /s the command will return a [full pathname](path.html). To list the full path _without_ including subfolders, use the [WHERE](where.html) command.

Errorlevels
-----------

> If the file(s) were successfully listed [%ERRORLEVEL%](errorlevel.html) = 0  
> If the file was not found or bad parameters given [%ERRORLEVEL%](errorlevel.html) = 1

All file sizes are shown in [bytes](../convert.html).

DIR is an [internal](syntax-internal.html) command.

### Examples

List the contents of c:\demo including ALL files:

DIR /a c:\demo\

List the contents of c:\demo displaying only the filenames:

DIR /b c:\demo\

List only the files (not folders) stored under c:\demo\ recursing into all sub-folders and include any hidden files:

DIR /a:-D /s c:\demo\

List the Full Path of each file in c:\demo WITHOUT using the /S switch: ([via Forum](https://ss64.org/viewtopic.php?f=2&t=180))

[For](for.html) %%**A** in ("c:\demo*") do Echo %%~f**A**  
or  
[WHERE](where.html) "C:\demo\:*.*"  

List the contents of c:\demo and H:\work  
notice the trailing backslashes, if either directory does not exist, this will fail and set [%Errorlevel%](errorlevel.html) = 1

DIR c:\demo\ h:\work\

List all the Reparse Points (symbolic links) in the current users profile:

DIR %USERPROFILE% /a:i

List the contents of c:\demo, without the header/footer details:

FOR /f "tokens=*" %%**G** IN ('DIR c:\demo*.* ^| find "/"') DO echo %%**G**

“There it was, hidden in alphabetical order” ~ Rita Holt

### Related commands

[WHERE](where.html) - Locate and display files in a directory tree.  
[XCOPY](xcopy.html) /L - List files without copying.  
[ROBOCOPY /L](robocopy.html) - List files with specific properties.  
[DIRUSE](diruse.html) - show size of multiple subfolders. (Resource Kit).  
How-to: [Long filenames, NTFS and legal filename characters](syntax-filenames.html).  
Get File Sizes and Date/Time from [Batch Parameters](syntax-args.html).  
Equivalent bash command (Linux): [ls](../bash/ls.html) - List information about file(s).  
Equivalent PowerShell: [Get-ChildItem](../ps/get-childitem.html) - Get the contents of a folder or registry key.



/. nt/diruse.html
========================================================

    Diruse - Disk usage - Windows CMD - SS64.com

DIRUSE ([2K Resource Kit / XP Support Tools](../links/windows.html#kits))
=========================================================================

Display directory sizes/usage.

Syntax

      DIRUSE [_options_] _Folders_...

Options
    /M  Display in Mb
    /K  Display in Kb
    /B  Display in bytes (default)
    /,  Use thousand separator when displaying sizes. 
    /Q:#  Quota limit, mark folders that exceed the size (#) with a "!".
         set %errorlevel% to ONE if any folders are found that
         exceed the specified size

    /*  Report on one level of subfolders (top-level folders)

    /D  Display only folders that exceed specified sizes.
    /S  Include detail of every subfolder in the output
    /O  Don’t check subfolders for quota overflow.
    /V  Display progress report for every subfolder

    /C  Use Compressed size instead of apparent size.
    /L  Output overflows to logfile .\DIRUSE.LOG.
    /A  generate an alert if quota is exceeded
       (requires the Alerter service)

Options for DIRUSE can be specified with either -option or /option

This utility does still work under Windows 10, although, like all Resource Kit tools, it is unsupported.

**Examples**  
  
Enumerate the top level folders on drive E:

C:> DIRUSE /M /* E:

Enumerate all sub-folders below the path E:\work

C:> DIRUSE /M /s e:\work

“Work is achieved by those employees who have not yet reached their level of incompetence” ~ Laurence J. Peter (The Peter Principle)

### Related commands

[DIR](dir.html) - Display a list of files and folders.  
DirQuota - Create and manage quotas (File Server Resource Manager).  
[DU](du.html) - Display directory sizes/usage.  
[XCOPY](xcopy.html) /L - List Files.  
[FREEDISK](freedisk.html) - Check free disk space.  
[FSUTIL](fsutil.html) - File and Volume utilities.  
Equivalent PowerShell: [DirUse Script](../ps/syntax-diruse.html) to list directory sizes.  
Equivalent bash command (Linux): [quotacheck](../bash/quotacheck.html) - Scan a file system for disk usage.



/. nt/diskpart.html
========================================================

    DiskPart - Partition a disk - Windows CMD - SS64.com

DiskPart
========

Disk Administration, Partition a disk.

Syntax

      DISKPART

      DISKPART /s _scriptname.txt_

      DISKPART /s _scriptname.txt_ > _logfile.txt_
Key
    /s _scriptname.txt_ (one command per line)
         To create a diskpart script, create a text file _scriptname.txt_ containing the Diskpart commands that you 
         want to run, one command per line, and no empty lines. Start a line with [REM](rem.html) to make the line a comment.

Commands you can issue at the DISKPART prompt or in a text file:

 ACTIVE  On basic disks, mark the partition with focus as active.

         DiskPart does not check the contents of the partition. If you mistakenly mark a partition as active
         and it does not contain the operating system startup files, your computer might not start.
         This informs the basic input/output system (BIOS) or Extensible Firmware Interface (EFI) that
         the partition or volume is a valid system partition or system volume.
         Only partitions can be marked as active. A partition must be selected for this operation to succeed.
         Use the select partition command to select a partition and shift the focus to it.

 ADD disk=_n_ [align=_n_] [wait] [noerr]
         Mirror the simple volume with focus to the specified disk.

 ASSIGN  [{LETTER=_D_  | mount=_path_}] [noerr]
         Assign a drive letter or mount point to the volume with focus. (Only Server 2012-2022)

         If no drive letter or mount point is specified, the next available drive letter is assigned.
         By using the assign command, you can change the drive letter associated with a removable drive.
         You cannot assign drive letters to system volumes, boot volumes, or volumes that contain the paging file.
         In addition, you cannot assign a drive letter to an Original Equipment Manufacturer (OEM) partition
         or any GUID Partition Table (gpt) partition other than a basic data partition.
         A volume must be selected for this operation to succeed.
         Use the select volume command to select a volume and shift the focus to it.
         ## Example To assign the letter E to the volume in focus, type: assign letter=e

 ATTRIBUTES DISK [{set | clear}] [readonly] [noerr]  
 ATTRIBUTES VOLUME [{set | clear}] [{hidden | readonly | nodefaultdriveletter | shadowcopy}] [noerr]
         Display, set, or clear the attributes of a disk or volume.

 AUTOMOUNT [enable] [disable] [scrub] [noerr]
         Enable or disable the automount feature.

 BREAK disk=_n_ [nokeep] [noerr]
         Break the mirrored volume with focus into two simple volumes.

 CLEAN [all]       (Server 2012-2022)
         Remove any and all partition or volume formatting from the disk with focus, 'all' will Zero the disk.
         See also the PowerShell cmdlet [clear-disk](../ps/clear-disk.html)

 COMPACT vdisk       (Windows Server 2008R2-2022)
         Reduce the physical size of a dynamically expanding virtual hard disk (VHD) file.
         This parameter is useful because dynamically expanding VHDs increase in size as you add files, but they do
         not automatically reduce in size when you delete files.

 [CONVERT](convert.html) Convert file allocation table (FAT) and FAT32 volumes to the NTFS file system. 

 CREATE partition efi [size=_n_] [offset=_n_] [noerr]
 CREATE partition extended [size=_n_] [offset=_n_] [align=_n_] [noerr]
 CREATE partition logical [size=_n_] [offset=_n_] [align=_n_] [noerr]
 CREATE partition msr [size=_n_] [offset=_n_] [noerr]
 CREATE partition primary [size=_n_] [offset=_n_] [id={ _byte_ | _guid_ }] [align=_n_] [noerr]
         Create a partition.

 CREATE volume raid [size=_n_] disk=_n_,_n_,_n_[,_n_,...] [align=_n_] [noerr]
 CREATE volume simple [size=_n_] [disk=_n_] [align=_n_] [noerr]
 CREATE volume stripe [size=_n_] disk=_n_,_n_[,_n_,...] [align=_n_] [noerr]
 CREATE volume mirror [size=_n_] disk=_n_,_n_[,_n_,...] [align=_n_] [noerr]
         Create a volume.

 CREATE vdisk file=_filepath_ {[type={fixed|expandable}] | [parent=_filepath_] | [source=_filepath_]}
                      [maximum=_n_] [sd=_SDDL_] [noerr]
         Create a virtual disk (VHD).

 DELETE disk [noerr] [override]
 DELETE partition [noerr] [override]
 DELETE volume [noerr]
         Delete a partition, volume or a dynamic disk from the list of disks.

 DETAIL Disk
 DETAIL Partition
 DETAIL volume
         Display properties of the selected disk/volume/partition, display the disks on which the current volume resides:

 EXIT    Exit Diskpart

 EXPAND vdisk maximum=_n_
         Expand the max size (in MB) available on a virtual disk (Windows Server 2008R2-2022).

 EXTEND [size=_n_] [disk=_n_] [noerr]
 EXTEND filesystem [noerr]
         Extend a volume or partition with focus and its file system into free space on a disk.
            size= The space in MB.
            disk= The disk on which the volume or partition is extended. Default = current disk.

 FILESYSTEMS
         Display the current and supported file systems on the volume (Use 'Select Volume' first)

 [FORMAT](diskpart-format.html) [[FS=_FS_] [REVISION=_X.XX_] | RECOMMENDED] [LABEL="_label_"] [UNIT=_N_]
            [QUICK] [COMPRESS] [OVERRIDE] [DUPLICATE] [NOWAIT] [noerr]
         Format a disk for use with Windows.

 GPT attributes=_n_     (Windows Server 2012-2022)  OEM use only.
      On basic GUID partition table (gpt) disks, this command assigns the gpt attribute(s) to the partition with focus.
      Gpt partition attributes give additional information about the use of the partition.
      Some attributes are specific to the partition type GUID.
      This might cause your basic data volumes to fail to be assigned drive letters, or to prevent the file system from mounting. 

 HELP [_command_]

 IMPORT
         Imports a transportable shadow copy from a loaded metadata file into the system.
         Before you can use [import](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/import#BKMK_examples), you must load a DiskShadow metadata file using the load metadata command.

 INACTIVE
         On basic master boot record (MBR) disks, marks the system partition or boot partition
         with focus as inactive [don’t boot]. Use 'Select Partition' first.
         Your computer might not start without an active partition. 

 LIST Disk
 LIST Partition
 LIST Volume
 LIST vdisk
 LIST writers [metadata | detailed | status]
 LIST shadows {all | set _SetID_ | id _ShadowID_}
 LIST providers
         Display a list of objects
            _SetID_ List shadow copies that belong to the specified Shadow Copy Set ID.
         _ShadowID_ List any shadow copy with the specified shadow copy ID

 MERGE vdisk depth=_n_           (Windows Server 2008R2-2022)
         Merge a differencing virtual hard disk (VHD) with its corresponding parent VHD.
         depth=1 will merge with parent.
         The parent VHD will be modified to include the modifications from the differencing VHD.
         As a result, other differencing VHDs that are dependent on the parent will no longer be valid.
         You must choose and detach a VHD for this operation to succeed.
         Use the 'select vdisk' command to select a VHD and shift the focus to it.

 OFFLINE disk [noerr]
 OFFLINE volume [noerr]
         Take an online disk or volume to the offline state, use 'Select Disk' first)

 ONLINE disk [noerr]
 ONLINE volume [noerr]
         Take an offline disk or volume to the online state.

 RECOVER [noerr]
         Refresh the state of all disks in the selected pack, attempt recovery on disks in the invalid 
         pack, and resynchronize mirrored volumes and RAID-5 volumes that have stale plex or parity data.
         Only applicable to dynamic disks.

 REM  (remark/comment)

 REMOVE letter=_E_ [dismount] [noerr]    Remove drive letter _E_ from the in-focus partition.
 REMOVE mount=_path_ [dismount] [noerr]  Remove mount point from the in-focus partition.
 REMOVE all [dismount] [noerr]         Remove ALL current drive letters and mount points.
         Remove a drive letter or mount point from a volume.

 REPAIR disk=_n_ [align=_N_] [noerr]
         Repair a RAID-5 volume with a failed member by replacing with a specified dynamic disk.
         align = _N_   Align all volume extents to the closest alignment boundary.
         Extent offsets will be a multiple of _N_.

 RESCAN  Locate new disks and volumes that have been added to the computer.
 RETAIN  Prepare an existing dynamic simple volume to be used as a boot or system volume.


 SAN [policy={OnlineAll | OfflineAll | OfflineShared}] [noerr]
         Display or set the SAN policy for the currently booted OS.
         Specifying onlineAll on a server that shares disks could lead to data corruption.
         Do not set this policy if disks are shared among servers unless the server is part of a cluster.

 SELECT Disk={ _n_ | _diskpath_ | system | next }
 SELECT Partition=_n_   (Volume number)
 SELECT Volume={ _n_ | _d_ } [noerr] (Volume number or Drive Letter)
 SELECT vdisk file=_fullpath_ [noerr]
         Shift the focus to an object.

 SET ID={ _byte_ | _GUID_ } [override] [noerr]
         Change the partition type for the partition with focus (for OEM use):

 SHRINK [desired=_n_] [minimum=_n_] [nowait] [noerr]  (Reduce the size of the in-focus volume)  
 SHRINK querymax [noerr]
         Reduce the size of the selected volume.
         Desired = Desired space in MB.
         Minimum = space in MB to reduce the volume by.
         QueryMax = Returns the maximum number of bytes that the volume can be reduced by.

 UNIQUEID disk [id={_dword_ | _GUID_}] [noerr]
         Display or set the GUID partition table identifier or MBR signature for
         the (basic or dynamic) disk with focus.
         id= For MBR disks specify a 4-byte DWORD in hex form for the signature.
**Commands to Manage Basic Disks:**

 ASSIGN MOUNT=_path_  (Choose a mount point path for the volume)

 CREATE PARTITION Primary Size=50000  (50 GB)
 CREATE PARTITION Extended Size=25000
 CREATE PARTITION logical Size=25000
 DELETE Partition
 EXTEND Size=10000
 GPT attributes=_n_   (assign GUID Partition Table attributes)
 SET id=_byte_|_GUID_ [override] [noerr]   (Change the partition type)

**Commands to Manage Dynamic Disks:**

 ADD disk=_n_   (Add a mirror to the in-focus SIMPLE volume on the specified disk
               see 'Diskpart Help' for more.)
 BREAK disk=_n_  (Break the current in-focus mirror)
 CREATE VOLUME Simple Size=_n_ Disk=_n_
 CREATE VOLUME Stripe Size=_n_ Disk=_n_,_n_,...
 CREATE VOLUME Raid Size=_n_ Disk=_n_,_n_,...
 DELETE DISK
 DELETE PARTITION
 DELETE VOLUME
 EXTEND Disk=_n_ [Size=_n_]
 EXTEND Filesystem [noerr]
 IMPORT [noerr]   (Import a foreign disk group, use 'Select disk' first)
 RECOVER [noerr]  (Refresh disk pack state, attempt recovery on an invalid pack,
                   & resynchronize stale plex/parity data.)
 REPAIR disk=_n_ [align=_n_] [noerr]  (Repair the RAID-5 volume with focus, replace with the specified dynamic disk)
 RETAIN   (Prepare an existing dynamic simple volume to be used as a boot or system volume)

Prior to Windows 8/Server 2008 the DiskPart utility used a different syntax.

DiskPart can be used to automate disk-related tasks, such as creating volumes or converting disks to dynamic disks. Scripting these tasks is useful if you deploy Windows by using unattended Setup or the Sysprep tool, which do not support creating volumes other than the boot volume.

When using the DiskPart command as a part of a script, we recommend that you complete all of the diskpart operations together as part of a single diskpart script. To run consecutive diskpart scripts, allow at least 15 seconds between each script for a complete shutdown of the previous execution before running the DiskPart command again in successive scripts. Otherwise, the successive scripts might fail.  
Add a pause between consecutive DiskPart scripts by adding a [TIMEOUT](timeout.html) /t 15 command to the batch file.

When setting up a new drive, create in this order: Create Partition, Format drive, Assign drive letter.

When selecting a volume or partition, you can use either the number or drive letter or the mount point path.

The Windows GUI interface can also be used to assign a mount-point folder path to a drive. In Disk Manager, right-click the partition or volume, and click Change Drive Letter and Paths, then click Add and then type the path to an empty folder on an NTFS volume.

The Windows [Recovery Console](syntax-recovery.html), includes a simplified DISKPART command. It only provides functionality for adding and deleting partitions, but not for setting an active partition.

Always back up the hard disk before running DiskPart.

Examples:  

SELECT DISK=0
CREATE PARTITION PRIMARY
SELECT PARTITION=1
FORMAT FS=NTFS LABEL="New Volume" QUICK  
ASSIGN LETTER=E
EXIT 

The default SAN policy in Windows Server 2008 / R2 is now VDS_SP_OFFLINE_SHARED for all non boot SAN disks.  
This means that the disks will be offline at server startup (even if the drive contains a paging file).

This Disk Management error message indicates that the drive is offline:

> "the disk is offline because of policy set by an administrator".

Query the current SAN policy to see if it is Offline Shared

DISKPART.EXE  
DISKPART> san  
SAN Policy : Offline Shared

To manually bring the disks online:  
Computer Management ➞ Storage ➞ Disk Management, right-click the disk and choose Online.

If these are **not** part of a cluster, than an alternative is to make a SAN policy change, select the offline disk, clear its readonly flag and bring it online:

 DISKPART> san policy=OnlineAll 
 DiskPart successfully changed the SAN policy for the current operating system. 
 
 DISKPART> LIST DISK 
 Disk ### Status        Size    Free    Dyn Gpt
 -------- ------------- ------- ------- --- ---
 Disk 0   Online         80 GB     0 B
 * Disk 1 Offline        20 GB  1024 KB 
 
 DISKPART> select disk 1 
 Disk 1 is now the selected disk. 
 
 DISKPART> ATTRIBUTES DISK CLEAR READONLY

 DISKPART> ONLINE DISK
 DiskPart successfully onlined the selected disk.

“Divide et impera” ~ Latin saying (Divide and conquer)

### Related commands

docs.microsoft.com - [Configure UEFI/GPT-Based Hard Drive Partitions](https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/configure-uefigpt-based-hard-drive-partitions?view=windows-11) using Windows PE and DiskPart.  
docs.microsoft.com - [Configure BIOS/MBR-Based Hard Disk Partitions](https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/configure-biosmbr-based-hard-drive-partitions?view=windows-11) using Windows PE and DiskPart.  
[FORMAT](format.html) - Format a disk.  
[FSUTIL](fsutil.html) - File and Volume utilities.  
[DISKSHADOW](diskshadow.html) - Volume Shadow Copy Service.  
[SYSPREP](https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/sysprep--generalize--a-windows-installation?view=windows-11) - (Generalize) a Windows installation.  
PowerShell equivalents: [clear-disk](../ps/clear-disk.html), get-disk, set-partition, get-volume  
[Partition Wizard](https://www.partitionwizard.com/) - GUI Disk Partition Manager.  
Equivalent bash command (Linux): [fdisk](../bash/fdisk.html) - Partition table manipulator for Linux.



/. nt/diskshadow.html
========================================================

    DiskShadow - Windows CMD - SS64.com

DISKSHADOW (Windows Server)
===========================

Volume Shadow Copy Service. By default, DiskShadow uses an interactive command interpreter similar to that of DiskRAID or DiskPart. DiskShadow also includes a scriptable mode.

Syntax

    Start interactive mode:
      diskshadow

    Execute a script:
      diskshadow -s _script_.txt

Commands to run interactively or through a script file:

      add
      add volume _Volume_ [provider _ProviderID_]
      add alias _AliasName AliasValue_
      begin backup
      begin restore
      break
      break [writable] _SetID_
      create
      delete shadows [all | volume _Volume_ | oldest _Volume_ 
                          | set _SetID_ | id _ShadowID_
                          | exposed {_Drive_ | _MountPoint_}]
      end backup
      end restore
      exec _ScriptFile.cmd_
      exit
      expose {_Drive_: | _Share_ | _MountPoint_}
      help
      import
      list
      list writers [metadata | detailed | status]
      list shadows {all | set _SetID_ | id _ShadowID_}
      list providers
      load metadata
      load metadata [_Drive_:][_Path_]_MetaData.cab_
      mask _ShadowSetID_
      reset
      resync
      revert
      revert _ShadowCopyID_
      set
      set context {clientaccessible | persistent [nowriters] | volatile [nowriters]}
      set option {[differential | plex]
                     [transportable]
                        **[** [rollbackrecover] [txfrecover]
                            | [noautorecover] **]**}
      set verbose {on|off}
      set metadata _MetaData.cab_
      simulate restore
      unexpose {_ShadowID_ | _Drive_: | _Share_ | _MountPoint_}
      writer verify [_Writer_ | _Component_]
      writer exclude [_Writer_ | _Component_]

Key
    See hover text above.

A shadow copy allows you to take manual or automatic backup copies or snapshots of data at a specific point in time over regular intervals. Using a shadow copy avoids problems with file locking, by creating a **read-only** copy of the volume, backup programs are able to access every file with no other programs able to lock those same files, this simplifies the creation of consistent backup.

A shadow copy is not created every time a file is changed; backup copies are created automatically once per day, or manually when triggered by a backup or installer application.

**Persistent** shadow copies can only be made for NTFS volumes.  
Nonpersistent (volatile) shadow copies can be made for NTFS and non-NTFS volumes.

In Windows 8 the ability to create persistent shadow copies (_Previous Versions_) was removed. This is now only available in Windows server.  
In a client OS, the Shadow Copy service will only be able to create **volatile** shadow copies for backup purposes.

Shadow copies on an NTFS volume will be deleted if the NTFS volume is subsequently mounted on an older operating system, either by dual booting or by moving the hard drive.

Use DiskShadow to:

*   Create a hardware or software shadow copy that can be subsequently exposed as a read-only volume.
*   Create a hardware transportable shadow copy that can be imported on a different computer - used for backups or data mining.
*   Import a shadow copy created earlier to replace a volume that has become corrupt.
*   Convert a shadow copy into a read-write volume.

DiskShadow is not supported on Windows Server 2003 or Vista.  
DiskShadow.exe replaced vshadow in Windows Server 2008 onwards (vshadow is still available for backwards compatibility).

### Examples

List all shadows, including their aliases:

C:> diskshadow.exe list shadows all

Remove the imported shadow copy %Import_1%:

C:> diskshadow.exe mask %Import_1%

Create a VSS snapshop of drive D: and expose it as Read-Only drive S:

C:> diskshadow.exe  
Set context persistent  
ADD volume D: alias ddrive  
Set verbose on  
CREATE  
expose %ddrive% S:  
Now backup the contents of S: (with copy or robocopy)  
When no longer needed, delete the snapshop and remove S:  
DELETE shadows volume D:  
unexpose S:  

Create a VSS snapshop of drive D:

C:> diskshadow.exe  
Set context persistent  
Set option TRANSPORTABLE  
Set metadata C:\docs\ss64.cab  
ADD VOLUME D:  
CREATE  
END BACKUP  
#The (transportable) shadow copy is not in the system yet.  
#You can reset or exit now if you wish.  
\# Import the diskshadow  
Load metadata C:\docs\ss64.cab  
IMPORT  
#The shadow copy will now be loaded into the system.

“I don’t need a friend who changes when I change and who nods when I nod; my shadow does that much better” ~ Plutarch

### Related commands

[DISKPART](diskpart.html) - Disk Administration.  
[VSSADMIN](vssadmin.html) - Volume Shadow Copy.  
[Where’s my disk space](https://docs.microsoft.com/en-gb/archive/blogs/askcore/wheres-my-disk-space) - Jeff Hughes [MSFT]



/. nt/diskuse.html
========================================================

    Diskuse - Disk usage - Windows CMD - SS64.com

DISKUSE ([2003 Resource Kit](../links/windows.html#kits))
=========================================================

Display disk usage.

Syntax

      DISKUSE _path_ _options_

Options
    /f:_file_   Store results in _file_
    /e:_file_   Store errors in _file_
    /u:_user_   Only search for _user_
    /s        Include subdirectories
    /t        Table format
    /w        Unicode output
    /q        Quiet
    /? |h     Help
    /r:file   Store restrictions in file
    /o        Show only users over the limit
    /v        verbose mode
    /d:a|c|w  Date to display   Access | Create | Write
    /n:_number_ Display _number_ largest files per user
    /x:_number_ Display files of _number_ bytes or larger

### Examples

List the files in the current folder and subfolders in verbose mode  
C:\demo> DISKUSE /v /s

“Work is achieved by those employees who have not yet reached their level of incompetence” ~ Laurence J. Peter (The Peter Principle)

### Related commands

[DIR](dir.html) - Display a list of files and folders.  
DirQuota - Create and manage quotas (File Server Resource Manager).  
[DU](du.html) - Display directory sizes/usage.  
You can also list files with [XCOPY](xcopy.html) /L  
[FREEDISK](freedisk.html) - Check free disk space.  
[FSUTIL](fsutil.html) - File and Volume utilities.  
Equivalent PowerShell: ([Get-ChildItem](../ps/get-childitem.html) C:\docs* -recurse) | measure-object -property length -sum  
Equivalent bash command (Linux): [quotacheck](../bash/quotacheck.html) - Scan a file system for disk usage.



/. nt/dism.html
========================================================

    DISM - Deployment Image Servicing and Management - Windows CMD - SS64.com

DISM.exe
========

Deployment Image Servicing and Management tool. DISM enumerates, installs, uninstalls, configures, and updates **features** and **packages** in Windows images. The commands that are available depend on the image being serviced and whether the image is offline or running (online).

Syntax

      DISM.exe [_dism_options_] {_Imaging_command_} [_Imaging_arguments_]

      DISM.exe {/Image:_path_to_offline_image_ | **/Online**} [_dism_options_]
         {_servicing_command_} [_servicing_arguments_]

Generic Imaging options:

    [/Apply-Image](#apply-image)           - Apply an image.
    [/Split-Image](#split-image)           - Split an existing .wim file into multiple 
                            read-only split WIM (SWM) files.
    [/Get-ImageInfo](#get-imageInfo)         - Display information about images in a WIM, a VHD or a FFU file.
    [/Get-MountedImageInfo](#get-mountedimageinfo)  - Display information about mounted WIM and VHD images.
    [/Commit-Image](#commit-image)          - Save changes to a mounted WIM or VHD image.
    [/Mount-Image](#mount-image)           - Mount an image from a WIM or VHD file.
    [/Unmount-Image](#unmount-image)         - Unmounts a mounted WIM or VHD image.
    [/Remount-Image](#remount-image)         - Recover an orphaned image mount directory.
    [/Cleanup-Mountpoints](#cleanup-mountpoints)   - Delete resources associated with corrupted mounted images.

Image Specifications:

    /Online                - Target the running operating system.
    [/Image](#image)                 - Specify the path to the root directory of an offline Windows image.

WIM options:

    [/Apply-CustomDataImage](#apply-customdataimage) - Dehydrate files contained in the custom data image.
    [/Capture-CustomImage](#capture-customimage)   - Capture customizations into a delta WIM file on a WIMBoot system.
                            Captured directories include all subfolders and data.
    [/Get-WIMBootEntry](#get-wimbootentry)      - Display WIMBoot configuration entries for the specified disk volume.
    [/Update-WIMBootEntry](#update-wimbootentry)   - Update WIMBoot configuration entry for the specified disk volume.
    /[Append-Image](#append-image)          - Add another image to a WIM file.
    [/List-Image](#list-image)            - Display a list of the files and folders in a specified image.
    [/Export-Image](#export-image)          - Export a copy of the specified image to another file.
    [/Delete-Image](#delete-image)          - Delete a volume image from a WIM file that has multiple volume images.
    [/Capture-Image](#capture-image)         - Capture an image of a drive into a new WIM file.
                            Captured directories include all subfolders and  data.
    [/Get-MountedWimInfo](#get-mountedwiminfo)    - Display information about mounted WIM images.
    [/Get-WimInfo](#get-wiminfo)           - Display information about images in a WIM file.
    [/Commit-Wim](#commit-wim)            - Save changes to a mounted WIM image.
    [/Mount-Wim](#mount-wim)             - Mount an image from a WIM file.
    [/Unmount-Wim](#unmount-wim)           - Unmount a mounted WIM image.
    [/Remount-Wim](#remount-wim)           - Recover an orphaned WIM mount directory.
    [/Cleanup-Wim](#cleanup-wim)           - Delete resources associated with mounted WIM images that are corrupt.

Full Flash Update ([FFU](https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/deploy-windows-using-full-flash-update--ffu)) options:

    [/Apply-Ffu](#apply-ffu)             - Apply an .ffu image.
    [/Capture-Ffu](#capture-ffu)           - Capture a physical disk image into a new FFU file.
    [/Optimize-FFU](#optimize-ffu)          - Optimize an FFU image to be faster to deploy, and more easily deployed to differently-sized disks.
    [/Split-Ffu](#split-ffu)             - Split an existing .ffu file into multiple read-only split FFU files.

DISM (Deployment Image Servicing and Management) options:

    [/English](#english)               - Display command line output in English.
    [/Format](#format)                - Specify the report output format.
    [/LogPath](#logpath)               - Specify the logfile path.
    [/LogLevel](#loglevel)              - Specify the output level shown in the log (1-4).
    [/NoRestart](#norestart)             - Suppress automatic reboots and reboot prompts.
    /Quiet                 - Suppress all output except for error messages.
    [/ScratchDir](#scratchdir)            - Specify the path to a scratch directory.
    [/SysDriveDir](#sysdrivedir)           - Specify the path to the system-loader file named  BootMgr.
    [/WinDir](#windir)                - Specify the path to the Windows directory.

The following commands may be used to service the image:

OS UNINSTALL SERVICING options:

    /Set-OSUninstallWindow  - Set the OS Uninstall Window.
    /Get-OSUninstallWindow  - Get the OS Uninstall Window.
    /Remove-OSUninstall     - Remove the OS Uninstall.
    /Initiate-OSUninstall   - Initiate the OS Uninstall

WINDOWS EDITION SERVICING options:

    [/Optimize-Image](#optimize-image)         - Configure an offline image.
    [/Apply-SiloedPackage](#apply-siloedpackage)    - Apply one or more siloed provisioning packages (SPPs) to a specified image.
    /Set-ProductKey         - Set the product key of the offline image.
    /Get-TargetEditions     - Display a list of Windows editions that an image 
                             can be upgraded to.
    /Get-CurrentEdition     - Display the edition of the current image.
    /Set-Edition            - Upgrade an image to a higher edition.

DEFAULT ASSOCIATIONS options:

    /Remove-DefaultAppAssociations - Remove the default application associations
                                    from a Windows image.
    /Import-DefaultAppAssociations - Import a set of default application 
                                    associations to a Windows image.
    /Get-DefaultAppAssociations    - Display the list of default application 
                                    associations from a Windows image.
    /Export-DefaultAppAssociations - Export the default application [associations](assoc.html)
                                    from a running operating system.

      e.g. Dism /Online /Export-DefaultAppAssociations:C:\demo\AppAssoc.xml

PROVISIONING PACKAGE SERVICING options:

    /Get-ProvisioningPackageInfo - Get information about a provisioning package.
    /Add-ProvisioningPackage     - Add a provisioning package.

APPX SERVICING options:

    /Get-NonRemovableAppPolicy - List the package families configured 
                                to be nonremovable by enterprise policy.
    /Set-NonRemovableAppPolicy - Set the enterprise nonremovable policy for 
                                a given package family. 
    /Optimize-ProvisionedAppxPackages - Optimize provisioned appx footprint by 
                                       hard-linking identical files across appx packages.
    /Set-ProvisionedAppxDataFile - Place custom data into the specified app 
                                  package (.appx or .appxbundle). The specified  
                                  application package must already be in the image.
    /Remove-ProvisionedAppxPackage - Remove app packages (.appx or .appxbundle)
                                    from the image. App packages will not be installed 
                                    when new user accounts are created.
    /Add-ProvisionedAppxPackage  - Add app packages (.appx or .appxbundle) to the
                                  image and set them to install for each new user.
    /Get-ProvisionedAppxPackages - Display information about app packages 
                                  (.appx or .appxbundle) in an image that are 
                                  set to install for each new user.

UNATTEND SERVICING options:

    /Apply-Unattend     - Apply an unattend file to an image.

DRIVER SERVICING options:

    /Remove-Driver      - Remove driver packages from an offline image.
    /Add-Driver         - Adds driver packages to an offline image.
    /Get-DriverInfo     - Display information about a specific driver
                         in an offline image or a running operating system.
    /Get-Drivers        - Display information about all drivers in
                         an offline image or a running operating system.
    /Export-Driver      - Export all third-party driver packages from an
                         offline image or a running operating system.

INTERNATIONAL SERVICING options:

    /Set-LayeredDriver  - Set the keyboard layered driver.
    /Set-UILang         - Set the default system UI language that is used
                         in the mounted offline image.
    /Set-UILangFallback - Set the fallback default language for the system 
                         UI in the mounted offline image.
    /Set-UserLocale     - Set the user locale in the mounted offline image.
    /Set-SysLocale      - Set the language for non-Unicode programs (also
                         called system locale) and font settings in the 
                         mounted offline image.
    /Set-InputLocale    - Set the input locales and keyboard layouts to 
                         use in the mounted offline image.
    /Set-TimeZone       - Set the default time zone in the mounted offline
                         image.
    /Set-AllIntl        - Set all international settings in the mounted
                         offline image.
    /Set-SKUIntlDefaults - Set all international settings to the default
                          values for the specified SKU language in the
                          mounted offline image.
    /Gen-LangIni        - Generate a new lang.ini file.
    /Set-SetupUILang    - Define the default language that will be used
                         by setup.
    /Get-Intl           - Display information about the international 
                         settings and languages.

APPLICATION SERVICING options:

    /Check-AppPatch     - Display information if the MSP patches are 
                         applicable to the mounted image.
    /Get-AppPatchInfo   - Display information about installed MSP patches.
    /Get-AppPatches     - Display information about all applied MSP patches
                         for all installed applications.
    /Get-AppInfo        - Display information about a specific installed MSI
                         application.
    /Get-Apps           - Display information about all installed MSI
                         applications.

PACKAGE SERVICING options:

    /Add-Package        - Add packages to the image.
    /Remove-Package     - Remove a package from the image.
    /Enable-Feature     - Enable a specific feature in the image.
    /Disable-Feature    - Disable a specific feature in the image.
    /Get-Packages       - Display information about all packages in the image.
    /Get-PackageInfo    - Display information about a specific package.
    /Get-Features       - Display information about all features in a package.
    /Get-FeatureInfo    - Display information about a specific feature.
    /Cleanup-Image      - Performs cleanup and recovery operations on the image.
    /Export-Source      - Export a set of capabilities into a new repository.
    /Add-Capability     - Add one or more capabilities to an image.
    /Remove-Capability  - Remove a capability from one image.
    /Get-Capabilities   - Get capabilities in the image.
    /Get-CapabilityInfo - Get information of a capability in the image.

For more information about these servicing commands and their arguments,
specify a command immediately before /?.

     Examples: 
         DISM.exe /Online /Get-Capabilities

         DISM.exe /Image:C:\test\offline /Apply-Unattend /?
         DISM.exe /Online /Get-Drivers /?
         DISM.exe /Online /Cleanup-Image /?
         Install one of the [RSAT tools](rsat.txt):
         DISM.exe /Online /add-capability /CapabilityName:Rsat.ActiveDirectory.DS-LDS.Tools~~~~0.0.1.0
KEY:
    Apply an image to a specified drive:
    **/Apply-Image** /ImageFile:_path_to_image_file_ /ApplyDir:_target_directory_ [/ApplyDrive _DeviceID_]
      {/Index:_image_index_ | /Name:_image_name_} [/CheckIntegrity] [/Verify] 
         [/NoRpFix] [/SWMFile:_pattern_] [/ConfirmTrustedFile] [/WIMBoot] [/Compact] [/EA]

     /CheckIntegrity  - Stop the operation if WIM file corruption is detected.
     /Verify          - Check for errors and file duplication. 
     /NoRpFix         - Disable the reparse point tag fix. 
     /SWMFile         - Reference split WIM files (SWMs).
                        _pattern_ is the naming  pattern and location of split files. 
     /ConfirmTrustedFile - Validate the image for Trusted Desktop on Windows 10, 8.1, or 8.
                        When using /Apply-Image with the /ConfirmTrustedFile option in WinPE, always
                        specify the /ScratchDir option pointed to a physical media location.
                        This ensures that short file names will always be available.
                        Use /EA to apply extended attributes.
     /WIMBoot         - Apply the image with WIMBoot configuration. 
     /Compact         - Apply the image in compact mode. 
     /EA              - Apply extended attributes.
     /ApplyDrive      - The logical drive, using the DeviceID.
                        To get the device ID from the command line, type "wmic diskdrive list brief".
                        A VHD may appear with the name “PhysicalDrive” in the description, e.g. .\PhysicalDrive2

     /SFUFile         - Reference split FFU files (SFUs).
                        _pattern_ is the naming  pattern and location of split files. 

    Examples: 
      DISM.exe /Apply-Image /ImageFile:install.wim /Index:1 /ApplyDir:D:\ 

      DISM.exe /Apply-Image /ImageFile:install.swm /SWMFile:install*.swm 
        /ApplyDir:D:\ /Index:1 

    Split an existing .wim file into multiple read-only split WIM files:
    **/Split-Image** /ImageFile:_path_to_image_file_ /SWMFile:_path_to_swm_
        /FileSize:_MB-Size_ [/CheckIntegrity] 

     /FileSize       - Maximum size in megabytes (MB) for each created file. 
                       If a single file is larger than the value specified, one of the split .swm files that
                       results will be larger than the value specified, in order to accommodate the large file.

     /CheckIntegrity - Detect and track WIM file corruption when used with capture, unmount, export, and
                       commit operations. /CheckIntegrity stops the operation if DISM detects that the .wim file
                       is corrupted when used with apply and mount operations.. 

    Example: 
      DISM.exe /Split-Image /ImageFile:install.wim /SWMFile:split.swm /FileSize:650 


    Display information about the images that the specified WIM or VHD file contains:
    **/Get-ImageInfo** /ImageFile:_image_file_ [/Index:_image_index_ | /Name:_image_name_] 

    Examples: 
      DISM.exe /Get-ImageInfo /ImageFile:C:\test\images\ss64.wim 
      DISM.exe /Get-ImageInfo /ImageFile:C:\test\images\ss64.vhd /Index:1 
      DISM.exe /Get-ImageInfo /ImageFile:C:\test\images\ss64.ffu 

    Display information about mounted images, including whether the image 
    is ready for servicing, needs a remount, or is an invalid image:
    **/Get-MountedImageInfo** 

    Example: 
      DISM.exe /Get-MountedImageInfo 

    Apply changes to the mounted image:
    The image remains mounted until the /Unmount-Image option is used. 
    **/Commit-Image** /MountDir:_target_mount_directory_ [/Append] [/CheckIntegrity] 
  
     /Append         - Add the image to an existing .wim file. 
     /CheckIntegrity - Detect and track WIM file corruption. 

    Example: 
      DISM.exe /Commit-Image /MountDir:C:\test\offline 

    Mount the image to the specified directory so that it is available for servicing:
    **/Mount-Image** /ImageFile:_path_to_image_file_ 
      {/Index:_image_index_ | /Name:_image_name_} /MountDir:_target_mount_directory_ 
         [/ReadOnly] [/Optimize] [/CheckIntegrity] 
   
     /Optimize       - Reduce initial mount time. 
     /CheckIntegrity - Stop the operation if WIM file corruption is detected.
     /ReadOnly       - Set the mounted image to have read-only permissions. 

    Examples: 
      DISM.exe /Mount-Image /ImageFile:C:\test\images\myimage.wim /Index:1 
        /MountDir:C:\test\offline 

      DISM.exe /Mount-Image /ImageFile:C:\test\images\myimage.vhd /Index:1 
        /MountDir:C:\test\offline /ReadOnly 

    Unmount the WIM or VHD. Use /Commit to save the changes or /Discard to discard:
    **/Unmount-Image** /MountDir:_target_mount_directory_
      {/Discard | /Commit [/Append] [/CheckIntegrity]}
  
     /CheckIntegrity  - Detect and track WIM file corruption. 
     /Append          - Add the image to an existing .wim file. 

    Examples: 
      DISM.exe /Unmount-Image /MountDir:C:\test\offline /Commit 
      DISM.exe /Unmount-Image /MountDir:C:\test\offline /Discard 

    Recover an orphaned image mount directory:
    **/Remount-Image** /MountDir:_target_mount_directory_ 

    Example: 
      DISM.exe /Remount-Image /MountDir:C:\test\offline 

    Delete resources associated with a corrupted mounted image:
    **/Cleanup-Mountpoints** 

    This command does not unmount a mounted image. It also does not delete 
    images that can be recovered by using the /Remount-Image command. 

    Example: 
      DISM.exe /Cleanup-Mountpoints 

    The path to the root directory of the offline Windows image:
    **/Image**:_path_to_offline_image_

    This option must be used with a servicing command. 

    Example:     
      DISM.exe /Image:C:\test\offline /Get-Packages

    Dehydrate files contained in the custom data image to save space:
    **/Apply-CustomDataImage** /SingleInstance /CustomDataImage:_packge_path_ /ImagePath:_image_Path_

    Example: 
      DISM.exe /Apply-CustomDataImage /CustomDataImage:C:\oem.ppkg /ImagePath:C:\ /SingleInstance 

    Capture image customizations into a new WIM file on a WIMBoot system:
    **/Capture-CustomImage** /CaptureDir:_source_directory_ [/ConfigFile:_wimscript.ini_]
      [/CheckIntegrity] [/Verify] [/ConfirmTrustedFile] 

     /ConfigFile         - Location of a configuration file to list exclusions for image capture and compress commands. 
     /CheckIntegrity     - Detect and track WIM file corruption. 
     /Verify             - Check for errors and file duplication. 
     /ConfirmTrustedFile - Validate the image for Trusted Desktop. [Supported platforms](https://go.microsoft.com/fwlink/?LinkID=309482). 

     Captured directories include all subfolders and data. You cannot capture an empty directory.
     Note: this command only captures the customization files.
     It cannot be used to capture the installation files into a new WIM.

    Example: 
      DISM.exe /Capture-CustomImage /CaptureDir:D:\ 

    Display WIMBoot configuration entries for the specified disk volume
    This only applies to Windows 8.1; this feature isn't supported in Windows 10:
    **/Get-WIMBootEntry** /Path:_volume_path_

    Update WIMBoot configuration entry, associated with the specified 
    data source ID, with the renamed or moved image file path:
    **/Update-WIMBootEntry** /Path:_volume_path_ /DataSourceID:_data_source_id_ 
      /ImageFile:_renamed_image_path_

     /Path         - The disk volume of the WIMBoot configuration. 
     /DataSourceID - The data source ID as displayed by Get-WIMBootEntry. 

    Example: 
      DISM.exe /Update-WIMBootEntry /Path:C:\ /DataSourceID:0 
        /ImageFile:R:\Install.wim 

    Add another image to a WIM file:
    **/Append-Image** /ImageFile:_path_to_image_file_ /CaptureDir:_source_directory_ 
      /Name:_Name_ [/Description:Description] [/ConfigFile:_wimscript.ini_] 
         {[/Bootable] | [/WIMBoot]} [/CheckIntegrity] [/Verify] [/NoRpFix] [/EA]

  
     /ConfigFile     - Location of a configuration file that lists 
                       exclusions for image capture and compress commands. 
     /Bootable       - Mark a Windows PE volume image as able to be booted. 
     /WIMBoot        - Append a WIMBoot configured image to a WIM file. 
     /CheckIntegrity - Detect and track WIM file corruption. 
     /Verify         - Check for errors and file duplication. 
     /NoRpFix        - Disable the reparse point tag fix. 
     /EA             - Capture Extended Attributes. 

    Example: 
      DISM.exe /Append-Image /ImageFile:install.wim /CaptureDir:D:\ /Name:Drive-D

    Display a list of the files and folders within a specified image:
    **/List-Image** /ImageFile:_path_to_image_file_  {/Index:_image_index_ | /Name:_image_name_} 

    Example: 
      DISM.exe /List-Image /ImageFile:install.wim /Index:1 

    Export a copy of the specified image to another file:
    **/Export-Image** {/SourceImageFile:_path_to_image_file_ | [/SWMFile:_pattern_]}
      {/SourceIndex:_image_index_ | /SourceName:_image_name_} 
         /DestinationImageFile:_path_to_image_file_ [/DestinationName:_Name_] 
            {[/Compress:{fast|max|none|recovery}] [/Bootable] | [/WIMBoot]} [/CheckIntegrity] 

    The source and destination files must use the same compression type.

     /SWMFile       - Reference split WIM files (SWMs).
                      _pattern_ is the naming pattern and location of split files. 
     /Compress      - The capture compression used when exporting an image to a new WIM file. 
     /Bootable      - Mark a Windows PE volume image as able to be booted. 
     /WIMBoot       - Export an image that can be applied with WIMBoot configuration. 
     /CheckIntegrity - Detect and track WIM file corruption. 

    Example: 
      DISM.exe /Export-Image /SourceImageFile:install.wim /SourceIndex:1 
        /DestinationImageFile:install2.wim 

    Delete a volume image from a WIM file that has multiple volume images. 
    **/Delete-Image** /ImageFile:_path_to_image_file_ 
      {/Index:_image_index_ | /Name:_image_name_} [/CheckIntegrity] 

     /CheckIntegrity - Detect and track .wim file corruption when used with capture, unmount, export,
                       and commit operations. /CheckIntegrity will stop the operation if DISM detects
                       that the .wim file is corrupted when used with apply and mount operations.

    Example: 
      DISM.exe /Delete-Image /ImageFile:install.wim /Index:1 

    Capture an image of a drive to a new WIM file:
    **/Capture-Image** /ImageFile:_path_to_image_file_ /CaptureDir:_source_directory_ 
      /Name:_Name_ [/Description:Description] [/ConfigFile:_wimscript.ini_] 
         {[/Compress:{fast|max|none}] [/Bootable] | [/WIMBoot]}
            [/CheckIntegrity] [/Verify] [/NoRpFix] [/EA]

  Captured directories include all subfolders and data. You cannot capture an empty directory.

     /ConfigFile - A config file listing exclusions for image capture and compress commands. 
     /Compress   - The type of compression used for the initial capture operation. 
     /Bootable   - Mark a Windows PE volume image as able to be booted. 
     /WIMBoot    - Capture the image that can be applied with WIMBoot configuration. 
     /CheckIntegrity - Detect and track WIM file corruption. 
     /Verify     - Check for errors and file duplication. 
     /NoRpFix    - Disable the reparse point tag fix. 
     /EA         - Capture extended attributes. 

    Example: 
      DISM.exe /Capture-Image /ImageFile:install.wim /CaptureDir:D:\ 
        /Name:Drive-D

    Display information about mounted images:
    **/Get-MountedWimInfo** 

  Includes whether the image is ready for servicing, needs a remount, or is an invalid image. 

    Example: 
      DISM.exe /Get-MountedWimInfo 

    Display information about the images contained in the specified WIM file:
    **/Get-WimInfo** /WimFile:_WIM_file_ [/Index:_image_index_ | /Name:_image_name_] 

    Examples: 
      DISM.exe /Get-WimInfo /WimFile:C:\test\images\myimage.wim 

      DISM.exe /Get-WimInfo /WimFile:C:\test\images\myimage.wim /Index:1 

    Apply changes to the mounted image:
    **/Commit-Wim** /MountDir:_target_mount_directory_ [/EA]

    The image remains mounted until /Unmount-Wim is used.
     /EA - Save extended attributes. 

    Example: 
      DISM.exe /Commit-Wim /MountDir:C:\test\offline 

    Mount the WIM file to the specified directory so that it is available for servicing. 
    **/Mount-Wim** /WimFile:_path_to_WIM_file_ 
      {/Index:_image_index_ | /Name:_image_name_} 
         /MountDir:_target_mount_directory_ [/ReadOnly] [/EA]

     /ReadOnly   - Set the mounted image to have read-only permissions. 
     /EA         - Mount with extended attributes. 

    Examples: 
      DISM.exe /Mount-Wim /WimFile:C:\test\images\myimage.wim /index:1 
        /MountDir:C:\test\offline 

      DISM.exe /Mount-Wim /WimFile:C:\test\images\myimage.wim /index:1 
        /MountDir:C:\test\offline /ReadOnly 

    Unmount the WIM file:
    **/Unmount-Wim** /MountDir:_target_mount_directory_ {/Commit | /Discard} [/EA]

     /Commit  - Save the changes
     /Discard - Discard the changes. 
     /EA      - Save extended attributes. 

    Examples: 
      DISM.exe /Unmount-Wim /MountDir:C:\test\offline /commit 

      DISM.exe /Unmount-Wim /MountDir:C:\test\offline /discard 

    Recover an orphaned WIM mount directory:
    **/Remount-Wim** /MountDir:_target_mount_directory_ 

    Example: 
      DISM.exe /Remount-Wim /MountDir:C:\test\offline 

    Delete resources associated with a corrupted mounted image:
    **/Cleanup-Wim** 

    This command does not unmount a mounted image; it also does not delete 
    images that can be recovered by using the /Remount-WIM command. 

    Example: 
      DISM.exe /Cleanup-Wim 

    Apply an .ffu image to a specified physical drive:
    **/Apply-Ffu** /ImageFile:_path_to_image_file_ /ApplyDrive:_physical_drive_path_ 
  [/SFUFile:_pattern_] 


  Use /SFUFile to reference split FFU files (SFUs). _pattern_ is the naming 
  pattern and location of split files. 

    Examples: 
      DISM.exe /Apply-Ffu /ImageFile:flash.ffu 
        /ApplyDrive:\.\PhysicalDrive0 

    Capture a physical disk image to a new FFU file:
    **/Capture-Ffu** /ImageFile:_path_to_image_file_ /CaptureDrive:_physical_drive_path_ 
     /Name:_Name_ [/Description:Description] [/PlatformIds:_platform_ids_] 
        [/Compress:{default|none}] 

     /PlatformIds  - One or more platform ids (separate with semicolon) to be add
                     to the image. If not specified, platform id will be '*'.

     /Compress     - The type of compression used for the initial capture operation. 

    Example: 
      DISM.exe /Capture-Ffu /ImageFile:install.ffu 
        /CaptureDrive:\.\PhysicalDrive0 /Name:Drive0 
        /PlatformIds:Qualcomm.MSM8994.P6211;Microsoft.MSM8994.P6211 
        /Compress:default 

    Optimize an FFU image to be faster to deploy, and more easily deployed to differently-sized disks.
    **/Optimize-FFU** /ImageFile:_path-to-ffu-file_ [/PartitionNumber:_PartitionNumber_]

     /ImageFile     - Path to the FFU you want to optimize.
     /PartitionNumber - By default /Optimize-FFU optimizes the OS partition.
                        This option allows you to specify the partition that you want to optimize.

    This command should be the last command run against an image before the image is applied to a device,
    and can reduce time on the factory floor when building devices for build-to-stock scenarios.

     DISM.exe /Image:C:\test\offline **/Optimize-Image** {/Boot | /WimBoot}

     /Boot  Tries to reduce the online configuration time that the OS spends during boot.
            This optimization may be rendered invalid if any servicing operations are performed on the image
            after optimizing it.  DISM /Optimize-Image /boot is available in the following operating systems: Windows 11,
            Windows 10, version 1607,Windows 10, version 1809 and later, Windows Server 2012 R2 later

            Use /Boot to try and reduce the online configuration time that the OS spends during boot.
            Note that this optimization may be rendered invalid if any servicing operations are performed
            on the image after optimizing it.
     /WimBoot is for configuring an offline image for installing on a WIMBoot system.

    Examples: DISM.exe /Image:C:\test\offline /Optimize-Image /Boot
              DISM.exe /Image:C:\test\offline /Optimize-Image /WimBoot

    Applies one or more siloed provisioning packages (SPPs) to a specified image.
      This option is only available after running CopyDandI.cmd from the ADK, Version 1607 or later, and running
      dism.exe /Apply-SiloedPackage from the target folder created by CopyDandI.cmd.

      /Apply-SiloedPackage can only be run once against a Windows image, but /PackagePath can used more than once
      in the same command to apply multiple SPPs. SPPs will be applied in the specified order, so a dependency should
      be specified before the SPP that depends on it. see [Siloed provisioning packages](https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/siloed-provisioning-packages?view=windows-11).

      **/Apply-SiloedPackage** /PackagePath:_package_path_ /ImagePath:_applied_image_path_

      /PackagePath - Specifies the path of a siloed provisioning package file.
      /ImagePath - Specifies the path of the Windows image where you are applying the SPP.
    Example: 
      DISM.exe /apply-SiloedPackage /PackagePath:C:\test\Word.spp /PackagePath:C:\test\spp2.spp /ImagePath:C:\

    Split an existing .ffu file into multiple read-only split FFU files. 
    **/Split-Ffu** /ImageFile:_path_to_image_file_ /SFUFile:_path_to_sfu_
      /FileSize:_MB-Size_ [/CheckIntegrity] 

     /FileSize - The maximum size in megabytes (MB) for each created file. 
                 If a single file is larger than the value specified in the /FileSize option, one of the
                 split .swm files that results will be larger than the value specified in the /FileSize option,
                 in order to accommodate the large file.

     /CheckIntegrity
                 Detect and track .wim file corruption when used with capture, unmount, export, and commit operations.
                 /CheckIntegrity stops the operation if DISM detects that the .wim file is corrupted when used
                 with apply and mount operations.

     /ImageFile  Specifies the path of a .FFU file, example: flash.ffu.
     /SFUFile    References split FFU files (SFUs). Pattern is the naming pattern and location of split files.

    Example: 
      DISM.exe /Split-Ffu /ImageFile:flash.ffu /SFUFile:flash.sfu /FileSize:650

    Display command line output in English:
    **/English**

    Examples:
     DISM.exe /Image:C:\test\offline /Format:Table /English /Get-Packages
     DISM.exe /Image:C:\test\offline /English /Get-DriverInfo /Driver:oem0.inf

    Specify the output format of a report:
    **/Format**:_output_format_

    The option has no effect when used with a command that does not generate reports, or
    a command that does not support this option.  The accepted values for _output_format_ are:
      Table = Display the report in a table.
      List = Display the report in a list of name/value pairs.

    Examples:
     DISM.exe /Image:C:\test\offline /Format:Table /Get-Packages
     DISM.exe /Image:C:\test\offline /Format:List /Get-Features
     DISM.exe /Image:C:\test\offline /Format:Table /Get-Drivers
     DISM.exe /Image:C:\test\offline /Format:List /Get-Apps
     DISM.exe /Image:C:\test\offline /Format:Table /Get-AppPatches

    Specify the path to the DISM logfile:
    **/LogPath**:_path_to_logfile_

    If not specified, the default is %windir%\Logs\DISM\dism.log.

    Example:
      DISM.exe /Image:C:\test\offline /logpath:C:\LogFiles\dism.log 

    Specify the maximum output level shown in logs:
    **/LogLevel**:_n_

    The accepted values for _n_:
    1 = Errors only
    2 = Errors and warnings
    3 = Errors, warnings, and information
    4 = All the above and debug output

  If not specified, _n_ defaults to 3 (maximum logging).

    Example:
      DISM.exe /Image:C:\test\offline /loglevel:1 

    Suppress restart prompting:
    **/NoRestart**

    Example:
      DISM.exe /Online /norestart

    A temporary directory to be used for extracting files for servicing:
    **/ScratchDir**:_path_to_directory_

    The directory must exist, If not set, the Windows Profile temporary directory will be used.

    Example:
      DISM.exe /Image:C:\test\offline /scratchdir:D:\Scratch

    Specify the path to the directory of the bootmgr file:
    /Image:_path_to_offline_image_ [**/SysDriveDir**:_path_to_bootmgr_]

    If not specified, it defaults to the offline image path.
    This option cannot be used with the /Online option.

    Example:
      DISM.exe /Image:C:\test\offline /SysDriveDir:C:\

    Specify the path to the Windows directory relative to the image path:
    /Image:_path_to_offline_image_ [**/WinDir**:_Windows_directory_]

    If not specified, it defaults to "Windows".
    This option cannot be used with the /Online option.

    Example:
      DISM.exe /Image:C:\test\offline /WinDir:Win

DISM commands are used on offline images, but subsets of the DISM commands are also available for servicing a running operating system.

The DISM PowerShell cmdlets are largely identical to the command-line tool, but DISM.exe does include some additional functionality to support servicing commands for international settings.

“Do not spoil what you have by desiring what you have not; remember that what you now have was once among the things you only hoped for” ~ Epicurus (Greek philosopher)

### Related commands

[PowerShell DISM cmdlets](https://docs.microsoft.com/en-us/powershell/module/dism/?view=win10-ps)  
[Get-WindowsCapability](../ps/get-windowscapability.html) - Get capabilities for an image or a running OS.  
[Add-WindowsCapability](../ps/add-windowscapability.html) - Install a Windows capability package on the specified OS image.  
[Docs.microsoft.com](https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/deployment-image-servicing-and-management--dism--command-line-options) - DISM Command-Line Options.  
[Get-Windows-Key](../ps/syntax-product-key.html) - Retrieve the Windows product key.



/. nt/displayswitch.html
========================================================

    DISPLAYSWITCH - Windows CMD - SS64.com

DISPLAYSWITCH.exe
=================

Specify which display to use and how to use it.

Syntax

      DISPLAYSWITCH /_Option_  
Options

       /internal    Switch to use the primary display only.
       1            All other connected displays will be disabled. 

       /clone       The primary display will be mirrored on a second screen.
       2        

       /extend      Expand the Desktop to a secondary display.
       3            This allows one desktop to span multiple displays. (Default).

       /external    Switch to the external display only (second screen).
       4            The current main display will be disabled.

Running DisplaySwitch.exe without any options will open a GUI.  
The command is located at: "%[SystemRoot](syntax-variables.html)%\System32\DisplaySwitch.exe"

### Examples

Mirror the current Desktop on a secondary display:

C:> DisplaySwitch /clone

Extend the Desktop to a secondary display:

C:> DisplaySwitch 3

"The mission of the press is to spread culture while destroying the attention span" ~ Karl Kraus

### Related commands

[MODE](mode.html) - Configure a system device COM/LPT/CON



/. nt/dnscmd.html
========================================================

    DnsCmd - Windows CMD - SS64.com

DNSCMD
======

Manage DNS servers, unattended setup and configuration of new DNS servers.

Syntax

      DnsCmd  _ServerName Command_ [_Command Parameters_]
 
    _ServerName_:
       IP address or host name    -- remote or local DNS server
       .                          -- DNS server on local machine

    _Command_:
    /ageallrecords    Set the current time on all time stamps in a zone or node.
    /clearcache       Clear the DNS server cache.
    /config           Reset the DNS server or zone configuration.
    /createbuiltindirectorypartitions    Create the built-in DNS application directory partitions.
    /createdirectorypartition    Create a DNS application directory partition.
    /deletedirectorypartition    Delete a DNS application directory partition.
    /directorypartitioninfo      List information about a DNS application directory partition.
    /enlistdirectorypartition    Add a DNS server to the replication set of a DNS application directory partition.
    /enumdirectorypartitions    List the DNS application directory partitions for a server.
    /enumrecords     List the resource records in a zone.
    /enumzones       List the zones hosted by the specified server.
    /exportsettings  Write server configuration information to a text file.
                     %systemroot%\system32\dns\DnsSettings.txt
    /info            Get server information.
    /ipvalidate      Validate remote DNS servers.
    /nodedelete      Delete all records for a node in a zone.
    /recordadd       Add a resource record to a zone.
    /recorddelete    Remove a resource record from a zone.
    /resetforwarders       Set DNS servers to forward recursive queries.
    /resetlistenaddresses  Set server IP addresses to serve DNS requests.
    /startscavenging    Initiate server scavenging.
    /statistics      Query or clear server statistics data.
    /unenlistdirectorypartition    Remove a DNS server from the replication set of a DNS application directory partition.
    /writebackfiles    Save all zone or root-hint data to a file.
    /zoneadd           Create a new zone on the DNS server.
    /zonechangedirectorypartition    Change the directory partition on which a zone resides.
    /zonedelete        Deletes a zone from the DNS server.
    /zoneexport        Write the resource records of a zone to a text file,
                       located in %systemroot%\system32\dns
    /zoneinfo       Display zone information.
    /zonepause      Pause a zone.
    /zoneprint      Display all records in the zone.
    /zonerefresh    Force a refresh of the secondary zone from the master zone.
    /zonereload     Reload a zone from its database.
    /zoneresetmasters    Change the master servers that provide zone transfer information to a secondary zone.
    /zoneresetscavengeservers Change the servers that can scavenge a zone.
    /zoneresetsecondaries     Reset secondary information for a zone.
    /zoneresettype     Change the zone type.
    /zoneresume        Resume a zone.
    /zoneupdatefromds  Update an active directory integrated zone with data from active directory Domain Services (AD DS).
    /zonewriteback     Save zone data to a file.

Detailed Usage:

 DnsCmd _ServerName_ /**AgeAllRecords** _ZoneName_ [_NodeName_] [/Tree] [/f]
    _Zone_     -- ZoneName
    _ZoneName_ -- FQDN of a zone
    _NodeName_ -- name or node or subtree in which to enable aging
                   - "@" for zone root OR
                   - FQDN of a node (name with a '.' at the end) OR
                   - single label for name relative to zone root
    /Tree      -- force aging on entire subtree of node
                    or entire zone if node not given
    /f         -- execute without asking for confirmation

 DnsCmd _ServerName_ /**clearcache**

 DnsCmd _ServerName_ /**Config** _ZoneName_ _Property_ _Value_
    run DnsCmd /Config /? for more

 DnsCmd _ServerName_ /**CreateBuiltinDirectoryPartitions** _Option_
    run DnsCmd /CreateBuiltinDirectoryPartitions /? for more

 DnsCmd _ServerName_ /**CreateDirectoryPartition** _FQDN of partition_

 DnsCmd _ServerName_ /**DeleteDirectoryPartition** _FQDN of partition_

 DnsCmd _ServerName_ /**DirectoryPartitionInfo** _FQDN of partition_

 DnsCmd _ServerName_ /**EnlistDirectoryPartition** _FQDN of partition_

 DnsCmd _ServerName_ /**EnumDirectoryPartitions** [/Custom]

 DnsCmd _ServerName_ /**EnumRecords** _ZoneName_ _NodeName_ [_DataOptions_] [_ViewOptions_]
    run DnsCmd /EnumRecords /? for more

 DnsCmd _ServerName_ /**EnumZones** [_Filter1_ _Filter2_ ...]
    run DnsCmd /EnumZones /? for more

 DnsCmd _ServerName_ /**exportsettings**

 DnsCmd _Server_ /**Info** [_Property_]
    run DnsCmd /Info /? for more

 DnsCmd _ServerName_ /**IpValidate** _Context_ [_ZoneName_] [_IPAddress_] ..]
  Tests remote DNS server IP addresses
  Context can be one of:
    /DnsServers-- test that IPs are DNS servers
    /Forwarders -- test IPs to use as forwarders
    /RootHints -- test IPs to use as root hints
    /ZoneMasters -- test IPs to use as master servers for the zone named _ZoneName_

 DnsCmd _ServerName_ /**NodeDelete** _Zone_ _NodeName_ [/Tree] [/f]
    run DnsCmd /NodeDelete /? for more

 DnsCmd _ServerName_ /**RecordAdd** _Zone_ _NodeName_ [/Aging] [/OpenAcl] [/CreatePTR] [_Ttl_] _RRType_ _RRData_
    run DnsCmd /RecordAdd /? for more

 DnsCmd _ServerName_ /**RecordDelete** _Zone_ _NodeName_ _RRType_ _RRData_ [/f]
    run DnsCmd /RecordDelete /? for more

 DnsCmd _ServerName_ /**ResetForwarders** [_IPAddress_] ...] [ /[No]Slave ] [/TimeOut _Time_]
    run DnsCmd /ResetForwarders /? for more

 DnsCmd _ServerName_ /**ResetListenAddresses** [_ListenAddress_] ...]
  _ListenAddress_  -- an IP address belonging to the DNS server
    Default:  listen to all server IP Address(es) for DNS requests

 DnsCmd _ServerName_ /**startscavenging**

 DnsCmd _ServerName_ /**Statistics** [_StatId_ | /Clear]
    run DnsCmd /RecordDelete /? for a list of StatIds

 DnsCmd _ServerName_ /**UnenlistDirectoryPartition** _FQDN of partition_

 DnsCmd _ServerName_ /**WriteBackFiles** [_ZoneName_]
  _ZoneName_ -- FQDN of a zone whose datafile to be written back
    Default: write back datafile for all dirty zones

 DnsCmd _ServerName_ /**ZoneAdd** _ZoneName_ _ZoneType_ [_Options_]
  _ZoneName_ -- FQDN of zone
    run DnsCmd /ZoneAdd /? for more

 DnsCmd _ServerName_ /**ZoneChangeDirectoryPartition** _ZoneName_ _NewPartition_
    _ZoneName_      -- FQDN of zone to move to new partition
    _NewPartition_  -- FQDN of new directory partition or one of:
                         /domain   - domain directory partition
                         /forest   - forest directory partition
                         /legacy   - legacy directory partition

 DnsCmd _ServerName_ /**ZoneDelete** _ZoneName_ [/DsDel] [/f]
    /DsDel   -- Delete Zone from DS
    /f       -- Execute without asking for confirmation
    Default: delete zone from DNS sever, but NOT from DS

 DnsCmd _ServerName_ /**ZoneExport** _ZoneName_ _ZoneExportFile_ (%systemroot%\system32\dns\)
    _ZoneName_    -- FQDN of zone to export
    /Cache      -- export cache

 DnsCmd _Server_ /**ZoneInfo** _ZoneName_ [_Property_]
  _Property_ -- zone property to view
  Examples:
    AllowUpdate
    DsIntegrated
    Aging
    RefreshInterval
    NoRefreshInterval

 DnsCmd _ServerName_ /**ZonePause** _ZoneName_

 DnsCmd _ServerName_ /**ZonePrint** [_ZoneName_] [/Detail]
  _ZoneName_ -- name of the zone (use ..Cache for DNS server cache)
  /Detail -- explicit RPC node contents

 DnsCmd _ServerName_ /**ZoneResetType** _ZoneName_ _Property_ [_Options_]
  _ZoneName_      -- FQDN of zone
    run DnsCmd /ZoneResetType /? for more

 DnsCmd _ServerName_ /**ZoneRefresh** _ZoneName_

 DnsCmd _ServerName_ /**ZoneReload** _ZoneName_

 DnsCmd _ServerName_ /**ZoneResetMasters** _ZoneName_ [/Local] [_Server IPs_]
    /Local -- Set the local master list for DS integrated zones.
    _Server IPs_ -- List of one or more IP addresses of master servers for
           this zone.  Masters may include the primary or other secondaries
           for the zone, but should not make the replication graph cyclic.

 DnsCmd _ServerName_ /**ZoneResetScavengeServers** _ZoneName_ [_Server IPs_]
    _Server IPs_ -- list of one or more IP addresses of servers to scavenge
           this zone;  if no addresses given ALL servers hosting this zone
           will be allowed to scavenge the zone.

 DnsCmd _ServerName_ /**ZoneResetSecondaries** _ZoneName_ 
               [_Security_] [_SecondaryIPAddress_] ...]
               [_Notify_] [_NotifyIPAddress_] ...]
    run DnsCmd /ZoneResetSecondaries /? for more

 DnsCmd _ServerName_ /**ZoneResume** _ZoneName_

 DnsCmd _ServerName_ /**ZoneUpdateFromDs** _ZoneName_

 DnsCmd _ServerName_ /**ZoneWriteBack** _ZoneName_

DNSCMD may be removed in a future version of Windows, Microsoft recommend moving over to the DNS cmdlets in [PowerShell](../ps/) (Get-command -module DnsServer).

Commonly used record types
--------------------------

> A (Host address)  
> AAAA (IPv6 host address)  
> ALIAS (Auto resolved alias)  
> CNAME (Canonical name for an alias)  
> MX (Mail eXchange)  
> NS (Name Server)  
> PTR (Pointer)  
> SOA (Start Of Authority)  
> SRV (location of service)  
> TXT (Descriptive text)

### Examples

Backup Zone1.com in an Active Directory-integrated zone:

dnscmd DC1 /zoneexport Zone1.com backup\zone1.com.dns.bak

This will create a file in %systemroot%\system32\dns\backup

“Confidence comes not from always being right but from not fearing to be wrong” - Peter T. Mcintyre

### Related commands

[NETSH](netsh.html) - Configure Network Interfaces.



/. nt/doskey.html
========================================================

    Doskey - recall commands - Windows CMD - SS64.com

DOSKEY.exe
==========

Recall and edit commands at the DOS prompt, and create macros.

Syntax

      DOSKEY [_options_] [_macroname_=[_text_]]

Key
    _macroname_   A short name for the macro.

        _text_   The commands you want to recall.

Options:

    /MACROFILE=_filename_ Specify a file of macros to install

    /MACROS            Display all Doskey macros

    /EXENAME=_exename_   Specify an  executable other than cmd.exe

    /MACROS:_exename_    Display all Doskey macros for the given executable

    /MACROS:ALL        Display all Doskey macros for all executables

    ALT+F10            Clear macro definitions

    /HISTORY           Display all commands stored in memory.

    /LISTSIZE=_size_     Set the number of commands to be remembered by the buffer.
                      (Maximum is 2,147,483,647)

    /REINSTALL         Install a new copy of Doskey (clears the buffer).

> In normal use the command line is always in overwrite mode, DOSKEY can be used to  
> change this to Insert, the [insert] key will always toggle from one to the other:  

    /INSERT            By default new text you type at the command line
                      will be inserted in old text

    /OVERSTRIKE        By default new text you type at the command line
                      will overwrite old

    /m /m: and /h are abbreviations for /macros /macros: and /history respectively.
    These provide compatibility with old MS-DOS versions of DOSKEY.

You cannot **run** a Doskey macro from a batch file, when scripting use the full path to the executable or other task you need to run.

In addition to the above, DOSKEY is loaded into memory for every cmd session so you can use [Keyboard shortcuts](syntax-keyboard.html) at the command line.

A DOSKEY macro will be effective for all text input during that session, for example when entering text at a [SET /P](set.html) prompt, if the text starts with a macro keyword, then DOSKEY will perform a substitution, just as if you are typing at the command line. [[stackoverflow](https://stackoverflow.com/questions/65856576/doskey-macros-break-prompts-set-p-of-batch-scripts-when-run-from-within-same)]  
  
The size of the command history can be set from Control Panel, Console or from the properties of any cmd shortcut.

Clearing History
----------------

> Clear all history with DOSKEY /REINSTALL  
> In all recent versions of Windows 10 the /REINSTALL option will cause the CMD.exe session to [crash](https://www.dostips.com/forum/viewtopic.php?f=3&t=5661).  
> An alternative is to manually change the ListSize:
> 
> :: Clear the command history  
> DOSKEY /LISTSIZE=0  
> DOSKEY /LISTSIZE=50

Comments
--------

> Doskey macro files do not support comments, but you can work around this by creating a fake macro called ; and repeatedly assigining your comment text, if you do this, always end with the line ;= to delete the fake macro.
> 
> ;= here is a comment  
> ;= another comment line  
> ;=

Advanced macro definitions:
---------------------------

    $T     If you put more than one command in a DOSKEY macro, use $T. 
          to separate them. Equivalent to & in a batch file.

    $1-$9  Parameters, equivalent to [%1-%9](syntax-args.html) in a batch file.

    $*     This represents ALL the parameters $1-9

Save and restore macro definitions
----------------------------------

> By default, DOSKEY macros are only saved for the current session.  
> A command like:  
> DOSKEY /macros >C:\batch\doskey-macros.txt  
> Will save all the current macro definitions into a text file.
> 
> Then to restore all the macros at a later date:  
> DOSKEY /macrofile=C:\batch\doskey-macros.txt
> 
> To load your saved macros as soon as a new CMD session is started, you have two options:  
> 1) Add your DOSKEY / macrofile command as an [AutoRun entry in the registry](syntax-autoexec.html)  
> AutoRun = DOSKEY /macrofile=C:\batch\doskey-macros.txt  
>   
> 2) Create a shortcut to CMD.exe and add DOSKEY to it:  
> C:\Windows\System32\cmd.exe /k "&& DOSKEY /macrofile=C:\batch\doskey-macros.txt"

### Examples

A macro to open notepad:  
C:> DOSKEY note=notepad.exe

Open a file with notepad:  
C:> DOSKEY opentext="C:\Windows\System32\notepad.exe" $1  
  
Using the above macro:  
C:> opentext MyTextfile.txt

Switch to the H: home drive:  
C:> DOSKEY home=cd /d H:\

Switch to your folder of batch files:  
C:> DOSKEY batch=cd /d C:\Batch  
  
A macro called 'd' to run dir/w  
C:> DOSKEY d=dir/w  
  
A macro to disable the FORMAT command (n.b. Doskey is not a foolproof method for disabling commands, it is easily bypassed by running the full command path/ extension or creating a different macro.)  
C:> DOSKEY Format=Echo The Format command has been disabled by the administrator.

“No man steps in the same river twice, for it's not the same river, and he's not the same man” ~ Heraclitus

### Related commands

CMD Syntax - [Batch file macros](syntax-macros.html)  
VBScript - [SendKeys](../vb/sendkeys.html)  
Equivalent bash commands (Linux): [m4](../bash/m4.html) - Macro processor, [history](../bash/history.html) - Command history.



/. nt/driverquery.html
========================================================

    DriverQuery - Windows CMD - SS64.com

DriverQuery.exe
===============

Display a list of all installed device drivers and their properties.

Syntax

      driverquery  [/s _Computer_] [/u _Domain__User_ /p _Password_]
         [/fo {TABLE|LIST|CSV}] [/nh] [/v] [/si]

Key
    /s _Computer_     The name or IP address of a remote computer
                  (do not use backslashes). Default = local computer.

    /u _Domain__User_  Run the command with the account permissions of the
                   user specified. Default = the currently logged on user.

    /p _Password_     The password of the user account that is specified in the /u parameter.

    /fo { TABLE | LIST | CSV } 
                   Format the output. Default = TABLE.

    /nh   Omit the header row from the displayed driver information.
         Valid when the /fo parameter is set to TABLE or CSV.

    /v    Display verbose driver information.

    /si   Display digital signature information for all device drivers. 

### Examples

Show all installed device drivers in Table output:  
driverquery

Show all installed device drivers in a CSV format:  
DriverQuery /fo csv  
  
Without a header:  
DriverQuery /nh  
  
Drivers that are not signed:  
DriverQuery /si | findstr FALSE

Find drivers that are currently Running:  
Driverquery.exe /v |findstr Running

Show installed device drivers on a remote machine  
driverquery /s ipaddress  
  
Show installed device drivers on server64 and authenticate as a different user:  
driverquery /s server64 /u ss64Ddom\user123 /p p@sswor3d /fo list

Export a verbose listing of drivers to a file  
driverquery /v /fo csv > T:\driverlist.csv

When running DriverQuery within PowerShell, the CSV output format can be used to turn the output into objects. The PowerShell function below turns DriverQuery into a graphical tool that will list drivers from both local and remote systems (assuming you have the appropriate permissions.)

function Show-DriverDialog {
    param(
        $ComputerName = $env:computername
    )
    
    driverquery.exe /S $ComputerName /FO CSV  | 
      ConvertFrom-Csv | 
      Out-GridView -Title "Driver on \$ComputerName"
}

Function via [Peter Bishop](https://community.idera.com/database-tools/powershell/powertips) @ Powershell.com

“He who asks a question is a fool for five minutes; he who does not ask a question remains a fool forever” ~ Chinese Prover

### Related commands

[DevCon](devcon.html) - Device Manager Command Line Utility.



/. nt/dsacls.html
========================================================

    DSACLS - Directory Service ACLs - Windows CMD - SS64.com

DSACLS.exe (installable option via [RSAT](../links/windows.html) /AD DS)
========================================================================

View or Edit ACLs (access control entries) for objects in Active Directory.

Syntax

      DSACLS "[\_Computer_\]_ObjectDN_" [/A] [/D _PermissionStatement_ [_PermissionStatement_]...]
         [/G _PermissionStatement_ [_PermissionStatement_]...] [/I:{T | S | P}]
            [/N] [/P:{Y | N}] 
               [/R {_User_ | _Group_} [{_User_ | _Group_}]...] [/S [/T]]

      PermissionStatements:
         {_User_ | _Group_}:_Permissions_[;{_ObjectType_ | _Property_}][;_InheritedObjectType_]
   
Key
    _ObjectDN_  Distinguished name of the object.
             If omitted will be taken from standard input (stdin)

    /A   Add ownership and auditing information to the results.

    /D   Deny permissions to a user or group

    /G   Grant permissions to a user or group.

    /I:  Inheritance
           T  The object and its child objects (default)
           S  The child objects only
           P  The object and child objects down one level only

    /N   Replace the current ACEs in the ACL.
        By default, dsacls adds the ACE to the ACL.

    /P:  Inherit permissions from parent objects (Y/N).

    /R   Revoke/Delete all ACEs for the users or groups.

    /S   Restore the default security.
        Default security for each object class is defined in the Active Directory schema.

  /S /T Restore the default security on the tree of objects.

Permissions
      GR: Generic Read
      GE: Generic Execute
      GW: Generic Write
      GA: Generic All

      SD: Delete an object
      DT: Delete an object and all of its child objects
      RC: Read security information
      WD: Change security information
      WO: Change owner information
      LC: List the child objects of the object
      CC: Create a child object•
      DC: Delete a child object•
      WS: Write to a self object (group membership) group object + {ObjectType | Property} = "member."
      RP: Read a property•
      WP: Write to a property•
      CA: Control access (normally a specific extended right for control access)
             If you do not specify {ObjectType | Property} this permission will apply to all
             meaningful control accesses on the object.
      LO: List the object access, AD DS does not enforce this permission by default.
             Grant list access to a specific object when List Children (LC) is not granted to the parent.
             Deny list access to a specific object when the user or group has LC permission on the parent.

    _ObjectType_ | _Property_
          Limit the permission to the specified object type or property.
          Enter the _display name_ of the object type or the property.
          Default=all object types and properties.

          For example, Grant the user rights to create all types of child objects:
          /G Domain\User:CC

          Grant the user rights to create only child **computer** objects:
          /G Domain\User:CC;computer

    _InheritedObjectType
_          Limit inheritance of the permission to the specified object type.
          For example, Grant only **User** objects to inherit the permission:
          /G Domain\User:CC;;user

    _Object Types_
          User,Contact,Group,Shared Folder,Printer,Computer,Domain Controllers,OU

• If you do not specify {ObjectType | Property} to define a specific child object type, this permission will apply to all types of child objects; otherwise, it will apply only to the child object type that you specify.

You can Grant, Deny or Delete ACEs for multiple users and groups with a single parameter (/G /D /R), list the users/groups separated with spaces.

### Examples

Grant Generic Read (GR) and Generic Execute (GE) on computer objects in the Laptops OU to Jdoe:  
  
C:> dsacls "OU=Laptops,OU=AcmeCo,DC=ss64,DC=Com" /G Domain\JDoe:GRGE;computer

“If future generations are to remember us with gratitude rather than contempt, we must leave them more than the miracles of technology. We must leave them a glimpse of the world as it was in the beginning, not just after we got through with it” ~ President Lyndon B. Johnson

### Related commands

[DSAdd](dsadd.html) - Add object.  
[DSMod](dsmod.html) - Modify object.  
[DSGet](dsget.html) - Display object.  
[DSMove](dsmove.html) - Move object.  
[DSQuery](dsquery.html) - Search for objects.  
DSdbUtil - Maintenance of AD, Authorative Restore, manage snapshots.  
DSAMain - Expose Active Directory data that is stored in a snapshot or backup.  
DSMgmt - Configure Directory Services.



/. nt/dsadd.html
========================================================

    Dsadd - Directory Service Add - Windows CMD - SS64.com

DSADD.exe (installable option via [RSAT](../links/windows.html) /AD DS)
=======================================================================

Add active directory object.

Syntax

    [DSADD Computer](dsadd-computer.html)
    [DSADD Contact](dsadd-contact.html) 
    [DSADD Group](dsadd-group.html)
    [DSADD OU](dsadd-ou.html)
    [DSADD User](dsadd-user.html)
    [DSADD Quota](dsadd-quota.html)

Special characters in distinguished names

Commas within a CN must be escaped with the backslash \ character  
e.g. "CN=Company****, Inc.,CN=Users,DC=ss64,DC=com"  
  
Backslashes must also be escaped with a backslash  
for example, "CN=Sales****\ Latin America,OU=Distribution Lists,DC=ss64,DC=com"

If any value contains spaces, use quotation marks:  
e.g. "CN=John Smith,CN=Users,DC=SS64,DC=com"

Redirection  
You can [pipe](syntax-redirection.html) results from DSQUERY into DSMOD in order to modify an object. If the DN contains any commas or backslashes you will need to redirect to a file first and add the escape characters as above.

Special Tokens  
The token $username$ (case insensitive) can be used to place the SAM account name.  
Entering * as a password will cause DSADD to prompt for the new password.

Adding multiple Objects
-----------------------

> For any DS command you can enter multiple values separated by spaces.  
> e.g. to add several user accounts at once just supply a list of the distinguished names separated with spaces.  
> It is also possible to store multiple values in a text file and redirect into DSADD.

How to organize Active Directory
--------------------------------

> An example AD layout using the domain name SS64.com, obviously customise that to your own domain.
> 
> The general principle is to create as few OU's as possible, don’t attempt to use AD as a configuration database.
> 
> Keep it simple with separate OU's for Users, Groups, Servers, Workstations and the IT department (Admin). Avoid deeply nested OUs and punctuation.
> 
> AcmeCo
> AcmeCo/Admin        (OU=Admin,OU=AcmeCo,DC=ss64,DC=com)
> AcmeCo/Groups       (OU=Groups,OU=AcmeCo,DC=ss64,DC=com)
> AcmeCo/Users        (OU=Users,OU=AcmeCo,DC=ss64,DC=com)
> AcmeCo/Servers      (OU=Servers,OU=AcmeCo,DC=ss64,DC=com)
> AcmeCo/Laptops      (OU=Laptops,OU=AcmeCo,DC=ss64,DC=com)
> AcmeCo/Workstations (OU=Workstations,OU=AcmeCo,DC=ss64,DC=com)
> AcmeCo/Workstations/Site1
> AcmeCo/Workstations/Site2
> AcmeCo/Workstations/Site3
> 
> PartnerCo           An OU for external contacts
> PartnerCo/Users        (OU=Users,OU=PartnerCo,DC=ss64,DC=com)
> PartnerCo/Workstations (OU=Workstations,OU=PartnerCo,DC=ss64,DC=com)

If possible store all USER accounts in a single OU. Organisations change and people move around, there is rarely any reason to reflect every such change in Active Directory. One reason for adding additional USER OUs is to allow delegated rights i.e. to allow super users to do password resets.

The default (built in) Organizational Units (OUs) for Users (CN=Computers,DC=ss64,DC=com) and Computers (CN=Users,DC=ss64,DC=com) will often be used by application installers when creating service accounts.

“Find a job you like and you add five days to every week” ~ H. Jackson Brown, Jr

### Related commands

[DSMod](dsmod.html) - Modify object.  
[DSGet](dsget.html) - Display object.  
[DSMove](dsmove.html) - Move object.  
[DSQuery](dsquery.html) - Search for objects.  
[DSRM](dsrm.html) - Delete object.  
[CSVDE](csvde.html) - Import or export AD info in CSV format.  
[LDIFDE](csvde.html) - Edit AD Objects, extend schema, import or export AD information.  
Equivalent bash commands (Linux): [useradd](../bash/useradd.html)/[groupadd](../bash/groupadd.html)



/. nt/dsadd-user.html
========================================================

    DSAdd user - Directory Service Add - Windows CMD - SS64.com

[DSADD](dsadd.html) User (installable option via [RSAT](../links/windows.html) /AD DS)
======================================================================================

Add a user account to active directory.

Syntax

      DSADD User _UserDN_ [-samid _SAMName_] [-upn _UPN_] [_Options_] [-q] [{-uc | -uco | -uci}]

Key
    _UserDN_   Distinguished name of the user that you want to add.
            If omitted will be taken from standard input (stdin).

    _SAMName_  Unique SAM account name for this user
            (By default, the first 20 chars from the UserDN/CN).

    _UPN_      User Principal Name of the user to add, e.g. fred@SS64.com

    -q       Quiet, suppress all output.

    -uc      Unicode format.
    -uco     Unicode format for output only.
    -uci     Unicode format for input only.

Options:

    [-fn _FirstName_] [-mi _Initial_] [-ln _LastName_] [-display _DisplayName_]
    [-empid _EmployeeID_] [-pwd {_Password_ | *}]
    [-desc _Description_] [-memberof _Group_ ...] [-office _Office_] [-tel _PhoneNumber_]
    [-email _Email_] [-hometel _HomePhoneNumber_] [-pager _PagerNumber_]
    [-mobile _CellPhoneNumber_] [-fax _FaxNumber_] [-iptel _IPPhoneNumber_]
    [-webpg _WebPage_] [-title _Title_] [-dept _Department_]
    [-company _Company_] [-mgr _ManagersDistinguishedName_]
    [-hmdir _HomeDirectory_] [-hmdrv _DriveLetter_:][-profile _ProfilePath_]
    [-loscr _ScriptPath_] [-mustchpwd {yes | no}] [-canchpwd {yes | no}]
    [-reversiblepwd {yes | no}] [-pwdneverexpires {yes | no}]
    [-acctexpires _NumberOfDays_] [-disabled {yes | no}]
    [{-s _Server_ | -d _Domain_}]
    [-u _UserName_] [-p {_Password_ | *}]

The special token $username$, can be used to replace the SAM account name in the value of the -email, -hmdir, -profile, and -webpg parameters.

### Examples

dsadd user "cn=fred,ou=staff,dc=ss64,dc=com"

dsadd user "cn=JohnS,cn=users,dc=ss64,dc=com" -fn "john" -ln "Smith" -disabled no

“For a list of all the ways technology has failed to improve the quality of life, press three” ~ Alice Kahn

### Related commands

[DSAdd](dsadd.html) - Add object.  
[DSMod](dsmod.html) - Modify object. [DSMod User](dsmod-user.html) - Modify a user account in active directory.  
[DSGet](dsget.html) - Display object. [DSGet User](dsget-user.html) - Display user(s) from active directory.  
[DSMove](dsmove.html) - Move object.  
[DSQuery](dsquery.html) - Search for objects.[DSQuery User](dsquery-user.html) - Search for users in active directory.  
[DSRM](dsrm.html) - Delete object / Delete a user account from active directory.  
[CSVDE](csvde.html) - Import or export AD info in CSV format.  
[LDIFDE](csvde.html) - Edit AD Objects, extend schema, import or export AD information.  
PowerShell: [New-adUser](../ps/new-aduser.html) - Create a new AD user.  
Equivalent bash commands (Linux): [useradd](../bash/useradd.html) - Add user.



/. nt/dsadd-group.html
========================================================

    Dsadd group - Directory Service Add - Windows CMD - SS64.com

[DSADD](dsadd.html) Group (installable option via [RSAT](../links/windows.html) /AD DS)
=======================================================================================

Add a group to active directory.

Syntax

      DSADD Group _GroupDN_ [-secgrp {yes | no}] [-scope {l | g | u}] [-samid _SAMName_]
         [-desc _Description_] [-memberof _Group_ ...] [-members _Member_ ...]
            [{-s _Server_ | -d _Domain_}] [-u _UserName_] [-p {_Password_ | *}]
               [-q] [{-uc | -uco | -uci}]

Key
    _Group_DN_  Distinguished name of the group that you want to add.
             If omitted will be taken from standard input (stdin).

    -secgrp   A security group (yes) or a distribution group (no) default=Yes.

    -scope    [Domain local](syntax-permissions.html) (l), [global](syntax-permissions.html) (g), or [universal](syntax-permissions.html) (u) default=g.

    _SAMName_   Unique SAM account name for this group
             By default, the dn attribute from the GroupDN.

    -memberof Add this new group to other groups.
    -members  Members to add to this new group. 

    -s _Server_ Connect to a remote server/domain, default=%logonserver% domain controller.

    -q        Quiet, suppress all output.

    -uc       Unicode format.
    -uco      Unicode format for output only.
    -uci      Unicode format for input only.

### Examples

C:> dsadd group cn=Beatles,cn=Musicians,dc=ss64,dc=com  
  
C:> dsadd group "cn=Rolling Stones,cn=Musicians,dc=ss64,dc=com"

“If he is a man of honor in one thing, he is that in all things” ~ Raymond Chandler

### Related commands

[DSAdd](dsadd.html) - Add object.  
[DSMod](dsmod.html) - Modify object. [DSMod Group](dsmod-group.html) - Add/remove users to a group.  
[DSGet](dsget.html) - Display object. [DSGet group](dsget-group.html) - Display group(s) from active directory.  
[DSMove](dsmove.html) - Move object.  
[DSQuery](dsquery.html) - Search for objects.  
[DSRM](dsrm.html) - Delete object.  
[BuiltIn Groups](syntax-security_groups.html) - Built-In Users and Security Groups.  
PowerShell: [New-adGroup](../ps/new-adgroup.html) - Create an AD group.  
Equivalent bash commands (Linux): [groupadd](../bash/groupadd.html) - Add group.



/. nt/dsadd-computer.html
========================================================

    DSAdd computer - Directory Service Add - Windows CMD - SS64.com

[DSADD](dsadd.html) computer (installable option either via [RSAT](../links/windows.html) /AD DS or [adminpack.msi](../links/windows.html))
===========================================================================================================================================

Add a computer object to active directory.

Syntax

      DSADD Computer _Computer_DN_ [-samid _SAMName_]
         [-desc _Description_] [-loc _Location_] [-memberof _GroupDN_ ...]
            [{-s _Server_ | -d _Domain_}]   [-u _UserName_]  [-p {_Password_ | *}]
               [-q] [{-uc | -uco | -uci}]

Key
    _Computer_DN_  Distinguished name of the computer that you want to add.
                If omitted will be taken from standard input (stdin).

    _SAMName_      Unique SAM account name for this computer
                By default, the cn attribute from the ComputerDN.

    -desc    Computer description.

    -loc     Location of computer.

    -memberof   Join this computer to a Group/DN.

    -s       Server to connect to (Default=the domain controller in the logon domain.)
    -d       Domain to connect to.

    -u       Username with which the user logs on to a remote server. 
    -p       Password     (UserName or Domain\UserName or Username@domain.com)

    -q       Quiet, suppress all output.

    -uc      Unicode format.
    -uco     Unicode format for output only.
    -uci     Unicode format for input only.

To also make the computer a member of a specific group (for applying group policy), use the -memberof option.

### Examples

C:> dsadd computer cn=pc64,ou=computers,dc=ss64,dc=com

“Hardware: the parts of a computer that can be kicked” - Jeff Pesis

### Related commands

[DSAdd](dsadd.html) - Add object.  
[DSMod](dsmod.html) - Modify object.  
[DSGet](dsget.html) - Display object.  
[DSMove](dsmove.html) - Move object.  
[DSQuery](dsquery.html) - Search for objects.  
[DSRM](dsrm.html) - Delete object.  
PowerShell: [New-adComputer](../ps/new-adcomputer.html) - Create a new AD computer.



/. nt/dsget.html
========================================================

    DSGet - Directory Service View - Windows CMD - SS64.com

DSGET.exe (installable option via [RSAT](../links/windows.html) /AD DS)
=======================================================================

View active directory objects.

Syntax

    [DSGet Computer](dsget-computer.html)
    [DSGet Contact](dsget-contact.html)
    [DSGet Group](dsget-group.html)
    [DSGet OU](dsget-ou.html)
    [DSGet Partition](dsget-partition.html)
    [DSGet Quota](dsget-quota.html)
    [DSGet Server](dsget-server.html)
    [DSGet Subnet](dsget-subnet.html)
    [DSGet User](dsget-user.html)

**Special characters in distinguished names**

Commas within a CN must be escaped with the backslash \ character  
e.g. "CN=Company****, Inc.,CN=Users,DC=ss64,DC=com"  
  
Backslashes must also be escaped with a backslash  
for example, "CN=Sales****\ Latin America,OU=Distribution Lists,DC=ss64,DC=com"

If any value contains spaces, use quotation marks:  
e.g. "CN=John Smith,CN=Users,DC=SS64,DC=com"  
  
**Redirection**  
You can [pipe](syntax-redirection.html) results from DSQUERY into DSGet in order to view multiple objects. If the DN contains any commas or backslashes you will need to redirect to a file first and add the escape characters as above.

**Special Tokens**  
The token $username$ (case insensitive) can be used to place the SAM account name.  
Entering * as a password will cause DSMOD to prompt for the new password.

For any DS command you can enter multiple values separated by spaces.  
e. class="quote"g. to modify several user accounts at once just supply a list of the distinguished names separated with spaces.

“A good reputation is more valuable than money” - Publilius Syrus

### Related commands

[DSAdd](dsadd.html) - Add object.  
[DSMod](dsmod.html) - Modify object.  
[DSGet](dsget.html) - Display object.  
[DSMove](dsmove.html) - Move object.  
[DSQuery](dsquery.html) - Search for objects.  
[DSRM](dsrm.html) - Delete object.  
[CSVDE](csvde.html) - Import or export AD info in CSV format.  
[LDIFDE](csvde.html) - Edit AD Objects, extend schema, import or export AD information.  
[Q322684](https://support.microsoft.com/en-us/help/322684/) - Directory Service Command-Line Tools.  
Equivalent bash commands (Linux): ldapmodify - Modify Lightweight Directory Access Protocol.



/. nt/dsget-user.html
========================================================

    DSGet User - Directory Service Add - Windows CMD - SS64.com

[DSGET](dsget.html) User (installable option via [RSAT](../links/windows.html) /AD DS)
======================================================================================

Display user(s) from active directory.

Syntax

      DSGET user _UserDN_ [-dn] [-samid] [-sid] [-upn] [-fn] [-mi] [-ln]
        [-display] [-empid] [-desc] [-office] [-tel] [-email] [-hometel] [-pager] [-mobile]
           [-fax] [-iptel] [-webpg] [-title] [-dept] [-company] [-mgr] [-hmdir] [-hmdrv] [-profile]
              [-loscr] [-mustchpwd] [-canchpwd] [-pwdneverexpires] [-disabled] [-acctexpires] [-reversiblepwd]
                 [{-uc | -uco | -uci}] [-part _PartitionDN_ [-qlimit] [-qused]]

      DSGET user _UserDN_ [-memberof] [-expand][{-uc | -uco | -uci}]

Key
    _UserDN_  Distinguished Name of the user to view.
    -dn     Display the distinguished names.
    -samid  Display the Security Account Manager (SAM) account names
    -sid    Display the user security identifiers (SIDs).
    -upn    Display the user principal names (UPNs).
    -fn     Display the first names.
    -mi     Display the middle initials.
    -ln     Display the last names.
  -display Display the display names.
    -empid  Display the employee IDs.
    -desc   Display the descriptions.
    -full   Display the full names.
    -office Display the office locations.
    -tel    Display the telephone numbers.
    -email  Display the email addresses.
  -hometel Display the home telephone numbers.
    -pager  Display the pager numbers.
    -mobile Display the mobile phone numbers.
    -fax    Display the fax numbers.
    -iptel  Display the user IP phone numbers.
    -webpg  Display the user Web page URLs.
    -title  Display the titles.
    -dept   Display the departments.
  -company Display the company information.
    -mgr    Display the managers.
    -hmdir  Display the users home directory.
    -hmdrv  Display the user's home drive letter.
  -profile Display the user profile paths.
    -loscr  Display the user logon script paths.
-mustchpwd Display whether users must change their passwords at next logon (yes/no).
 -canchpwd Display whether users can change their password (yes/no).
 -pwdneverexpires Display whether passwords never expire (yes/no).
 -disabled     Display whether user accounts are disabled (yes/no).
-acctexpires   Display the dates when user accounts expire. (date/never).
-reversiblepwd Display whether user passwords will be stored with reversible encryption (yes/no).

  -memberof Display the immediate list of groups of which the user is a member.
    -expand  Display the recursively expanded list of groups of which the user is a member. 

    -uc      Unicode format.
    -uco     Unicode format for output only.
    -uci     Unicode format for input only.

    -part    Connect to the directory partition _PartitionDN_.
    -qlimit  Display the effective quota of the user within _PartitionDN_.
    -qused   Display how much quota the user has used within _PartitionDN_.

Dsget can accept stdin from the keyboard, from a redirected file, or as [piped](syntax-redirection.html) output from another command e.g. [DSQuery](dsquery.html)

### Examples

Find the list of groups, recursively expanded, to which the user Fred belongs:

C:> dsget user "cn=fred,ou=Users,ou=AcmeCo,dc=ss64,dc=com" -memberof -expand

Display the distinguished name and description of domain controller Dom1:

C:> dsget server CN=Dom1,CN=Servers,CN=AcmeCo,DC=ss64,DC=Com -dn -desc

_“There’s no such thing as a free lunch” ~ Milton Friedman_

### Related commands

[DSAdd](dsadd.html) - Add object. [DSAdd User](dsadd-user.html) - Add a user to active directory.  
[DSMod](dsmod.html) - Modify object. [DSMod User](dsmod-user.html) - Modify a user account in active directory.  
[DSGet](dsget.html) - Display object.  
[DSMove](dsmove.html) - Move object.  
[DSQuery](dsquery.html) - Search for objects. [DSQuery User](dsquery-user.html) - Search for users in active directory.  
[DSRM](dsrm.html) - Delete object.  
PowerShell: [Get-adUser](../ps/get-aduser.html) - Get one or more AD users.



/. nt/dsget-group.html
========================================================

    DSGet Group - Directory Service Get - Windows CMD - SS64.com

[DSGET](dsget.html) group (installable option via [RSAT](../links/windows.html) /AD DS)
=======================================================================================

Display group(s) from active directory.

Syntax

      DSGET group _GroupDN_ [-dn] [-samid] [-sid] [-desc] [-secgrp] [-scope]
         [{-s _Server_ | -d _Domain_}]   [-u _UserName_]  [-p {_Password_ | *}]
            [-c] [-q] [-l] [{-uc | -uco | -uci}]  [-part _PartitionDN_ [-qlimit] [-qused]]

      DSGET group _GroupDN_ [{-memberof | -members}] [-expand]
         [{-s _Server_ | -d _Domain_}]   [-u _UserName_]  [-p {_Password_ | *}]
            [-c] [-q] [-l] [{-uc | -uco | -uci}]

Key
    _Computer_DN_  Distinguished Name of the group object list (first variation) or 
                single group (second variation) to view.

    -dn      Display the distinguished name.
    -samid   Display the Security Account Manager (SAM) account name.
    -sid     Display the computer security IDs (SID).

    -desc    Display the description.
    -secgrp  Display Security groups (yes) or Distribution groups (no).
    -scope   Display Local, Global, or Universal group scope.
    -loc     Display the location.

  -disabled Display the disabled status (Yes/No).

  -memberof Display the immediate list of groups of which the group is a member.
    -expand  Display the recursively expanded list of groups of which the group is a member. 

  -members  Display the immediate list of members of the group.
    -expand  Display the recursively expanded list of members of the group. 

    -s       Server to connect to (Default=the domain controller in the logon domain.)
    -d       Domain to connect to.

    -u       Username with which the user logs on to a remote server. 
    -p       Password     (UserName or Domain\UserName or Username@domain.com).

    -c       Report errors, but continue with the next object after any error (when you specify multiple objects)
            by default dsget will exit when the first error occurs.
    -q       Quiet, suppress all output.
    -l       Display entries in a list format. By default, dsget outputs a table format.

    -part    Connect to the directory partition _PartitionDN_.
    -qlimit  Display the effective quota of the group in _PartitionDN_.
    -qused   Display how much of its quota a group has used in _PartitionDN_.

    -uc      Unicode format.
    -uco     Unicode format for output only.
    -uci     Unicode format for input only.

Dsget can accept stdin from the keyboard, from a redirected file, or as [piped](syntax-redirection.html) output from another command e.g. [DSQuery](dsquery.html)

### Examples

Display the list of members, recursively expanded, of the Finance group:

C:> dsget group "CN=Finance,OU=Groups,OU=AcmeCo,DC=ss64,DC=Com" -members -expand

“There are three classes of people: those who see. Those who see when they are shown. Those who do not see” ~ Leonardo da Vinci

### Related commands

[DSAdd](dsadd.html) - Add object. [DSAdd Group](dsadd-group.html) - Add a group to AD.  
[DSGet](dsget.html) - Display object.  
[DSMod](dsmod.html) - Modify object. [DSMod Group](dsmod-group.html) - Add/remove users to a group.  
[DSMove](dsmove.html) - Move object.  
[DSQuery](dsquery.html) - Search for objects.  
[DSRM](dsrm.html) - Delete object.  
PowerShell: [Get-adGroup](../ps/get-adgroup.html) - Get one or more AD groups.  
[Q243330](https://support.microsoft.com/en-us/help/243330/) - Well-known security identifiers (sids) in Windows operating systems.



/. nt/dsget-computer.html
========================================================

    DSGet computer - Directory Service Get - Windows CMD - SS64.com

[DSGET](dsget.html) computer (installable option via [RSAT](../links/windows.html) /AD DS)
==========================================================================================

Display computer object(s) from active directory.

Syntax

      DSGET Computer _Computer_DN_ [-dn] [-samid]
         [-sid] [-desc] [-loc] [-disabled] 
            [{-s _Server_ | -d _Domain_}]   [-u _UserName_]  [-p {_Password_ | *}]
                [-c] [-q] [{-uc | -uco | -uci}] [-part _PartitionDN_ [-qlimit] [-qused]]

      DSGET Computer _Computer_DN_ [-memberof [-expand]] [{-s _Server_ | -d _Domain_}]
         [-u _UserName_] [-p {_Password_ | *}]
            [-c] [-q] [-l] [{-uc | -uco | -uci}]
   
Key
    _Computer_DN_  Distinguished Name of the computer object list (first variation) or 
                single computer (second variation) to view.

    -dn      Display the distinguished name.
    -samid   Display the Security Account Manager (SAM) account name.
    -sid     Display the computer security IDs (SID).
    -desc    Display the description.
    -loc     Display the location.

  -disabled Display the disabled status (Yes/No).

  -memberof Display the immediate list of groups of which the computer is a member.
    -expand  Display the recursively expanded list of groups of which the computer is a member. 

    -s       Server to connect to (Default=the domain controller in the logon domain.)
    -d       Domain to connect to.

    -u       Username with which the user logs on to a remote server.
    -p       Password     (UserName or Domain\UserName or Username@domain.com)

    -c       Report errors, but continue with the next object after any error (when you specify multiple objects)
            by default dsget will exit when the first error occurs.
    -q       Quiet, suppress all output.
    -l       Display entries in a list format. By default, dsget outputs a table format.

    -part    Connect to the directory partition _PartitionDN_.
    -qlimit  Display the effective quota of the computer in _PartitionDN_.
    -qused   Display how much of its quota a computer has used in _PartitionDN_.

    -uc      Unicode format.
    -uco     Unicode format for output only.
    -uci     Unicode format for input only.

To also make the computer a member of a specific group (for applying group policy), use the -memberof option.

### Examples

Display the list of all groups, to which pc64 belongs:

C:> dsget computer cn=pc64,ou=computers,dc=ss64,dc=com -memberof -expand

Display the descriptions of all computers in an organizational unit (OU) named France whose name starts with "pari"

C:> dsquery computer OU=France,DC=ss64,DC=Com -name pari* | dsget computer -desc

“Hardware: the parts of a computer that can be kicked” ~ Jeff Pesis

### Related commands

[DSAdd](dsadd.html) - Add object.  
[DSMod](dsmod.html) - Modify object.  
[DSGet](dsget.html) - Display object.  
[DSMove](dsmove.html) - Move object.  
[DSQuery](dsquery.html) - Search for objects.  
[DSRM](dsrm.html) - Delete object.  
PowerShell: [Get-adComputer](../ps/get-adcomputer.html) - Get one or more AD computers.



/. nt/dsquery.html
========================================================

    DSQuery - Directory Service Query - Windows CMD - SS64.com

DSQUERY.exe (installable option via [RSAT](../links/windows.html) /AD DS)
=========================================================================

Search for an active directory object.

Syntax

    [DSQuery Computer](dsquery-computer.html) 
    [DSQuery Contact](dsquery-contact.html)
    [DSQuery Group](dsquery-group.html)
    [DSQuery OU](dsquery-ou.html)
    [DSQuery Site](dsquery-site.html)
    [DSQuery Server](dsquery-server.html) 
    [DSQuery User](dsquery-user.html)
    [DSQuery Quota](dsquery-quota.html)
    [DSQuery Partition](dsquery-partition.html)
    [DSQuery *](dsquery-ldap.html)  (LDAP query)

Commas within a CN must be escaped with the backslash \ character CN=Company****, Incorporated...

Escape Backslashes with a second backslash CN=Sales****\ Latin America...

If any value contains spaces, use quotation marks: **"**CN=John Smith,CN=Users,DC=SS64,DC=com**"**

**Special Tokens**  
The token $username$ (case insensitive) can be used to place the SAM account name.  
Entering * as a password will prompt for a new password.

**Adding multiple Objects  
**For any DS command you can enter multiple values separated by spaces.  
e.g. to add several user accounts at once just supply a list of the distinguished names separated with spaces.  
  
It is also possible to store multiple values in a text file and redirect into DSQUERY.

**PowerShell**  
To call dsquery and store the resulting string in a powershell array variable (from PowerShellHell.com):  
$arrComputerList = $(&dsquery computer -limit 0)|%{$_.Split("=")[1].replace(",OU","").replace(",CN","")}

“plus ça change, plus c'est la même chose (The more things change, the more they are the same.)” ~ Jean-Baptiste Alphonse Karr 1849.

### Related commands

[DSAdd](dsadd.html) - Add object.  
[DSMod](dsmod.html) - Modify object.  
[DSGet](dsget.html) - Display object.  
[DSMove](dsmove.html) - Move object.  
[DSQuery](dsquery.html) - Search for objects.  
[DSRM](dsrm.html) - Delete object.  
[CSVDE](csvde.html) - Import or export AD info in CSV format.  
[LDIFDE](csvde.html) - Edit AD Objects, extend schema, import or export AD information.  
[LDAP Syntax Filters](https://social.technet.microsoft.com/wiki/contents/articles/5392.active-directory-ldap-syntax-filters.aspx?Sort=MostUseful&PageIndex=1) - TechNet Wiki.  
[AdFind](https://www.joeware.net/freetools/tools/adfind/) - Command line Active Directory query tool (JoeWare).  
Equivalent bash commands (Linux): ldapmodify - Modify Lightweight Directory Access Protocol.



/. nt/dsquery-user.html
========================================================

    DSQuery User - Directory Service User - Windows CMD - SS64.com

[DSQuery](dsquery.html) user (installable option via [RSAT](../links/windows.html) /AD DS)
==========================================================================================

Search for users in active directory.

Syntax

      DSQuery User [{_StartNode_ | forestroot | domainroot}]
         [-o {dn | rdn | samid}]  [-scope {subtree | onelevel | base}]
            [-name _Name_] [-desc _Description_]  [-upn _UPN_] [-samid _Filter_]
               [-inactive _NumberOfWeeks_] [-stalepwd _NumberOfDays_] [-disabled]
                  [{-s _Server_ | -d _Domain_}] [-u _UserName_] [-p {_Password_ | *}]
                     [-q] [-r] [-gc] [-limit _NumberOfObjects_]  [{-uc | -uco | -uci}]

Key
    _StartNode_ | forestroot | domainroot  The node in the console tree where the search starts.
                                        forestroot = search using the global catalog. 

    -o       The format used to display the search results.
              dn = distinguished name. 
              rdn = relative distinguished name.
              samid = Security Accounts Manager (SAM) account name.

    -scope   The scope of the search:
              subtree = subtree that is rooted at the start node in the console tree.
              onelevel = immediate children of the start node only.
              base = single object that the start node represents.
            If forestroot is the _StartNode_, then subtree is the only valid scope. 

    -name    Search for user(s) whose name attribute(CN) matches _Name_.
            For example, "br*"

    -desc    Search for user(s) whose description matches. For example, "contractor*"

    -upn     Users whose UPN attribute matches _UPN_
    -samid   User(s) whose SAM account name matches _SAMName_

  -inactive Users who have been inactive for _n_ number of weeks.
  -stalepwd Users who have not changed their passwords for _n_ days.
  -disabled Users with disabled accounts.

    -s       Server to connect to (Default=the domain controller in the logon domain.)
    -d       Domain to connect to.

    -u       Username with which the user logs on to a remote server. 
    -p       Password     (UserName or Domain\UserName or Username@domain.com)

    -q       Quiet, suppress all output.
    -r       Recursive search (follow referrals).
    -gc      Use the AD global catalog during the search.
    -limit   The maximum number of objects to return, default=100.

    -uc      Unicode format.
    -uco     Unicode format for output only.
    -uci     Unicode format for input only.

### Examples

Find all users on the current domain with a name that starts with 'Admin'

C:> dsquery user -name Admin*

Echo all inactive accounts (more than 4 weeks inactive)

C:> dsquery user -inactive 4

Disable all inactive accounts (more than 4 weeks inactive)

C:> dsquery user -inactive 4 | dsmod user -disabled yes

Find the distinguished names of all users in the LaptopUsers OU:

C:> dsquery user ou=LaptopUsers,ou=AcmeCo,dc=ss64,dc=com

“If he is a man of honor in one thing, he is that in all things” ~ Raymond Chandler

### Related commands

[DSQuery Group](dsquery-group.html) -Search for groups.  
[DSAdd](dsadd.html) - Add object.  
[DSMod](dsmod.html) - Modify object.  
[DSGet](dsget.html) - Display object.  
[DSMove](dsmove.html) - Move object.  
[DSQuery](dsquery.html) - Search for objects.  
[DSRM](dsrm.html) - Delete object.  
PowerShell: [Get-adUser](../ps/get-aduser.html) - Get one or more AD users.



/. nt/dsquery-group.html
========================================================

    DSQuery Group - Directory Service Group - Windows CMD - SS64.com

[DSQuery](dsquery.html) group (installable option via [RSAT](../links/windows.html) /AD DS)
===========================================================================================

Search for Groups in active directory.

Syntax

      DSQuery Group [{_StartNode_ | forestroot | domainroot}]
            [-o {dn | rdn | samid}]  [-scope {subtree | onelevel | base}]
               [-name _Name_] [-desc _Description_]  [-samid _Filter_]
                  [{-s _Server_ | -d _Domain_}] [-u _UserName_] [-p {_Password_ | *}]
                     [-q] [-r] [-gc] [-limit _NumberOfObjects_]  [{-uc | -uco | -uci}]

Key
    _StartNode_ | forestroot | domainroot  The node in the console tree where the search starts.
                                        forestroot = search using the global catalog. 

    -o       The format used to display the search results.
              dn = distinguished name. 
              rdn = relative distinguished name.
              samid = Security Accounts Manager (SAM) account name.

    -scope   The scope of the search:
              subtree = subtree that is rooted at the start node in the console tree.
              onelevel = immediate children of the start node only.
              base = single object that the start node represents.
            If forestroot is the Start Node, then subtree is the only valid scope. 

    -name    Search for group(s) whose name attribute(CN) matches _Name_.
            For example, "br*"

    -desc    Search for group(s) whose description matches. For example, "contractor*"

    -samid   Search for group(s) whose SAM account name matches _SAMName_

    -s       Server to connect to (Default=the domain controller in the logon domain.)
    -d       Domain to connect to.

    -u       Username with which the user logs on to a remote server. 
    -p       Password     (UserName or Domain\UserName or Username@domain.com)

    -q       Quiet, suppress all output.
    -r       Recursive search (follow referrals).
    -gc      Use the AD global catalog during the search.
    -limit   The maximum number of objects to return, default=100.

    -uc      Unicode format.
    -uco     Unicode format for output only.
    -uci     Unicode format for input only.

### Examples

Find all groups on the current domain with a name that starts with 'Admin'

C:> dsquery group -name Admin*

Find all groups in the 'Groups' OU

C:> dsquery group ou=Groups,ou=AcmeCo,dc=ss64,dc=com

“It is to Scotland that we look for our idea of civilization” ~ Voltaire

### Related commands

[DSQuery Site](dsquery-site.html) - Search for sites  
[DSAdd](dsadd.html) - Add object.  
[DSMod](dsmod.html) - Modify object.  
[DSGet](dsget.html) - Display object.  
[DSMove](dsmove.html) - Move object.  
[DSQuery](dsquery.html) - Search for objects.  
[DSRM](dsrm.html) - Delete object.  
PowerShell: [Get-adGroup](../ps/get-adgroup.html) - Get one or more AD groups.



/. nt/dsquery-computer.html
========================================================

    DSQuery Computer - Directory Service Query - Windows CMD - SS64.com

[DSQuery](dsquery.html) computer (installable option via [RSAT](../links/windows.html) /AD DS)
==============================================================================================

Search for computers in active directory.

Syntax

      DSQuery Computer [{_StartNode_ | forestroot | domainroot}]
         [-o {dn | rdn | samid}]  [-scope {subtree | onelevel | base}]
            [-name _Name_] [-desc _Description_] [-samid _SAMName_] [-inactive _NumberOfWeeks_]
               [-stalepwd _NumberOfDays_] [-disabled] 
                  [{-s _Server_ | -d _Domain_}] [-u _UserName_] [-p {_Password_ | *}]
                     [-q] [-r] [-gc] [-limit _NumberOfObjects_] [{-uc | -uco | -uci}]

Key
    _StartNode_ | forestroot | domainroot  The node in the console tree where the search starts.
                                        forestroot = search using the global catalog. 

    -o           The format used to display the search results.
                dn = distinguished name. 
                rdn = relative distinguished name.
                samid = Security Accounts Manager (SAM) account name.

    -scope       The scope of the search:
                subtree = subtree that is rooted at the start node in the console tree.
                onelevel = immediate children of the start node only.
                base = single object that the start node represents.
                If forestroot is the _StartNode_, then subtree is the only valid scope. 

    -name        Search for computer(s) whose name attribute(CN) matches _Name_.
                For example, "br*"

    -desc        Search for computer(s) whose description matches. For example, "dell*"

    -samid       Search for computer(s) whose SAM account names match _SAMName_

    -inactive    Search for computer(s) that have been inactive for _N_ number of weeks.

    -stalepwd    Search for computer(s) whose passwords have not changed for _n_ number of days.

    -disabled    Search for computer(s) whose accounts are disabled.

    -s       Server to connect to (Default=the domain controller in the logon domain.)
    -d       Domain to connect to.

    -u       Username with which the user logs on to a remote server. 
    -p       Password     (UserName or Domain\UserName or Username@domain.com)

    -q       Quiet, suppress all output.
    -r       Recursive search (follow referrals).
    -gc      Use the AD global catalog during the search.
    -limit   The maximum number of objects to return, default=100.

    -uc      Unicode format.
    -uco     Unicode format for output only.
    -uci     Unicode format for input only.

### Examples

Find all computers on the current domain with a name that starts with "wks" :

C:> dsquery computer -name wks* -desc desktop*

Find all computers in the Aberdeen OU:

C:> dsquery computer ou=Aberdeen,ou=Workstations,dc=ss64,dc=com

List the first 500 inactive computer accounts (more than 52 weeks inactive):

C:> dsquery computer -inactive 52 -limit 500

Disable all inactive computer accounts (more than 52 weeks inactive):

C:> dsquery computer -inactive 52 | dsmod computer -disabled yes

Delete all inactive computer accounts (more than 52 weeks inactive):

C:> dsquery computer -inactive 52 | dsrm -noprompt

“The best weapon against an enemy is another enemy" ~ Friedrich Nietzsche

### Related commands

[DSQuery Server](dsquery-server.html) - Search for server.  
[DSAdd](dsadd.html) - Add object.  
[DSMod](dsmod.html) - Modify object.  
[DSGet](dsget.html) - Display object.  
[DSMove](dsmove.html) - Move object.  
[DSQuery](dsquery.html) - Search for objects.  
[DSRM](dsrm.html) - Delete object.  
PowerShell: [Get-adComputer](../ps/get-adcomputer.html) - Get one or more AD computers.



/. nt/dsmod.html
========================================================

    Dsmod - Directory Service Modify - Windows CMD - SS64.com

DSMOD.exe (installable option via [RSAT](../links/windows.html) /AD DS)
=======================================================================

Modify active directory object.

Syntax

    [DSMOD Computer](dsmod-computer.html)
    [DSMOD Contact](dsmod-contact.html)
    [DSMOD Group](dsmod-group.html)
    [DSMOD OU](dsmod-ou.html)
    [DSMOD Server](dsmod-server.html)
    [DSMOD User](dsmod-user.html)
    [DSMOD Quota](dsmod-quota.html)
    [DSMOD Partition](dsmod-partition.html)

**Special characters in distinguished names**

Commas within a CN must be escaped with the backslash \ character  
e.g. "CN=Company****, Inc.,CN=Users,DC=ss64,DC=com"  
  
Backslashes must also be escaped with a backslash  
for example, "CN=Sales****\ Latin America,OU=Distribution Lists,DC=ss64,DC=com"

If any value contains spaces, use quotation marks:  
e.g. "CN=John Smith,CN=Users,DC=SS64,DC=com"  
  
**Redirection**  
You can [pipe](syntax-redirection.html) results from DSQUERY into DSMOD in order to modify an object. If the DN contains any commas or backslashes you will need to redirect to a file first and add the escape characters as above.

e.g. To find all users in the Marketing OU (organizational unit) and add them to the Sales group:

DSQUERY user -startnode "ou=Marketing,dc=SS64,dc=com" | DSMOD group "cn=Sales,ou=Marketing,dc=SS64,dc=com" -addmbr 

**Special Tokens**  
The token $username$ (case insensitive) can be used to place the SAM account name.  
Entering * as a password will cause DSMOD to prompt for the new password.

For any DS command you can enter multiple values separated by spaces.  
e.g. to modify several user accounts at once just supply a list of the distinguished names separated with spaces.

“The aim of science is not to open the door to infinite wisdom but to set a limit to infinite error” ~ Bertolt Brecht ‘Life of Galileo’

### Related commands

[DSAdd](dsadd.html) - Add object.  
[DSMod](dsmod.html) - Modify object.  
[DSGet](dsget.html) - Display object.  
[DSMove](dsmove.html) - Move object.  
[DSQuery](dsquery.html) - Search for objects.  
[DSRM](dsrm.html) - Delete object.  
[ADmodcmd](admodcmd.html) - Active Directory Bulk Modify.  
[CSVDE](csvde.html) - Import or export AD info in CSV format.  
[LDIFDE](csvde.html) - Edit AD Objects, extend schema, import or export AD information.  
[Q322684](https://support.microsoft.com/en-us/help/322684/) - Directory Service Command-Line Tools.  
Equivalent bash commands (Linux): [usermod](../bash/usermod.html)/[groupmod](../bash/groupmod.html)



/. nt/dsmod-user.html
========================================================

    DSMod user - Directory Service Modify - Windows CMD - SS64.com

[DSMOD](dsadd.html) User (installable option via [RSAT](../links/windows.html) /AD DS)
======================================================================================

Modify a user account in active directory.

Syntax

      dsmod user _UserDN_ [-upn _UPN_] [-c] [-q] [{-uc | -uco | -uci}] [_Options_] 

Key
    _UserDN_   Distinguished name of the user that you want to modify.
            If omitted will be taken from standard input (stdin).

    _UPN_      User Principal Name of the user, e.g. fred@SS64.com

    -c       Continue with the next object after any error (when you specify multiple target objects)
            by default dsmod will exit when the first error occurs.

    -q       Quiet, suppress all output.

    -uc      Unicode format.
    -uco     Unicode format for output only.
    -uci     Unicode format for input only.

Options:

    [-fn _FirstName_] [-mi _Initial_] [-ln _LastName_] [-display _DisplayName_]
    [-empid _EmployeeID_] [-pwd {_Password_ | *}]
    [-desc _Description_] [-memberof _Group_ ...] [-office _Office_] [-tel _PhoneNumber_]
    [-email _Email_] [-hometel _HomePhoneNumber_] [-pager _PagerNumber_]
    [-mobile _CellPhoneNumber_] [-fax _FaxNumber_] [-iptel _IPPhoneNumber_]
    [-webpg _WebPage_] [-title _Title_] [-dept _Department_]
    [-company _Company_] [-mgr _ManagersDistinguishedName_]
    [-hmdir _HomeDirectory_] [-hmdrv _DriveLetter_:][-profile _ProfilePath_]
    [-loscr _LoginScriptPath_] [-mustchpwd {yes | no}] [-canchpwd {yes | no}]
    [-reversiblepwd {yes | no}] [-pwdneverexpires {yes | no}]
    [-acctexpires _NumberOfDays_] [-disabled {yes | no}]
    [{-s _Server_ | -d _Domain_}]
    [-u _UserName_] [-p {_Password_ | *}]

To prevent a new password from being displayed on screen, enter it as an asterisk * , DSMOD will then prompt you (twice) to type the new password "blind".

The special token $username$, can be used to replace the SAM account name in the value of the -email, -hmdir, -profile, and -webpg parameters.

### Examples

Disable freds account:

C:> set _fred="cn=fred,ou=Users,ou=AcmeCo,dc=ss64,dc=com"  
C:> dsmod user %_fred% -disabled yes

Set the profile path of Fred and Ann using the $username$ token:

C:> set _ann="cn=AnnSmith,ou=Users,ou=AcmeCo,dc=ss64,dc=com"  
C:> dsmod user %_fred% %_ann% -profile \users\$username$\profile

“A person is a success if they get up in the morning and gets to bed at night and in between does what he wants to do” ~ Bob Dylan

### Related commands

[DSAdd](dsadd.html) - Add object. [DSAdd User](dsadd-user.html) - Add a user to active directory.  
[DSMod](dsmod.html) - Modify object.  
[DSGet](dsget.html) - Display object. [DSGet User](dsget-user.html) - Display user(s) from active directory.  
[DSMove](dsmove.html) - Move object.  
[DSQuery](dsquery.html) - Search for objects. [DSQuery User](dsquery-user.html) - Search for users in active directory.  
[DSRM](dsrm.html) - Delete object.  
How-to: [Reg Tweaks](syntax-reghacks.html) - Registry tweaks and settings for the current user.  
[ADmodcmd](admodcmd.html) - Active Directory Bulk Modify.  
PowerShell: [Set-adUser](../ps/set-aduser.html) - Modify an AD user.  
Equivalent bash commands (Linux): [usermod](../bash/usermod.html) - modify user.



/. nt/dsmod-group.html
========================================================

    DSMod group - Directory Service Modify - Windows CMD - SS64.com

[DSMOD](dsmod.html) Group (installable option via [RSAT](../links/windows.html) /AD DS)
=======================================================================================

Modify a group in active directory.

Syntax

      DSMOD Group _GroupDN_ [-secgrp {yes | no}] [-scope {l | g | u}] [-samid _SAMName_]
         [-desc _Description_]  [{-addmbr | -rmmbr | -chmbr} _MemberDN_ ...]
            [{-s _Server_ | -d _Domain_}] [-u _UserName_] [-p {_Password_ | *}]
               [-q] [{-uc | -uco | -uci}]

Key
    _Group_DN_  Distinguished name of the group that you want to add.
             If omitted will be taken from standard input (stdin).

    -secgrp   A security group (yes) or a distribution group (no) default=Yes.

    -scope    [Domain local](syntax-permissions.html) (l), [global](syntax-permissions.html) (g), or [universal](syntax-permissions.html) (u)   default=g

    _SAMName_   Unique SAM account name for this group.
             By default, the dn attribute from the GroupDN.

    -addmbr   Add members to the group.
|  -rmmbr    Remove members from the group.
    -chmbr    Replace members in the group.

    -s _Server_ Connect to a remote server/domain, default=%logonserver% domain controller.

    -c        Continue with the next object after any error (when you specify multiple target objects)
             by default dsmod will exit when the first error occurs.

    -q        Quiet, suppress all output.

    -uc       Unicode format.
    -uco      Unicode format for output only.
    -uci      Unicode format for input only.

### Examples

Add all members of the Finance group to the Sales group:

C:> set _finance="CN=Finance Dept,OU=Europe,DC=ss64,DC=com"  
C:> set _sales="CN=Sales Dept,OU=Europe,DC=ss64,DC=com"  
C:> dsget group %_finance% -members | dsmod group %_sales% -addmbr

Add all users from the Europe organizational unit (OU) to the existing group AfricaMarket:

C:> set _europe="OU=Europe,DC=ss64,DC=com"  
C:> set _AfricaMkt ="CN=AfricaMarket,OU=Africa,DC=ss64,DC=Com"  
C:> dsquery user %_europe% | dsmod group %_AfricaMkt% -addmbr

Add the user Fred to all administrator distribution list groups:

C:> set _dls="OU=Distribution Lists,DC=ss64,DC=com"  
C:> set _fred="cn=fred,ou=staff,dc=ss64,dc=com"  
C:> dsquery group %_dls% -name adm* | dsmod group -addmbr %_fred%

Add the user Fred to the finance group  
C:> dsmod group %_finance% -addmbr %_fred%

"When people show you who they are, believe them" ~ Maya Angelou

### Related commands

[DSAdd](dsadd.html) - Add object. [DSAdd Group](dsadd-group.html) - Add a group to AD.  
[DSMod](dsmod.html) - Modify object.  
[DSGet](dsget.html) - Display object. [DSGet group](dsget-group.html) - Display group(s) from active directory.  
[DSMove](dsmove.html) - Move object.  
[DSQuery](dsquery.html) - Search for objects.  
[DSRM](dsrm.html) - Delete object.  
How-to: [AD Groups](syntax-groups.html) - Local Domain groups, Global and Universal groups.  
PowerShell: [Set-adGroup](../ps/set-adgroup.html) - Modify an AD group.  
Equivalent bash commands (Linux): [groupmod](../bash/groupmod.html) - Modify Group.



/. nt/dsmod-computer.html
========================================================

    Dsmod computer - Directory Service Modify - Windows CMD - SS64.com

[DSMOD](dsmod.html) computer (installable option via [RSAT](../links/windows.html) /AD DS)
==========================================================================================

Modify a computer object in active directory.

Syntax

      DSMOD computer _Computer_DN_ -reset -disabled [-c] [-q] [{-uc | -uco | -uci}] [_options_]  
Key
    _Computer_DN_  Distinguished name of the computer that you want to add.
                If omitted will be taken from standard input (stdin).

    -reset       Reset computer account.

    -disabled {yes | no}    Disable the computer account for logon.

    -c       Continue with the next object after any error (when you specify multiple target objects)
            by default dsmod will exit when the first error occurs.

    -q       Quiet, suppress all output.

    -uc      Unicode format.
    -uco     Unicode format for output only.
    -uci     Unicode format for input only.

Options
    -desc _Description_
    -loc _Location_

    {-s _Server_ | -d _Domain_} By default, connects the computer to the domain controller in the logon domain.

    -u _UserName_             The user name with which a user logs on to a remote server.
                           By default, the currently logged on user.
    -p {_Password_ | *}

### Examples

Disable multiple computer accounts (CMD shell)

C:> set _mc1="CN=ServerA,CN=Computers,DC=ss64,DC=Com"  
C:> set _mc2="CN=ServerB,CN=Computers,DC=ss64,DC=Com"  
C:> dsmod computer %_mc1% %_mc2% -disabled yes

Reset multiple computer accounts (powershell)

PS C:> $mc1 = "CN=ServerA,CN=Computers,DC=ss64,DC=Com"  
PS C:> $mc2 = "CN=ServerB,CN=Computers,DC=ss64,DC=Com"  
PS C:> dsmod computer $mc1 $mc2 -reset

“If you want a thing done well, do it yourself” ~ Napoleon Bonaparte

### Related commands

[DSAdd](dsadd.html) - Add object.  
[DSMod](dsmod.html) - Modify object.  
[DSGet](dsget.html) - Display object.  
[DSMove](dsmove.html) - Move object.  
[DSQuery](dsquery.html) - Search for objects.  
[DSRM](dsrm.html) - Delete object.  
PowerShell: [Set-adComputer](../ps/set-adcomputer.html) - Modify an AD computer.



/. nt/dsmove.html
========================================================

    Dsmove - Directory Service Move - Windows CMD - SS64.com

DSMOVE.exe (installable option via [RSAT](../links/windows.html) /AD DS)
========================================================================

Rename or Move an active directory object (user, computer, group..) to a different Organisational Unit (OU).

Syntax

      DSMOVE _ObjectDN_ [-newname _NewRDN_] [-newparent _ParentDN_]
         [{-s _Server_ | -d _Domain_}]
            [-u _UserName_] [-p {_Password_ | *}]
               [-q] [{-uc | -uco | -uci}]

Options
    _ObjectDN_   Distinguished name of the computer that you want to add.
              If omitted will be taken from standard input (stdin).

    -newname   Rename the object with a new Relative Distinguished Name.

    -newparent New location for the object, enter the new parent DN.

    -q         Quiet, suppress all output.

    -uc        Unicode format.
    -uco       Unicode format for output only.
    -uci       Unicode format for input only.

    -u _UserName_ The user name with which a user logs on to a remote server.
               By default, the currently logged on user.

    -p _Password_ The password, or * to prompt for a password.

By default, DSMOVE connects the computer to the domain controller in the logon domain.

For any DS command you can enter multiple values separated by spaces.  
e.g. to modify several user accounts at once just supply a list of the distinguished names separated with spaces.

### Examples

Rename a user:

C:> set _andy="CN=Andrew Gorden,OU=Europe,DC=ss64,DC=Com"
C:> dsmove %_andy% -newname "Andrew Gordon"

Move a user to a different OU

C:> set _andy="CN=Andrew Gordon,OU=Europe,DC=ss64,DC=Com"
C:> set _newOrgUnit="OU=Asia,DC=ss64,DC=Com"
C:> dsmove %_andy% -newparent %_newOrgUnit%

"All that is gold does not glitter, Not all those who wander are lost;" ~ J. R. R. Tolkien

### Related commands

[DSAdd](dsadd.html) - Add object.  
[DSMod](dsmod.html) - Modify object.  
[DSGet](dsget.html) - Display object.  
[DSQuery](dsquery.html) - Search for objects.  
[DSRM](dsrm.html) - Delete object.  
[CSVDE](csvde.html) - Import or export AD info in CSV format.  
[LDIFDE](csvde.html) - Edit AD Objects, extend schema, import or export AD information.  
[Q322684](https://support.microsoft.com/en-us/help/322684/) - Directory Service Command-Line Tools.  
Equivalent bash commands (Linux): ldapmodify - Modify Lightweight Directory Access Protocol.



/. nt/dsrm.html
========================================================

    DSRM - Directory Service Remove - Windows CMD - SS64.com

DSRM.exe (installable option via [RSAT](../links/windows.html) /AD DS)
======================================================================

Delete objects from active directory.

Syntax

      DSRM _ObjectDN_ [-subtree [-exclude]] [-noprompt]
            [{-s _Server_ | -d _Domain_}] [-u _UserName_] [-p {_Password_ | *}]
               [-c] [-q] [{-uc | -uco | -uci}]

Key
    _ObjectDN_  Distinguished name of the group that you want to remove.
             If omitted will be taken from standard input (stdin).

    -subtree  Delete the object and all objects contained in its subtree.
    -exclude  Delete all objects contained in the subtree, but not the object itself.

    -noprompt Do not prompt to confirm deletion.

    -s _Server_ Connect to a remote server/domain, default=%logonserver% domain controller.

    -c        Continue with the next object after any error (when you specify multiple target objects)
             by default dsrm will exit when the first error occurs.

    -q        Quiet, suppress all output.

    -uc       Unicode format.
    -uco      Unicode format for output only.
    -uci      Unicode format for input only.

### Examples

Remove all objects under the OU AcmeCo, but leave the OU intact:  
  
C:> dsrm -subtree -exclude -noprompt -c "OU=AcmeCo,DC=ss64,DC=Com"

Find all the computer objects that have been inactive in AD for the last 52 weeks and remove them:

C:> dsquery computer -inactive 52 | dsrm -noprompt

“If future generations are to remember us with gratitude rather than contempt, we must leave them more than the miracles of technology. We must leave them a glimpse of the world as it was in the beginning, not just after we got through with it” ~ President Lyndon B. Johnson

### Related commands

[DSAdd](dsadd.html) - Add object.  
[DSMod](dsmod.html) - Modify object.  
[DSGet](dsget.html) - Display object.  
[DSMove](dsmove.html) - Move object.  
[DSQuery](dsquery.html) - Search for objects.  
[OldCmp](https://www.joeware.net/freetools/tools/oldcmp/) - Joeware utility for safely removing User and Computer accounts.  
Equivalent bash commands (Linux): [groupdel](../bash/groupdel.html)/[userdel](../bash/userdel.html) - Delete user/group.



/. nt/dsregcmd.html
========================================================

    DSREGCMD - Windows CMD - SS64.com

DSREGCMD
========

Directory Service Registration, device join status.

Syntax

      DSREGCMD _options_

Key
    /status       Display the device join status.
    /status_old   Display the device join status in old format.
    /join         Schedule and monitor the Autojoin task to Hybrid Join the device.
    /leave        Perform a Hybrid Unjoin.
                 Removes the device from azure and then re-joins on the next delta sync.
    /forcerecovery For Azure AD joined devices, will force a Sign out and Sign back in.
    /refreshprt   Refresh Primary Refresh Token (PRT) in the cloudAP cache.
    /debug        Display debug messages.

    /refreshp2pcerts  Refresh P2P certificates. *
    /cleanupaccounts  Delete all WAM accounts. *
    /listaccounts     List all WAM accounts. *
    /UpdateDevice     Update device attributes (e.g. a change in device name) to Azure AD. *
    /?            Help.

* = Windows 11 option.

Device State

> AzureAdJoined
> 
> EnterpriseJoined
> 
> DomainJoined
> 
> Device state
> 
> YES
> 
> NO
> 
> NO
> 
> Azure AD Joined
> 
> NO
> 
> NO
> 
> YES
> 
> Domain Joined
> 
> YES
> 
> NO
> 
> YES
> 
> Hybrid AD Joined
> 
> NO
> 
> YES
> 
> YES
> 
> On-premises DRS Joined

Device details

> The Device state is displayed only when the device is Azure AD-joined or hybrid Azure AD-joined (not Azure AD-registered).
> 
> *   DeviceId, Thumbprint, DeviceCertificateValidity, KeyContainerId, KeyProvider, TpmProtected, DeviceAuthStatus (device health in Azure AD, added in 21H1).

Tenant details

> The tenant details are displayed only when the device is Azure AD-joined or hybrid Azure AD-joined, not Azure AD-registered.
> 
> *   TenantName, TenantId, Idp, and various Urls.

User state

> Statuses of various attributes for users who are currently logged in to the device.

SSO state

> You can ignore this section for Azure AD registered devices.

Pre-join diagnostics

> This diagnostics section is displayed only if the device is domain-joined and unable to hybrid Azure AD-join. This section performs various tests to help diagnose join failures. The information includes the error phase, the error code, the server request ID, the server response http status, and the server response error message.

Post-join diagnostics

> This diagnostics section displays the output of sanity checks performed on a device that's joined to the cloud.
> 
> AadRecoveryEnabled: If the value is YES, the keys stored in the device aren't usable, and the device is marked for recovery. The next sign-in will trigger the recovery flow and re-register the device. KeySignTest: If the value is PASSED, the device keys are in good health.

NGC prerequisites check

> This diagnostics section performs the prerequisites check for setting up Windows Hello for Business (WHFB).

### Examples

C:> DSREGCMD /status

"There's no limit possible to the expansion of each one of us" ~ Charles M. Schwab

### Related commands

[BROWSTAT](browstat.html) - Get domain, browser and PDC info.  
[DSAdd](dsadd.html) - Add items to Active Directory ([user](dsadd-user.html) [group](dsadd-group.html) [computer](dsadd-computer.html)).  
[NTDSUtil](ntdsutil.html) - Active Directory Domain Services management.  
[Microsoft.com](https://learn.microsoft.com/en-us/azure/active-directory/devices/troubleshoot-device-dsregcmd) - Troubleshoot devices with dsregcmd.



/. nt/du.html
========================================================

    DU - Disk usage - Windows CMD - SS64.com

DU ([SysInternals](https://docs.microsoft.com/en-us/sysinternals/downloads/du))
===============================================================================

Report the disk space usage for a directory. By default DU will recurse to show the total size of a directory and its subdirectories.

Syntax

      DU [-c[t]] [-l _levels_ | -n | -v] [-u] [-q] [_Directory_]

Options
    -c 	Print output as CSV. 
    -ct  Print output with tab delimiting.
    -l 	Specify subdirectory depth of information (default is all levels).
    -n 	Do not recurse.
    -v 	Show size (in KB) of intermediate directories.
    -u 	Count each instance of a hardlinked file.
    -q 	Quiet (no banner).

When installing du.exe just ensure it is placed somewhere in either the system [PATH](path.html) or in the [current](cd.html) directory.

### Examples

List the files in E:\work and subfolders in verbose mode:

C:\demo> DU -v E:\work

“I think the main struggle for women in Hollywood and women in my position is to fight for true representation in the media and accurate representation of our many diverse qualities in stories” ~ Amber Heard, (Stylist Magazine 2011)

### Related commands

[DIR](dir.html) - Display a list of files and folders.  
[DISKUSE](diskuse.html) - Display disk usage.  
DirQuota - Create and manage quotas (File Server Resource Manager).  
[DIRUSE](diruse.html) - Display directory sizes/usage (2000 Resource Kit).  
[FSUTIL](fsutil.html) - File and Volume utilities.  
Equivalent PowerShell: [DirUse Script](../ps/syntax-diruse.html) to list directory sizes.  
Equivalent bash command (Linux): [quotacheck](../bash/quotacheck.html) - Scan a file system for disk usage.



/. nt/echo.html
========================================================

    Echo - Windows CMD - SS64.com

ECHO
====

Display messages on screen, turn command-echoing on or off.

Syntax

      ECHO [ON | OFF] 
      ECHO [_message_]
      ECHO /?
Key
    ON      : Display each line of the batch on screen (default)
    OFF     : Only display the command output on screen
    _message_ : a string of characters to display
    ?       : Display help

Type ECHO without parameters to display the current echo setting (ON or OFF).  
  
In most batch files you will want ECHO OFF, turning it ON can be useful when debugging a problematic batch script.

In a batch file, the @ symbol at the start of a line is the same as ECHO OFF applied to the current line only.

Normally a command is executed and takes effect from the next line onwards, @ is a rare example of a command that takes effect immediately.

### Examples

Escape Command characters
-------------------------

> Command characters will normally take precedence over the ECHO statement  
> e.g. The redirection and pipe characters: & < > | ON OFF
> 
> To override this behaviour you can [escape](syntax-esc.html#escape) each command character with ^ or : as follows:
> 
> ECHO Nice ^&Easy
> ECHO Salary is ^> Commision
> ECHO Name ^| Username ^| Expiry Date
> ECHO:Off On Holiday
> ECHO: /? Will display help
> 
> An alternative approach is to use SET /P which will display the string without interpreting anything.  
> 
> C:> <nul set/p "__any_variable_=string to emit"
> e.g.
> C:> <nul (set/p "_demo=This & That ^more < or > less")
> This & That ^more < or > less

Echo text into a FILE
---------------------

> The general syntax is:  
> Echo This is some Text **>** FileName.txt
> 
> To avoid extra spaces:  
> Echo Some more text**>**FileName.txt
> 
> To create an empty (zero byte) file:  
> Echo. **2>**EmptyFile.txt

Echo a Variable
---------------

> To display a department variable:  
>   
> ECHO %_department%  
>   
> A more robust alternative is to separate with : or ( instead of a space.
> 
> ECHO:%_department%
> 
> Using a colon like this will sanitise the values [ON /OFF /?](https://groups.google.com/forum/?hl=en#!msg/alt.msdos.batch.nt/VhNXmRQEcVk/J3-C8ViGOD0J) so for example
> 
> Set "_var=OFF"  
> Echo %_var%  
> Will will actually turn Echo off
> 
> Echo:%_var%  
> Will simply display "OFF"
> 
> Using Echo:in this way does have some limitations:
> 
> *   If the variable does not exist, ECHO: will return the variable name"%_var%"
> *   If you are using [DelayedExpansion](delayedexpansion.html) (!_var!) AND the syntax to search and [replace](syntax-replace.html) parts of a variable or display [substrings](syntax-substring.html) of a variable, then the Echo:syntax will not work. You can workaround this by using an intermediate variable or just reverting to the default parse time expansion of variables.
> 
> There are some edge cases (such as adding \..\..\..\..\ to a variable) where only ( will work without errors e.g. Echo(%var%

Echo a file
-----------

> Use the [TYPE](type.html) command.

Echo a sound
------------

> The following command in a batch file will trigger the default beep on most PC's
> 
> ECHO ^G
> 
> To type the [BELL](../ascii.html) character use Ctrl-G or 'Alt' key, and 7 on the numeric keypad. (ascii 7)
> 
> The default beep is [now](https://docs.microsoft.com/en-us/archive/blogs/larryosterman/whats-up-with-the-beep-driver-in-windows-7) played through the speakers/audio system, however if you select the 'No Sounds' scheme in Contol Panel ➞ Sounds ➞ Change system sounds, then the default beep will not play.
> 
> Alternatively using Windows Media Player:  
> START/min "C:\Program Files\Windows Media Player\wmplayer.exe" %windir%\media\chimes.wav

Echo a blank line
-----------------

> To produce an empty line, without displaying the echo status, use the Echo command immediately followed with a colon ([delimiter](syntax-esc.html#delimiters)):  
>   
> Echo First Line  
> Echo:  
> Echo Third line  
>   
> This can also be written as  
> Echo First Line & Echo: & Echo Third line
> 
> Several other [delimiter](syntax-esc.html#delimiters) characters will produce the same effect ; ( / + =
> 
> Other command delimiters are available but have buggy [side effects](https://www.dostips.com/forum/viewtopic.php?f=3&t=774&start=0), for example Echo. will search for a file named "echo" (or echo.exe) in the current directory, if such a file is found that will raise an error. If the 'echo' file does not exist then the command does work, but this still makes Echo. slightly slower than echo: (In recent builds of WIndows 10 Echo. will always throw an error.)  
> 
> To ECHO text _without_ including a CR/LF ([source](https://groups.google.com/forum/#!msg/microsoft.public.win2000.cmdprompt.admin/CHS0gwjZQDA/L85IIcFcLgkJ))  
> <nul (set/p _any_variable=string to emit)

Echo text inside a box
----------------------

> Extended ASCII [box-characters](https://en.wikipedia.org/w/index.php?title=Box-drawing_character#DOS) can be used to display characters inside a box, this will work in the most common [code pages](chcp.html), but you do need to ensure the batch file is encoded as ANSI, many text editors will automatically switch to unicode.
> 
> Echo Off
> Echo:
> Echo  ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
> Echo  ³                                                         ³
> Echo  ³ Hello this will appear inside a box                     ³
> Echo  ³                                                         ³
> Echo  ³                                                         ³
> Echo  ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
> Echo:
> Pause

Echo the system PATH
--------------------

> To view each item in the [path](path.html) on a single line, this works by [replacing](syntax-replace.html) the semicolons with newlines:
> 
> ECHO:%PATH:;= & ECHO:%

Echo text into a stream
-----------------------

> Streams allow one file to contain several separate forks of information, like the macintosh resource fork.
> 
> The general syntax is:

    Echo Text_String > FileName:StreamName

> Only the following commands support the File:Stream syntax - ECHO, MORE, FOR
> 
> Creating streams:
> 
> Echo This is stream1 > myfile.dat:stream1 
> Echo This is stream2 > myfile.dat:stream2

Displaying streams:
-------------------

    More < myfile.dat:stream1 
    More < myfile.dat:stream2
   
    FOR /f "delims=*" %%G in (myfile.dat:stream1) DO echo %%G
    FOR /f "delims=*" %%G in (myfile.dat:stream2) DO echo %%G

> A data stream file can be successfully copied and renamed despite the fact that most applications and commands will report a zero length file. The file size can be calculated from remaining free space. The file must always reside on an NTFS volume.

ECHO does not set or clear the [Errorlevel](errorlevel.html).  
ECHO is an [internal](syntax-internal.html) command.

“The only thing that helps me pass the time away; is knowing I'll be back at Echo Beach some day” ~ Martha and the Muffins

### Related commands

[ANSI colors](syntax-ansi.html) - Use ANSI colors in the terminal.  
[SET](set.html) - Create and display environment variables.  
[TYPE](type.html) - Display the contents of a text file.  
[Banner.cmd](syntax-banner.html) - Batch file to display a string of text in extra large letters.  
[NET SEND](net.html) %COMPUTERNAME%  
SoundRecorder.exe - Record.  
[Q177795](https://support.microsoft.com/en-us/help/177795/) - Large vs Small fonts.  
[Q901115](https://support.microsoft.com/en-us/help/901115/) - Terminal Services/Citrix client makes beep sounds.  
Equivalent PowerShell cmdlet: [Write-Host](../ps/write-host.html)  
Equivalent bash command: [echo](../bash/echo.html) - Display message on screen.



/. nt/endlocal.html
========================================================

    Endlocal - Local environment variables - Windows CMD - SS64.com

ENDLOCAL
========

End localisation of environment changes in a batch file. Pass variables from one batch file to another.

Syntax

      ENDLOCAL

If [SETLOCAL](setlocal.html) is used to make variables 'local' to one batch script, then those variables will be invisible to all other batch scripts unless explicitly passed using an ENDLOCAL & SET... command.

If SETLOCAL is used without a corresponding ENDLOCAL then local environment variables will be discarded when the batch file ends.  
In effect the ENDLOCAL happens automatically when the script terminates.

Ending a cmd.exe session will discard all Environment Variables both local and global.

If a batch script does not use SETLOCAL then all variables will be Global, i.e. visible and modifiable from other calling scripts or on the command line after the script has completed.

Passing variables from one routine to another
---------------------------------------------

> The CMD command processor always works on a line-by-line basis, so it will convert all %variables% into their text values before executing any of the commands.  
>   
> By putting ENDLOCAL [&](syntax-redirection.html) SET commands on a single line you are able to SET a variable just before the localisation is ended by the ENDLOCAL command.
> 
> ENDLOCAL does not reset %errorlevel%  
>   
> **Examples**:
> 
> ::Sales.cmd
>    
>    @Echo off
>    SETLOCAL
>       Set "_item=Ice Cream Maker"
>       Set _price=450
>    ENDLOCAL **&** SET _return1=%_item%**&** SET _return2=%_price%
> 
> ::Results.cmd
> 
>    @Echo off
>    SETLOCAL
>    CALL Sales.cmd
>    Echo [%_return1%] will cost [%_return2%]
> 
> ::SubDemo.cmd
>    
>    @Echo off
>    SETLOCAL
>    CALL :sub_products
>    Echo [%_return1%] will cost [%_return2%]
>    goto:eof
> 
>    :sub_products
>    SETLOCAL
>       Set "_item=Coffee Grinder"
>       Set _price=150
>    ENDLOCAL **&** SET _return1=%_item%**&** SET _return2=%_price%
> 
> Multiple SET commands can be added to pass multiple variables, just prefix each with an **&**  
> Be aware that any trailing spaces    will be added to the variables value.

Improving readability
---------------------

> The 'ENDLOCAL **&** SET' technique described above can become difficult to read if you have a lot of SET commands all on the same line. This can be made easier to read if you use parentheses.
> 
> Endlocal&(  
> set "_return1=%_item%"  
> set "_return2=%_price%"  
> set "_return3=%_discount%")
> 
> In these examples we have used the variable names _return1, _return2 etc, and quoted all the assignments. You can of course use any names for the return variables, even re-use the exact same variable name inside and outside the ENDLOCAL command (SET _price=%_price%)

ENDLOCAL does not set or clear the [Errorlevel](errorlevel.html).  
ENDLOCAL is an [internal](syntax-internal.html) command.

_"A good place to visit, but a poor place to stay" ~ Josh Billings_

### Related commands

[SETLOCAL](setlocal.html) - Begin localisation of environment variables in a batch file.  
How-to: [Functions](syntax-functions.html) - How to package blocks of code with ’tunneling'.  
Equivalent bash command (Linux): [readonly](../bash/readonly.html) - Mark variables/functions as readonly.



/. nt/del.html
========================================================

    Del - Delete Files - Windows CMD - SS64.com

DEL
===

Delete one or more files.

Syntax

      DEL [_options_] [/A:_file_attributes_] _files_to_delete_

Key
    _files_to_delete_ : A filename or a list of files, may include wildcards.

    options:
      /P  Give a Yes/No Prompt before deleting. 
      /F  Ignore read-only setting and delete anyway (FORCE) 
      /S  Delete from all Subfolders (DELTREE)
      /Q  Quiet mode, do not give a Yes/No Prompt before deleting.

      /A  Select files to delete based on _file_attributes_
            file_attributes:
              R  Read-only    -R  NOT Read-only
              A  Archive      -A  NOT Archive
              S  System       -S  NOT System
              H  Hidden       -H  NOT Hidden
              I  Not content indexed  -I  content indexed files
              L  Reparse points       -L  NOT Reparse points

              X  No scrub file attribute  -X  Scrub file attribute   (Windows 8+)
              V  Integrity attribute      -V  NO Integrity attribute (Windows 8+)

    [Wildcards](syntax-wildcards.html): These can be combined with part of a filename

      *  Match any characters
      ?  Match any ONE character

If a folder name is given instead of a file, all files in the folder will be deleted, but the folder itself will not be removed.

Errorlevels: DEL will return an [Errorlevel](errorlevel.html) of 0, irrespective if the delete succeeds or fails for any reason.  
Also a deletion failure will not fire for [||](syntax-redirection.html) unless the DEL arguments are invalid.  
If you delete files using PowerShell then a True/False return code ($?) will be set correctly.

Errorlevels
-----------

> If the files were successfully deleted [%ERRORLEVEL%](errorlevel.html) = 0  
> If the files failed to delete, or don’t exist to be deleted [%ERRORLEVEL%](errorlevel.html) = 0  
> Bad or no parameters given [%ERRORLEVEL%](errorlevel.html) = 1

Undeletable Files
-----------------

> Files are sometimes created with a very long filename or a trailing period or with reserved names (CON, AUX, COM1, COM2, COM3, COM4, LPT1, LPT2, LPT3, PRN, NUL) and as a result they become impossible to delete with Windows Explorer.
> 
> To delete such files use the [Device Path](syntax-filenames.html): DEL "\?\path to file"  
> 
> e,g,  
> DEL "\?\C:\some folder\AZH64GT."  
> 
> Alternatively for long filenames, you can reduce the total path length by using [SUBST](subst.html) to map a drive letter to the folder containing the file.
> 
> It is also possible to delete long paths using [RoboCopy](robocopy.html) - Copy/Move the required files to a temporary folder and then delete the folder, one gotcha with that technique is RoboCopy's tendency to follow symbolic links which can cause files outside the source folder to be moved/ deleted.
> 
> If a file is still 'undeletable' this may be caused by the indexing [service](syntax-services.html), temporarily stop the service and then delete the file.
> 
> **Thumbs.db**
> 
> If you are unable to delete thumbs.db using Windows Explorer or while Explorer is open, this is a bug in the thumbnail view for images. This issue can occur for folders which don't even contain any images.  
> To resolve, open Explorer, select View ➞ Options, open the "View" tab and uncheck "Display file icon on thumbnails".  
> For a more permanent [registry fix](thumbsdb.txt), you can disable thumbnail caching completely.

Permanent deletion
------------------

> Deleting a file will not prevent third party utilities from un-deleting it again. Secure file deletion utilities are available, however for casual use, you can turn any file into a zero-byte file to destroy the file allocation chain like this:  
>   
> TYPE nul > C:\examples\MyFile.txt  
> DEL C:\examples\MyFile.txt

Delete Locked files
-------------------

> Typically this is caused by the Offline Cache or Internet Explorer temp files.
> 
> Close all applications  
> Open a command prompt  
> Click Start, and then Shut Down  
> Simultaneously press CTRL+SHIFT+ALT.  
> While you keep these keys pressed, click Cancel in the Shut Down Windows dialog box.  
> In the command prompt window, navigate to the cache location, and delete all files from the folder (DEL /s)  
> At the command prompt, type explorer, and then press ENTER.

**DELTREE** - Older versions of Windows had the DELTREE command to delete all files and sub folders. This can be replicated with a script as shown on the [DELTREE](deltree.html) page.

### Examples

Delete "Hello World.txt"

DEL "Hello World.txt"

Delete 3 named files:

DEL file1.txt file2.txt "C:\demo\file3.txt"

Delete all files that start with the letter A

DEL A*  
  
Delete all files that end with the letter A

DEL *A.*

Delete all files with a .doc extension:

DEL *.doc  
  
Delete all read only files:

DEL /a:R *  
  
Delete all files including any that are read only:

DEL /F *

Normally DEL will display a list of the files deleted, if [Command Extensions](cmd.html) are disabled; it will instead display a list of any files it cannot find.

DEL is an [internal](syntax-internal.html) command. ERASE is a synonym for DEL

“But over all things brooding slept, The quiet sense of something lost” ~ Alfred Tennyson

### Related commands

[CIPHER /w](cipher.html) - Overwrite data in a directory (secure delete).  
[DELPROF](delprof.html) - Delete user profiles.  
[DELTREE](deltree.html) - Script to Delete a folder and all subfolders/files.  
[RD](rd.html) - Delete folders or entire folder trees.  
[CleanMgr](cleanmgr.html) - Automated cleanup of Temp files, Internet files, downloaded files, recycle bin.  
[FORFILES](forfiles.html) - Delete files older than X days.  
[INUSE](https://web.archive.org/web/20050921194716/https://support.microsoft.com/?id=228930) - updated file replacement utility (may not preserve file permissions).  
[Q120716](https://web.archive.org/web/20120215131526/http://support.microsoft.com:80/kb/120716/EN-US) - Remove Files with Reserved Names.  
[Q320081](https://support.microsoft.com/en-us/help/320081/) - You cannot delete a file or folder.  
[Q159199](https://web.archive.org/web/20050213173509/https://support.microsoft.com/?id=159199) - A file cannot be deleted (NTFS).  
PowerShell: [Remove-Item](../ps/remove-item.html) - Delete the specified items.  
Equivalent bash command (Linux): [rmdir](../bash/rmdir.html) / [rm](../bash/rm.html) - Remove folders/ files.



/. nt/eventcreate.html
========================================================

    EventCreate - Windows CMD - SS64.com

EVENTCREATE
===========

Add a message to the Windows event log, requires administrator rights.

Syntax

      EVENTCREATE [/S _system_ [/U _username_ [/P [_password_]]]] /ID _eventid_
            [/L _logname_] [/SO srcname] /T type /D description

Key:
    /S _system_         The remote system to connect to.

    /U [_domain_\]_user_  User credentials under which to execute.

    /P [_password_]     Password for _user,_ will prompt if omitted.

    /L _logname_        The event log to create an event in.

    /T _type_           The type of event to create: SUCCESS, ERROR, WARNING, INFORMATION.

    /SO _source_        The source to use for the event  A text string that represents the application
                      or component that is generating the event. Default='eventcreate'

    /ID _id_            Event ID, a number between 1 - 1000.

    /D _description_    Description text for the new event.

    /?                Help

### Examples

Add an ERROR to the Application log:  
C:> EVENTCREATE /T ERROR /ID 1000 /L APPLICATION /D "My application error mesaage"  
  
Add a WARNING to the Application log for Application SS64App:  
C:> EVENTCREATE /T WARNING /ID 500 /L APPLICATION /SO SS64App /D "Running low on diskspace"  
  
Add an ERROR to the Application log on Server401:  
C:> EVENTCREATE /S Server401 /T ERROR /ID 250 /L APPLICATION /D "Something bad happened"  
  
Add an ERROR to the Application log on Server401:  
C:> EVENTCREATE /S Server401 /U billg /P password /ID 250 /T ERROR /L APPLICATION /D "Something bad happened"

“Ideology: a system of organizing principals, a way of seeing the world as the basis of a social or political philosophy or program”

### Related commands

EVENTQUERY - Read an event log message.  
EVENTTRIGGERS - Display and configure Event Triggers.  
[LOGMAN](logman.html) - Manage Performance Monitor & performance logs from the command line.  
RELOG - Extract performance counters from performance counter logs into other formats (Server).  
PowerShell: [Get-Eventlog](../ps/get-eventlog.html) - Get / write eventlog data.  
VBScript: [WshShell.LogEvent](../vb/logevent.html) - Log an item in the Event log.  
[WMIC NTEVENTLOG](wmic.html) - WMI access to the event log.



/. nt/exit.html
========================================================

    Exit - Terminate a script - Windows CMD - SS64.com

EXIT
====

Close the current batch script, exit the current subroutine or close the CMD.EXE session, optionally setting an errorlevel.

Syntax

      EXIT [/B] [_exitCode_]

Key
    /B        When used in a batch script, this option will exit 
              only the script (or subroutine) but not CMD.EXE
              If executed on the command-line it will close CMD.exe

    _exitCode_   Sets the %ERRORLEVEL% to a numeric number.
              If quitting CMD.EXE, sets the process exit code no.

To close an interactive command prompt, the [keyboard shortcut](syntax-keyboard.html) ALT + F4 is an alternative to typing EXIT.

If you start a second nested CMD shell (or PowerShell), this will be added to the [TITLE](title.html) of the CMD/terminal window, when you EXIT back to the initial shell, the Title will also revert making it possible to track how many nested shells you have open.

Errorlevel
----------

> EXIT /b has the option to set a specific exit code, EXIT /b 0 for sucess, EXIT /b 1 (or greater) for an error.  
> The exit code can be an integer of up to 10 digits in length (positive or negative).
> 
> EXIT without an ExitCode acts the same as [goto:eof](goto.html) and will not alter the [ERRORLEVEL](errorlevel.html)
> 
> n.b. You should never attempt to directly write to the %ERRORLEVEL% variable, (SET ERRORLEVEL _n_ ) instead use EXIT /b _n_ as a safe way to set the internal ERRORLEVEL pseudo variable to _n_.

Ctrl-C
------

> An errorlevel of -1073741510 will be interpreted by CMD.exe as a Ctrl-C Key sequence to cancel the current operation, not the entire script which EXIT will do.
> 
> To use this in a batch file, launch a new CMD session and immediately exit it, passing this errorlevel. The script will then act as though Ctrl-C had been pressed. [Source and examples](https://www.dostips.com/forum/viewtopic.php?t=5859) on DosTips.com.
> 
> ::Ctrl-C  
> cmd /c exit -1073741510

When EXIT /b used with [FOR /L](for_l.html), the execution of the commands in the loop is stopped, but the loop itself [continues](https://ss64.org/viewtopic.php?f=2&t=334) until the end count is reached. This will cause slow performance if the loop is (pointlessly) counting up to a large number.  
In the case of an infinite loop, this EXIT /b behaviour will cause the script to hang until manually terminated with Ctrl + C

Exiting nested [FOR](for.html) loops, EXIT /b can be used to exit a FOR loop that is nested within another FOR loop.  
This will only work if the inner FOR loop is contained in a separate [subroutine](call.html), so that EXIT /b (or [goto:eof](goto.html)) will terminate the subroutine.

### Examples

Exit if a required file is missing:

> @Echo Off  
> If not exist MyimportantFile.txt **Exit /b**  
> Echo If we get this far the file was found

Set the [errorlevel](errorlevel.html) to 5:

> @Echo Off  
> Call :setError  
> Echo %errorlevel%  
> Goto :eof
> 
> :setError  
> Exit /B 5

Run a batch file which exits with an error and then display it. In these examples throw_err.cmd does nothing other than exit with error #3:

> C:> Echo @exit **/b** 3 > throw_err.cmd
> C:> CMD /c throw_err.cmd && echo Success || echo Error: %errorlevel%  
> 1
> 
> C:> CMD /K throw_err.cmd && echo Success || echo Error: %errorlevel%
> C:> exit
> 3
> 
> C:> Echo @exit 3 > throw_err.cmd
> C:> CMD /c throw_err.cmd && echo Success || echo Error: %errorlevel%  
> 3
> 
> From PowerShell (this works with or without /b):
> PS C:> ./throw_err.cmd
> PS C:> $lastExitCode
> 3

Use EXIT /b to exit a nested FOR loop (so skipping the values X,Y and Z), but still continue back to the main outer loop:

> @Echo Off
> Setlocal 
> For %%A in (alpha beta gamma) DO (
>    Echo Outer loop %%A
>    Call :inner 
> )
> Goto :eof
> 
> :inner
> For %%B in (U V W X Y Z) DO (
>    if %%B==X ( **exit /b 2** )
>    Echo    Inner loop    Outer=%%A Inner=%%B
> )

EXIT is an [internal](syntax-internal.html) command.  
If [Command Extensions](cmd.html) are disabled, the EXIT command will still work but may output a spurious 'cannot find the batch label' error.

“Making music is not about a place you go. It’s about a place you get out of. I’m underwater most of the time, and music is like a tube to the surface that I can breathe through. It’s my air hole up to the world. If I didn’t have the music I’d be under water, dead” ~ Fiona Apple

### Related commands

[VERIFY](verify.html) - Provides an alternative method of raising an error level without exiting.  
[TSKILL](tskill.html) - End a running process.  
Equivalent PowerShell: [Exit](../ps/exit-pssession.html) - Exit PowerShell or [break](../ps/break.html) - Exit a program loop.  
Equivalent bash command (Linux): [](../bash/export.html)[break](../bash/break.html) - Exit from a loop.



/. nt/expand.html
========================================================

    expand - Windows CMD - SS64.com

EXPAND
======

Uncompress one or more compressed .CAB cabinet files.

Syntax

      EXPAND [-R] _Source Destination_
      EXPAND -R _Source_ [_Destination_]
      EXPAND -I _Source_ [_Destination_]
      EXPAND -D _Source_.cab [-F:_Files_]
      EXPAND _Source_.cab -F:_Files_ _Destination_

Options
    _Source_       Source file specification.  Wildcards can be used.

  -F:_Files_      Name of files to expand from a .CAB.

  _Destination_   Destination file | path specification.
                Destination can be a directory.
                If _Source_ is multiple files and -r is not specified,
                Destination must be a directory.

  -R            Rename expanded files.

  -I            Rename expanded files but ignore directory structure.

  -D            Display list of files in source.
                The output display does not display the PATH, but will use it on the extraction.

The Microsoft File Expansion Utility dates back to MS-DOS 5 in 1990 supplied on floppy disc.

Versions of Expand prior to 6.0 (Windows 7) have buggy handling of cab files that contain subfolders - [Full details](https://ss64.org/viewtopic.php?t=71) over on the forum.

### Examples

C:> Expand -d demo.cab

"There's no limit possible to the expansion of each one of us" ~ Charles M. Schwab

### Related commands

[ATTRIB](../nt/attrib.html) - Display or change file attributes.  
[COPY](copy.html) - Copy one or more files to another location.  
[EXTRACT](extract.html) - Uncompress CAB files.  
[MAKECAB](makecab.html) - Create .CAB files.  
Equivalent bash command (Linux): [gzip](../bash/gzip.html) - Compress or decompress named file(s).



/. nt/explorer.html
========================================================

    Explorer.exe - Windows CMD - SS64.com

Explorer.exe
============

Command-line switches that you can use to open the GUI Windows Explorer (Explorer.exe).

Syntax

      Explorer.exe _options_

Options
    /n            Open a new single-pane window for the default selection. This is usually the root
                  of the drive Windows is installed on. If the window is already open, a duplicate opens.

    /e            Open Windows Explorer in its default view. This is usually the users home drive.

  (,)/root,_object_ Open the specified object in a window view.

    /select,_object_ Open a window view with the specified folder, file or application selected.

    /separate      Launch an explorer instance as a separate process (undocumented option).

Quotation marks are required if the File/Folder object contains spaces or symbols.

If /e or /n are followed by a comma and folder path then explorer will open and display the folder, the /e or /n have no effect, this provides backwards compatibility with older versions of Windows. If the _object_ is given as a filename rather than a folder, the file will be opened using the default application, like [START](start.html).

Explorer.exe is normally found in the Windows folder, typically C:\Windows\Explorer.exe

Current versions of Windows no longer allow the use of variables such as %username% in a [shortcut](shortcut.html) **target** executable, but you can pass a variable as a **parameter** to Explorer.exe making it possible to build shortcuts which open explorer at a given path. A kind of poor mans [folder redirection](https://docs.microsoft.com/en-us/windows-server/storage/folder-redirection/folder-redirection-rup-overview).

Windows File Explorer search box
--------------------------------

> Windows File explorer supports Advanced Query Syntax (AQS) to help define precise searches.  
> Microsoft describe this as an '[obsolete technology'](https://learn.microsoft.com/en-gb/windows/win32/lwef/-search-2x-wds-aqsreference) but it is still present and mostly working. Searches work for filenames and properties but not reliably for file contents, use a third party tool for that.  
> 
> File kind to search
> 
> AQS Keyword
> 
> Example
> 
> All file kinds
> 
> everything
> 
> kind:everything
> 
> Author
> 
> author or by
> 
> author:"Gabrielle Zavin"
> 
> Company
> 
> company
> 
> company:Microsoft
> 
> Date
> 
> date
> 
> date:today  
> date:tomorrow  
> date:yesterday  
> date:this week  
> date:last week  
> date:next month  
> date:past month  
> date:coming year
> 
> Date modified
> 
> datemodified or modified
> 
> modified:last week
> 
> Deleted
> 
> deleted or isdeleted
> 
> isdeleted:true
> 
> Documents
> 
> docs
> 
> kind:docs
> 
> Favorites
> 
> favorites
> 
> kind:favorites
> 
> File extension
> 
> ext or fileext
> 
> ext:.txt
> 
> File name or foldername
> 
> Filename or name
> 
> filename:MyResume  
> filename:*Resume
> 
> File name or foldername (exact match)
> 
> Filename or name
> 
> filename:=MyResume
> 
> Files within a specific folder or any subfolders
> 
> folder, under or path
> 
> folder:downloads  
> folder:"Public\Public Desktop"
> 
> Files within a specific folder name
> 
> foldername or in
> 
> foldername:mydocs or in:mydocs
> 
> Folders
> 
> folders
> 
> kind:folders
> 
> Music
> 
> music
> 
> kind:music
> 
> Pictures
> 
> pics
> 
> kind:pics
> 
> Presentations
> 
> presentations
> 
> kind:presentations
> 
> Programs
> 
> programs
> 
> kind:programs
> 
> Size
> 
> size
> 
> size:> 5m
> 
> Spreadsheets
> 
> spreadsheets
> 
> kind:spreadsheets
> 
> Status
> 
> status
> 
> status:complete
> 
> Text documents
> 
> text
> 
> kind:text
> 
> Title
> 
> title, subject or about
> 
> title:"Quarterly Financial"
> 
> Videos
> 
> videos
> 
> kind:videos
> 
> There are [additional](https://learn.microsoft.com/en-gb/windows/win32/lwef/-search-2x-wds-aqsreference) keywords available but many will only work for specific document types (e.g. datelastprinted: lastsavedby).
> 
> You can combine search keywords and file properties with the following operators to broaden or narrow a search.
> 
> Operator
> 
> Example
> 
> Result
> 
> NOT
> 
> social NOT security
> 
> Finds items that contain _social_, but not _security_.
> 
> Space
> 
> social security
> 
> Finds items that contain _social_ and _security_.
> 
> OR
> 
> social OR security
> 
> Finds items that contain _social_ or _security_.
> 
> Quotation marks
> 
> "social security"
> 
> Finds items that contain the exact phrase _social security_.  
> Use quotes to match "long filenames".
> 
> Parentheses
> 
> (social security)
> 
> Finds items that contain _social_ and _security_ in any order.
> 
> >
> 
> date:>11/13/2023  
> size:>500  
> 
> Finds items newer than a given date (use the [locale's](../locale.html) [date format](date.html)).  
> Finds items with a size greater than 500 bytes.  
> 
> <
> 
> date:<11/13/2023  
> size:<50k  
> 
> Finds items older than a given date (use the locale's [date format](date.html)).  
> Finds items with a size less than 50 Kbytes.  
> 
> ..
> 
> date:11/13/21..11/15/21
> 
> Finds items with a modified date between the given range (use the locale's [date format](date.html)).
> 
> The operators **NOT** and **OR** must be in uppercase and can't be combined in the same query.
> 
> Similar search options are provided in macOS Finder but with a graphical interface.

### Examples

Open a Windows Explorer window at the current directory:

C:\some folder> Explorer .

Open an Explorer window with the 'C:\Demo' folder displayed:

Explorer.exe "C:\Demo"

Open an Explorer window with the 'examples' folder displayed and its parent hidden:

Explorer.exe /root,"C:\Demo\examples"

Open a webpage in Microsoft Edge:

%windir%\explorer.exe microsoft-edge:https://ss64.com

Open an Explorer window with SS64App selected:

Explorer.exe /select,"C:\Demo\SS64App.exe"

Open an Explorer window with C: expanded and SS64App selected:

Explorer.exe /e,/root,"C:\Demo\SS64App.exe"

Open an Explorer window with the share \server64\FileShare1 :

Explorer.exe /root,"\server64\FileShare1"

Open an Explorer window with TestApp.exe selected in the share\server64\FileShare1 :

Explorer.exe /root,\server64\FileShare1,select,SS64App.exe

Open an Explorer window at the root of the system drive C:\

Explorer \

Open an Explorer window at 'My Documents':

Explorer \  
or  
Explorer /

Open an Explorer window at 'the Computer':

Explorer ','

“From the growth of the Internet through to the mapping of the human genome and our understanding of the human brain, the more we understand, the more there seems to be for us to explore” ~ Martin Rees

### Related commands

[Shell: folder](shell.html) - Shortcuts to key folders.  
[CMD](cmd.html) - Start a new CMD shell.  
[RUN](run.html) [Start ➞ RUN](run.html) commands.  
[START](start.html) - Start a program, command or batch file.  
[ProfileFolders](syntax-folders.html) - Location of user profile folders.  
[Q152457](https://web.archive.org/web/20150602220856/https://support.microsoft.com/en-us/kb/152457) - Windows Explorer Command-Line Options.



/. nt/extract.html
========================================================

    Extrac32 - Uncompress files - Windows CMD - SS64.com

EXTRACT.exe / Extrac32.exe
==========================

Uncompress one or more compressed .CAB cabinet files.

Syntax

      EXTRACT  [/Y] [/A] [/D | /E] [/L _dir_] _cabinet_ [_filename..._]

      Extrac32 [/Y] [/A] [/D | /E] [/L _dir_] _cabinet_ [_filename_...]

      Extrac32 [/Y] _source_ [_newname_]

      Extrac32 [/Y] /C _source destination_

Key
    _cabinet_    Cabinet file (contains two or more files.)

    _filenames _ Name of the file to extract from the cabinet
              Wild cards (*.*) (.) and multiple files (separated by
              blanks are valid.

    source   Compressed file (a cabinet with only one file.)

    newname  New filename to give the exracted file.
            If not supplied the original name is used.

    /A       Process ALL cabinets. Follow cabinet chain.

    /C       Copy source file to destination (to copy from DMF floppy disks.)

    /D       Display cabinet directory (use with _filename_ to avoid extract)

    /E       Extract all (use instead of *.* to extract all files)

    /L _dir_   Location to place extracted files (default is current folder)

    /Y       Overwrite files without any prompt

Extrac32.exe is part of Internet Explorer, it can be used from the command line, but does not display any output on the console.  
The output can be revealed by redirecting it through the [more](more.html) utility extrac32.exe /? | more

### Examples

Extracting the archive demo.cab to the work folder:

C:> extrac32.exe demo.cab /L "C:\work\"

Create a self extracting archive containing movie.mov:

C:> makecab movie.mov "temp.cab"  
C:> copy /b "%windir%\system32\extrac32.exe"+"temp.cab" "movie.exe"  
C:> del /q /f "temp.cab"

“It is not the man who has too little, but the man who craves more, who is poor” ~ President José Mujica

### Related commands

[ATTRIB](../nt/attrib.html) - Display or change file attributes.  
[COPY](copy.html) - Copy one or more files to another location.  
[MAKECAB](makecab.html) - Create .CAB file.  
[Q132913](https://web.archive.org/web/20140208083217/https://support.microsoft.com/kb/132913) - Extract utility.  
Equivalent bash command (Linux): [gzip](../bash/gzip.html) - Compress or decompress named file(s).



/. nt/fc.html
========================================================

    FC - file compare - Windows CMD - SS64.com

FC.exe
======

Compare the contents of two files or sets of files. Display any lines which do NOT match.

Syntax

      FC [_options_] [_drive1_:][_path1_] _**filename1**_ [_drive2_:][_path2_] _**filename2**_

Options
    /A    Abbreviate the output of an ASCII comparison, display only first and last lines
         for each set of differences.

    /B    Perform a binary comparison. FC compares the two files byte by byte and does not attempt
         to resynchronize the files after finding a mismatch.
         This is the default mode for comparing files that have the following file extensions:
          .exe, .com, .sys, .obj, .lib, or .bin. 

    /C    Do a case insensitive string comparison

    /L    Compare the files in ASCII mode. Fc compares the two files line by line and attempts to resynchronize
         the files after finding a mismatch.
         This is the default mode for comparing non binary files, see /B. 

    /LB_n_  Set the _n_ number of lines for the internal line buffer. The default length of the line buffer is 100 lines.
         If the files being compared have more than this number of consecutive differing lines, FC cancels the comparison. 

    /N    Display line numbers during an ASCII comparison.

    /T    Prevent FC from converting tabs to spaces.
         The default behavior is to treat tabs as spaces, with stops at each eighth character position.

    /U    Compares files as Unicode text files.

    /W    Compress white space (that is, tabs and spaces) during the comparison.
         If a line contains many consecutive spaces or tabs, /w treats these characters as a single space.
         When used with the /W command-line option, FC ignores (and does not compare) white space at the beginning and end of a line. 

    /_nnnn_   The a number of consecutive lines that must match before FC considers the files to be resynchronized.
           If the number of matching lines in the files is less than _nnnn_, FC displays the matching lines as differences.
           The default value is 2.

 [ _drive1_ : ][ _path1_ ] _filename1_   The location and name of the first file you want to compare.
                                   Filename1 is required.

 [ _drive2_ : ][ _path2_ ] _filename2_   The location and name of the second file you want to compare.
                                   Filename2 is required.

 Wildcards ( * and ? ) may be used with _filename1_ or _filename2_, FC will then compare all the matching files.

PowerShell also has an Alias FC for the [Format-Custom](/ps/format-custom.html) cmdlet, therefore to run the 'old' FC under PowerShell you can explicitly run C:\windows\system32\fc.exe  

Errorlevels
-----------

> FC will set an [ErrorLevel](errorlevel.html) as follows:
> 
> > -1 Invalid syntax (e.g. only one file passed)  
> > 0 The files are identical.  
> > 1 The files are different.  
> > 2 Cannot find at least one of the files.  
> > For an invalid switch (with two passed files) an error message is printed but the errorlevel is not changed.
> 
> The messages returned by FC are language/locale dependent, so to reliably identify 2 identical files use [redirection](syntax-redirection.html) syntax:
> 
>    FC File1.txt File2.txt >NUL **&&** Echo Same **||** Echo Different or error

Comparison order
----------------

> When FC is used for an ASCII comparison, it will display differences between two files in the following order:
> 
> 1.  Name of the first file
> 2.  Lines from filename1 that differ between the files
> 3.  First line to match in both files
> 4.  Name of the second file
> 5.  Lines from filename2 that differ
> 6.  First line to match

Binary Comparisons
------------------

> /B displays mismatches found during a binary comparison as follows: xxxxxxxx: yy zz
> 
> The value of xxxxxxxx specifies the relative hexadecimal address for the pair of bytes, measured from the beginning of the file. Addresses start at 00000000.  
> The hexadecimal values for yy and zz represent the mismatched bytes from _filename1_ and _filename2_, respectively.
> 
> When comparing binary files that are larger than available memory, FC compares both files completely, overlaying the portions in memory with the next portions from the disk.

PowerShell
----------

> Like every other [external](syntax-internal.html) command FC can be run under PowerShell instead of CMD, however there is one extra complication for FC and that is the standard PowerShell alias FC which redirects to the [Format-Custom](../ps/format-custom.html) cmdlet.
> 
> To avoid that, use the [call](../ps/call.html) operator to run FC.exe:
> 
> & fc.exe

### Examples

Make a binary comparison of two DLL files:

C:> FC /b new.dll old.dll

Compare two files and report if they are identical:

C:> (FC /B "new.dll" "old.dll" | Find "FC: no differences encountered") > nul [&&](syntax-redirection.html) (Echo The Files match.)

Make an ASCII comparison of two text files and display the result in abbreviated format:

C:> FC /a C:\demo\input.txt H:\work\output.txt

\# Oh lord won’t you buy me a Mercedes Benz, my friends all drive Porsches, I must make amends # ~ Janice Joplin

### Related commands

[COMP](comp.html) - Compare two files and display any characters which do NOT match.  
[FIND](find.html) - Search for a text string in a file.  
[FINDSTR](findstr.html) - Search for strings in files.  
[WinDiff](windiff.html) - GUI to compare files.  
Equivalent PowerShell: [Compare-Object](../ps/compare-object.html) - Compare the properties of objects, e.g. compare content of files.  
Equivalent bash command (Linux):[cmp](../bash/cmp.html) - Compare two files.



/. nt/find.html
========================================================

    Find - Search for text - Windows CMD - SS64.com

FIND
====

Search for a text string in a file & display all the lines where it is found.

Syntax

      FIND [/V] [/C] [/N] [/I] "_string_" [_[pathname](path.html#pathname)_(s)]  
Key  
    "_string_"    The text string to find (must be in quotes).  
    [_pathname_]  A drive/file(s) to search ([wildcards](syntax-wildcards.html) accepted).

     /V        Display all lines NOT containing the specified string.  
  
     /C        Count the number of lines containing the string.  
     /N        Display Line numbers.  
     /I        Ignore the case of characters when searching for the string.

  [/off[line]] Do not skip files that have the offline attribute set.

If a [pathname] is not specified, FIND will prompt for text input or will accept text piped from another command.  
(use CTRL-Z to end manual text input)

If searching for text that contains double quote characters " , they must be escaped by doubling to ""  
This is in addition to enclosing the entire string in quotation marks: "The ""main"" event"

The FIND command will output a string of 10 dashes ---------- followed by the filename being searched, followed by any matching lines of text in the file.

Errorlevel
----------

> FIND will return an [ErrorLevel](errorlevel.html) as follows:
> 
> 0 String found in at least one of the files.  
> 1 String not found  
> 2 If any files in the list do not exist or if no files match a wildcard mask. An invalid switch is given.

Limitations
-----------

> Find does not support wildcards, use [FINDSTR](findstr.html) instead.
> 
> Although FIND can be used to scan large files, it will not detect any string that is positioned more than 1070 characters along a single line (with no carriage return) This makes it of limited use in searching binary or [XML](https://www.theregister.com/2003/04/25/writing_history_with_microsofts_office/) file types.
> 
> An empty string "" will normally match _nothing_, with the/v flag reversing the test, to match _everything_, but this will fail for any lines longer than 4091 characters long.

### Examples

If names.txt contains the following:

  Joe Bloggs, 48 Main St, Dunoon 
  Shameika James, 127 Scotland Street, Edinburgh

To search for "Shameika" in names.txt

C:> FIND "Shameika" names.txt  
  
---------- NAMES.TXT
Shameika James, 127 Scotland Street, Edinburgh

If you want to pipe the output from a command into FIND use this syntax

C:> TYPE names.txt | FIND "Shameika" 

You can also redirect like this

C:> FIND /i "Shameika" < names.txt >logfile.txt

To search a folder for files that contain a given search string:

C:> FOR %G IN (*.txt) do (find /n /i "SearchWord" "%G")

Count the number of lines in a file (like [wc -l](../bash/wc.html) on unix).  
The empty string "" is treated as never matching. The /v flag reverses the test, so now it matches everything and then /c returns the count:

C:> TYPE myfile.txt | FIND "" /v /c

“For my art, there is a common theme most of the time: it is using the things we can see to search for the world we cannot see” ~ Cai Guo-Qiang

### Related commands

[FINDSTR](findstr.html) - Search for strings in files, supports regular expressions.  
[ATTRIB](attrib.html) - Find filename, rather than searching the file contents.  
[WHERE](where.html) - Locate and display files in a directory tree.  
[Escape chars, delimiters and quotes](syntax-esc.html)  
[Redirection](syntax-redirection.html) - Spooling output to a file, piping input.  
[Advanced Query Syntax](explorer.html) (AQS) in Windows File Explorer.  
[](syntax-esc.html)[Agent Ransack](https://www.mythicsoft.com/agentransack/) - Free File Searching Utility.  
Equivalent PowerShell: [Where-Object](../ps/where-object.html) - Filter objects passed along the pipeline.  
Equivalent bash command (Linux): awk/[gawk](../bash/awk.html) - Find and Replace text within file(s).



/. nt/findstr.html
========================================================

    Findstr - Search for strings - Windows CMD - SS64.com

FINDSTR
=======

Search for a text string in a file (or multiple files) unlike the simple [FIND](find.html) command FINDSTR supports more complex regular expressions.

Syntax

      FINDSTR _string_(s) [_[pathname](path.html#pathname)_(s)]
         [/R] [/C:"_string_"] [/G:_StringsFile_] [/F:_file_] [/D:_DirList_]
            [/A:_color_] [/OFF[LINE]] [_options_]

Key
    _string(s)_    Text to search for, each word a separate search.
    _pathname_(s)  The file(s) to search. 
    /C:_string_    Use _string_ as a literal search string (may include spaces).
    /R           Evaluate as a regular expression.
    /R /C:_string_  Use _string_ as a regular expression.
    /G:_StringsFile_  Get search string from a file (/ stands for console).
    /F:_file_      Get a list of filename(s) to search from a file (/ stands for console).
    /d:_dirlist_   Search a comma-delimited list of directories.
    /A:_color_     Display filenames in [colour](color.html) (2 hex digits)

_options_ can be any combination of the following switches:  
    /I   Case-insensitive search.
    /S   Search subfolders.
    /P   Skip any file that contains non-printable characters
    /OFF[LINE] Do not skip files with the OffLine [attribute](attrib.html) set.
    /L   Use search string(s) literally.
    /B   Match pattern if at the Beginning of a line.
    /E   Match pattern if at the END of a line.
    /X   Print lines that match exactly.
    /V   Print only lines that do NOT contain a match.
    /N   Print the line number before each line that matches.
    /M   Print only the filename if a file contains a match.
    /O   Print character offset before each matching line.

When using /G or /F the text file should be a plain ANSI text file with one Search string or Filename/Path on each line.  
If more than one file is searched (/F), the results will be prefixed with the filename where the text was found.

The default behaviour of FINDSTR is to match any word, so FINDSTR "blue planet" will match the word blue or the word planet.  
To match an entire phrase/sentence or to use Regular Expressions use the /C and /R options.

Option syntax
-------------

> Options can be prefixed with either / or -  
> Options can also be concatenated after a single / or -. However, the concatenated option list can contain at most one multicharacter option such as OFF or F:, and the multi-character option must be the last option in the list.
> 
> The following are all equivalent ways of expressing a case insensitive regex search for any line that contains both "hello" and "goodbye" in any order  
> 
> > FINDSTR /i /r /c:"hello.*goodbye" /c:"goodbye.*hello" Demo.txt  
> > FINDSTR -i -r -c:"hello.*goodbye" /c:"goodbye.*hello" Demo.txt  
> > FINDSTR /irc:"hello.*goodbye" /c:"goodbye.*hello" Demo.txt
> 
> To search for more than 2 items in any order starts to become impractical as you would you need every permutation. An alternative approach is to chain multiple findstr commands:
> 
> FINDSTR /ic:"hello" Demo.txt | findstr /ic:"goodbye"

Regular Expressions (Search for patterns of text)
-------------------------------------------------

> FINDSTR with the /R option can use the following metacharacters which have special meaning either as an operator or delimiter. FINDSTR support for regular expressions is limited and non-standard, only the following metacharacters are supported:
> 
>  .         Wildcard: any character.
> 
>  *         Repeat: zero or more occurances of previous character or class.
> 
>  ^         Line position: beginning of line.
>  $         Line position: end of line.
> 
>  [_class_]   Character class: any one character in the set. [aB4] will match a or B or 4
>  [^_class_]  Inverse class: any one character NOT in the set.
> 
>  [_x_-_y_]     Range: any characters within the specified range
> 
>  _x_        Escape: literal use of metacharacter _x_.
> 
>  \<_xyz_     Word position: beginning of word.
>  _xyz_>     Word position: end of word.
> 
> Metacharacters are most powerful when they are used together. For example, the combination of the wildcard character (.) and repeat (*) character is similar in effect to the filename wildcard (*.*)
> 
> .*         Match any string of characters.
> 
> The .* expression can be useful within a larger expression, for example a.*b will match any string beginning with A and ending with B.
> 
> FINDSTR does not support alternation with the pipe character (|) multiple Regular Expressions can be separated with spaces, just the same as separating multiple words (assuming you have not specified a literal search with /C) but this might not be useful if the regex itself contains spaces.
> 
> FINDSTR does not support [UTF-16](../ascii.html) files, but [FIND](find.html) does.

Regex Line Position anchors ^ and $
-----------------------------------

> ^ matches beginning of input stream as well as any position immediately following a <LF>. Since FINDSTR also breaks lines after <LF>, a simple regex of "^" will always match all lines within a file, even a binary file.  
> So to find the string snark at the beginning of a line, use ^snark
> 
> $ matches any position immediately preceding a <CR>. This means that a regex search string containing $ will never match any lines within a Unix style text file, nor will it match the last line of a Windows text file if it is missing the EOL marker of <CR><LF>.  
> So to find the string snark at the end of a line, use snark$
> 
> Note - As detailed further below, piped and redirected input to FINDSTR can have <CR><LF> appended that is not in the source. This can impact a regex search that uses $.
> 
> A search string with characters (before ^) OR (after $) will always fail to find a match. $nevermatches^

Positional Options /B /E /X
---------------------------

> The positional options work the same as ^ and $, except they also work for literal search strings.
> 
> /B functions the same as ^ at the start of a regex search string.
> 
> /E functions the same as $ at the end of a regex search string.
> 
> /X functions the same as having both ^ at the beginning and $ at the end of a regex search string.
> 
> [FINDSTR - Escapes and Length limits](findstr-escapes.html) - More detail of how to use search strings that include quotes and/or backslashes. Also maximum Search String length limits vary with OS version.
> 
> [FINDSTR - Searching across line breaks](findstr-linebreaks.html)

Regex character class ranges [x-y]
------------------------------------

> Character class ranges do not work as expected. See this Q/A on Stack Exchange: [Why does findstr not handle case properly (in some circumstances)?](https://stackoverflow.com/questions/2635740/why-does-findstr-not-handle-case-properly-in-some-circumstances)
> 
> The problem is FINDSTR does not collate the characters by their byte code value (commonly thought of as the ASCII code, but ASCII is only defined from 0x00 - 0x7F). Most regex implementations would treat [A-Z] as all upper case English capital letters. But FINDSTR uses a collation sequence that roughly corresponds to how SORT works. So [A-Z] includes the complete English alphabet, both upper and lower case (except for "a"), as well as non-English alpha characters with diacriticals.
> 
> The FINDSTR regex sorts lower case before upper case. So findstr /nrc:"^[A-a]" will find nothing, but findstr /nrc:"^[a-A]" will match.

Default type of search: Literal vs Regular Expression
-----------------------------------------------------

> /C:"string" - The default match like /L literal, but will also accept spaces.
> 
> /R /C:"Search string" - This will perform a Regex match, but will also accept spaces in the search string.
> 
> "string argument" - The default depends on the content of the very first search string. (Remember that <space> is used to delimit search strings.) If the first search string is a valid regular expression that contains at least one un-escaped meta-character, then all search strings are treated as regular expressions. Otherwise all search strings are treated as literals. For example, "51.4 200" will be treated as two regular expressions because the first string contains an un-escaped dot, whereas "200 51.4" will be treated as two literals because the first string does not contain any meta-characters.
> 
> /G:file - The default depends on the content of the first non-empty line in the file. If the first search string is a valid regular expression that contains at least one un-escaped meta-character, then all search strings are treated as regular expressions. Otherwise all search strings are treated as literals.
> 
> Recommendation - Always explicitly specify /L literal option or /R regular expression option when using "string argument" or /G:file.

Searching for Spaces
--------------------

> When the search _string_ contains multiple words, separated with spaces, then FINDSTR will return lines that contain either word (OR).  
> A literal search (/C:"_string"_) will reverse this behaviour and allow searching for a phrase or sentence. A literal search also allow searching for punctuation characters.
> 
> Some examples using a text file Demo.txt containing the following:
> 
> The quick brown fox  
> The really ^brown^ fox
> 
> Literal searches /L :
> 
> Match the first line with: FINDSTR /L /C:"quick brown" Demo.txt  
> Match the second line with: FINDSTR /L /C:"^brown" Demo.txt
> 
> Regex Searches /R :
> 
> Match the word fox at the end of any line with: FINDSTR /R /C:"fox$" Demo.txt  
> Match the word The or the (case insensitive) at the start of any line with: FINDSTR /I /R /C:"^the" Demo.txt  

FINDSTR Output
--------------

> The format of matching line output from FINDSTR is:
> 
> > _filename_:_lineNumber_:_lineOffset_:_text_
> 
> where
> 
> > _fileName_ = The name of the file containing the matching line. The file name is not printed if the request was explicitly for a single file, or if searching piped input or redirected input. When printed, the fileName will always include any path information provided. Additional path information will be added if the /S option is used. The printed path is always relative to the provided path, or relative to the current directory if none provided.
> > 
> > _lineNumber_ = The line number of the matching line represented as a decimal value with 1 representing the 1st line of the input. Only printed if /N option is specified.
> > 
> > _lineOffset_ = The decimal byte offset of the start of the matching line, with 0 representing the 1st character of the 1st line. Only printed if /O option is specified.
> > 
> > _text_ = The binary representation of the matching line, including any <CR> and/or <LF>.
> 
> Nothing is left out of the binary output, such that this example that matches all lines will produce an exact binary copy of the original file:
> 
> FINDSTR "^" FILE >FILE_COPY 

Using a script file
-------------------

> Multiple search criteria can be specified with a script file /G  
> Multiple FileNames to search can be specified with /F  
>   
> When preparing a source or script file, place each filename or search criteria on a new line.  
> If several filenames are to be searched they must all exist or FINDSTR will fail with an error.  
>   
> For example: to use the search criteria in Criteria.txt to search the files listed in Files.txt:  
>   
> FINDSTR /g:Criteria.txt /f:Files.txt

Piping and Redirection
----------------------

> A text file can be piped or redirected into FINDSTR:
> 
> *   Data stream from a pipe TYPE file.txt | FINDSTR "searchString"
> *   Stdin via redirection FINDSTR "searchString" <file.txt
> 
> The various data source specifications are mutually exclusive - FINDSTR can only work with one of the following: filename argument(s), /F:file option, redirected input, or piped input.
> 
> A string can also be piped into FINDSTR, this will just tell us if searchString exists within dataString:
> 
> Echo "dataString"| FINDSTR "searchString"
> 
> Piped and Redirected input can have <CR><LF> appended:
> 
> *   If the input is piped in and the last character of the stream is not <LF>, then FINDSTR will automatically append <CR><LF> to the input. (XP, Vista and Windows 7.)
> *   If the input is redirected and the last character of the file is not <LF>, then FINDSTR will automatically append <CR><LF> to the input. (Vista only), Note that in this case XP and Windows 7/2008 will **not** alter redirected input which can cause FINDSTR to hang indefinitely.

Finding Unicode text under PowerShell
-------------------------------------

> When running FINDSTR under the CMD shell, it can be used to match Unicode strings, but running a similar command under PowerShell will fail.
> 
> This is because output data piped from a PowerShell cmdlet into a native application will default to ASCII. This is normally a sensible default because most native commands do not process Unicode correctly.
> 
> The output encoding from PowerShell cmdlets is controlled by the [$OutputEncoding](../ps/syntax-preference.html) variable, [if that is set](https://devblogs.microsoft.com/powershell/outputencoding-to-the-rescue/) then FINDSTR will work against unicode text.
> 
> $OutputEncoding = UnicodeEncoding  
> or to match the console's encoding:  
> $OutputEncoding = [Console]::OutputEncoding

Errorlevel
----------

> FINDSTR will set [%ERRORLEVEL%](errorlevel.html) as follows:
> 
> > 0 A match is found in at least one line of at least one file.  
> > 1 If a match is not found in any line of any file, (or if the file is not found at all).  
> > 2 Wrong syntax  
> > An invalid switch will only print an error message in error stream.
> 
> Echo 12G6 |FindStr /R "[0-9]"  
> If %ERRORLEVEL% EQU 0 echo The string contains one or more numeric characters
> 
> Echo 12G6 |FindStr /R "[^0-9]"  
> If %ERRORLEVEL% EQU 0 echo The string contains one or more non numeric characters

Bugs
----

> If the last character of a file used as redirected input does not end with <LF>, then FINDSTR will hang indefinitely once it reaches the end of the redirected file.
> 
> FINDSTR cannot search for null bytes commonly found in Unicode files.
> 
> Specifying multiple literal search strings can give unreliable results. The following FINDSTR example fails to find a match, even though it should:
> 
> echo ffffaaa|findstr /L "ffffaaa faffaffddd" 
> 
> Based on experiments, FINDSTR can fail if all of the following conditions are met:
> 
> *   The search is using multiple literal search strings
> *   The search strings are of different lengths
> *   A short search string has some amount of overlap with a longer search string
> *   The search is case sensitive (no /I option)
> 
> It seems to always be the shorter search strings that fails, for more info see: [FINDSTR fails to match multiple literal search strings](https://stackoverflow.com/questions/8921253/why-doesnt-this-findstr-example-with-multiple-literal-search-strings-find-a-mat/8921279#8921279)
> 
> In early versions of FindStr /F:file a path length of more than 80 chars will be truncated.

### Examples

Search for "granny" OR "Smith" in the files Apples.txt or Pears.txt

FINDSTR "granny Smith" Apples.txt Pears.txt  
  
Search for "granny Smith" in Contacts.txt (effectively the same as the [FIND](find.html) command)

FINDSTR /C:"granny Smith" Contacts.txt  
  
Search every file in the current folder and all subfolders for the word "Smith", regardless of upper/lower case, note that /S will only search below the _current_ directory:  
  
FINDSTR /s /i smith *.*

Match exactly the number 12345:

Echo 12345| findstr /X "12345"

Join two files, return only the lines that they both have in common:

FINDSTR /g:"file1.txt" "file2.txt"  
  
Search all the text files in the current folder for the string "fiona", display the filenames in White on Green (:2F).

FINDSTR /A:2F /C:"fiona" *.txt

Read the file Z:\source.txt, remove all the blank lines and write to Z:\result.txt

FINDSTR /v "^$" Z:\source.txt >Z:\result.txt  
  
Find every line in novel.txt containing the word SMITH, preceeded by any number of spaces, and prefix each line found with a consecutive number:  
  
FINDSTR /b /n /c:" *smith" novel.txt  
  
Finding a string only if surrounded by the standard [delimiters](syntax-esc.html)  
Find the word "computer", but not the words "supercomputer" or "computerise":  
  
FINDSTR "\<computer>" C:\work\inventory.txt  
  
Find any words that begin with the letters 'comp', such as 'computerise' or 'compete'  
  
FINDSTR "\<comp.*" C:\work\inventory.txt

Find any positive integers in the file sales.txt and include any lines that are a zero (0):  
  
FINDSTR /r "^[1-9][0-9]*$ ^0$" Sales.txt

Credits:  
Dave Benham - List of [undocumented features and limitations of FINDSTR](https://stackoverflow.com/questions/8844868/what-are-the-undocumented-features-and-limitations-of-the-windows-findstr-comman) from [StackOverflow](https://stackoverflow.com)

“Twenty years from now, you will be more disappointed by the things you didn’t do than by the ones you did do. So throw off the bowlines, sail away from the safe harbour. Catch the trade winds in your sails. Explore. Dream. Discover” ~ Mark Twain

### Related commands

[FINDSTR - Escapes and Length limits](findstr-escapes.html)  
[FINDSTR - Searching across line breaks](findstr-linebreaks.html)  
[FIND](find.html) - Search for a text string in a file.  
[Advanced Query Syntax](explorer.html) (AQS) in Windows File Explorer.  
VBScript: [Find and Replace](../vb/syntax-replace.html)  
Equivalent PowerShell: [Regular Expressions](https://ss64.com/ps/syntax-regex.html) / [Select-String -raw](../ps/select-string.html) / [Where-Object](../ps/where-object.html).  
Equivalent bash command (Linux): [grep](../bash/grep.html) - Search file(s) for lines that match a given pattern.



/. nt/fltmc.html
========================================================

    FLTMC - Windows CMD - SS64.com

FLTMC.exe
=========

Manage MiniFilter drivers. **Load** a Filter driver, **Unload** a Filter driver, List **filter** information, List all **instances** or the instances associated with a Filter or Volume**,** List all **volumes** (including the network redirectors), **Attach** or **Detach** a filter from a Volume.

Syntax

      FLTMC load [ _driverName_ ]
      FLTMC unload [ _driverName_ ]
      FLTMC filters
      FLTMC instances [-f _filterName_ ]|[-v _volumeName_ ]
      FLTMC volumes
      FLTMC attach [ _filterName_ ] [ _volumeName_ ] [[-i _instanceName_ ][-a _altitude_]]
      FLTMC detach [ _filterName_ ] [ _volumeName_ ] [ _instanceName_ ]

Key

    _driverName_  The full path to the sys file for the Filter driver.

    _filterName_  The name for the Filter used by the driver to register and
               to load the Filter using this command line.

    _volumeName_  The name of the volume, such as c: or d:

    _instanceName_ The name for the instance to be attached or detached.

    -f          List the instances associated with the filter identified by _filterName_.

    -v          List the instances associated with the volume identified by _volumeName_.

FLTMC requires an [Elevated](syntax-elevate.html) command prompt (either CMD or PowerShell)

File System Minifilter Drivers
------------------------------

> A file system filter driver (Minifilter) is an optional driver that adds value to or modifies the behavior of a file system.
> 
> These filter drivers process all filesystem activity including background processes. Typical uses are: encryption software transparently encrypting new files. Enforcing file quotas and most commonly anti-virus software scanning file activity.
> 
> A malicious rootkit infection, may obfuscate its presence by installing a minifilter driver which intercepts and filters calls between other (legitimate) drivers and the system. It is therefore good practice to document the known minidrivers installed on your key systems.
> 
> The FLTMC command allows the option to display existing filters and delete malicious ones.

Attaching a filter to a Volume
------------------------------

> The instanceName is optional if an altitude is provided If no altitude is provided, the necessary keys must already exist in the registry to describe the altitude for the given name.
> 
> The altitude is optional if an instanceName is provided. If specified, this new instance is placed at this explicit altitude. If a name is specified as well, the new instance will be given the name specified.
> 
> If the attachment is successful, an Instance Name will be displayed to identify the instance created by this attachment.

Detaching a filter from a Volume
--------------------------------

> The filterName is the name for the Filter that is used by the driver to register and to load the Filter using this command line.
> 
> The instanceName is the identifier returned by the attach command.  
> If no instanceName is given, the default instance for the Volume specified will be removed.

Altitude
--------

> Minifilters are assigned a specific altitude by Microsoft. This will sit within a range that is specific to the function of the minifilter.  
> e.g. Anti-Virus minifilters are assigned an altitude between 320,000 and 329,999.  
> and encryption minifilters are assigned an altitude between 140,000 and 149,999.
> 
> For file **Writes**, Altitudes are processed in descending order.  
> For file **Reads**, Altitudes are processed in ascending order.
> 
> So when writing anti-virus is handled before encryption, but when reading decryption is handled before anti-virus.
> 
> Legacy filter drivers do not use the minifilter model, this means they don’t slot into place based on their altitude. For interoperability with legacy filter drivers, the filter manager can [attach filter device objects](https://docs.microsoft.com/en-gb/windows-hardware/drivers/ifs/filter-manager-concepts) to a file system I/O stack in more than one location [[example](https://blogs.msdn.microsoft.com/ntdebugging/2013/03/25/understanding-file-system-minifilter-and-legacy-filter-load-order/)]. However you should still consider replacing legacy filters with minifilters.

Offloading Reads and/or Writes on NTFS drives
---------------------------------------------

> Starting with Windows 8, a filter may specify [offload](https://docs.microsoft.com/en-gb/windows-hardware/drivers/ifs/offloaded-data-transfers) capability .  
> FLTMC instances will display the Supported Features (SprtFtrs)  
> 1 = FSCTL_OFFLOAD_READ  
> 2 = FSCTL_OFFLOAD_WRITE  
> So 3 = Offload Read + Write are supported.

Common minifilters (\System32\Drivers)
----------------------------------------

> WdFilter.sys – Windows Defender  
> storqosflt.sys - Storage QoS Filter Driver  
> luafv.sys – UAC File Virtualization  
> npsvctrig.sys – Named Pipe Service Trigger Provider  
> FileCrypt.sys - Windows sandboxing and encryption  
> FileInfo.sys – FileInfo Filter Driver (SuperFetch / ReadyBoost)  
> wcifs.sys - File System Filter  
> Wof.sys – Windows Image File Boot

### Examples

Display the installed filters:

C:> FLTMC

Display the instance names, altitude and supported features:

C:> FLTMC instances

_“A complex system that works is invariably found to have evolved from a simple system that worked. The inverse proposition also appears to be true: A complex system designed from scratch never works and cannot be made to work." ~ John Gall_

### Related commands

[Load Order Groups and Altitudes for Minifilter Drivers](https://docs.microsoft.com/en-gb/windows-hardware/drivers/ifs/load-order-groups-and-altitudes-for-minifilter-drivers) - Docs.Microsoft.com  
[FSUTIL](fsutil.html) - File and Volume utilities.



/. nt/fondue.html
========================================================

    Fondue - Windows CMD - SS64.com

FONDUE.exe
==========

Features on Demand User Experience Tool, enable Windows optional features by downloading required files from Windows Update or another source specified by Group Policy. The manifest file for the feature must already be installed in your Windows image.

Example

Syntax

      FONDUE /enable-feature:_feature_name_ [/caller-name:_program_name_]
         [/hide-ux:{all | rebootrequest}]
         
Key
    /enable-feature:_feature_name_  The name of the Windows optional feature to enable.
                                 You can only enable one feature per command line.
                                 To enable multiple features, call fondue.exe for each feature.

    /caller-name:_program_name_     The program or process name when you call fondue.exe from a script or batch file.
                                 Use this option to add the program name to the SQM report if there is an error.

    /hide-ux:{all|rebootrequest}  Use **all** to hide all messages to the user including progress and permission
                                 requests to access Windows Update.
                                 If permission is required, the operation will fail.
                                 Use **rebootrequest** to only hide user messages asking for permission to reboot the
                                 computer. Use this option if you have a script that controls reboot requests.

### Examples

Enable Microsoft .NET Framework 4.8:  
C:> fondue.exe /enable-feature:NETFX4  
  
Enable Microsoft .NET Framework 4.8, add the program name to the SQM report, and don't display any messages to the user:  
C:> fondue /enable-feature:NETFX4 /caller-name:Admin.bat /hide-ux:all

“Fondue, which comes from the French 'fondre', meaning 'to melt', had its origins in 18th century Switzerland as a means for farm families to stretch their limited resources during the winter months. From these simple beginnings, fondue became a Swiss winter tradition.”

### Related commands

PowerShell: [Enable-WindowsOptionalFeature](../ps/enable-windowsoptionalfeature.html)



/. nt/for_f.html
========================================================

    For /f - Loop through text - Windows CMD - SS64.com

[FOR](for.html) /F
==================

Loop command: against a set of files - conditionally perform a command against each item.

Syntax

        FOR **/F** ["_options_"] %%_parameter_ IN (_filenameset_) DO _command_ 
      
        FOR **/F** ["_options_"] %%_parameter_ IN ("Text string to process") DO _command_

Key
    options:
      delims=_xxx_   The [delimiter](syntax-esc.html#delimiters) character(s). Default for strings = a space or TAB.

      skip=_n_       A number of lines to skip at the beginning of the file. 
                    (default = 0)
 
      eol=;        Character at the start of each line to indicate a comment 
                   The default is a semicolon ; 

      tokens=_n_     Specifies which numbered items to read from each line 
                  (default = 1)

      usebackq     Use the alternate quoting style:
                   - Instead of double quotes use single quotes for 'Text string to process'
                   - Use double quotes for long file names in "_filenameset_".
                   - Use back quotes for \`[command to process](for_cmd.html)\`

    _Filenameset_    A set of one or more text files, the contents of which will be parsed.
                  Enclose the list of files in parentheses (file1.txt,file2.txt).

    _command_        The command to carry out, including any parameters.
                  This can be a single command, or if you enclose it
                  in ([parentheses](syntax-brackets.html)), several commands, one per line.

    %%_parameter_    A replaceable parameter:               
                  in a batch file use %%G (on the command line %G)

FOR /F processing of a text file consists of reading the file, one line of text at a time and then breaking the line up into individual items of data called 'tokens'. The DO command is then executed with the parameter(s) set to the token(s) found.

If you want to process the File Names rather than the content of the files, use the [FOR /F command_to_process](for_cmd.html) variant, with DIR /b as the command.

FOR parameters (%%A – %%Z)
--------------------------

> Read the main [FOR introduction](for.html) page for a full description of assigning the replaceable %%parameter.  
> FOR parameters are used in all variations of the FOR command, it is a good idea to get up to speed with writing a basic FOR command before trying the more complex FOR / F variant.

By default, /F breaks up each line within the file at each blank space " ", and any blank lines are skipped, this default parsing behavior can be changed by applying one or more of the "_options_" parameters. The option(s) must be contained "within quotes"

Within a FOR loop the visibility of variables is affected by SETLOCAL [EnableDelayedExpansion](delayedexpansion.html), by default variable changes within the loop will not be visible until the loop completes.

usebackq
--------

> This option is useful when dealing with a _filenameset_ that is a long filename containing spaces, it allows you to put double quotes around the filename.  
> Because double quotes are used to indicate a filename, it then uses single quotes instead of double quotes to indicate a _text string_ and backquotes for a _command to process_. The backquote character \` is just below the ESC key on most keyboards.  
> Filenames which don’t contan spaces can still be referenced without using quotes.
> 
> Usebackq can be abbreviated to useback (undocumented.)

Skip
----

> SKIP will skip processing a number of lines from the beginning of the file.  
> SKIP includes empty lines, but after the SKIP is complete, FOR /F ignores (does not iterate) empty lines.

eol
---

> The default end-of-line character is a semicolon ';' when the FOR command reads a text file (or even a character string), any line that STARTS with the eol character will be ignored. In other words it is treated as a comment.  
> Use eol=X to change the eol character to X.
> 
> Often you will want to turn this feature off so that every line of your data file is processed, in theory "eol=" should turn this feature off, but in practice this fails to work correctly - it will set eol to whatever the next character is, often the quote or space character. One workaround is to set eol to some unusual character that you don’t expect to ever encounter in the data file e.g. "eol=€" or "eol=¬". Another method is to escape every [delimiter](syntax-esc.html#delimiters) For /f tokens^=*^ delims^=^ eol^= %%a in (file.txt) do... (see forum for a [discussion](https://ss64.org/viewtopic.php?f=2&t=13) of this)
> 
> None of the options can be repeated, if you include say "eol=# eol=@" then only the second, "eol=@" is applied.

Delims
------

> More than one delimiter can be specified so a string like 'abcd;efg+hijk;lmno;pqr' can be broken up using "delims=;+".
> 
> for /f "tokens=1,2,3,4,5 delims=;+" %%G in (filename.txt) do echo %%G %%H %%K
> 
> For simple FOR commands which only process one item at a time, use "delims="  
> This will place everything on the line into the first token. even if it contains spaces, e.g. a long filename.
> 
> for /f "usebackq delims=" %%G in ("file 1.txt","file 2.txt","file 3.txt") do echo %%G
> 
> You can use almost any character as a delimiter, but they are case sensitive.  
> 
> delims should always the last item in the _options_ string "tokens=3 delims= " not "delims=  tokens=3"  
> This is because the quotations around the _options_ string do double duty as a terminator for the delims character(s), which is particularly important when that character is a space.
> 
> If you don’t specify delims it will default to "delims=<TAB><Space>"  
> This is different from the [default delimiters for the CMD shell command line](syntax-esc.html) (Space,Tab,Comma,Equals,Semicolon). All of those can be specified as delimiters with the FOR command, but when using = as a delimiter it cannot be the last one in the list. So this is valid: "delims=;= " and this is not valid: "delims=; ="
> 
> Consecutive delimiters will be treated as one, even if they are different characters.  
> This means that if any data values are missing between delimiters the subsequent items in that line will be assigned a different token, e.g.
> 
> Bread,Organic,$1.49  
> Cheese,,$2.99  
> In the first line the price will be assigned to the third token, but for the second line, the price will be assigned to the second token.  
> A common workaround for this issue is to pre-process the input data adding a placeholder character between any consecutive delimiters. e.g. replace ',,' with ',~,'
> 
> One special case is using a double quote (") as delimiter.  
> By default this will be misinterpreted as the end of the "delims string", a workaround for this is to remove the outer enclosing quotes and instead [escape](syntax-esc.html) all the delimiter chars with ^.  
>   
> for /f tokens^=1^,2^,3^ delims^=^" %%G in (filename.txt) do echo %%G %%H %%I  
>   
> n.b. some text editors will enter the TAB character as a series of spaces.

Tokens
------

> tokens=2,4,6  Will cause the second, fourth and sixth items on each line to be processed (3 Tokens).  
>   
> tokens=2-6  Will cause the second, third, fourth, fifth and sixth items on each line to be processed (5 Tokens).  
>   
> tokens=*   Will cause all items on each line to be processed as a single string Token.  
>   
> tokens=3,*  Will process the third item as one string token and then all subsequent text as a second string Token.  
> This can also be written as tokens=3*  
> 
> If the last character in the tokens= string is an asterisk '*', then one additional parameter is added for all the remaining text on the line.
> 
> If an asterix is used in the tokens= string then it must be the **last** character in the string.
> 
> The parameter added by the asterix is based on the whole tokens= string and not on the number preceding the asterix, so if you select tokens 1,2,* the asterisk will represent the third and all subsequent items, and if you select tokens=19,2,1,* then the asterisk will represent the 20th and all subsequent items.
> 
> Each token specified will cause a corresponding parameter letter to be allocated. The letters used for tokens are case sensitive.  
> 
> The following [ASCII characters](../ascii.html) can be used as FOR tokens:  
> ASCII 63 - 93 inclusive, 31 tokens: ? @ A B C D E F G H I J K L M N O P Q R S T U V W X Y Z [ \ ]  
> ASCII 95-123 inclusive, 29 tokens: _ \` a b c d e f g h i j k l m n o p q r s t u v w x y z {  
> (there are [a few](https://stackoverflow.com/a/8520993/1720814) other characters that can be used, but require [escaping](syntax-esc.html#escape))
> 
> A single FOR /F command can never parse more than 31 tokens, to use more requires a [workaround](https://stackoverflow.com/a/8520993/1720814) with multiple FOR commands.
> 
> The tokens selected do not have to be listed in numeric order, though it is usually more readable to do so. The numbers selected in tokens= are automatically sorted, so for example tokens=5,7,1-3 and tokens=1,2,3,5,7 both produce the same result.
> 
> Matching the same token more than once (tokens=1,2,1) can give [unpredictable](https://stackoverflow.com/questions/25950181/why-for-f-sets-empty-values-for-repeated-numbers-in-the-rest-of-tokens) results. Token variables can of course be used multiple times: Echo %%G %%H %%G  
>   
> FOR tokens variables (or parameter names) are global, so in complex scripts which [call](call.html) one FOR statement from within another FOR statement you can refer to both sets of parameters.

The precedence/priority of FOR command options is: usebackq > skip > delims > eol > tokens  

### Examples

Select items from a string and display them:

  @Echo Off
  FOR /f "tokens=1,2,3,*" %%A in ("alpha beta gamma delta epsilon") DO echo A:[%%A]  B:[%%B]  C:[%%C]  D:[%%D]

Copy the filenames listed in a text file (one per line) to a new destination:

FOR /f "delims=" %%G in (files.txt) DO copy "\source\folder\%%G" "H:\destination\%%G"

Extract data from a text file which contains characters and commas (but no spaces or other punctuation):

January,Snowy,02  
February,Rainy,15  
March,Sunny,25  
  
FOR /F "tokens=1,3 delims=," %%G IN (weather.txt) DO @echo %%G %%H  
  
The tricky part is splitting up each the line into the right tokens, in this case I'm splitting on the comma character ',' this splits the line into 3 chunks of text and we pull out the first and third items with "tokens=1,3"

token=1 (%%G)

token=2

token=3 (%%H)

 

(ignored)

 

January

 

02

February

 

15

March

 

25

%%G is declared in the FOR statement and %%H is implicitly declared via the tokens= option.

An alternative way to retrieve the same data would be:  
FOR /F "tokens=1,2,3 delims=," %%G IN (weather.txt) DO @echo %%G %%I

Splitting a string that includes spaces.
----------------------------------------

> This can be done just as above, replacing "delims=," with "delims= "
> 
> It is possible to specify either the tokens= and/or delims= options in any order, but whenever both delims and tokens are specified, they must be separated by a space, this space will NOT count as a token. For this reason it is recommended to always place delims as the last option before the closing quotation, it is much easier to see what is happening with one space (or no spaces) at the end of the string.

Parse a text string
-------------------

> A string of text will be treated just like a single line of input from a file, the string must be enclosed in double quotes (or single quotes with usebackq).  
>   
> Echo just the date from the following string
> 
> FOR /F "tokens=4 delims=," %%G IN ("deposit,$4500,123.4,31-AUG-2021") DO @echo Date paid %%G

Parse the output of a command:
------------------------------

> FOR /F %%G IN ('"C:\program Files\command.exe"') DO ECHO %%G

Parse the contents of a file:
-----------------------------

> FOR /F "tokens=1,2* delims=," %%G IN (C:\MyDocu~1\mytex~1.txt) DO ECHO %%G
> 
> FOR /F "usebackq tokens=1,2* delims=," %%G IN ("C:\My Documents\my textfile.txt") DO ECHO %%G

Filenameset
-----------

> To specify an exact set of files to be processed, such as all .MP3 files in a folder including subfolders and sorted by date - just use the [DIR /b](dir.html) command to create the list of filenames ~ and use [this variant of the FOR command](for_cmd.html) syntax.

Unicode
-------

> Many of the newer commands and utilities (e.g. [WMIC](wmic.html)) output text files in unicode format, these cannot be read by the FOR command which expects [ASCII](../ascii.html).  
> To convert the file format use the [TYPE](type.html) command.

Errorlevel
----------

> FOR does not, by itself, set or clear an [Errorlevel](errorlevel.html), leaving that to the _command_ being called.  

FOR is an [internal](syntax-internal.html) command.

“It’s completely intuitive; it just takes a few days to learn, but then it's completely intuitive” ~ Terry Pratchett.

### Related commands

[FOR](for.html) - Loop commands.  
[FOR](for2.html) - Loop through a set of files in one folder.  
[FOR /R](for_r.html) - Loop through files (recurse subfolders) [.  
FOR /D](for_d.html) - Loop through several folders.  
[FOR /L](for_l.html) - Loop through a range of numbers.  
[FOR /F](for_cmd.html) - Loop through the output of a command.  
[FORFILES](forfiles.html) - Batch process multiple files.  
[IF](if.html) - Conditionally perform a command.  
[SETLOCAL](setlocal.html) - Control the visibility of environment variables inside a loop.  
Equivalent PowerShell: [ForEach-Object](../ps/foreach-object.html) - Loop for each object in the pipeline.  
 for example: Get-Content files.txt |Foreach{copy-item -path $_.FullName -destination "H:\destination\"}  
Equivalent bash command (Linux): [read](../bash/read.html) (in a loop) - Read a line from standard input.



/. nt/for_cmd.html
========================================================

    For - Loop through command output - Windows CMD - SS64.com

[FOR](for.html) /F
==================

Loop command: against the results of another command.

Syntax

      FOR **/F** ["_options_"] %%_parameter_ IN ('_command_to_process_') DO _command_

Key
    options:
      delims=_xxx_   The [delimiter](syntax-esc.html#delimiters) character(s) default: a Space, TAB, comma, Equals or Semicolon.

      skip=_n_       A number of lines to skip at the beginning. Default = 0.

      eol=;        Character at the start of each line to indicate a comment
                   The default is a semicolon ;

      tokens=_n_     The numbered items to  read from each line. Default = 1.

      usebackq     Use the alternate quoting style:                        
                   - Instead of double quotes use single quotes for 'Text string to process'
                   - Use double quotes for long file names in "_filenameset_".
                   - Use back quotes for \`command_to_process\`

  _command_to_process_ : The output of the '_command_to_process_' is passed into the FOR _parameter_.

    _command_    :   The command to carry out, including any parameters. This can be a single
                  command, or if you enclose it in ([brackets](syntax-brackets.html)), several commands, one per line.

  %%_parameter_ :  A replaceable parameter:
                 in a batch file use **%%**G (on the command line **%**G)

FOR /F processing of a command consists of reading the output from the command one line at a time and then breaking the line up into individual items of data or 'tokens'. The DO command is then executed with the parameter(s) set to the token(s) found.

FOR parameters (%%A – %%Z)
--------------------------

> Read the main [FOR introduction](for.html) page for a full description of assigning the replaceable %%parameter.  
> FOR parameters are used in all variations of the FOR command, it is a good idea to get up to speed with writing a basic FOR command before trying the more complex FOR / F variant.

The FOR /F command is the answer to innumerable questions where you want to take the output of some command, store it in a variable (%%G) then do something with the result.

For example the PING command returns serveral lines including one like:

Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),

To select that one line of output, you can search for the text "loss" (which is always present), then use the Tokens parameter to select the number of lost packets, here this is 0 but it will vary each time you run the command.

SET _cmd=ping -n 5 127.0.0.1  
FOR /f "tokens=4 delims=(=" %%G IN ('%_cmd% ^|find "loss"') DO echo Result is [%%G]

The tricky part is splitting up the line of interest into the right tokens, in this case we are splitting on the characters '=' and '('  
those two characters split the line into 5 chunks of text and we pull out the fourth one with "tokens=4"

By default, /F breaks up the command output at each blank space, and any blank lines are skipped.  
You can override this default parsing behavior by specifying the "options" parameter. The options must be contained within "quotes"

It is possible to use the syntax on this page to parse a text file with [TYPE](type.html) ('Type somefile.txt') but you will get much better performance using [FOR /F File contents](for_f.html) (somefile.txt) as that will save loading TYPE.EXE.

The precedence/priority of FOR command options is: usebackq > skip > delims > eol > tokens

usebackq
--------

> This option is useful when dealing with a command that already contains one or more straight quotes.  
> The backquote character \` is just below the ESC key on most keyboards. See the [FOR /F](for_f.html) page for other effects of usebackq.
> 
> Usebackq can be abbreviated to useback (undocumented.)

Skip
----

> SKIP will skip processing a number of lines from the beginning of the file.  
> SKIP includes empty lines, but after the SKIP is complete, FOR /F ignores (does not iterate) empty lines. Some commands, in particular WMIC will append extra carriage returns to otherwise blank lines at the end of their output. To skip these, add a [goto](goto.html) command to break out of the FOR loop.

eol
---

> The default end-of-line character is a semicolon ';' when the FOR command reads a text file (or even a character string), any line that STARTS with the eol character will be ignored. In other words it is treated as a comment.  
> Use eol=X to change the eol character to X.
> 
> Often you will want to turn this feature off so that every line of your data file is processed, in theory "eol=" should turn this feature off, but in practice this fails to work correctly - it will set eol to whatever the next character is, often the quote or space character. One workaround is to set eol to some unusual character that you don’t expect to ever encounter in the data file e.g. "eol=€" or "eol=¬". Another method is to escape every [delimiter](syntax-esc.html#delimiters) For /f tokens^=*^ delims^=^ eol^= %%a in (file.txt) do... (see forum for a [discussion](https://ss64.org/viewtopic.php?t=13) of this)

Delims
------

> More than one delimiter can be specified so a string like 'abcd+efg+hijk;lmno;pqr' can be broken up using "delims=;+".
> 
> for /f "tokens=1,2,3,4,5 delims=;+" %%G in ('type filename.txt') do echo %%G %%H %%K
> 
> For simple FOR commands which only process one item at a time, use "delims="  
> This will place everything on the line into the first token. even if it contains spaces, e.g. a long filename.
> 
> for /f "delims=" %%G in ('dir /b C:\demo*.*') do echo %%G
> 
> You can use almost any character as a delimiter, but they are case sensitive.  
> 
> delims should always the last item in the _options_ string "tokens=3 delims= " not "delims=  tokens=3"  
> This is because the quotations around the _options_ string do double duty as a terminator for the delims character(s), which is particularly important when that character is a space.
> 
> If you don’t specify delims it will default to "delims=<tab><space>,=;"  
> This is the same as the [default delimiters for the CMD shell command line](syntax-esc.html) (Space,Tab,Comma,Equals,Semicolon). All of those can be specified as individual delimiters with the FOR command, but when using = as a delimiter it cannot be the last one in the list. So this is valid: "delims=;= " and this is not valid: "delims=; ="
> 
> Consecutive delimiters will be treated as one, even if they are different characters.  
> This means that if any data values are missing between delimiters the subsequent items in that line will be assigned a different token, e.g.
> 
> Bread,Organic,$1.49  
> Cheese,,$2.99  
> In the first line the price will be assigned to the third token, but for the second line, the price will be assigned to the second token.  
> A common workaround for this issue is to pre-process the input data adding a placeholder character between any consecutive delimiters. e.g. replace ',,' with ',~,'
> 
> One special case is using a double quote (") as delimiter.  
> By default this will be misinterpreted as the end of the "delims string", a workaround for this is to remove the outer enclosing quotes and instead [escape](syntax-esc.html) all the delimiter chars with ^.  
>   
> for /f tokens^=1^,2^,3^ delims^=^" %%G in ('type filename.txt') do echo %%G %%H %%I  
>   
> n.b. some text editors will enter the TAB character as a series of spaces.

Tokens
------

> tokens=2,4,6  Will cause the second, fourth and sixth items on each line to be processed (3 Tokens).  
>   
> tokens=2-6  Will cause the second, third, fourth, fifth and sixth items on each line to be processed (5 Tokens).  
>   
> tokens=*   Will cause all items on each line to be processed as a single string Token.  
>   
> tokens=3*  Will process the third item as one string token and then all subsequent text as a second string Token.  
> This can also be written as tokens=3,*  
>   
> If the last character in the tokens= string is an asterisk '*', then one additional parameter is added for all the remaining text on the line.
> 
> If an asterix is used in the tokens= string then it must be the **last** character in the string.
> 
> The parameter added by the asterix is based on the whole tokens= string and not on the number preceding the asterix, so if you select tokens 1,2,* the asterisk will represent the third and all subsequent items, and if you select tokens=19,2,1,* then the asterisk will represent the 20th and all subsequent items.
> 
> Each token specified will cause a corresponding parameter letter to be allocated. The letters used for tokens are case sensitive.  
> 
> The following [ASCII characters](../ascii.html) can be used as FOR tokens:  
> ASCII 63 - 93 inclusive, 31 tokens: ? @ A B C D E F G H I J K L M N O P Q R S T U V W X Y Z [ \ ]  
> ASCII 95-123 inclusive, 29 tokens: _ \` a b c d e f g h i j k l m n o p q r s t u v w x y z {  
> (there are [a few](https://stackoverflow.com/a/8520993/1720814) other characters that can be used, but require [escaping](syntax-esc.html#escape))
> 
> A single FOR /F command can never parse more than 31 tokens, to use more requires a [workaround](https://stackoverflow.com/a/8520993/1720814) with multiple FOR commands.
> 
> The tokens selected do not have to be listed in numeric order, though it is usually more readable to do so. The numbers selected in tokens= are automatically sorted, so for example tokens=5,7,1-3 and tokens=1,2,3,5,7 both produce the same result.
> 
> Matching the same token more than once (tokens=1,2,1) can give [unpredictable](https://stackoverflow.com/questions/25950181/why-for-f-sets-empty-values-for-repeated-numbers-in-the-rest-of-tokens) results. Token variables can of course be used multiple times: Echo %%G %%H %%G  
>   
> FOR tokens variables (or parameter names) are global, so in complex scripts which [call](call.html) one FOR statement from within another FOR statement you can refer to both sets of parameters.

_command_to_process_
----------------------

> The _command_to_process_ can be almost any internal or external command, but there are a few commands that have no effect when are called through FOR /F - SHIFT, SETLOCAL, ENDLOCAL, CALL:Subroutine.  
> To be clear these can be used as part of _command_, but not _command_to_process_
> 
> If the _command_to_process_ is a long filename, you will need to surround it in double quotes, similarly any [parameters](syntax-args.html) with spaces need to be double quoted. In addition to that the entire _command_to_process_ needs to be enclosed in another set of double quotes like so:
> 
> FOR /f %%G in ('**"**"C:\Program Files\some Program.exe" "a string" "second"**"**') do...
> 
> This is because the FOR command will start the program in a new sub-shell which removes the outer set of double quotes.
> 
> If any of the strings contain multiple consecutive delimiters (typically spaces) then you may need to [escape](syntax-esc.html) them "before ^ ^ after" otherwise they will be merged into a single delimiter/space.

_command_
---------

> This can be almost any [internal](syntax-internal.html) or external command.
> 
> A common pattern is to set a variable = some token output to make it available for later processing/display. When doing this be sure to read the section [_Using variables within a FOR loop_](for.html#variables) on the main FOR page.
> 
> Also consider the case where the _command_ fails, the FOR command will trap the error, but the DO clause is never reached - this means the variable will not be changed. This can cause subtle bugs. When using the FOR command in a batch file always use [SETLOCAL](setlocal.html) at the start to localise all variables. Alternatively you can explicitly clear the variable(s) to remove any existing value, just before running the FOR loop.

FOR does not, by itself, set or clear an [Errorlevel](errorlevel.html), leaving that to the _command_ being called.  
FOR is an [internal](syntax-internal.html) command.

### Examples

Select just the version number from the output of [VER](ver.html):

  @echo off
  For /f "tokens=3,*" %%G in ('ver') do echo The version is [%%H

How would you modify this to remove the square brackets from the output? (hint you will need a delims=).

To ECHO from the command line, the name of every environment variable.

    FOR /F "delims==" %G IN ('SET') DO @Echo %G

The same command with usebackq:

    FOR /F "usebackq delims==" %G IN (\`SET\`) DO @Echo %G

To put the Windows Version into an environment variable

    @echo off 
    ::parse the VER command 
    FOR /F "tokens=4*" %%G IN ('ver') DO SET _version=%%G 
    :: show the result 
    echo %_version%

List all the text files in a folder:

    FOR /F "tokens=*" %%G IN ('dir /b C:\docs*.txt') DO echo %%G

The "tokens=*" has been added to match all parts of any long filenames returned by the DIR command.

List all the text files in a folder, including the full path:

    FOR /F "tokens=*" %%G IN ('dir /b **/s** ^"c:\program files*.txt^"') DO echo %%G

We use DIR /S (even if the folder has no subfolders) to make [DIR](dir.html) return the **full** path to each file.  
In the example above the long filename has to be surrounded in "quotes" and those quotes have to be escaped using ^  
  
Although the above is a trivial example, being able to set a variable equal to each long filename in turn allows much more complex processing to be done.

More examples can be found on the [Syntax / Batch Files pages](syntax.html) and the other FOR pages below.

“History never repeats itself, Mankind always does” - Voltaire

### Related commands

[FOR](for.html) - Summary of FOR Loop commands.  
[FOR](for2.html) - Loop through a set of files in one folder.  
[FOR /R](for_r.html) - Loop through files (recurse subfolders).[  
FOR /D](for_d.html) - Loop through several folders.  
[FOR /L](for_l.html) - Loop through a range of numbers.  
[FOR /F](for_f.html) - Loop through items in a text file.  
[SETLOCAL](setlocal.html) - Control the visibility of variables inside a FOR loop.  
[FORFILES](forfiles.html) - Batch process multiple files.  
[GOTO](goto.html) - Direct a batch program to jump to a labelled line.  
[IF](if.html) - Conditionally perform a command.  
Equivalent PowerShell: [ForEach-Object](../ps/foreach-object.html) - Loop for each object in the pipeline.  
Equivalent bash command (Linux): [for](../bash/for.html) - Expand words, and execute commands



/. nt/for.html
========================================================

    For - Looping commands - Windows CMD - SS64.com

FOR
===

Conditionally perform a command several times.

 syntax-[FOR-Files](for2.html)
       FOR %%parameter IN (_set_) DO _command_ 
   
 syntax-[FOR-Files-Rooted at Path](for_r.html)   
       FOR **/R** [[drive:]path] %%parameter IN (_set_) DO _command_ 
   
 syntax-[FOR-Folders](for_d.html)
       FOR **/D** %%parameter IN (_folder_set_) DO _command_ 
   
 syntax-[FOR-List of numbers](for_l.html)   
       FOR **/L** %%parameter IN (start,step,end) DO _command_ 
   
 syntax-[FOR-File contents](for_f.html)   
       FOR **/F** ["options"] %%parameter IN (filenameset) DO _command_ 
   
       FOR **/F** ["options"] %%parameter IN ("Text string to process") DO _command_
   
 syntax-[FOR-Command Results](for_cmd.html) 
       FOR **/F** ["options"] %%parameter IN ('command to process') DO _command_

The operation of the FOR command can be summarised as...

*   Take a set of data
*   Make a FOR Parameter %%G equal to some part of that data
*   Perform a command (optionally using the parameter as part of the command).
*   Repeat for each item of data

If you are using the FOR command at the command line rather than in a batch program, use just one percent sign: %G instead of %%G**.**

FOR Parameters
--------------

> The first parameter has to be defined using a single character, for example the letter G.  
>   
> FOR %%G IN ...  
>   
> In each iteration of a FOR loop, the IN ( ....) clause is evaluated and %%G set to a different value  
>   
> If this clause results in a single value then %%G is set equal to that value and the command is performed.  
>   
> If the clause results in a multiple values then extra parameters are implicitly defined to hold each. These are automatically assigned in alphabetical order %%H %%I %%J ...(implicit parameter definition)
> 
> If the parameter refers to a file, then [enhanced variable reference](syntax-args.html) can be used to extract the filename/path/date/size.
> 
> You can of course pick any letter of the alphabet other than %%G.  
>   
> %%G is a good choice because it does not conflict with any of the pathname [format letters](syntax-args.html) (a, d, f, n, p, s, t, x) and provides the longest run of non-conflicting letters for use as implicit parameters.  
> G > H > I > J > K > L > M  
> Format letters are case sensitive, so using a capital letter is also a good way to avoid conflicts %%A rather than %%a.
> 
> If you need a lot of parameter letters, the full list from low to high is:  
> > ? @ A B C D E F G H I J K L M N O P Q R S T U V W X Y Z [ \ ] ˆ _ \` a b c d e f g h i j k l m n o p q r s t u v w x y z { | }
> 
> Starting at %A, you can use 29 characters before having to escape any punctuation letters. [[source](https://www.robvanderwoude.com/clevertricks.php#FORListExtended)]

Using variables within a FOR loop
---------------------------------

> Variables are expanded at the start of a FOR loop and don’t update until the entire DO section has completed.  
> The following example counts the files in the current folder, but %count% always returns 1:
> 
> @echo off  
> SET count=1  
>  FOR /f "tokens=*" %%G IN ('dir /b') DO **(**  
>  echo %count%:%%G  
>  set /a count+=1 **)**
> 
> To update variables within each iteration of the loop we must either use [EnableDelayedExpansion](setlocal.html) or else use the [CALL :subroutine](call.html) mechanism as shown below:
> 
> @echo off  
> SET count=1  
> FOR /f "tokens=*" %%G IN ('dir /b') DO **(**call :subroutine "%%G"**)**  
> GOTO :eof  
>   
> :subroutine  
>  echo %count%:%1  
>  set /a count+=1  
>  GOTO :eof

Nested FOR commands
-------------------

> FOR commands can be nested FOR %%G... DO (for %%U... do ...)  
> when nesting commands choose a different letter for each part. you can then refer to both parameters in the final DO command.
> 
> For an example of exiting the inner loop of two nested FOR loops, see the [EXIT](exit.html) page.

Errorlevels
-----------

> FOR does not, by itself, set or clear an [Errorlevel](errorlevel.html), leaving that to the _command_ being called.  
> One exception is using a wildcard, if the wildcard does not match any files, then FOR will return %ERRORLEVEL% = 5

FOR is an [internal](syntax-internal.html) command.  
If [Command Extensions](cmd.html) are disabled, the FOR command will only support the basic syntax with no enhanced variables: FOR %%parameter IN (set) DO command [command-parameters]

### Examples

FOR /F "tokens=1-5" %%A IN ("This is a short sentence") DO @echo %%A %%B %%D

will result in the output: This is short

Create a set of 26 folders, one for each letter of the alphabet:

FOR %%G IN (a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z) DO (md C:\demo\%%G)

“Those who cannot remember the past are condemned to repeat it” - George Santayana

### Related commands

[FOR](for2.html) - Loop through a set of files in one folder.  
[FOR /R](for_r.html) - Loop through files (recurse subfolders) [.  
FOR /D](for_d.html) - Loop through several folders.  
[FOR /L](for_l.html) - Loop through a range of numbers.  
[FOR /F](for_f.html) - Loop through items in a text file.  
[FOR /F](for_cmd.html) - Loop through the output of a command.  
[Parameters/arguments](syntax-args.html) %~ options.  
[FORFILES](forfiles.html) - Batch process multiple files.  
[GOTO](goto.html) - Direct a batch program to jump to a labelled line.  
[IF](if.html) - Conditionally perform a command .  
Equivalent PowerShell: [ForEach-Object](../ps/foreach-object.html) - Loop for each object in the pipeline.  
Equivalent bash command (Linux): [awk](../bash/awk.html) or [read](../bash/read.html) (in a loop) - Read a line from standard input.



/. nt/forfiles.html
========================================================

    Forfiles - Batch process multiple files - Windows CMD - SS64.com

FORFILES.exe
============

Select a file (or set of files) and execute a command on each file. Batch processing.

Syntax

      FORFILES [/p _Path_] [/**m** _SrchMask_] [/s] [/**c** _Command_] [/**d** [+ | -] {_date_ | _dd_}]   

Key
    /p _Path_      The Path to search  (default=current folder)

    /m _SrchMask_  Select files matching the specified search mask
                Wildcards are literal (non standard):
                A mask of -m *   will iterate all files (this is the default)
                A mask of -m *.* will skip any extensionless filename.

    /s           Recurse into sub-folders

    /C _command_   The command to execute for each file.
                Wrap the command string in double quotes.
                Default = "cmd /c echo @file"

                The Command variables listed below can also be used in the
                command string.

    /D _date_      Select files with a last modified date greater than or 
                equal to (+), or less than or equal to (-),
                the specified _date_, using the region specific date format.
                The /? Help text will display the date format for your region
                typically "MM/DD/yyyy" or "DD/MM/yyyy".

    /D +_dd_       Select files with a last modified date greater than or
                equal to the current date plus "dd" days. (in the future)

    /D -_dd _      Select files with a last modified date less than or
                equal to the current date minus "dd" days. (in the past)

                A valid "dd" number of days can be any number in
                the range of 0 to 32768.   (89 years)

                "+" is taken as the default sign if not specified.

    Command Variables:
      @file    The name of the file.
      @fname   The file name without extension.                
      @ext     Only the extension of the file.                  
      @path    Full path of the file.
      @relpath Relative path of the file.          
      @isdir   Returns "TRUE" if a file type is a directory,
               and "FALSE" for files.
      @fsize   Size of the file in bytes.
      @fdate   Last modified date of the file.
      @ftime   Last modified time of the file.

To include [special characters](../ascii.html) in the command line, use the hexadecimal code for the character in 0xHH format (ex. 0x09 for tab). [Internal](syntax-internal.html) CMD.exe commands should be preceded with "cmd /c".

Last modified time is taken to be midnight 00:00, so FORFILES /D +_TodaysDate_ will find files created today.

Last modified dates set in the future are not common but can happen when your computer clock date/time is changed e.g. due to daylight savings time.

Early versions of FORFILES were supplied in the NT resource kit and used unix style '-' parameters, (still supported for backwards compatibility) also the /D option accepted dates only in DDMMYYYYHHMN format.

Bugs
----

> Recent versions of FORFILES contain a bug, in processing command line arguments: running a /c command that contains an argument such as FORFILES /C "PING -a" [will fail](https://stackoverflow.com/a/26990159/1720814). The expected convention is that argv[0] will contain the program name, but FORFILES instead passes the first _argument_ as argv[0]. Old versions e.g. FORFILES version 1.46 (24th March 2006) do not suffer from this bug.
> 
> One workaround for this is to include the program name as the first argument, this will be passed along by FORFILES and the CreateProcess call will then work as expected:  
> FORFILES /c "Ping Ping -a"
> 
> Alternatively pass the command to [CMD /C](cmd.html), which will then process all the arguments correctly.  
> If you want to use an internal commmand, or if you want to use redirection, pipe, command concatenation, etc, then you must use CMD /C.  
> FORFILES /c "CMD /C Ping -a"
> 
> There are some disadvantages to using CMD.exe with FORFILES, a new process will be created and destroyed for every file that FORFILES processes, so if you loop through 1000 files, then 1000 copies of CMD.exe will be opened and closed, this will affect performance. Also any variable created with SET will be lost as soon as FORFILES moves on to the next file.
> 
> In most cases using a simple [FOR](for2.html) command along with [Parameter extensions](syntax-args.html) will provide a better/less buggy solution.  

Return values
-------------

> If ForFiles finds one or more matches if will return [Errorlevel](errorlevel.html) =0  
> If ForFiles finds no matches if will return Errorlevel =1 and will print _"ERROR: No files found with the specified search criteria."_

### Examples

Delete the testfile if it is is 5 days old or older:  
C:> forfiles /m testfile.txt /c "cmd /c Del testfile.txt " /d -5

Find all .xlsx files that were last modified 30 days ago or older:  
C:> FORFILES /M *.xlsx /C "cmd /c echo @path was changed 30 days ago" /D -30

List the size of all .doc files:  
C:> FORFILES /S /M *.doc /C "cmd /c echo @fsize"

Run a command against each text file newer than 1st Jan 2001:  
C:> FORFILES /D +01/01/2001 /m *.txt /C "CMD /c echo @fname is new since Jan 1st 2001"

Rule #1: Don’t sweat the small stuff.  
Rule #2: It's all small stuff - Dr Robert S Eliot, University of Nebraska cardiologist

### Related commands

Syntax - [Delete files older than _N_ days](syntax-delolder.html)  
[OldNewThing](https://devblogs.microsoft.com/oldnewthing/?p=6953) - Combining ForFiles and FOR.  
[Parameter extensions](syntax-args.html) - Get file size(s).  
[FOR](for.html) - Conditionally perform a command several times.  
Equivalent PowerShell: [ForEach-Object](../ps/foreach-object.html) - Loop for each object in the pipeline.  
Equivalent bash command (Linux): [find](../bash/find.html) - Search for files that meet a desired criteria.



/. nt/format.html
========================================================

    Format - Format a disk - Windows CMD - SS64.com

FORMAT.com
==========

Format a disk for use with Windows.

Syntax

      FORMAT _volume_ [/FS:_file-system_] [/V:_label_] [/Q] [/L] [/A:_size_] [/C] [/I:_state_] [ /X] [/P:_passes_] [/S:_state_]
      FORMAT _volume_ [/V:_label_] [/Q] [/F:_size_] [/P:_passes_]
      FORMAT _volume_ [/V:_label_] [/Q] [/T:_tracks_ /N:_sectors_] [/P:_passes_]
      FORMAT _volume_ [/V:_label_] [/Q] [/P:_passes_]
      FORMAT _volume_ [/Q]

Key
    _volume_          The drive letter (followed by a colon), mount point, or volume name.

    /FS:_file-system_ The type of the file system (FAT, FAT32, exFAT, NTFS, [UDF](https://docs.microsoft.com/en-us/windows/win32/imapi/disc-formats), [ReFS](https://docs.microsoft.com/en-us/windows-server/storage/refs/refs-overview)).  
    /V:_label_        The volume label.  
    /Q              Perform a quick format. This switch overrides /P (zero out bytes).  
    /C              Compression - files added to the new disk will be compressed by default (NTFS only).

    /X              Force the volume to dismount first if necessary.
                   All opened handles to the volume would no longer be valid.

    /R:_revision_     UDF only: Force the format to a specific UDF version
                   (1.02, 1.50, 2.00, 2.01, 2.50).  default= 2.01

    /D              UDF 2.50 only: Metadata will be duplicated.

    /L              NTFS Only: Use large size file records.
                   By default, the volume will be formatted with small size file records.

    /A:_size_         Override the default allocation unit size. Default settings are
                   strongly recommended for general use. See below for allocation unit sizes.
                   NTFS compression is not supported for allocation unit sizes above 4096.

    /T:_tracks_       The number of tracks per disk side.

    /N:_sectors_      The number of sectors per track.

    /P:_count_        Zero every sector on the volume.  After that, the volume will be
                   overwritten "_count_" times using a different random number each time.
                   If "count" is zero, no additional overwrites are made after 
                   zeroing every sector.
                   This switchis ignored when /Q is specified.

    /S:_state_        Support for short filenames (enable, disable)
                   Short names are disabled by default

    /I:_state_        ReFS only: enable integrity on the new volume.
                   "state" is either "enable" or "disable"
                   Integrity is enabled on storage that supports data redundancy
                   by default.

    /F:_size_         The size of the floppy disk to format (720, 1.2, 1.44, 2.88, or 20.8).

    /DAX[:_state_]    NTFS Only: Enable direct access storage (DAX) mode for this volume.
                   In DAX mode, the volume is accessed via the memory bus, boosting IO performance.
                   A volume can be formatted with DAX mode only if the hardware is DAX capable. 
                   State can specify "enable" or "disable".   * Windows 10+
                   /DAX is considered as /DAX:enable.

    /LogSize[:_size_] NTFS Only: The size for NTFS log file in kilobytes.
                   The minimum supported size is 2MB, so specifying size smaller than 2MB will
                   result in a 2MB log file.  Zero indicates the default value which generally
                   depend on the volume size.   * Windows 10+

    /NoRepairLogs   NTFS Only: Disable NTFS repair logs.   * Windows 10+
                   If the flag is set spotfix (i.e. [chkdsk](chkdsk.html) /spotfix) will not work.

Allocation unit sizes:
    ReFS supports 64K.
    NTFS supports 512, 1024, 2048, 4096, 8192, 16K, 32K, 64K.
    FAT supports 512, 1024, 2048, 4096, 8192, 16K, 32K, 64K,
     (128K, 256K for sector size > 512 bytes).
    FAT32 supports 512, 1024, 2048, 4096, 8192, 16K, 32K, 64K,
     (128K, 256K for sector size > 512 bytes).
    exFAT supports 512, 1024, 2048, 4096, 8192, 16K, 32K, 64K,
      128K, 256K, 512K, 1M, 2M, 4M, 8M, 16M, 32M.

The FAT and FAT32 files systems impose the following restrictions on the number of clusters on a volume:  
FAT: Number of clusters <= 65526  
FAT32: 65526 < Number of clusters < 4177918  

### Examples

@echo off  
Echo Warning this will reformat the entire D: disk!  
PAUSE  
format D: /FS:NTFS /x

"The disks had a recording density of 1,100 bits per inch, and could move data out of the drive at 77 kilobytes per second" ~ Early hard drive specs.

### Related commands

[DISKPART](diskpart.html) - Disk Administration.  
[SYSPREP](https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/sysprep--generalize--a-windows-installation?view=windows-11) - (Generalize) a Windows installation.  
[Q140365](https://support.microsoft.com/en-gb/help/140365/) - Default cluster size for NTFS, FAT, and exFAT.  
[Q17423](https://support.microsoft.com/en-gb/help/17423/) - How to create a Bootdisk.  
Equivalent bash command (Linux): mkfs, in FreeBSD & OSX: newfs, fsck_exfat



/. nt/freedisk.html
========================================================

    Freedisc - Windows CMD - SS64.com

FREEDISK (Windows Server 2003/2008/2012)
========================================

Checks to see if a specified amount of disk space is available.

Syntax

      FREEDISK [/s _Computer_ [/u [_Domain_\]_User_ [/p [_Password_]]]] [/d _Drive_] [_Value_]  
Key
    /s _Computer_       The name or IP address of a remote computer (do not use backslashes).
                     The default is the local computer.
                     This parameter applies to all files and folders specified in the command.

    /u [_Domain_\]_User_  Run the script with the permissions of the specified user account.
                     The default is system permissions.

    /p [_Password_]     The password of the user account that is specified in /u.
    /d _Drive_          The drive for which you want to find out the availability of free space.
                     You must specify _Drive_ for a remote computer.

    _Value_             Check for a specific amount of free disk space.
                     specify _Value_ in bytes, KB, MB, GB, TB, PB, EB, ZB or YB.

When used in a batch file, freedisk returns errorlevel=0 if there is enough space and errorlevel=1 if there is not enough space.

For unattended installations, you can use FREEDISK in installation batch files to check for a prerequisite amount of free space before continuing with the installation.

### Examples

Determine if there is at least 50 MB of free space on drive C:

freedisk 50mb  

"Our deepest fear is not that we are inadequate. Our deepest fear is that we are powerful beyond measure. It is our light, not our darkness that most frightens us. We ask ourselves, ‘Who am I to be brilliant, gorgeous, talented, fabulous?’ Actually, who are you not to be? Your playing small doesn’t serve the world" ~ Marianne Williamson

### Related commands

[DIRUSE](diruse.html) - Display disk usage (2000 Resource Kit).  
DirQuota - Create and manage quotas (File Server Resource Manager).  
[DISKUSE](diskuse.html) - Show the space used in a folder/subfolders (2003 Resource Kit).



/. nt/fsutil.html
========================================================

    summary { color: blue; cursor: pointer; font-size:18px; margin-left: 20px; width: 265px; } details > summary { padding: 2px 6px; background-color: #e7e7e7; border: none; box-shadow: 1px 1px 2px black; } Fsutil - File system utilities - Windows CMD - SS64.com

FSUTIL.exe
==========

File and Volume specific commands, Hardlink management, Quota management, USN, Sparse file, Object ID and Reparse point management.

Filename management options (for the Local System):

FSUTIL 8dot3name

    Show the current setting for shortname behaviour:
    FSUTIL **8dot3name query**
          
    Scan for affected registry entries:
    FSUTIL **8dot3name scan** [/s] [/l _log_file_] [/v] _DirectoryPath_       
         /s  Recurse to subdirectories.
         /l  Log to file.
         /v  Verbose, output log to the console.

    Change the setting for shortname behaviour:
    FSUTIL **8dot3name set** [0 through 3] [_volume_Path_] 1 | 0]

        When a volume is not specified, this updates the registry
          0 - Enable 8dot3 creation on all volumes
          1 - Disable 8dot3 creation on all volumes
          2 - Set 8dot3 creation on a per volume basis
          3 - Disable 8dot3 creation on all volumes other than the system volume.

          In the registry HKLM\SYSTEM\CurrentControlSet\Control\FileSystem  (NtfsDisable8dot3NameCreation)
          
        When a volume is  specified, this updates individual volume's on disk flag.
        This operation is only meaningful if the registry value is set to 2.
          0 - Enable 8dot3 creation on this volume
          1 - Disable 8dot3 creation on this volume

          Eg :  fsutil 8dot3name set E: 1

    Remove the shortnames for all files within a directory:
    FSUTIL **8dot3name strip** [/t] [/s] [/f] [/l _log_file_] [/v] _DirectoryPath_
    
        This command will permanently remove 8dot3 filenames from a volume. Stripping will not be performed on any
        files with full path names longer than the maximum path_length of 260 chars.

        This command will also list any registry keys pointing to the stripped filenames but will not
        modify the affected registry keys.

        **WARNING** If there are affected registry keys and you use the override switch /f
        it is recommended that you backup your volume as it may lead to unexpected
        application failures including the inability to uninstall.

          /t - Test mode, perform all operations except the actual stripping of filenames.
          /s - Recurse all subdirectories
          /f - Force, Strip the directory 8.3 filenames even if there are registry conflicts.
          /v - Verbose mode, output log to the console.
          /l - Specify an output log file, if not specified this will default
               to "%temp%\8dot3_removal_log@(GMT YYYY-MM-DD HH-MM-SS)"

          Eg :  fsutil 8dot3name strip /t /l SS64.log /s D:\datafiles

View or set File system Behavior:

FSUTIL behavior

View File system Behavior:

    FSUTIL **[behavior](#behavior) query** _option_

Set File system Behavior:

    FSUTIL **[behavior](#behavior) set** _option_

      Where _option_ is one of:
       AllowExtChar {0|1}       Allow extended characters in filenames
       BugcheckOnCorrupt {0|1}  Enable bugcheck
       Disable8dot3 [_volumePath_] _sfnNum_
          _sfnNum_ is between 0 and 3 
           0 = Create short file names (default).
           1 = don’t create short file names. 
           2 = Set 8.3 names on a per volume basis.
           3 = Disable 8.3 names on all volumes except the system volume.
       DisableCompression {0|1} Disable compression
       DisableCompressionlimit {0|1} 
       DisableEncryption {0|1}  Disable encryption
       DisableDeleteNotify {0| [NTFS|ReFS] 1} SSD [TRIM](https://www.thewindowsclub.com/enable-trim-in-windows-10) Delete notifications for all volumes
                                 0=TRIM enabled, 1=TRIM disabled.
       DisableFileMetadataOptimization {0|1|2|3} 0=Enable, 1=Disable   file metadata optimization.
                                                 2=Disable incremental file metadata optimization only.
                                                 3=Disable all file metadata optimization
       DisableLastAccess {0|1|2|3}  0=Enable last-access updates  1=Disable / Don’t generate last-access times,
                                    2=System managed Enabled      3=System managed Disabled.
                                    When system managed, it allows system policy to control this.
                                    Which may in turn be overridden by Group Policy.
                                    This parameter can affect programs such as Backup and Remote Storage.
       DisableSpotCorruptionHandling {0|1}   Disable (1) or Enable spot [corruption](chkdsk.html) handling.
                                             This feature allows system administrators to run CHKDSK to analyze the state
                                             of a volume without taking it offline. We do not recommend disabling this feature.
       DisableWriteAutoTiering [_voumePath_ 0|1]   1=Disable ReFS v2 auto tiering logic for tiered volumes.
       EncryptPagingfile {0|1}  Encrypt or do not encrypt the memory paging file.
       MemoryUsage {1|2}           Paged-pool memory cache, 1=default
       QuotaNotify _NumSeconds_   Log quota violations, default=3600 seconds
       MftZone {1|2|3|4}        Set MFT Zone, multiple of 200MB
       SymlinkEvaluation L2L:{0|1}    Local to local symbolic links
       SymlinkEvaluation L2R:{0|1}    Local to remote symbolic links
       SymlinkEvaluation R2R:{0|1}    Remote to local symbolic links
       SymlinkEvaluation R2L:{0|1}    Remote to remote symbolic links

  **1** = Set the option to True/On/Enable.
  **0** = Set the option to False/Off/Disable.

    Eg :  fsutil behavior set disablelastaccess 1

With 8.3 filennames disabled you'll notice a performance improvement only with a large number of files (over 300,000) in relatively few folders where a lot of the filenames start with similar names. Not having 8.3 filenames available will prevent the use of old applications such as Word 2.0 and Excel 4.0

If you have a lot of small files, you might need a larger Master File Table to avoid MFT fragmentation:  
FSUTIL behavior set **mftzone** 2 will reserve approximately twice the space for the MFT.  
The exact ratios for each setting are undocumented because they are not standardized and may change in future releases.  
Pre Windows 7 the following ratios were used:  
1 = 12.5 % (default)  
2 = 25%  
3 = 37.5%  
4 = 50%

This won’t affect existing disk partitions, after changing the mftzone size, reboot the machine and create a new partition.

Increasing the MFT zone does not decrease the disk space available for data files.

The NTFS last access time attribute can affect performance on very busy drives, if you disable it, the time set will be the Creation Time.  
FSUTIL behavior set disablelastaccess 1

Mark a File system as dirty to invoke Chkdsk:

FSUTIL dirty

    Query the dirty bit for a volume:
    FSUTIL **[dirty](#dirty) query** _volume_ [_pathname_]

    Mark a file system as dirty:
    FSUTIL **[dirty](#dirty) set** _volume_ [_pathname_]

    Marking a disk as dirty will prompt a [Chkdsk](chkdsk.html) at next boot
    Eg :  fsutil dirty query C:

File operations:

FSUTIL file

Create a new file of a specific size:

    FSUTIL **[file](#file) createnew** _filename_ _length_

    Eg : fsutil file createnew C:\testfile.txt 1000

Find a file by user name / sAMAccountName (only if Disk Quotas are enabled):

    FSUTIL **[file](#file) findbysid** _user directory_

    Eg : fsutil file findbysid scottb C:\users

Query the allocated ranges for a file:

    FSUTIL **[file](#file) queryallocranges** offset=_val_ length=_val filename_

    offset : File Offset, the start of the range to query
    length : Size, in bytes, of the range

    Eg :  fsutil file queryallocranges offset=1024 length=64 C:\Temp\sample.txt

Queries extents for a file:

    FSUTIL **[file](#file) queryextents** [/R] _filename_ [_startingvcn_ [_numvcns_]]

Query the file ID of a file:

    FSUTIL **[file](#file) queryFileid** _filename_

Display a random link name for the file ID (in most cases the file ID will only have one link name):

    FSUTIL **[file](#file) queryFileNamebyid** _volume fileID_

Perform an immediate compaction of the metadata for a given file:  

    FSUTIL **[file](#file) queryoptimizemetadata** _filename_

Query the valid data length for a file:  

    FSUTIL **[file](#file) queryvaliddata** [/R] [/D] _filename_

Enable or disable linux style Case Sensitivity support to a folder (Windows 10 [1803](ver.html)+)  
Prior to 1803, this option required 'Windows Subsystem for Linux' to be enabled.  
Case sensitivity is not automatically inherited but must be applied to each folder.

    FSUTIL **[file](#file) SetCaseSensitiveInfo** C:\folder\path enable
    FSUTIL **[file](#file) SetCaseSensitiveInfo** C:\folder\path disable

Set the EOF of the given file:

    FSUTIL **[file](#file) seteof** _filename length_

Set the short NTFS filename for a file:

    FSUTIL **[file](#file) setshortname** _filename_ _ShortName_

    Eg :  fsutil file setshortname C:\testfile.txt tes1.txt

Set the valid data length for a file:

    FSUTIL **[file](#file) setvaliddata** _filename_ _datalength_

    Eg :  fsutil file setvaliddata C:\testfile.txt 4096

Set the zero data for a file:

    FSUTIL **[file](#file) setzerodata** offset=_val_ length=_val filename_

    offset : File offset, the start of the range to set to zeroes
    length : Byte length of the zeroed range
        Eg :  fsutil file setzerodata offset=100 length=150 C:\Temp\sample.txt

Display filesystem information:

FSUTIL fsinfo

List all drives (including mapped and Subst drives):

    FSUTIL **[fsinfo](#fsinfo) drives**

Query drive type for a drive:

    FSUTIL **[fsinfo](#fsinfo) drivetype** _volume pathname_

    Eg :  fsutil fsinfo drivetype C:
    
    Script to list all drives on the local computer:
    @Echo off
    :: Store all the drive letters currently in use in a variable
    For /f "tokens=*" %%L in ('**FSUTIL fsinfo drives**') do (set _drives=%%L)
    :: Remove the [first 8](syntax-substring.html) characters - the 'Drives:' prefix 
    :: this may need to adjusted for other languages/locales
    Set _drives=%_drives:~8%
    :: Find and Display the drive type of each drive
    For %%D in (%_drives%) do (**FSUTIL fsinfo drivetype** %%D)

Query volume information:

    FSUTIL **[fsinfo](#fsinfo) volumeinfo** _volume pathname_

    Eg :  fsutil fsinfo volumeinfo C:\

Query NTFS specific volume information:

    FSUTIL **[fsinfo](#fsinfo) ntfsinfo** _volume pathname_

    Eg :  fsutil fsinfo ntfsinfo C:
         The cluster size of the disc is shown as 'Bytes Per Cluster' (default= 4K). 

Query file system statistics:

    FSUTIL **[fsinfo](#fsinfo) statistics** _volume pathname_

    Eg :  fsutil fsinfo statistics C:

Manage hardlink(s):

FSUTIL hardlink

List hardlink(s) for a file:

    FSUTIL **[hardlink](#hardlink) list** _filename_

Create hardlink(s) for a file:

    FSUTIL **[hardlink](#hardlink) create** _New_filename_ _Existing_filename_
    Eg :  fsutil hardlink create c:\foo.txt c:\bar.txt

    See also [MKLINK](mklink.html)

Edit an object identifier:  

FSUTIL objectid

Query or Edit an objectID. Deleting or setting an object identifier can result in the loss of data from portions of a file, up to and including entire volumes of data.

    FSUTIL **[objectid](#objectid)** {query | set | delete | create}

QUOTA Management:

FSUTIL quota

Query or edit the quota limits for a volume:

    FSUTIL **[quota](#quota)** {query|disable|track|enforce } C:
    
    FSUTIL **[quota](#quota) violations**
    
    FSUTIL **[quota](#quota) modify** _volume_pathname Threshold Limit User_Name

    Eg : fsutil quota modify c: 3000 5000 domain\user

Self healing management:

FSUTIL repair

Administer and monitor NTFS self-healing repair operations:

    FSUTIL **[repair](#repair) query** _VolumePath_

    FSUTIL **[repair](#repair) enumerate** _VolumePath_ [_LogName_]

    FSUTIL **[repair](#repair) set** _VolumePath__flags_
       Flags: 0x01 - enable general repair
              0x09 - warn about potential data loss
              0x10 - Disable general repair and bugcheck once on first corruption.

    FSUTIL **[repair](#repair) wait** _VolumePath_ [_wait_type_]
       Wait types: 0 - Wait for all repairs (default)
                   1 - Wait for the current repair

    FSUTIL **[repair](#repair) initiate** _VolumePath file_ref#
       file_ref#_ : File reference including segment number of the file.

Query a reparse point:

FSUTIL reparsepoint

List reparse points:

    FSUTIL **[reparsepoint](#reparsepoint) query** _filename_

    Eg : fsutil reparsepoint query C:\Server

Delete a reparse point:

    FSUTIL **[reparsepoint](#reparsepoint) delete** _filename_
    A common reason for long directory name problems is a Windows bug which creates a
    recursive reparsepoint for a directory called "Application Data\Application Data\"
    Eg : cd "\users\myacct\appdata\local\application data"
         fsutil reparsepoint delete "application data"

Transactional Resource Manager:

FSUTIL resource

Create a Secondary Transactional Resource Manager, start or stop a Transactional Resource Manager:

    Create new:
    FSUTIL **[resource](#resource) create** _RM_root_pathanme_
    FSUTIL **[resource](#resource) info** _RM_root_pathanme_

    Specify whether a default [Transactional Resource Manager](https://docs.microsoft.com/en-us/windows/win32/fileio/about-transactional-ntfs) will clean the transactional metadata on the next mount:
    FSUTIL **[resource](#resource) setautoreset** {true|false} _RM_root_pathanme_

    Prefer availability over consistency:
    FSUTIL **[resource](#resource) setavailable** _RM_root_pathanme_

    Prefer consistency over availability:
    FSUTIL **[resource](#resource) setconsistent** _RM_root_pathanme_

    FSUTIL **[resource](#resource) setlog** [growth {_Containers_ containers | _Percent_ percent} _RmRootPathname_]
                              [maxextents _Containers_ _RmRootPathname_]
                                 [minextents _Containers_ _RmRootPathname_]
                                    [mode {full|undo} _RmRootPathname_] [rename _RmRootPathname_]
                                       [shrink _Percent_ _RmRootPathname_] [size _Containers_ _RmRootPathname_]

    FSUTIL **[resource](#resource) start** _RM_root_pathanme_ _RM_log_pathanme_
    FSUTIL **[resource](#resource) stop** _RM_root_pathanme_ _RM_log_pathanme_

Sparse files:

FSUTIL sparse

Set sparse file properties:

    FSUTIL **[sparse](#sparse) queryflag** _filename_
    FSUTIL **[sparse](#sparse) setflag** _filename_

    FSUTIL **[sparse](#sparse) queryrange** _filename_
    FSUTIL **[sparse](#sparse) setrange** _filename_ _Beginning_offset Length_
    
    Eg : fsutil sparse queryflag "C:\My Test.txt"

Sparse files provide a method of saving disk space for files that contain meaningful data as well as large sections of data composed of zeros. If an NTFS file is marked as sparse, then disk clusters are allocated only for the data explicitly specified by the application.  
e.g. The Indexing Service, stores it's catalogs as sparse files.

Management storage tier functions

FSUTIL tiering

Manage storage tier functions, such as setting and disabling flags and listing of tiers:

    FSUTIL **[tiering](#tiering)** [clearflags] _volume_ _flags_
    FSUTIL **[tiering](#tiering)** [queryflags] _volume_
    FSUTIL **[tiering](#tiering)** [regionlist] _volume_
    FSUTIL **[tiering](#tiering)** [setflags] _volume_ _flags_
    FSUTIL **[tiering](#tiering)** [tierlist] _volume_

    Eg : fsutil tiering tierlist C:

NTFS transactions.

FSUTIL transaction

Manage NTFS transactions:

    FSUTIL **[transaction](#transaction) commit** _guid_
    FSUTIL **[transaction](#transaction) list**
    FSUTIL **[transaction](#transaction) fileinfo** _filename_
    FSUTIL **[transaction](#transaction) query** {files|all} _guid_
    FSUTIL **[transaction](#transaction) rollback** _guid_

The Update Sequence Number (USN) change journal:

FSUTIL usn

Manage the update sequence number (USN) change journal:

    FSUTIL **[usn](#usn) createjournal** m=_maxSize_ a=A_llocationDelta VolumePath_
    FSUTIL **[usn](#usn) deltejournal** {/D | /N} _VolumePath_
       Deleting the change journal impacts the File Replication and the Indexing Service, it
       will require a complete (and time-consuming) scan of the volume. 
    FSUTIL **[usn](#usn) enablerangetracking** _VolumePath_ [_options_]

    FSUTIL **[usn](#usn) enumdata** _file_ref# lowUSN highUSN VolumePath_
    FSUTIL **[usn](#usn) queryjournal** _VolumePath_
    FSUTIL **[usn](#usn) readdata** _filename_
    FSUTIL **[usn](#usn) readjournal** [c=_ChunkSize_ s=_FileSizeThreshold_] _VolumePath_

Volume management, Dismount or query free space

FSUTIL volume

Dismount a volume, or query the hard drive to determine how much free space is currently available or which file is using a particular cluster:

    FSUTIL **[volume](#volume) allocationreport** _VolumePath_
    FSUTIL **[volume](#volume) diskfree** _VolumePath_
    FSUTIL **[volume](#volume) dismount** _VolumePath_
    FSUTIL **[volume](#volume) filelayout** _VolumePath fileid_
    FSUTIL **[volume](#volume) list**
    FSUTIL **[volume](#volume) querycluster** _VolumePath cluster_ [_cluster_...]

Windows Image (WIM)-backed files:

FSUTIL wim

Functions to discover and manage Windows Image (WIM)-backed files.:

    FSUTIL **[wim](#wim) enumfiles** _DriveName_ _DataSource_
    FSUTIL **[wim](#wim) enumwims** _DriveName_
    FSUTIL **[wim](#wim) queryfile** _Filename_
    FSUTIL **[wim](#wim) removewim** _DriveName_ _DataSource_

To run FSUTIL, you must be logged on as an administrator or a member of the Administrators group.

**Bugs**

> FSUTIL outputs a NULL character (not a space) after every drive specifier, this can cause difficulty when piping the output of fsutil into other commands (particularly FOR). The output from FSUTIL varies by OS see [this forum thread](https://ss64.org/viewtopic.php?f=2&t=23) for more detail.
> 
> Some features in fsutil are reported to not work correctly under FAT or FAT32 volumes e.g. FSUTIL dirty query.

“You can tune a file system, but you can’t tune a fish” ~ Sun man page for tunefs

### Related commands

[Q982018](https://support.microsoft.com/en-gb/help/982018/) - FSUTIL update - compatibility with Advanced Format Disks.  
[CACLS](cacls.html) - Change file permissions.  
[CHKDSK](chkdsk.html) - Check Disk - check and repair disk problems  
[CHKNTFS](chkntfs.html) - Check the NTFS file system.  
[DevCon](devcon.html) - Device Manager Command Line Utility.  
[DIRUSE](diruse.html) - Display disk usage.  
[DISKSHADOW](diskshadow.html) - Volume Shadow Copy Service.  
[MKLINK](mklink.html) - Create a symbolic link (linkd)  
PowerShell: [New-Item -ItemType SymbolicLink](../ps/new-item.html)  
[PSINFO](psinfo.html) -d - Display drive information.  
[Q174619](https://support.microsoft.com/en-gb/help/174619/) - MFT How NTFS reserves space for its Master File Table.



/. nt/ftp.html
========================================================

    Ftp - File transfer protocol - Windows CMD - SS64.com

FTP
===

File Transfer Protocol. (Not Secure, for Secure FTP utilities see the [links](../links/windows.html) page.)

Syntax

      FTP [_options_] [-s:_filename_] [-w:_windowsize_] [_host_]

Key   
    _host_   The computer name, IP address, or IPv6 address of the remote FTP host.
          If omitted then FTP will enter command-line mode, type quit to exit.
    -a     Use any local interface when binding data connection.
    -A     Log onto the ftp server as anonymous.
    -d     Debug.
    -g     Disable filename wildcards.
    -i     No interactive prompts during ftp.
    -n     No auto-login.
    -s:_filename_     Run a text file containing FTP commands.
    -v     Hide remote server responses.
    -b:_asyncbuffers_ Override the default async buffer count of 3.
    -r:_recvbuffer_   Override the default SO_RCVBUF size of 8192.
    -x:_sendbuffer_   Override the default SO_SNDBUF size of 8192.
    -w:_windowsize_  Set the transfer buffer size to _windowsize_ (default=4096).
    -?           Help.

Commands to run at the FTP: prompt  

append _local-file_ [_remote-file_]
             Append a local file to a file on the remote computer.

ascii        Set the file transfer type to ASCII, the default. 
             In ASCII text mode, character-set and end-of-line
             characters are converted as necessary.

bell         Toggle a bell to ring after each command. 
             By default, the bell is off.

binary       Set the file transfer type to binary. 
             Use \`Binary' for transferring executable program
             files or binary data files e.g. Oracle

bye          End the FTP session and exit ftp

cd           Change the working directory on the remote host.

close        End the FTP session and return to the cmd prompt.

debug        Toggle debugging. When debug is on, FTP will display
             every command.

delete _remote-file_
             Delete file on remote host.

dir [_remote-directory_] [_local-file_]
             List a remote directory's files and subdirectories.
             (or save the listing to _local-file_)

disconnect   Disconnect from the remote host, retaining the ftp prompt.

get _remote-file_ [_local-file_]
             Copy a remote file to the local PC.

glob         Toggle the use of wildcard characters in local pathnames.
             By default, globbing is on.

hash         Toggle printing a hash (#) for each 2K data block transferred. 
             By default, hash mark printing is off.

help [_command_]
             Display help for ftp command.

lcd [_directory_]
             Change the working directory on the local PC.
             By default, the working directory is the directory in which ftp was started.

literal _argument_ [ ...]
             Send arguments, as-is, to the remote FTP host.

ls [_remote-directory_] [_local-file_]
             List a remote directory's files and folders.
             (short format)

mdelete _remote-files_ [ ...]
             Delete files on remote host.

mdir _remote-files_ [ ...] _local-file_
             Display a list of a remote directory's files and subdirectories.
             (or save the listing to _local-file_)
             Mdir allows you to specify multiple files.

mget _remote-files_ [ ...]
             Copy multiple remote files to the local PC.

mkdir _directory_
             Create a directory on the remote host.

mls _remote-files_ [ ...] _local-file_
             List a remote directory's files and folders.
             (short format)

mput _local-files_ [ ...]
             Copy multiple local files to the remote host.

open _computer_ [_port_]
             Connects to the specified FTP server. 

prompt       Toggle prompting. Ftp prompts during multiple file transfers to 
             allow you to selectively retrieve or store files;
             mget and mput transfer all files if prompting is turned off. 
             By default, prompting is on.

put _local-file_ [_remote-file_]
             Copy a local file to the remote host.

pwd          Print Working Directory
             (current directory on the remote host)

quit         End the FTP session with the remote host and exit ftp.

quote _argument_ [ ...]
             Send arguments, as-is, to the remote FTP host.

recv _remote-file_ [_local-file_]
             Copy a remote file to the local PC.

remotehelp [_command_]
             Display help for remote commands.

rename _filename newfilename_
             Rename remote files.

rmdir _directory_
             Delete a remote directory.

send _local-file_ [_remote-file_]
             Copy a local file to the remote host.

status       Display the current status of FTP connections and toggles.

trace        Toggles packet tracing; trace displays the route of each packet 

type [_type-name_]
             Set or display the file transfer type:
             \`binary' or \`ASCII' (the default)

             If type-name is not specified, the current type is displayed. 
             ASCII should be used when transferring text files.

             In ASCII text mode, character-set and end-of-line
             characters are converted as necessary.

             Use \`Binary' for transferring executable files. 

user _user-name_ [_password_] [_account_]
             Specifes a user to the remote host.

verbose      Toggle verbose mode. By default, verbose is on.

! _command_    Run command on the local PC.

? [_command_]  Display help for ftp command.

### Examples

Connect to the speedtest FTP server as 'anonymous' and with a null password:

C:> ftp speedtest.tele2.net  
User: anonymous  
Password:  
230 Login successful.  
ftp>

An example FTP Script to **retrieve** files in binary and then ascii mode:

::GetFiles.ftp

    [User_id]
    [ftp_password]  
    binary
    get /usr/file1.exe
    get file2.html
    mget *.jpeg  
    ascii
    mget *.txt  
    quit

To run the above script:  
FTP -s:GetFiles.ftp [hostname]  
This will connect as the user:_User_id_ with password:_ftp_password_  
  
An FTP Script to **publish** files in binary mode:

::PutFiles.ftp

    [User_id]
    [ftp_password]  
    binary
    mput *.html
    cd images
    mput *.gif  
    quit

To run the above script:  
FTP -s:PutFiles.ftp [hostname]  
This will connect as the user:_User_id_ with password:_ftp_password_

Using the Windows GUI for FTP
-----------------------------

> Windows Explorer also has a built in basic FTP client, suitable only for small files.  
> Enable it in the Control Panel ➞ Internet Options ➞ Advanced, then tick to enable _FTP folder view_ and _Use Passive FTP_
> 
> Type in the address bar:  
> ftp://_username_@_ftpserver.address.com_  
> you will be prompted for the password if any.  
> e.g.  
> ftp://speedtest.tele2.net  
> 
> You can also do  
> ftp://_username_:_password_@_ftpserver.address.com_  
> This is not recommended as the password will be visible in plain text.
> 
> Or Start ➞ Computer ➞ Right click ➞ Add a network Location ➞ Custom ➞ enter the name of the FTP site.

Secure FTP
----------

> Standard FTP does not encrypt passwords - they are sent across the network in plain text. A more secure method is to use SecureFTP (SFTP) or SecureCopy (SCP) Freeware clients are available e.g. [WinSCP](https://winscp.net/eng/download.php)

_“Only wimps use tape backup: _real_ men just upload their important stuff on ftp, and let the rest of the world mirror it” - Linus Torvalds_

### Related commands

[CURL](curl.html) - Transfer data from or to a server  
[COPY](copy.html) - Copy one or more files to another location.  
[XCOPY](xcopy.html) - Copy files and folders.  
[REM](rem.html) - Add a comment (includes commenting FTP scripts).  
[Q271078](https://web.archive.org/web/20140714092822/https://support.microsoft.com/kb/271078) - Microsoft FTP does not support [passive](https://slacksite.com/other/ftp.html) mode (error 425).  
[RAW FTP](../rawftp.html) - Full list of RAW FTP commands.  
Equivalent bash command (Linux): [FTP](../bash/ftp.html) - File Transfer Protocol.



/. nt/ftype.html
========================================================

    Ftype - File type - Windows CMD - SS64.com

FTYPE
=====

Display or change the link between a FileType and an executable program.

Syntax

    FTYPE _fileType_=_executable_path_
   
    FTYPE

    FTYPE _fileType_

    FTYPE _fileType_=

Key
    _fileType_        : The type of file

    _executable_path_ : The executable program including any command line parameters

File Types can be displayed in Windows Settings under:  
Apps ➞ Default apps ➞ Choose default apps by file type

XML Registration.
-----------------

> Microsoft have changed how file associations work from Windows 8 /2012 onward to prevent malicious apps from changing file associations on the fly. It is no longer possible to use the registry or FTYPE for file association hijacking.
> 
> [Microsoft blog post](https://web.archive.org/web/20170619233131/https://blogs.technet.microsoft.com/mrmlcgn/2013/02/26/windows-8-associate-a-file-type-or-protocol-with-a-specific-app-using-gpo-e-gdefault-mail-client-for-mailto-protocol/):
> 
> > _In Pre-Win 8, apps could set the default handler for a file type/protocol by manipulating the registry, this means you could easily have a script or a group policy manipulating the registry. However In Win 8, the registry changes are verified by a hash (unique per user and app) that detects tampering by apps. In the absence of a valid hash, we ignore the default in the registry. Microsoft have introduced a new Group Policy mechanism for declaring these defaults in Win 8 to accommodate this type of scenario..._
> 
> The way Microsoft expect you to change this now is with an xml file applied through Group Policy. Instructions [here](https://blogs.technet.microsoft.com/windowsinternals/2017/10/25/windows-10-how-to-configure-file-associations-for-it-pros).
> 
> The Settings pane will only display installed applications (FileTypes) and/or an option to install apps from the Windows store. There is no option to manually add a file association for a non-Windows store application.
> 
> Christoph Kolbicz has reverse engineered the hashing algorithm and created a tool called [SetUserFTA](https://kolbi.cz/blog/2017/10/25/setuserfta-userchoice-hash-defeated-set-file-type-associations-per-user/) to set the file type association on a single machine.
> 
> FTYPE can still be used to display registration entries from the registry, but those may not reflect changes made via Group Policy.

Here is a list of [Common File Extensions and FileTypes](syntax-extensions.html).  
  
Several FileTypes can be linked to the same executable application.  
  
FTYPE _filetype_ will display the current executable program for that file type e.g. FTYPE jpegfile.  
  
FTYPE without any parameters will display all FileTypes and the executable program for each.

More than one file extension can be [associated](assoc.html) with the same File Type.  
e.g. both the extension .JPG and the extension .JPEG can be associated with the File Type "jpegfile"

So the path is: File Extension ➞ File Type ➞ executable program  
e.g. .TXT ➞ txtfile ➞ system32\NOTEPAD.EXE

The FileType should always be created before making a File Association with [ASSOC](assoc.html)

Defining command line parameters
--------------------------------

> It is almost always necessary to supply command line parameters so that when a document is opened not only is the relevant application loaded into memory but the document itself also loaded into the application. To make this happen the filename of the document must be passed back to the application.  
>   
> Command line parameters are exactly like [batch file parameters](syntax-args.html), %0 is the executable program and %1 will reference the document filename  
>   
> so a simple command line might be:  
>   
> MyApplication.exe "%1"  
>   
> If any further parameters are required by the application they can be passed as %2, %3. To pass ALL parameters to an application use %*. To pass all the remaining parameters starting with the nth parameter, use %~n where n is between 2 and 9.  

Switch between multiple applications
------------------------------------

> If you have multiple applications that use the same file extension, the [ASSOC](assoc.html) command can be used to switch the file extension between the different FileTypes. This does not remove the _fileType_ for the other application, it will remain so you can easily switch back.

Delete a FileType
-----------------

> Specify **executable_path=**nothing and the FTYPE command will delete the **executable_path** for that FileType.  
> For example:  
> FTYPE htmlfile=

Backup FileTypes
----------------

> FTYPE >backup_types.txt  
> ASSOC >backup_ext.txt

Restore FileTypes from a Backup
-------------------------------

> [FOR](for.html) /F "tokens=* delims=" %G IN (backup_types.txt) DO FTYPE %G  
> FOR /F "tokens=* delims=" %G IN (backup_ext.txt) DO ASSOC %G  
>   
> This will recreate the CLASS id's in the registry at HKey_Classes_Root\.<file extension>  
> If you put the commands above in a batch file change the %G to be %%G

Use file associations at the command line
-----------------------------------------

> If you have a file association between .DOC and Word for Windows then at a command prompt you can open a document with any of the following commands:  
>   
> Start "My Document.doc"  
> "Monthly Report.doc"  
> JULY.DOC  
>   
> note that the file extension must be supplied for this to work

Errorlevels
-----------

> When [CMD Command Extensions](cmd.html) are enabled (the default):  
> If the File Type Association could not be changed [%ERRORLEVEL%](errorlevel.html) = 1  
> If the File Type Association was successfully changed [%ERRORLEVEL%](errorlevel.html) = 0

FTYPE is an [internal](syntax-internal.html) command.  
If [Command Extensions](cmd.html) are disabled, the FTYPE command will not function.

### Examples

The percent signs are doubled to [escape](syntax-esc.html) them, because a single percent has a special meaning within a batch file.

@ECHO OFF  
FTYPE pagemill.html=C:\PROGRA~1\Adobe\PAGEMI~1.0\PageMill.exe "%%1"  
ASSOC .html=pagemill.html  
  
FTYPE rtffile="C:\Program Files\Windows NT\Accessories\WORDPAD.EXE" "%%1"  
ASSOC .rtf=rtffile  
  
FTYPE word.rtf.8="%%[ProgramFiles](syntax-variables.html)%%\Microsoft Office\Office\winword.exe" /n "%%1"  
ASSOC .rtf=word.rtf.8

"True to type - Of a plant, or group of plants, which matches the accepted description of the cultivar to which it is assumed to belong"

### Related commands

[ASSOC](assoc.html) - Change file extension associations.  
[DISM](dism.html) /online /export-defaultappassociations  
[SetUserFTA](https://kolbi.cz/blog/2017/10/25/setuserfta-userchoice-hash-defeated-set-file-type-associations-per-user/) - Utility to set the file type association.  
Batch file to list the [application associated](fassoc.txt) with a file extension.  
[DirectInvoke](https://learn.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/dev-guides/jj215788(v=vs.85)) - Register MIME Types for direct invocation from a URL (legacy Internet Explorer feature) /o "%u"  
[Raymond Chen](https://devblogs.microsoft.com/oldnewthing/20170517-00/?p=96175) - Why do my PDF file associations get reset every time I restart?



/. nt/getmac.html
========================================================

    GetMac - Windows CMD - SS64.com

GetMac.exe
==========

Display the Media Access Control (MAC) address and list of network protocols associated with each address for all network cards in each computer, either locally or across a network.

Syntax

      GETMAC [/s _Computer_ [/u _Domain__User_ [/p _Password_]]]
         [/fo {TABLE|LIST|CSV}] [/nh] [/v]

Key
    /s _Computer_     The name or IP address of a remote computer
                  (do not use backslashes). Default = local computer.

    /u _Domain__User_  Run the command with the account permissions of the
                   user specified. Default = the currently logged on user.

    /p _Password_     The password of the user account that is specified in the /u parameter.

    /fo { TABLE | LIST | CSV } 
                   Format the output. Default = TABLE.

    /nh   Omit the header row from the displayed driver information.
         Valid when the /fo parameter is set to TABLE or CSV.

    /v    Display verbose information.

    /?    Display Help. 

### Examples

Show all MAC addresses in Table output:  
getmac /fo table /nh /v  
  
Show MAC addresses on server64  
getmac /s server64  
  
Show MAC addresses on server64 and authenticate as a different user:  
getmac /s server64 /u ss64Dom\user583  
  
Export a verbose listing of MAC addresses to a CSV file  
getmac /v /fo csv > T:\macaddresses.csv

PowerShell script to get the Mac address of the current machine:  
$Mac = getmac /fo csv | ConvertFrom-Csv

PowerShell script to collect Mac addresses for multiple machines by calling GetMac:

\# Create empty hash table
$macHash=@{}
# Load a list of machine names
$servers=get-content c:\batch\servers.txt
foreach ($server in $servers) {
    if (Test-Connection $server -quiet) {   # if it responds to a Ping
      # Call the GetMac utility
      $getmac=**getmac /nh /fo csv /s $server**
      $macAddresses=$getmac -split ","
      $interface = 1
      $macAddresses | foreach {
         if ($_ -ne ""){
            # check for a '-' to see if we have a mac address
            if ($_.substring(3,1) -eq "-") {
               # Remove quotes
               $addr = $_.replace("""","")
               $adapter = $interface/2
               Echo "$server  Adapter:$adapter  $addr"
               # Save in the hash variable
               $macHash.add("$server Adapter:$adapter",$addr)
            }
         }
      $interface += 1
      }
    }
}
# Export the hash table to a spreadsheet
$macHash.GetEnumerator() | select name, value | Sort-Object Name | Export-CSV -Path "c:\batch\macaddresses.csv" -NoTypeInformation

“I am the literary equivalent of a Big Mac and Fries” ~ Stephen King (Writer, best known for horror novels.)

### Related commands

[DevCon](devcon.html) - Device Manager Command Line Utility.  
WMI : Win32_NetworkAdapter  
PowerShell: [Get-NetAdapter](../ps/get-netadapter.html) - Get the basic network adapter properties.



/. nt/goto.html
========================================================

    Goto - Jump to label - Windows CMD - SS64.com

GOTO
====

Direct a batch program to jump to a labelled line.

Syntax

      GOTO _label_

      GOTO:eof

Key
    _label_   A predefined label in the batch program.
           Each label must be defined on a line by itself, beginning with
           a colon and ending with either a space, a colon or a CR/LF.

    :eof    This predefined label will exit the current subroutine or script.

Each GOTO… command must be terminated by a newline.

Although undocumented, GOTO :MySubroutine generally has the same effect as GOTO MySubroutine  
or GOTO:MySubroutine (a colon in place of the space)

EOF

> The eof label is a special case - using GOTO:eof will always transfer execution to the end of the current batch file or the end of the current subroutine.  
> This can be written as GOTO:eof or GOTO :eof the space is optional.
> 
> GOTO EOF and GOTO :EOF are not the same.  
> if you create a label called eof, the command GOTO:eof will still exit the file/routine and not jump to the label.
> 
> The command goto eof (without a colon) will jump to a label called eof, but to avoid confusion it is better to use a different name goto nextsub
> 
> When exiting a subroutine, an alternative command is [EXIT /b](exit.html)  
> EXIT /b has the option to set a specific [errorlevel](errorlevel.html), 0 for sucess, 1 or greater for an error.  
> EXIT /b without an ExitCode acts the same as goto:eof and will not alter the %errorlevel%

Errorlevels
-----------

> If the jump is successfully made [%ERRORLEVEL%](errorlevel.html) = _unchanged_, typically this will be 0 but if a previous command set an errorlevel, that will be preserved (this is a bug).
> 
> If the subroutine Label does not exist [%ERRORLEVEL%](errorlevel.html) = 1

### Examples

A simple goto jump:

GOTO sub-message
    Echo this wont display
goto:eof

:sub-message
    Echo this is a subroutine

Use the %1 [parameter](syntax-args.html) to jump:

IF %1==12 GOTO specialcase 
    Echo the input was NOT 12
goto:eof 
 
:specialcase
   Echo the input was  12
goto:eof

Use a variable as a label:
   
CHOICE /C:01 /m choose [Y]yes or [N]No 
    goto sub_%ERRORLEVEL% 
   
    :sub_0 
   Echo You typed Y for yes
goto:eof 

:sub_1
   Echo You typed N for no
goto:eof
 
Use a variable as a  [comment](rem.html)
In this example the COPY command will only run if the parameter "Update" is supplied to the batch:
   
    @Echo Off 
    Setlocal
    SET _skip=
    IF /I NOT %1==Update SET _skip=:: 
       
    %_skip% COPY x:\update.dat 
    %_skip% echo Update applied 
     ...


Bugs
----

> Using GOTO within parentheses - including FOR and IF commands - will break their context:
> 
> @echo off
> if A equ A **(**
>        GOTO :EXAMPLE_LABEL
>        :EXAMPLE_LABEL
>     **rem**
> **)** else (
>    echo You didn't expected to see this,did you?
> ) 
> 
> An alternative is to replace the GOTO with a [CALL](call.html) to a subroutine. The subroutine can contain GOTO statements as they will be safely outside the parentheses.
> 
> GOTO breaks the & and && [redirection](syntax-redirection.html) operators.
> 
> If GOTO a non existent label is used in conjunction with a negative [conditional](syntax-conditional.html) execution, the line containing the GOTO will be executed, but the rest of the Batch file is [cancelled](https://stackoverflow.com/questions/23327304/my-goto-redirect-is-not-working-but-works-with-echo):
> 
> goto :non_existent_label || Echo This line will run anything except GOTO ,SHIFT ,SETLOCAL , ENDLOCAL , CALL
> :SUBROUTINE echo This will be never displayed.
> 
> Just placing a :label within parentheses, can cause errors if the following line is not a valid command, [details on SO](https://stackoverflow.com/a/4006006/1720814).

GOTO is an [internal](syntax-internal.html) command. If [Command Extensions](cmd.html) are disabled GOTO will no longer recognise the :EOF label.

_“GOTO... how bad can it be??...” ~ [XKCD](https://xkcd.com/292/)_

### Related commands

[CALL](call.html) - Call one batch program from another.  
[EXIT](exit.html) - Quit the current script/routine and set an errorlevel.  
[IF](if.html) - Conditionally perform a command.  
Equivalent PowerShell: While (condition) {action} else {action}  
Equivalent bash command: [case](../bash/case.html) - Conditionally perform a command.



/. nt/gpresult.html
========================================================

    GPResult - Windows CMD - SS64.com

GPRESULT.exe
============

Display Resultant Set of Policy information for a remote user and computer.

Syntax

       gpresult [/s _Computer_ [/u [_Domain_\]_UserName_ [/p [_Password_]]]]
          [/user [_TargetDomain_\]_TargetUser_] [/scope {user | computer}]
             [/r | /v | /z] [[/x | /h] _FileName_ [/f]]

Key:
    /s        The name or IP address of a remote computer. Do not use backslashes.
             (default = the local computer)

    /u [\]    Run the command with the credentials of the specified user.
             (default = the currently logged on user)

    /p []     The password of the user account that is provided in the /u parameter.
             If /p is omitted, gpresult prompts for the password.

    /user [\] The remote user whose RSoP data is to be displayed.

    /scope {user | computer}
             Displays RSoP data for either the user or the computer.
             If /scope is omitted, gpresult displays RSoP data for both the userand the computer.

    [/x | /h] Save the report in either XML (/x) or HTML (/h) format at the location and
             with the file name specified by the _FileName_ parameter.
             Cannot be used with /u, /p, /r, /v, or /z.

    /f        Force gpresult to overwrite the file name specified in the /x or /h option.

    /r        Display RSoP summary data.

    /v        Display verbose policy information, including additional detailed settings that
             have been applied with a precedence of 1.

    /z        Display all available information about Group Policy, including detailed settings
             that have been applied with a precedence of 1 and higher.

    /?        Display help

The /f and /r options were introduced in Windows Vista/7/2008.

### Examples

C:> gpresult /z >C:\batch\policy.txt  
C:> gpresult /user targetusername /scope computer /r  
C:> gpresult /s srvmain /u ss64dom\hiropln /p p@ssW23 /user targetusername /scope user  
C:> gpresult /s srvmain /u ss64dom\hiropln /p p@ssW23 /user targetusername /z >policy.txt  
C:> gpresult /s srvmain /u ss64dom\hiropln /p p@ssW23

“The difference between false memories and true ones is the same as for jewels:  
it is always the false ones that look the most real, the most brilliant” ~ Salvador Dalí

### Related commands

[GPUPDATE](gpupdate.html) - Update Group Policy settings.  
[LGPO](lgpo.html) - Local Group Policy Object utility.  
[NTRIGHTS](ntrights.html) - Edit user account rights.



/. nt/gpupdate.html
========================================================

    gpupdate - Group Policy - Windows CMD - SS64.com

GPUPDATE.exe
============

Update Group Policy settings.

Syntax

       GPUpdate  [/Force] [/Logoff] [/Boot] [/Sync]
           [/Target:{Computer | User}] [/Wait:_value_]

Key:

    /Force         Apply all policy settings, not just those that have changed.

    /Logoff        Logoff after the Group Policy settings have been updated. 
                  Some group policy client-side extensions are only processed when a
                  user logs on. (Software Install, Folder Redirection.)

    /Boot          Restart after the Group Policy settings are applied. 
                  Some group policy client-side extensions are only processed at startup
                  (e.g. computer-targeted Software Install)

    /Sync          Apply the next foreground policy synchronously (in the background).
                  This can be applied to computer boot and/or user logon. (see /Target)

    /Target:       Update only User or only Computer policy settings
                  default = both

    /Wait:         The number of seconds to wait for policy processing.
                  '0'  = do not wait.
                  '-1' = wait indefinitely.
                  default = 600 (10 minutes)
                  If the time limit is exceeded, the command prompt returns, but policy
                  processing continues.

/Logoff and /Boot will have no effect if there are no client-side extensions called that require a logoff/reboot. /Force and /Wait parameters will be ignored if /sync is specified.

GPUPDATE will apply new and changed policies, it will not remove an existing setting where the policy is set to "not configured"

### Examples

Run a background update to install any new Group Policy settings:

C:> GPUpdate

Force a background update of all Group Policy settings, regardless of whether they have changed:

C:> GPUpdate /Force

_When the people are being beaten with a stick, they are not much happier if it is called "The People's Stick" - Mikhail Bakunin (Statism and Anarchy)_

### Related commands

[NTRIGHTS](ntrights.html) - Edit user account rights.  
[LGPO](lgpo.html) - Local Group Policy Object utility.  
[Copy and Merge Group Policies](https://learn.microsoft.com/en-gb/archive/blogs/ashleymcglone/updated-copy-and-merge-group-policies-gpos-with-powershell) (GPOs) with PowerShell [[script](https://github.com/Vexander/PowerShell-Jedi/blob/master/GPFunctions.ps1)]  
HKCU\Software\Microsoft\Windows\CurrentVersion\GroupPolicy\History  
HKLM\Software\Microsoft\Windows\CurrentVersion\GroupPolicy\History



/. nt/help.html
========================================================

    Help - Windows CMD - SS64.com

HELP
====

Online help for Microsoft Windows - most commands will give help when run with _COMMAND_ **/?** or _COMMAND_ **-?**  
Help will not detect if [Command Extensions](cmd.html) have disabled and will print help messages assuming the extensions are available.

  
GUI Help files (WINHELP and WINHLP32.exe) are **no longer supported in Windows 10** and will redirect to online help.

### Related commands

Equivalent PowerShell: [Get-Help](../ps/get-help.html) - Open the help file.  
Equivalent bash command (Linux): [man pages](../bash/).



/. nt/hostname.html
========================================================

    HOSTNAME - Windows CMD - SS64.com

HOSTNAME.exe
============

Display the host name portion of the full computer name of the computer.

Syntax

      HOSTNAME

Options

    /?    Display Help

The hostname command is only available if the Internet Protocol (TCP/IP) is installed as a network component.

The computer hostname is usually (but not always) the same as the %COMPUTERNAME% [variable](syntax-variables.html).

When called with any argument other than /? hostname sets errorlevel to 1 and prints an error message.

If the environment variable _CLUSTER_NETWORK_NAME_ exists and is populated, then HOSTNAME will return the value of that variable in place of the true Hostname.

### Examples

Display the system hostname:

C:> hostname

_“There's a little bit of magic in everything, and some loss to even things out” ~ Lou Reed_

### Related commands

echo %computername%  
Equivalent PowerShell cmdlet: $env:COMPUTERNAME  
Equivalent bash command: [hostname](../bash/hostname.html)



/. nt/icacls.html
========================================================

    iCacls - Modify Access Control List - Windows CMD - SS64.com

iCACLS.exe (2003 sp2, Vista+)
=============================

Change file and folder permissions - display or modify Access Control Lists (ACLs) for files and folders.  
iCACLS resolves various issues that occur when using the older CACLS & XCACLS.

Syntax

    Add or remove permissions:
      **ICACLS** _Name
        _ [**/grant**[:r] _User_:_Permission_[...]]
            [**/deny** _User_:_Permission_[...]]
               [**/remove**[:g|:d]] _User_[...]]
                  [**/inheritance**:e|d|r ]
                     [**/setintegritylevel** _Level_[...]]
                        [/T] [/C] [/L] [/Q]

    Store ACLs for one or more directories matching _name_ into _aclfile_ for later use with /restore:
      **ICACLS** _name_ **/save** _aclfile_ [/T] [/C] [/L] [/Q]
    
    Restore ACLs to all files in _directory_:
      **ICACLS** _directory_ [/substitute _SidOld SidNew_ [...]]
          **/restore** _aclfile_ [/C] [/L] [/Q]

    Change Owner:
      **ICACLS** _name_ **/setowner** _user_ [/T] [/C] [/L] [/Q]

    Find items with an ACL that mentions a specific SID:
      **ICACLS** _name_ **/findsid** _Sid_ [/T] [/C] [/L] [/Q]

    Find files whose ACL is not in canonical form or with a length inconsistent with the ACE count:
      **ICACLS** _name_ **/verify** [/T] [/C] [/L] [/Q]
 
    Replace ACL with default inherited acls for all matching files:
      **ICACLS** _name_ **/reset** [/T] [/C] [/L] [/Q]
    This is equivalent to “Replace all child permission entries with inheritable permission from this object” in the GUI.

Key
    _name_  The File(s) or folder(s) the permissions will apply to.

    /T  Traverse all subfolders to match files/directories. This will apply permission changes to
       all subfolders whether or not they are set to inherit permissions from the parent. On very large
       directory structures this may take some time as the command has to traverse the entire tree.
   
    /C  Continue on file errors (access denied) Error messages are still displayed.
  
    /L  Perform the operation on a symbolic link itself, not its target.

    /Q  Quiet - supress success messages.

    /grant _:r user:permission_
       Grant access rights, with :r, the permissions
       will **r**eplace any previouly granted explicit permissions (for the given user).
       Otherwise the permissions are added.

    /deny _user:permission_
       Explicitly deny the specified user access rights.
       This will also remove any explicit grant of the 
       same permissions to the same user.

    /remove[:[g|d]] _User_ 
       Remove all occurrences of _User_ from the acl. 
       :g remove all **granted** rights to that User/Sid.
       :d remove all **denied** rights to that User/Sid.

    /inheritance:e|d|r
          e - Enable inheritance
          d - Disable inheritance and copy the ACEs 
          r - Remove all inherited ACEs

    /setintegritylevel [(CI)(OI)]_Level_ 
       Add an integrity ACE to all matching files. 
       _level_ is one of L,M,H (Low Medium or High)

             Mandatory Label\Low Mandatory Level    = Low.
             Mandatory Label\Medium [Mandatory](https://docs.microsoft.com/en-us/windows/win32/secauthz/mandatory-integrity-control) Level = Medium/Standard.
             Mandatory Label\High Mandatory Level   = [Elevated](syntax-elevate.html).

             If No mandatory label is displayed in the output, it is Medium by default. 

       A Directory Inheritance option for the integrity ACE can precede the level
       and is applied only to directories:

    _user_   A user account, Group or a SID

    /restore  Apply the acls stored in _ACLfile_ to the files in _directory_

    _permission_ is a permission mask and can be specified in one of two forms:
        a sequence of simple rights:
                D - Delete access
                F - Full access (Edit_Permissions+Create+Delete+Read+Write)
                N - No access
                M - Modify access (Create+Delete+Read+Write)
                RX - Read and eXecute access
                R - Read-only access
                W - Write-only access
        a comma-separated list in parentheses of specific rights:
                DE - Delete
                RC - read control
                WDAC - write DAC
                WO - write owner
                S - synchronize
                AS - access system security
                MA - maximum allowed
                GR - generic read
                GW - generic write
                GE - generic execute
                GA - generic all
                RD - read data/list directory
                WD - write data/add file
                AD - append data/add subdirectory
                REA - read extended attributes
                WEA - write extended attributes
                X - execute/traverse
                DC - delete child
                RA - read attributes
                WA - write attributes
        inheritance rights can precede either form and are applied
        only to directories:
                (OI) - object inherit
                (CI) - container inherit
                (IO) - inherit only
                (NP) - don’t propagate inherit
                (I)  - Permission inherited from parent container

Unlike earlier command-line tools, iCACLS correctly preserves the canonical ordering of ACE entries:

1.  Explicit Deny
2.  Explicit Grant
3.  Inherited Deny
4.  Inherited Grant

Access Control Lists apply only to files stored on an NTFS formatted drive, each ACL determines which users (or groups of users) can read or edit the file. When a new file is created it normally inherits ACL's from the folder where it was created.

An access control list (ACL) is a list of access control entries (ACE). When backing up or restoring an ACL with iCACLS, you must do so for an entire directory (using /save and /restore) even if you are only interested in the ACEs for a few individual files. In practice most permissions are set at the per-directory level.

Multiple /Grant /Deny /Remove clauses can be included in a single icacls command, on a large directory tree this has the advantage that the tree only has to be traversed once, rather than multiple times if you were to issue several consecutive icacls commands instead.

The ability to delete or rename a _folder_ is decided by a combination of the Delete permissions on the folder in question, plus the Delete subfolders and files permission on the parent folder.

Modify vs Full control
----------------------

*   To _edit_ a file you must have the "Modify/Change" ACL (or be the file's owner)  
    
*   To use the iCACLS command to change the _permissions_ of a file requires "FULL Control" (or be the file's owner)  
    
*   File "Ownership" will always override all ACL's - you always have Full Control over files that you create.

Inheritance
-----------

> Inherited folder permissions are given as:
> 
>  OI - Object inherit    - This folder and files. (no inheritance to subfolders)
>  CI - Container inherit - This folder and subfolders.
>  IO - Inherit only      - The ACE does not apply to the current file/directory
> 
> These can also be combined as follows:
>  (OI)(CI)      This folder, subfolders, and files.
>  (OI)(CI)(IO)  Subfolders and files only.
>      (CI)(IO)  Subfolders only.
>  (OI)    (IO)  Files only. 
> 
> So BUILTIN\Administrators:(OI)(CI)F means that both files and Subdirectories will inherit 'F' (Full control)  
> similarly (CI)R means Directories will inherit 'R' (Read folders only = List permission)
> 
> It is worth spending some time working out which permissions can be inherited and which need to be applied directly. On large/complex directory structures, minimising the number of ACLs can improve fileserver performance.
> 
> If inheritance is combined with /T (traverse subfolders) the change will apply to all folders, not just the top level.  
> for example:  
> icacls "C:\demo\example" /inheritance:**e** /T  
> Will traverse all subfolders below"C:\demo\example" and **e**nable the inheritance for every one, this will replace any inheritance permissions that have been removed.
> 
> If no inheritance is specified, inheritance rules will not be changed but existing _inherited_ permissions will be re-applied to existing objects in the specified location for the specified users/groups.  
> for example:  
> icacls "C:\demo\example" /grant administrators:(F) /T  
> This is similar to applying /reset to the child items of "C:\demo\example" but only resets the administrators group.
> 
> By default, an object will inherit permissions from its parent object, either at the time of creation or when it is copied or moved. The only exception to this rule occurs when you **move** an object to a different folder on the same volume. In this case, the original permissions are retained. In controlled environments this ensures that users cannot change file permissions by just moving items to a different folder. This behaviour can be disabled by setting a system-wide registry key, see [Q310316](https://learn.microsoft.com/en-GB/troubleshoot/windows-client/windows-security/permissions-on-copying-moving-files).

Built-In Groups
---------------

> A command which addresses a built-in group by name like ICACLS _foldername_ /GRANT **Everyone**:F /T  
> will only work when the system language is English.
> 
> To make this language independent, use an asterisk followed by the well-known SID for the group, see [Q243330](https://support.microsoft.com/en-us/kb/243330) for a list.
> 
> For example, to grant full control to Everyone on a folder: ICACLS _foldername_ /GRANT ***S-1-1-0**:F /T

Running icacls under PowerShell
-------------------------------

> The options for icacls do not run easily under [PowerShell](../ps/), because brackets ( ) have a special meaning in PowerShell, to pass a bracket symbol to an external program it must be [escaped](../ps/syntax-esc.html) with a backtick.  
> Alternatively, use the stop-parsing symbol --%  
> e.g. : icacls "C:\demo\" --% /grant:r Administrators:(OI)(CI)**F** /T
> 
> A more 'PowerShell' approach which gives improved readability for complex icacls commands, is to set a variable for each option and then execute icacls with [Invoke-Expression](../ps/invoke-expression.html) which will expand all the variables:
> 
> \# Set PS variables for each of the icacls options
> $Path = "c:\demo"   #The path must be the first thing passed to icacls
> $Grant = "/grant:r"
> $Remove = "/remove"
> $replaceInherit = "/inheritance:r"
> $permission = ":(OI)(CI)(F)"
> $useraccount1 = "ss64dom\simon"
> $useraccount2 = "administrators"
> 
> # Run icacls using invoke Expression
> Invoke-Expression -Command ('icacls $Path $replaceInherit $Grant "${useraccount1}${permission }"')

### Examples

Change the NTFS permissions on C:\demo\example\, remove all existing inherited permissions and replace with **F**ull control for the Administrators group and Change/**M**odify permission for jsmith.  
Apply the new permissions to the folder and inherit down to subfolders and files (OI)(CI):

icacls "C:\demo\example" /inheritance:r /grant:r Administrators:(OI)(CI)**F**  
icacls "C:\demo\example" /grant:r Administrators:(OI)(CI)**F** /T  
icacls "C:\demo\example" /grant:r ss64Dom\jsmith:(OI)(CI)**M** /T

or you can combine grants like:

icacls "C:\demo\example" /grant:r Administrators:(OI)(CI)**F** /T /grant:r ss64Dom\jsmith:(OI)(CI)**M** /T

View the permissions currently set on a folder:

icacls "C:\demo\example"

Grant the group FileAdmins '**D**elete' and '**W**rite **DAC**' permissions to C:\demo\example:

icacls "C:\demo\example" /grant:r FileAdmins:(**D,WDAC**)

Reset permissions on all child items below C:\demo\example\, note the use of *, without that, the permissions would be reset to those of C:\demo\

icacls "C:\demo\example*" /c /t /reset

Propagate a new permission to all files and subfolders of C:\demo\example\, without using inheritance:  
(so if any of the subfolders contain specific permissions, those won’t be overwritten)

icacls "C:\demo\example" /grant:r accountName:(NP)(RX) /T

Backup the ACLs of every file in the current directory:

icacls * /save Myacl_backup.txt

Restore ACLS using a previously saved acl file:

icacls /restore Myacl_backup.txt

Change the Integrity Level (IL) of a file to High:  
  
icacls MyReport.doc /setintegritylevel H  
  
Remove all inheritance on the 'Demo' folder and grant access to the domain user 'Volta', in this command the /t will traverse existing subfolders and files, and the (CI) will ensure that new folders/files added in future will inherit these permissions:

> icacls C:\demo\example /inheritance:r /grant SS64dom\Volta:(CI)F /t

Grant the user jdoe rights to create, edit and delete files in the folder C:\demo\example\, but prevent deletion of the folder itself:

> :: First remove inheritance and grant admins **F**ull control to the top folder  
> icacls "C:\demo\example" /inheritance:r /grant:r administrators:(OI)(CI)(**F**)
> 
> :: Grant **M**odify + **D**elete **C**hild to subfolders and files only  
> icacls "C:\demo\example" /grant:r ss64Dom\jdoe:(OI)(CI)(IO)(**M,DC**) /T
> 
> :: Grant **R**ead/E**x**ecute, **W**rite and **A**ppend to the top level folder  
> icacls "C:\demo\example" /grant:r ss64Dom\jdoe:(**RX,WD,AD**)
> 
> :: if any pre-existing subfolders Grant admins **F**ull control  
> icacls "C:\demo\example" /grant:r administrators:(OI)(CI)(**F**) /T
> 
> The above does set the correct permissions, but an undesired bug/side effect is that within the top level folder the Windows Explorer right click option to create New files will be empty - only _New Folder_ is shown:
> 
> ![Right Click - New is empty](icacls.png)

“It's easier to ask forgiveness than it is to get permission” ~ Rear Admiral Grace Hopper

### Related commands

[ATTRIB](attrib.html) - Display or change file attributes.  
[CACLS](cacls.html) - Change file permissions.  
[DIR /Q](dir.html) - Display the owner for a list of files (try it for Program files) .  
[FSUTIL](fsutil.html) - File System Options.  
[NTRIGHTS](ntrights.html) - Edit user account rights.  
[PERMS](perms.html) - Show permissions for a user.  
[TAKEOWN](takeown.html) - Take ownership of file(s).  
[XCACLS](xcacls.html) - Display or modify Access Control Lists (ACLs) for files and folders.  
[SetObjectSecurity](setobjectsecurity.html) - Set security for an object (file, directory, reg key etc).  
[Syntax-Permissions](syntax-permissions.html) - Explanation of permissions.  
[Q243330](https://support.microsoft.com/en-gb/help/243330/) - Well-known security identifiers (sids) in Windows operating systems.  
[Q220167](https://web.archive.org/web/20120713100042/https://support.microsoft.com/kb/220167) - Understanding Container Access Inheritance Flags.  
[Q310316](https://learn.microsoft.com/en-GB/troubleshoot/windows-client/windows-security/permissions-on-copying-moving-files) - Force Copy Acl with File.  
[AccessEnum](https://docs.microsoft.com/en-gb/sysinternals/downloads/accessenum) - SysInternals GUI to browse a tree view of user permissions.  
SetObjectSecurity.exe - Coming soon as part of the Security Compliance Toolkit.  
PowerShell equivalent: [Get-Acl](../ps/get-acl.html) / [Set-Acl](../ps/set-acl.html) - Set permissions.  
Equivalent bash command (Linux): [chmod](../bash/chmod.html) / [chown](../bash/chown.html) - Change file permissions/owner and group.



/. nt/iexpress.html
========================================================

    iexpress - Windows CMD - SS64.com

IEXPRESS.exe
============

Create a self extracting ZIP file archive. iexpress 2.0 must be run with [elevated](syntax-elevate.html) permissions.

Syntax

      IEXPRESS [ /N [/Q] [/M] ] _[SED_filename](iexpress-sed.html)_
         [/O:_Override_SED_filename_, _OverrideSectionName_] [/D:directory]

Key:

  /N   Build package now (SED filename must be specified).
  /Q   Quiet mode when using /N
  /M   Use minimised windows when using /N
  /O   Specify overrideSED file and section.
  /D   Override directory for exe stub.

When running the created self extracting archive, the following options can be used:

  /Q            Quiet mode, No prompts and no errors.

  /QA or /Q:A   Quiet + Assume the person running the app is admin so do not check for admin rights or disk space.[Build 306+]
                Supress all prompt messages.

  /QU or /Q:U   Quiet + Assume the person running the app is an non-admin user. [Build 306+]
                Supress some prompt messages. No extract UI, but still get warnings on admin checks or disk space issues.
                Used when IExpress packages are shipped on CDs or installed through ActiveSetup.

  /T:_Full_path_    A Temporary working folder.
  /C            Extract files only, when used with /T
  /C:_cmd_        Override the install command defined by the author.

  /R:N    Never restart the computer after installation.
  /R:A    Ask to restart the computer after installation.
  /R:S    Restart the computer after installation without prompting the user.

Running IExpress with no options will launch a GUI wizard**.**

The error message "_Unable to open the report file_..." typically means that iexpress needs to be elevated.

iexpress.exe has shipped with all Windows OSs since at least 2008. Early versions of iexpress were supplied with the Internet Explorer administration kit (IE 5 and IE 6) in 1999.

The self extracting bundle created will be dependent on the source OS bitness (32 or 64 bit), so if you create a self-extracting archive of 64 bit programs, they won’t run (extract) on a 32 bit computer.

### Examples

Create a zip archive:

iexpress.exe

Extract an archive, run any installation program specified and then prompt to reboot:

demo.exe /R:A

Extract package.exe and then run setup /s (which is embedded inside package.exe):

Package.exe /Q /C:"setup.exe /s"

Alternatively in build 306, the package.exe can be built with the install command predefined: (UserQuietInstCmd=Setup.exe /s) then launching becomes a simple:

Package.exe /QU

“He can compress the most words into the smallest ideas of any man I ever met” ~ Abraham Lincoln (attr.)

### Related commands

[INF + SED](http://www.mdgx.com/INF_web/) (Self Extraction Directive) file functions.  
[iespresso](https://github.com/markgollnick/iespresso) - tools for creating more useful iexpress.exe packages.  
[COMPACT](compact.html) - Compress files or folders on an NTFS partition.  
[COMPRESS](compress.html) - Compress one or more files.  
[MAKECAB](makecab.html) - Create .CAB files.  
[TAR](tar.html) - Store, list or extract files in an archive.  
[Compress-Archive](../ps/compress-archive.html) - PowerShell.  
[Zip a file](https://superuser.com/questions/110991/) - using only built-in Batch/VBS commands (Superuser.com)



/. nt/if.html
========================================================

    If - Conditionally perform command - Windows CMD - SS64.com

IF
==

Conditionally perform a command.

**File syntax**
    IF [NOT] EXIST _filename command_

    IF [NOT] EXIST _filename_ (_command_) ELSE (_command_)

**String syntax**
    IF [/I] [NOT] **_item1_**==**_item2_** _command_
    IF [/I] [NOT] "**_item1_**" == "**_item2_**" _command_

    IF [/I] **_item1_** _compare-op_ **_item2_** _command_

    IF [/I] **_item1_** _compare-op_ **_item2_** (_command_) ELSE (_command_)

**Error Check Syntax**
    IF [NOT] DEFINED _variable command_

    IF [NOT] [ERRORLEVEL](errorlevel.html) _number command_ 

    IF CMDEXTVERSION _number command_

**key**
    _item_        A text string or environment variable, for more complex
               comparisons, a variable can be modified using
               either [Substring](syntax-substring.html) or [Search syntax](syntax-replace.html).

    _command_     The command to perform.

    _filename_    A file to test or a [wildcard](syntax-wildcards.html) pattern.

    NOT         Perform the command if the condition is false. 

    **==**          Perform the command if the two strings are equal. 

    /I          Do a case Insensitive string comparison.

    _compare-op_  can be one of
                EQU : Equal
                NEQ : Not equal

                LSS : Less than <
                LEQ : Less than or Equal <=

                GTR : Greater than >
                GEQ : Greater than or equal >=

                This 3 digit syntax is necessary because the > and <
                symbols are recognised as redirection operators

IF will only parse numbers when one of ([EQU](equ.html), [NEQ](neq.html), [LSS](lss.html), [LEQ](leq.html), [GTR](gtr.html), [GEQ](geq.html)) is used.  
The == comparison operator always results in a string comparison.

Compare strings that contain Spaces by using "double quotes"
------------------------------------------------------------

> The IF command can seem flaky if any spaces exist in the comparison strings. for example these commands all seem like they work:
> 
> > IF 'ab'=='a b' Echo OK  
> > IF [ab]==[a b] Echo OK  
> 
> But if you reverse the logic to see if they are **not** equal, the code will fail and thow an error:
> 
> > IF 'ab' NEQ 'a b' Echo OK  
> > IF [ab] NEQ [a b] Echo OK  
> 
> Similarly this will fail:
> 
> > IF 'a b'=='a b' Echo OK
> 
> The problem with the above, is that single quotes have **no** special meaning to CMD, so when it reaches a space it assumes that's the end of the string.
> 
> These versions using double quotes will all work:
> 
> > IF "ab"=="a b" Echo OK  
> > IF "ab" NEQ "a b" Echo OK  
> > IF NOT "ab" == "a b"
> 
> So then you think, OK I'll just use double quotes. However there is one remaining gotcha, if the item you are comparing is a quoted filename, so it already contains double quotes, you have an [escape](syntax-esc.html) sequence:
> 
> IF ""long filename"" EQU "something" Echo OK
> 
> That will break because the "" acts as an escape. To prevent that from happening strip any quotes from the strings being compared.
> 
> In addition to spaces, the above applies to all other [delimiters](syntax-esc.html) [Comma],[Semicolon], [Equals], [Space] [Tab].  
> Either the delimiters must be individually escaped with a caret ^ or the whole string must be "quoted".

Test if a variable is empty
---------------------------

> To test for the existence of a [command line parameter](syntax-args.html) - use empty brackets like this:  
>   
> IF [%1]==[] ECHO Value Missing  
> or  
> IF [%1] EQU [] ECHO Value Missing  
>   
> When comparing against a variable that may be empty, we include a pair of brackets [ ] so that if the variable does happen to be empty the IF command still has something to compare: IF [] EQU [] will return True.
> 
> You can in fact use almost any character for this a '~' or curly brackets, { } or even the number 4, but square brackets tend to be chosen because they don’t have any special meaning.  
> When working with filenames/paths you should always surround them with quotes, if %_myvar% contains "C:\Some Path" then your comparison becomes IF ["C:\Some Path"] EQU []  
> if %_myvar% could contain empty quotes, "" then your comparison should become IF [%_myvar%] EQU [""]  
>   
> if %_myvar% will _never_ contain quotes, then you can use quotes in place of the brackets IF "%_myvar%" EQU ""  
> However with this pattern if %_myvar% does unexpectedly contain quotes, you will get IF ""C:\Some Path"" EQU "" those doubled quotes, act as an [escape](syntax-esc.html) and will break the comparison.  

Test if a variable is NULL
--------------------------

> In the case of a variable that might be NULL - a null variable will remove the variable definition altogether, so testing for a NULL becomes:  
>   
> IF NOT DEFINED __example_ ECHO Value Missing  
>   
> IF DEFINED will return true if the variable contains any value (even if the value is just a space).
> 
> To test for the existence of a variable use [SET](set.html) _VariableName_, or IF DEFINED _VariableName_

Test the existence of files and folders
---------------------------------------

> IF EXIST _filename_   Will detect the existence of a file or a folder.
> 
> The script [empty.cmd](syntax-empty.html) will show if the folder is empty or not (this is not case sensitive).

Parenthesis
-----------

> [Parenthesis](syntax-brackets.html) can be used to split commands across multiple lines. This enables writing more complex IF… ELSE… commands:
> 
> IF EXIST filename.txt **(**
>     Echo deleting filename.txt
>     Del filename.txt
>  **)** ELSE **(** 
>     Echo The file was not found.
>  **)**
> 
> When combining an [ELSE](else.html) statement with parentheses, always put the opening parenthesis on the same line as [ELSE](else.html).  
>  **)** ELSE **(**   This is because CMD does a rather primitive one-line-at-a-time parsing of the command.
> 
> When using parentheses the CMD shell will expand [read] all the [variables](syntax-variables.html) at the beginning of the code block and use those values even if the variables value has just been changed. Turning on [DelayedExpansion](delayedexpansion.html) will force the shell to read variables at the start of every line.

Pipes
-----

> When [piping](syntax-redirection.html) commands, the expression is evaluated from left to right, so
> 
> IF _SomeCondition_ _Command1_ | _Command2_ is equivalent to:
> 
> (IF _SomeCondition_ _Command1_ ) | _Command2_  
> The pipe is always created and _Command2_ is always run, regardless whether _SomeCondition_ is TRUE or FALSE
> 
> You can use brackets and [conditionals](syntax-redirection.html) around the _command_ with this syntax:
> 
> IF _SomeCondition_ (_Command1_ | _Command2_)  
> If the condition is met then Command1 will run, and its output will be piped to Command2.
> 
> The IF command will interpret brackets around a _**condition**_ as just another character to compare (like # or @) for example:  
> IF **(**%_var1%==**(**demo Echo the variable _var1 contains the text demo
> 
> Placing an IF command on the right hand side of a pipe is also possible but the CMD shell [is buggy in this area](https://stackoverflow.com/questions/36763782/why-does-the-error-message-appear-when-if-comparison-is-in-the-piped-block-com) and can swallow one of the delimiter characters causing unexpected results.  

Chaining IF commands (AND).
---------------------------

> The only logical operator directly supported by IF is NOT, so to perform an AND requires chaining multiple IF statements:
> 
> IF _SomeCondition_ (
>    IF _SomeOtherCondition_ (
>      _Command_if_both_are_true_
>    )
> )

If either condition is true (OR)
--------------------------------

> This can be tested using a temporary variable:
> 
> Set "_tempvar="  
> If _SomeCondition_ Set "_tempvar=1"  
> If _SomeOtherCondition_ Set "_tempvar=1"  
> if %_tempvar% EQU 1 _Command_to_run_if_either_is_true_

Test Numeric values
-------------------

> IF only parses _numbers_ when one of the compare-op operators (EQU, NEQ, LSS, LEQ, GTR, GEQ) is used.  
> The == comparison operator always results in a _string_ comparison.
> 
> This is an important difference because if you compare numbers as strings it can lead to unexpected results: "2" will be greater than "19" and "026" will be less than "10".
> 
> Correct numeric comparison:  
> IF 2 GEQ 15 echo "bigger"
> 
> Using parentheses or quotes will force a string comparison:  
> IF (2) GEQ (15) echo "bigger"  
> IF "2" GEQ "15" echo "bigger"  
> 
> This behaviour is exactly opposite to the [SET](set.html) /a command where quotes are required.
> 
> IF should work within the full range of 32 bit signed integer numbers (-2,147,483,648 through 2,147,483,647)
> 
> C:> if 2147483646 GEQ 2147483647 (Echo Larger) Else (Echo Smaller)  
> Smaller   ⇨ correct
> 
> C:> if 2147483647 GEQ 2147483648 (Echo Larger) Else (Echo Smaller)  
> Larger   ⇨ wrong due to overflow
> 
> C:> if -2147483649 GEQ -2147483648 (Echo Larger) Else (Echo Smaller)  
> Larger   ⇨ wrong due to overflow
> 
> You can perform a string comparison on very long numbers, but this will only work as expected when the numbers are exactly the same length:
> 
> C:> if "2147483647" GEQ "2147483648" (Echo Larger) Else (Echo Smaller)  
> Smaller   ⇨ correct

Wildcards
---------

> Wildcards are not supported by IF, so %COMPUTERNAME%==SS6* will not match SS64  
>   
> A workaround is to retrieve the [substring](syntax-substring.html) and compare just those characters:  
> SET _prefix=%COMPUTERNAME:~0,3%  
> IF %_prefix%==SS6 GOTO they_matched

ERRORLEVEL
----------

> There are two different methods of checking an errorlevel, the first syntax ( IF ERRORLEVEL ... ) provides compatibility with ancient batch files from the days of Windows 95.  
> The second method is to use the %ERRORLEVEL% variable available in Windows 2000 or newer.
> 
> IF ERRORLEVEL _n_ statements should be read as IF _Errorlevel_ >= _number_  
> i.e.  
> IF ERRORLEVEL 0 will return TRUE whether the errorlevel is 0, 1 or 5 or 64  
> IF ERRORLEVEL 1 will return TRUE whether the errorlevel is 1 or 5 or 64  
> IF NOT ERRORLEVEL 1 means if ERRORLEVEL is less than 1 (Zero or negative).  
> This is not very readable or user friendly and does not easily account for negative error numbers.
> 
> Using the %ERRORLEVEL% variable is a more logical method of checking Errorlevels:
> 
> IF %ERRORLEVEL% NEQ 0 Echo An error was found  
> IF %ERRORLEVEL% EQU 0 Echo No error found  
>   
> IF %ERRORLEVEL% EQU 0 (Echo No error found) ELSE (Echo An error was found)  
> IF %ERRORLEVEL% EQU 0 Echo No error found [||](syntax-conditional.html) Echo An error was found
> 
> This allows you to trap errors that can be negative numbers, you can also test for specific errors:  
> IF %ERRORLEVEL% EQU 64 ...  
> 
> To deliberately raise an ERRORLEVEL in a batch script use the [EXIT /B](exit.html) command.
> 
> It is possible (though not a good idea) to create a string variable called %ERRORLEVEL% (user variable)  
> if present such a variable will override and prevent the system variable %ERRORLEVEL% from being read by commands such as ECHO and IF.

If [Command Extensions](cmd.html) are disabled IF will only support direct comparisons: IF ==, IF EXIST, IF ERRORLEVEL  
also the system variable CMDEXTVERSION will be disabled.

In early versions of Windows NT/XP comparisons made using == would include the spaces before and after the ==, so for backwards compatibility you will still see commands written as IF alpha==beta rather than IF alpha == beta

IF does not, by itself, set or clear the [Errorlevel](errorlevel.html).

### Examples

IF EXIST C:\logs*.log (Echo Log file exists)

IF EXIST C:\logs\install.log (Echo Complete) ELSE (Echo failed)

IF DEFINED _department ECHO Got the _department variable

IF DEFINED _commission SET /A "_salary=%_salary% + %_commission%"

IF CMDEXTVERSION 1 GOTO start_process

IF %ERRORLEVEL% EQU 2 goto sub_problem2

IF is an [internal](syntax-internal.html) command.

_You see things; and you say 'Why?' But I dream things that never were; and I say 'why not?' ~ George Bernard Shaw_

### Related commands

[Using parentheses](https://ss64.com/nt/syntax-brackets.html) to group and expand expressions.  
[Conditional execution](syntax-conditional.html) syntax (AND / OR)  
[SET](set.html) - Display or Edit environment variables.  
[ECHO](echo.html) - Display message on screen.  
[EXIT](exit.html) - Set a specific ERRORLEVEL.  
[IFMEMBER](ifmember.html) - group member (Resource kit).  
[SC](sc.html) - Is a Service running (Resource kit).  
Equivalent PowerShell: [IF -](../ps/if.html) Conditionally perform a command.  
Equivalent bash command (Linux): [if -](../bash/if.html) Conditionally perform a command.



/. nt/ifmember.html
========================================================

    ifmember - Windows CMD - SS64.com

IFMEMBER ([Windows 2003 Resource Kit](../links/windows.html#kits))
==================================================================

Find out if the current user is a member of one or more groups.

Syntax

      IFMEMBER [_options_] _Group_ [ _Group2 Group3_...]

Options:
        /verbose or /v   : print all matches.
        /list    or /l   : print all groups user is a member of

The %ERRORLEVEL% return code shows how many of the listed groups the currently logged-in user is a member of.

To also test for nested permissions use [VBScript](../vb/syntax-ismember.html) or PowerShell [Get-adGroupMember](../ps/get-adgroupmember.html).

### Examples

IFMEMBER /v /l "MyDomain\Administrators"  
IF ERRORLEVEL 1 echo This user is an Administrator  
  
Notice that the syntax here is the opposite to most other commands in that an %errorlevel% of 1 = Success  
  
A good way to utilise IFMEMBER is through [conditional](syntax-conditional.html) execution...  
  
IFMEMBER Administrators || ECHO Error is 1 so [%Username%] is an Admin  
  
IFMEMBER Administrators && ECHO Error is 0 so [%Username%] is NOT an Admin

“The euro will raise the citizens' awareness of their belonging to one Europe more than any other integration step to date” ~ Gerhard Schroeder

### Related commands

[NET](net.html) GROUP - Add or remove a user from a group.  
[Joeware.net](https://www.joeware.net/freetools/) - MemberOf.exe - Like IFMEMBER but able to handle nested AD groups.



/. nt/ipconfig.html
========================================================

    ipconfig - IP configuration command - Windows CMD - SS64.com

IPCONFIG
========

Configure IP (Internet Protocol configuration)

Syntax


    IPCONFIG /all          Display full configuration information.

    IPCONFIG /release [_adapter_]
                          Release the IPv4 address for the specified adapter.
    IPCONFIG /release6 [_adapter_]
                          Release the IPv6 address for the specified adapter.

    IPCONFIG /renew [_adapter_]
                          Renew the IPv4 address for the specified adapter.
    IPCONFIG /renew6 [_adapter_]
                          Renew the IPv6 address for the specified adapter.

    IPCONFIG /flushdns     Purge the DNS Resolver cache.

    IPCONFIG /registerdns  Refresh all DHCP leases and re-register DNS names.

    IPCONFIG /displaydns   Display the contents of the DNS Resolver Cache.

    IPCONFIG /showclassid _adapter_
                          Display all the DHCP class IDs allowed for _adapter_.
    IPCONFIG /showclassid6 _adapter_
                          Display all the IPv6 DHCP class IDs allowed for _adapter_.

    IPCONFIG /setclassid _adapter_ [_classid_]
                          Modify the DHCP class id.
    IPCONFIG /setclassid6 _adapter_ [_classid_]
                          Modify the IPv6 DHCP class id.

    IPCONFIG /?            Display help.

If the Adapter name contains spaces, use quotes: "Adapter Name"  
Wildcard characters * and ? are allowed, see the examples below  
  
The default is to display only the IP address, subnet mask and default gateway for each adapter bound to TCP/IP.  
  
For Release and Renew, if no adapter name is specified, then the IP address leases for all adapters bound to TCP/IP will be released or renewed.

If you remote into a computer and run ipconfig /release it will kill your connection  
  
For setclassid, if no CLASS ID is specified, then the CLASS ID is removed.

DHCP User Classes allow additional or modified DHCP options to be applied to a subset of computers on the network, as identified by a CLASS ID. For example, a different gateway, DNS server, or lease time.  
This requires configuring the CLASS ID appropriately on the DHCP server. see [RFC 3004](https://tools.ietf.org/html/rfc3004)

### Examples

Show detailed information  
C:> ipconfig /all

Release and Renew all adapters:  
ipconfig /release  
ipconfig /renew

Release and Renew all adapters - one liner for remote use:  
ipconfig /release && ipconfig /renew

Renew any connection that has a name starting with EL:  
ipconfig /renew EL*  
  
Release all connections matching *Con*, eg. "Local Area Connection 1" or "Local Area Connection 2":  
ipconfig /release *Con*  
  
Set the DHCP class ID for the named adapter to TEST:  
ipconfig /setclassid "Local Area Connection" TEST

“Life is a grand adventure – or it is nothing” ~ Helen Keller

### Related commands

[BROWSTAT](browstat.html) - Get domain, browser and PDC info.  
[NETSTAT](netstat.html) - Display networking statistics (TCP/IP).  
[NETSH](netsh.html) - Configure interfaces, routing protocols, filters, routes, RRAS.  
[PATHPING](pathping.html) - IP trace utility.  
[PING](ping.html) - Test a network connection.  
Configure the [hosts](../hosts.html) file to redirect or block urls.  
[Q813878](https://web.archive.org/web/20130305115143/https://support.microsoft.com/kb/813878) - How to block specific network protocols and ports.  
[Q313190](https://web.archive.org/web/20140403101053/https://support.microsoft.com/kb/313190) - Use [IPSec](https://docs.microsoft.com/en-us/previous-versions/system-center/operations-manager-2005/cc179879(v=technet.10)?redirectedfrom=SS64) IP Filter Lists.  
[Domain Name System](https://docs.microsoft.com/en-us/previous-versions/technet-magazine/cc160825(v=msdn.10)?redirectedfrom=SS64) - docs.microsoft.com  
[ipchicken](https://www.ipchicken.com/) - Display your current IP.  
Equivalent bash command (Linux): [ifconfig](../bash/ifconfig.html) - IP configuration, dhcpcd, lookupd -flushcache.  
Equivalent bash command (MacOS): ipconfig / [dscacheutil](../osx/dscacheutil.html) - View IP config / Query / flush the Directory Service cache.  
Equivalent PowerShell commands:[  
Get-NetIPAddress](../ps/get-netipaddress.html) - Get IPAddress configuration.  
[Clear-DnsClientCache](../ps/clear-dnsclientcache.html) - Clear the content of the DNS client cache.



/. nt/inuse.html
========================================================

    Inuse - Windows CMD - SS64.com

INUSE.exe (Windows 2000/2003 [Resource Kit](../links/windows.html) – [download](https://download.microsoft.com/download/win2000platform/inuse/1.0/NT5/EN-US/inuse.exe))
=======================================================================================================================================================================

Replace files that are currently in use by the OS, requires a reboot.

Inuse is deprecated, and is not guaranteed to be supported in future releases of Windows.

Syntax

      INUSE _source destination_ [/y]

Key

  _source_         The new/replacement file.

  _destination_    The existing file to be replaced.

  /y             Suppress the confirmation prompt.

  /?             help

Source and destination must include the complete physical or UNC pathname.

The file will be replaced when the machine is rebooted.  
The 'locked file can be either the source or destination file.

### Examples

inuse.exe \server64\install\shiny.dll c:\program files\ss64\shiny.dll /y

Registry
--------

Replacing in-use files, can also be done manually with the REGEDIT registry editor:  
  
Open HKLM\SYSTEM\CurrentControlSet\Control\Session Manager  
  
Double click on  
PendingFileRenameOperations  
(if it does not exist - create of type REG_MULTI_SZ )  
  
On the first line is the destination file prefixed with \??\  
e.g.  
\??\d:\backup\trouble.sys  
  
On the second line is the source file to be moved prefixed with !\??\  
e.g.  
!\??\c:\windows\system32\drivers\trouble.sys  
  
So the complete Multi-String Data would appear like:  
  
\??\d:\backup\trouble.sys  
!\??\c:\windows\system32\drivers\trouble.sys  
  
Reboot the machine and the file will be moved and the PendingFileRenameOperations registry key will be deleted.

“Any intelligent fool can make things bigger and more complex...  
It takes a touch of genius - and a lot of courage to move in the opposite direction” ~ E.F. Schumacher

### Related commands

[Q228930](https://web.archive.org/web/20110228113651/https://support.microsoft.com/kb/228930) - How to replace currently locked files with Inuse.exe  
Equivalent PowerShell: [Move-Item](../ps/move-item.html) - Move an item from one location to another (move/mv/mi)  
Equivalent bash command (Linux): [mv](../bash/mv.html) - Move or rename files or directories.



/. nt/klist.html
========================================================

    KLIST - Windows CMD - SS64.com

KLIST
=====

List cached Kerberos tickets. List the Kerberos principal and Kerberos tickets held in a credentials cache.

Syntax

      klist [_command_]

commands:

    tickets [-lh _logonID.highpart_] [-li _logonID.lowpart_]
       tgt [-lh _logonID.highpart_] [-li _logonID.lowpart_]
     purge [-lh _logonID.highpart_] [-li _logonID.lowpart_]
    sessions [-lh _logonID.highpart_] [-li _logonID.lowpart_]
    kcd_cache [-lh _logonID.highpart_] [-li _logonID.lowpart_]
     get _SPN_ [-lh _logonID.highpart_] [-li _logonID.lowpart_] [-kdcoptions _[options](http://www.ietf.org/rfc/rfc4120.txt)_] [-cachecoptions _options_]
    add_bind  _Domain DC_
    query_bind 
    purge_bind
    cloud_debug

Key
    -lh 	Denotes the high part of the user's locally unique identifier (LUID), expressed in hex.
    -li 	Denotes the low part of the user's locally unique identifier (LUID), expressed in hexadecimal.
             If neither –lh nor –li are present, the command defaults to the LUID of the currently signed in user.

    tickets      List the currently cached ticket-granting-tickets (TGTs), and service tickets of the specified logon session.
                This is the default option.

    tgt          Display the initial Kerberos TGT.
    purge        Delete all the tickets of the specified logon session.
    sessions     Display a list of logon sessions on this computer.
    kcd_cache    Display the Kerberos constrained delegation cache information.
    get          Allows you to request a ticket to the target computer specified by the service principal name (SPN).
    add_bind 	Allows you to specify a preferred domain controller for Kerberos authentication.
    query_bind   Display a list of cached preferred domain controllers for each domain that Kerberos has contacted.
    purge_bind   Remove the cached preferred domain controllers for the domains specified.
    kdcoptions   Display the Key Distribution Center (KDC) options specified in RFC 4120.
    /? 	      Display Help.

If no parameters are provided, **klist** retrieves all the tickets for the currently logged on user.

Each LogonId is divided into two sections, high-part and low-part, separated with a colon ':'  
for example:  
HighPart:LowPart  
**0:0x3e7**

Domain joined machines obtain Kerberos tickets under two sessions, identified below along with the Low Part of the LogonId. These two accounts will always use the same Low Part LogonId. They should never change.

*   Local System (**0x3e7**)
*   Network Service (**0x3e4**)

Output
------

> **tickets** - Displays the following attributes of all cached tickets:
> 
> > **LogonID**: The LUID.  
> > **Client**: The concatenation of the client name and the domain name of the client.  
> > **Server**: The concatenation of the service name and the domain name of the service.  
> > **KerbTicket** Encryption Type: The encryption type that is used to encrypt the Kerberos ticket.  
> > **Ticket Flags:** The Kerberos ticket flags. Start Time: The time from which the ticket is valid.  
> > **End Time**: The time the ticket becomes no longer valid. When a ticket is past this time, it can no longer be used to authenticate to a service or be used for renewal.  
> > **Renew Time:** The time that a new initial authentication is required.  
> > **Session Key Type:** The encryption algorithm that is used for the session key.
> 
> **tgt** - Displays the following attributes for the currently cached ticket:
> 
> > **LogonID**: Identified in hex.  
> > **ServiceName**: krbtgt  
> > **TargetName** _SPN_: krbtgt  
> > **DomainName**: Name of the domain that issues the TGT.  
> > **TargetDomainName**: Domain that the TGT is issued to.  
> > **AltTargetDomainName**: Domain that the TGT is issued to.  
> > **Ticket Flags**: Address and target actions and type.  
> > **Session Key**: Key length and encryption algorithm.  
> > **StartTime**: Local computer time that the ticket was requested.  
> > **EndTime**: Time the ticket becomes no longer valid. When a ticket is past this time, it can no longer be used to authenticate to a service.  
> > **RenewUntil**: Deadline for ticket renewal.  
> > **TimeSkew**: Time difference with the Key Distribution Center (KDC).  
> > **EncodedTicket**: Encoded ticket.
> 
> Other options will display the **LogonID:** Identified in hex

### Examples

Query the Kerberos ticket cache to determine if any tickets are missing, if the target server or account is in error, or if the encryption type is not supported due to an Event ID 27 error:

C:> klist

Query only local System Tickets:

C:> klist –li 0x3e7

To learn about the specifics of each ticket-granting-ticket that is cached on the computer for a logon session:

C:> klist tgt

Purge the Kerberos ticket cache, log off, and then log back on:

C:> klist purge

Purge only local System Tickets:

C:> klist purge –li 0x3e7  

Diagnose a logon session and to locate a logonID for a user or a service:

C:> klist sessions

Diagnose Kerberos constrained delegation failure, and to find the last error that was encountered:

C:> klist kcd_cache

Diagnose if a user or a service can get a ticket to a server, or to request a ticket for a specific SPN:

C:> klist get host/%computername%

To diagnose replication issues across domain controllers, you typically need the client computer to target a specific domain controller. To target the client computer to the specific domain controller:

C:> klist add_bind CONTOSO KDC.CONTOSO.COM  
C:> klist add_bind CONTOSO.COM KDC.CONTOSO.COM

Query which domain controllers were recently contacted by this computer:

C:> klist query_bind

Rediscover domain controllers, or to flush the cache before creating new domain controller bindings with klist add_bind:

C:> klist purge_bind

_“Find out who you are and do it on purpose” ~ Dolly Parton_

### Related commands

[Gpupdate /force](gpupdate.html) - Refresh Group policy, which will generate a new kerberos ticket.  
Equivalent bash command (Linux): [klist](../bash/klist.html) - Display a list of currently cached Kerberos tickets.



/. nt/label.html
========================================================

    Label - Disk label - Windows CMD - SS64.com

LABEL
=====

Edit a disk label.

Syntax

      LABEL [/MP][_volume_] [_drive_:][_label_]

Key
    _Drive_:  The drive letter of the disk to be named.
    _label_   The name for the volume.
    /MP     Treat the volume as a mount point or volume name.
    _volume_  The drive letter, mount point, or volume name.
           If a volume name is specified, the /MP parameter is unnecessary.
    /?      Display help. 

Originally designed as a reminder of which floppy disk is in the machine, disk labels can also be applied to hard drives and mapped drives.

Changing the disk label requires [elevated](syntax-elevate.html) permissions. Running the LABEL command from a normal command prompt will generate the error. “_Access Denied as you do not have sufficient privileges._”  
By default the SYSTEM account should have full access to the drive (root folder).

If you do not specify a _label_ when you use the label command, LABEL displays a message including the "_Volume Serial Number_" if one exists.

A volume label can contain as many as 32 characters for NTFS volumes and as many as 11 characters for FAT volumes and can include spaces but not tabs.

FAT volume labels are not case sensitive and cannot contain any of the following characters: * ? / \ | . , ; : + = [ ] < > " This limitation does not apply to NTFS volumes.

Disk labels should not be confused with the _drive description_ held in the registry.

### Examples

To label the disk drive D: as SS64:

C:> label d:SS64

The drive descriptor shown in Windows Explorer can also be modified with a few lines of PowerShell:

\# Rename drive S: to 'Shared'  
$objshell = New-Object -ComObject "Shell.Application"  
$mapDrive="S:"  
$objshell.NameSpace($mapDrive).Self.Name = "Shared"

“A name is a label, and as soon as there is a label, the ideas disappear and out comes label-worship and label-bashing” ~ Richard Bach

### Related commands

[VOL](vol.html) - display the volume label.  
Equivalent PowerShell: [gcim](../ps/get-ciminstance.html) win32_logicaldisk "volumeName"  
Equivalent bash command (Linux): [hostname](../bash/hostname.html) - Print or set system name.



/. nt/lgpo.html
========================================================

    LGPO - Windows CMD - SS64.com

LGPO.exe ([MS Security Compliance Toolkit](https://www.microsoft.com/en-us/download/details.aspx?id=55319))
===========================================================================================================

Local Group Policy Object utility.

Syntax


    Apply policy settings:

      LGPO.exe _command_ [...]

      where "_command_" is one or more of the following (each of which can be repeated):

       /g path               Import settings from one or more GPO backups under "path"
       /m path\registry.pol  Import settings from registry.pol into machine config
       /u path\registry.pol  Import settings from registry.pol into user config

       /s path\GptTmpl.inf   Apply security template.

       /a[c] path\Audit.csv  Apply an advanced auditing settings backup(CSV) file; /ac to clear policy first
                             With /ac, LGPO.exe clears existing Advanced Auditing settings before
                             applying the settings from the CSV file, and copies the file to the
                             local group policy subdirectory so that the settings appear in
                             the local group policy editor.

       /t path\lgpo.txt      Apply registry commands from LGPO text.

       /e _name_|_guid_          Enable GP extension for local policy processing; specify a GUID,
                             or one of these names:
                                 "zone"       for IE zone mapping extension
                                 "mitigation" for mitigation options, including font blocking
                                 "audit"      for advanced audit policy configuration

       /boot                 Reboot after applying policies
       /v                    Verbose output
       /q                    Quiet output (no headers)

    Create a GPO backup from local policy:

      LGPO.exe **/b** _path_ [/n _GPO-name_]

        /b _path_              Create GPO backup in "_path_"
        /n _GPO-name_          Optional GPO display name (use quotes if it contains spaces)

    Parse a Registry.pol file to LGPO text (stdout):

      LGPO.exe **/parse** [/q] {/m|/u} _path\registry.pol_

       /m _path\registry.pol_  Parse _registry.pol_ as machine config commands
       /u _path\registry.pol_  Parse _registry.pol_ as user config commands
       /q                    Quiet output (no headers)

    Build a Registry.pol file from LGPO text:

      LGPO.exe **/r** _path\lgpo.txt_ /w _path\registry.pol_ [/v]

       /r path\lgpo.txt      Read input from LGPO text file
       /w path\registry.pol  Write new registry.pol file

Capture a backup before you apply the new settings.

File locations:

%Systemroot%\System32\GroupPolicy\  
%Systemroot%\System32\GroupPolicyUsers\  
C:\ProgramData\registry.pol

### Examples

Export a Local Group Policy backup:

C:> lgpo /b c:\gpobackups\  

Import some previously saved Local Group Policy settings:

C:> lgpo /g c:\gpobackups\

“The policy of being too cautious is the greatest risk of all” ~ Jawaharlal Nehru

### Related commands

[LGPO.exe v1.0](https://docs.microsoft.com/en-gb/archive/blogs/secguide/lgpo-exe-local-group-policy-object-utility-v1-0) - Microsoft Security Guidance blog.  
[GPRESULT](gpresult.html) - Display Resultant Set of Policy information.  
[GPUPDATE](gpupdate.html) - Update Group Policy settings.



/. nt/lodctr.html
========================================================

    LODCTR (perfmon) - Windows CMD - SS64.com

LODCTR.exe
==========

Load PerfMon performance counters (update registry values).

Syntax:
      LODCTR _option_

Options:

    _INI-FileName_
      An initialization file that contains  the counter name definitions and
      explain text for an extensible counter DLL.

    /C:_filename_
      Upgrade counter text strings using _filename_.

    /H:_filename_
      Upgrade help text strings using _filename_.

    /L:_filename_
      Specifies the language for the /C and /H options.

    /S:_Backup-FileName_
      Save the current perf registry strings and info to _Backup-FileName_

    /R:_Backup-FileName_
      Restore the perf registry strings and info using _Backup-FileName_

    /R
      Rebuild the perf registry strings and info from scratch based on the current 
      registry settings and backup INI files.
      Often required if Perfmon crashes, or the server is rebooted while perfmon is running.

    /T:_Service-Name_
      Set the performance counter service as trusted.

    /E:_Service-Name_
      Enable the performance counter service.

    /D:_Service-Name_
      Disable the performance counter service.

    /Q
      Query all performance counter service information

    /Q:_Service-Name_
      Query specific performance counter service information.

    /M:_Counter-Manifest_ [_Installation-Path_]
      Install a 2.0 performance counter provider using the specified XML manifest.
      The installation requires a full path to the DLL containing the perf counter resources (localized  strings).
      The path to the DLL will be determined as follows:
         If the applicationIdentity attribute in the manifest is a full path, that will be used.
          Otherwise, if _Installation-Path_ is provided and is a full path, that will be used.
          Otherwise, if _Counter-Manifest_ is a full path, the directory from _Counter-Manifest_ will be
          combined with the DLL name from the applicationIdentity attribute in the manifest.
          Otherwise, the current directory will be combined with the DLL name from the
          applicationIdentity attribute in the manifest.

    /? Display help.

Any arguments with spaces in the names must be enclosed within "Double Quotation" marks.  
The Microsoft online help for the command is currently incomplete, run LODCTR /? to check which options are available on your machine.

### Examples

Rebuild the performance counters:

C:> lodctr /r

“People count up the faults of those who keep them waiting” ~ French Proverb

### Related commands

[LOGMAN](logman.html) - Manage Performance Monitor logs.  
Equivalent PowerShell: [New-Object](../ps/new-object.html) System.Diagnostics.PerformanceCounter.



/. nt/logman.html
========================================================

    LOGMAN (perfmon) - Windows CMD - SS64.com

LOGMAN.exe
==========

Manage Performance Monitor & performance logs from the command line.

Syntax

      Logman [create | query | start | stop | delete | update | import | export] [_options_]

Verbs:
  create           Create a new data collector.
  query            Query data collector properties. 
                   If no _name_ is given all data collectors are listed.
  start            Start an existing data collector and set the begin time to manual.
  stop             Stop an existing data collector and set the end time to manual.
  delete           Delete an existing data collector.
  update           Update an existing data collector's properties.
  import           Import a data collector set from an XML file.
  export           Export a data collector set to an XML file.

Adverbs:
  counter          Create a counter data collector.
  trace            Create a trace data collector.
  alert            Create an alert data collector.
  cfg              Create a configuration data collector.
  providers        Show registered providers.

Options (counter):
    -c _path_ [_path_ [...]]
                     The [performance counters](syntax-performance-counters.html) to collect.
                     To collect remotely, prefix with the \machine name.
    -cf _filename_      File listing performance counters to collect,one per line.
    -f {bin|bincirc|csv|tsv|sql}
                     The log format for the data collector. For SQL database format,
                     you must use the -o option in the command line with the DNS!log option.
                     The defaults is binary.
    -sc _value_         Maximum number of samples to collect with a performance counter data collector.
    -si [[_hh_:]_mm_:]_ss_  Sample interval for performance counter data collectors.

Options (trace):
    -f {bin|bincirc|csv|tsv|sql}
                     The log format for the data collector. For SQL database format,
                     you must use the -o option in the command line with the DNS!log option.
                     The defaults is binary.
    -mode _trace_mode_  Event Trace Session [logger mode](https://go.microsoft.com/fwlink/?LinkID=136464).           
    -ct {perf|system|cycle}
                     The clock resolution to use when logging the time stamp for
                     each event: query performance counter, system time, or CPU cycle.
    -ln _logger_name_   Logger name for Event Trace Sessions.
    -ft [[_hh_:]_mm_:]_ss_  Event Trace Session flush timer.
    -[-]p _provider_ [_flags_ [_level_]]
                     A single Event Trace provider to enable.
                     The terms 'Flags' and 'Keywords' are synonymous in this context.
    -pf _filename_      File listing multiple Event Trace providers to enable.
    -[-]rt            Run the Event Trace Session in real-time mode.
    -[-]ul            Run the Event Trace Session in user mode.
    -bs _value_         Event Trace Session buffer size in kb.
    -nb _min max _      Number of Event Trace Session buffers.

Options (alert):
    -[-]el             Enable/Disable event log reporting.
    -th _threshold_ [_threshold_ [...]]
                      Specify counters and a threshold values for an alert.
    -[-]rdcs _name_      Data collector set to start when alert fires.
    -[-]tn _task_        Scheduled Task to run when alert fires.
    -[-]targ _argument_  Scheduled Task arguments.
    -si [[_hh_:]_mm_:]_ss_   Sample interval for performance counter data collectors.

Options (cfg):
    -[-]ni                    Enable/Disable network interface query.
    -reg _path_ [_path_ [...]]    Registry values to collect.
    -mgt _query_ [_query_ [...]]  WMI objects to collect.
    -ftc _path_ [_path_ [...]]    Full path to the files to collect.

Options:
    -?                        Display context sensitive help.
    -s _computer_               Perform the command on specified remote system.
    -config _filename_          Settings file containing command options.
    **[-n] _name_                 Name of the target object.**
    -pid _pid_                  Process identifier.
    -xml _filename_             Name of the XML file to import or export.
    -as                       Perform the requested operation asynchronously.
    -[-]u _user_ [_password_]     User to Run As. Entering a * for the password produces a prompt
                             The interactive password is not displayed on screen.

    -m [_start_] [_stop_]         Change to manual start or stop instead of a scheduled begin or end time.
    -rf [[_hh_:]_mm_:]_ss_          Run the data collector for the specified period of time.
    -b _dd/MM/yyyy HH:mm:ss_[AM|PM] Begin the data collector at specified time.
    -e _dd/MM/yyyy HH:mm:ss_[AM|PM] End the data collector at specified time.
    -[-]r                     Repeat the data collector daily at the specified begin and end times.

    -o {_path_|dsn!log}         Path of the output log file or the DSN and log set name in a
                             SQL database. The default path is '%systemdrive%\PerfLogs\Admin'.
    -[-]a                     Append to an existing log file.
    -[-]ow                    Overwrite an existing log file.
    -[-]v {_nnnnnn_ | _mmddhhmm_} Attach file versioning information to the end of the log name.
    -[-]rc _task_               Run the command specified each time the log is closed.
    -[-]max _value_             Maximum log file size in MB or number of records for SQL logs.
    -[-]cnf [[_hh_:]_mm_:]_ss_      Create a new file when the specified time has elapsed or when the max size is exceeded.

    -y                        Answer yes to all questions without prompting.
    -fd                       Flush all the active buffers of an existing Event Trace Session to disk.
    -ets                      Send commands to Event Trace Sessions directly without saving or scheduling.

Note: Where [-] is listed, an extra - negates the option. For example --u turns off the -u option.

### Examples

Create a counter to Log the % Processor Time on the local machine:

C:> set _mycounters="\Processor(_Total)\%% Processor Time"  
C:> set _mylogfile=C:\docs\ss64.blg  
C:> Logman.exe create counter ss64_CPU -f bincirc -v mmddhhmm -max 250 -c %_mycounters% -o %_mylogfile%

Start the counter running (and then run whatever other process you wish to monitor):  
C:> Logman.exe start ss64_CPU  
  
Stop the counter  
C:> Logman.exe stop ss64_CPU  
The above creates a file like C:\docs\ss64_09031235.blg  
  
To convert this to text/CSV format:  
C:> relog C:\docs\ss64_09031235.blg -f csv -o proc_time.csv -t 2  
  
We can now delete the counter (unless intending to reuse it again)  
C:> Logman.exe delete ss64_CPU

Run a scheduled task if % Processor Time > 5 (this assumes that demo_task already exists)
Logman.exe create alert ss64_alert -th "\Processor(_Total)\%% Processor Time>5" -tn "demo_task"

More examples:

 logman start perf_log
 logman update perf_log -si 10 -f csv -v mmddhhmm
  
 logman create counter perf_log -c "\Processor(_Total)\% Processor Time"
 logman create counter perf_log -c "\Processor(_Total)\% Processor Time" -max 10 -rf 01:00
  
 logman create trace trace_log -nb 16 256 -bs 64 -o c:\logfile
  
 logman create alert new_alert -th "\Processor(_Total)\% Processor Time>50"
  
 logman create cfg cfg_log -reg "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\"
 logman create cfg cfg_log -mgt "root\cimv2:SELECT * FROM Win32_OperatingSystem"
  
 logman query providers
 logman query providers Microsoft-Windows-Diagnostics-Networking
  
 logman start process_trace -p Microsoft-Windows-Kernel-Process 0x10 win:Informational -ets
 logman start process_trace -p Microsoft-Windows-Kernel-Process -mode newfile -max 1 -o output%d.etl -ets

 logman start usermode_trace -p "Service Control Manager Trace" -ul -ets
 logman query usermode_trace -p "Service Control Manager Trace" -ul -ets
 logman stop usermode_trace -p "Service Control Manager Trace" -ul -ets
  
 logman start "NT Kernel Logger" -o log.etl -ets
 logman start "NT Kernel Logger" -p "Windows Kernel Trace" (process,thread) -ets

_“Painting is just another way of keeping a diary” - Pablo Picasso_

### Related commands

[Microsoft Help page](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/logman)  
[LODCTR](lodctr.html) - Load PerfMon performance counters.  
[SYSMON](sysmon.html) - Monitor and log system activity to the Windows event log.  
[TypePerf](typeperf.html) - Write performance data to a log file.  
[EVENTCREATE](eventcreate.html) - Add a message to the Windows event log.  
Equivalent PowerShell: [New-Object](../ps/new-object.html) System.Diagnostics.PerformanceCounter.



/. nt/logoff.html
========================================================

    Logoff - Windows CMD - SS64.com

LOGOFF.exe
==========

Terminate a session and log a user off.

Syntax

      LOGOFF [_sessionname_ | _sessionid_] [/SERVER:_servername_] [/V] [/VM]

Key
    _sessionname_   The name of the session.
    _sessionid_     The ID of the session.
    _servername_    The Remote Desktop server containing the user session to log off
                 (default is current).
    /V            Verbose - display information about the actions performed.
    /VM           Log off a session on server or within virtual machine.
                 The unique ID of the session needs to be specified.

By default LOGOFF will not ask for any user confirmation or prompt to save any unsaved data. Use the SHUTDOWN /L command if you need that.  
Older versions of Logoff only have two options, /f and /n to force running processes to close, or to force with no confirmation.

**Windows security log events**

Logon Event IDs 528 and 540 = successful logon

Logoff Event ID 538 = logoff

Logon and logoff events also specify a Logon Type code:

> Logon Type 2 – Interactive - Log on at the local keyboard / screen (see the event description for a computer name).
> 
> Logon Type 3 – Network - connections to shared folders or printers, over-the-network logons, IIS logons( but not basic authentication)
> 
> Logon Type 4 – Batch - The Scheduled Task service creates a new logon session for each task.
> 
> Logon Type 5 – Service - Each service is configured to run as a specified user account.
> 
> Logon Type 7 – Unlock- a password protected screen saver.
> 
> Logon Type 8 – NetworkCleartext - a network logon like logon type 3 but where the password was sent over the network in clear text.
> 
> Logon Type 9 – NewCredentials - If you use [RunAs /netonly](runas.html) and records the logon event with logon type 2.
> 
> Logon Type 10 – RemoteInteractive - Terminal Services, Remote Desktop or Remote Assistance.
> 
> Logon Type 11 – CachedInteractive - mobile users not connected to the network connecting with cached credentials.

“The man who is tired of London is tired of looking for a parking space” ~ Paul Theroux

### Related commands

[SHUTDOWN](shutdown.html) - Shutdown the computer - can also logoff a user.  
[psShutdown](psshutdown.html) - SysInternals.



/. nt/logtime.html
========================================================

    Logtime - Windows CMD - SS64.com

LOGTIME.exe ([2003 Resource kit](../links/windows.html#kits))
=============================================================

Create logtime.txt and add the date, time and a message.

Syntax

      LOGTIME _text_string_

Key
    _text_string_ : The message to add to the log file. 

The date is stored in the US mm/dd/yy format.

### Examples

Sample batch file:  
  
LOGTIME "begin import program"  
import.exe  
LOGTIME "end import program"An alternative command to log the date and time:  
  
ECHO: | DATE | FIND /i "curre">>C:\Install_log.txt

“You can always tell that an organisation is on the skids when it changes its name, and pays a lot of money for consultants to invent some ghastly new corporate identity” ~ Baroness Helena Kennedy

### Related commands

[ECHO](../nt/echo.html) - Display message on screen.  
[DATE](../nt/date.html) /T - Display or set the date.  
[TOUCH](touch.html) - Change file timestamps.  
[timer.cmd](syntax-timer.html) - Measure the run time of a script.  
Equivalent PowerShell cmdlet: [Measure-Command](../ps/measure-command.html)



/. nt/makecab.html
========================================================

    MakeCab Create .CAB file - Windows CMD - SS64.com

MAKECAB.exe
===========

Create compressed .CAB file. A .CAB Cabinet file is a Lossless Data Compression format.

Syntax

      MAKECAB [/V[_n_]] [/D _var_=_value_ ...] [/L _dir_] _source_ [_destination_]

      MAKECAB [/V[_n_]] [/D _var_=_value_ ...] /F _directive_file_ [...]

Key
    _source_         File to compress.

    _destination_    File name to give compressed file.  If omitted, the
                  last character of the source file name is replaced
                  with an underscore (_) and used as the destination.

    /F _directives_  A file containing [directives](makecab-directives.html) for MAKECAB to use (may be repeated).
                  If more than one directive file is specified (/F file1 /F file2 ...), they
                  are processed in the order (left to right) specified on the command line.

                  Variable settings, open cabinets, open disks, etc. are all carried forward
                  from one directive file to the next (just as if all of the files had been
                  concatenated together and presented as a single file to MakeCAB).
                  For example, this is intended to simplify the work for a product shipped in
                  multiple languages. There would be a short, language-specific directives file, 
                  and then a single, master directives file that covers the bulk of the product.

    /D _var_=_value_   Defines variable with specified value. (may be repeated).
                  Equivalent to using .Set in a directives file.
                  For example, a single directive file could be used to produce layouts
                  for different disk sizes by running MakeCAB once with different values of
                  MaxDiskSize defined: /D MaxDiskSize=1.44M. Both standard MakeCAB variables
                  and custom variables can be defined in this way.

                  If .Option Explicit is specified in a directive file,
                  then _variable_ must be defined with a .Define command in a directive file.
                  To use a variable substitution (as in the directive file with %)
                  use double %%

    /L _dir_         Folder location to place destination file (default is current directory).
                  most useful when _destination_ is not specified.

    /V[_n_]          Verbosity level (1..3)  1=default, 3=Verbose. ( 0=none undocumented )

A single CAB file can be used to store a maximum of 65,535 files with a total size of up to 1.99 GiB. To compress multiple files into a single CAB file, use a directive file containing a list of the files to compress and package.

The default destination name is constructed from the source file name plus an extension that can be defined via the CompressedFileExtensionChar variable. ( MAKECAB /D CompressedFileExtensionChar=c )

MakeCAB replaces an older utility CABARC.  
On Windows Server the DIANTZ command is an synonym for Makecab  
The MakeCAB defaults are configured for a floppy disk layout.

### Examples

Create a .CAB archive containing a single file:

C:> makecab "recording.wav" "recording.cab" /L "C:\Archive"

Create a .CAB archive containing multiple files, first create SS64.ddf as a plain text file:

.OPTION EXPLICIT  
;    CabinetNameTemplate is the name of the output CAB file:  
.Set CabinetNameTemplate=Destination.CAB  
.Set Cabinet=on  
.Set Compress=on  
"file1.dat"  
"file2.iso"  
"file3.wav"  
  
C:> makecab /F SS64.ddf  

Create a self extracting archive containing movie.mov:

C:> makecab movie.mov "temp.cab"  
C:> copy /b "%windir%\system32\extrac32.exe"+"temp.cab" "movie.exe"  
C:> del /q /f "temp.cab"

“One resolution I have made, and try always to keep, is this: To rise above little things” - John Burroughs

### Related commands

[EXTRACT](extract.html) - Uncompress CAB files.  
[EXPAND](expand.html) - Uncompress one or more compressed files.  
[GenChr.cmd](syntax-genchr.html) - Generate an ASCII/Unicode character.  
[IEXPRESS](iexpress.html) - Create a self extracting ZIP file archive.  
[COMPACT](compact.html) - Compress files or folders on an NTFS partition.  
[COMPRESS](compress.html) - Compress one or more files.  
[IEXPRESS](iexpress.html) - Create a self extracting ZIP file archive.  
[Compress-Archive](../ps/compress-archive.html) - PowerShell.  
[TAR](tar.html) - Store, list or extract files in an archive.



/. nt/mapisend.html
========================================================

    Mapisend - Windows CMD - SS64.com

MAPISEND ([Back Office/Exchange Resource kit](https://www.amazon.com/dp/0735605831?tag=ss64))
=============================================================================================

Send email from the command line.

Syntax

      MAPISEND -u "_profile_" -p _password_
         -r _recipient_ -s "_subject_" **-m** _text message_ [_options_]

      MAPISEND -u "_profile_" -p _password_
         -r _recipient_ -s "_subject_" **-t** _text_file_ [_options_]

Options
      -i  interactive login (prompts for profile and password)
      -c  cc: list
      -f  File Attachment - path and file name(s)
      -v  generates verbose output (an 8 line summary of the message)

"profile" is the profile name (user mailbox) of sender
"subject" is the subject line 
"recipient" is one or more recipient(s) 
If more than one recipient - separate with ';' these must not be ambiguous in the default address book.

Mapisend requires MAPI - i.e the MS Outlook client needs to be installed.

MAPI cannot be used to generate HTML-formatted messages. As an alternative, consider using the Microsoft Outlook Object Model, CDONTS, CDOSYS, CDOEX, or a third-party SMTP control.

### Examples

mapisend -u "MS Exchange Settings" -p MyPassword -r shameika@example.com -s "Subject" -m "Test message text"

mapisend -u "MS Exchange Settings" -p MyPassword -r shameika@example.com -s "Subject" -t c:\MyMail.txt >> c:\mail.log

“The new electronic interdependence re-creates the world in the image of a global village” ~ Marshall McLuhan

### Related commands

Equivalent PowerShell: [New-Object](../ps/new-object.html) Net.Mail.MailMessage - Send email via SMTP.  
[BLAT (freeware)](https://www.blat.net/) - Send email via SMTP, avoids the need to install MS Outlook.  
A command like [START](start.html) mailto:shameika@example.com will send email but requires the user to press send.  
Equivalent bash command (Linux): sendmail.



/. nt/manage-bde.html
========================================================

    Manage-BDE - Windows CMD - SS64.com

Manage-BDE.exe
==============

BitLocker Drive Encryption: Configuration Tool. Configure BitLocker Drive Encryption on disk volumes.

Syntax

      manage-bde[.exe] -parameter [_arguments_]

Key
    -autounlock            Manage automatic unlocking of data volumes.
    -ComputerName or -cn   Run on another computer. Examples: "Computer64", "127.0.0.1"
    -changekey             Modify startup key for a volume.
    -changepassword        Modify password for a data volume.
    -changepin             Modify PIN for a volume.
    -ForceRecovery or -fr  Force a BitLocker-protected OS to recover on restarts.
    -KeyPackage or -kp     Generate a key package for a volume.
    -lock       Prevent access to BitLocker-encrypted data.
    -unlock     Allow access to BitLocker-encrypted data.
    -on         Encrypt the volume and turns BitLocker protection on.
    -off        Decrypt the volume and turns BitLocker protection off.
    -pause      Pause encryption, decryption, or free space wipe.
    -protectors   Manage protection methods for the encryption key.
    -resume     Resume encryption, decryption, or free space wipe.
    -SetIdentifier or -si  Configure the identification field for a volume.
    -status     Provide information about BitLocker-capable volumes.
    –tpm        Configure the computer's Trusted Platform Module (TPM).
    -upgrade               Upgrade the BitLocker version.
    -WipeFreeSpace or -w   Wipe the free space on the volume.

    -? or /?    Display brief help. Example: "-ParameterSet -?"

    -Help or -h Display complete help. Example: "-ParameterSet -h"

Use the -h or -help option to see the full options for each of the commands above e.g. manage-bde -on -h

### Examples

manage-bde -status  
manage-bde -on C: -RecoveryPassword -RecoveryKey F:\  
manage-bde -unlock E: -RecoveryKey F:\84E151C1...7A62067A512.bek

“The instinct of nearly all societies is to lock up anybody who is truly free. First, society begins by trying to beat you up. If this fails, they try to poison you. If this fails too, the finish by loading honors on your head” ~ Jean Cocteau (poet)

### Related commands

PowerShell: [Enable-BitLocker](../ps/enable-bitlocker.html) / [Suspend-BitLocker](../ps/suspend-bitlocker.html) / [Get-BitLockerVolume](../ps/get-bitlockervolume.html)



/. nt/mbr2gpt.html
========================================================

    summary { color: blue; cursor: pointer; font-size:18px; margin-left: 20px; width: 265px; } details > summary { padding: 2px 6px; background-color: #e7e7e7; border: none; box-shadow: 1px 1px 2px black; } MBR2GPT - Convert a disk from MBR to GPT - Windows CMD - SS64.com

MBR2GPT
=======

Convert a disk from the Master Boot Record (MBR) to the GUID Partition Table (GPT) partition style without modifying or deleting data on the disk. The tool runs from a Windows Preinstallation Environment (Windows PE) command prompt, but can also be run from the full Windows 10 operating system (OS) by using the **/allowFullOS** option.

Syntax

      MBR2GPT /validate|convert [/disk:_diskNumber_] [/logs:_logDirectory_]
         [/map:_source_=_destination_] [/allowFullOS]

Key
    /validate 	     Instruct MBR2GPT.exe to perform only the disk validation steps and report whether
                     the disk is eligible for conversion.

    /convert 	      Instruct MBR2GPT.exe to perform the disk validation and to proceed with the conversion if
                     all validation tests pass.

    /disk:_diskNumber_  The disk number of the disk to be converted to GPT.
                     If not specified, the system disk is used. The mechanism used is the same as used by the
                     diskpart.exe tool SELECT DISK SYSTEM command.
    /logs:_logDirectory_
                     The directory where MBR2GPT.exe logs should be written.
                     If not specified, %windir% is used. If specified, the directory must already exist, it will
                     not be automatically created or overwritten.
    /map:_source_=_destination_
                     Specifies other partition type mappings between MBR and GPT.
                     The MBR partition number is specified in decimal notation, not hexadecimal.
                     The GPT GUID can contain brackets, for example: /map:42={af9b60a0-1431-4f62-bc68-3311714a69ad}.
                     Multiple /map options can be specified if multiple mappings are required.

    /allowFullOS 	 By default, MBR2GPT.exe is blocked unless it's run from Windows PE.
                     This option overrides this block and enables disk conversion while running in the full
                     Windows environment.

Note: Since the existing MBR system partition is in use while running the full Windows environment, it can't be reused. In this case, a new ESP is created by shrinking the OS partition.

To use this tool in a deployment task sequence with Configuration Manager or Microsoft Deployment Toolkit (MDT), you must first update the Windows PE image (winpe.wim, boot.wim) with the [Windows ADK](https://developer.microsoft.com/windows/hardware/windows-assessment-deployment-kit) 1703, or a later version.

The conversion tool will attempt to remap all drive letter assignment information contained in the registry that corresponds to the volumes of the converted disk. If a drive letter assignment can't be restored, an error will be displayed at the console and in the log, so that you can manually perform the correct assignment of the drive letter.

Logs
----

> Four log files are created by MBR2GPT:
> 
> diagerr.xml  
> diagwrn.xml  
> setupact.log  
> setuperr.log
> 
> These files contain errors and warnings encountered during disk validation and conversion. Information in these files can be helpful in diagnosing problems with the tool. The setupact.log and setuperr.log files will have the most detailed information about disk layouts, processes, and other information pertaining to disk validation and conversion.
> 
> The setupact*.log files are different than the Windows Setup files that are found in the %Windir%\Panther directory.
> 
> The default location for all these log files in Windows PE is %windir%.

Return codes
------------

> Return code
> 
> Description
> 
> 0
> 
> Conversion completed successfully.
> 
> 1
> 
> Conversion was canceled by the user.
> 
> 2
> 
> Conversion failed due to an internal error.
> 
> 3
> 
> Conversion failed due to an initialization error.
> 
> 4
> 
> Conversion failed due to invalid command-line parameters.
> 
> 5
> 
> Conversion failed due to error reading the geometry and layout of the selected disk.
> 
> 6
> 
> Conversion failed because one or more volumes on the disk is encrypted.
> 
> 7
> 
> Conversion failed because the geometry and layout of the selected disk don't meet requirements.
> 
> 8
> 
> Conversion failed due to error while creating the EFI system partition.
> 
> 9
> 
> Conversion failed due to error installing boot files.
> 
> 10
> 
> Conversion failed due to error while applying GPT layout.
> 
> 100
> 
> Conversion to GPT layout succeeded, but some boot configuration data entries couldn't be restored.

### Examples

disk 0 is validated for conversion. Errors and warnings are logged to the default location of %windir%.  

C:> mbr2gpt.exe /validate /disk:0
MBR2GPT: Attempting to validate disk 0
MBR2GPT: Retrieving layout of disk
MBR2GPT: Validating layout, disk sector size is: 512
MBR2GPT: Validation completed successfully

Determine the partition type & disk number:

PS C:> Get-Disk | ft -Auto

Number Friendly Name      Serial Number        HealthStatus OperationalStatus Total Size Partition Style
------ -------------      -------------        ------------ ----------------- ---------- ---------------
0      MTFDDAK256MAM-1K1  13050928F47C         Healthy      Online             238.47 GB MBR
1      ST1000DM003-1ER162 Z4Y3GD8F             Healthy      Online             931.51 GB GPT

If Windows PowerShell and Disk Management aren't available, such as when you're using Windows PE, you can determine the partition type at a command prompt with [DiskPart](diskpart.html) >list disk

Conversion example

In the following example:

1.  Using DiskPart, the current disk partition layout is displayed prior to conversion - three partitions are present on the MBR disk (disk 0): a system reserved partition, a Windows partition, and a recovery partition. A DVD-ROM is also present as volume 0.
2.  The OS volume is selected, partitions are listed, and partition details are displayed for the OS partition. The MBR partition type is 07 corresponding to the installable file system (IFS) type.
3.  The MBR2GPT tool is used to convert disk 0. The DiskPart tool displays that disk 0 is now using the GPT format.
4.  The new disk layout is displayed - four partitions are present on the GPT disk: three are identical to the previous partitions and one is the new EFI system partition (volume 3).
5.  The OS volume is selected again, and detail displays that it has been converted to the GPT partition type of ebd0a0a2-b9e5-4433-87c0-68b6b72699c7 corresponding to the PARTITION_BASIC_DATA_GUID type.

As noted in the output from the MBR2GPT tool, you must make changes to the computer firmware so that the new EFI system partition will boot properly.

MBR2GPT example

X:>DiskPart.exe

Microsoft DiskPart version 10.0.15048.0

Copyright (C) Microsoft Corporation.
On computer: MININT-K71F13N

DISKPART> list volume

  Volume ###  Ltr  Label        Fs     Type        Size     Status     Info
  ----------  ---  -----------  -----  ----------  -------  ---------  --------
  Volume 0     F   CENA_X64FRE  UDF    DVD-ROM     4027 MB  Healthy
  Volume 1     C   System Rese  NTFS   Partition    499 MB  Healthy
  Volume 2     D   Windows      NTFS   Partition     58 GB  Healthy
  Volume 3     E   Recovery     NTFS   Partition    612 MB  Healthy    Hidden

DISKPART> select volume 2

Volume 2 is the selected volume.

DISKPART> list partition

  Partition ###  Type              Size     Offset
  -------------  ----------------  -------  -------
  Partition 1    Primary            499 MB  1024 KB
* Partition 2    Primary             58 GB   500 MB
  Partition 3    Recovery           612 MB    59 GB

DISKPART> detail partition

Partition 2
Type  : 07
Hidden: No
Active: No
Offset in Bytes: 524288000

  Volume ###  Ltr  Label        Fs     Type        Size     Status     Info
  ----------  ---  -----------  -----  ----------  -------  ---------  --------
* Volume 2     D   Windows      NTFS   Partition     58 GB  Healthy

DISKPART> exit

Leaving DiskPart...

X:> mbr2gpt /convert /disk:0

MBR2GPT will now attempt to convert disk 0.
If conversion is successful the disk can only be booted in GPT mode.
These changes cannot be undone!

MBR2GPT: Attempting to convert disk 0
MBR2GPT: Retrieving layout of disk
MBR2GPT: Validating layout, disk sector size is: 512 bytes
MBR2GPT: Trying to shrink the system partition
MBR2GPT: Trying to shrink the OS partition
MBR2GPT: Creating the EFI system partition
MBR2GPT: Installing the new boot files
MBR2GPT: Performing the layout conversion
MBR2GPT: Migrating default boot entry
MBR2GPT: Adding recovery boot entry
MBR2GPT: Fixing drive letter mapping
MBR2GPT: Conversion completed successfully
MBR2GPT: Before the new system can boot properly you need to switch the firmware to boot to UEFI mode!

X:>DiskPart

Microsoft DiskPart version 10.0.15048.0

Copyright (C) Microsoft Corporation.
On computer: MININT-K71F13N

DISKPART> list disk

  Disk ###  Status         Size     Free     Dyn  Gpt
  --------  -------------  -------  -------  ---  ---
  Disk 0    Online           60 GB      0 B        *

DISKPART> select disk 0

Disk 0 is now the selected disk.

DISKPART> list volume

  Volume ###  Ltr  Label        Fs     Type        Size     Status     Info
  ----------  ---  -----------  -----  ----------  -------  ---------  --------
  Volume 0     F   CENA_X64FRE  UDF    DVD-ROM     4027 MB  Healthy
  Volume 1     D   Windows      NTFS   Partition     58 GB  Healthy
  Volume 2     C   System Rese  NTFS   Partition    499 MB  Healthy    Hidden
  Volume 3                      FAT32  Partition    100 MB  Healthy    Hidden
  Volume 4     E   Recovery     NTFS   Partition    612 MB  Healthy    Hidden

DISKPART> select volume 1

Volume 1 is the selected volume.

DISKPART> list partition

  Partition ###  Type              Size     Offset
  -------------  ----------------  -------  -------
  Partition 1    Recovery           499 MB  1024 KB
* Partition 2    Primary             58 GB   500 MB
  Partition 4    System             100 MB    59 GB
  Partition 3    Recovery           612 MB    59 GB

DISKPART> detail partition

Partition 2
Type    : ebd0a0a2-b9e5-4433-87c0-68b6b72699c7
Hidden  : No
Required: No
Attrib  : 0000000000000000
Offset in Bytes: 524288000

  Volume ###  Ltr  Label        Fs     Type        Size     Status     Info
  ----------  ---  -----------  -----  ----------  -------  ---------  --------
* Volume 1     D   Windows      NTFS   Partition     58 GB  Healthy

“Travel for me is all about transformation, and I'm fascinated by those people who really do come back from a trip unrecognizable to themselves and perhaps open to the same possibilities they'd have written off not a month before” ~ Pico Iyer

### Related commands

[YouTube walkthrough](https://www.youtube.com/watch?v=hfJep4hmg9o) - Convert BIOS / MBR to UEFI / GPT without reformatting - MBR2GPT tool.  



/. nt/md.html
========================================================

    MD - Make directory - Windows CMD - SS64.com

MD
==

Make Directory - Create a new folder/directory.

Syntax

      MD [_drive_:]_path_ [[_drive_:]_path_...]

Key
    _path_  The path/directory to create.

The path can consist of any valid characters up to the maximum path length. Command extensions, which are enabled by default, allow a single MD command to create all the intermediate directories in a specified path.

Directories are one type of folder, namely, folders which correspond to file system locations. There are other types of folders, such as Control Panel or Network Neighborhood or Printers. These other types of folders represent objects in the shell namespace which do not correspond to files.

Naming Restrictions
-------------------

> The set of [CMD delimiters](syntax-esc.html) (Comma , Semicolon ; Equals = Space ' ' Tab '   ') **can** be used in a folder name, but they must be enclosed in quotation marks:  
> MD "aa=bb" will create a folder called 'aa=bb',  
> MD aa=bb will create two folders 'aa' and 'bb'
> 
> Try to avoid using the following characters in folder names, they may cause problems when scripting: © ® " & ' ^ @  
>   
> The maximum length of a full pathname (folders + filename) is 260 characters, this is a limitation of Windows Explorer not NTFS.  
>   
> You cannot create a folder with the same name as any of the following devices:  
> CON, PRN, LPT1, LPT2 ..LPT9, COM1, COM2 ..COM9  
> This limitation ensures that [redirection](syntax-redirection.html) to these devices will always work.

Errorlevels
-----------

> If the Directory was successfully created [%ERRORLEVEL%](errorlevel.html) = 0  
> If the Directory could not be created [%ERRORLEVEL%](errorlevel.html) = 1

MKDIR is a synonym for MD

### Examples

C:\temp> MD MyFolder

Make several directories with one command:

C:\temp> MD Alpha Beta Gamma

will create  
  
C:\temp\Alpha\  
C:\temp\Beta\  
C:\temp\Gamma\Make an entire path  
MD creates any intermediate directories in the path, if needed.  
For example, assuming utils does not exist then:

 MD utils\downloads\Editor 
   
    is the same as: 
   
    MD utils 
    MD utils\downloads 
    MD utils\downloads\Editor

For filenames with spaces or punctuation characters, add surrounding quotes:  
  
 MD "\utils\downloads\Super New Editor"

"We are American at puberty. We die French" - Evelyn Waugh

### Related commands

[CD](cd.html) - Change directory.  
[RD](del.html) - Delete directory or entire directory tree.  
[MKLINK](mklink.html) / Linkd - Link an NTFS directory to a target object.  
powershell: [New-Item](../ps/new-item.html) -path c:\ -name "Demo Folder" -type directory.  
[What is the difference between a directory and a folder?](https://devblogs.microsoft.com/oldnewthing/20110216-00/?p=11473) - Raymond Chen.  
Equivalent bash command (Linux): [mkdir](../bash/mkdir.html) - Create new folder(s)



/. nt/mklink.html
========================================================

    MKLink - Windows CMD - SS64.com .mklink{max-width: 1000px;} td, th{ padding: 10px 3px; text-align: center; line-height: 1.0; }

MKLink
======

Create a symbolic link to a directory or a file, or create a hard file link or directory junction.

Syntax

      MKLINK [[/D] | [/H] | [/J]] _LinkName Target_

Key:

    /D     Create a Directory symbolic link. (default is file)

    /H     Create a hard link instead of a symbolic link.

    /J     Create a Directory Junction.

    _LinkName_ The new symbolic link name.

    _Target_ The path (relative or absolute) that the new link refers to.

Symbolic links are the newest and most flexible type of link, (first introduced in Vista) they are transparent to users; the links appear as normal NTFS files or directories, and can be acted upon by the user or application in exactly the same manner. Symbolic links can span volumes and can use UNC paths. Symbolic links are also the only type of link which can be set to a _relative_ path (on the same volume).

A symlink can be an absolute path C:\Programs or a path relative to the link's location \Programs.

Types of Link  

----------------

Can link to files?

Can link to folders?

Can link across hard drives?

Can point to a non-existent target?

How to delete:

[Shortcut](shortcut.html)

Yes

Yes

Yes

Yes

[Del](del.html)

Hard link

Yes

No

No

No  

[Del](del.html)

Junction  
(soft link)

No

Yes

Y (on the same computer)

Yes

[RD](rd.html)

Symbolic link

Yes

Yes

Yes

Yes

RD _folder_ or Del _file_

Symbolic Links and Directory Junctions are implemented using [reparse points](https://docs.microsoft.com/en-gb/windows/desktop/FileIO/reparse-points).

Shortcut files have some additional features beyond just linking to another file: set [run as admin](syntax-elevate.html) flag, make an icon, invoke an executable with arguments.

Hard Links are implemented with multiple file table entries that point to the same inode – the same as Unix hard links. If the original filename is deleted, the hard link will still work - it points directly to the data on disk.

It is possible (but not advisable) to create two links that point to each other in a loop, or a link that targets itself. Symbolic links can expose security vulnerabilities in applications that aren’t designed to handle them.

Unfortunately under Microsoft Windows neither hard links or symbolic links are supported by .zip files.

List existing Links and Junctions
---------------------------------

> The standard [DIR](dir.html) command will display Symbolic Links, indicated with <SYMLINKD>  
> The [DIR /A:S](dir.html) command will display Junctions, indicated with <JUNCTION>
> 
> DIR /A:S %userprofile%

Elevation
---------

> By default, only Administrators can create symbolic links. The security setting 'Create symbolic links' can be granted at: Configuration\Windows Settings\Security Settings\Local Policies\User Rights Assignment\
> 
> Creating a symbolic link requires elevation, but from Windows 10 [build 14972](https://blogs.windows.com/buildingapps/2016/12/02/symlinks-windows-10/), symlinks can be created without needing to elevate the console as administrator - this does however require that you have [Developer Mode](https://docs.microsoft.com/en-us/windows/uwp/get-started/enable-your-device-for-development) enabled.

Windows Explorer - drag and drop
--------------------------------

> *   Selecting a symbolic link in Windows Explorer will select the original directory.
> *   Selecting a junction in Windows Explorer will select the junction.
> 
> *   Dragging a symbolic link to a new directory in Windows Explorer will move the symbolic link to the new directory.
> *   Dragging a junction to a new directory in Windows Explorer will move the original directory to the new directory.

Errorlevels
-----------

> If the link was successfully created [%ERRORLEVEL%](errorlevel.html) = 0  
> Link could not be created or bad parameters given [%ERRORLEVEL%](errorlevel.html) = 1

### Examples

Link for a file:  
C:> MKlink ss64.exe C:\Windows\system32\notepad.exe  
C:> Dir  
C:> Del ss64.exe

Link for a folder:  
C:> MKlink /D Apr C:\work\April  
C:> Dir  
C:> RD Apr

MKLINK is an [internal](syntax-internal.html) command.

"And so its my assumption, I’m really up the junction" ~ Squeeze

### Related commands

[FSUTIL](fsutil.html) - Create Hard Junction Link.  
[FSUTIL behavior set symlinkevalution](fsutil.html#behavior) - Allow/disable symbolic links.  
[MOUNTVOL](mountvol.html) - Manage a volume mount point.  
[RD](rd.html) - Delete folder or Junction Point.  
PowerShell: [New-Item -ItemType SymbolicLink](../ps/new-item.html)  
[Q205524](https://web.archive.org/web/20120423075849/https://support.microsoft.com/kb/205524) - How to create and manipulate NTFS junction points.  
[Hard Links and Junctions](https://docs.microsoft.com/en-gb/windows/desktop/FileIO/hard-links-and-junctions) - MSDN  
[Junction](https://docs.microsoft.com/en-gb/sysinternals/downloads/junction) - Create directory symbolic link (sysInternals).



/. nt/mode.html
========================================================

    MODE - Com1, Com2, Lpt1, con - Windows CMD - SS64.com

MODE
====

Configure a system device: COM / LPT port, or CMD console CON.

Syntax

    Serial port:
      MODE COM_m_[:] [BAUD=_b_] [PARITY=_p_] [DATA=_d_] [STOP=_s_]
                                [to=on|off] [xon=on|off] [odsr=on|off]
                                [octs=on|off] [dtr=on|off|hs]
                                [rts=on|off|hs|tg] [idsr=on|off]
    Device Status:
      MODE [_device_] [/STATUS]

    Redirect printing:
      MODE LPT_n_[:]=COM_m_[:]

    Select code page:
      MODE CON[:] CP SELECT=_yyy_

    Code page status:
      MODE CON[:] CP [/STATUS]

    Display size/buffer - number of columns wide and number of lines deep:
      MODE CON[:] [COLS=_c_] [LINES=_n_]

    undocumented) abbreviated version of the above:
      MODE _Cols, Lines_

    Typematic rate:
      MODE CON[:] [RATE=_r_ DELAY=_d_]

Used without parameters, MODE displays the status of all devices installed on your system  
(COM1, COM2, LPT1, CON) this output is language/locale specific.

C:> MODE
Status for device CON:
----------------------
    Lines:        240
    Columns:       80
    Keyboard Rate: 31
    Keyboard delay: 1
    Code Page:    850  

Mode lines will set both the height/width of the console window and the screen buffer.

Mode can be used to set the display window to be larger than the monitor width and/or height, in this case the CMD window size will be restricted to the display size but a scroll bar will appear. If the display window is made very large (many times the size of a typical display), the memory used by conhost.exe will increase, in extreme cases to over 1 GB.

In PowerShell the height and buffer size can be set independently, but this requires [a script](../ps/syntax-consolesize.html).

Show the status of a specific device:  
MODE [_device_]  
  
To additionally show the status of any redirected parallel printer:  
MODE [_device_] [/STATUS]

Keyboard
--------

> Typematic rate is the rate at which a character is repeated when you hold down a key.  
> MODE CON[:] [RATE=_r_ DELAY=_d_]

Printing
--------

> To redirect output from a parallel port (PRN, LPT1, LPT2, or LPT3) to a serial port(COM1, COM2, COM3, etc).  
> You must be a member of the Administrators group to redirect printing.  
>   
> To configure a parallel printer port (PRN, LPT1, LPT2, or LPT3):  
> MODE LPT_n_[:]=COM_m_[:]  
>   
> To setup the parameters for a serial port.  
> MODE COM_**m**_ [_options_*]  
>   
> Configure a printer connected to a parallel printer port.  
> mode LPT_n_[:] [_c_][,[_l_][,_r_]]  
> mode LPT_n_[:] [cols=_c_] [lines=_l_]  
> This allows you to configure a line printer connected to a parallel printer port.

Window Border size
------------------

> The border size (for all windows) can be set in the registry or with [REG](reg.html), the defaults are -15 for BorderWidth and -60 for PaddedBorderWidth
> 
> @echo off  
> Echo Display the current border  
> REG QUERY "HKCU\Control Panel\Desktop\WindowMetrics" /v BorderWidth  
> REG QUERY "HKCU\Control Panel\Desktop\WindowMetrics" /v PaddedBorderWidth
> 
> Echo Set the border to 12 with 0 padding  
> REG ADD "HKCU\Control Panel\Desktop\WindowMetrics" /v BorderWidth /d -12 /f  
> REG ADD "HKCU\Control Panel\Desktop\WindowMetrics" /v PaddedBorderWidth /d 0 /f  
>   
> Logoff and login again to see the new border. (also see [PowerShell script](https://web.archive.org/web/20200318042348/https://gallery.technet.microsoft.com/scriptcenter/Change-window-borderdesktop-609a6fb2) for setting the border + color/spacing.)  

International Settings
----------------------

> Change the current code page:  
> MODE CON[:] CP SELECT=_yyy_  
>   
> Display the current Code page:  
> MODE CON[:] CP [/STATUS]

### Examples

MODE CON:cols=80 lines=25

MODE 80, 50

![mode](mode.jpg)

“The dogma of the ghost in the machine” ~ Gilbert Ryle

### Related commands

[Full list of Code Page Identifiers](https://docs.microsoft.com/en-gb/windows/win32/intl/code-page-identifiers) - docs.microsoft.com  
[DisplaySwitch](displayswitch.html) - Specify which display to use and how to use it  
The [NUL](nul.html) device.  
[NET](net.html) - manage network resources.  
[CHCP](chcp.html) - Display or change device settings.  
Equivalent bash command (Linux): [screen](../bash/screen.html) - Terminal window manager.



/. nt/more.html
========================================================

    More - screen display - Windows CMD - SS64.com

MORE
====

Display output one screen at a time. MORE can be used to run any executable command (or batch file) and pause the screen output one screen at a time. MORE can also be used to [TYPE](type.html) the contents of any file to the screen.

Syntax

      _command_ | MORE [/E [/C] [/P] [/S] [/Tn] [+n]]

      MORE [/E [/C] [/P] [/S] [/Tn] [+n]] < _Pathname_

      MORE /E [/C] [/P] [/S] [/Tn] [+n] [_Pathname_(s)]

Key
    _command_  Any executable command or batch file.

    Pathname  The file to be displayed. (if more than one separate with spaces).

    /E        Enable extended features.

    /E /C     Clear screen before displaying page.

    /E /P     Expand FormFeed characters.

    /E /S     Squeeze multiple blank lines into a single line.

    /E /T_n_    Expand tabs to _n_ spaces (default=8).

    /E +_n_     Start displaying the first file at line _n_.

You can create an environment variable called %MORE% and use this to supply any of the above switches.

More will convert any TAB characters to spaces in the output, by default 8 spaces.

If the output of MORE is [redirected](syntax-redirection.html) to a file (MORE demo.txt > output.txt) it will not prompt for the next page, unless the file contains more than 65,536 lines at which point it will prompt for each additional line.

When the output is redirected, this will also redirect/hide the --More (17%) -- prompts.

If extended features are enabled, (/E) the following keystrokes can be used at the -- More -- prompt:

  <space>   Display next page.
  <return>  Display next line.
  Q         Quit.
  P _n_       Display next _n_ lines.
  S _n_       Skip next _n_ lines.
  F         Display next file.
  =         Show line number.
  ?         Show help line.

In PowerShell use | [Out-Host](../ps/out-host.html) -Paging in preference to MORE, it will start to yield results immediately through the PowerShell pipeline, without waiting first to collect all the incoming data.

### Examples

Convert a Unix text file (LF line endings) to Windows text file (CR/LF)  

TYPE UnixFile.txt | MORE /E /P > WindowsFile.txt

Extract just one line from a file: this can be done using FOR /F:  

SET "_line12="
FOR /F "skip=**11** delims=" %%i in (demo.txt) DO if not defined _line12 set "_line12=%%i"  
Echo %_line12%

“less is more” ~ Ludwig Mies van der Rohe

### Related commands

[TYPE](type.html) - display files.  
[ECHO](echo.html) - display variables.  
Equivalent bash command (Linux): [more](../bash/more.html) / [less](../bash/less.html) - Display output one screen at a time.  
Equivalent PowerShell: [Out-Host](../ps/out-host.html) -Paging



/. nt/mountvol.html
========================================================

    Mountvol - Mount Volume - Windows CMD - SS64.com

MOUNTVOL
========

Link volumes without requiring a drive letter. Create, delete or list a volume mount point. NTFS junction mount points can only be used with **local** NTFS directories, (unlike DFS junction points which will target a network share). MOUNTVOL can be found on the Windows CD i386 folder.

Syntax

      MOUNTVOL [_drive_:]_path_ _VolumeName_
      MOUNTVOL [_drive_:]_path_ /D
      MOUNTVOL [_drive_:]_path_ /L
      MOUNTVOL [_drive_:]_path_ /p
      MOUNTVOL /R
      MOUNTVOL [/N | /E]
      MOUNTVOL _drive_: /S

Options

    _path_     : An existing NTFS folder where the mount point will reside.

 _VolumeName_  : The volume name that is the target of the mount point.
               In the form \?\Volume{GUID}\, where {GUID} is a globally unique identifier
               e.g.   **\?\Volume\{**2eca078d-5cbc-43d3-aff8-7e8511f60d0e**}**

    /D       : Remove the volume mount point from the specified folder.

    /E       : Re-enable automatic mounting of new basic volumes.

    /L       : List the mounted volume name for the specified folder.

    /S       : Itanium-based computers only. Mount the EFI System Partition on the specified drive. 

    /p       : Remove the volume mount point from the specified directory, 
               dismount the basic volume, and take the basic volume offline,
               making it unmountable. (Win7/Server 2008+)

    /R       : Remove volume mount point directories and registry settings for
               volumes that are no longer in the system,this prevents them from
               being automatically mounted and given their former volume mount
               point(s) when added back to the system.(Win7/Server 2008+)

    /N       : Disable automatic mounting of new basic volumes. (Win7/Server 2008+)
               New volumes are not mounted automatically when added to the system.

The GUID is used to identify a unique volume even if the drive letter changes.

If other processes are using the volume, mountvol closes any open handles before dismounting the volume.

Volumes that are dismounted by using /p are listed in the volumes list as "NOT MOUNTED UNTIL A VOLUME MOUNT POINT IS CREATED."  
If the volume has more than one mount point, use /d to remove the additional mount points before using /p. You can make the basic volume mountable again by assigning a volume mount point.

If you need to expand your volume space without reformatting or replacing a hard drive, you can add a mount path to another volume. The benefit of using one volume with several mount paths is that you can access all **local volumes** by using a single drive letter (such as C:). You do not need to remember which volume corresponds to which drive letter—although you can still mount local volumes and assign them drive letters.

When using junction points:  
• Use NTFS ACLs to protect junction points from inadvertent deletion.  
• Use NTFS ACLs to protect files and directories that are targeted by junction points from inadvertent deletion or other file system operations.  
• Never delete a junction point by using Explorer, a del /s command, or other file system utilities that walk recursively into directory trees. These utilities affect the target directory and all subdirectories.  
• Use caution when you apply ACLs or change file compression in a directory tree that includes NTFS junction points.  
• Do not create namespace cycles with NTFS or DFS junction points.  
• Put all your junction points in a secure location in a namespace where you can test them out in safety, and where other users will not mistakenly delete them or walk through them.

### Examples

List a brief help text followed by a list of the volumes, mount points and GUIDs on your system:

C:> mountvol

List the volume GUID for the C: drive on your system:

C:> mountvol C: /L

Create a mount point called ss64:

C:> md ss64  
C:> mountvol c:\ss64 \?\Volume\{2eca078d-5cbc-43d3-aff8-7e8511f60d0e}\

Delete the mount point:

C:> mountvol c:\ss64 /d

“The shortest and surest way of arriving at real knowledge is to unlearn the lessons we have been taught, to mount the first principles, and take nobody's word about them” ~ Henry Bolingbroke

### Related commands

[MKLINK](mklink.html) - Create a symbolic link (linkd).  
[Q205524](https://web.archive.org/web/20120423075849/https://support.microsoft.com/kb/205524) - How to create and manipulate NTFS junction points.  
[BCDEDIT](bcdedit.html) - Manage Boot Configuration Data.  
Equivalent bash command (Linux): [mount](../bash/mount.html) - Mount a file system.



/. nt/move.html
========================================================

    Move - Windows CMD - SS64.com

MOVE
====

Move a file from one folder to another.

Syntax

      MOVE [_options_] [_Source_] [_Target_]

Key
    _source_ : The path and filename of the file(s) to move.

    _target_ : The path and filename to move file(s) to.

    _options_:
            /Y    Suppress confirmation prompt, when overwriting files.

            /-Y   Enable confirmation prompt, when overwriting files.

Both Source and Target can be either a folder or a single file.

The source can include [wildcards](syntax-wildcards.html) (but not the destination).

Under Windows 2000 and above, the default action is to prompt on overwrite unless the command is being executed from within a batch script.  
To force the overwriting of destination files use the COPYCMD environment variable:  
SET COPYCMD=/Y

Errorlevels
-----------

> If the File(s) were successfully moved/renamed [%ERRORLEVEL%](errorlevel.html) = 0  
> If the File was not found, could not be moved/renamed or bad parameters [%ERRORLEVEL%](errorlevel.html) = 1

### Examples

Rename a file in the current folder, unlike the [REN](ren.html) command this will replace the destination file if it already exists:  
MOVE oldfile.wp newfile.doc  
  
Move a file, specifying the full path:  
MOVE g:\department\oldfile.wp "c:\Files to Convert\newfile.doc"  
  
Specify the drive and filename, assumes the [current](cd.html) folder on both drives is correct:  
MOVE a:oldfile.wp c:newfile.doc  
  
Specify source only, will copy the file to current folder, keeping the same filename:  
MOVE g:\department\oldfile.wp  
  
Quiet move, no feedback on screen:  
MOVE oldfile.wp newfile.doc >nul

Move a file, but do not overwrite if the destination file already exists, this technique only works for a single file, no wildcards  
( /-y is required):

Echo n|MOVE /-y c:\file1.txt c:\dir\file1.txt

MOVE is an [internal](syntax-internal.html) command.

“Any intelligent fool can make things bigger and more complex...  
It takes a touch of genius - and a lot of courage to move in the opposite direction” ~ E.F. Schumacher

### Related commands

[COPY](copy.html) - Copy one or more files to another location.  
[INUSE](inuse.html) - Replace files that are in use by the OS.  
[ROBOCOPY](robocopy.html) /MOVE - Robust File and Folder Copy.  
[XCOPY](xcopy.html) - Copy files and folders.  
[REN](ren.html) - Rename a file or files.  
[Move the CSC folder](https://learn.microsoft.com/en-us/troubleshoot/windows-client/networking/move-client-side-caching-folder) (client-side caching).  
Equivalent PowerShell: [Move-Item](../ps/move-item.html) - Move an item from one location to another (move/mv/mi).  
Equivalent bash command (Linux): [mv](../bash/mv.html) - Move or rename files or directories.



/. nt/moveuser.html
========================================================

    Moveuser - Move between domains - Windows CMD - SS64.com

MOVEUSER.exe ([Windows 2003 Resource Kit](../links/windows.html#kits))
======================================================================

Move a local user account into a domain or move a user account between machines.

Syntax

      MOVEUSER [DOMAIN/]_user1_ [DOMAIN/]_user2_ [/c:_computer_] [/k] [/y]

Key:

    _user1_   The existing user (who has a local profile)
           Specify domain users in 'DOMAIN/user' format
           or just 'user' for a local account. 

    _user2_   The user acount that will inherit the user1 profile.
           This account must already exist.
           Specify domain users in DOMAIN/user format
           specify only user for local accounts.

 /c:_computer_   The computer on which to make the changes. 

    /k      Keep user account _user1_ (only applies to local users) 

    /y      Overwrite an existing profile for _user2_.

To use MOVEUSER, you must be logged in with admin rights to create and modify user accounts on both the source and target machine.

### Examples

MOVEUSER fred MyDomain\newfred

Or if the account 'fred' is on the remote PC called 'wks0123'

MOVEUSER fred MyDomain\newfred /c:\wks0123 

“You don’t sew with a fork, so I see no reason to eat with knitting needles” - Miss Piggy, on eating Chinese Food

### Related commands

ADMT - Active Directory Migration Tool (domain to domain).



/. nt/msg.html
========================================================

    Msg - Windows CMD - SS64.com

MSG.exe
=======

Send a pop-up message to a Terminal Server user.

Syntax

      MSG _username_ [_options_] [_message_]

      MSG _sessionname_ [_options_] [_message_]

      MSG _sessionid_   [_options_] [_message_]

      MSG  @_filename_ [_options_] [_message_]

      MSG * [_options_] [_message_]

Options

    _username_            The user to send to, * will send to all sessions on the machine.

    /SERVER:_servername_  The server to contact (default is current).

    /TIME:_seconds_       Time delay to wait for receiver to acknowledge msg.

    /V                  Verbose, display extra information.

    /W                  Wait for response from user, useful with /V.

    _message_             The message text to send, some special characters may
                       have to be escaped.

Msg is most commonly used to send Terminal Server/Citrix shutdown messages.  
The 'Home' editions of Windows don’t include MSG.

Special characters: dash (-) forward slash (/) and quote marks (") can be escaped with a backslash ([undocumented](https://ss64.org/viewtopic.php?f=2&t=351))

If no message text to send is specified, MSG will prompt for it (also reads from stdin)  
@filename identifies a file containing a list of usernames, sessionnames or sessionids to send the message to.  

### Examples

C:> msg user64 "The system will shutdown at 10pm"

C:> msg * "The \"ACME\" system is currently down."

\# And these children that you spit on, As they try to change their worlds  
Are immune to your consultations, they're quite aware of what they're going through # - David Bowie

### Related commands

[ECHO](echo.html) - Display message on screen.  
[TYPE](type.html) - Display the contents of a text file.  
Equivalent PowerShell:  
PS C:> [Reflection.Assembly]::LoadWithPartialName("System.Windows.Forms")  
PS C:> [Windows.Forms.MessageBox]::show("Hello World", "My PopUp Message Box")  
Equivalent bash command (Linux): [echo](../bash/echo.html) - Display message on screen.



/. nt/msiexec.html
========================================================

    MSIEXEC - Windows installer - Windows CMD - SS64.com

MSIEXEC
=======

Microsoft Windows Installer.

Syntax

      MSIEXEC /Option _RequiredParameter_ [_OptionalParameter_]

Install Options:

    Install or configure a product:
      MSIEXEC /package _Product.msi_
      MSIEXEC /i _Product.msi_

    Administrative install, Install a product on the network:
      MSIEXEC /a _Product.msi_

    Advertise a product to all users:
      MSIEXEC /j **m** _Product.msi_ [/t _TransformList_] [/g _LanguageID_]

    Advertise a product to current user:
      MSIEXEC /j **u** _Product.msi_ [/t _TransformList_] [/g _LanguageID_]

    Uninstall the product:
      MSIEXEC /uninstall _Product.msi_
      MSIEXEC /x _Product.msi_
      MSIEXEC /uninstall _ProductCode_
      MSIEXEC /x _ProductCode_

    Extract files from an MSI:
      MSIEXEC /a _MSIFile_ /qb TARGETDIR=_DestinationDirectory_

Display Options:

    Quiet mode, no user interaction
      /quiet

    Unattended mode - progress bar only
      /passive

    Set user interface level: None
      /qn

    Set user interface level: Basic UI
      /qb

    Set user interface level: Reduced UI
      /qr

    Set user interface level: Full UI (default)
      /qf

    Help information
      /help
                
Restart Options:

    Do not restart after the installation is complete:
      /norestart

    Prompt the user for restart if necessary:
      /promptrestart

    Always restart the computer after installation:
      /forcerestart
             
Logging Options:

    /le _Logfile_  Log All error messages
    /lw _Logfile_  Log Non-fatal warnings
    /li _Logfile_  Log Status messages
    /la _Logfile_  Log Start up of actions
    /lr _Logfile_  Log Action-specific records
    /lu _Logfile_  Log User requests
    /lc _Logfile_  Log Initial (UI) parameters
    /lm _Logfile_  Log Out-of-memory or fatal exit information
    /lo _Logfile_  Log Out-of-disk-space messages
    /lp _Logfile_  Log Terminal properties
    /lv _Logfile_  Log Verbose output
    /lx _Logfile_  Log Extra debugging information

    /l* _Logfile_  Log all information, except for v and x options
    /log _Logfile_ Equivalent of /l* 

    /l+ _Logfile_  Append to an existing log file.
    /l! _Logfile_  Flush each line to the log.

Update Options:

    Apply update(s)
      /update [;_Update2.msp_]

    Remove update(s) for a product:
      /uninstall [;_Update2.msp_] /package 
                
Repair Options:

    /fp          Repair/fix - re**p**lace missing files
    /fo          Repair/fix - replace **O**lder files(default)
    /fe          Repair/fix - replace older or **E**qual date files
    /fd          Repair/fix - replace **D**ifferent version files
    /fc          Repair/fix - replace files based on **C**hecksum differences
    /fa          Repair/fix - replace **A**ll files
    /fu          Repair/fix - rewrite HKCU registry(default)
    /fm          Repair/fix - rewrite HKLM registry(default)
    /fs          Repair/fix - recreate shortcuts(default)
    /fv          Repair/fix - rewrite local cache from source

Set Public Properties
        [PROPERTY=_PropertyValue_]

Product codes:

> The ProductCode for each application is a GUID that can be retrieved with a WMI query in VBScript or PowerShell, [Get-CimInstance](../ps/get-ciminstance.html) Win32_Product will return the IdentifyingNumber which is the installed ProductCode:
> 
> PS C:> gcim Win32_Product -Filter "Name LIKE 'Paint.net%'" | Select name, IdentifyingNumber, LocalPackage
> 
> Win32_Product should be used with extreme caution as it will perform a reconfigure (repair) of **all** installed applications, see [Q974524](https://support.microsoft.com/en-gb/help/974524/).
> 
> The ProductCode should be unique for each installed product, the same ProductCode will be found on multiple machines if they have the same software installed. So run the query on a test machine and store the product codes somewhere.

Windows installer (and msiexec) have been updated with each major release of Windows, Installer redistributables are available at the [Microsoft Download Center](https://www.microsoft.com/download/).

All Command-line options are case insensitive.

Msiexec sets an error level on return that corresponds to [System Error Codes](https://docs.microsoft.com/en-us/windows/win32/debug/system-error-codes).

Do not use the domain controller SYSVOL folder as a Windows Installer installation point, doing so can result in the following error when you attempt to run the Windows Installer (.msi) package:

> _This installation package could not be opened. Verify that the package exists and that you can access it, or contact the application vendor to verify that this is a valid Windows Installer package._

This is because the SYSVOL folder is created with the SHI1005_FLAGS_RESTRICT_EXCLUSIVE_OPENS attribute, which prevents it from being exclusively locked by Windows Installer. Having locked files on a SYSVOL will create Active Directory directory service synchronization problems.

Registry Keys:  
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall

### Examples

Install an application from a .MSI file:  
msiexec /i "C:\Install\ss64app.msi"  
  
UnInstall a program, using its GUID:  
msiexec /uninstall "{5AFF6499-63BA-4A36-83B2-8D256404AC3D}" /log "C:\install\ss64app.txt"

or remotely with [psexec](psexec.html)  
psexec \$workstation -s msiexec /uninstall "{5AFF6499-63BA-4A36-83B2-8D256404AC3D}" /log "C:\install\ss64app.txt"

Extract the files from a .MSI installer:

msiexec /a proginstall.msi /qb TARGETDIR=C:\demo\extractedprog  

“People don’t resist change. They resist being changed!” - Peter Senge.

### Related commands

[CHANGE](change.html) - Terminal Server session install mode.  
[MSIinfo](https://docs.microsoft.com/en-gb/windows/win32/msi/msiinfo-exe) - Edit or display the summary information stream of an MSI database. (Windows Installer SDK).  
[ORCA](https://docs.microsoft.com/en-gb/windows/win32/msi/orca-exe) - A database table editor for creating and editing Windows Installer packages and merge modules. (Windows Installer SDK).  
[REGSVR32](regsvr32.html) - Register or unregister a DLL.  
[RunDll32](rundll32.html) - Uninstall DLL's e.g. MS Java.  
[WINGET](winget.html) - Windows Package Manager.  
[docs.microsoft.com](https://docs.microsoft.com/en-gb/windows/desktop/Msi/released-versions-of-windows-installer) - Released Versions of Windows Installer.  
[Q310747](https://support.microsoft.com/en-gb/help/310747/) - System File Checker (Sfc.exe)  
Equivalent bash command (Linux): [RPM](https://rpm.org/) - Rpm Package Manager.



/. nt/msinfo32.html
========================================================

    MsInfo32 - Windows CMD - SS64.com

MSINFO32.exe
============

System Information - display details about hardware configuration, computer components, software and drivers.

Syntax

      Msinfo32 [/pch] [/nfo _PathName_] [/report _[PathName](path.html#pathname)_]
         [/computer _ComputerName_] [/showcategories]
            [/category _categoryID_] [/categories _categoryID_]

Key
    /nfo _PathName_   Save the information as a .nfo file
                   An .nfo file name extension will be appended to the name if needed.

    /report _PathName
               _    Output a text file

    /computer       Get details from a remote computer

    /categories     Display or output the specified categories

    /category       Set focus to a specific category at startup

    /pch            Display History View

    /showcategories  
                   Start System Information with the category IDs displayed
                   instead of the friendly names or the localized names.
                   For example, when you use this switch, the Software Environment
                   category is displayed as the SWEnv category.
                   SWEnv is a valid categoryID argument for the /category switch
                   and the /categories switch.

If no options are specified the GUI interface will open.

MSinfo32 can also be started from Help ➞ About rather than the command line, it is not normally in the system path, but can usually be found in:  
C:\Program Files\Common Files\Microsoft Shared\MSInfo\  
  
Generation of the text file can take some time, depending on the complexity of the system.

If you have problems getting MSInfo32 to run, check permissions on the following key: HKLM\SOFTWARE\Microsoft\Shared Tools\MSInfo\  
  
Msinfo32 is a replacement for WINMSD

**Examples:**  
  
Create a text report file in the folder C:\Temp with a name of Test.txt:

msinfo32 /report C:\TEMP\test.txt

Create an NFO report file in the folder C:\Temp with a name of Test.NFO:

msinfo32 /nfo C:\TEMP\test.nfo

View System Information for a remote computer with a UNC name of Server64:

msinfo32 /computer Server64

List all the available category IDs:

msinfo32 /showcategories

Display only System Summary information and create an .nfo file called mysummary.nfo containing the same information:

msinfo32 /nfo mysummary.nfo /categories +systemsummary

“Education is not the filling of a pail, but the lighting of a fire” ~ W. B. Yeats

### Related commands

[SYSTEMINFO](systeminfo.html) - List system configuration.  
Equivalent PowerShell: [Get-CIMInstance](../ps/get-ciminstance.html) - Get WMI class information.



/. nt/mstsc.html
========================================================

    MSTSC - RDP / Terminal Server Connection - Windows CMD - SS64.com #keys{ max-width: 1000px; border: 1px; width: 95%; }

MSTSC
=====

Connect and login to a remote machine using the Remote Desktop Protocol (RDP) also known as Terminal Server Connection (TSC).

Syntax

      MSTSC [_connection_file_] [/v:_server_[:_port_]] [/g:_gateway_] [/admin] [/f[ullscreen]]
         [/w:_width_ /h:_height_] [/public] | [/span] [/multimon] [/edit "_connection file_"]
            [/restrictedAdmin] [/remoteGuard] [/prompt] [/shadow:_sessionID_ [/control] [/noConsentPrompt]]

Options
    "_connection_file_"  The name of an .RDP file to use for the connection.

    /v:_server_[:_port_]   The remote PC to which you want to connect.

    /g:_gateway_         The RD Gateway server to use for the connection.
                      This parameter is only read if the endpoint remote PC is specified with /v.

    /admin     Connect you to the session for administering a remote PC.

    /f         Start Remote Desktop in full-screen mode.

    /w:_width_   Width of the RDP screen

    /h:_height_  Height of the RDP screen

    /public    Run Remote Desktop in public mode. In public mode, passwords and bitmaps are not cached.

    /span      Match the remote desktop width and height with the local virtual desktop, spanning across multiple
              monitors, if necessary. To span across monitors, the monitors must be arranged to form a rectangle.

    /multimon  Configure the Remote Desktop Services session monitor layout to be identical to the current
              client-side configuration.

    /edit      Open the specified .RDP connection file for editing.

    /restrictedAdmin Connect you to the remote PC in Restricted Administration mode.
                    In this mode, credentials won’t be sent to the remote PC, which can protect you if you connect
                    to a PC that has been compromised. However, connections made from the remote PC might not be
                    authenticated by other PCs, which might impact application functionality and compatibility.
                    This parameter implies /admin.

    /remoteGuard     Connect your device to a remote device using Remote Guard.
                    Remote Guard prevents credentials from being sent to the remote PC, which can help protect your
                    credentials if you connect to a remote PC that has been compromised.
                    Unlike Restricted Administration mode, Remote Guard also supports connections made from the remote
                    PC by redirecting all requests back to your device.

    /prompt          Prompt for your credentials when you connect to the remote PC.

    /shadow:_sessionID_  The ID of the session to shadow.

    /control           Allow control of the session when shadowing.

    /noConsentPrompt   Allow shadowing without user consent.

To connect to a remote computer the user account must be a member of the local group 'Remote Desktop users' on the remote server (either directly or inherited via a global group) in addition the user account needs the privilege [SeRemoteInteractiveLogonRight](ntrights.html) (allow logon through RDP/Terminal Services.)

The command [CMDKEY](cmdkey.html) can be used to setup/save the password credentials used by Remote Desktop.

Shortcut Keys
-------------

> Shortcut keys that can be used when connected to a Remote Desktop:
> 
> Windows Shortcut
> 
> Remote Desktop
> 
> Description
> 
> Ctrl+ALT+Del
> 
> Ctrl+ALT+END
> 
> Bring up the Windows Security dialog box - this allows changing your password.  
> Alternatively run C:\Windows\explorer.exe shell:::{2559a1f2-21d7-11d4-bdaf-00c04f60b9f0}
> 
> ALT+TAB
> 
> ALT+Page Up
> 
> Switch between programs from left to right.
> 
> ALT+Shift+TAB
> 
> ALT+Page Down
> 
> Switch between programs from right to left.
> 
> ALT+Esc  
> ALT+Shift+Esc
> 
> ALT+INSERT
> 
> Switch between programs in the order they were started.
> 
> Ctrl+Esc
> 
> ALT+HOME
> 
> Display the Start menu.
> 
> n/a
> 
> Ctrl+ALT+BREAK
> 
> Switch the client between full-screen mode and window mode.
> 
> ALT+Space Bar
> 
> ALT+Delete
> 
> Displays the remote window's Control menu
> 
> ALT+Print Screen
> 
> Ctrl+ALT+NumPad MINUS
> 
> Place an image of active window onto the Terminal Services clipboard.
> 
> Print Screen
> 
> Ctrl+ALT+NumPad PLUS
> 
> Place an image of the entire TS client on the Terminal Services clipboard.  
> This is almost the same as pressing ALT+Print Screen to capute the window locally but removes the Windows chrome and so shows more of the remote window.
> 
> If the RDP shortcut keys don’t work - this is dependent on your RDP options/settings.  
> The window may need to be full screen to accept shortcut keys.
> 
> ![RDP Shortcut Keys](rdp.png)
> 
> All the RDP connection settings can be saved to a .rdp file, which you can then run from a shortcut:
> 
> ![Save RDP settings](rdpconn.png)
> 
> The default settings are saved in default.rdp, you can also edit the .rdp file, the settings while [scarcely](https://web.archive.org/web/20090923131256/http://blogs.msdn.com/rds/archive/2008/09/02/specifying-the-ts-client-start-location-on-the-virtual-desktop.aspx) documented all in plain text.

### Examples

MSTSC /v:MyServer /f /admin  
MSTSC /v:127.0.0.1 /w:1024 /h:768  
MSTSC /v:MyServer /w:800 /h:600  
MSTSC /edit filename.rdp

Error: "Your credentials did not work"

> This error can have several causes:
> 
> If using a domain account, prefix with the domain name: SS64dom\user64  
> If the account is a non-administrator, you may need to grant logon rights as described above.  
> If the password contains any special characters: $,/,\, Tabs etc then copy and paste of the password to an RDP session may not work.  
> Specific problems: copy/paste will convert TABs into spaces and double $$'s are removed (e.g. Pa$$word1)

“Ignorance is preferable to error; and he is less remote from the truth who believes nothing, than he who believes what is wrong” - Thomas Jefferson

### Related commands

[Q216783](https://support.microsoft.com/en-gb/help/216783/) - Keep-Alive Disconnected TS Connections  
[Q2726399](https://support.microsoft.com/en-gb/help/2726399/) - Cannot change the DPI setting through an RDP session.  
[MAPISEND](mapisend.html) - Send email from the command line.  
[RMTSHARE](rmtshare.html) - Share a folder or printer.  
[SHORTCUT](shortcut.html) - Create a windows shortcut.  
SHADOW - Monitor/View another users running RDP session.  
[SHUTDOWN](shutdown.html) - Shutdown the computer/Log off a user.  
[TSDISCON](tsdiscon.html) - Disconnect a Remote Desktop Session.  
[VMConnect](vmconnect.html) - Connect to a Hyper-V Virtual Machine.  
[Microsoft Quick Assist](https://support.microsoft.com/en-us/windows/solve-pc-problems-over-a-remote-connection-b077e31a-16f4-2529-1a47-21f6a9040bf3) - Based on the Remote Desktop Protocol, Quick Assist allows for remote viewing and control of another device.  
[Remote Desktop Services Shortcut Keys](https://docs.microsoft.com/en-gb/windows/desktop/TermServ/terminal-services-shortcut-keys) - Microsoft.  
Equivalent bash command (Linux): VNCconnect or [screen](../bash/screen.html)



/. nt/net.html
========================================================

    Net - Services, File/Print shares, Permissions - Windows CMD - SS64.com

NET.exe
=======

The NET Command is used to manage network resources as follows:

> [NET ACCOUNTS, USER, GROUP, LOCALGROUP](net-useradmin.html) - Logins & Security.
> 
> [NET COMPUTER, CONFIG_](net-config.html) - Network configuration (Workstation/Server).  
>   
> [NET FILE, SESSIONS](net-session.html) - Manage open files and user sessions.
> 
> [NET HELP, HELPMSG](net-help.html) - Help.
> 
> [NET PRINT](net-print.html) - Manage Network Print jobs.
> 
> [NET TIME](net-time.html) - Manage Network Time.
> 
> [NET START, STOP, PAUSE, CONTINUE](net-service.html) - Manage Services.

File and printer sharing:

> [NET SHARE](net-share.html) - Create file and printer shares.
> 
> [NET USE](net-use.html) - Connect to a file/print Share (Drive Map).
> 
> [NET VIEW](net-view.html) - View file and printer shares.

When using a NET command in a batch file, you can use the /Y or /N switch to unconditionally answer Yes or No to questions returned by the Net command.

NET1.exe – in Windows NT and Windows 2000 the NET1.exe command was made available as a quick fix for a Y2K issue. This Y2K issue with the NET command was corrected in Windows XP but NET1.exe is retained to maintain compatibility with older scripts that used NET1.

“The white man knows how to make everything but he does not know how to distribute it” ~ Sitting Bull

### Related commands

[Enable Admin Shares](syntax-admin-share.html)  
[MODE](mode.html) - Configure a system device.  
[NETDOM](netdom.html) - Domain Manager.  
[OPENFILES](openfiles.html) - Query or display open files.  
[PRNMNGR](prnmngr.html) - Add, delete, list printers and printer connections.  
[SC](sc.html) - Service Control  
[Q149427](https://support.microsoft.com/en-gb/help/14087/) - Change Password from the CMD prompt.  
Equivalent bash commands (Linux): [groups](../bash/groups.html) - group names a user is in, [users](../bash/users.html) - login names of users currently logged in.



/. nt/netdom.html
========================================================

    Netdom - Windows CMD - SS64.com

NETDOM.exe
==========

Domain Manager - Manage Machine Accounts and Passwords.

 [NETDOM ADD](netdom-add.html)        Add a workstation or server account to the domain
 [NETDOM COMPUTERNAME](netdom-computername.html) Manage computer names
 NETDOM HELP       Display help
 [NETDOM JOIN](netdom-join.html)       Join a workstation or member server to the domain
 [NETDOM MoveNT4BDC](netdom-bdc.html) Rename an NT4 backup domain controller
 [NETDOM MOVE](netdom-move.html)       Move a workstation or member server to a new domain
 [NETDOM QUERY](netdom-query.html)      Query the domain for information
 [NETDOM TRUST](netdom-trust.html)      Manage or verify the trust relationship between domains
 [NETDOM REMOVE](netdom-remove.html)     Remove a workstation or server from the domain.
 [NETDOM RENAMECOMPUTER](netdom-renamecomputer.html) Rename a computer.
 [NETDOM RESETPWD](netdom-resetpwd.html)   Reset the machine account password for a domain controller
 [NETDOM RESET](netdom-reset.html)      Reset the secure connection between a PC and a DC
 [NETDOM VERIFY](netdom-verify.html)     Verify the secure connection between a PC and a DC

NetDom is available as part of the Remote Server Administration Tools ([RSAT](/links/windows.html#kits "Remote Server Administration Tools")) on clients or on a Server OS by default, with the AD DS or AD LDS server roles.

To enable NETDOM: Control Panel ➞ Programs and Features ➞ Windows features ➞ Remote Server Administration Tools ➞ Role Administration Tools ➞ AD DS and AD LDS Tools ➞ select AD DS Tools.

“Technology is ruled by two types of people: those who manage what they do not understand, and those who understand what they do not manage” ~ Mike Trout

### Related commands

[Q216393](https://support.microsoft.com/en-gb/help/216393/) - Resetting computer accounts in Windows.



/. nt/netsh.html
========================================================

    Netsh - Windows CMD - SS64.com

NETSH (Network Shell)
=====================

Configure Network Interfaces, Windows Firewall, Routing & remote access.

Syntax

      NETSH [_Context_] [_sub-Context_] _command_

Key
    The contexts and commands available vary by platform, the list below is for **Windows Server 2016**.
    Use interactive mode/help (described below) to check the commands available on your machine.

    abort           - Discard changes made while in offline mode.
    add             - Add a configuration entry to a list of entries.
      netsh add helper  - Install the specified helper DLL

    advfirewall    - Change the 'netsh advfirewall' context.

      netsh advfirewall consec ?              - Display a list of commands.
      netsh advfirewall consec add            - Add a new connection security rule.
      netsh advfirewall consec delete         - Delete all matching connection security rules.
      netsh advfirewall consec dump           - Display a configuration script.
      netsh advfirewall consec set            - Set new values for properties of an existing rule.
      netsh advfirewall consec show           - Display a specified connection security rule.

      netsh advfirewall dump    Create a script that contains the current configuration.
                                If saved to a file, this can be used to restore the configuration settings.

      netsh advfirewall export _path\filename_  - Export the current policy to the specified file.
      netsh advfirewall import _path\filename_  - Import policy from the specified file.

      netsh advfirewall firewall add          - Add a new inbound or outbound firewall rule.
      netsh advfirewall firewall delete       - Delete all matching inbound rules.
      netsh advfirewall firewall dump         - Display a configuration script.
      netsh advfirewall firewall set          - Set new values for properties of a existing rule.
      netsh advfirewall firewall show         - Display a specified firewall rule.
      netsh advfirewall firewall show rule name=all   - Show all firewall rules.

      netsh advfirewall monitor delete        - Delete all matching security associations.
      netsh advfirewall monitor dump          - Display a configuration script.
      netsh advfirewall monitor show          - Show all matching security associations.

      netsh advfirewall reset   - Reset to factory settings (Firewall=ON)

      netsh advfirewall set allprofiles    - Set properties in all profiles.
      netsh advfirewall set currentprofile - Set properties in the active profile.
      netsh advfirewall set domainprofile  - Set properties in the domain profile.
      netsh advfirewall set global         - Set the global properties.
      netsh advfirewall set privateprofile - Set properties in the private profile.
      netsh advfirewall set publicprofile  - Set properties in the public profile.

      netsh advfirewall show allprofiles    - Display firewall rules for all profiles.
      netsh advfirewall show currentprofile - Display firewall rules for the active profile.
      netsh advfirewall show domainprofile  - Display properties for the domain properties.
      netsh advfirewall show global         - Display the global firewall rules.
      netsh advfirewall show privateprofile - Display firewall rules for the private profile.
      netsh advfirewall show publicprofile  - Display firewall rules for the public profile.
      netsh advfirewall show store          - Display the policy store for the current interactive session.
  alias          - Add an alias.
  branchcache    - Change to the 'netsh branchcache' context.
  bridge         - Change to the 'netsh bridge' context.
      netsh bridge dump           - Display a configuration script.
      netsh bridge install        - Install the component corresponding to the current context.
      netsh bridge set            - Set configuration information.
      netsh bridge show           - Display information.
      netsh bridge uninstall      - Remove the component corresponding to the current context.
  bye            - Exit the program.
  commit         - Commit changes made while in offline mode.
  delete         - Delete a configuration entry from a list of entries.
      netsh delete helper   Remove the specified helper DLL from netsh.
      Note that after a helper is removed, it is no longer supported by netsh.
  dhcp           - Change to the 'DHCP' context.
  dhcpclient     - Change to the 'netsh dhcpclient' context.
      netsh dhcpclient list            - List all the commands available.
      netsh dhcpclient trace enable    - Enable tracing for DHCP client and DHCP QEC.
      netsh dhcpclient trace disable   - Disable tracing for DHCP client and DHCP QEC.
  dnsclient      - Change the 'netsh dnsclient' context.
  dump           - Display a configuration script.
      netsh dump    - Create a script that contains the current configuration.
                      If saved to a file, this can be used to restore the configuration settings.

  exec           - Run a script file.
  exit           - Exits the program.

  firewall       - Change to the 'netsh firewall' context.
      netsh firewall add                - Add firewall configuration.
      netsh firewall delete             - Delete firewall configuration.
      netsh firewall dump               - Display a configuration script.
      netsh firewall reset              - Reset firewall configuration to default.
      netsh firewall set allowedprogram - Set firewall allowed program configuration.
      netsh firewall set icmpsetting    - Set firewall ICMP configuration.
      netsh firewall set logging        - Set firewall logging configuration.
      netsh firewall set multicastbroadcastresponse - Set firewall multicast/broadcast response configuration.
      netsh firewall set notifications  - Set firewall notification configuration.
      netsh firewall set opmode         - Set firewall operational configuration.
      netsh firewall set portopening    - Set firewall port configuration.
      netsh firewall set service        - Set firewall service configuration.
      netsh firewall show allowedprogram - Show firewall allowed program configuration.
      netsh firewall show config         - Show firewall configuration.
      netsh firewall show currentprofile - Show current firewall profile.
      netsh firewall show icmpsetting    - Show firewall ICMP configuration.
      netsh firewall show logging        - Show firewall logging configuration.
      netsh firewall show multicastbroadcastresponse - Show firewall multicast/broadcast response configuration.
      netsh firewall show notifications  - Show firewall notification configuration.
      netsh firewall show opmode         - Show firewall operational configuration.
      netsh firewall show portopening    - Show firewall port configuration.
      netsh firewall show service        - Show firewall service configuration.
      netsh firewall show state          - Show current firewall state.

  help           - Display a list of netsh commands.
      netsh help

  http           - Change to the 'netsh http' context.
      netsh http add            - Add a configuration entry to a table.
      netsh http delete         - Delete a configuration entry from a table.
      netsh http delete sslcert ipport=_0.0.0.0_:443  - Delete an expired SSL cert.
      netsh http delete sslcert hostnameport=_localhost_:443  - Delete an expired SSL cert.
      netsh http dump           - Display a configuration script.
      netsh http flush          - Flush internal data.
      netsh http show           - Display information.
      netsh http show cacheparam - Show the cache parameters of the HTTP service.
      netsh http show cachestate  - List cached URI resources and their associated properties.
      netsh http show iplisten    - Display all the IP addresses in the IP listen list.
      netsh http show servicestate - Show a snapshot of the HTTP service.
      netsh http show setting   - Show the setting values of the service.
      netsh http show sslcert   - Display SSL certificate bindings.
      netsh http show timeout   - Show the timeout values of the service.
      netsh http show urlacl    - Display URL namespace reservations.

  interface      - Change to the 'netsh interface' context.
      netsh interface 6to4           + Change to the 'netsh interface 6to4' context.
      netsh interface add            - Add a configuration entry to a table.
      netsh interface delete         - Delete a configuration entry from a table.
      netsh interface dump           - Display a configuration script.
      netsh interface ipv4           + Change to the 'netsh interface ipv4' context.
      netsh interface ipv6           + Change to the 'netsh interface ipv6' context.
      netsh interface isatap         + Change to the 'netsh interface isatap' context.
      netsh interface portproxy      + Change to the 'netsh interface portproxy' context.
      netsh interface reset          - Reset information.
      netsh interface set            - Set configuration information.
      netsh interface show interface - Display the network interface status.
      netsh interface ip show interfaces - Display
      netsh interface tcp            + Change to the 'netsh interface tcp' context.
      netsh interface teredo         + Change to the 'netsh interface teredo' context.

  ipsec          - Change to the 'netsh ipsec' context.
      netsh ipsec dump                  - Display a configuration script.
      netsh ipsec dynamic add           - Add policy, filter, and actions to SPD.
      netsh ipsec dynamic delete        - Delete policy, filter, and actions from SPD.
      netsh ipsec dynamic dump          - Display a configuration script.
      netsh ipsec dynamic set           - Modifiy policy, filter, and actions in SPD.
      netsh ipsec dynamic show          - Display policy, filter, and actions from SPD.
      netsh ipsec static add            - Create new policies and related information.
      netsh ipsec static delete         - Delete policies and related information.
      netsh ipsec static dump           - Display a configuration script.
      netsh ipsec static exportpolicy   - Export all the policies from the policy store.
      netsh ipsec static importpolicy   - Import the policies from a file to the policy store.
      netsh ipsec static set            - Modify existing policies and related information.
      netsh ipsec static show           - Display details of policies and related information.

  ipsecdosprotection - Change to the 'netsh ipsecdosprotection' context.
  lan            - Change to the 'netsh lan' context.
      netsh lan add            - Add a configuration entry to a table.
      netsh lan delete         - Delete a configuration entry from a table.
      netsh lan dump           - Display a configuration script.
      netsh lan export         - Save LAN profiles to XML files.
      netsh lan reconnect      - Reconnect on an interface.
      netsh lan set            - Configure settings on interfaces.
      netsh lan show           - Display information.

  mbn           - Change to the 'netsh mbn context.
  namespace     - Change to the 'netsh namespace' context.

  netio          - Chang to the 'netsh netio' context.
      netsh netio add          - Add a configuration entry to a table.
      netsh netio delete       - Delete a configuration entry from a table.
      netsh netio dump         - Display a configuration script.
      netsh netio show         - Display information.
  offline       - Set the current mode to offline.
  online        - Set the current mode to online.
  p2p           - Change to the 'netsh p2p' context.
  popd          - Pop a context from the stack.
  pushd         - Pushe current context on stack.
  quit          - Exit the program.
  ras            - Change to the 'netsh ras' context. (Remote Access Server)
      netsh ras aaaa           - Change to the 'netsh ras aaaa' context.
      netsh ras add            - Add items to a table.
      netsh ras delete         - Remove items from a table.
      netsh ras diagnostics    - Change to the 'netsh ras diagnostics' context.
      netsh ras dump           - Display a configuration script.
      netsh ras ip             - Change to the 'netsh ras ip' context.
      netsh ras ipv6           - Change to the 'netsh ras ipv6' context.
      netsh ras set            - Set configuration information.
      netsh ras show           - Display information.

  routing        - Change to the 'netsh routing' context.
  rpc            - Change to the 'netsh rpc' context. (RPC firewall filter)
      netsh rpc add            - Create an Add list of subnets.
      netsh rpc delete         - Create a Delete list of subnets.
      netsh rpc dump           - Display a configuration script.
      netsh rpc filter         - Change to the 'netsh rpc filter' context.
      netsh rpc reset          - Reset the selective binding settings to 'none' (listen on all interfaces).
      netsh rpc show           - Display the selective binding state for each subnet on the system.

    set            - Update configuration settings on a remote machine.
      netsh set machine [name=] [user=][[DomainName\]UserName] [pwd=][Password | *]

    If a machine name is not specified, the local machine is used.
    A username and password cannot be used to connect to the local machine.

    show           - Display information.
      netsh show alias   - List all defined aliases.
      netsh show helper  - List all the top-level helpers.

    trace         - Change to the 'netsh trace' context.
      netsh trace convert   - Convert a trace file to an HTML export.
      netsh trace correlate - Normailse or filter a trace file to a new output file.
      netsh trace diagnose  - Start a dignose session.
      netsh trace dump    - Display a configuration script.
      netsh trace export  - Export a scenario to a WPR profile.
      netsh trace help    - display help
      netsh trace merge   - Merge trace files and add symbols metadata.
      netsh trace postreset - ?
      netsh trace start - Start tracing.
      netsh trace stop  - Stop tracing.

    unalias       - Delete an alias.
    wcn           - Change to the 'netsh wcn' context (Wireless config/connect).
    wfp           - Change to the 'netsh wfp' context, Windows Filtering Platform (WFP).
    winhttp       - Change to the 'netsh winhttp' context.
      netsh winhttp dump      - Display a configuration script.
      netsh winhttp import    - Import WinHTTP proxy settings.
      netsh winhttp reset     - Reset WinHTTP settings.
      netsh winhttp set       - Configure WinHTTP settings.
      netsh winhttp show      - Display currents settings.

    winsock        - Change to the 'netsh winsock' context.
      netsh winsock audit     - Display a list of Winsock LSPs that have been installed and removed.
      netsh winsock dump      - Display a configuration script.
      netsh winsock remove    - Remove a Winsock LSP from the system.
      netsh winsock reset     - Reset the Winsock Catalog to a clean state.
      netsh winsock show      - Display information.

    wlan        - Change to the 'netsh wlan' context (wireless lan).
      netsh wlan add          - Add a configuration entry to a table.
      netsh wlan connect      - Connect to a wireless network.
      netsh wlan delete       - Delete a configuration entry from a table.
      netsh wlan disconnect   - Disconnect from a wireless network.
      netsh wlan dump         - Display a configuration script.
      netsh wlan export       - Save WLAN profile to an XML file.
      netsh wlan help  or ?   - Display a list of commands.
      netsh wlan IHV          - Commands for IHV logging.
      netsh wlan refresh      - Refresh hosted network settings.
      netsh wlan reportissues - Generate WLAN smart trace report.
      netsh wlan set          - Set configuration information.
      netsh wlan show         - Display information.
      netsh wlan start        - Start hosted network.
      netsh wlan stop         - Stop hosted network.

    netsh                      - Interactive mode

In interactive mode, switch context by typing any context name: advfirewall, bridge, firewall, http, interface, ipsec.. etc  
Then list the available commands with ?  
Exit interactive mode with Quit or Exit.  
To view help for any command, type the command, followed by a space and ?

For run Netsh against a remote machine, both _File and Printer sharing_ must be enabled and the _Remote Registry_ [service](syntax-services.html) must be running on the remote machine.

The syntax above is based on Windows 2016. For backwards compatibility dns is an alias for dnsserver and ip is an alias for ipv4.

Most NETSH options require [elevation](syntax-elevate.html).

### Examples

Enable or Disable File and Printer Sharing:

C:> netsh advfirewall firewall set rule group="File and Printer Sharing" new enable=**Yes**  
C:> netsh advfirewall firewall set rule group="File and Printer Sharing" new enable=**No**

Install ipmontr.dll:  
C:> netsh advfirewall net add helper ipmontr.dll  
  
Export the fiewall policy:  
C:> netsh advfirewall export "c:\advfirewallpolicy.wfw"  
  
Enable or Disable the LAN connection:

C:> netsh interface set interface name="Local Area Connection" admin=DISABLED  
C:> netsh interface set interface name="Local Area Connection" admin=ENABLED

Show TCP/IP settings:  
C:> netsh interface ip show config  
C:> netsh interface ipv4 show config  
C:> netsh interface ipv6 show config  
  
Set a static IP address (e.g. for a laptop)  
C:> netsh interface ip set address name="Local Area Connection" source=static addr=192.168.0.10 mask=255.255.255.0 gateway=192.168.0.1 gwmetric=1  
  
Set a dynamic IP address with DHCP  
C:> netsh interface ip set address name="Local Area Connection" source=dhcp  
  
Add multiple DNS servers:  
C:> netsh interface ipv4 add dns "Local Area Connection" 10.0.0.1  
C:> netsh interface ipv4 add dns "Local Area Connection" 10.0.0.3 index=2  
index=2 adds the IP as a secondary dns server.  
  
Set a static DNS server address:  
C:> netsh interface ip set dns name="Local Area Connection" source=static addr=192.168.0.2 register=none

> Working with foreign locales: you cannot rely on the interface name being English e.g. in French the _Local Area Network_ is called "_Connexion au réseau local_" (why yes that is unicode!) To display the different interfaces with their index numbers:  
> C:> netsh interface ip show interfaces  
> Knowing the index number (the main/active interface tends to be 13.) we can set a static address/gateway using the index number:  
> C:> netsh interface ip set address **13** static 192.168.0.10 255.255.255.0 192.168.0.1 1

Set a dynamic DNS server address with DHCP:  
C:> netsh interface ip set dns name="Local Area Connection" source=dhcp  
  
Set a static address for the WINS server:  
C:> netsh interface ip set wins name="Local Area Connection" source=static addr=192.168.100.3  
  
To configure WINS from DHCP:  
C:> netsh interface ip set wins name="Local Area Connection" source=dhcp

List general configuration state including DirectAccess and DNSSEC.  
C:> netsh dns show state

Disable IPv6 [privacy](https://blog.bimajority.org/2014/09/05/the-network-nightmare-that-ate-my-week/) extensions:  
C:> netsh interface ipv6 set privacy state=disabled store=persistent (saved configuration)  
C:> netsh interface ipv6 set privacy state=disabled store=active (running configuration)  
  
Backup the local DHCP server configuration to a file:  
C:> netsh dump dhcp > C:\backupDHCPconfig.dat  
You can use this backup file to recreate the DHCP server with Netsh .  
  
Work against a remote machine:  
C:> netsh set machine server64

Run a network capture to the file c:\temp\ss64.etl

C:> netsh trace start capture=yes tracefile=c:\temp\ss64.etl report=no maxsize=500mb  
C:> netsh trace stop

Run a network capture with the persistent=yes argument. This will survive a reboot and capture network traffic while Windows is starting.

C:> netsh trace start persistent=yes capture=yes tracefile=c:\temp\ss64.etl report=no maxsize=500mb  
C:> netsh trace stop  
  
Backup the current network interface configuration to a file:  
C:> netsh dump interface > c:\backupInterfaceConfig.dat  
  
Restore network interface configuration from a file:  
C:> netsh exec c:\backupInterfaceConfig.dat

Run Netsh from [PowerShell](../ps/) (returns a Text object you can manipulate)  
PS C:> $myFWstate=netsh firewall show state  
PS C:> $myFWstate -match "disable"

Disable Network auto-tuning (certain routers and networking devices perform better with this off.)  
PS C:> netsh interface tcp set global autotuning=disabled

Enable Network auto-tuning (certain routers and networking devices perform better with this on.)  
PS C:> netsh interface tcp set global autotuning=normal

Remove a wireless network profile, ([script to remove all](https://www.leeholmes.com/removing-insecure-wireless-connections-with-powershell/) insecure profiles).  
PS C:> netsh wlan delete profile name="CentralPerkCoffee"

"Once you eliminate your #1 problem, #2 gets a promotion" ~ Gerald Weinberg, "The Secrets of Consulting"

### Related commands

[Netsh command reference](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc754516(v=ws.10)?redirectedfrom=SS64) - Microsoft.com  
[Q242468](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-xp/bb490939(v=technet.10)) - How to Use the Netsh.exe Tool.  
[DNSCMD](dnscmd.html) - Manage DNS servers.  
[NVSPBIND](nvspbind.html) - Modify network bindings (Unsupported tool.)  
[NETSH](https://docs.microsoft.com/en-us/windows-server/networking/technologies/netsh/netsh-contexts) - Change from Static IP Address to DHCP with NETSH.  
[ROUTE](route.html) - Manipulate network routing tables.  
PowerShell: New-NetEventSession  
Equivalent bash command (Linux): [ifconfig](../bash/ifconfig.html) - Interface configurator



/. nt/nbtstat.html
========================================================

    Nbtstat - Netbios Statistics - Windows CMD - SS64.com

NBTSTAT.exe
===========

Display protocol statistics and current TCP/IP connections using NBT (NetBIOS over TCP/IP).  
NetBIOS has been deprecated since 2000 disabling NetBIOS can greatly enhance the security status of a network.

Syntax

    By Name
      NBTSTAT -a _Remote_host_Name_ [_options_] [_interval_] 

    By IP address
      NBTSTAT -A _IP_address_ [_options_] [_interval_]

Key
  -a   (adapter status) List the remote machine's name table given its name
  -A   (Adapter status) List the remote machine's name table given its IP address
  -c   (cache)          List NBT's cache of remote [machine] names and their IP addresses.
  -n   (names)          List local NetBIOS names.
  -r   (resolved)       List names resolved by broadcast and via WINS
  -R   (Reload)         Purge and reloads the remote cache name table
  -S   (Sessions)       List sessions table with the destination IP addresses
  -s   (sessions)       List sessions table converting destination IP addresses
                        to computer NETBIOS names.
  -RR  (ReleaseRefresh) Send Name Release packets to WINS and then, starts Refresh

  _interval_                Redisplay selected statistics, pausing _interval_ seconds
                        between each display. Press Ctrl+C to stop redisplaying statistics.

_“I could prove God statistically” ~ George Gallup_

### Related commands

[IPCONFIG](ipconfig.html) - IP Configuration.  
[NETSTAT](netstat.html) - Display networking statistics (TCP/IP).  
[PING](ping.html) - Test a network connection.  
[TRACERT](tracert.html) - Trace route to a remote host.  
[Q163409](https://web.archive.org/web/20120418234655/https://support.microsoft.com/kb/163409) - The 16th character is a NetBIOS suffix.  
[Q172218](https://support.microsoft.com/en-gb/help/172218/) - Microsoft TCP/IP Host Name Resolution Order.  
Equivalent bash command (Linux): trace - Find the IP address of a remote host.



/. nt/netstat.html
========================================================

    Netstat - TCP/IP network connections - Windows CMD - SS64.com

NETSTAT.exe
===========

Display current TCP/IP network connections and protocol statistics.

Syntax

    NETSTAT [_options_] [-p _protocol_] [_interval_]

Key
    -a   Display All connections and listening ports.
    -e   Display Ethernet statistics. (may be combined with -s)
    -n   Display addresses and port numbers in Numerical form.
    -r   Display the Routing table.
    -o   Display the Owning process ID associated with each connection.

    -b   Display the exe involved in creating each connection or listening port.*****
    -v   Verbose - use in conjunction with -b, to display the sequence of
        components involved for all executables.

    -p _protocol_
        Show only connections for the protocol specified; 
        can be any of: TCP, UDP, TCPv6 or UDPv6.  
        If used with the -s option then the following protocols
        can also be specified: IP, IPv6, ICMP,or ICMPv6. 

    -s   Display per-protocol statistics.  By default, statistics are
        shown for IP, IPv6, ICMP, ICMPv6, TCP, TCPv6, UDP, and UDPv6;
        (The v6 protocols are not available under 2k and NT4)
        The -p option can be used to display just a subset of these.

    _interval_     Redisplay statistics, pausing _interval_ seconds between
                each display. (default=once only) Press CTRL+C to stop. 

***** Where available this will display the sequence of components involved in creating the connection or listening port. (Typically well-known executables which host multiple independent components.) This option will display the executable name in [ ] at the bottom, with the component it called on top, repeated until TCP/IP is reached. The -b option can be time-consuming and will fail unless you have sufficient permissions.

"Once you're on the network, you can do a command called NetStat - Network Status - and it lists all the connections to that machine. There were hackers from Denmark, Italy, Germany, Turkey, Thailand ..." ~ [Gary McKinnon](https://www.theguardian.com/theguardian/2005/jul/09/weekend7.weekend2)

### Related commands

[BROWSTAT](browstat.html) - Get domain, browser and PDC info.  
[ROUTE](route.html) - Manipulate network routing tables.  
[PATHPING](pathping.html) - IP trace utility.  
[PING](ping.html) - Test a network connection.  
Equivalent bash command (Linux): [netstat](../bash/netstat.html)  
Equivalent PowerShell: [Get-NetStat](https://github.com/TobiasPSP/GetNetStat) (module) , [Get-NetTCPConnection](../ps/get-nettcpconnection.html)



/. nt/nltest.html
========================================================

    .grey {color: #666;} nltest - Windows CMD - SS64.com

NLTEST.exe
==========

Network Location Test - List domain controllers(DCs), Force a remote shutdown, Query the status of trust,  
test trust relationships and the state of domain controller replication.

Syntax

      NLTEST [/server:_servername_] [_operation_[_parameter_]

Key
    /server: _ServerName_ 
            Run nltest at a remote domain controller: _ServerName_.
            default = the local computer (a domain controller).

    /query   Report on the state of the secure channel the last time you used it.
            (The secure channel is the one that the NetLogon service established.)

    /repl    Force synchronization with the primary domain controller (PDC).
            Nltest synchronizes only changes that are not yet replicated to the backup
            domain controller (BDC). NT 4.0 BDCs only, not for Active Directory replication.
            You must have administrative credentials to use this parameter.

    /sync    Force an immediate synchronization with the PDC of the entire SAM database.
            NT 4.0 BDCs only, not for Active Directory replication.
            You must have administrative credentials to use this parameter.

    /pdc_repl Force the PDC to send a synchronization notification to all BDCs.
            NT 4.0 PDCs only, not for Active Directory replication.
            You must have administrative credentials to use this parameter.

    /sc_query: _DomainName_
             Report on the state of the secure channel the last time that you used it.
            (The secure channel is the one that the NetLogon service established.)
            This parameter lists the name of the domain controller that you queried on the
            secure channel, also.

    /sc_reset:[ _DomainName_]
            Remove, and then rebuild, the secure channel that the NetLogon service established.
            You must have administrative credentials to use this parameter.

    /sc_verify:[ _DomainName_]
            Check the status of the secure channel that the NetLogon service established.
            If the secure channel does not work, this parameter removes the existing channel, and
            then builds a new one. You must have administrative credentials to use this parameter.

    /sc_change_pwd:[ _DomainName_]
            Change the password for the trust account of a domain that you specify.
            If you run nltest on a domain controller, and an explicit trust relationship exists,
            then nltest resets the password for the interdomain trust account.
            Otherwise, nltest changes the computer account password for the domain that you specify.

    /dclist:[ _DomainName_]
            List all DCs in the domain.
            This command first queries Active Directory for a list of DCs.
            If this query is unsuccessful, nltest then uses the Browser service (if netbios is enabled).

    /dcname:[ _DomainName_]
            List the primary domain controller or the PDC emulator for DomainName.

    /**ds**getdc:[ _DomainName_]
            Query the Domain Name System (DNS) server for a list of DCs and their
            IP addresses. This parameter also contacts each domain controller to check for connectivity.
            The following list shows the values that you can use to filter the list of DCs
            or specify alternate names types in the syntax.

            /PDC: Return only the PDC (Windows NT 4.0) or domain controllers designated as the PDC
                  emulator (Windows 2000 and later).
            /DS:  Return only those DCs that are Windows 2000 and later.
            /DSP: Return only Windows 2000 and later DCs. If the query finds no such server,
                  then return Windows NT 4.0 DCs.
            /GC:  Return only those DCs that are designated as global catalog servers.
            /KDC: Return only those DCs that are designated as Kerberos key distribution centers.
            /TIMESERV: Return only those DCs that are designated as time servers.
            /GTTIMESERV: Return only DCs designated as master time servers.
            /WS: /NetBIOS: Specifies computer names in the syntax as NetBIOS names.
            /DNS: Specify computer names in the syntax as fully qualified domain names (FQDNs).
                  If you do not specify a return format, the DC can return either NetBIOS or DNS format.
            /IP:  Return only DCs that have IP addresses. i.e. return only TCP/IP DCs.
            /FORCE: Force the computer to run the command against the DNS server instead of looking in
                    the cache for the information.
            /Writable: Require that the returned DC be writable; All Windows 2000 DCs are writable
            /Avoidself: When called from a DC, specifies that the returned DC name should
                        not be the current computer. If the current computer is not a DC, this flag is ignored.
                        This flag can be used to obtain the name of another DC in the domain.
            /LDAPOnly: Specifies that the server returned is an LDAP server. The server returned is not
                       necessarily a DC. This flag can be used with the DS_GC_SERVER_REQUIRED flag
                       to return an LDAP server that also hosts a global catalog server.
                       If this flag is specified, the DS_PDC_REQUIRED, DS_TIMESERV_REQUIRED, 
                       DS_GOOD_TIMESERV_PREFERRED, DS_DIRECTORY_SERVICES_PREFERED,
                       DS_DIRECTORY_SERVICES_REQUIRED, and DS_KDC_REQUIRED flags are ignored.
            /Backg: If the DS_FORCE_REDISCOVERY flag is not specified, this function uses cached DC data.
                    If the cached data is more than 15 minutes old, the cache is refreshed by pinging
                    the DC. If this flag is specified, this refresh is avoided even if the cached data
                    is expired. This flag should be used if the DsGetDcName function is called periodically.
            /DS_6: Require that the returned DC be running Windows Server 2008 or later.
            /DS_8: Require that the returned domain controller be running Windows Server 2012 or later.
            /Try_Next_Closest_Site: When this flag is specified, DsGetDcName attempts to find a DC in
                                    the same site as the caller.
            /Ret_DNS: Specifies that the names returned in the DomainControllerName and DomainName members
                      of DomainControllerInfo should be DNS names.
            /Ret_NETBIOS: Specifies that the names returned in the DomainControllerName and DomainName members
                          of DomainControllerInfo should be flat names.

    /**dns**getdc: _DomainName_
            Query the DNS server for a list of domain controllers and their corresponding IP addresses.
            values that you can use to filter the list of DCs:
               /PDC: Return only those DCs that are PDCs (Windows NT 4.0) or designated as PDC emulators.
               /GC:  Return only those DCs that you designate as global catalogs.
               /KDC: Return only those DCs that you designate as Kerberos key distribution centers.
               /WRITABLE: Return only those DCs that can accept changes to the directory database.
                          This value returns all Active Directory DCs, but not Windows NT 4.0 BDCs.
               /LDAPONLY: Return servers that are running a Lightweight Directory Access Protocol (LDAP) application.
                          The servers can include LDAP servers that are not DCs.
               /FORCE:    Run the command against the DNS server instead of looking in cache.
               /SITE _Sitename_: Sort to list first the records that pertain to _Sitename_.
               /SITESPEC:      Filter the returned records to display only _Sitename_, used only with /SITE.

    /dsgetfti: _DomainName_[ /UpdateTDO]
            Return information about interforest trusts. You use this parameter only for a Windows Server 2008
            domain controller that is in the root of the forest. If no interforest trusts exist, this parameter
            returns an error. The /UpdateTDO value updates the locally stored information on the interforest trust.

    /dsgetsite
            Return the name of the site in which the DC resides.

    /dsgetsitecov
            Return the name of the site that the DC covers. A DC can cover a site
            that has no local DC of its own.

    /parentdomain
            Return the name of the parent domain of the server.

    /dsregdns
            Refreshe the registration of all DNS records that are specific to a DC that you specify.


    /dsderegdns: _DnsHostName_
            Deregisters DNS host records for the host that you specify in the DnsHostName parameter.
            values you can use to specify which records nltest deregisters:
               /DOM:  Specify a DNS domain name for the host to use when you search for records on the DNS server.
                      If you do not specify this value, nltest uses the DNS domain name as the suffix of the
                      DnsHostName parameter.
               /DSAGUID: Deletes Directory System Agent (DSA) records that are based on a GUID.
               DOMGUID: Deletes DNS records that are based on a globally unique identifier (GUID).

    /whowill: _Domain_/ _User_
            Find the DC that has the user account that you specify. Use this parameter to determine
            whether nltest has replicated the account information to other DCs.

    /finduser: _User_
            Find the directly-trusted domain that the user account _User_ belongs to.
            Use this parameter to troubleshoot logon issues of older client operating systems.

    /transport_notify    Flushe the negative cache to force the discovery of a domain controller.
                        You can use this parameter for Windows NT 4.0 domain controllers only.
                        This operation is done automatically when clients log on to Windows 2000 and
                        Windows Server 2003 domain controllers.
    /dbflag: _HexadecimalFlags_
            Set a new debug flag. For most purposes, use 0x2000FFFF as the value for HexadecimalFlags.
            The entry in the Windows Server 2003 registry for debug flags is
            HKLM\System\CurrentControlSet\Services\Netlogon\Parameters\DBFlag.

    /user: _UserName_
            Display many of the attributes that you maintain in the SAM account database for the user that
            you specify. You cannot use this parameter for user accounts that are stored in an AD database.

    /time: _HexadecimalLSL HexadecimalMSL_
            Convert Windows NT Greenwich Mean Time (GMT) time to ASCII. _HexadecimalLSL_ is a hex value for
            least significant longword. _HexadecimalMSL_ is a hexa value for most significant longword.

    /logon_query
            Query the cumulative number of NTLM logon attempts at a console or over a network.

    /domain_trusts
            Returns a list of trusted domains. /Primary /Forest /Direct_Out /Direct_In /All_Trusts /v.
            values that you can use to filter the list of domains:
               /Primary: Return only the domain to which the computer account belongs.
               /Forest: Return only those domains that are in the same forest as the primary domain.
               /Direct_Out: Return only the domains that are explicitly trusted with the primary domain.
               /Direct_In: Return only the domains that explicitly trust the primary domain.
               /All_Trusts: Return all trusted domains.
               /v: Display verbose output, including any domain SIDs and GUIDs that are available.

    /dsquerydns
            Query for the status of the last update for all DNS records that are specific to a DC.

    /bdc_query: _DomainName_
            Query for a list of BDCs in _DomainName_, and then display their state of synchronization
            and replication status. You can use this parameter only for Windows NT 4.0 domain controllers.

    /sim_sync: _DomainName ServerName_
            Simulate full synchronization replication. This is a useful parameter for test environments.

    /list_deltas: _FileName
_            Display the contents of the FileName change log file, which lists changes to the user account 
            database. Netlogon.chg is the default name for this log file, which resides only on Windows NT 4.0 BDCs.

    /cdigest: _Message_ /domain: _DomainName_
            Display the current digest that the client uses for the secure channel.
            (The digest is the calculation that nltest derives from the password.)
            This parameter displays the digest that is based on the previous password, also. Nltest uses
            the secure channel for logons between client computers and a domain controller, or for
            directory service replication between domain controllers. You can use this parameter in
            conjunction with the /sdigest parameter to check the synchronization of trust account passwords.

    /sdigest: <Message> /rid: _RID_In_Hexadecimal_
            Display the current digest that the server uses for the secure channel.
            (The digest is the calculation that nltest derives from the password.)
            This parameter displays the digest for the previous password, also. If the digest from the
            server matches the digest from the client, then nltest synchronizes the passwords that it
            uses for the secure channel. If the digests do not match, then nltest might not have replicated
            the password change yet.

    /shutdown: _Reason_ [_Seconds_]
            Remotely shut down the server that you specify in _ServerName_.
            Use a string to specify the reason for the shutdown in the Reason value.
            Use an integer value of _Seconds_ before the shutdown will occur.
            (see InitiateSystemShutdown in the Platform SDK documentation.)

    /shutdown_abort
            Terminate a system shutdown.

  {/help | /?}   Display help at the command prompt.

If nltest does not appear to be available, enable the _Active Directory Domain Services_ or the _AD LDS server_ role.

### Examples

Verify domain controllers in a domain:

nltest /dclist:ss64dom

Show detailed information about a specific user:

nltest /user:"user64"

Verify trust relationship with a specific server:

nltest /server:ss64-DC01 /sc_query:ss64dom

lags: 30 HAS_IP HAS_TIMESERV  
Trusted DC Name \ss64-DC01.ss64.com  
Trusted DC Connection Status Status = 0 0x0 NERR_Success  
The command completed successfully

_“..If it disagrees with experiment it is wrong. In that simple statement is the key to science. It does not make any difference how beautiful your guess is. It does not make any difference how smart you are, who made the guess, or what his name is – if it disagrees with experiment it is wrong” ~ [Richard Feynman](https://www.youtube.com/watch?v=EYPapE-3FRw)_

### Related commands

[RepAdmin](repadmin.html) - Diagnose Active Directory replication problems between domain controllers.  
[DcDiag](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731968(v=ws.11)) - Analyze the state of domain controllers and report any problems.  
DsMgt - Manage password operations over unsecured connections, AD Lightweight Directory Services application partitions, flexible single master operations (FSMO), and clean up AD metadata.  
[SetSpn](setspn.html) - Read, modify, or delete the Service Principal Names (SPN) for an Active Directory service account.



/. nt/nmbind.html
========================================================

    NMBIND - Windows CMD - SS64.com

NMBIND
======

Manage network bindings on Hyper-V Network Core.

Syntax

      NMBIND [_option_] [NIC|*] [_protocol_|*]

Options

    /n   Display NIC information only.

    /u   Unbind switch protocol from specified nic(s).

    /b   Bind switch protocol to specified nic(s).

    /d   Disable binding of specified protocol from specified nic(s).

    /e   Enable binding of specified protocol to specified nic(s)

Enabling the Hyper-V feature requires Windows 10: Pro or Enterprise and 64-bit Windows.

### Examples

Display NIC information:

C:> NMBIND /n

“There is not a liberal America and a conservative America — there is the United States of America. There is not a Black America and a White America and Latino America and Asian America — there's the United States of America.” ~ Barack Obama

### Related commands

[NSVPBIND](https://gallery.technet.microsoft.com/Hyper-V-Network-VSP-Bind-cf937850) - Hyper-V Network VSP Bind (nvspbind) provided "as-is" (unsupported).



/. nt/now.html
========================================================

    Now - Display message with time - Windows CMD - SS64.com

NOW.exe ([2003 Resource Kit](../links/windows.html#kits))
=========================================================

Display Message with current Date and Time, similar to ECHO but with a date/time stamp.

Syntax

      NOW [_message to be printed with time-stamp_] 

The format of the output is always US english.

**Examples**  

C:> now  
Fri Jun 13 14:56:52 2022

C:> now All complete  
Fri Jun 13 14:58:48 2022 All complete  

“How Soon is Now?” ~ The Smiths

### Related commands

[ECHO](../nt/echo.html) %date% - %time% - Display current the date/time on screen.  
[DATE](../nt/date.html) /t - Display or set the date.  
[LOGTIME](logtime.html) - Log the date and time in a file.  
[timer.cmd](syntax-timer.html) - Measure the run time of a script.  
Equivalent PowerShell: [DateTime]::Now or [Get-Date](../ps/get-date.html)  
Equivalent bash command (Linux): [](../bash/export.html)[date](date.html) - Display or change the date & time.



/. nt/nslookup.html
========================================================

    Nslookup - Name server lookup - Windows CMD - SS64.com

NSLOOKUP (TCP/IP)
=================

Lookup IP addresses on a NameServer.

_Syntax_
  Lookup the ip address of MyHost:

     NSLOOKUP [-_option_] _MyHost_
     
  Lookup ip address of MyHost on MyNameServer:
   
     NSLOOKUP [-_option_] _MyHost MyNameServer_
   
  Enter "command" mode:
   
     NSLOOKUP
Command Mode options:

 help or ?          - print a list of Command Mode options
 exit or ^C         - exit "command mode" 

 set all            - print options, current server and host
 finger [_USER_]      - finger the optional _USER_ at the current default host
 _MyHost_             - print ip address of _MyHost_
 _MyHost_ _MyNameServer_ - print ip address of _MyHost_ on _MyNameServer_
 set [no]debug      - print debugging info
 set [no]d2         - print exhaustive debugging info

 set domain=_NAME_    - set default domain name to _NAME_
 set root=_NAME_      - set root server to _NAME_
 root               - set current default server to the root
 server _NAME_        - set default server to _NAME_, using current default server
 lserver _NAME_       - set default server to _NAME_, using initial server
 set srchlist=_N1_[/_N2_/.../_N6_] - set domain to _N1_ and search list to _N1_, _N2_,...

 set retry=_X_        - set number of retries to _X_
 set timeout=_X_      - set initial time-out interval to _X_ seconds
 set [no]defname    - append domain name to each query
 set [no]recurse    - ask for recursive answer to query
 set [no]search     - use domain search list
 set [no]vc         - always use a virtual circuit
 set class=_X_        - set query class (for example, IN (Internet), ANY)
 set [no]msxfr      - use MS fast zone transfer
 set ixfrver=_X_      - current version to use in IXFR transfer request
 set type=_X_         - set query type 
 set querytype=_X_    - set query type
                      (e.g. A, ANY, CNAME, MX, NS, PTR, SOA, SRV)

 ls [opt] _DOMAIN_ [> _FILE_] - list addresses in _DOMAIN_
                            (and optionally output to _FILE_)

    -d          -  list all records
    -t TYPE     -  list records of the given Type (for example, A, CNAME, 
                   MX, NS, PTR, and so on)
    -a          -  list Aliases and canonical names.

 view FILE       - sort an 'ls' output file and view it with pg

### Examples

C:> nslookup -querytype=TXT -timeout=10 porttest.dns-oarc.net

We are all in the gutter, but some of us are looking at the stars ~ Oscar Wilde (Lady Windermere's Fan 1892)

### Related commands

[NBTSTAT](nbtstat.html) - Display networking statistics (NetBIOS over TCP/IP)  
[NETSTAT](netstat.html) - Display networking statistics (TCP/IP)  
[TRACERT](tracert.html) - Trace route to a remote host.  
[ViewDNS.info](https://viewdns.info/) - IP and DNS lookups.  
[Q200525](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc725991(v=ws.11)) - Using nslookup.  
[network-tools.com](https://network-tools.com/) - nslookup.



/. nt/ntbackup.html
========================================================

    NTBackup - Windows CMD - SS64.com

NTBACKUP (XP/2003)
==================

Backup to tape: drives, folders and systemstate.  
In Vista and above [wbadmin](wbadmin.html) and PowerShell have replaced NTBACKUP.

To recover backups on Windows Server 2008/Vista that were created using ntbackup a 'restore-only' version of NTBACKUP is [available as a download](https://www.microsoft.com/en-us/download/details.aspx?id=4220).

**Syntax**:

    NTBACKUP backup [systemstate] "_@bks file name_"
                /J {"_job name_"} [_options_] [/SNAP:{on|off}] [/um]

**Options**:

_systemstate_
  Back up the System State data. 
  This will also force the backup type to normal or copy.

@_bks file name_
  The name of the backup selection file (.bks file).
  In WinXP the at (@) character must precede this name.
  A backup selection file contains information on the files and folders 
  to be backed up. 
  You have to create the file using the GUI version of NT Backup.

/J {"_job name_"}
  The job name to be used in the log file 
  Describe the files and folders and the backup date-time.

/P {"_pool name_"}
  The media pool from which you want to use media. 
  Usually a subpool of the Backup media pool, such as 4mm DDS.
  If you select this you cannot use /A, /G, /F, or /T

/G {"_guid name_"}
  Overwrite or append to this tape. 
  Don’t use with a media Pool (/P).

/T {"_tape name_"}
  Overwrite or append to this tape.
  don’t use with a media Pool (/P).

/A
  Perform an append operation. 
  Either "guid name" (/G) or "tape name" (/T) must be specified with this switch. 
  don’t use with a media Pool (/P).

/N {"_media name_"}
  The new tape name. don’t use with Append (/A).

/F {"_file name_"}
  Backup to a file - logical disk path and file name.
  Do not use with the switches: /P /G /T.

/D {"_set description_"}
  Label for each backup set

/DS {"_server name_"}
  Back up the directory service file for MS Exchange 5.5 server. 
  This is not needed/does not work with Exchange 2000 since Exchange 2000
  uses Active Directory.

/IS {"_server name_"}
  Back up the Information Store file for an MS Exchange 5.5 Server.

/V:{yes|no}
  Verify the data after the backup is complete.

/R:{yes|no}
  Restrict access to this tape to the Owner/AdministratorS

/L:{f|s|n}
  The type of log file: f=full, s=summary, n=none

/M {_backup type_}
  The backup type. One of: normal, copy, differential, incremental, or daily

/RS:{yes|no}
  Backs up the migrated data files located in Remote Storage. 
  The /RS command-line option is not required to back up the local Removable 
  Storage database (that contains the Remote Storage placeholder files). 
  When you backup the %systemroot% folder, Backup automatically backs up the 
  Removable Storage database as well.

/HC:{on|off}
  Use hardware compression, if available, on the tape drive.

/SNAP:{on|off}
  Copy open/locked files, requires XP or 2003,
  creates a temporary snapshot for the [volume shadow copy](https://docs.microsoft.com/en-us/windows-server/storage/file-server/volume-shadow-copy-service).

/um  (Windows 2000 only)
  Find the first available media, format it, and use for the current backup.
  Use with the /p switch to scan for available media pools. 
  This command is only for standalone tape devices (not tape loaders.)
  The /UM switch must be at the end of the command line.

NTBackup has a reputation for being clumsy and unreliable, [Microsoft Data Protection Manager](https://www.microsoft.com/en-us/server-cloud/products/system-center-2012-r2/) is a more robust solution for Windows backup and recovery. Third party and cross platform tools are also available.

NTBackup is not available in Windows Vista/Windows 7 but utilities to restore old backup files are available (links below)

Mick Jagger sang backup vocals for "You're so Vain" by Carly Simon

### Related commands

[WBADMIN](wbadmin.html) - Windows Backup Admin.  
[Microsoft utility to restore NT Backups](https://www.microsoft.com/en-us/download/details.aspx?id=4220) for Windows Vista/Server 2008.  
Wbadmin - back up and restore the OS, volumes, files, folders, and applications.  
[Windows Server PowerShell Backup Cmdlets](https://docs.microsoft.com/en-us/powershell/module/windowserverbackup/?view=winserver2012r2-ps)  
[BackupAssist](https://www.backupassist.com/) - 3rd party backup software for small and medium businesses.  
Equivalent bash command (Linux): [fwbackups](https://diffingo.com/oss/fwbackups) or [rsync](../bash/rsync.html) - Synchronize file trees.



/. nt/ntdsutil.html
========================================================

    NTDSUtil - Windows CMD - SS64.com

NTDSUtil (NT Directory Service Utility)
=======================================

Active Directory Domain Services management, database/metadata maintenance, etc.

Run NTDSUtil from an elevated command prompt. NTDSUtil.exe is built into Windows Server 2008 /R2. It is available if you have the AD DS or the AD LDS server role installed or if you install the Active Directory Domain Services Tools that are part of the Remote Server Administration Tools (RSAT).

This tool is intended for use by experienced administrators, NTDSUtil is very powerful, but it’s also dangerous - some commands will require Active Directory to be taken offline.

Syntax

      Ntdsutil _option_

Options
    **ac**tivate **i**nstance %_s_        - Set "NTDS" or a specific AD LDS instance as the active instance.
    **au**thoritative **r**estore       - Authoritatively restore the DIT database.
    change service account %_s1_ %_s2_   - Change AD DS/LDS Service Account to
                                   username %_s1_ and password %_s2_.
                                   Use "NULL" for blank password, * to be prompted.
    **co**nfigurable **s**ettings       - Manage configurable settings
    **DS b**ehavior                 - View and modify AD DS/LDS Behavior
    **f**iles                       - Manage AD DS/LDS database files
    **g**roup **m**embership **e**valuation - Evaluate SIDs in token for a given user or group
    Help                        - Show help
    **i**fm                         - IFM media creation
    ldap policies               - Manage LDAP protocol policies
    ldap port %d                - Configure LDAP Port for an AD LDS Instance.
    **li**st **i**nstance               - List all AD LDS instances installed on this machine.
    **lo**cal **r**oles                 - Local RODC roles management
    **m**etadata **c**leanup            - Clean up objects of decommissioned servers
    **pa**rtition **m**anagement        - Manage directory partitions
    **po**pups **on**                   - Disable popups
    **po**pups **off**                  - Enable popups
    **q**uit                        - Quit the utility
    **r**oles                       - Manage NTDS role owner tokens
    **sec**urity **a**ccount **m**anagement - Manage Security Account Database - Duplicate SID Cleanup
    **sem**antic **d**atabase **a**nalysis  - Semantic Checker
    **set** DSRM password           - Reset directory service restore mode administrator account password
    **sn**apshot                    - Snapshot management
    SSL port %_d_                 - Configure SSL Port for an AD LDS Instance.  

For most commands, there is a short form, using the first few characters instead of the entire command, these are shown above in **bold**. Any abbreviation that will uniquely identify the command will work.

For example the interactive commands:

ntdsutil **r**oles 
  "**sel**ect **o**peration **t**arget" 
    "**c**onnections" 
      "**co**nnect **t**o **s**erver server64" 
      **q**uit 
  "**l**ist **r**oles **f**or **c**onnected **s**erver"
      **q**uit
    **q**uit
  **q**uit 

Can be abbreviated for use in a script:

ntdsutil r "sel o t" c "co t s server64" q "l r f c s" q q q

Or a little more readably:

ntdsutil rol "sel op targ" conn "conn to serv server64" qu "li rol fo conn serv" qu qu qu

At the ntdsutil: prompt, type HELP any point to see the available commands/subcommands.

_“Tyranny is always better organized than freedom” ~ Charles Peguy_

### Related commands

[NTDSUtil](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc753343(v=ws.11)?redirectedfrom=SS64) - Microsoft reference page.  
[Repadmin](repadmin.html) - Diagnose Active Directory replication problems.



/. nt/ntrights.html
========================================================

    NTrights - User Privileges - Windows CMD - SS64.com

NTRIGHTS.exe ([2003 Resource Kit](../links/windows.html#kits))
==============================================================

Edit user account privileges.

Syntax

       NTRIGHTS **+r** _Right_ -u _UserOrGroup_ [-m \_Computer_] [-e _Entry_]

       NTRIGHTS **-r** _Right_ -u _UserOrGroup_ [-m \_Computer_] [-e _Entry_]

Key:

    +/-r _Right_        Grant or revoke one of the rights listed below.

     -u _UserOrGroup_  Who the rights are to be granted or revoked to.
                     This is the pre-windows 2000 logon name (Max 20 characters)

     -m \_Computer_   The computer (machine) on which to perform the operation.
                     The default is the local computer. 

     -e _Entry_        Add a text string 'Entry' to the computer's event log.

This utility does work under all recent versions of Windows, although (like all Resource Kit tools) it is unsupported.

Below are the Privileges that can be granted or revoked, **all are Case-Sensitive.**

Logon Rights:

 Log on as a batch job            SeBatchLogonRight
 Deny logon as a batch job    SeDenyBatchLogonRight
 Log on locally                   SeInteractiveLogonRight
 Deny local logon             SeDenyInteractiveLogonRight
 Logon as a service               SeServiceLogonRight
 Deny logon as a service      SeDenyServiceLogonRight
 Access this Computer from the Network         SeNetworkLogonRight
 Deny Access to this computer via network  SeDenyNetworkLogonRight
 Allow logon through RDP/Terminal Services     SeRemoteInteractiveLogonRight
 Deny logon through RDP/Terminal Services  SeDenyRemoteInteractiveLogonRight

System Admin Privileges_:_

 Generate security audits         SeAuditPrivilege
 Manage auditing and security log SeSecurityPrivilege
 Backup files and directories     SeBackupPrivilege
 Create symbolic links            SeCreateSymbolicLinkPrivilege
 Add workstations to the domain   SeMachineAccountPrivilege
 Shut down the system             SeShutdownPrivilege
 Force shutdown from a remote system  SeRemoteShutdownPrivilege
 Create a pagefile                SeCreatePagefilePrivilege
 Increase quotas                  SeIncreaseQuotaPrivilege
 Restore files and directories    SeRestorePrivilege  
 Change the system time           SeSystemTimePrivilege
 Change the time zone             SeTimeZonePrivilege
 Take ownership of files/objects  SeTakeOwnershipPrivilege
 Enable computer/user accounts
    to be trusted for delegation       SeEnableDelegationPrivilege
 Remove computer from docking station SeUndockPrivilege

Service Privileges:

 Create permanent shared objects  SeCreatePermanentPrivilege
 Create a token object            SeCreateTokenPrivilege
 Replace a process-level token    SeAssignPrimaryTokenPrivilege
 Impersonate a client after authentication  SeImpersonatePrivilege
 Increase scheduling priority     SeIncreaseBasePriorityPrivilege
 Act as part of the operating system   SeTcbPrivilege
 Profile a single process         SeProfileSingleProcessPrivilege
 Load and unload device drivers   SeLoadDriverPrivilege
 Lock pages in memory             SeLockMemoryPrivilege
 Create global objects            SeCreateGlobalPrivilege

Misc Privileges:

 Debug programs                   SeDebugPrivilege
 Bypass traverse checking         [SeChangeNotifyPrivilege](https://blogs.technet.com/b/markrussinovich/archive/2005/10/19/the-bypass-traverse-checking-or-is-it-the-change-notify-privilege.aspx)
 Increase a process working set   SeIncreaseWorkingSetPrivilege
 Modify an object label           SeRelabelPrivilege
 Obtain an impersonation token for another user in the same session:
                                  SeDelegateSessionUserImpersonatePrivilege
 Sync directory service data      SeSyncAgentPrivilege
 Edit firmware environment values SeSystemEnvironmentPrivilege
 Access Credential Manager as a trusted caller
                                  SeTrustedCredManAccessPrivilege
 Perform volume maintenance tasks SeManageVolumePrivilege
 Profile system performance       SeSystemProfilePrivilege
 Obsolete and unused              SeUnsolicitedInputPrivilege (has no effect)

The Se_Deny… rights will override the corresponding account rights. An Se_Deny… right will also override any logon rights that an account may inherit as a result of its group membership(s).

To run NTRIGHTS you need to be an administrator.  
To change privileges remotely (-m option) you need to have administrator rights on the machine being changed.  

It is often helpful to grant the privileges to a named group, e.g. grant SeServiceLogonRight to a group called ServiceAccounts, then add individual user accounts to that group.  
The group policy editor can be used to view these privileges in a GUI.  
  
On a Windows 2008 Server (or Vista), allowing logon through Terminal Services (SeRemoteInteractiveLogonRight) requires an extra step: Control Panel ➞ System ➞ 'Remote Settings' ➞ 'Select Users' button, and then add users/groups.

### Examples

Allow all members of the local 'Users' group to logon locally:

ntrights -u Users +r SeInteractiveLogonRight

Allow members of the domain group 'Admin-RDP' to logon remotely via RDP to "server64", also log this security change in the event log:

ntrights -u ss64Dom\Admin-RDP +r SeRemoteInteractiveLogonRight -m \server64 -e "Added RDP rights for Admin-RDP"

Allow the domain user 'Ashley' the right to run a batch (Scheduled Task) on Server64:

ntrights -u ss64Dom\Ashley +r SeBatchLogonRight -m \server64

Allow all members of the domain group 'Admin-Local' to shutdown this computer:

ntrights -u ss64Dom\Admin-Local +r SeShutdownPrivilege

Allow the domain user 'JDoe' to shutdown the machine 'Server64' :

ntrights -u ss64Dom\JDoe +r SeShutdownPrivilege -m \Server64

Allow any Interactive user of the local machine the right to change the system time:

ntrights -u INTERACTIVE +r SeSystemtimePrivilege

Specifically deny local logon rights to Henry:

ntrights -u Henry +r SeDenyInteractiveLogonRight

“What distinguishes the majority of men from the few is their inability to act according to their beliefs” ~ Henry Miller

### Related commands

[UserRights.psm1](https://web.archive.org/web/20200806215449/https://gallery.technet.microsoft.com/scriptcenter/Grant-Revoke-Query-user-26e259b0) - PowerShell module to grant, revoke, and query user rights (privileges).  
[CACLS](cacls.html) - Change file permissions.  
[Q315276](https://web.archive.org/web/20140206160903/http://support.microsoft.com:80/kb/315276) - Set Logon User Rights by Using the NTRights.  
[Logon Types](syntax-logon-types.html) - Windows Logon types.  
[docs.microsoft.com](https://docs.microsoft.com/en-us/previous-versions/tn-archive/dd277311(v=technet.10)) - User Rights and Privileges.



/. nt/nvspbind.html
========================================================

    NVSPBind - Windows CMD - SS64.com

NVSPBIND.exe Network VSP Bind - [[archive](https://web.archive.org/web/20200318041433/https://gallery.technet.microsoft.com/Hyper-V-Network-VSP-Bind-cf937850)]
=================================================================================================================================================================

Modify network bindings. Intended for use in Server Core environments with the Hyper-V role enabled.  
Windows 8 /2008/2012 n.b. this is an **unsupported** 32 bit tool.

Syntax

      NVSPBIND _option NIC protocol_

Options:
    /n  display NIC information only
    /u  unbind switch protocol from specified nic(s)
    /b  bind switch protocol to specified nic(s)
    /d  disable binding of specified protocol from specified nic(s)
    /e  enable binding of specified protocol to specified nic(s)
    /r  repair bindings on specified nic(s)
    /o  show NIC order for specified protocol
    /+  move specified NIC up in binding order for specified protocol
    /-  move specified NIC down in binding order for specified protocol
    /++ move specified NIC up to top of binding order for specified protocol
    /-- move specified NIC down to bottom of binding order for specified protocol

### Examples

Obtain the GUID which uniquely identifies the adapter:  
C:> nvspbind  
{F93642D9-9085-4EEF-9669154AD4391ED7}  
"pci\ven_8086&dev_10c9&subsys_a03c8086"  
"Intel(R) Gigabit ET Dual...  
  
Unbind the protocol ms_server (the short name for _File and Printer Sharing for Microsoft Networks_) using the GUID:  
C:> nvspbind -d {F93642D9-9085-4EEF-9669154AD4391ED7} ms_server  

Set the priority of the 'Wireless network connection' to the top of the binding order:  
C:> nvspbind.exe /++ "Wireless Network Connection" ms_tcpip

"Talent is hitting a target no-one else can hit, genius is hitting a target no-one else can see" ~ Schopenhauer

### Related commands

[NETSH](netsh.html) - Configure Network Interfaces, Windows Firewall & Remote access.  
NVSPSCRUB.js - Delete all virtual adapters (and thus return physical).  
[ROUTE](route.html) - Manipulate network routing tables.



/. nt/openfiles.html
========================================================

    Openfiles - Windows CMD - SS64.com

OPENFILES.exe
=============

Query or display open files, disconnect files opened by network users.

Syntax

      Openfiles.exe **/query** [/s _Computer_ [/u _Domain__User_ [/p _Password_]]]
        [/fo {TABLE|LIST|CSV}] [/nh] [/v]

      Openfiles.exe **/disconnect** [/s _Computer_  [/u _Domain__User_ [/p _Password_]]]
         {[/id OpenFileID]|[/a _UserName_]|[/o _OpenMode_]} [/se _SessionName_] [/op _OpenFileName_]

Key
    /s     The name or IP address of a remote computer. (Do not use backslashes.) default=local computer.

    /u     Run the command with the account permissions of _user_. Default=current logged on user.

    /p     The password of the user account specified with /u.

    /fo    The format to use for the query output. Valid values are TABLE, LIST, and CSV. Default=TABLE.

    /nh    No column headers in the output. Valid only when /fo = TABLE or CSV.

    /id    Disconnect the file opened with the specified numeric _OpenFileID_ on _computer_
          Use openfiles.exe /query to learn the file ID.
          The wildcard (*) can be used to disconnect all open files on _computer_.

    /a     Disconnect all open files that were accessed by _user_ on _computer_.
          The wildcard (*) can be used to disconnect all open files on _computer_.

    /o     Disconnect all open files with the specified _OpenMode_ on the computer specified by the /s parameter.
          The OpenMode parameter includes the Read/Write and Read modes.
          The wildcard (*) can be used to disconnect all open files on _computer_.

    /se    Disconnect all open files that were created by the specified session on _computer_.
          Wildcards (*) can be used. (the /se option is not available under Windows 7)

    /op    Disconnect the open file that was created with the specified _OpenFileName_ on _computer_ 
          The wildcard (*) can be used to disconnect all open files on _computer_.

    /v     Display verbose information in the output.

    /?     Help.

Administrator privileges are required to run the OPENFILES command. We can use this fact to detect if the current user is an Admin ( OPENFILES >nul 2>nul will set %ERRORLEVEL% = 1 if the user is not an administrator.) However this will fail when running under WOW64 e.g. running a 32 bit installer on an 64 bit system, so an alternative is to use [NET SESSION](net-session.html).

Running openfiles.exe from within powershell allows the output to be easily assigned to a variable.

### Examples

From the CMD shell:

C:> openfiles /query /fo list /v  
C:> openfiles /query /s Server64 /u SS64Dom\FileAdmin /p password1  
  
C:> openfiles /disconnect /o read/write  
C:> openfiles /disconnect /op "c:\work\finance.xls"  
C:> openfiles /disconnect /s Server64 /u SS64Dom\FileAdmin /id 5  
C:> openfiles /disconnect /s Server64 /u SS64Dom\FileAdmin /p password1 /id *

From PowerShell:

PS C:> openfiles /query  
PS C:> openfiles /query /fo table /nh  
PS C:> $file_list = openfiles /query /s Server64 /fo CSV /v /nh  
PS C:> openfiles /query /s Server64 /fo CSV /v | ConvertFrom-Csv | Out-GridView  
  
PS C:> openfiles /disconnect /id 1  
PS C:> openfiles /disconnect /a mike

“Love is a sudden revelation: a kiss is always a discovery” - Anon

### Related commands

[NET FILE](net.html) - Force an open file to close.  
[PsFile](psfile.html) - Show files opened remotely, or close an open file.  
[PsList](pslist.html) - List detailed information about processes.  
[TASKLIST](tasklist.html) - List running applications and services.  
Equivalent bash command (Linux): inotify - file-monitoring mechanism.



/. nt/path.html
========================================================

    Path - Search path for executable files - Windows CMD - SS64.com

PATH
====

Display or set a search path for executable files at the command line.

Syntax

      PATH _path_ [;_path_] [;_path_] [;_path_]...[;%PATH%]]
      PATH
      PATH ;

Key
    _path_       A directory path to be added to %PATH%
    %PATH%     Optionally include %PATH% at the beginning or end to avoid overwriting the current PATH definition.
    ;         The command 'PATH ;' will clear the path

PATH without parameters will display the current path.

The %PATH% environment variable contains a list of folders. When a command is issued at the CMD prompt, the operating system will first look for an executable file in the current folder, if not found it will scan %PATH% to find it.

Use the PATH command to display or change the list of folders stored in the %PATH% [environment variable](syntax-variables.html)  

The PATH environment variable uses semicolons: ; to separate directories. It will ignore spaces or commas.

You do [not need](https://devblogs.microsoft.com/oldnewthing/20060929-06/?p=29533) to surround each part of the path with double quotes, PATH will automatically treat spaces as part of the filename.  
A trailing backslash is accepted but is not required, each part of the PATH is always treated as a directory not a file.

PowerShell in particular will ignore any path node delimited by double quotes.

By default, Windows does not add a semicolon to the end of the path, but some program installers will incorrectly do so. This can lead to double semicolons appearing in the path list, creating a NULL node entry.

Permanent Changes
-----------------

> Changes made using the PATH command are NOT permanent, they apply to the current CMD prompt only and remain only until the CMD window is closed.
> 
> To permanently change the PATH use Control Panel ➞ System ➞ Advanced System settings ➞ Environment Variables.
> 
> The %PATH% variable is set as both a system and user variable, the 2 values are combined to give the PATH for the currently logged in user. This is explained in full by MS Product Support Article [Q100843](https://web.archive.org/web/20140307091135/https://support.microsoft.com/kb/100843)
> 
> [HKLM\System\CurrentControlSet\Control\Session Manager\Environment]  
> [HKCU\Environment]
> 
> Be wary of using commands like [SETX](setx.html) to modify the PATH, the User path can be edited, but the System path remains read-only for most users. If you try to delete an old value and add a new one it is very common for the 'delete' to fail and the 'add' to succeed, resulting in duplicate values being added to the path.
> 
> To programatically modify the PATH there are a few traps to consider:  
> Stray quotation marks or semi-colon delimiters in the current path, Duplicate entries in the **user** and **system** paths, also duplicates in either one (Windows does not check or warn about this), the [maximum length of the system path](https://superuser.com/questions/1070272/why-does-windows-have-a-limit-on-environment-variables-at-all) (roughly 2 KB or just 7 paths of the maximum 260 characters), and lastly checking for any dependencies in other applications (if the path you are adding or removing could be used by them).
> 
> To modify the path to add settings for a single application, one method is to use a second variable:  
> e.g.
> 
> SetX MYAPP "C:\Program Files\My App" -m
> 
> Now include the new variable in the path like so ...C:\Windows\system32;%MYAPP%  
>   
> You can now easily change that one variable %MYAPP% at any time in the future and the PATH will reflect the new value.
> 
> *   Changing a variable in the Control Panel will not affect any CMD prompt that is already open, only new CMD prompts will get the new setting.  
>     
> *   To change a system variable you must have administrator rights  
>     
> *   If your system has an AUTOEXEC.BAT file then any PATH setting in AUTOEXEC.BAT will also be appended to the %PATH% environment variable. This is to provide compatibility with old installation routines which need to set the PATH. All other commands in AUTOEXEC.BAT are ignored.

PathExt
-------

> If you start/run an application without a file extension (for example WinWord instead of WinWord.exe)then the [PATHEXT](syntax-variables.html) environment variable will be read to determine which file extensions to search for and in what order.  
> The default value for the PATHEXT variable is: .COM;.EXE;.BAT;.CMD  
> Many would argue that .CMD should have higher priority than the legacy .BAT.

Dpath
-----

> DPATH is an undocumented internal utility that allows the [TYPE](type.html) command to read data files in specified directories as if they were in in the current directory. On some OS's this is also implemented as the now deprecated APPEND command. The list of directories is held in the %DPATH% [environment variable](syntax-variables.html) which works just like the %PATH% variable, delimited with semicolons (not quotes). Syntax: DPATH _pathname_ [;_pathname_]...  
>   
> To type any file on the path:
> 
> C:\batch> type win.ini  
> The system cannot find the file specified.  
> C:\batch> dpath %path%  
> C:\batch> type win.ini

Terminology - filename, path, pathname
--------------------------------------

> For a file stored as:  
> C:\Program Files\Windows Media Player\wmplayer.exe  
>   
> ![A pathname is Drive + Path + Filename](pathname.jpg)
> 
> So Drive + Path + Filename = Pathname.
> 
> If a file reference uses only the filename rather than a full pathname, then that will work to execute the file, only if the file is in the [current directory](cd.html) or is listed in the PATH.

Paths for GUI Windows applications
----------------------------------

> The App Paths registry subkey is available to provide a location for specific executable filenames.  
> This can be used to populate the 'Open With Dialog Box' and also avoids the need to modify the system PATH environment variable.
> 
> The keys can be found in the following two registry locations, for the Current User (strongly recommended) or all users.  
> Full documentation of this is on [docs.microsoft.com](https://docs.microsoft.com/en-gb/windows/desktop/shell/app-registration)
> 
> HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\App Paths  
> HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\App Paths
> 
> The filename used in App Paths to launch the application does [not have to match](https://devblogs.microsoft.com/oldnewthing/20110725-00/?p=10073) the actual destination file.

Errorlevels
-----------

> When [CMD Command Extensions](cmd.html) are enabled (the default):
> 
> If the PATH was successfully changed [%ERRORLEVEL%](errorlevel.html) = _unchanged_, typically this will be 0 but if a previous command set an errorlevel, that will be preserved (this is a bug).
> 
> If PATH could not be changed [%ERRORLEVEL%](errorlevel.html) = 1

PATH is an [internal](syntax-internal.html) command.

### Examples

To view each item in the path on a single line:

> For %G in ("%path:;=" "%") do @echo:%~G
> 
> Or in a batch file:
> 
> For %%G in ("%path:;=" "%") do @echo:%%~G
> 
> Alternatively [replacing](syntax-replace.html) the semicolons with ECHO: to generate a newline:
> 
> ECHO:%PATH:;= & ECHO:%

Add 'My Application' to the **end** of the path, including the current %PATH% in the new setting:  
  
PATH=%PATH%;C:\Program Files\My Application

Add 'My Application' to the **start** of the path, including the current %PATH% in the new setting:  
  
PATH=C:\Program Files\My Application;%PATH%  

“If you do not love your job, change it. Instead of pushing paper, push ideas. Instead of sitting down, stand up and be heard. Instead of complaining, contribute. don’t get stuck in a job description” - [Microsoft job advert](https://web.archive.org/web/20070307194651/http://www.socresonline.org.uk/1/4/1.html)

### Related commands

[SET](set.html) - Display, set, or remove environment variables.  
[ePath](https://westmesatech.com/?page_id=49) - Add and remove individual directories from the system or current user path. (Bill Stewart).  
PATHMAN - Resource Kit utility - modify system and user paths. Resolve duplicates. See Pathman.wri in the resource kit.  
[How to check if directory exists in %PATH%?](https://stackoverflow.com/a/8046515/1720814) - Stackoverflow.com  
[Dynamic-Link Library Search Order](https://docs.microsoft.com/en-gb/windows/desktop/Dlls/dynamic-link-library-search-order) - docs.microsoft.com  
Equivalent PowerShell: DIR Env: or "$Env:path" To add an item to the path for the current session: $env:path += ";C:\demo"  
Equivalent bash command (Linux): [env](../bash/env.html) - Display, set, or remove environment variables - PATH/CDPATH/MAILPATH



/. nt/pathping.html
========================================================

    PathPing - IP trace - Windows CMD - SS64.com

PATHPING
========

Trace route and provide network latency and packet loss for each router and link in the path. Combines the functionality of PING and TRACERT.

Syntax

      PATHPING [-n] [-h _max_hops_] [-g _host_list_] [-p _period_]
         [-q _num_queries_] [-w _timeout_] [-i _IPAddress_] [-4 ] [-6 ][TargetName]

Key
    -g _host_list_ - Loose source route along host-list.
    -h _max_hops _ - Maximum number of hops to search for target.
    -i _address_   - Use the specified source address.
    -n           - Do not resolve addresses to hostnames.
    -p _period_    - Wait _period_ milliseconds between pings.
    -q _num_queries_ - Number of queries per hop.
    -w _timeout_   - Wait _timeout_ milliseconds for each reply.
    -P    - Test for RSVP PATH connectivity.
    -R    - Test if each hop is RSVP aware.
    -T    - Test connectivity to each hop with Layer-2 priority tags.
    -4    - Force using IPv4.
    -6    - Force using IPv6.

PathPing is invaluable for determining which routers or subnets are having network problems - it displays the degree of packet loss at any given router or link.

Pathping sends multiple Echo Request messages to each router between a source and destination over a period of time and computes aggregate results based on the packets returned from each router.

Pathping performs the equivalent of the tracert command by identifying which routers are on the path.

To avoid network congestion and to minimize the effect of burst losses, pings should be sent at a sufficiently slow pace (not too frequently.)

When -p is specified, pings are sent individually to each intermediate hop. When -w is specified, multiple pings can be sent in parallel. It's therefore possible to choose a _Timeout_ parameter that is less than the wait _Period_ * Number of hops.

Firewalls
---------

> Like [TRACERT](tracert.html), PathPing uses Internet Control Message Protocol (ICMP) over TCP/IP.  
> Many firewalls will block ICMP traffic by default. If an attacker is able to forge ICMP redirect packets, he or she can alter the routing tables on the host and possibly subvert the security of the host by causing traffic to flow via a path you didn’t intend.

_"The path changes, so too must the traveler" ~ Tarek Verena_

### Related commands

[BROWSTAT](browstat.html) - Get domain, browser and PDC info.  
[IPCONFIG](ipconfig.html) - IP Configuration.  
[NETSTAT](netstat.html) - Display networking statistics (TCP/IP).  
[PING](ping.html) - Test a network connection.  
[TRACERT](tracert.html) - Trace route to a remote host.  
Equivalent bash command (Linux): [mtr](../bash/mtr.html) - Network diagnostics (traceroute/ping).



/. nt/pause.html
========================================================

    Pause - Windows CMD - SS64.com

PAUSE
=====

Pause the execution of a batch file

Syntax

      PAUSE

Displays the message "Press any key to continue . . ."  
  
To suppress the message:  
PAUSE >nul

To display a different message:  
Echo Pulse cualquier tecla para continuar  
PAUSE >nul

Execution of a batch script can also be paused by pressing CTRL-S (or the Pause|Break key) on the keyboard, this also works for pausing a single command such as a long DIR /s listing.  
Pressing any key will resume the operation.

Pause is often used at the end of a script to give the user time to read some output text.  
An alternative to this is to run the script using [CMD /K](cmd.html):

START CMD /k C:\demo\yourscript.cmd

That will run the script and the window will remain open for any further input. The advantage of CMD /K is that you can then run the same script in 'unattended mode' without having to edit it. The limitation is that this only acts like PAUSE at the very end of a script.

PAUSE does not set or clear the [Errorlevel](errorlevel.html).  
PAUSE is an [internal](syntax-internal.html) command.

“Advertising may be described as the science of arresting the human intelligence long enough to get money from it” - Stephen Leacock

### Related commands

[SLEEP](sleep.html) - Wait for x seconds.  
[TIMEOUT](timeout.html) - Delay that allows the user to press a key and continue immediately.  
PowerShell: Pause  
Equivalent bash command (Linux): [read -p](../bash/read.html) "press any key to continue" or ctrl-z & [fg](../bash/fg.html)



/. nt/perms.html
========================================================

    perms - Windows CMD - SS64.com

PERMS.exe ([2003 Resource Kit](../links/windows.html#kits))
===========================================================

Display a user’s ACL access permissions for a file.  
Output from PERMS can be incomplete in cases where a user has inherited permission through membership of a group.

Syntax

      PERMS [_account_] [_path_] options  
Key  
    _account_ : username or [domain\|computer\]username 

    _path_    : name of a file or folder in any legal format
             including UNC names
             [Wildcards](syntax-wildcards.html) are permitted.

    /i      : interactively logged on to the computer
             where the path resides.
             (rather than being connected via the network)

    /s      : include subfolders

The output access mask uses the following abbreviations:  

  R  Read file/folder.
  W  Write file/folder.   
  X  Execute file.  
  D  Delete file or folder. Can be inherited from the parent
     via 'Delete Subfolder and Files' permission.
  P  Change Permission.  
  O  Take Ownership.   
  A  General All  
  -  No Access
  *  The specified user is the owner of the file or folder.  
  #  A group the user is a member of owns the file or folder.  
  ?  Permisssions cannot be determined. 

_"Microsoft allowed us to change our startup screen, but we don’t think we should have to ask permission every time we want to make some minor software modification. Windows is an operating system, not a religion" ~ Ted Waitt, Gateway Chairman_

### Related commands

[GPRESULT](gpresult.html) - Display Resultant Set of Policy information for a remote user and computer.  
[NTRIGHTS](ntrights.html) - Edit user account rights.  
[CACLS](../nt/cacls.html) - Display or modify Access Control Lists (ACLs) for files and folders.  
[SUBINACL](subinacl.html) - Change an ACL's user/domain (use when the file owner has moved to a new domain).  
[XCACLS](xcacls.html) - Display or modify Access Control Lists (ACLs) for files and folders.  
Equivalent PowerShell: [Set-Acl](../ps/set-acl.html) - Set permissions.  
Equivalent bash command (Linux):[chmod](../bash/chmod.html) - Change access permissions.



/. nt/ping.html
========================================================

    Ping - Windows CMD - SS64.com

PING
====

Test a network connection - if successful, ping returns the ip address.

Syntax

      PING [_options_] _destination_host_

Options
    -w _timeout_     Timeout in milliseconds to wait for each reply, default=4000.
    -i _TTL_         Time To Live.
    -v _TOS_         Type Of Service.
    -a             Resolve addresses to hostnames.
    -n _count_       Number of echo requests to send.
    -t             Ping the destination host until interrupted.
                   To see statistics and continue type Control-Break;
                   To stop type Control-C.
    -l _size_        Send buffer size (default=32).
    -f             Set don’t Fragment flag in packet (IPv4-only).
    -r _count_       Record route for count hops (IPv4-only).
    -s _count_       Timestamp for count hops (IPv4-only).
    -j _host_list_   Loose source route along _host_list_ (IPv4-only).
    -k _host_list_   Strict source route along _host_list_ (IPv4-only).
 _destination_host_  The name of the remote host
    -R             Use routing header to test reverse route also (IPv6-only).
    -S _srcaddr_     Source address to use.
    -4             Force using IPv4.
    -6             Force using IPv6.

A response of "Request timed out" means there was no response within the default time period.

A successful PING does NOT always return an %errorlevel% of 0Therefore to reliably detect a successful ping, pipe the output into FIND and look for the text "TTL"  
  
Note that "Reply" in the output of PING does not always indicate a positive response.  
Example message: _Reply from 192.168.1.254: Destination Net Unreachable._

Ping defaults to an ICMP timeout of 4000ms or 4 seconds. When specifying very small numbers (<500) for timeout with -w , the Ping reply can be received even if _timeout_ milliseconds have elapsed.  

Timeout
-------

> When pinging a host that doesn’t exist or is offline there will be a delay of some seconds before it is returned as 'host not found'.
> 
> The PING -w and the WMI Get-CIMInstance Win32_PingStatus timeout=_NNN_ options both offer to control the Timeout, but this is the [ICMP timeout](https://www.cloudflare.com/en-gb/learning/ddos/glossary/internet-control-message-protocol-icmp/) not the [DNS client timeout](https://support.microsoft.com/en-gb/help/2834226/net-dns-dns-client-resolution-timeouts).  
> 
> When sucessfully contacting a host, the ICMP timeout is used (default typically 4 seconds) but when attempting to PING a non-existent or offline computer it will be a DNS timeout causing the delay, typically around 9 - 10 seconds.
> 
> The time to respond as 'host not found' is for the _first_ response, once you have pinged a host once, DNS will cache the (non) response and respond much faster to a second PING.
> 
> The performance of PING, [Get-CIMinstance](../ps/get-ciminstance.html), [PSPING](psping.html) and [Test-Connection](../ps/test-connection.html) (PowerShell) are all comparable, the only difference being that PING and Get-CIMinstance allow modifying the ICMP timeout.

How to test connectivity with ping:
-----------------------------------

> 1) Ping the loopback address to verify that TCP/IP is installed and configured correctly on the local computer.  
> PING 127.0.0.1  
>   
> 2) Ping the IP address of the local computer to verify that it was added to the network correctly.  
> PING _IP_address_of_local_host_  
>   
> 3) Ping the IP address of the default gateway to verify that the default gateway is functioning and that you can communicate with a local host on the local network.  
> PING _IP_address_of_default_gateway_  
> 4) Ping the IP address of a remote host to verify that you can communicate through a router.  
> PING _IP_address_of_remote_host_

Use PING to create a time delay:
--------------------------------

> Create a delay of 1 or more seconds by pinging the loopback address (127.0.0.1) multiple times.  
> The delay **between** each ping is 1 second, so for a delay of **5** seconds ping **6** times:  
> PING -n **6** 127.0.0.1>nul  
> In tests this consumes less processor time than [Sleep](sleep.html) or [Timeout](timeout.html) - see [Clay Calvert's](https://groups.google.com/forum/#!msg/alt.msdos.batch.nt/nSRpfQE-lko/WEWG9aCfSoAJ) original newsgroup posting.  

Ping response times below 10 milliseconds often have low accuracy. A time of 10 milliseconds is roughly equal to a distance of 1860 Miles, travelling a straight line route at the speed of light, (or a round trip of 2 × 930 miles). From this you can see that ping response times will give a very very rough estimate of the distance to a remote host.

Network adminstrators do not appreciate frequent or continual pings to their servers, try not to overdo it!

The IPv6 options are only available on versions of Windows that support IPv6.

### Examples

Ping a server just once:  
PING -n 1 Server64  
  
Check if a host is reachable:  
PING Server64 |find "TTL=" && ECHO MyHost found  
  
Check if a host is not reachable:  
PING Server64 |find "TTL=" || ECHO MyHost not found  
  
Test which iSCSI IP on a specific NIC is functioning or if a specific teamed NIC is operating as it should:  
Ping -S _(Source IP: XXX.XXX.XXX.XXX) (Destination IP: XXX.XXX.XXX.XXX)_  
Ping -S 10.5.7.64  10.5.7.1  
  
Ping a website 5 times:  
PING -n 5 -w 7500 www.microsoft.com

Monitor a website (example.com) every 15 seconds:

@Echo off
Echo Logging ping responses, press CTRL-C to stop
:start
 Ping -n 1 **example.com** | find "TTL=" >>c:\pingtest.txt
 Echo .
 Ping -n 16 127.0.0.1>nul
goto start

The script above can be used to test an Internet connection, just replace **example.com** with your ISP's Default Gateway IP address. This represents the first physical device on the ISP's side of your connection. You can find the Default Gateway on your [router status screen](http://192.168.0.1/).  

PING is [named](https://web.archive.org/web/20170404133003/http://ftp.arl.army.mil/~mike/ping.html) after the sound that a sonar makes.

“And now I see with eye serene  
The very pulse of the machine” ~ William Wordsworth, (She Was a Phantom of Delight)

### Related commands

[TRACERT](tracert.html) - Trace route to a remote host.  
[IPCONFIG](ipconfig.html) - IP Configuration.  
[PATHPING](pathping.html) - Route Tracing tool.  
[Q115388](https://web.archive.org/web/20140321063652/https://support.microsoft.com/kb/115388) - Resolving IP Address with Leading Zero.  
[FreePing](https://network-tools.com/) - Freeware Windows GUI Ping.  
[LocaPing](https://www.locaping.com/) - Online ping.  
[RFC5737](https://tools.ietf.org/html/rfc5737) - IPv4 Address Blocks Reserved for Documentation.  
Equivalent PowerShell: [Test-Connection](../ps/test-connection.html) - Ping one or more computers, [psp](../ps/syntax-ping.html) function.  
Equivalent bash command (Linux): ping - Test a network connection.



/. nt/pktmon.html
========================================================

    PktMon - Monitor internal packet propagation - Windows CMD - SS64.com

PktMon.exe
==========

Monitor internal packet propagation and packet drop reports. Run all PktMon commands from an [Elevated](syntax-elevate.html) command prompt.

Syntax - List all active components:
      **PKTMON comp** list _options_
    Options:
    -i, --show-hidden
    Show components that are hidden by default.

    --json  Output the list in Json format

Syntax - Display current per-component counters:
      **PKTMON comp** counters _options_

    Options:
    -i, --show-hidden
    Show components that are hidden by default.

    --json  Output the list in Json format

    -t,--counter-type
    Select which types of counters to show
    Supported values are all counters (default), drops only, or flows only.

    -z, --show-zeros
    Show counters that are zero in both directions.

Syntax - Manage packet filters:
      **PKTMON filter** { list | add | remove } [_options_ | help]

    Key:
      list    Display active packet filters.
      add     Add a filter to control which packets are reported.
      remove  Removes all filters.
      help    Show help text and sub-options for a command.

Syntax - Reset all component counters to zero:
      **PKTMON reset**[-counters]

Syntax - Stop packet monitoring and show results:
      **PKTMON stop**

Syntax - Convert log file to text format:
      **PKTMON format** log.etl [-o log.txt]
    Key:
    -o, --out     Name of the formatted text file.

Syntax - Stop the PktMon driver service and unload PktMon.sys:
      **PKTMON unload**
      Effectively equivalent to '[SC.exe](sc.html) stop PktMon'.
      Measurement (if active) will immediately stop, and any state will be
      deleted (counters, filters, etc.).

Syntax - Start packet monitoring:
      **PKTMON start** [-c { all | nics | [ids...] }] [-d]
         [--etw [-p _size_] [-k _keywords_]]  [-f] [-s] [-r] [-m]

    Key:
    -c, --components
      Select components to monitor. Can be all components, NICs only, or a
      list of component ids. Defaults to all.

  -d, --drop-only
      Only report dropped packets. By default, successful packet propagation
      is reported as well.

    ETW Logging
      --etw
         Start a logging session for packet capture.

      -p, --packet-size
         Number of bytes to log from each packet. To always log the entire
         packet, set this to 0. Default is 128 bytes.

      -k, --keywords
         Hexadecimal bitmask (i.e. sum of the below flags) that controls
         which events are logged. By default all events are logged.

         Flags:
         0x001 - General configuration events.
         0x002 - Component related information, including counters.
         0x004 - Pre-parsed packets.
         0x008 - Packet metadata (NBL OOB).
         0x010 - Raw packet payload.

    -f, --file-name
      .etl log file. Default is PktMon.etl.

    -s, --file-size
      Maximum log file size in megabytes. Default is 512 MB.

    Logging mode

      -r, --circular
         New events overwrite the oldest ones when 
         when the maximum file size is reached.

      -m, --multi-file
         A new log file is created when the maximum file size is reached.
         Log files are sequentially numbered. PktMon1.etl, PktMon2.etl, etc.

### Examples

Create a packet filter for the traffic on TCP port 20:  
  
pktmon filter add -p 20

List the current packet filters:

pktmon filter list

Start monitoring to a file called PktMon.etl (n.b. without the -p option this will default to capturing only the first 128 bytes of each packet.):

pktmon start --etw

Stop monitoring:

pktmon stop

Convert the PktMon.etl file to a human-readable text format:

pktmon format PktMon.etl -o converted.txt

“Sooner or later we all discover that the important moments in life are not the advertised ones, not the birthdays, the graduations, the weddings, not the great goals achieved. The real milestones are less prepossessing. They come to the door of memory unannounced, stray dogs that amble in, sniff around a bit and simply never leave. Our lives are measured by these” ~ Susan B. Anthony

### Related commands

[Microsoft Network Monitor](https://www.microsoft.com/en-in/download/details.aspx?id=4865) - View the .ETL file generated by PktMon.  
[How to use PktMon](https://www.bleepingcomputer.com/news/microsoft/windows-10-quietly-got-a-built-in-network-sniffer-how-to-use/) - Bleeping Computer.  
Equivalent macOS command : [tcpdump](../osx/tcpdump.html) - Dump traffic on a network.



/. nt/pnputil.html
========================================================

    PNPUTIL - Windows CMD - SS64.com

PNPUTIL.exe
===========

Plug and Play Utility to manage device drivers.

Syntax

      Add driver package(s) into the driver store:
      PNPUTIL /add-driver _filename_.inf | *.inf [/subdirs] [/install] [/reboot]

      Delete driver package from the driver store.
      PNPUTIL /delete-driver _oem#_.inf [/uninstall] [/force] [/reboot]

      Export driver package(s) from the driver store into a target directory:
      PNPUTIL /export-driver _oem#_.inf | * _target_directory_

      Enumerate all 3rd party driver packages in the driver store:
      PNPUTIL /enum-drivers

      Enumerate all devices on the system:
      PNPUTIL /enum-devices [/connected | /disconnected] [/instanceid _instance_ID_]
                [/class _name_ | _GUID_] [/problem [_code_]] [/ids] [/relations] [/drivers]

      Enumerate all device interfaces on the system:
      PNPUTIL /enum-interfaces [/enabled | /disabled] [/class _GUID_]

      Disable devices on the system:
      PNPUTIL /disable-device  [/reboot]

      Enable devices on the system:
      PNPUTIL /enable-device  [/reboot]

      Restart devices on the system:
      PNPUTIL /restart-device  [/reboot]

      Attempt to remove a device from the system:
      PNPUTIL /remove-device _instance_ID_ [/subtree] [/reboot]

      Scan the system for any device hardware changes:
      PNPUTIL /scan-devices [/instanceid _instance_ID_] [/async]
      PNPUTIL /?

Key:
      /async         : Scan for changes asynchronously.
      /connected     : Filter by connected devices 
      /disconnected  : Filter by disconnected devices.
      /class _name_ | _GUID_  : Filter by device class name or GUID.
      /disabled      : Filter by disabled interfaces.
      /drivers       : Display matching and installed drivers.
      /enabled       : Filter by enabled interfaces
      /force         : Delete driver package even when it is in use by devices.
      /ids           : Display hardware IDs and compatible IDs.
      /install       : Install/update drivers on any matching devices.
      /instanceid _instance_ID_ : Scan or filter the device subtree by device _instance_ID_.
      /problem [_code_]         : Filter by devices with problems or
                                Filter by specific problem code.
      /reboot       : Reboot system if needed to complete the operation.
      /relations    : Display parent and child device relations.
      /subdirs      : Traverse sub directories for driver packages.
      /subtree      : Remove entire device subtree, including any child devices.
      /uninstall    : Uninstall driver package from any devices using it.

PnPUtil is included in every version of Windows, starting with Windows Vista (in the %windir%\system32 directory). There isn't a separate PnPUtil download package.

Driver packages use a setup information (.INF) file for installing device drivers for hardware components.   
An INF file is a text file containing information used to properly install a driver package on a device.

### Examples

Add driver package:

> PNPUTIL /add-driver x:\driver.inf

Add multiple driver packages:

> PNPUTIL /add-driver c:\oem*.inf

Add and install driver package:

> PNPUTIL /add-driver device.inf /install

Delete driver package:

> PNPUTIL /delete-driver oem0.inf

Force delete driver package:

> PNPUTIL /delete-driver adobe.inf /force

Export driver package:

> PNPUTIL /export-driver ss64.inf

Export all driver packages:

> PNPUTIL /export-driver * c:\backup

Enumerate only enabled interfaces on the system:

> PNPUTIL /enum-interfaces /enabled

Enumerate all interfaces with specific interface class GUID:

> PNPUTIL /enum-interfaces /class {884b96c3-56ef-11d1-bc8c-00a0c91405dd}

Enumerate all OEM driver packages:

> PNPUTIL /enum-drivers

Disable device:

> PNPUTIL /disable-device "USB\VID_045E&PID_00DB\6&870CE29&0&1"

Enable device:

> PNPUTIL /enable-device "USB\VID_045E&PID_00DB\6&870CE29&0&1"

Restart device:

> PNPUTIL /restart-device "USB\VID_045E&PID_00DB\6&870CE29&0&1"

Remove device:

> PNPUTIL /remove-device "USB\VID_045E&PID_00DB\6&870CE29&0&1"

Scan devices:

> PNPUTIL /scan-devices

“I've learned that people will forget what you said, people will forget what you did, but people will never forget how you made them feel” ~ Maya Angelou

### Related commands

[DISKPART](diskpart.html) - Disk Administration.  
[FSUTIL](fsutil.html) - File and Volume utilities.  
[DriverQuery](driverquery.html) - Display installed device drivers.  



/. nt/popd.html
========================================================

    Popd - Restore directory/folder - Windows CMD - SS64.com

POPD
====

Change directory back to the path/folder most recently stored by the [PUSHD](pushd.html) command.  
POPD will also remove any temporary drive maps created by PUSHD

Syntax

      POPD 

PUSHD and POPD operate on a stack or LIFO (last in, first out) principle and so can be used multiple times.

### Examples

    C:\Program Files**>** PUSHD c:\utils
    C:\utils**>** PUSHD c:\Windows
    C:\Windows**>** 
    C:\Windows**>** POPD
    C:\utils**>** 
    C:\utils**>** POPD
    C:\Program Files**>**

Errorlevels
-----------

> If the directory is successfully changed [%ERRORLEVEL%](errorlevel.html) = _unchanged_, typically this will be 0 but if a previous command set an errorlevel, that will be preserved (this is a bug).
> 
> If a bad switch is given [%ERRORLEVEL%](errorlevel.html) = 1

POPD is an [internal](syntax-internal.html) command. If [Command Extensions](cmd.html) are disabled the PUSHD command will no longer map temporary drives to UNC paths, and POPD will not delete such drives.

"It's amazing how low you go to get high" - John Lennon  

### Related commands

[PUSHD](pushd.html) - Change the current directory/folder and store the previous folder/path.  
[CD](cd.html) - Change Directory, select a Folder (and drive).  
Equivalent PowerShell: [Pop-Location](../ps/pop-location.html) - Set the current working location from the stack (popd).  
Equivalent bash command (Linux):[popd](../bash/popd.html) - Remove the top entry from the directory stack.



/. nt/portqry.html
========================================================

    portqry - Windows CMD - SS64.com

PORTQRY ([Download](https://www.microsoft.com/downloads/details.aspx?familyid=89811747-C74B-4638-A2D5-AC828BDC6983&displaylang=en))
===================================================================================================================================

Port Query - Display the status of TCP and UDP ports, troubleshoot TCP/IP connectivity and security, return LDAP base query info, SMTP, POP3, IMAP4 status, enumerate SQL Server instances (UDP port 1434), Local ports, local services running (and the DLL modules loaded by each).

Portqry.exe can query a single port, a list of several ports, or a sequential range of port numbers.

Syntax


The 3 modes are listed below: Command line, Local and Interactive mode.

**Command line mode:**
    portqry -n _name_to_query_ [-p _protocol_]
             [-e | -r | -o _endpoint(s_)]
                [_other options_]

Command line mode options:
    -n [_name_to_query_]   IP address or name of system to query

    -p [_protocol_]        TCP or UDP or BOTH (default is TCP)

    -e [_endpoint_]        Single Port to query (valid range: 1-65535)
    -r [_end point range_] Range of ports to query (start:end)
    -o [_end point order_] Range of ports to query in an order (x,y,z)

    -l [_logfile_]  Output a log file

    -y            Overwrite existing log file without prompting

    -sp [_source port_] Initial source port to use for query

    -sl     'slow link delay' Wait longer for UDP replies from remote systems

    -nr     By-pass default IP address-to-name resolution
           ignored unless an IP address is specified after -n

    -cn     Specify SNMP community name for query
           ignored unless querying an SNMP port
           must be delimited with !

    -q      'Quiet' operation runs with no output
           returns 0 if port is listening
           returns 1 if port is not listening
           returns 2 if port is listening or filtered

**Local Mode:**
Local Mode gives detailed data on local system's ports

    portqry -local [-wt _seconds_] [-l _logfile_] [-v]
    portqry -wpid pid [-wt _seconds_] [-l _logfile_] [-v]
    portqry -wport port [-wt _seconds_] [-l _logfile_] [-v]

Local mode options:
    -local   Enumerate local port usage, port to process mapping,
           service port usage, and list loaded modules

    -wport [_port_number_]  Watch the specified port
           report when the port's connection status changes

    -wpid [_process_ID_]    Watch the specified process ID (PID)
           report when the PID's connection status changes
    -wt [_seconds_]   Watch time option
           specify how often to check for status changes
           valid range: 1 - 1200 seconds (default = 60 secs)

    -l [_logfile_]  Log file to create
  
    -v            Verbose output

**Interactive Mode:**
An alternative to command line mode

portqry -i [-_options_]

For help with -i run portqry.exe and then type 'help' <enter>

### Examples

portqry -local
portqry -local -l MyLogFile.txt -v
portqry -wpid 1272 -wt 5 -l MyLogFile.txt -y -v
portqry -wport 53 -l dnslog.txt
portqry -n myserver.com -e 25
portqry -n 10.0.0.1 -e 53 -p UDP -i
portqry -n host1.dev.reskit.com -r 21:445
portqry -n 10.0.0.1 -o 25,445,1024 -p both -sp 53
portqry -n host2 -cn !my community name! -e 161 -p udp

For best results run local commands in the context of local administrator.  
Port to process mapping is not be available on all systems.  
Defaults: TCP, port 80, no log file, slow link delay off.

Hit Ctrl-C to terminate prematurely.

“I always look for a woman who has a tattoo. I see a woman with a tattoo, and I’m thinking, okay, here’s a gal who’s capable of making a decision she’ll regret in the future” - Richard Jeni

### Related commands

[NSLOOKUP](nslookup.html) - Lookup IP addresses on a NameServer.  
[PortRptr](https://www.microsoft.com/downloads/details.aspx?familyid=69BA779B-BAE9-4243-B9D6-63E62B4BCD2E&displaylang=en) - Port Reporter, logging service for TCP/IP port usage.  
[NETSH diag](netsh.html) - Connect to TCP port.  
[WMIC PORTCONNECTOR](wmic.html) - Access Physical port.  
[Port Numbers](https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xml) at IANA.  
[Jon Honeyball](https://www.theinquirer.net/inquirer/news/1001872/fire-it-director) - Routing to harden machines against attack.  
[Q310099](https://support.microsoft.com/en-gb/help/310099/) - Description of PortQry.  
[Q832919](https://support.microsoft.com/en-gb/help/832919/) - New features in PortQry Version2.  
[Q310456](https://web.archive.org/web/20130424005958/https://support.microsoft.com/kb/310456) - Use PortQry to Troubleshoot Active Directory Connectivity (port 389).  
[Q310298](https://web.archive.org/web/20130424005950/https://support.microsoft.com/kb/310298) - Use PortQry to Troubleshoot MS Exchange (port 25).



/. nt/powercfg.html
========================================================

    PowerCfg - Windows CMD - SS64.com

PowerCFG
========

Control power settings, configure Hibernate/Standby modes.

Syntax

      powercfg [_Options_]

Options

    /AvailableSleepStates
    /A
            Report the sleep states available on the computer.
            Will also attempt to report reasons why sleep states are unavailable.

    /Aliases
            Display all aliases and their corresponding GUIDs.
            These can be used in place of a GUID at the command prompt.

    /batteryreport
            Generate a report of battery usage.

    /Change _settingvalue_
    /x _setting value_
            Modify one of the following settings in the current power scheme:
               monitor-timeout-ac _minutes_
               monitor-timeout-dc _minutes_
               disk-timeout-ac _minutes_
               disk-timeout-dc _minutes_
               standby-timeout-ac _minutes_
               standby-timeout-dc _minutes_
               hibernate-timeout-ac _minutes_
               hibernate-timeout-dc _minutes_
            Setting any value to 0 will set the timeout=Never
            AC settings are used when the system is on AC power. DC settings on battery power.

    /ChangeName _GUID PowerSchemeName_ [_scheme_description_]
            Modify the name of a power scheme and, optionally, the scheme description.

    /Delete _GUID_
    /D _GUID_
            Delete the power scheme with the specified GUID.

    /DeleteSetting _Sub_GUID Setting_GUID_
            Delete a power setting.

    /DeviceQuery _query_flags_
            Return a list of devices that meet the specified flags:
               wake_from_S1_supported – Waking the computer from a light sleep state.
               wake_from_S2_supported – Waking the computer from a deeper sleep state.
               wake_from_S3_supported – Waking the computer from the deepest sleep state.
               wake_from_any   – Support waking the computer from any sleep state.
               S1_supported    – Light sleep.
               S2_supported    – Deeper sleep.
               S3_supported    – Deepest sleep.
               S4_supported    – Hibernation.
               wake_programmable – User-configurable to wake the computer from a sleep state.
               wake_armed      – Currently configured to wake the computer from any sleep state.
               all_devices     – Present in the computer.
               all_devices_verbose – Verbose list of devices.

    /DeviceEnableWake _devicename_
            Enable the device to wake the computer from a sleep state.

    /DeviceDisableWake _devicename_
            Disable the device from waking the computer from a sleep state.

    /DuplicateScheme _GUID [DestinationGUID]_
            Duplicate a power scheme. The GUID of the new scheme will be displayed.
            If DestinationGUID is omitted, then a new GUID will be created for the duplicated scheme.

    /Energy
            Create energy-report.html in the current directory.

    /Export _filename GUID_
            Export a power scheme, represented by _GUID_, into _filename_.
            A power scheme GUID is returned by running **powercfg /list**.

    /GetActiveScheme
            Retrieve the currently active power scheme.

    /Hibernate [on|off]
    /H [on|off]
            Enable or disable the hibernate feature.
            This will also turn off Fast Startup (or hybrid sleep)
            Hibernate timeout is not supported on all computers.

    /import _filename_ [_GUID_]
            Import all power settings from the specified file.
            _filename_ is the path to a file generated with powercfg /export
            If no GUID is specified, a new GUID is created.

    /LastWake
            Report information about the last event that woke the computer.

    /L
    /List
            List the current user's power schemes (GUIDs)

    /Query [_Scheme_GUID_] [_Sub_GUID_]
    /q [_Scheme_GUID_] [_Sub_GUID_]
            Display the contents of a power scheme.

    /requests  Enumerate application and driver Power Requests.

    /requestsoverride
            Set a Power Request override for a particular Process, Service, or Driver.

    /SetActive _Scheme_GUID_
    /S _Scheme_GUID_
            Make the specified power scheme active on the computer.

    /SetacValueIndex _Scheme_GUID Sub_GUID Setting_GUID SettingIndex_
            Set a value associated with a specified power setting while the
            computer is powered by AC power. Use the /l and /q options to discover the GUIDs
            _SettingIndex_ Specifies which value in the list to set, so 3 = 3rd in the list

    /SetdcValueIndex _Scheme_GUID Sub_GUID Setting_GUID SettingIndex_
            Set a value associated with a specified power setting while the
            computer is powered by DC power.
            _SettingIndex_ Specifies which value in the list to set, so 3 = 3rd in the list

    /SetSecurityDescriptor [_GUID_|_Action_] _SDDL_
            Set a security descriptor associated with a specified power setting, power scheme, or action.
            _Action_ Is one of: ActionSetActive, ActionCreate, ActionDefault
            _SDDL_ is a valid security descriptor string in SDD format.
            Call powercfg /getsecuritydescriptor to see an example SDDL STRING.

    /GetSecurityDescriptor [_GUID_|_Action_]
            Get a security descriptor associated with a specified power setting, power scheme, or action.
            _Action_ is one of: ActionSetActive, ActionCreate, ActionDefault

    /sleepstudy
            Generates a diagnostic system power transition report.

    /srumutil  Dumps Energy Estimation data from System Resource Usage Monitor (SRUM).

    /SystemPowerReport [ /output _file_name_ ] [ /xml | /transformxml _file_name_ ]
    /spr [ /output _file_name_ ] [ /xml | /transformxml _file_name_ ]
            Generate a report of system power transitions over the last three days on the system,
            including connected standby power efficiency.
            Generates an HTML report in the current path. Requires elevation.

    /SystemSleepDiagnostics [ /output _file_name_ ] [ /xml ] [ /duration _days_ ]
            Generate a report of intervals when the user was not present over the last three
            days on the system, and if the system went to sleep.
            Generates an HTML report in the current path. Requires elevation.

    /WakeTimers
            Enumerate the active wake timers. (Typically used to run scheduled tasks)

    /Help
    /?       Display help

To make changes to power settings, Powercfg must be run from an elevated command prompt.

[Powercfg command-line options](https://docs.microsoft.com/en-us/windows-hardware/design/device-experiences/powercfg-command-line-options) - full details from docs.Microsoft.com

Reasons you you may wish to disable Hibernation/Fast Start:

*   The hibernation file can take up considerable disc space.
*   Linux users will likely see complications with dual boot and virtualization.
*   Wake-on-LAN may fail to work (or work reliably) when fast startup is enabled.
*   Windows 10 updates might not install properly, due to WOL failing to wake the machine.

These problems are by no means across the board, and are often due to an incompatible device driver, diagnose this by disabling each device in turn (with /DeviceDisableWake)

When activating Power Saving across an organisation, it is important to ensure that software updates (security patches and antivirus) are not disrupted.  
[WSUS](https://docs.microsoft.com/en-us/windows-server/administration/windows-server-update-services/get-started/windows-server-update-services-wsus) can be configured to install updates when workstations are available and [Scheduled Tasks](schtasks.html) can be set to Wake the machine when needed.

Power scheme GUIDs
------------------

> The use of [GUIDs](https://betterexplained.com/articles/the-quick-guide-to-guids/) avoids any problems with internationalisation when applying Power Saving to non-english versions of Windows.
> 
> The three most common built-in power schemes:
> 
> SCHEME_MAX = Power saver (Max power saving)  
> SCHEME_BALANCED = Balanced (Typical)  
> SCHEME_MIN = High performance (Min power saving)

### Examples

List all Aliases:

C:> powercfg /aliases  
a1841308-3541-4fab-bc81-f71556f20b4a SCHEME_MAX  
8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c SCHEME_MIN  
381b4222-f694-41f0-9685-ff5bb260df2e SCHEME_BALANCED  
fea3413e-7e05-4911-9a71-700331f1c294 SUB_NONE  
238c9fa8-0aad-41ed-83f4-97be242c8f20 SUB_SLEEP  
29f6c1db-86da-48c5-9fdb-f2b67b1f44da STANDBYIDLE  
9d7815a6-7ee4-497e-8888-515a05f02364 HIBERNATEIDLE  
94ac6d29-73ce-41a6-809f-6363ba21b47e HYBRIDSLEEP  
d4c1d4c8-d5cc-43d3-b83e-fc51215cb04d REMOTEFILESLEEP  
7516b95f-f776-4464-8c53-06167f40cc99 SUB_VIDEO

Retrieve the currently active power scheme:  
C:> Powercfg /getactivescheme  
  
Set the Monitor and disc timeouts for the current Power saver scheme  
C:> Powercfg /Change -monitor-timeout-ac 20  
C:> Powercfg /Change -disk-timeout-ac 30

Enable the mouse to wake from sleep:  
C:> Powercfg /deviceEnableWake "Microsoft USB IntelliMouse Explorer"  
  
Set the 'Power saver' scheme:  
C:> Powercfg /SETACTIVE SCHEME_MAX  
  
Create a Custom Power scheme and set it as active:  
Set _Custom_Power=B1234567-SS64-SS64-SS64-F00000111AAA  
Powercfg /DUPLICATESCHEME SCHEME_MAX %_Custom_Power%  
Powercfg /CHANGENAME %_Custom_Power% "SS64 Power Scheme "  
Powercfg /SETACTIVE %_Custom_Power%

Disable the sleep button (for the users current power scheme):  
For /f "tokens=2 delims=:(" %%G in ('powercfg /getActiveScheme') do (  
Powercfg /setAcValueIndex %%G SUB_BUTTONS sButtonAction 0  
Powercfg /setActive %%G  
)

Disable the sleep button (for all available power schemes):  
For /f "skip=2 tokens=2,4 delims=:()" %%G in ('powercfg /list') do (  
Powercfg /setAcValueIndex %%G SUB_BUTTONS sButtonAction 0  
if "%%H" == " *" Powercfg /setActive %%G  
)

“The fact that you have to choose between nine different ways of turning off your computer... produces just a little bit of unhappiness every time” - [Joel on Software](https://www.joelonsoftware.com/items/2006/11/21.html)

### Related commands

powercfg.cpl - Control Panel  
[Q915160](https://web.archive.org/web/20140719135111/http://support.microsoft.com/kb/915160) - Create a Group Policy object for power schemes.  
[3rd party Power Management tools](https://www.energystar.gov/products/low_carbon_it_campaign/implementation_resources_enterprises/commercial_software) - EnergyStar.gov  
[SCHTASKS](schtasks.html) - Schedule a command to run at a specific time.



/. nt/print.html
========================================================

    Print - Windows CMD - SS64.com

PRINT
=====

Print a file or files to a local or network printer.

Syntax

      PRINT [/D:_device_] [_pathname(s)_]

Key
    _device_    Either a local printer (LPTx, COMx )
             or a network printer by its sharename (\servername\print_share)

    _pathname_  The file or files to be printed.

The default device is PRN. The values PRN and LPT1 refer to the same parallel port.  
The PRINT command is most often used in conjunction with an [LPR print queue](syntax-printing.html) - sending plain ASCII text.

All recent versions of Windows have automatic _default printer_ management enabled by default. This can be enabled or disabled via policy:  
'User Configuration ➞ Policies ➞ Administrative Templates ➞ Control Panel ➞ Printers': 'Turn off Windows default printer management'.

When [printing to file](print-to-file.html), the destination file must not already exist.  
PRINT will add a FormFeed character ([ASCII 12](../ascii.html)) to the end of each print job.

### Examples

Delete a print job:
-------------------

> Use Control Panel ➞ Printers (GUI) or use  
> NET PRINT job# /DELETE  
>   
> It is possible to delete the spool .spl and .shd files from %SystemRoot%\system32\spool\PRINTERS but this should be a last resort - stop the spooler [service](syntax-services.html) before deleting any files.

Status Messages
---------------

> Many modern laser printers have a status display panel, the 'Ready' message can be changed using HP Job Language (PCL/PJL) like this:  
> Echo @PJL RDYMSG DISPLAY ="Ready Message" >\server\printQ  
> e.g.  
> Echo @PJL RDYMSG DISPLAY ="Ready Printer64" >\printserv1\printer64
> 
> It's not essential to include the word "Ready" in the ready message, but the status display has 16 characters, which is usually enough space for "Ready" plus the printer Name/Number. e.g. "Ready Printer123", "Ready Prn1234567", "Ready #123-45678" etc
> 
> Note that when a printer error or jam occurs the status message will change, so adding a printer identifier to the status display does not replace the need for a physical label. It can still be very useful when the physical label is wrong or missing.

Printing requires the Spooler [service](syntax-services.html) to be running.

“Without books the development of civilization would have been impossible. They are the engines of change, windows on the world, ''Lighthouses'' as the poet said ''erected in the sea of time'.' They are companions, teachers, magicians, bankers of the treasures of the mind, Books are humanity in print” ~ Arthur Schopenhauer

### Related commands

[Print to File](print-to-file.html) - Configure a printer to always print to a file.  
[NET PRINT](net-share.html) - View and Delete print jobs.  
[NET VIEW](net-share.html) - List all printer share names for a print server.  
Defptr - Default Printer. ([Win 2K ResKit](../links/windows.html#kits))  
[PRNCNFG](prncnfg.html) - Display, configure or rename a printer.  
[PRINTBRM](printbrm.html) - Print queue Backup/Recovery[.](con2prt.html)  
[WMIC PRINTER](wmic.html) - Set printing options through WMI.  
[Q234270](https://support.microsoft.com/en-gb/help/234270/) - Group Policies to Control Printers.  
[HP PCL 5 Printer Language Technical Reference Manual](https://www.google.com/search?&q=Hewlett-Packard+PCL+5+Printer+Language+Technical+Reference+Manual) - Full PCL Manual.  
Resource Kit: [prncnfg.vbs](prncnfg.html), prndrvr.vbs, prnjobs.vbs, prnmngr.vbs, prnport.vbs, prnqctl.vbs, pubprn.vbs  
Equivalent PowerShell: [Out-Printer](../ps/out-printer.html) - Send the output to a printer (lp).  
Equivalent bash command (Linux): [printf](../bash/printf.html) - Format and print data.



/. nt/printbrm.html
========================================================

    PRINTBRM.exe - Windows CMD - SS64.com

PRINTBRM.exe
============

Print queue Backup/Recovery/Migration.

Syntax

      PRINTBRM -b -s _\server_name_ -f _file_name_ _options_

      PRINTBRM -r -s _\server_name_ -f _file_name_ _options_

      PRINTBRM -q _options_

Key
    -s _server_name_ The unc path to the print server.
    -b             Back up the server to the specified file.
    -r             Restore the configuration in the file to the server.
    -q             Query the server or the backup file.
    -f _file_name_   The backup file.
    -d _directory_   Unpack the backup file to the directory (with -r),
                  or repack a backup file from the directory (with -b).
    -o force       Forces overwriting of existing objects.
    -p all         Publish all printers in the directory, or
    -p org         Publish the printers that were originally published.
    -nobin         Omit binary files from the backup.
    -lpr2tcp       Convert LPR ports to standard TCP/IP ports on restore.
    -c _file_name_   Use the specified configuration file.
    -noacl         Remove ACLs from print queues on restore.
    -?             Help

PrintBRM is not be included in the Windows [PATH](path.html) but will be found at %Windir%\System32\spool\tools\printbrm.exe

In Windows 2008 PrintBRM replaces the old Win 2003 PrintMig utility, it is backwards compatible with 2003.  
in Windows Server 2012 PrintBRM supports both v3 and v4 print drivers and can backup to .CAB files greater than 2 GB .

Get a list of all printer share names for a print server: net view \printserv1

PrintBRM can be run over the network to remote servers, but the Print$ share must exist on both the source and target server and the Remote Registry Service must be running.

If you move printers to a different domain, use the -NoACL parameter to prevent the restoration of print queue’s ACLs.

A backup or export operation using PrintBRM produces a compressed file that is used for the restore or import operation. This includes XML files for drivers, forms, port monitors, ports, printers, spooler directories. These details can be edited by using the -d option to unpack the file to XML, edit the files and then repack into a modified export file.

### Examples

Backup your printer queues:

C:> Printbrm.exe –b –nobin –s \PrintServer64 –f C:\scripts\backup.printerExport

On the new print server computer, manually install the updated printer drivers.  
Create a BrmConfig.xml configuration file to map the old drivers to the new drivers:

<BrmConfig>
  <PLUGINS>
  </PLUGINS>

  <LanguageMonitors>
  </LanguageMonitors>

  <DriverMap>
    <DRV old="OldDriverName1" new="NewDriverName1"/>
    <DRV old="OldDrverName2" new="NewDriverName2"/>
  </DriverMap>
</BrmConfig>

Restore the printers specifying your configuration file using your configuration file:  
C:> PrintBrm.exe –r –c BrmConfig.xml –f D:\scripts\backup.printerExport –o force

“Lots of people want to ride with you in the limo, but what you want is someone who will take the bus with you when the limo breaks down” ~ Oprah Winfrey

### Related commands

[PrintBRMui.exe](run.html) - GUI for Printer management.  
[NET PRINT](net-share.html) - View and Delete print jobs.  
[PRINT](print.html) - Print a text file.  
[PrintSave.vbs](../vb/syntax-printsave.html) - Save and Restore Windows Printer Connections.  
[Q938923](https://support.microsoft.com/en-gb/help/938923/) - Back up and restore printers from Win Server 2003 to Win Server 2008.  
Equivalent bash command (Linux): [printf](../bash/printf.html) - Format and print data.



/. nt/prncnfg.html
========================================================

    prncnfg - Windows CMD - SS64.com

PRNCNFG.vbs
===========

Configure a printer (set properties, rename).  

Display configuration information about a printer.  
prncnfg.vbs is a VB Script located in the %WINDIR%\System32\Printing_Admin_Scripts_lang_ directory.  

    cscript prncnfg.vbs **-g** [-s _RemoteComputer_]
            -p _PrinterName_ 
               [-u _UserName_ -w _Password_] 

Configure a printer:

    cscript prncnfg.vbs **-t** [-s _RemoteComputer_]
            -p PrinterName [-r _PortName_] [-l _Location_]
                [-m Comment] [-h _ShareName_] [-f _SeparatorText_]
                   [-y _DataType_] [-st _StartTime_] [-ut _EndTime_] [-o _Priority_]
                      [-i DefaultPriority] [{+ | -}shared] [{+ | -}direct]
                         [{+ | -}published] [{+ | -}hidden] [{+ | -}rawonly]
                              [{+ | -}queued] [{+ | -}keepprintedjobs]
                                  [{+ | -}workoffline] [{+ | -}enabledevq]
                                     [{+ | -}docompletefirst][{+ | -}enablebidi]

Change the name of a printer:

    cscript prncnfg.vbs **-x** [-s _RemoteComputer_]
            -p _PrinterName_ -z _NewPrinterName_
              [-u _UserName_ -w _Password_] 

Key

    -s _RemoteComputer_ 
         The name of the remote computer that manages the printer. 

    -p _PrinterName_ 
         The name of the printer.

    -u _UserName_ -w _Password_ 
         An account with permission to connect WMI services to the computer
         that hosts the printer. e.g. A member of the Administrators group. 

    -r _PortName_ 
         The port to which the printer is connected.
         If this is a parallel or a serial port, then use the ID of the port
         (for example, LPT1 or COM1). If this is a TCP/IP port, then use the
         port name that was specified when the port was added. 

    -l _Location_ 
         The printer location, such as "Copier Room." 

    -m _Comment_ 
         A comment string. 

    -h _ShareName_ 
         The share name. 

    -f _SeparatorText_ 
         A file that contains the text that appears on the separator page. 

    -y _DataType_ 
         Data types that the printer can accept. 

    -st _StartTime_ 
         Specify a time of the day after which the printer is available.
         If you send a document to a printer when it is unavailable, the
         document is held (spooled) until the printer becomes available.
         Specify time as a 24-hour clock. e.g. 2300

    -ut _EndTime_ 
         Specify a time of the day after which the printer is no longer available.

    -o _Priority_ 
         A priority that the spooler uses to route print jobs.
         A print queue with a higher priority receives all its
         jobs before any queue with a lower priority. 

    -i _DefaultPriority_ 
            The default priority assigned to each print job. 

    {+ | -}shared 
            Is this printer is shared on the network. 

    {+ | -}direct 
            Is the document to be sent directly to the printer without being spooled. 

    {+ | -}published 
            Is this printer to be published in Active Directory.
            If you publish a printer, other users can search for it based on its location
            and capabilities, such as color printing and stapling.

    {+ | -}hidden 
             Reserved function.

    {+ | -}rawonly 
             Are only raw data print jobs to be spooled on this queue. 

    {+ | -}queued 
             Do not begin to print until after the last page of the document is spooled.
             The printing program is unavailable until the document has finished printing.
             This option ensures that the whole document is available to the printer.

    {+ | -}keepprintedjobs 
             Retain documents after they are printed.
             Allows a user to resubmit a document to the printer from the print queue. 

    {+ | -}workoffline 
             Allow sending print jobs when computer is not connected to the network. 

    {+ | -}enabledevq 
             Print jobs that do not match the printer setup (for example, PostScript files
             spooled to non-PostScript printers) should be held in the queue rather than 
             being printed. 

    {+ | -}docompletefirst 
             Allocate jobs to a printer as soon as thay are spooled.
             If this option is disabled, the spooler always sends higher priority
             jobs to their respective queues first.
             You should enable this option if you want to maximize printer efficiency
             at the cost of job priority.  

    {+ | -}enablebidi 
             Send bi-directional status information to the spooler.

    ?         Help

Prncnfg.vbs is not on the Windows [PATH](path.html) but will be found at:  
%Windir%\System32\Printing_Admin_Scripts_[locale](../locale.html)_\prnmngr.vbs  

### Examples

    Set _scripts=**cscript** %Windir%\System32\Printing_Admin_Scripts\en-US

    :: Rename printer
    %_scripts%\prncnfg.vbs -x -p OldPrinter45 -z NewPrinter64

“Without books the development of civilization would have been impossible. They are the engines of change, windows on the world, ''Lighthouses'' as the poet said ''erected in the sea of time'.' They are companions, teachers, magicians, bankers of the treasures of the mind, Books are humanity in print” ~ Arthur Schopenhauer

### Related commands

[PRINT](print.html) - Print a text file.  
[NET VIEW](net-share.html) - to view a list of printers.  
[NET PRINT](net-print.html) - View and Delete print jobs.  
[PRNDRVR](prndrvr.html) - Add, delete or list printer drivers.  
[PRNJOBS](prnjobs.html) - Pause, resume, cancel, or list print jobs.  
[PRNMNGR](prnmngr.html) - Add, delete, or list printers / connections, set the default printer.  
[PRNPORT](prnport.html) - Manage TCP/IP printer ports, change port configuration.  
[PRNQCTL](prnqctl.html) - Manage printer queues, print a test page.  
[RUNDLL32](rundll32.html) - Install/Remove Printers (plus advanced options).  
[WMIC PRINTER](wmic.html) - Set printing options through WMI.  
[Q246868](https://web.archive.org/web/20140605094947/https://support.microsoft.com/kb/246868) - TCP/IP Printing options in the Windows Standard Port Monitor.  
Add printer - [.AddPrinterConnection](../vb/addprinterconnection.html)  
Add Network printer - [.AddWindowsPrinterConnection](../vb/addwindowsprinterconnection.html)  
List printers - [.EnumPrinterConnections](../vb/enumprinterconnections.html)  
Set default printer - [.SetDefaultPrinter](../vb/setdefaultprinter.html)  
Equivalent bash command (Linux): [lpc](../bash/lpc.html) - Line printer control program.



/. nt/prndrvr.html
========================================================

    PrnDrvr - Windows CMD - SS64.com

PRNDRVR.vbs
===========

Add, delete and list print drivers.

Syntax

      cscript PRNDRVR.vbs [-_options_] [-m _driver model_] [-s _server_]
                  [-u _user_name_] [-v {0 | 1 | 2 | 3}] [-w _password_] [-h _path_] [-i _inf_file_]

Options

    -a   Add the specified driver
    -d   Delete the specified driver
    -e   Environment {Windows NT x86 | Windows X64 | Windows IA64}
    -h   Driver file path
    -i   Fully qualified inf file anme
    -l   List all drivers
    -m   Driver model Name
    -s   Server Name
    -u   User Name
    -v   Version, for all current versions of Windows use 3.
        Will default to a driver version appropriate for the version of Windows running.
    -w   password
    -x   Delete all drivers that are not in use
    -?   Display help

PrnDrvr.vbs is not on the Windows [PATH](path.html) but will be found at:  
%Windir%\System32\Printing_Admin_Scripts_[locale](../locale.html)_\prnmngr.vbs

### Examples

Set _scripts=**cscript** %Windir%\System32\Printing_Admin_Scripts\en-US  
  
List all drivers on the \prnserv64  
%_scripts%\Prndrvr.vbs -l -s "prnserv64"  
  
Add a version 3 Windows x64 printer driver for the "Laser Printer Model 1" model of printer using the C:\temp\LaserPrinter1.inf driver information file for a driver stored in the C:\temp folder  
%_scripts%\Prndrvr.vbs -a -m "Laser Printer Model 1" -v 3 -e "Windows x64" -i c:\temp\LaserPrinter1.inf -h c:\temp  
  
Delete a version 3 Windows NT x86 printer driver for "Laser Printer Model 1"  
%_scripts%\Prndrvr.vbs -a -m "Laser Printer Model 1" -v 3 -e "Windows NT x86"  

“ Whenever people ask me: 'Why didn’t you get up when the bus driver asked you?' I say it felt as though Harriet Tubman's hands were pushing me down on one shoulder and Sojourner Truth's hands were pushing me down on the other shoulder. I felt inspired by these women because my teacher taught us about them in so much detail” ~ Claudette Colvin

### Related commands

[NET VIEW](net-share.html) \Printserver - to view a list of available printers.  
[NET PRINT](net-print.html) - View and Delete print jobs.  
[PRNCNFG](prncnfg.html) - Configure a printer.  
[PRNJOBS](prnjobs.html) - Pause, resume, cancel, or list print jobs.  
[PRNMNGR](prnmngr.html) - Add, delete or list printer drivers.  
[PRNPORT](prnport.html) - Manage TCP/IP printer ports, change port configuration.  
[PRNQCTL](prnqctl.html) - Print a test page, pause or resume a printer, clear a printer queue.  
[PRINT](print.html) - Print a text file.  
[RUNDLL32](rundll32.html) - Install/Remove Printers (plus advanced options).  
[WMIC PRINTER](wmic.html) - Set printing options through WMI.  
[Q246868](https://web.archive.org/web/20140605094947/https://support.microsoft.com/kb/246868) - TCP/IP Printing options in the Windows Standard Port Monitor.  
Add printer - [.AddPrinterConnection](../vb/addprinterconnection.html)  
Add Network printer - [.AddWindowsPrinterConnection](../vb/addwindowsprinterconnection.html)  
List printers - [.EnumPrinterConnections](../vb/enumprinterconnections.html)  
Set default printer - [.SetDefaultPrinter](../vb/setdefaultprinter.html)  
Equivalent bash command (Linux): [lpc](../bash/lpc.html) - Line printer control program.



/. nt/prnjobs.html
========================================================

    PrnJobs - Windows CMD - SS64.com

PRNJOBS.vbs
===========

Pause, resume, cancel, or list print jobs.

Syntax

      cscript PRNJOBS.vbs [-_options_] [-s _server_] [-p _printer_] [-j _jobid_]
                  [-u _user_name_]  [-w _password_]

Options

    -j   Job ID
    -l   List all jobs
    -p   Printer Name
    -s   Server Name
    -u   User Name
    -w   password
    -x   Cancel the job
    -z   Pause the job
    -?   Display help

PrnJobs.vbs is not on the Windows [PATH](path.html) but will be found at:  
%Windir%\System32\Printing_Admin_Scripts_[locale](../locale.html)_\prnmngr.vbs

### Examples

Set _scripts=**cscript** %Windir%\System32\Printing_Admin_Scripts\en-US  
  
List all current print jobs in the queue for the local printer named ColorPrinter_2  
%_scripts%\prnjobs.vbs -l -p ColorPrinter_2  
  
Pause a print job with a job ID of 27 sent to the remote computer named prnserv64 for printing on the printer named Gareth  
%_scripts%\prnjobs.vbs -z -s prnserv64 -p Gareth -j 27  

“My father used to have an expression. He'd say, 'Joey, a job is about a lot more than a paycheck. It's about your dignity. It's about respect. It's about your place in your community'” ~ Joe Biden

### Related commands

[NET VIEW](net-share.html) \Printserver - to view a list of available printers.  
[NET PRINT](net-print.html) - View and Delete print jobs.  
[PRNCNFG](prncnfg.html) - Configure a printer.  
[PRNDRVR](prndrvr.html) - Add, delete or list printer drivers.  
[PRNMNGR](prnmngr.html) - Add, delete or list printer drivers.  
[PRNPORT](prnport.html) - Manage TCP/IP printer ports, change port configuration.  
[PRNQCTL](prnqctl.html) - Manage printer queues, print a test page.  
[PRINT](print.html) - Print a text file.  
[RUNDLL32](rundll32.html) - Install/Remove Printers (plus advanced options).  
[WMIC PRINTER](wmic.html) - Set printing options through WMI.  
[Q246868](https://web.archive.org/web/20140605094947/https://support.microsoft.com/kb/246868) - TCP/IP Printing options in the Windows Standard Port Monitor.  
Add printer - [.AddPrinterConnection](../vb/addprinterconnection.html)  
Add Network printer - [.AddWindowsPrinterConnection](../vb/addwindowsprinterconnection.html)  
List printers - [.EnumPrinterConnections](../vb/enumprinterconnections.html)  
Set default printer - [.SetDefaultPrinter](../vb/setdefaultprinter.html)  
Equivalent bash command (Linux): [lpc](../bash/lpc.html) - Line printer control program.



/. nt/prnmngr.html
========================================================

    PrnMngr - Windows CMD - SS64.com

PRNMNGR.vbs
===========

Add, delete and list printers and printer connections, can also display or set the _default_ printer.

Syntax

      cscript PRNMNGR.vbs [-_options_] [-s _server_] [-p _printer_name_] [-m _driver model_]
                  [-r _port_] [-u _user_name_] [-w _password_]

Options

    -a   Add local printer
    -ac  Add printer connection
    -d   Delete printer
    -g   Get the default printer
    -l   list printers
    -m   Driver model
    -p   Printer Name
    -r   Port Name
    -s   Server Name
    -t   Set the default printer
    -u   User Name
    -w   password
    -x   Delete all printers
    -xc  Delete all printer connections
    -xo  Delete all local printers
    -?   Display help

PrnMngr.vbs is not on the Windows [PATH](path.html) but will be found at:  
%Windir%\System32\Printing_Admin_Scripts_[locale](../locale.html)_\prnmngr.vbs

All recent versions of Windows have automatic _default printer_ management enabled by default. This can be enabled or disabled via policy:  
'User Configuration ➞ Policies ➞ Administrative Templates ➞ Control Panel ➞ Printers': 'Turn off Windows default printer management'.

### Examples

Set _scripts=cscript %Windir%\System32\Printing_Admin_Scripts\en-US

:: Add printer 'print64'
%_scripts%\prnmngr.vbs -a -p "print64" -m "Brother 2140" -r "lpt1:"

:: Delete the printer 'print64' from print server 'prnserv1'
%_scripts%\prnmngr.vbs -d -p "print64" -s prnserv1

:: Connect to printer
%_scripts%\prnmngr.vbs -ac -p "\prnserv1\print64"

:: Delete a printer connection
%_scripts%\prnmngr.vbs -d -p "\prnserv1\print64"

:: List all printers on a printserver
%_scripts%\prnmngr.vbs -l -s prnserv1

:: Delete all printers on a printserver
%_scripts%\prnmngr.vbs -x -s prnserv1

:: List a specific printer
%_scripts%\prnmngr.vbs -l |find "Printer name"

:: Get the DEFAULT printer
%_scripts%\prnmngr.vbs -g

:: Set the DEFAULT printer
%_scripts%\prnmngr.vbs -t -p "\server\printer"

“We photographers deal in things which are continually vanishing, and when they have vanished there is no contrivance on earth can make them come back again. We cannot develop and print a memory” ~ Henri Cartier-Bresson

### Related commands

[NET VIEW](net-share.html) \Printserver - to view a list of available printers.  
[NET PRINT](net-print.html) - View and Delete print jobs.  
[PRNCNFG](prncnfg.html) - Add, delete, or list printers / connections, set the default printer.  
[PRNDRVR](prndrvr.html) - Add, delete or list printer drivers.  
[PRNJOBS](prnjobs.html) - Pause, resume, cancel, or list print jobs.  
[PRNPORT](prnport.html) - Manage TCP/IP printer ports, change port configuration.  
[PRNQCTL](prnqctl.html) - Manage printer queues, print a test page.  
[PRINT](print.html) - Print a text file.  
[RUNDLL32](rundll32.html) - Install/Remove Printers (plus advanced options).  
[WMIC PRINTER](wmic.html) - Set printing options through WMI.  
[Q246868](https://web.archive.org/web/20140605094947/https://support.microsoft.com/kb/246868) - TCP/IP Printing options in the Windows Standard Port Monitor.  
Add printer - [.AddPrinterConnection](../vb/addprinterconnection.html)  
Add Network printer - [.AddWindowsPrinterConnection](../vb/addwindowsprinterconnection.html)  
List printers - [.EnumPrinterConnections](../vb/enumprinterconnections.html)  
Set default printer - [.SetDefaultPrinter](../vb/setdefaultprinter.html)  
Equivalent bash command (Linux): [lpc](../bash/lpc.html) - Line printer control program.



/. nt/prnport.html
========================================================

    PrnPort - Windows CMD - SS64.com

PRNPORT.vbs
===========

Create, delete, or list TCP/IP printer ports, change port configuration.

Syntax

      cscript PRNPORT.vbs [-_options_] [-r _port_] [-s _server_] [-u _user_name_]  [-w _password_]
                  [-o raw|lpr ] [-h _host address_] [-q _queue_] [-n _number_] [-me | -md]
                     [-i SNMP _index_] [-y _community_] [-2e | -2d]

Options

    -a   Add a port
    -d   Delete the specified port
    -g   Get configuration for a TCP port
    -h   IP address of the device
    -i   SNMP index, if SNMP is enabled
    -l   List all TCP ports
    -m   SNMP type. [e] enable, [d] disable
    -n   Port number, applies to TCP RAW ports
    -o   Port type, raw or lpr
    -q   Queue name, applies to TCP LPR ports only
    -r   Port name
    -s   Server Name
    -t   Set configuration for a TCP port
    -u   User Name
    -w   password
    -y   Community name, if SNMP is enabled
    -2   Double spool, applies to tcp LPR ports. [e] enable, [d] disable
    -?   Display help

PrnPort.vbs is not on the Windows [PATH](path.html) but will be found at:  
%Windir%\System32\Printing_Admin_Scripts_[locale](../locale.html)_\prnmngr.vbs

### Examples

Set _scripts=**cscript** %Windir%\System32\Printing_Admin_Scripts\en-US  
  
Display all standard TCP/IP printing ports on the server \prnserv64:  
%_scripts%\Prnport.vbs -l -s prnserv64  
  
Delete the standard TCP/IP printing port on the server \Server64 that connects to a network printer at 10.2.3.4:  
%_scripts%\Prnport.vbs -d -s Server64 -r IP_10.2.3.4

Add a standard TCP/IP printing port on the server \Server64 that connects to a network printer at 10.2.3.4 and uses the TCP raw protocol on port 9100:  
%_scripts%\Prnport.vbs -a -s Server64 -r IP_10.2.3.4 -h 10.2.3.4 -o raw -n 9100

Enable SNMP, specify the "public" community name and set the SNMP index to 1 on a network printer at 10.2.3.4 shared by the server \Server64:  
%_scripts%\Prnport.vbs -t -s Server64 -r IP_10.2.3.4 -me -y public -i 1 -n 9100

Add a standard TCP/IP printing port on the local computer that connects to a network printer at 10.2.3.4 and automatically get the device settings from the printer:  
%_scripts%\Prnport.vbs -a -r IP_10.2.3.4 -h 10.2.3.4  

“ If the highest aim of a captain were to preserve his ship, he would keep it in port forever” ~ Thomas Aquinas

### Related commands

[NET VIEW](net-share.html) \Printserver - to view a list of available printers.  
[NET PRINT](net-print.html) - View and Delete print jobs.  
[PRNCNFG](prncnfg.html) - Configure a printer.  
[PRNDRVR](prndrvr.html) - Add, delete or list printer drivers.  
[PRNJOBS](prnjobs.html) - Pause, resume, cancel, or list print jobs.  
[PRNMNGR](prnmngr.html) - Add, delete or list printer drivers.  
[PRNQCTL](prnqctl.html) - Manage printer queues, print a test page.  
[PRINT](print.html) - Print a text file.  
[RUNDLL32](rundll32.html) - Install/Remove Printers (plus advanced options).  
[WMIC PRINTER](wmic.html) - Set printing options through WMI.  
[Q246868](https://web.archive.org/web/20140605094947/https://support.microsoft.com/kb/246868) - TCP/IP Printing options in the Windows Standard Port Monitor.  
Add printer - [.AddPrinterConnection](../vb/addprinterconnection.html)  
Add Network printer - [.AddWindowsPrinterConnection](../vb/addwindowsprinterconnection.html)  
List printers - [.EnumPrinterConnections](../vb/enumprinterconnections.html)  
Set default printer - [.SetDefaultPrinter](../vb/setdefaultprinter.html)  
Equivalent bash command (Linux): [lpc](../bash/lpc.html) - Line printer control program.



/. nt/prnqctl.html
========================================================

    PrnQctl - Windows CMD - SS64.com

PRNQCTL.vbs
===========

Print a test page, pause or resume a printer, clear a printer queue.

Syntax

      cscript PRNQCTL.vbs [-_options_] [-s _server_] [-p _printer_] [-u _user_name_] [-w _password_]

Options

    -e   Print a test page
    -m   Resume the printer
    -p   Printer name
    -s   Server Name
    -u   User Name
    -w   password
    -x   Purge the printer (cancel all jobs)
    -z   Pause the printer
    -?   Display help

PrnQctl.vbs is not on the Windows [PATH](path.html) but will be found at:  
%Windir%\System32\Printing_Admin_Scripts_[locale](../locale.html)_\prnmngr.vbs

### Examples

Set _scripts=**cscript** %Windir%\System32\Printing_Admin_Scripts\en-US  
  
Print a test page on the LaserPrinter1 printer shared by the \prnserv64 computer :  
%_scripts%\Prnqctl.vbs -e -s prnserv64 -p LaserPrinter1  
  
Pause printing on the LaserPrinter1 printer on the local computer:  
%_scripts%\Prnqctl.vbs -z -p LaserPrinter1

Cancel all print jobs on the LaserPrinter1 printer on the local computer:  
%_scripts%\Prnqctl.vbs -x -p LaserPrinter1  

“ If the highest aim of a captain were to preserve his ship, he would keep it in port forever” ~ Thomas Aquinas

### Related commands

[NET VIEW](net-share.html) \Printserver - to view a list of available printers.  
[NET PRINT](net-print.html) - View and Delete print jobs.  
[PRNCNFG](prncnfg.html) - Configure a printer.  
[PRNDRVR](prndrvr.html) - Add, delete or list printer drivers.  
[PRNJOBS](prnjobs.html) - Pause, resume, cancel, or list print jobs.  
[PRNMNGR](prnmngr.html) - Add, delete or list printer drivers.  
[PRNPORT](prnport.html) - Manage TCP/IP printer ports, change port configuration.  
[PRINT](print.html) - Print a text file.  
[RUNDLL32](rundll32.html) - Install/Remove Printers (plus advanced options).  
[WMIC PRINTER](wmic.html) - Set printing options through WMI.  
[Q246868](https://web.archive.org/web/20140605094947/https://support.microsoft.com/kb/246868) - TCP/IP Printing options in the Windows Standard Port Monitor.  
Add printer - [.AddPrinterConnection](../vb/addprinterconnection.html)  
Add Network printer - [.AddWindowsPrinterConnection](../vb/addwindowsprinterconnection.html)  
List printers - [.EnumPrinterConnections](../vb/enumprinterconnections.html)  
Set default printer - [.SetDefaultPrinter](../vb/setdefaultprinter.html)  
Equivalent bash command (Linux): [lpc](../bash/lpc.html) - Line printer control program.



/. nt/procdump.html
========================================================

    ProcDump - Monitor CPU/processes - Windows CMD - SS64.com

ProcDump ([SysInternals](https://docs.microsoft.com/en-gb/sysinternals/downloads/procdump))
===========================================================================================

Monitor an application for CPU spikes and/or generate a crash dump during a CPU spike.

Syntax

      procdump [-a] **[**[-c|-cl CPU usage] [-u] [-s _seconds_]**]** [-n _exceeds_] **[**-e [1 [-b]]
         [-f _filter_,...] [-g] [-h] [-l] [-m|-ml _commit_threshold_MB_] [-ma | -mp] [-o]
            [-p|-pl _counter threshold_] [-r] [-t] [-d <_callback DLL_>] [-64] 
               <[-w] _process_name_or_service_name_or_PID_ [_dump_file_]
                | -i _dump_file_
                | -u
                | -x _dump_file_ _image_file_ [_arguments_] >**]**
                  [-accepteula] [-? [ -e]

Key:

    -a   Avoid outage. Requires -r. If the trigger will cause the target to suspend for a 
        prolonged time due to an exceeded concurrent dump limit, the trigger will be skipped.

    -b   Treat debug breakpoints as exceptions (otherwise ignore them).

    -c   CPU threshold at which to create a dump of the process.

    -cl  CPU threshold below which to create a dump of the process.

    -d   Invoke the minidump callback routine named MiniDumpCallbackRoutine of the specified DLL.

    -e   Write a dump when the process encounters an unhandled exception. Include the 1 to
        create dump on first chance exceptions.

    -f   Filter the first chance exceptions. Wildcards (*) are supported. To just display the
        names without dumping, use a blank ("") filter.

    -g   Run as a native debugger in a managed process (no interop).

    -h   Write dump if process has a hung window (does not respond to window messages for at least 5 seconds).

    -i   Install ProcDump as the AeDebug postmortem debugger.
        Only -ma, -mp, -d and -r are supported as additional options.

    -l   Display the debug logging of the process.

    -m   Trigger a dump when memory commit reaches this threshold value (in MB).

    -ma  Write a dump file with all process memory. The default dump format only includes thread
        and handle information.

    -ml  Trigger when memory commit drops **below** specified threshold value (in MB).

    -mp  Write a dump file with thread and handle information, and all read/write process memory.
        To minimize dump size, memory areas larger than 512MB are searched for, and if found,
        the largest area is excluded. A memory area is the collection of same sized memory allocation
        areas. The removal of this (cache) memory reduces Exchange and SQL Server dumps by over 90%.

    -n   Number of dumps to write before exiting.

    -o   Overwrite an existing dump file.

    -p   Trigger on the specified performance counter when the threshold is exceeded.
        Note: to specify a process counter when there are multiple instances of the process running,
        use the process ID with the following syntax: "\Process(_name_pid_)\counter"

    -pl  Trigger when performance counter falls below the specified value.

    -r   Dump using a clone. Concurrent limit is optional (default 1, max 5).
        CAUTION: a high concurrency value can impact system performance.
          Windows 7   : Uses Reflection. OS doesn't support -e.
          Windows 8.0 : Uses Reflection. OS doesn't support -e.
          Windows 8.1+: Uses PSS. All trigger types are supported.

    -s   Consecutive seconds before dump is written (default is 10).

    -t   Write a dump when the process terminates.

    -u   Treat CPU usage relative to a single core (used with -c).
        As the only option, Uninstalls ProcDump as the postmortem debugger.

    -w   Wait for the specified process to launch if it's not running.

    -x   Launch the specified image with optional arguments.
        If it is a Store Application or Package, ProcDump will start on the next activation (only).

    -64  By default ProcDump will capture a 32-bit dump of a 32-bit process when running on 64-bit Windows.
        This option overrides to create a 64-bit dump. Only use for WOW64 subsystem debugging.

    -accepteula Suppress the display of the license dialog.

    -?   Use -? -e to see example command lines.

If you omit the dump file name, it will default to _processname_datetime_.dmp

### Examples

Write a mini dump of a process named 'notepad' (only one match can exist):

C:> procdump notepad

Write a full dump of a process with PID '6464':

C:> procdump -ma 6464

Write 3 mini dumps 5 seconds apart of a process named 'notepad':

C:> procdump -s 5 -n 3 notepad

See a longer list of example command lines:

C:> procdump -? -e

_“History will be kind to me for I intend to write it” ~ Winston Churchill_

### Related commands

[PsKill](pskill.html) - Kill processes by name or process ID.  
[PsList](pslist.html) - List detailed information about processes.  
[SYSMON](sysmon.html) - Monitor and log system activity to the Windows event log.



/. nt/prompt.html
========================================================

    PROMPT - Windows CMD - SS64.com

PROMPT
======

Change the appearance of the [cmd.exe](cmd.html) command prompt.

Syntax

      PROMPT [_text_] 
   
Key
    _text_ : a text string.

The prompt text can be made up of normal characters and the following special codes:

    $A  &           (Ampersand) 
    $B  |           (pipe) 
    $C  (           (Opening parenthesis) 
    $D Current date 
    $E Escape code  ([ASCII code](../ascii.html) 27) 
    $F  )           (Closing parenthesis) 
    **$G**  >           (greater-than sign) 
    $H  Backspace   (erases previous character) 
    $L  <           (less-than sign) 
    $M  Display the remote name for Network drives
    $N  Current drive 
    **$P**  Current drive and path 
    $Q  =           (equal sign) 
    $S              (space) 
    $T  Current time 
    $V  Windows version number 
    $_  Carriage return and linefeed 
    $$  $           (dollar sign)
    $+  Will display plus signs (+) one for each level of the PUSHD directory stack

The default prompt is $P$G (drive/path followed by > )  

The PROMPT command is tied to the %PROMPT% environment variable, editing the variable will lead to the same result as using the PROMPT command (e.g. PROMPT $P$G is the same as SET PROMPT=$P$G)

If the %PROMPT% variable is deleted, the prompt will automatically revert to the default.

To set the CMD prompt for all sessions, set a permanent environment variable ([SETX](setx.html)) with the appropriate prompt text. e.g.  
SETX PROMPT $M$_$P$G  

The prompt variable only holds the prompt definition, the final prompt characters are calculated by the CMD console.

The maximum length of a prompt string is 511 characters. If a longer prompt is set it will be silently truncated to the first 511 symbols.  
The dollar codes each count as 1 character.

Errorlevels
-----------

> When [CMD Command Extensions](cmd.html) are enabled (the default)
> 
> If the prompt was successfully changed [%ERRORLEVEL%](errorlevel.html) = _unchanged_, typically this will be 0 but if a previous command set an errorlevel, that will be preserved (this is a bug).
> 
> If prompt could not be changed [%ERRORLEVEL%](errorlevel.html) = 1
> 
> If an attempt is made to set a prompt using a dollar sign followed by any character not in the list of codes above, then everything after that dollar sign will be ignored.
> 
> PROMPT does not error if passed invalid switches PROMPT /Z /invalid - it will just set them as part of the prompt.

### Examples

Display the UNC path whenever you are using a network drive (mapped with NET USE)  
`PROMPT $M$_$P$G`

Simulate an HP-UX style prompt with the computername and the current folder on separate lines:  
`PROMPT=$p$_%username%@%computername%:.`

Display the time, backspacing to hide the milliseconds:  
`PROMPT=$T$H$H$H$G$S`

Restore the default prompt:  
`PROMPT $P$G`

Save a backspace character (obtained via the $H option) into the variable %BS%. ([source](https://ss64.org/viewtopic.php?f=2&t=87))  
For /F %%A in ('Echo `PROMPT` $H ^| cmd') do Set "BS=%%A"  

PROMPT is an [internal](syntax-internal.html) command. If [Command Extensions](cmd.html) are disabled the commands $M and $+ are not supported.

“All actions are judged by the motive prompting them” ~ Muhammad

### Related commands

[SETX](setx.html) - Set an environment variable permanently.  
Equivalent PowerShell: Create a function called [Prompt](https://devblogs.microsoft.com/powershell/setting-the-console-title-to-be-your-current-working-directory/) (save in Profile.ps1 to make permanent).  
Equivalent bash command (Linux): variable [$PROMPT_COMMAND](../bash/syntax-prompt.html)



/. nt/psexec.html
========================================================

    PsExec - Execute process remotely - Windows CMD - SS64.com

PsExec ([SysInternals](https://docs.microsoft.com/en-gb/sysinternals/downloads/sysinternals-suite))
===================================================================================================

Execute a command-line process on a remote machine.

Syntax

      psexec \_computer_[,_computer_[,..] [_options_] _command_ [_arguments_]

      psexec @_run_file_ [_options_] _command_ [_arguments_]

Options:

    _computer_   The computer on which psexec will run _command_. Default = local system 
              To run against all computers in the current domain enter "\*"
               
    @_run_file_  Run _command_ on every computer listed in the text file specified.

    _command_    Name of the program to execute on the remote machine.

    _arguments_  Arguments to pass (file paths must be absolute paths on the target system)

    -a _n_,_n_,... Set processor affinity to _n_. Processors are numbered as 1,2,3,4 etc
              so to run the application on CPU 2 and CPU 4, enter: "-a 2,4"

    -c         Copy the program (_command_)to the remote system for execution.
    -c -f      Copy even if the file already exists on the remote system.
    -c -v      Copy only if the file is a higher version or is newer than the remote copy.

    If you omit the -c option then the application must be in the system path on the remote system.

    -d         Don’t wait for the application to terminate.
              Only use for non-interactive applications.

    -e         Do NOT load the specified account’s profile.
              (In early versions of PSEXEC: Load the user account's profile, don’t use with -s)

    -f         Copy the specified program even if the file already exists on the remote system.

    -h         Run with the account's [elevated token](syntax-elevate.html), if available. (Vista or higher)

    -i         Interactive - Run the program so that it interacts with the desktop on the remote system.
              If no session is specified, the process runs in the console session.

    -l         Limited - Run process as limited user.  Run with Low Integrity.
              Strips the Administrators group and allows only privileges assigned to the Users group.

    -n _s_       Specify a timeout (_s_ seconds) for connecting to the remote computer.

    -p _psswd_   Specify a password for _user_ (optional). Passed as clear text.
              If omitted, you will be prompted to enter a hidden password.

    -r         The name of the remote service to create or interact with.

    -s         Run remote process in the SYSTEM account (use with caution).

    -u _user_    Specify a user name for login to remote computer(optional).

    -v         Copy the specified file only if it has a higher version number or is newer
              than the one on the remote system.

    -w _directory_ Set the working directory of the process (relative to the remote computer).

    -x         Display the UI on the Winlogon desktop (local system only).

    -low, -belownormal, -abovenormal, -high or -realtime
              These options will run the process at a different priority.
              also -background (Vista and above) will run at low memory and I/O priority.

    -accepteula Suppress the display of the license dialog.

For PsExec to work, _File and Printer sharing_ must be enabled on the remote computer. This can be done with [netsh](netsh.html) advfirewall or Group Policy (Local Computer Policy ➞ User Configuration ➞ Administrative Templates ➞ Windows Components ➞ Network Sharing)  
You may also have to enable it under Control Panel ➞ Network ➞ Network Adapter ➞ properties.

If you omit username the remote process will run in the same account from which you execute PsExec, but because the remote process is impersonating it will not have access to network resources on the remote system.

When installing psexec.exe just ensure it is placed somewhere in either the system [PATH](path.html) or in the [current](cd.html) directory.

When you specify a username the remote process will execute in that account, and will have access to that account's network resources. If you do specify an alternative username/password, then PsExec will send the [logon](syntax-logon-types.html) password in clear text. This can be a security risk if unauthorized network sniffers could intercept traffic between the local and remote system.

PsExec can be used to start GUI applications, but in that case the GUI will appear on the remote machine.

Input is passed to the remote system when you press the enter key - typing Ctrl-C will terminate the remote process.

PsExec does not require you to be an administrator of the local filesystem, with the correct password psexec will allow _UserA_ to run commands as _UserB_ - a [Runas](runas.html) replacement.

If you kill a PsExec process, you might also need to manually remove the background service:  
sc.exe \workstation64 delete psexesvc

PsExec can also be used to start a process (on a remote or local machine) as SYSTEM, this is a very privileged account similar to root on a UNIX machine ~ use with extreme caution.

Error [codes](errorlevel.html) returned by PsExec are specific to the applications you execute, not PsExec.

Accept eula
-----------

> When launched for the first time, PsExec will prompt you to accept the EULA. There is a command line option for this, but Psexec will swallow the first "-accepteula" on the command line, no matter where it occurs, so when using psexec to run any other ps* utilities, you will have to pass "-accepteula" twice:
> 
> psexec -accepteula -s c:\utils\pslist.exe -accepteula
> 
> Surround any long filenames "with quotation marks"
> 
> Alternatively just write directly to the license registry key:  
> 
> Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Sysinternals' -Name 'EulaAccepted' -Value 1

Internal commands
-----------------

> Internal commands (such as COPY, CD, DIR etc) are only available within the CMD shell. To run these commands from PsExec you must call [CMD /C](cmd.html) and then pass the commands as parameters - see the examples below.

### Examples

Launch an interactive command prompt on \workstation64, the CMD prompt window will appear locally:  
(This is equivalent to PowerShell: [New-PSSession](../ps/new-pssession.html) _ServerName_ ; Start-PSSession _ServerName_)

C:> PSEXEC \workstation64 CMD

Launch an [Elevated](syntax-elevate.html) interactive command prompt on \workstation64, this must be run from a local command prompt which is already elevated:

C:> PSEXEC \workstation64 -h CMD

Launch an [Elevated](syntax-elevate.html) interactive [PowerShell](../ps/powershell.html) prompt on \workstation64, this must be run from a local command prompt which is already elevated:

C:> PSEXEC \workstation64 -h powershell

Execute a program that is already installed on the remote system:

C:> PSEXEC \workstation64 "c:\Program Files\test.exe"

Connect to workstation64 and run [IPCONFIG](ipconfig.html) to display the remote PC's IP address:

C:> PSEXEC \workstation64 ipconfig

Connect to workstation64 and list a directory:

C:> PSEXEC \workstation64 -s cmd /c dir c:\work

Connect to workstation64 and copy a file from another server:

C:> PSEXEC \workstation64 -s cmd /c copy \server21\share45\file.ext c:\localpath

Execute IpConfig on the remote system, and display the output locally:

C:> PSEXEC \workstation64 ipconfig /all

Copy the program test.exe to the remote system and execute it interactively, running under the account DannyGlover:

C:> PSEXEC \workstation64 -c test.exe -u DannyGlover -p Pa55w0rd

Run Internet Explorer on the local machine but with limited-user privileges:

C:> PSEXEC -l -d "c:\program files\internet explorer\iexplore.exe"

Run Regedit on the local machine with SYSTEM privileges:

C:> PSEXEC -s -i regedit.exe

From PowerShell, run a VBscript on a remote workstation, pass some parameters and log the result:

$script='C:\Program Files\demo.vbs'  
$args = "some more stuff"  
& PSEXEC -s \workstation64 "c:\windows\system32\cscript.exe" $script $args /log 'C:\logs\demo.txt'

_“Don’t ask what the world needs. Ask what makes you come alive, and go do it. Because what the world needs is people who have come alive” - Howard Thurman_

### Related commands

[Q942817](https://support.microsoft.com/en-gb/help/942817/) - Remote UAC LocalAccountTokenFilterPolicy setting (allow remote administration)  
[RUNAS](runas.html) - Execute a program under a different user account.  
[xCMD](../links/windows.html#utils) - 3rd party utility.  
Equivalent PowerShell command: [Invoke-Command](../ps/invoke-command.html)  
Equivalent bash command (Linux): xon - start an X program on a remote machine.



/. nt/psfile.html
========================================================

    PsFile - Show files opened remotely - Windows CMD - SS64.com

PsFile ([SysInternals](https://docs.microsoft.com/en-gb/sysinternals/downloads/sysinternals-suite))
===================================================================================================

Show files opened remotely, or close an open file (kill file locks)

Syntax

      psfile [\_Computer_ [-u _User_ [-p _Passwd_]]]  [[Id | path]  [-c]]

Options:

    computer   The remote computer on which to list files. Default = local system 

              
    -p _passwd_  Specify a password for _user_ (optional). Passed as clear text.
              If omitted, you will be prompted to enter a hidden password.

    -u _user_    Specify a username for login to remote computer(optional).

    Id         Identifier (as assigned by PsFile) of the file for which to display info or to close.

    Path       Full or partial path of files to match for information display or close.

    -c         Close the files identifed by ID or path.

    -accepteula Suppress the display of the license dialog.

Unlike the NET FILE command, PsFile does not truncate long filenames.

When installing psfile.exe just ensure it is placed somewhere in either the system [PATH](path.html) or in the [current](cd.html) directory.

When launched for the first time, PsFile will prompt you to accept the EULA.  
You can avoid this by writing the license registry key:  

Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Sysinternals' -Name 'EulaAccepted' -Value 1

### Examples

List all the files on \workstation64 that have been opened remotely:

psfile \workstation64

_“Faith does not consist in the belief that we are saved; it consists in the belief that we are loved” ~ Alexandre Vinet_

### Related commands

[NET FILE](net-share.html) - Display all the open shared files on a server and the lock-id.  
[OPENFILES](openfiles.html) - Query or display open files.  
Equivalent bash command (Linux): inotify - file-monitoring mechanism



/. nt/psgetsid.html
========================================================

    PsGetSid - Show files opened remotely - Windows CMD - SS64.com

PsGetSid ([SysInternals](https://docs.microsoft.com/en-gb/sysinternals/downloads/sysinternals-suite))
=====================================================================================================

Display the SID of a computer or a user.

Syntax

      psgetsid [\_computer_[,_computer_[,...] | @_get_file_] [-u _user_ [-p _passwd_]]] [_account_|_SID_]

Options:

    _computer_   The remote computer on which to list files. Default = local system 

    @_get_file_  Get the SID of every computer listed in the text file specified.
              
    -p _passwd_  Specify a password for _user_ (optional). Passed as clear text.
              If omitted, you will be prompted to enter a hidden password.

    -u _user_    Specify a username for login to remote computer(optional).

    _account_    The user account to resolve to a user SID

    _SID_        A User account **S**ystem **Id**entifier 

    -accepteula Suppress the display of the license dialog.

Specify a _user_ name if the account you are running from doesn’t have administrative privileges on the computer you want to query.

To retrieve a computer SID pass the computer's name.  
To retrieve a user account SID, pass the account name (e.g. "-u administrator") on the command-line, and optionally the computer name.

Obtaining the Users SID makes it possible to update specific user registry hives under HKey_Users

When installing psGetSid.exe just ensure it is placed somewhere in either the system [PATH](path.html) or in the [current](cd.html) directory.

When launched for the first time, PsGetSid will prompt you to accept the EULA.  
You can avoid this by writing the license registry key:  

Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Sysinternals' -Name 'EulaAccepted' -Value 1

### Examples

Get the SID of \workstation64:

psgetsid \workstation64

Get the computer SID for the computer at IP address 192.168.2.5

psgetsid \192.168.2.5

Get the domain SID for the domain ss64Dom:

psgetsid ss64Dom

Get the SID for the user CaraJ from workstation64:

psgetsid \workstation64 -u CaraJ

Get the SID for the currently logged-in user and place in a variable:

@Echo Off  
For /f "tokens=1 skip=1" %%G in ('psgetsid %username% -accepteula 2^>nul') do set _SID=%%G

“From the first time I saw Sid Caesar be funny I knew that's what I had to do” ~ Billy Crystal

### Related commands

[SYSTEMINFO](systeminfo.html) - List system configuration.  
[Q243330](https://support.microsoft.com/en-gb/help/243330/) - Well-known security identifiers (sids) in Windows operating systems.



/. nt/psinfo.html
========================================================

    PsInfo - List information about a system - Windows CMD - SS64.com

PsInfo ([SysInternals](https://docs.microsoft.com/en-gb/sysinternals/downloads/sysinternals-suite))
===================================================================================================

List information about a system including the type of installation, kernel build, registered organization, owner, processor details, physical memory and the system install date.

Syntax

      psinfo [\_computer_[,_computer_[,..]] [_options_] [_filter_]

      psinfo @_file_ [_options_] [_filter_]

Options:

    _computer_   The computer(s) on which psinfo will list information. Default=local system 
               
    @_file_      List info for every computer listed in the text file specified.

    -c         Print in CSV format.
    -c -t _d_    Print in CSV format, separate items with delimiter _d_.

    -h         Show list of installed hotfixes.

    -s         Show list of installed applications.

    -d         Show disk volume information: drive letter, format, capacity.

    -p _psswd_   Specify a password for _user_ (optional). Passed as clear text.
              If omitted, you will be prompted to enter a hidden password.

    -u _user_    Specify a user name for login to remote computer(optional).

    _filter_     Psinfo will only show data for the field matching the filter. 
               e.g. "psinfo service" lists only the service pack field.

    -accepteula Suppress the display of the license dialog.

PsInfo relies on remote Registry access to obtain its data, the remote system must be running the Remote Registry service and the account from which you run PsInfo must have access to the HKLM\System portion of the remote Registry.

In order to aid in automated Service Pack updates, PsInfo returns as a value the Service Pack number of system (e.g. 0 for no service pack, 1 for SP 1, etc).

When installing psifo.exe just ensure it is placed somewhere in either the system [PATH](path.html) or in the [current](cd.html) directory.

When launched for the first time, PsInfo will prompt you to accept the EULA.  
You can avoid this by writing the license registry key:  

Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Sysinternals' -Name 'EulaAccepted' -Value 1

### Examples

List disc information about \workstation64:

psinfo \workstation64 -d

psinfo -d | find "%"

_“If you hear that someone is speaking ill of you, instead of trying to defend yourself you should say: “He obviously does not know me very well, since there are so many other faults he could have mentioned” ~ Epictetus_

### Related commands

[PsGetSid](psgetsid.html) - Display the SID of a computer or a user  
[SYSTEMINFO](systeminfo.html) - List system configuration  
[FSUTIL fsinfo](fsutil.html) - File and Volume specific commands  
Equivalent bash command (Linux): [cat](../bash/cat.html) /proc/*



/. nt/pskill.html
========================================================

    PsKill - Kill processes by name or process ID - Windows CMD - SS64.com

PsKill ([SysInternals](https://docs.microsoft.com/en-gb/sysinternals/downloads/sysinternals-suite))
===================================================================================================

Kill processes by name or process ID.

Syntax

      pskill [- ] [-t] [\_computer_ [-u _user_] [-p _passwd_]] _process_name_ | _process_id_

Options:

    _computer_   The computer on which the process is running. Default=local system 

    -p _passwd_  Specify a password for _user_ (optional). Passed as clear text.
              If omitted, you will be prompted to enter a hidden password.

    -u _user_    Specify a user name for login to remote computer(optional).

    -t         Kill the process and its descendants.

    _process_id/name_
              The process or processes to be killed.

    -accepteula Suppress the display of the license dialog.

    -          Help, display the supported options.

To kill a process on a remote system requires administrative privileges on the remote system.

When installing pskill.exe just ensure it is placed somewhere in either the system [PATH](path.html) or in the [current](cd.html) directory.

When launched for the first time, PsKill will prompt you to accept the EULA.  
You can avoid this by writing the license registry key:  

Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Sysinternals' -Name 'EulaAccepted' -Value 1

### Examples

Kill all instances of notepad.exe running on \workstation64:

pskill \workstation64 notepad

_“Never trust a man who, when left alone with a tea cosy, doesn’t try it on” ~ Billy Connolly_

### Related commands

[TSKILL](tskill.html) - Kill process on a Terminal Server.  
[TASKKILL](taskkill.html) - End a running process.  
[ProcDump](procdump.html) - Monitor an application for CPU spikes.  
[PsList](pslist.html) - List detailed information about processes.  
The process button of Task Manager in Windows will also identify the process ID (PID.)  
[PsSuspend](pssuspend.html) - Suspend processes (so they can be continued at a later point in time.)  
Equivalent PowerShell: [Stop-Process](../ps/stop-process.html) - Stop a running process. (kill)  
Equivalent bash command (Linux): [kill](../bash/kill.html) - Stop a process from running.



/. nt/pslist.html
========================================================

    PsList - List detailed information about processes - Windows CMD - SS64.com

PsList ([SysInternals](https://docs.microsoft.com/en-gb/sysinternals/downloads/sysinternals-suite))
===================================================================================================

Process Status, list information about processes running in memory.

Syntax

      pslist [-?] [-t] [-m] [-x] [\computer [-u _user_] [-p _passwd_]] [_name_ | _pid_] 

Options:

    computer   The computer on which the process is running. Default=local system 

    -p _passwd_  Specify a password for _user_ (optional). Passed as clear text.
              If omitted, you will be prompted to enter a hidden password.

    -u _user_    Specify a user name for login to remote computer(optional).

    -t         Show statistics for all active threads on the system,
              each thread is grouped with its owning process.

    -m         Show memory-oriented information for each process, 
              rather than the default of CPU-oriented information.

    -x         Show CPU, memory and thread information for each process specified.

    _name_       Scan only those processes that begin with the _name_ process.
              Thus:
                pslist exp
              will display processes that start with exp... Explorer, Export etc

    -accepteula Suppress the display of the license dialog.

    -?         Display options and units of measurement.

The default information listed includes the time the process has executed, the amount of time the process has executed in kernel and user modes, and the amount of physical memory that the OS has assigned the process.

When running PsList against a remote system you must have administrative rights on that system, and the system must be running the Remote Registry [service](syntax-services.html).

When installing pslist.exe just ensure it is placed somewhere in either the system [PATH](path.html) or in the [current](cd.html) directory.

When launched for the first time, PsList will prompt you to accept the EULA.  
You can avoid this by writing the license registry key:  

Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Sysinternals' -Name 'EulaAccepted' -Value 1

### Examples

List all processes running on \workstation64:

C:> [SC](sc.html) \workstation64 start RemoteRegistry  
C:> pslist \workstation64

_“Here’s a rule I recommend. Never practice two vices at once” ~ Tallulah Bankhead_

### Related commands

[PsKill](pskill.html) - Kill processes by name or process ID.  
[OPENFILES](openfiles.html) - Query or display open files, disconnect files opened by network users.  
[ProcDump](procdump.html) - Monitor an application for CPU spikes.  
[TASKLIST](tasklist.html) - List running applications and services.  
[TLIST](tlist.html) Task list with full path.  
Windows Task Manager - List of running process IDs (PID)  
PerfMon - Monitoring tool.  
Equivalent PowerShell: [Get-Process](../ps/get-process.html) - Get a list of processes on a machine (ps/gps)  
Equivalent bash command (Linux): [ps](../bash/ps.html) - Process status, information about processes running in memory.



/. nt/psloggedon.html
========================================================

    PsLoggedOn - List detailed information about processes - Windows CMD - SS64.com

PsLoggedOn ([SysInternals](https://docs.microsoft.com/en-gb/sysinternals/downloads/sysinternals-suite))
=======================================================================================================

See who is logged onto a computer, either locally or remotely

Syntax

      psloggedon [- ] [-l] [-x] [\_computer_ | _username_]

Options:

    computer   The computer on which the process is running. Default=local system 

    -l         Show only local logons instead of both local and network resource logons.

    -x         Don’t show logon times.

    username   Search the network for computers to which that user is loggedon.

    -accepteula Suppress the display of the license dialog.

    -          Help, display all options and units of measurement used.

PsLoggedOn's definition of a locally logged on user is one that has their profile loaded into the Registry. If no one is currently logged on, PsLoggedOn will return the last logged on user.

Note that PsLoggedOn will show you as logged on via resource share to remote computers that you query because a logon is required for PsLoggedOn to access the Registry of a remote system.

When installing psloggedon.exe just ensure it is placed somewhere in either the system [PATH](path.html) or in the [current](cd.html) directory.

When launched for the first time, PsLoggedOn will create the regkey  
HKCU\Software\Sysinternals\PsLoggedOn\EulaAccepted=0x01

### Examples

List all processes running on \workstation64:

pslist \workstation64

[WhoIsLoggedOnWhere.cmd](psloggedon_example.html) - script to list all workstations

_“If you are coasting, it means you are going downhill” ~ C. P. Fulford Jr._

### Related commands

[NET SESSION](net-share.html) - List or disconnect user sessions (Local machine only)  
Equivalent PowerShell: [Get-CIMInstance](../ps/get-ciminstance.html) Win32_ComputerSystem (UserName)  
Equivalent bash command (Linux): [who](../bash/who.html) - Print who is currently logged in.



/. nt/psloglist.html
========================================================

    PsLogList - Event log records - Windows CMD - SS64.com

PsLogList ([SysInternals](https://docs.microsoft.com/en-gb/sysinternals/downloads/sysinternals-suite))
======================================================================================================

Event log records

Syntax

      psloglist [- ] [\_computer_[,_computer_[,...] | @_file_
         [-u _user_ [-p _passwd_]]] [-s [-t _delim_]]
            [-m #|-n #|-h #|-d #|-w]
               [-c][-x][-r][-a mm/dd/yy][-b mm/dd/yy]
                  [-f _filter_] [-i _ID_[,_ID_[,...] | -e ID[,ID[,...]]]
                     [-o _event source_[,_event source_][,..]]]
                        [-q _event source_[,_event source_][,..]]]
                           [-l [_event_log_file_] <_eventlog_>

Options:

    computer   The computer on which the log resides. Default=local system 

    -p _passwd_  Specify a password for _user_ (optional). Passed as clear text.
              If omitted, you will be prompted to enter a hidden password.

    -u _user_    Specify a user name for login to remote computer(optional).

    @file      Execute the command on each of the computers listed in the file.

    -a         Dump records timestamped after specified date.

    -b         Dump records timestamped before specified date.

    -c         Clear the event log after displaying.

    -d #       Only display records from previous # days.

    -e _ID_      Exclude events with the specified ID or IDs (up to 10).

    -f _filter_  Filter event types with filter string (e.g. "-f w" to filter warnings).

    -h #       Only display records from previous # hours.

    -i _ID_      Show only events with the specified _ID_ or _ID_s (up to 10).

    -l [_event_log_file_] <_eventlog_>  Dump records from the specified event log/file.

    -m #       Only display records from previous _#_ minutes.

    -n #       Only display # number of most recent entries.

    -o _event source_
              Show only records from the specified event source (e.g. \"-o cdrom\").

    -q _event source_
              Omit records from the specified event source or sources (e.g. \"-q cdrom\").

    -r         Dump log from least recent to most recent.

    -s         Print Event Log records one-per-line, with comma delimited fields.
              This format is convenient for text searches, e.g. psloglist | findstr /i text
              and for importing the output into a spreadsheet.

    -t _delim_   The default delimeter is a comma, but can be overriden with the specified character.

    -w         Wait for new events, dumping them as they generate (local system only).

    -x         Dump extended data.

    _eventlog_   application, system or security, only the first few letters need be used.
              default=system log.

    -accepteula Suppress the display of the license dialog.

If your current security credentials would not permit access to the Event Log, specify a different username ( -u user ).

When installing psLogList.exe just ensure it is placed somewhere in either the system [PATH](path.html) or in the [current](cd.html) directory.

When launched for the first time, PsLogList will create the regkey  
HKCU\Software\Sysinternals\PsLogList\EulaAccepted=0x01

### Examples

List everything in the application event log on \workstation64 from the last 24 hours:

psloglist \workstation64 -h 24 application

“Events, dear boy, events” ~ British Prime Minister Harold Macmillan (answer to 'what is the biggest problem in politics'?)

### Related commands

[WECUTIL](wecutil.html) - Windows Event Collector Utility.  
Equivalent bash command (Linux): Logs are in plain ascii text.



/. nt/pspasswd.html
========================================================

    PsPasswd - Change account password - Windows CMD - SS64.com

PsPasswd ([SysInternals](https://docs.microsoft.com/en-gb/sysinternals/downloads/sysinternals-suite))
=====================================================================================================

Change account password

Syntax

      pspasswd [[\_computer_[,_computer_[,..] | @_file_ 
         [-u _user_ [-p _passwd_]]] _Username_ [_NewPassword_]

Options:

    computer   The computer on which the user account resides. Default=local system 

    -p _passwd_  Specify a password for _user_ (optional). Passed as clear text.
              If omitted, you will be prompted to enter a hidden password.

    -u _user_    Specify a user name for login to remote computer(optional).

    @file      Execute the command on each of the computers listed in the file.

    Username   Name of account for password change.

  _NewPassword_  The new password, If ommitted a NULL password is applied.

    -accepteula Suppress the display of the license dialog.

This tool allows administrators to create a batch file that will run against multiple computers to perform a mass change of the administrator password.

When installing pspasswd.exe just ensure it is placed somewhere in either the system [PATH](path.html) or in the [current](cd.html) directory.

When launched for the first time, PsPasswd will create the regkey  
HKCU\Software\Sysinternals\PsPasswd\EulaAccepted=0x01

### Examples

Change the password for user JDoe on \workstation64

C:> pspasswd \workstation64 jdoe password567

_“Drunk with power isn’t the same as being drunk with booze” ~ [Craig Ferguson](https://twitter.com/#!/CraigyFerg)_

### Related commands

[NET USER](netuseroptions.html) /passwordchg - user account settings  
Equivalent bash command (Linux): [passwd](../bash/passwd.html) - Modify a user password  
[Password generator](/pass/)



/. nt/psping.html
========================================================

    PsPing - Windows CMD - SS64.com

PsPing ([SysInternals](https://docs.microsoft.com/en-gb/sysinternals/downloads/sysinternals-suite))
===================================================================================================

Measure network performance. In addition to standard ICMP ping functionality, PsPing can report the latency of connecting to TCP ports, the latency of TCP round-trip communication between systems, and the TCP bandwidth available to a connection between systems. Besides obtaining min, max, and average values in 0.01ms resolution, you can also use PsPing to generate histograms of the results that are easy to import into a spreadsheet.

Syntax (ICMP ping)
      psping [[-6]|[-4]] [-h [_buckets_]] [-i _interval_] [-l _requestsize_
        [-q] [-t|-n _count_] [-w _count_] _destination_

Key
    -h   Print histogram (default bucket count is 20).
    -i   Interval in seconds. Specify 0 for fast ping.
    -l   Request size.
    -n   Number of pings.
    -q   Don't output during pings.
    -t   Ping until stopped with Ctrl+C and type Ctrl+Break for statistics.
    -w   Warmup with the specified number of iterations (default is 1).
    -4   Force using IPv4.
    -6   Force using IPv6. For high-speed ping tests use -q and -i 0.
    -? I Usage for ICMP ping.

Syntax (TCP ping)
      psping [[-6]|[-4]] [-h [_buckets_]] [-i _interval_] [-l _requestsize_
         [-q] [-t|-n _count_] [-w _count_] _destination_:_destport_
Key
    -h   Print histogram (default bucket count is 20).
    -i   Interval in seconds. Specify 0 for fast ping.
    -l   Request size.
    -n   Number of pings.
    -q   Don't output during pings.
    -t   Ping until stopped with Ctrl+C and type Ctrl+Break for statistics.
    -w   Warmup with the specified number of iterations (default is 1).
    -4   Force using IPv4.
    -6   Force using IPv6. For high-speed ping tests use -q and -i 0.
    -? T Usage for TCP ping.

Syntax (TCP latency)
      server: psping [[-6]|[-4]] -s _source:sourceport_ client: psping
         [[-6]|[-4]] [-h [buckets]] [-r] -l _requestsize_]
            -n _count_ [-w _count_] _destination:destport_
Key
    -h   Print histogram (default bucket count is 20).
    -l   Request size.
    -n   Number of sends/receives.
    -r   Receive from the server instead of sending.
    -w   Warmup with the specified number of iterations (default is 5).
    -4   Force using IPv4.
    -6   Force using IPv6.
    -? L Usage for Latency test.
 The server can serve both latency and bandwidth tests and remains active until you terminate it with Control-C.

Syntax (TCP bandwidth)
      server: psping [[-6]|[-4]] -s _source:sourceport_ client: psping
         [[-6]|[-4]] -b [-h [_buckets_]] [-r] -l _requestsize_ -n _count_ 
            [-i _outstanding_] [-w _count_] _destination:destport_
Key
    -b   Bandwidth test.
    -h   Print histogram (default bucket count is 20).
    -i   Number of outstanding I/Os (default is min of 16 and 2x CPU cores).
    -l   Request size.
    -n   Number of sends/receives.
    -r   Receive from the server instead of sending.
    -w   Warmup for the specified iterations (default is 2x CPU cores).
    -4   Force using IPv4.
    -6   Force using IPv6.
    -? B Usage for Bandwidth test.
 The server can serve both latency and bandwidth tests and remains active until you terminate it with Control-C.

    -accepteula Suppress the display of the license dialog.

When installing psping.exe just ensure it is placed somewhere in either the system [PATH](path.html) or in the [current](cd.html) directory.

Typing "psping" will display help.

When launched for the first time, PsPing will create the regkey  
HKCU\Software\Sysinternals\PsPing\EulaAccepted=0x01

### Examples

Execute an ICMP ping test for 10 iterations with 3 warmup iterations:

psping -n 10 -w 3 workstation64

To execute a TCP connect test, specify the port number. The following command executes connect attempts against the target as quickly as possible, only printing a summary when finished with the 100 iterations and 1 warmup iteration:

psping -n 100 -i 0 -q workstation64:80

To configure a server for latency and bandwidth tests, specify the -s option and the source address and port the server will bind to:

psping -s 10.5.2.2:5000

A buffer size is required to perform a TCP latency test. This example measures the round trip latency of sending an 8KB packet to the target server, printing a histogram with 100 buckets when completed:

psping -l 8192 -n 10000 -h 100 192.168.2.2:5000

This is the same command except with a -b option, which executed against the same server performs a bandwidth test. Note that the test must run for at least one second after warmup for a histogram to generate:

psping -b -l 8192 -n 10000 -h 100 192.168.2.2:5000

_“You may poke a man's fire after you've known him for seven years” ~ English Proverb_

### Related commands

[TRACERT](tracert.html) - Trace route to a remote host.  
[IPCONFIG](ipconfig.html) - IP Configuration.  
[PATHPING](pathping.html) - Trace route and provide network latency and packet loss for each router and link in the path.  
Equivalent PowerShell: [Test-Connection](../ps/test-connection.html) - Ping one or more computers, [psp](../ps/syntax-ping.html) function.  
Equivalent bash command (Linux): ping - Test a network connection.



/. nt/psservice.html
========================================================

    PsService - View and control services - Windows CMD - SS64.com

PsService ([SysInternals](https://docs.microsoft.com/en-gb/sysinternals/downloads/sysinternals-suite))
======================================================================================================

View and control services.

Syntax

      psservice [\computer [-u _user_] [-p _passwd_]] <_command_> <_options_>

Options:

    computer   The computer on which the service is running. Default=local system 

    -p _passwd_  Specify a password for _user_ (optional). Passed as clear text.
              If omitted, you will be prompted to enter a hidden password.

    -u _user_    Specify a user name for login to remote computer(optional).

    commands:
      query      Display the status of a service
      config     Display the configuration of a service
      setconfig  Set the start type (disabled, auto, demand) of a service.
      start      Start a service
      stop       Stop a service
      restart    Stop and then restart a service
      pause      Pause a service
      cont       Resume a paused service
      depend     List the services dependent on the one specified
      security   Dump the service's security descriptor
      find       Search the network for the specified service

    -accepteula Suppress the display of the license dialog.

Typing a command followed by "- " displays the syntax for that command.

Service States:

1 - Stopped  
2 - Start Pending  
3 - Stop Pending  
4 - Running

When installing psService.exe just ensure it is placed somewhere in either the system [PATH](path.html) or in the [current](cd.html) directory.

When launched for the first time, PsService will create the regkey  
HKCU\Software\Sysinternals\PsService\EulaAccepted=0x01

### Examples

Restart the spooler service on \server64

C:> psservice \server64 restart spooler

_“The highest reward for a person’s toil is not what they get for it but what they become by it” ~ John Ruskin_

### Related commands

[NET START/STOP](net-service.html) - Start/Stop services.  
[SC](sc.html) - Service control.  
Equivalent PowerShell: [Get-Service](../ps/get-service.html) - Get a list of services.



/. nt/psshutdown.html
========================================================

    PsShutdown - Shutdown or reboot a computer - Windows CMD - SS64.com

PsShutdown ([SysInternals](https://docs.microsoft.com/en-gb/sysinternals/downloads/sysinternals-suite))
=======================================================================================================

Initiate a shutdown/reboot of a local or remote computer, logoff a user, lock a system.

Syntax

      psshutdown [[\_computer_[,_computer_[,..]]] | @_file_ [-u _user_ [-p _passwd_]]]
         -s|-r|-h|-d|-k|-a|-l|-o 
            [-f] [-c] [-t _nn_|_h:m_] [-n _s_] [-v _nn_]
               [-e [u|p]:_xx:yy_] [-m "message"]

Options:

    computer   The computer on which the user account resides. Default=local system 
              a wildcard (\*), will affect all computers in the current domain.

    -p _passwd_  Specify a password for _user_ (optional). Passed as clear text.
              If omitted, you will be prompted to enter a hidden password.

    -u _user_    Specify a user name for login to remote computer(optional).

    @_file_      Execute the command on each of the computers listed in the _file_.

    -a         Cancel a shutdown (only possible while a countdown is in progress).

    -c         Allow the shutdown to be cancelled by the interactive user.

    -d         Suspend the computer.

  -e [u|p]:_xx:yy_ 
              Shutdown reason code, 'u' = user, 'p'= planned shutdown.
              xx is the major reason code (must be less than 256)
              yy is the minor reason code (must be less than 65536)

    -f         Force all running applications to exit during the shutdown
              instead of giving them a chance to gracefully save their data.

    -h         Hibernate the computer.

    -k         Poweroff the computer (reboot if poweroff is not supported).

    -l         Lock the computer
              On Vista and greater this requires the username and password of the account to lock
              Even with a password, the default permissions do not allow the screen to be locked.

  -m "_message_" DIsaply a message to logged-on users when a shutdown countdown commences.

    -n         Timeout in seconds connecting to remote computers.

    -o         Logoff the console user.

    -r         Reboot after shutdown.

    -s         Shutdown without poweroff.

    -t         Countdown in seconds until the shutdown (default: 20 seconds)
              or the time of shutdown (in 24 hour notation).

    -v         Display message for the specified number of seconds before the shutdown. 
              default= display a shutdown notification dialog,
              specifying a value of 0 results in no dialog.

    -accepteula Suppress the display of the license dialog.

    -          Help, display the supported options.

This tool allows administrators to create a batch file that will run against multiple computers to perform a mass change of the administrator password.

PsShutdown has two features not found in the [SHUTDOWN](shutdown.html) command:

*   It will (by default) force the shutdown/restart of remote PCs so an interactive user cannot cancel the shutdown.
*   Multiple remote PCs can be targeted at once ().

When installing psShutdown.exe just ensure it is placed somewhere in either the system [PATH](path.html) or in the [current](cd.html) directory.

When launched for the first time, PsShutdown will create the regkey  
HKCU\Software\Sysinternals\PsFile\EulaAccepted=0x01

### Examples

Reboot \workstation64 as part of an OS upgrade:

psshutdown \workstation64 -r -e p:2:3

Shutdown all the computers listed in a file (one per line):

psshutdown @c:\scripts\computers.txt -s

“I shall go the way of the open sea, To the lands I knew before you came,  
And the cool ocean breezes shall blow from me, The memory of your name” ~ Laurence Hope

### Related commands

[SHUTDOWN](shutdown.html) - With full list of reason codes.  
PowerShell: [Stop-Computer](../ps/stop-computer.html) / [Restart-Computer](../ps/restart-computer.html)  
Equivalent bash command (Linux): [shutdown](../bash/shutdown.html) - Shutdown or restart linux.



/. nt/pssuspend.html
========================================================

    PsSuspend - Suspend processes on the local or a remote system - Windows CMD - SS64.com

PsSuspend ([SysInternals](https://docs.microsoft.com/en-gb/sysinternals/downloads/sysinternals-suite))
======================================================================================================

Suspend processes on the local or a remote system.

Syntax

      pssuspend [- ] [-r] [\_computer_ [-u _user_] [-p _passwd_]] <_process name_ | _process id_>

Options:

    _computer_   The computer on which the service resides. Default=local system 

    -p _passwd_  Specify a password for _user_ (optional). Passed as clear text.
              If omitted, you will be prompted to enter a hidden password.

    -u _user_    Specify a user name for login to remote computer(optional).

    -r         Resume the processes specified if they are suspended.

    _process id/name_
              The process or processes to suspend or resume.

    -accepteula Suppress the display of the license dialog.

    -          Help, display the supported options.

Suspend is desirable in cases where a process is consuming a resource (e.g. network, CPU or disk) that you want to allow different processes to use. Rather than kill the process that's consuming the resource, suspending permits you to let it continue operation at some later point in time.

When installing psSuspend.exe just ensure it is placed somewhere in either the system [PATH](path.html) or in the [current](cd.html) directory.

When launched for the first time, PsSuspend will create the regkey  
HKCU\Software\Sysinternals\PsSuspend\EulaAccepted=0x01

### Examples

Suspend the notepad process on \workstation64

pssuspend \workstation64 notepad

“Gentlemen you can’t fight in here - this is the war room” ~ President Muffley (Dr. Strangelove)

### Related commands

[PsKill](pskill.html) - Kill processes by name or process ID.



/. nt/pushd.html
========================================================

    Pushd - Change directory/folder - Windows CMD - SS64.com

PUSHD
=====

Change the current directory/folder and store the previous folder/path for use by the [POPD](popd.html) command.

Syntax

      PUSHD [_drive_]_path_

      PUSHD

Key
    drive  The drive to switch to.
    _path_   The folder to make 'current' (UNC names accepted).

If the drive is not specified, the current drive will be assumed.  
If neither drive nor path are specified PUSHD will just display a list of previous pathnames, you can switch back to any of these by using [POPD](popd.html) one or more times.  
The number of pushed directories can be displayed on the command line with [PROMPT $+](prompt.html)  
If the path specified is a file not a folder, or if it does not exist, PUSHD will return %errorlevel% =1

Batch files
-----------

> When PUSHD is used in a batch script it is strongly recommended that you check the [%errorlevel%](errorlevel.html) to be sure that the directory exists and was successfully connected before continuing:
> 
> PUSHD \install_server\wsus_share  
> :: If this fails then exit  
> If %errorlevel% NEQ 0 goto:eof  
> :: other commands...
> 
> :: or in one line:
> PUSHD "%~1" 2>nul [&&](syntax-redirection.html) goto sub-error-failed

Run as Admin
------------

> When a batch script is '[Run as Admin](syntax-elevate.html)', the current directory will be set to C:\windows\system32\.  
> Using the following pushd command at the start of the script will restore the normal current directory.
> 
> This works by setting the current directory to the location of the batch script, using the %0 [parameter](syntax-args.html)  
>   
> pushd "%~dp0"

UNC Network paths
-----------------

> When a UNC path is specified, PUSHD will create a temporary drive map and will then use that new drive.  
> The temporary drive letters are allocated in reverse alphabetical order, so if Z: is free it will be used first.

Errorlevels
-----------

> If the Current directory was changed: [%ERRORLEVEL%](errorlevel.html) = 0  
> If the Directory does not exist or is not accessible or if a bad switch given: [%ERRORLEVEL%](errorlevel.html) = 1

### Examples

C:\demo> pushd \work 
C:\work> echo %errorlevel%
0
C:\work> popd  
C:\demo> pushd "F:\monthly reports"
F:\monthly reports> popd  
C:\demo>

C:> pushd "C:\demo\demo.1" 2>nul [||](syntax-redirection.html) Echo Error not a folder

PUSHD is an [internal](syntax-internal.html) command. If [Command Extensions](cmd.html) are disabled the PUSHD command will no longer map temporary drives to UNC paths, and POPD will not delete such drives.

_#Ah, push it - push it good  
Ah, push it - p-push it real good# ~ Salt 'N' Pepa_

### Related commands

[CD](cd.html) - Change directory.  
[CMD](cmd.html) - UNC options.  
[PROMPT](prompt.html) - Display the level of the PUSHD stack ($+).  
Equivalent PowerShell: [Push-Location](../ps/push-location.html) - Push a location to the stack (pushd).  
Equivalent PowerShell: [cd -](../ps/syntax-cd.html) Jump to the previous working directory.  
Equivalent bash command (Linux): [pushd](../bash/pushd.html) - Save and then change the current directory.



/. nt/query-process.html
========================================================

    Query Process - Windows CMD - SS64.com

Query Process / QPROCESS
========================

Display information about processes.

Syntax

      QUERY PROCESS * [/server:_ServerName_]

      QUERY PROCESS _ProgramName_ [/server:_ServerName_]

      QUERY PROCESS _ProcessID_ [/server:_ServerName_]

      QUERY PROCESS _SessionName_ [/server:_ServerName_]

      QUERY PROCESS /id:_nn_ [/server:_ServerName_]

Key
    *           List the processes for all sessions.

    ProcessID   The numeric ID identifying the process that you want to query.

    UserName    The name of the user whose processes you want to list.

    _SessionName_ The name of the session whose processes you want to list.

    /id:_nn_      The ID of the session whose processes you want to list.

    _ProgramName_ The name of the program whose processes you want to query.
               The .exe extension is required.

    /server:_ServerName
              _ The Remote Desktop Session Host server whose processes
               you want to list.
               default = server where you are currently logged on.

    /?          Display help.

QPROCESS is a synonym for QUERY PROCESS.

QUERY PROCESS returns the following information:

*   The user who owns the process
*   The session that owns the process
*   The ID of the session
*   The name of the process - only the first 12 letters.
*   The ID of the process

If you do not specify a process with _UserName_, _SessionName_, or _SessionID_, then QUERY PROCESS will return only the processes that belong to the current user. When information for multiple processes is returned, a greater than > symbol is displayed before each process that belongs to the current session.

Administrators have full access to all query process functions.

### Examples

Display information about the processes being used by all sessions:

C:> query process *

Display information about the processes being used by session ID 2:

C:> query process /ID:2

_“Oh, what's going on, What's going on, Ya, what's going on, Ah, what's going on” - Marvin Gaye (What's Going On Lyrics)_

### Related commands

[TASKLIST](tasklist.html) - List running applications and services.  
[Query Session](query-session.html) - Display all sessions (TS/Remote Desktop).  
[Query TermServer](query-termserver.html) - List all servers (TS/Remote Desktop).  
[Query User](query-user.html) - Display user sessions (TS/Remote Desktop).  
[PsList](pslist.html) - List detailed information about processes.  
[CHANGE](change.html) - Change Terminal Server Session properties.  
[MSTSC](mstsc.html) - Terminal Server Connection (Remote Desktop Protocol).



/. nt/query-session.html
========================================================

    Query Session / Qwinsta - Windows CMD - SS64.com

Query Session / Qwinsta.exe
===========================

Display information about user sessions on a Terminal server or a Remote Desktop Session Host (RD Session Host) server.

Syntax

      QUERY SESSION [/server:_ServerName_]
         [/mode] [/flow] [/connect] [/counter]

      QUERY SESSION _UserName_ [/server:_ServerName_]
         [/mode] [/flow] [/connect] [/counter]

      QUERY SESSION [_SessionName_ | _SessionID_] [/server:_ServerName_]
         [/mode] [/flow] [/connect] [/counter]

Key
    _UserName_    The logon username of the user whose sessions you want to query.

    _SessionName_ The name of the session that you want to query.

    _SessionID_   The ID of the session that you want to query.

    /server:_ServerName_
               The Remote Desktop Session Host server to query.
               The default is the current server.

    /mode       Display current line settings.

    /flow       Display current flow-control settings.

    /connect    Display current connect settings.

    /counter    Display current counter information, including the
               total number of sessions created, disconnected, and reconnected.

    /?          Display help.

QUERY SESSION is a synonym for Qwinsta.exe.

Available to 64 bit sessions only, there are no 32 bit implementations of Qwinsta.exe (QUERY SESSION).

A user can always query the session to which the user is currently logged on. To query other sessions, the user must have _Query Information_ special access permission.

If you do not specify a session by using _SessionName_, _UserName_, or _SessionID_, information about all active sessions in the system will be displayed.

When QUERY SESSION returns information, a greater than (>) symbol is displayed before the current session.  
Sample output:

C:>query session
  SESSIONNAME USERNAME       ID STATE  TYPE    DEVICE
 >console     Administrator1 0  active wdcon
  rdp-tcp#1   User1          **1  active** wdtshare
  rdp-tcp                    2  listen wdtshare
                             4  idle
                             5  idle

> SESSIONNAME The name assigned to the session.  
> USERNAME The user name of the user connected to the session.  
> ID The session ID  
> STATE provides information about the current state of the session.  
> TYPE indicates the session type.  
> DEVICE, which is not present for the console or network-connected sessions, is the device name assigned to the session.

Either the SessionName or the ID can be used by the [Reset Session](reset-session.html) and [LOGOFF](logoff.html) commands respectfully to disconnect or logoff that session from the server.

The comment following session information is from the session profile. Any sessions in which the initial state is configured as DISABLED do not show up in the query session list until they are enabled.

The User Access permission type grants the following special permissions: Query Information, Logon, and Connect. These special permissions allow a user to: Log on to a session on the terminal server. Query information about a session. Send messages to other user sessions. Connect to another session.

Permissions are set under:

Terminal Services Configuration ➞ Connections ➞ Properties ➞ Permissions ➞ Advanced ➞ Permissions

### Examples

Display information about all active sessions on server64:

C:> query session /server:Server64

Display information about active session MODEM02:

C:> query session MODEM02

_“Once men are caught up in an event, they cease to be afraid. Only the unknown frightens men” - Antoine de Saint-Exupery_

### Related commands

[Get-CimInstance](../ps/get-ciminstance.html) Win32_LoggedOnUser - Similar to Query Session, but includes stale data (disconnected sessions).  
[Query Process](query-process.html) - Display processes (TS/Remote Desktop).  
[Query TermServer](query-termserver.html) - List all servers (TS/Remote Desktop).  
[Query User](query-user.html) - Display user sessions (TS/Remote Desktop).  
[Reset Session](reset-session.html) - Delete a Remote Desktop Session.  
[Get-WTSSessionInformation](https://twitter.com/guyrleech/status/1354812255393595399) - PowerShell script from Guy Leech to return detailed user session information (RDS & Citrix).  
[LOGOFF](logoff.html) - Log a user off.  
[CHANGE](change.html) - Change Terminal Server Session properties.  
[MSTSC](mstsc.html) - Terminal Server Connection (Remote Desktop Protocol).



/. nt/query-termserver.html
========================================================

    Query Termserver - Windows CMD - SS64.com

Query Termserver / Qappsrv
==========================

Display a list of all Terminal server or a Remote Desktop Session Host (RD Session Host) servers on the network.

Syntax

      QUERY TERMSERVER [_ServerName_] [/domain:_Domain_] [/address] [/continue]

Key
    _ServerName_     The RD Session Host server name.

    /domain:_Domain_ The domain to query for terminal servers.
                  default = current domain.

    /address       Display the network and node addresses for each server.

    /continue      Don't pause after each screen of information is displayed.

    /?             Display help.

Qappsrv is a synonym for QUERY TERMSERVER

QUERY TERMSERVER returns the following information:

*   The name of the server
*   The network (and node address if the /address option is used)

### Examples

Display information about all RD Session Host servers on the network:

C:> query termserver

Display information about the RD Session Host server named Server64:

C:> query termserver Server64

Display the network and node address for the RD Session Host server named Server64:

C:> query termserver Server64 /address

“Big machines are the awe-inspiring cathedrals of the 20th century” - Daniel Kleppner

### Related commands

[Query Process](query-process.html) - Display processes (TS/Remote Desktop).  
[Query Session](query-session.html) - Display all sessions (TS/Remote Desktop).  
[Query User](query-user.html) - Display user sessions (TS/Remote Desktop).  
[CHANGE](change.html) - Change Terminal Server Session properties.  
[MSTSC](mstsc.html) - Terminal Server Connection (Remote Desktop Protocol).



/. nt/query-user.html
========================================================

    Query User - Windows CMD - SS64.com

Query User / QUSER.exe
======================

Display information about user sessions on a Terminal server or a Remote Desktop Session Host (RD Session Host) server.

Syntax

      QUERY USER [/server:_ServerName_]

      QUERY USER _UserName_ [/server:_ServerName_]

      QUERY USER [_SessionName_ | _SessionID_] [/server:_ServerName_]

Key
    _UserName_    The logon username of the user whose sessions you want to query.

    _SessionName_ The name of the session that you want to query.

    _SessionID_   The ID of the session that you want to query.

    /server:_ServerName_
               The Remote Desktop Session Host server to query.
               The default is the current server.

    /?          Display help.

QUERY USER is a synonym for QUSER.exe

Available to 64 bit sessions only, there are no 32 bit implementations of QUSER.exe (QUERY USER).

Query User returns the following information:

*   The name of the user
*   The name of the session on the RD Session Host server
*   The session ID
*   The state of the session (active or disconnected)
*   The idle time (the number of minutes since the last keystroke or mouse movement at the session)
*   The date and time the user logged on

If you do not specify a user by using _UserName_, _SessionName_, or _SessionID_, a list of all users who are logged on to the server is returned. Alternatively, use [query session](query-session.html) to display a list of all sessions on the server. When information for multiple users is returned, a greater than > symbol is displayed before the current session.

A user can always query the session to which the user is currently logged on. To query other sessions, the user must have Query Information special access permission.

The User Access permission type grants the following special permissions: Query Information, Logon, and Connect. These special permissions allow a user to: Log on to a session on the terminal server. Query information about a session. Send messages to other user sessions. Connect to another session.

Permissions are set under:

Terminal Services Configuration ➞ Connections ➞ Properties ➞ Permissions ➞ Advanced ➞ Permissions

PowerShell
----------

> When running quser under PowerShell it is useful to split the output into rich objects, this can be done with a regex and [ConvertFrom-Csv](../ps/convertfrom-csv.html):
> 
> (quser) -replace '\s{2,}', ',' | ConvertFrom-Csv  
>   
> Alternatively the script [Get-LoggedOnUser.ps1](https://web.archive.org/web/20210118231433/https://gallery.technet.microsoft.com/scriptcenter/Get-LoggedOnUser-Gathers-7cbe93ea) will also show disconnected sessions.

### Examples

Display information about all users logged on the system:

C:> query user

Display information about the user ursula on server64:

C:> quser ursula /server:Server64

“The crowds in the big towns, with their mild, knobby faces, their bad teeth and gentle manners solid breakfasts and gloomy Sundays, smoky towns and winding roads, green fields and red pillar boxes” - George Orwell

### Related commands

[Query Process](query-process.html) - Display processes (TS/Remote Desktop).  
[Query Session](query-session.html) - Display all sessions (TS/Remote Desktop).  
[Query TermServer](query-termserver.html) - List all servers (TS/Remote Desktop).  
[Reset Session](reset-session.html) - Delete a Remote Desktop Session.  
[LOGOFF](logoff.html) - Log a user off.  
[CHANGE](change.html) - Change Terminal Server Session properties.  
[MSTSC](mstsc.html) - Terminal Server Connection (Remote Desktop Protocol).



/. nt/rasdial.html
========================================================

    Rasdial - Dial Up Networking - Windows CMD - SS64.com

RASDIAL (Dial Up Networking)
============================

Manage RAS/DUN connections.

Dial a RAS connection:

    RASDIAL _entryname_ [/PHONEBOOK:_PhonebookFile_]
                [/PHONE:_PhoneNumber_] [_username_ [_password_|*]] 
                [/CALLBACK:_CallBackNumber_]
                [/DOMAIN:_domain_][/PREFIXSUFFIX]

Hang up a RAS connection:
    RASDIAL [_entryname_] /DISCONNECT

Display RAS Status:
    RASDIAL

To use this command requires that Dial Up Networking Service be installed (via Control Panel - Networking)  
  
The default location for PhoneBook entries is \%SystemRoot%\system32\ras\

_"If advanced switching technology had not been developed and the telephone still had one operator for every 120 of some 100 million telephones, it would take 2,400,000 telephone operators (on three shifts) ~ John R. Pierce_  

### Related commands

[RASPHONE](rasphone.html) - Manage RAS connections.



/. nt/rasphone.html
========================================================

    Rasphone - Dial up Networking (RAS) - Windows CMD - SS64.com

RASPHONE (Dial Up Networking)
=============================

Manage Remote Access Service (RAS) connections.  
This is a part of the Dial-Up Networking service, typically used to connect a PC to an Internet Service Provider.

Dial a RAS connection:
    RASPHONE [-v] -f _PhoneBook_file_ -d "_PhoneBook_entry_" 

Hang up a RAS connection:
    RASPHONE [-v] -f _PhoneBook_file_ -h "_PhoneBook_entry_" 

Display RAS Status dialogue box
    RASPHONE -S

Other RAS options:
    RASPHONE [-v] -f _PhoneBook_file_ _options_ "_PhoneBook_entry_"

OPTIONS
    -a   : Add new PhoneBook entry
    -e   : Edit an existing PhoneBook entry
    -c   : Clone an existing PhoneBook entry
    -r   : Delete/remove an existing PhoneBook entry
    -v   : Disable - 'grey out' the option to rename the PhoneBook_entry

To use this command requires that Dial Up Networking Service be nstalled (via Control Panel - Networking)  
  
The default location for PhoneBook entries is %SystemRoot%\System32\ras\

"Someone invented the telephone, And interrupted a nation's slumber, Ringing wrong but similar numbers" ~ Ogden Nash

### Related commands

[RASDIAL](rasdial.html) - Manage RAS connections.



/. nt/rd.html
========================================================

    RD - Remove Directory - Windows CMD - SS64.com

RD
==

Remove (or Delete) a Directory.

Syntax

      RD _[pathname](path.html#pathname)_
      RD /S _[pathname](path.html#pathname)_
      RD /S /Q _[pathname](path.html#pathname)_
   
Key
    /S  : Delete all files and subfolders
         in addition to the folder itself.
         Use this to remove an entire folder tree.

    /Q  : Quiet - do not display Y/N confirmation

Place any long pathnames in double quotes.

Without the /S option, RD will only delete an empty directory and RD /Q will _silently_ fail to delete any directories that are not empty.  
If the pathname is a [Junction Point](mklink.html), then RD without /S will remove the Junction point itself, not the Junction’s destination directory.

RD does not support [wildcards](syntax-wildcards.html) but you can remove multiple directories in one command:  
  
C:> RD C:\docs\Jan "C:\My Documents\Mar"

Delete a directory with a trailing space
----------------------------------------

> If you try to delete a directory which has a trailing space, WIndows explorer will give the error: “Could Not Find This Item”.  
> Escaping the closing quote seems to bypass the normal logic of trimming trailing spaces and allows you to delete the folder:
> 
> C:> RD "this has a trailing space \"

Exit code / Errorlevel
----------------------

> In normal use RD will [fail](https://stackoverflow.com/questions/11137702/batch-exit-code-for-rd-is-0-on-error-as-well) to return an [ERRORLEVEL](errorlevel.html) to the shell, irrespective if the command succeeds or fails the ERRORLEVEL will be left unchanged.
> 
> It will however set an Exit Code
> 
> > Directory deleted successfully = 0  
> > Invalid option = 1  
> > Directory not found = 2  
> > Access denied = 5  
> > Directory in use = 32  
> > Directory not empty = 145
> 
> A workaround to detect a non zero Exit Code from RD is to use [conditional execution](syntax-conditional.html) to run a command if the RD fails, the second command can be anything, but typically will be an Echo, Goto or CALL statement:
> 
> RD NonExistentFolder || Echo This failed!  

If you delete directories using PowerShell then a True/False return code ($?) will be set correctly.

RMDIR is a synonym for RD

RD is an [internal](syntax-internal.html) command.

### Examples

Remove 'C:\demo documents\work' and all files and sub folders:

C:> RD /S "C:\demo documents\work"

Remove 'C:\source_files' but only if it is already empty:

C:> RD "C:\source_files"  

“Dying is the most embarrassing thing that can happen to you, because someones got to take care of all your details” - Andy Warhol

### Related commands

[CIPHER /w](cipher.html) - Overwrite data in a directory (secure delete).  
[MD](md.html) - Create Directory.  
[CD](cd.html) - Change Directory.  
[DEL](del.html) - Delete selected files from an entire folder tree.  
[DELTREE](deltree.html) - Script to Delete a folder and all subfolders/files.  
[Delete only empty folders](https://ss64.org/viewtopic.php?f=2&t=37) and log results.  
[FSUTIL](fsutil.html) reparsepoint delete - Delete an NTFS reparse point.  
[INUSE](inuse.html) - updated file replacement utility (may not preserve file permissions).  
Equivalent PowerShell: [Remove-Item](../ps/remove-item.html) - Remove an item (rd/ri/rmdir).  
Equivalent bash command (Linux): [rmdir](../bash/rmdir.html) - Remove folder(s) [rm -rf](../bash/rm.html) - Delete directory recursively.



/. nt/recover.html
========================================================

    Recover - Restore damaged data - Windows CMD - SS64.com

RECOVER
=======

Recover a damaged file from a defective disk.

Syntax

      RECOVER [_drive_:][_path_]_filename_

You must specify a _filename_.

Recover is designed to help in the case of hardware failure. When a drive fails the failure is not always total, you can often read some files but not others, and some files will be only partly readable.  
  
The data on a disk is stored in tracks and sectors in an almost random manner.  
  
RECOVER reads a file sector by sector and recovers data from the good sectors, data stored in a bad sectors cannot be read so this will often result in a partial recovery with some data loss. Restoring a backup is almost always a better option.  
  
Recover does not allow you to undelete a file.

“Whom the gods love dies young” ~ Menander 300 BC  

### Related commands

[CHKDSK](chkdsk.html) - Check Disk - check and repair disk problems.  
Equivalent bash command (Linux): [cksum](../bash/cksum.html) - Print CRC checksum and byte counts (can detect problems but not fix them).



/. nt/reg.html
========================================================

    Reg - Edit Registry - Windows CMD - SS64.com

REG.exe
=======

Read, Set or Delete registry keys and values, save and restore from a .REG file.

Syntax:

    REG QUERY [_ROOT_\]_RegKey_ **/V** _ValueName_ [/s] **[**/F _Data_ [/K] [/D] [/C] [/E]**]
     ** [/T _DataType_] [/Z] [/SE _Separator_] [/reg:32 | /reg:64]

    REG QUERY [_ROOT_\]_RegKey_ **/VE**  **[**/f _Data_ [/K] [/D] [/C] [/E]**]**    -- /VE returns the (default) value
      [/T _DataType_] [/Z] [/SE _Separator_] [/reg:32 | /reg:64]      
   
    REG ADD [_ROOT_\]_RegKey_ **/V** _ValueName_ [/T _DataType_] [/S _Separator_] [/D _Data_] [/F] [/reg:32] [/reg:64]
    REG ADD [_ROOT_\]_RegKey_ **/VE** [/d _Data_] [/F] [/reg:32 | /reg:64]

    REG DELETE [_ROOT_\]_RegKey_ **/V** _ValueName_ [/F]
    REG DELETE [_ROOT_\]_RegKey_ **/VE** [/F]      -- Remove the (default) value
    REG DELETE [_ROOT_\]_RegKey_ **/VA** [/F]      -- Delete all values under this key

    REG COPY  [\_SourceMachine_][_ROOT_\]_RegKey_ [\_DestMachine_][ROOT\]_RegKey_

    REG EXPORT _[ROOT\]RegKey FileName_.reg [/Y] [/reg:32 | /reg:64]
    REG IMPORT _FileName_.reg  [/reg:32 | /reg:64]
    REG SAVE [_ROOT_\]_RegKey FileName_.hiv [/Y] [/reg:32 | /reg:64]
    REG RESTORE _\MachineName_[_ROOT_]_KeyName FileName_.hiv [/reg:32 | /reg:64]
   
    REG LOAD _KeyName_ _FileName_ [/reg:32 | /reg:64]
    REG UNLOAD _KeyName_
   
    REG COMPARE [_ROOT_\]_RegKey_ [_ROOT_\]_RegKey_ [**/V** _ValueName_] [_Output_] [/s] [/reg:32 | /reg:64]
    REG COMPARE [_ROOT_\]_RegKey_ [_ROOT_\]_RegKey_ [**/VE**] [Output] [/s] [/reg:32 | /reg:64]

Key:
    _ROOT_ :
         HKLM = HKey_Local_machine (default)
         HKCU = HKey_current_user
         HKU  = HKey_users
         HKCR = HKey_classes_root

    _ValueName_ : The value, under the selected RegKey, to edit.
               (default is all keys and values)

    /C        : Case sensitive search.

    /D _Data_   : The actual data to store as a "String", integer etc

    /E        : Return only exact matches, by refault all are returned.

    /F        : Add/Delete - Force an update without prompting "Value exists, overwrite Y/N"
                    Query - Specify the data/pattern to search for, default = "*"
                            Use double quotes if the string contains spaces.

    /K        : Search in Key names only.

    \_Machine_ : Name of remote machine - omitting defaults to current machine.
               Only HKLM and HKU are available on remote machines.

    _FileName_  : The filename to save or restore a registry hive.

    _KeyName_   : A key name to load a hive file into. (Creating a new key)

    _RegKey_    : A Registry key. String name.
               These are case sensitive when creating and case-insensitive when reading.

    /S        : Query all subkeys and values.
    /S _Separator_  : Character to use as the separator in REG_MULTI_SZ values, the default is "\0"
    /SE _Separator_ : Character to use as the separator in REG_MULTI_SZ values, the default is "\0"

    /T _DataType_  : [REG_SZ (default) | REG_DWORD | REG_EXPAND_SZ | REG_MULTI_SZ](reg-types.html)
                  Click for full list, default = all types.

    /reg:32   : Force REG.exe to read/write to the 32-bit registry location.
    /reg:64   : Force REG.exe to read/write to the 64-bit registry location.

             By default a 32-bit process (such as an SCCM client or a 32 bit MSI installer)
             on a 64 bit machine, will use a 32-bit view of the registry: HKLM\SOFTWARE\Wow6432Node
             Use the /REG switch to over-ride this. See [Q305097](https://support.microsoft.com/en-gb/help/305097/) for more details.

    _Output_    : /od (only differences) /os (only matches) /oa (all) /on (no output)

    /V        : Query for a specific registry key value, if omitted all values for the key are queried.

    /VE       : Compare or SET the empty value name (default)

    /Y        : Force overwriting the existing file without prompt.

    /Z        : Verbose - shows the numeric equivalent for the type of the _valuename_.

Any of the above commands can be run against a remote machine by adding \_MachineName_ to the command line, assuming the [Remote Registry Service](syntax-services.html) is running.

Registry paths which contain a space must be enclosed by quotation marks:  
"HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList\"  
It is easy to miss one space in a long path so it is a good habit to surround all registry paths with quotes.

Depending on the registry permissions, REG ADD may require running REG.exe from an [elevated](syntax-elevate.html) command prompt.  
Registry data stored under HKCU will be visible and writable by the currently logged in user.  
Registry data stored under HKLM will be visible to all users and writable only by administrators.  

REG RESTORE has a tendency not to work, possibly due to firewall issues, EXPORT and IMPORT are much more reliable.

Backslash characters
--------------------

> The REG command will interpret \ as an [escape](syntax-esc.html#escape) for the character that immediately follows it.  
> To include a quote mark (") in the data, prefix it with the escape character e.g. Here is \" a quote
> 
> This can cause problems with quoted directory paths because \" at the end of the line will be escaped.
> 
> To save a directory path with a trailing backslash (\) requires adding a second backslash to 'escape' the escape  
> so for example instead of "C:\My Docs\" use "C:\My Docs\"

Activate
--------

> To activate registry changes in HKEY_CURRENT_USER without logging off:  
> [RUNDLL32.EXE](rundll32.html) USER32.DLL,UpdatePerUserSystemParameters ,1 ,True  
> n.b. this is an unsupported hack, with a good chance of failing in the future - [details on oldnewthing](https://devblogs.microsoft.com/oldnewthing/?p=41043)  

Elevation
---------

> Unlike [REGEDIT](regedit.html), REG.exe does not always require [elevation](syntax-elevate.html)  
> When adding an item to HKCU, REG will be automatically manifested “asInvoker”, and will work without elevation,  
> when adding an item to HKLM then it does need to be run elevated.

Return codes ([ERRORLEVEL](errorlevel.html))
--------------------------------------------

> 0 = Success, the result is identical  
> 1 = Failed  
> 2 = Success, the result is different

### Examples

Query the console settings:

> C:> REG QUERY HKCU\Console\
> C:> REG QUERY HKCU\Console /v ScreenBufferSize

Add the registry key 'Sample' along with some data and then query to check that it worked:

> C:> REG ADD HKCU\Software\SS64 /v Sample /d "some test data"  
> C:> REG QUERY HKCU\Software\SS64 /v Sample  

Add the registry key to disable Fast User Switching on the current PC (requires elevation):

> C:> REG ADD "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v HideFastUserSwitching /t REG_DWORD /d 1

Add a REG_BINARY registry key to HKLM and overwrite if it already exists (requires elevation):

> C:> REG ADD HKLM\Software\DiLithium /v WarpSpeed /t REG_BINARY /d f1f2f3f4 /f  
> C:> REG QUERY HKLM\Software\DiLithium /v WarpSpeed

Find the location of the [Start Menu](syntax-folders.html) folder:

C:> REG QUERY "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders" /v "Start Menu"

Windows Dark mode

> Enable Windows Dark mode:  
> C:> REG ADD HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize /v AppsUseLightTheme /t REG_DWORD /d 0 /f  
>   
> Enable Windows light mode:  
> C:> REG ADD HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize /v AppsUseLightTheme /t REG_DWORD /d 1 /f
> 
> To automate switching to Dark mode use a [Scheduled task](schtasks.html) to call the above REG.exe scripts at dawn and dusk.  
> To make them run precisely at dawn/dusk rather than at fixed times, use the [Sunwait](https://sourceforge.net/projects/sunwait4windows/) utility.

Delete the [3DObjects](https://blogs.windows.com/windows-insider/2021/02/24/announcing-windows-10-insider-preview-build-21322/) folder from the Windows Explorer sidebar (Requires elevation):

> C:> REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{0DB7E03F-FC29-4DC6-9020-FF41B59E513A}"
> C:> REG DELETE "HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{0DB7E03F-FC29-4DC6-9020-FF41B59E513A}"

Save a directory/registry path that ends with a backslash:

> Set _reg=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\SS64.EXE****  
> Set _prog=C:\Program Files\SS64 App****  
> REG ADD "%_reg%****" /f /v "SS64.EXE" /t REG_SZ /d "%_prog%****" 

Save a REG_Expand_SZ value, this variable will be expanded every time the registry value is read, rather than once when the key is added. Example using the %systemroot% variable:

> C:> REG ADD HKLM\Software\SS64 /v Path /t REG_EXPAND_SZ /d **^**%systemroot**^**%  
>   
> Copy registry keys:

C:> REG COPY HKCU\Software\SS64 HKCU\Software\SS64Copy  
C:> REG COPY \Computer64\HKCU\Software\SS64 HKCU\Software\SS64

Export/Import/Save/Restore:

REG EXPORT HKCU\Software\SS64 C:\MyReg.REG  
REG IMPORT C:\MyReg.REG  
REG SAVE HKCU\Software\SS64 C:\MyRegHive.hiv  
REG RESTORE \Wks580\HKCU\Software\SS64 C:\MyRegHive.hiv

Run a script at first logon (Run Once) to do this we edit the Default User profile by temporarily loading it as TEMP:

REG LOAD HKU\TEMP "C:\Documents and Settings\Default User\NTUSER.DAT"
REG ADD HKU\TEMP\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce /v newUserProfile /t REG_EXPAND_SZ /d "D:\setup.cmd" /f
REG UNLOAD HKU\TEMP

To save a progress log as part of a RunOnce command you can include [redirection](syntax-redirection.html) to a log file as part of the command string, however to make this work the redirection characters and quotes must be [escaped](syntax-esc.html#escape):  
... "setup.cmd ^>^> \"C:\Temp\setup.log\"\"" /f

More examples are available via: REG QUERY /? REG ADD /? etc

"The way to a mans heart is through his stomach" ~ Fanny Fern (writer)

### Related commands

[SETX](setx.html) - Set environment variables permanently, can also read a registry key and write the value to a text file.  
[REGEDIT](regedit.html) - Load Registry settings from a .REG file.  
[List all the Internet Explorer Trusted sites.](trusted-sites.html)  
Equivalent PowerShell: [Get-ItemProperty](../ps/get-itemproperty.html) / [Set-ItemProperty](../ps/set-itemproperty.html) - Retrieve / save registry Keys.  
[Q305097](https://docs.microsoft.com/en-gb/troubleshoot/windows-client/deployment/view-system-registry-with-64-bit-windows) - Comparison of the 32 bit and 64-bit Registry Editor Regedit.exe.  
[Q325347](https://docs.microsoft.com/en-gb/troubleshoot/windows-server/application-management/run-logon-script-once-new-user-logs) - Run a Logon Script once the first time a new user logs on, (Runonce).



/. nt/regedit.html
========================================================

    Regedit - Windows CMD - SS64.com

REGEDIT
=======

Import, export or delete registry settings from a text (.REG) file.

Syntax

      Export the Registry (all HKLM plus current user):
      REGEDIT /E _[pathname](path.html#pathname)_

      Export part of the Registry:
      REGEDIT /E _[pathname](path.html#pathname)_ "RegPath"

      Export part of the Registry in ANSI mode:
      REGEDIT /A _[pathname](path.html#pathname)_ "RegPath"
      (This is undocumented and will skip any unicode keys/values.)

      Import a reg script:
      REGEDIT _[pathname](path.html#pathname)_

      Silent import:
      REGEDIT /S _[pathname](path.html#pathname)_

      Start the regedit GUI:
      REGEDIT

      Open multiple copies of regedit:
      REGEDIT /m

Key
    /E : Export

    /S : Silent Import

All registry scripts must start with a version string:  
REGEDIT4  = Windows 98 or any later version of Windows.  
Windows Registry Editor Version 5.00  = Windows 2000 or any later version of Windows.  
Windows 2000 had the first support for Unicode in the registry.

### Examples

Add keys and values to the registry:
------------------------------------

> Create a text file like this:
> 
> Windows Registry Editor Version 5.00
> 
> [HKEY_CURRENT_USER\SomeKey]
> "SomeStringValue"="Hello"
> 
> Note the registry file should contain a blank line at the bottom of the file.
> 
> The registry file must use full names for registry hives (HKEY_LOCAL_MACHINE, HKEY_CURRENT_USER, etc.)  
> not short abbreviations (HKLM, HKCU, etc.).
> 
> When double clicking this .reg file the key and value will be added.  
> Alternatively run REGEDIT _Myfile_.REG from the command line.

Delete keys and values from the registry:
-----------------------------------------

> Create a reg file like this, notice the hyphen inside the first bracket
> 
> Windows Registry Editor Version 5.00 
> [-HKEY_CURRENT_USER\SomeKey]
> 
> When double clicking this .reg file the key "SomeKey" will be deleted along with all string, binary or Dword values in that key.  
>   
> If you want to just delete values, leaving the key in place, set the value you want to delete = to a hyphen  
> e.g.
> 
> Windows Registry Editor Version 5.00 
> [HKEY_CURRENT_USER\SomeKey]
> "SomeStringValue"=-
> 
> Again double click this .reg file to delete the values, or type REGEDIT /s _MyFile_.REG

Elevation
---------

> Unlike [REG.exe](reg.html), REGEDIT will normally require [elevation](syntax-elevate.html) even when adding an item to HKCU,  
> after a sucessful elevation REGEDIT will give access to the whole registry, see [elevation](syntax-elevate.html) for more options.  

Export a registry key to a text (.REG) file
-------------------------------------------

> regedit /e export.reg HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Audio
> 
> Export the same key in ANSI text format:  
> regedit /A ansi.reg HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Audio

Compare the Registry of two machines
------------------------------------

> Opening multiple copies of Regedit.exe (with /m) is useful for comparing keys between two registry hives or between two different computers (File, connect network registry) Press F5 to refresh the view.
> 
> [Windiff](windiff.html) is a useful alternative, this GUI utility from the [resource kit](../links/windows.html#kits) will list all the differences.

Drag and Drop
-------------

> The Regedit GUI supports drag and drop of .reg files. This is mostly useful when connected to a remote registry allowing you to apply a .reg file to a remote machine.

Add Comments
------------

> Within a registry file, comments are prefixed with a semicolon "; "  
> e.g.  
> ;  
> ; Set NUMLOCK at login  
> :  
> ;  0 = Turn OFF at logon.  
> ;  1 = Disable Num Lock.  
> ;  2 = Turn ON at logon.  
> [HKEY_CURRENT_USER\Control Panel\Keyboard]  
> "InitialKeyboardIndicators"="2"
> 
> Batch files will ignore any semicolons before a command, so this can be used to create a [self-contained registry script](https://www.robvanderwoude.com/regedit.php#SelfContained).

Open the regedit GUI at a given Key
-----------------------------------

> Regedit remembers the last registry key that was opened from the last time it was running. This is stored in the registry under:  
> HKCU\Software\Microsoft\Windows\CurrentVersion\Applets\Regedit  
> [LastKey]  
> We can set the LastKey value property from the command line with a REG ADD command.  
>   
> Set "_mykey=HKEY_CURRENT_USER\Software\Microsoft"  
> REG ADD "HKCU\Software\Microsoft\Windows\CurrentVersion\Applets\Regedit" /v "LastKey" /d "%_mykey%" /f  
> Start /b regedit

To activate registry changes in HKEY_CURRENT_USER without logging off:  
[RUNDLL32.EXE](rundll32.html) USER32.DLL,UpdatePerUserSystemParameters ,1 ,True

“Never test the depth of the river with both feet” ~ Ghanaian Proverb

### Related commands

[REG](reg.html) - Read, Set or Delete registry keys and values.  
[SET](set.html) - Display, set, or remove Windows environment variables.  
[SETX](setx.html) - Set environment variables permanently.  
[WMIC REGISTRY](wmic.html) - Set registry options through WMI.  
[REGJUMP](https://learn.microsoft.com/en-us/sysinternals/downloads/regjump) - Sysinternals utility to open Regedit at a specific registry path.  
[Q322756](https://support.microsoft.com/en-gb/help/322756/) - How to backup and edit the registry.  
[Q310516](https://support.microsoft.com/en-gb/help/310516/) - How to add, modify, or delete registry subkeys and values.  
Equivalent PowerShell: [Get-ItemProperty](../ps/get-itemproperty.html) / [Set-ItemProperty](../ps/set-itemproperty.html) - Retrieve / save registry Keys.  
[Registry](syntax-reghacks.html) - Commonly tweaked user interface settings.



/. nt/regsvr32.html
========================================================

    Regsvr32 - Register a DLL - Windows CMD - SS64.com

REGSVR32
========

Register or unregister OLE controls, such as DLLs and ActiveX controls in the Windows Registry.

Syntax

      REGSVR32 [/U] [/S] [/N] [/e] /I:[_CmdLine_] _DLLName_  
Key

  _CmdLine_    An optional command line for DllInstall

  _default_    With no other options: Register server by calling DLLRegisterServer.

    /i:       Call DllInstall(TRUE,[_cmdline_]) to **install** the DLL.
             if the install was successful also call DLLRegisterServer.

    /n /i:    Call DllInstall to install the DLL, but do not call DllRegisterServer.

    /U        Unregister Server by calling DLLUnRegisterServer.

    /U /i:    Call DllInstall(FALSE,[_cmdline_]) to **uninstall** the DLL.
             if the uninstall was successful also call DLLUnRegisterServer.

    /U /n /i: Call DllInstall(FALSE,[_cmdline_]) to uninstall the DLL.
             but do not call DllUnRegisterServer.

    /s        Silent, do not display any dialogue boxes.

    /e        Silent, do not display a success message for DllRegisterServer (undocumented).

  _DLLName_    The path (absolute or relative) to the DLL to call the entry point on.
             This DLL is required to export the entry points that will be called depending
             on the selected option: DLLRegisterServer, DLLUnRegisterServer or DLLInstall.

Regsvr32 requires [Elevation](syntax-elevate.html).

ActiveX controls are now [deprecated](https://blogs.windows.com/msedgedev/2015/05/06/a-break-from-the-past-part-2-saying-goodbye-to-activex-vbscript-attachevent/) and will only run in Internet Explorer.

DllInstall is used only for application installation and setup. It should not be called by an application.  
DllRegisterServer Instructs an in-process server to create its registry entries for all classes supported in the module.  
DllUnregisterServer Instructs an in-process server to remove only those entries created through DllRegisterServer.

If you run REGSVR32 dllname.dll when the file is already registered, this will display a Pop Up message: "The module _ModuleName_ was loaded but the Entry-point DllRegisterServer was not found."

On a 64-bit version of Windows operating system, there are two versions of the Regsvr32.exe file:

The 64-bit version is %systemroot%\System32\regsvr32.exe  
The 32-bit version is %systemroot%\SysWoW64\regsvr32.exe

To use the 32-bit version of Regsvr32 to register a 32-bit DLL on a 64-bit version of Windows, Open an [elevated](syntax-elevate.html) prompt and run a command like:

%systemroot%\SysWoW64\regsvr32 _full_path_of_the_DLL_

### Examples

Unregister (Disable) CAB file viewer:  
REGSVR32 **/u** C:\Windows\System32\cabview.dll

Register (enable) CAB file viewer:  
REGSVR32 cabview.dll

Register DAO 3.6 (Data Access Objects):  
  
REGSVR32 "C:\Program Files\Common Files\Microsoft Shared\DAO\DAO360.DLL"

“I was planning to go into architecture. But when I arrived, architecture was filled up. Acting was right next to it. So I signed up for acting instead” ~ Tom Selleck (on his college registration experience)

### Related commands

[MSIEXEC](msiexec.html) - Microsoft Windows Installer.  
[RUNDLL32](rundll32.html) - Run a DLL command.  
[Q249873](https://support.microsoft.com/en-gb/help/249873/) - Regsvr32 usage and error messages.



/. nt/regini.html
========================================================

    REGINI - Windows CMD - SS64.com

REGINI
======

Change Registry Permissions.

Syntax

      REGINI [-m \_machinename_] [-i _n_]
         [-o _outputWidth_][-b] _textFiles_...

      REGINI [-h _hivefile hiveroot_] [-i _n_]
         [-o _outputWidth_][-b] _textFiles_...

Key
    -m     A remote computer to be modified.

    -h     The local hive to manipulate.

    -i _n_   The display indentation multiple.  Default is 4

    -o _outputWidth_ 
          The width of the command output.  By default the _outputWidth_ is set
          to the width of the console window unless standard output has 
          been redirected to a file, in which case, 240 is used.

  _textFiles_  One or more ANSI or Unicode text files containing registry data.

    -b     Make REGINI backward compatible with older versions of REGINI that
          did not strictly enforce line continuations and quoted strings
          Specifically, REG_BINARY, REG_RESOURCE_LIST and
          REG_RESOURCE_REQUIREMENTS_LIST data types did not need line
          continuations after the first number that gave the size of the data.
           It just kept looking on following lines until it found enough data
           values to equal the data length or hit invalid input.  Quoted
           strings were only allowed in REG_MULTI_SZ.  They could not be
           specified around key or value names, or around values for REG_SZ or
           REG_EXPAND_SZ  Finally, the old REGINI did not support the semicolon
           as an end of line comment character.

To understand the format of the input _textFile_ use the REGDMP command (22,288 bytes, Windows 2000 Resource Kit) with no arguments to dump the current contents of the registry to standard out. Redirect standard out to a file and this file is acceptable as input to REGINI.  
regdmp HKEY_CURRENT_USER >hkcu.txt

> The REGDMP utility has not been supplied with any versions of Windows or any Resource Kits since Windows 2000, the likely expectation is that most people will now use PowerShell ([Get-ACL](../ps/get-acl.html) and [Set-ACL](../ps/set-acl.html)) for this, the new commands are widely available and much easier to use.

The semicolon character is an end-of-line comment character, provided it is the first non-blank character on a line  
  
The Backslash character is a line continuation character. All characters from the backslash up to but not including the first non-blank character of the next line are ignored. If there is more than one space before the line continuation character, it is replaced by a single space.  
  
Indentation is used to indicate the tree structure of registry keys The REGDMP program uses indentation in multiples of 4. You can use hard tab characters for indentation, but embedded hard tab characters are converted to a single space regardless of their position  
  
Values should come before child keys, as they are associated with the previous key at or above the value's indentation level.  
  
For key names, leading and trailing space characters are ignored and not included in the key name, unless the key name is surrounded by quotes. Imbedded spaces are part of a key name.  
  
Key names can be followed by an Access Control List (ACL) which is a series of decimal numbers, separated by spaces, bracketed by a square brackets (e.g. [8 4 17]). The valid numbers and their meanings are:

    1  - Administrators Full Access
    2  - Administrators Read Access
    3  - Administrators Read and Write Access
    4  - Administrators Read, Write and Delete Access
    5  - Creator Full Access
    6  - Creator Read and Write Access
    7  - World Full Access
    8  - World Read Access
    9  - World Read and Write Access
    10 - World Read, Write and Delete Access
    11 - Power Users Full Access
    12 - Power Users Read and Write Access
    13 - Power Users Read, Write and Delete Access
    14 - System Operators Full Access
    15 - System Operators Read and Write Access
    16 - System Operators Read, Write and Delete Access
    17 - System Full Access
    18 - System Read and Write Access
    19 - System Read Access
    20 - Administrators Read, Write and Execute Access
    21 - Interactive User Full Access
    22 - Interactive User Read and Write Access
    23 - Interactive User Read, Write and Delete Access

If there is an equal sign on the same line as a left square bracket then the equal sign takes precedence, and the line is treated as a registry value. If the text between the square brackets is the string DELETE with no spaces, then REGINI will delete the key and any values and keys under it.

           For registry values, the syntax is:

              value Name = type data

Leading spaces, spaces on either side of the equal sign and spaces between the type keyword and data are ignored, unless the value name  
is surrounded by quotes. If the text to the right of the equal sign is the string DELETE, then REGINI will delete the value.  
  
The value name can be left out or be specified by an @ character which will resolve to an empty value _name_.  
The following two lines are identical:  
  
= type data  
@ = type data  
  
This syntax means that you can’t create a value with leading or trailing spaces, an equal sign or an @ in the value name, unless you put the name in quotes.

Valid value types and format of data that follows are:

    REG_SZ _text_
    REG_EXPAND_SZ _text_
    REG_MULTI_SZ "_string1_" "_str_""_ing2_" ...
    REG_DATE _mm/dd/yyyy HH:MM DayOfWeek_
    REG_DWORD _numberDWORD_
    REG_BINARY _numberOfBytes numberDWORD(s)_...
    REG_NONE           (same format as REG_BINARY)
    REG_RESOURCE_LIST  (same format as REG_BINARY)
    REG_RESOURCE_REQUIREMENTS      (same format as REG_BINARY)
    REG_RESOURCE_REQUIREMENTS_LIST (same format as REG_BINARY)
    REG_FULL_RESOURCE_DESCRIPTOR   (same format as REG_BINARY)
    REG_QWORD _numberQWORD_
    REG_MULTISZ_FILE _fileName_
    REG_BINARYFILE _fileName_

If no value type is specified the default is REG_SZ _text_

For REG_SZ and REG_EXPAND_SZ, if you want leading or trailing spaces in the value text, surround the text with quotes. The value text can contain any number of imbedded quotes, and REGINI will ignore them, as it only looks at the first and last character for quote characters.  
  
For REG_MULTI_SZ, each component string is surrounded by quotes. If you want an imbedded quote character, then double quote it, as in string2 above.  
  
For REG_BINARY, the value data consists of one or more numbers The default base for numbers is decimal. Hexidecimal can be specified by using 0x prefix. The first number is the number of data bytes, excluding the first number. After the first number must come enough numbers to fill the value. Each number represents one DWORD or 4 bytes. So if the first number was 0x5 you would need two more numbers after that to fill the 5 bytes. The high order 3 bytes  
of the second DWORD would be ignored.  
  
Whenever specifying a registry path, either on the command line or in an input file, the following prefix strings can be used:

    HKEY_LOCAL_MACHINE
    HKEY_USERS
    HKEY_CURRENT_USER
    USER:
    Each of these strings can stand alone as the key name or be followed
    a backslash and a subkey path.

### Examples

Grant Admin full access and World Read/Write access to an HKLM registry key on computer64:

regdemo.txt

HKEY_LOCAL_MACHINE\Software\Classes\SS64 [1 9]

Command:

C:> RegIni -m \computer64 regdemo.txt

“Never test the depth of the river with both feet” ~ Ghanaian Proverb

### Related commands

[Regini documention](https://go.microsoft.com/fwlink/?LinkId=201803) - Full docs originally provided as part of the Windows Server 2000 Resource Kit.  
[REGEDIT](regedit.html) - Import or export registry settings.  
[REG](reg.html) - Registry: Read, Set, Export, Delete keys and values.  
[Q245031](https://web.archive.org/web/20140214115957/https://support.microsoft.com/kb/245031) - Use a script to change registry permissions.  
[Q237607](https://web.archive.org/web/20140320201722/https://support.microsoft.com/kb/237607) - Use Regini.exe to set permissions on registry.  
PowerShell equivalent: [Get-ACL](../ps/get-acl.html) and [Set-ACL](../ps/set-acl.html)



/. nt/rem.html
========================================================

    Rem - Comment - Windows CMD - SS64.com

REM
===

In a batch file REM at the start of a line signifies a comment or REMARK.

An alternative is adding :: at the start of a line, this has a similar effect to REM. Double colons act like a [GOTO](goto.html) or [CALL](call.html) :label the second colon is invalid as a name but is still treated as a label, and so the line is always skipped.

### Examples

@ECHO OFF  
::  
:: First comment  
  
REM Second comment  
REM  
  
Echo Hello REM This remark is displayed by echo  
Echo Hello & REM This remark is ignored by echo  
  
Copy work.xls backup.xls [&](syntax-redirection.html):: We backed up the file  
  
Although you can use REM without a comment to add vertical spacing to a batch file, you can also use completely blank lines. The blank lines are ignored when processing the batch program.

The double-colon :: is not documented as a comment command. An important limitation of this is that as a label it can only be used at the beginning of the line. Also because the double colon is a command, it will be displayed if you run a batch file without [@ECHO](echo.html) OFF

A REM comment is slightly slower to process than :: (360µs versus 58µs per comment line)  
A REM comment is a documented command that may be used almost anywhere within a command line.  
  
C:> Echo This will work REM Echo But will this show  
This will work REM Echo But will this show

You can add a comment to the end of a command line using &REM or &::  
C:> Echo This will work &:: Echo this will not show  
This will work  
This approach works because ['&'](syntax-redirection.html) introduces a new command on the same line.

Multi-Line Comments
-------------------

> One approach to adding a large multi-line block of comment test is to use plain text and a [goto](goto.html) command to jump execution past the comments:
> 
> @Echo OFF
> Goto :START
> 
> Description can go here
> which can even include - | > characters
> 
> :START
> 
> The technique above will not work in the middle of a bracketed expression such as a FOR... DO(...) loop.  
> This is because a Goto command cannot be used inside brackets - it would break their context.  
>   
> Such cases can be handled by also putting the comment text within brackets, as below:
> 
> (
>   Echo the lines below are commented
>   Rem/||**(**
>     some comment text that will work within brackets.
>     The REM command always evaluates to TRUE so these
>     lines will never be executed.
>   **)**
> )

Comments within bracketed code blocks.
--------------------------------------

> When :: labels are used as comments within a [bracketed code block](syntax-brackets.html) or FOR command, the command processor will expect (not unreasonably) that every label is followed by at least one command. (That way if you jump to the label it will have something to execute.) In fact the CMD shell will attempt to execute the second line [even if it is formatted as a label](https://ss64.org/viewtopic.php?f=2&t=118).  
> Anything which is not a valid command, even a blank line or a closing parenthesis will cause a :: style comment to fail:
> 
> (
>  Echo This example will fail
>  :: some comment
> )
> 
> (  
>  :NormalLabel & Echo this will not be executed.  
>  :SecondaryLine & Echo This will be executed.  
> ) 
> 
> When working within parentheses/brackets it is safer to use REM for all comment lines.
> 
> (
>  REM something & Echo this will not be executed.
>  REM somethingelse & Echo This also will not be executed.
> )
> 
> However these do have to be on a separate line to any brackets:
> 
> (REM My comment & ECHO Something else)
> 
> The line above is equivalent to:  
> (REM  
> The REM wipes out everything following, including the close bracket which will typically break the script.

Bugs
----

> It is possible, (though rare) to [SUBST](subst.html) a drive with the character : resulting in the drive :: that will break the use of double colons as a remark.
> 
> A comment like the examples below will be interpreted as a command and will produce a fatal error:  
> ::%~  
> or  
> REM %~  
>   
> or similarly with a variable  
> set var=demo  
> rem %var:=  
> or  
> rem %var:*=  
>   
> There errors will terminate all further batch processing and return an error message:  
> _The following usage of the path operator in batch-parameter substitution is invalid: %~_  
> 
> This behaviour is a result of the [batch parsing rules](https://stackoverflow.com/questions/4094699/how-does-the-windows-command-interpreter-cmd-exe-parse-scripts/4095133#4095133) used by CMD.EXE and so is unlikely to ever change.
> 
> To avoid these issues, make sure your comments do not contain any % characters.

Inline comments
---------------

> We have covered adding a whole line comment and adding a comment at the end of a line, but sometimes there is a need to add a small comment in the middle of a line to explain some detail.
> 
> Batch variable [names](set.html) can contain spaces and punctuation, we can take advantage of this fact by typing our comment as a non-existent variable. Because it doesn’t exist, this variable will expand to nothing and so will have no effect when the script is run.
> 
> n.b. This only works in batch files, not directly at the command prompt.
> 
> To be sure that we don’t accidently choose a name which is in fact a real variable, start and end the comment with "="  
> 
> @Echo off  
> Echo This is an example of an %= Inline Comment =% in the middle of a line.
> 
> (Variable names starting with "=" are reserved for undocumented dynamic [variables](syntax-variables.html). Those dynamic variables never end with "=", so by using an "=" at both the start and end of our comment, there is [no](https://stackoverflow.com/a/12411082/1720814) possibility of a name clash.)  
> Limitations: the comment text cannot contain % or :

Registry Comments
-----------------

> Within a registry .REG file comments can be preceded by ;  
>   
> ;  
> ; Turn the NUMLOCK on at login  
> ;  
> [HKEY_CURRENT_USER\Control Panel\Keyboard]  
> "InitialKeyboardIndicators"="2"

FTP Comments
------------

> There is no valid comment character for [FTP](ftp.html) but you can cheat by escaping to the shell and running REM  
> e.g.  
>   
> C:\WORK>type ftpscript  
> !REM This is a remark  
> bye
> 
> C:\WORK>ftp -s:ftpscript  
> ftp> !REM This is a remark  
> ftp> bye
> 
> C:\WORK>

REM does not set or clear the [Errorlevel](errorlevel.html).  
REM is an [internal](syntax-internal.html) command.

_“_I can’t stand a naked light bulb, any more than I can a rude remark or a vulgar action_”_ ~ Tennessee Williams

### Related commands

In the text editor, Notepad++ you can add REM to the beginning of multiple lines: Select them and hit Ctrl-Q  
Equivalent PowerShell: # - Comment / Remark.  
Equivalent bash command: [#](../bash/rem.html) - Comment / Remark.



/. nt/ren.html
========================================================

    Ren - Rename - Windows CMD - SS64.com

REN
===

Rename a file or files.

    REN [_drive_:][_path_]_SourceMask TargetMask_

Both the _SourceMask_ and _TargetMask_ can contain * and/or ? [wildcards](syntax-wildcards.html).  
As described below, the behavior of these wildcards is slightly different for a _source_ or a _target_ mask.

*   You **cannot** specify a new or different drive or path for _TargetMask_ - use the [MOVE](move.html) command instead.
*   Characters represented by wildcard characters in _TargetMask_ will be identical to the corresponding characters in _SourceMask_.
*   If _TargetMask_ matches an existing file name, the following error message appears: _Duplicate file name or file not found_.  
    Instead use "[MOVE /y](move.html)" to rename and replace an existing file.

REN can also be used to rename directories, but this behaviour is undocumented.  
A simple REN folderA folderB will work, but wildcard operations are **not** supported for directories, if you issue a wildcard rename that matches both files and directories, the file(s) will be renamed and the folders will be ignored. If you issue a wildcard rename that matches only directories then a syntax error will be thrown.

RENAME is a synonym for REN

Rename files within subdirectories
----------------------------------

> By default REN with a wildcard will only rename the files in a single folder, to recurse down into sub folders use a [FOR /R](for_r.html) command, after first changing to the top level directory.
> 
> e.g. A batch file to rename all .LOG files to .TXT in the 'C:\demo\' folder and all sub-folders:
> 
> CD C:\demo\  
> For /R %%G in (*.LOG) do **Echo** REN "%%G" "%%[~dpn](syntax-args.html)G.TXT"  
> Remove the **echo** to run this for real  

SourceMask
----------

> The sourceMask works as a filter to determine which files are renamed. The wildcards work here the same as with any other command that filters file names.
> 
> > ? Matches any 0 or 1 character except . This wildcard is greedy - it always consumes the next character if it is not a . However it will match nothing without failure if at name end or if the next character is a .
> > 
> > * Matches any 0 or more characters including . (with one exception below). This wildcard is not greedy. It will match as little or as much as is needed to enable subsequent characters to match.
> 
> All non-wildcard characters must match themselves, with a few special case exceptions.
> 
> > . Matches itself or it can match the end of name (nothing) if no more characters remain. (Note: a valid Windows file/folder name cannot end with .)
> > 
> > {space} Matches itself or it can match the end of name (nothing) if no more characters remain. (Note: a valid Windows file/folder name cannot end with {space})
> > 
> > *. at the end, Matches any 0 or more characters except . The terminating . can actually be any combination of . and {space} as long as the very last character in the mask is . this is the one and only exception where * does not match _any_ set of characters.
> 
> The above rules are not that complex. But there is one more very important rule that makes the situation confusing: The _SourceMask_ is compared against both the long name and the short 8.3 name (if it exists). This last rule can make interpretation of the results very tricky, because it is not always obvious when the mask is matching via the short name.
> 
> It is possible to use [FSUTIL](fsutil.html) to disable the generation of short 8.3 names on NTFS volumes, at which point interpretation of file mask results is much more straight forward. Any short names that were generated before disabling short names will remain. New installations of Windows server now default to disabling 8.3 names.

TargetMask
----------

> The _TargetMask_ specifies the new name. It is always applied to the full long name; The _TargetMask_ is never applied to the short 8.3 name, even if the _SourceMask_ matched the short 8.3 name.
> 
> The presence or absence of wildcards in the _SourceMask_ has no impact on how wildcards are processed in the _TargetMask_.
> 
> In the following discussion c represents any character that is not *, ?, or .
> 
> The _TargetMask_ is processed against the source name strictly from left to right with no back-tracking.
> 
> > _c_ Advances the position within the source name as long as the next character is not . and appends _c_ to the target name. Replaces the character that was in source with _c_, but never replaces ' . '
> > 
> > ? Matches the next character from the source long name and appends it to the target name as long as the next character is not ' . ' If the next character is . or if at the end of the source name then no character is added to the result and the current position within the source name is unchanged.
> > 
> > * At end of _TargetMask_ - Appends all remaining characters from source to the target. If already at the end of source, then does nothing.
> > 
> > *_c_ Matches all source characters from current position through the last occurance of _c_ (case sensitive greedy match) and appends the matched set of characters to the target name. If _c_ is not found, then all remaining characters from source are appended, followed by _c_  
> > This is a rare example where Windows file pattern matching is case sensitive.
> > 
> > *. Matches all source characters from current position through the last occurance of . (greedy match) and appends the matched set of characters to the target name. If . is not found, then all remaining characters from source are appended, followed by .
> > 
> > *? Appends all remaining characters from source to the target. Any additional characters after the *? in _sourceMask_ will be appended to target. If already at end of source then does nothing.
> > 
> > . without * in front - Advances the position in source through the first occurance of . without copying any characters, and appends . to the target name. If . is not found in the source, then advances to the end of source and appends . to the target name.
> 
> After the _TargetMask_ has been exhausted, any trailing . and {space} are trimmed off the end of the resulting target name because Windows file names cannot end with . or {space}
> 
> _It appears these same rules also work for the target name of the [COPY](copy.html) commmand._

8.3 Filename bug - a single command can rename the same file twice!
-------------------------------------------------------------------

> When 8.3 filenames exist then the _SourceMask_ will first look for a match against the long file name, and then against the short file name. If the result of the first rename operation still matches the _SourceMask_ then the same file can be renamed twice. For example:
> 
> copy nul 123456789.123
> dir /x
> ren *1* **2*3.?x**
> dir /x
> 
> Expected result = 223456789.123.x  
> Actual result = 223456789.123.**xx**
> 
> If [8.3 name generation](syntax-filenames.html) is enabled, the _SourceMask_ matches the original long name, the initial rename generates a short name that still matches _SourceMask_ and sorts later in the alphabet, then this bug _might_ be triggered.  
> 
> If 8.3 name generation is disabled then RENAME always gives the expected result.

The [delimiter](syntax-esc.html) between the source and target is normally a space but can be any of Comma, Semicolon, Equals, Space or Tab.  
Multiple delimiters are treated as one, so all the following are equivalent:

REN source.txt dest.txt  
REN source.txt=dest.txt  
REN source.txt = dest.txt  
REN source.txt=;=,=dest.txt

Note that most programming languages use = assignments the other way around: Let dest=some_source_expression  
For this reason the use of = is not recommended in this context.

Errorlevels
-----------

> If the File(s) were successfully renamed [%ERRORLEVEL%](errorlevel.html) = 0  
> If the File was not found, could not be renamed or bad parameters [%ERRORLEVEL%](errorlevel.html) = 1

### Examples

Rename Monday.txt as Tuesday.txt:  
C:> REN Monday.txt Tuesday.txt

Rename Tuesday.txt as Any Day.txt:  
C:> REN Tuesday.txt "Any Day.txt"

Substitute a character in the 1st and 3rd positions prior to any extension (adds a 2nd or 3rd character if it doesn’t exist yet)

ren  *  A?Z*
  1        -> AZ
  12       -> A2Z
  1.txt    -> AZ.txt
  12.txt   -> A2Z.txt
  123      -> A2Z
  123.txt  -> A2Z.txt
  1234     -> A2Z4
  1234.txt -> A2Z4.txt

Change the (final) extension of every file:

ren  *  *.txt
  a     -> a.txt
  b.dat -> b.txt
  c.x.y -> c.x.txt

Append an extension to every file:

ren  *  *?.bak
  a     -> a.bak
  b.dat -> b.dat.bak
  c.x.y -> c.x.y.bak

Remove any extra extension after the initial extension. Note that adequate ? must be used to preserve the full existing name and initial extension:

ren  *  ?????.?????
  a     -> a
  a.b   -> a.b
  a.b.c -> a.b
  part1.part2.part3    -> part1.part2
  123456.123456.123456 -> 12345.12345   (note truncated name and extension because not enough \`?\` were used)

Same as above, but filter out files with initial name and/or extension longer than 5 chars so that they are not truncated. (Obviously could add an additional ? on either end of targetMask to preserve names and extensions up to 6 chars long.):

ren  ?????.?????.*  ?????.?????
  a      ->  a
  a.b    ->  a.b
  a.b.c  ->  a.b
  part1.part2.part3  ->  part1.part2
  123456.123456.123456  (Not renamed because it doesn't match sourceMask)

Change characters after last _ in name and attempt to preserve extension. (Doesn’t work properly if _ appears in extension.):

ren  *_*  *_NEW.*
  abcd_12345.txt  ->  abcd_NEW.txt
  abc_newt_1.dat  ->  abc_newt_NEW.txt
  abcdef.jpg          (Not renamed because it doesn't match sourceMask)
  abcd_123.a_b    ->  abcd_123.a_NEW  (not desired, but no simple RENAME form will work in this case) 

Any name can be broken up into components that are delimited by . characters can only be appended to or deleted from the end of each component. Characters cannot be deleted from or added to the beginning or middle of a component while preserving the remainder with wildcards. Substitutions are allowed anywhere.

ren  ??????.??????.??????  ?x.????999.*rForTheCourse
  part1.part2            ->  px.part999.rForTheCourse
  part1.part2.part3      ->  px.part999.parForTheCourse
  part1.part2.part3.part4   (Not renamed because it doesn't match sourceMask)
  a.b.c                  ->  ax.b999.crForTheCourse
  a.b.CarPart3BEER       ->  ax.b999.CarParForTheCourse

A sourceMask with at least 8 ? for the name and at least 3 ? for the extension will match all files because it will always match the short 8.3 name (assuming one exists).

ren ????????.???  ?x.????999.*rForTheCourse
  part1.part2.part3.part4  ->  px.part999.part3.parForTheCourse

Credits:  
Dave Benham - List of [How does the Windows RENAME command interpret wildcards?](https://superuser.com/questions/475874/how-does-the-windows-rename-command-interpret-wildcards#475875) from [SuperUser](https://superuser.com/) Dec 2012

REN is an [internal](syntax-internal.html) command.

“We may dig in our heels and dare life never to change, but, all the same, it changes under our feet like sand under the feet of a sea gazer as the tide runs out. Life is forever undermining us. Life is forever washing away our castles, reminding us that they were, after all, only sand and sea water” ~ Erica Jong (Parachutes and Kisses)

### Related commands

[MOVE](move.html) - Move a file from one folder to another.  
[Stamp.cmd](syntax-stampme.html) - Batch file to rename a file to include the current date and time.  
Equivalent PowerShell: [Rename-Item](../ps/rename-item.html) - Change the name of an existing item (ren/rni).  
Equivalent bash command (Linux): [rename](../bash/rename.html) - rename files, [mv](../bash/mv.html) - Move or rename files or directories.



/. nt/replace.html
========================================================

    Replace - Windows CMD - SS64.com

REPLACE
=======

Replace one file with another (both having the same filename).

Syntax

      REPLACE [_Drive_:][_path_]_SourceFiles_ [_Drive_:][_path_2] [/A] [/P] [/R] [/W]  
      REPLACE [_Drive_:][_path_]_SourceFiles_ [_Drive_:][_path_2] [/S] [/P] [/R] [/W] [/U]  
Key
    _path/files_ : The source file(s), [wildcards](syntax-wildcards.html) accepted.  
    _path2_      : The destination folder. If no destination is specified REPLACE will
                use the [current](cd.html) drive and directory as the destination.

    /A   : Add any missing files.  
    /P   : Prompt for confirmation (each file)  
    /R   : Replace even Read-only files  
    /S   : Include all subfolders of the destination.  
    /W   : Wait/pause (originally to allow inserting a floppy disk.)  
    /U   : Update only files that are older than the source.

When replacing in all subdirectories (/S ) the files in the source are matched against every subfolder, this is not a mirror, the files in each folder are matched separately.  
The (/S ) subdirectories option cannot be combined with Add files (/A) or Restrict to Updating older (/U).

REPLACE will list all the files that are replaced. By default, only files that _already_ exist in the destination will be replaced.

You cannot use REPLACE to update any file which has a hidden or system attribute set, see the [ATTRIB](attrib.html) command for more.  

REPLACE will set [%ERRORLEVEL%](errorlevel.html) as follows:

> 0 0 or more files were replaced.  
> 3 Source or destination not found.  
> 5 Access denied.  
> 11 Invalid switch.

The path to the destination folder must NOT include a trailing backslash.

### Examples

Update the files in C:\delivery\ with the .exe files in C:\source files\

C:> replace "C:\source files*.exe" C:\delivery

Update the report.doc file in all the folders beneath C:\reports :

C:> replace "C:\demo\report.doc" C:\reports /s  
Replacing C:\reports\Jan\report.doc  
Replacing C:\reports\Feb\report.doc  
Replacing C:\reports\Mar\report.doc

"That's the secret to life... replace one worry with another" ~ Charles M. Schulz

### Related commands

[ROBOCOPY](robocopy.html) - Robust File and Folder Copy.  
[MOVE](move.html) - Move files from one folder to another folder on the same drive.  
[DEL](del.html) - Delete one or more files.  
[COPY](copy.html) - Copy one or more files to another location.  
Equivalent bash command (Linux): [install](../bash/install.html) - Copy files and set attributes.



/. nt/reset-session.html
========================================================

    RESET SESSION / RWinSta - Windows CMD - SS64.com

RESET SESSION / RWinSta
=======================

Reset (delete) a Remote Desktop Session.

Syntax

      RESET SESSION {_SessionName_ | _SessionID_} [/server:_ServerName_] [/v]

Key
    _SessionName_ The name of the session that you want to reset.
               To determine the name, use [query session](query-session.html)
    _SessionID_   The ID of the session that you want to reset.

    /server:_ServerName_
               The Remote Desktop Host server containing the session to be reset.
               The default is the current RD Session Host server

    /?          Display help.

Reset Session causes the device to close and then to reopen. Use reset session when the session malfunctions or when the session appears to be down. When you reset a session, the underlying hardware is reset and the drivers and data are reloaded and reinitialized.

Resetting a user's session without warning the user, can result in the loss of data at the session.

Only reset a session when it malfunctions or appears to have stopped responding.

You can always reset your own sessions, but you must have Full Control access permission to reset another user's session. Users can also reset sessions of other users who log on with the same **name**. This is by design in version 4.0 of Terminal Server. To avoid this, give users unique logon names or deny access to the RESET SESSION utility.

RESET SESSION is a synonym for AND replaces RWINSTA from Citrix Winframe. It resets the subsystem hardware and software of the session to known initial values.

Disconnecting a session will often, but not always, cause the session to logoff.  
To force a logoff use the logoff command:

[LOGOFF](logoff.html) _sessionId_ /server:_serverName_

RDP Permissions are set under:

Terminal Services Configuration ➞ Connections ➞ Properties ➞ Permissions ➞ Advanced ➞ Permissions

### Examples

Reset the session designated rdp-tcp#6:

C:> reset session rdp-tcp#6

Reset the session that uses session ID 3:

C:> reset session 3

Reset the session ID 2 on remote server64:

C:> reset session 2 /server:Server64

_“The crowds in the big towns, with their mild, knobby faces, their bad teeth and gentle manners solid breakfasts and gloomy Sundays, smoky towns and winding roads, green fields and red pillar boxes” ~ George Orwell_

### Related commands

[Query Session](query-session.html) - Display all sessions (TS/Remote Desktop).  
[Query TermServer](query-termserver.html) - List all servers (TS/Remote Desktop).  
[LOGOFF](logoff.html) - Log a user off.  
[CHANGE](change.html) - Change Terminal Server Session properties.  
[MSTSC](mstsc.html) - Terminal Server Connection (Remote Desktop Protocol).



/. nt/rd.html
========================================================

    RD - Remove Directory - Windows CMD - SS64.com

RD
==

Remove (or Delete) a Directory.

Syntax

      RD _[pathname](path.html#pathname)_
      RD /S _[pathname](path.html#pathname)_
      RD /S /Q _[pathname](path.html#pathname)_
   
Key
    /S  : Delete all files and subfolders
         in addition to the folder itself.
         Use this to remove an entire folder tree.

    /Q  : Quiet - do not display Y/N confirmation

Place any long pathnames in double quotes.

Without the /S option, RD will only delete an empty directory and RD /Q will _silently_ fail to delete any directories that are not empty.  
If the pathname is a [Junction Point](mklink.html), then RD without /S will remove the Junction point itself, not the Junction’s destination directory.

RD does not support [wildcards](syntax-wildcards.html) but you can remove multiple directories in one command:  
  
C:> RD C:\docs\Jan "C:\My Documents\Mar"

Delete a directory with a trailing space
----------------------------------------

> If you try to delete a directory which has a trailing space, WIndows explorer will give the error: “Could Not Find This Item”.  
> Escaping the closing quote seems to bypass the normal logic of trimming trailing spaces and allows you to delete the folder:
> 
> C:> RD "this has a trailing space \"

Exit code / Errorlevel
----------------------

> In normal use RD will [fail](https://stackoverflow.com/questions/11137702/batch-exit-code-for-rd-is-0-on-error-as-well) to return an [ERRORLEVEL](errorlevel.html) to the shell, irrespective if the command succeeds or fails the ERRORLEVEL will be left unchanged.
> 
> It will however set an Exit Code
> 
> > Directory deleted successfully = 0  
> > Invalid option = 1  
> > Directory not found = 2  
> > Access denied = 5  
> > Directory in use = 32  
> > Directory not empty = 145
> 
> A workaround to detect a non zero Exit Code from RD is to use [conditional execution](syntax-conditional.html) to run a command if the RD fails, the second command can be anything, but typically will be an Echo, Goto or CALL statement:
> 
> RD NonExistentFolder || Echo This failed!  

If you delete directories using PowerShell then a True/False return code ($?) will be set correctly.

RMDIR is a synonym for RD

RD is an [internal](syntax-internal.html) command.

### Examples

Remove 'C:\demo documents\work' and all files and sub folders:

C:> RD /S "C:\demo documents\work"

Remove 'C:\source_files' but only if it is already empty:

C:> RD "C:\source_files"  

“Dying is the most embarrassing thing that can happen to you, because someones got to take care of all your details” - Andy Warhol

### Related commands

[CIPHER /w](cipher.html) - Overwrite data in a directory (secure delete).  
[MD](md.html) - Create Directory.  
[CD](cd.html) - Change Directory.  
[DEL](del.html) - Delete selected files from an entire folder tree.  
[DELTREE](deltree.html) - Script to Delete a folder and all subfolders/files.  
[Delete only empty folders](https://ss64.org/viewtopic.php?f=2&t=37) and log results.  
[FSUTIL](fsutil.html) reparsepoint delete - Delete an NTFS reparse point.  
[INUSE](inuse.html) - updated file replacement utility (may not preserve file permissions).  
Equivalent PowerShell: [Remove-Item](../ps/remove-item.html) - Remove an item (rd/ri/rmdir).  
Equivalent bash command (Linux): [rmdir](../bash/rmdir.html) - Remove folder(s) [rm -rf](../bash/rm.html) - Delete directory recursively.



/. nt/rmtshare.html
========================================================

    Rmtshare - File and Printer shares - Windows CMD - SS64.com

RMTSHARE.exe ([NT 4 Resource kit](../links/windows.html#kits))
==============================================================

Manage File and Printer shares, local or on a remote server.  
Although missing from recent Resource kits, the old version works also under Windows XP/2003 and possibly newer versions.

Syntax

  Display all shares
      RMTSHARE \_server_

  Display details of a specific share
      RMTSHARE \server\sharename

  Share a Folder
      RMTSHARE \_server\sharename_=drive:path [_options_]

  Share a Printer
      RMTSHARE \_server\sharename_=_printername_ /PRINTER [_options_]

  Edit an existing SHARE
      RMTSHARE \_server\sharename_ [_options_]

  Delete a SHARE
      RMTSHARE \_server\sharename_ /DELETE

Options
      /USERS:_number_
      /UNLIMITED
      /REMARK:"_text_"
      /GRANT _user_:_perm_
      /REMOVE _user_

Notes: Either specify /Users to restrict the number of connections that can be made OR specify /UNLIMITED  
You can include several /GRANTs in a single command line.  
Enclose paths that include spaces like this  
\server\"long share name"="c:\long file name"

PowerShell alternative
----------------------

An alternative way to list remote shares with PowerShell:

$server = '_SERVER64_'
$shares = [Get-CIMinstance](../ps/get-ciminstance.html) -class Win32_Share -computername $server -filter "Type=0"
$shares | foreach {
    $path=($_.path)
    $Description=($_.Description)
    $name=($_.name)
    $Caption=($_.Caption)

    "Share Name   : $name
     Source Folder: $path 
     Description  : $Description
     Caption : $Caption"
    }

“How to be green? consume less, share more, enjoy life” ~ Penny Kemp

### Related commands

[CACLS](cacls.html) - Apply File permissions.  
[NET USE](net.html) - Connect to a file share.  
REMOTE - Run a command on a remote computer (Resource Kit).  
[RUNDLL32](rundll32.html) - Run a DLL command (add/remove print connections).  
[SHARE](share.html) - List or edit a file share or print share (on any computer).  
Equivalent PowerShell: [Get-CIMInstance](../ps/get-ciminstance.html) win32_share.  
Equivalent bash command (Linux): [mount](../bash/mount.html) - Mount a file system.



/. nt/robocopy.html
========================================================

    td {text-align: center;} Robocopy "Robust File Copy" - Windows CMD - SS64.com 

ROBOCOPY.exe
============

Robust File and Folder Copy.  
By default Robocopy will only copy a file if the source and destination have different time stamps or different file sizes.

Syntax

      ROBOCOPY _Source_folder Destination_folder_ [_files_to_copy_] [_options_]

Key
     _files_to_copy_ : A list of files or a [wildcard](syntax-wildcards.html).
                     (defaults to copying *.*)

  Source options
                /S : Copy Subfolders.
                /E : Copy Subfolders, including Empty Subfolders.
                /A : Copy only files with the Archive attribute set.
                /M : like /A, but remove Archive attribute from source files.
            /LEV:_n_ : Only copy the top _n_ LEVels of the source tree.

         /MAXAGE:_n_ : MAXimum file AGE - exclude files older than _n_ days/date.
         /MINAGE:_n_ : MINimum file AGE - exclude files newer than _n_ days/date.
                     (If _n_ < 1900 then _n_ = no of days, else _n_ = YYYYMMDD date).

              /FFT : Assume FAT File Times (2-second date/time granularity).
                     Use this when copying files to a linux NAS or other non-windows file system.

              /256 : Turn off very long path (> 256 characters) support.

 Copy options

 /COPY:_copyflag_[_s_] : What to COPY for FILES (default is /COPY:DAT)
                       (copyflags : **D**=Data, **A**=Attributes, **T**=Timestamps,
                                    **S**=Security=NTFS ACLs, **O**=Owner info, **U**=aUditing info)
                                    File Data (**D**) always includes file Timestamps (**T**).
  /DCOPY:_DCflag_[_s_] : What to COPY for Directories (default is /DCOPY:DA)
                       (DCflags : **D**=Data, **A**=Attributes, **T**=Timestamps,
                                  **E**=EAs, **X**=Skip alt data streams).
          /COPYALL : Copy ALL file info (equivalent to /COPY:DATSOU).
           /NOCOPY : Copy NO file info (useful with /PURGE).
          /NODCOPY : COPY No directory info (by default /DCOPY:DA is done).
              /SEC : Copy files with SECurity (equivalent to /COPY:DATS).

                /B : Copy files in Backup mode.
           /EFSRAW : Copy any encrypted files using EFS RAW mode.
                /L : List only - don’t copy, timestamp or delete any files.
              /MOV : MOVe files (delete from source after copying).
             /MOVE : Move files and dirs (delete from source after copying).
               /SJ : Copy Junctions as Junctions instead of the junction target.
               /SL : Copy file Symbolic Links instead of the SL target [see notes below].

 Performance tweaks

         /COMPRESS : Request [SMB network compression](https://www.youtube.com/watch?v=_iP3Dge1U6w) during file transfer, if applicable.
                /J : Copy using unbuffered I/O (recommended for large files).
        /NOOFFLOAD : Copy files without using the Windows [Copy Offload](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/hh831628(v=ws.11)?redirectedfrom=MSDN) mechanism.
            /IPG:_n_ : Inter-Packet Gap (ms), to free bandwidth on slow lines.
           /MT[:_n_] : Multithreaded copying, _n_ = no. of threads to use (1-128)
                     default = 8 threads, not compatible with /IPG and /EFSRAW
                     Redirecting output using /LOG is recommended for even better performance.

              /R:_n_ : Number of Retries on failed copies - default is 1 million.
              /W:_n_ : Wait time between retries - default is 30 seconds.
              /REG : Save /R:_n_ and /W:_n_ in the Registry as default settings.
              /TBD : Wait for sharenames To Be Defined (retry error 67).

  Destination options

    /A+:[RASHCNET] : Set file Attribute(s) on destination files + add.
    /A-:[RASHCNET] : UnSet file Attribute(s) on destination files - remove.
              /FAT : Create destination files using 8.3 FAT file names only.

           /CREATE : CREATE directory tree structure + zero-length files only.
              /DST : Compensate for one-hour DST time differences.
            /PURGE : Delete dest files/folders that no longer exist in source.
              /MIR : MIRror a directory tree - equivalent to /PURGE plus all subfolders (/E)

           /SECFIX : Update ACL file SECurity on [all](https://web.archive.org/web/20110317055316/http://blogs.technet.com/b/filecab/archive/2008/07/31/robocopy-mir-switch-mirroring-file-permissions.aspx) files, even skipped files.
                     When using /SECFIX, specify the type of security information you want to copy by
                     also using one of these options: /COPYALL  /COPY:O  /COPY:S  /COPY:U  /SEC

  Logging options

                /L : List only - don’t copy, timestamp or delete any files.
               /NP : No Progress - don’t display % copied.
          /unicode : Display the status output as Unicode text.
         /LOG:_file_ : Output status to LOG file (overwrite existing log).
      /UNILOG:_file_ : Output status to Unicode Log file (overwrite)
        /LOG+:_file_ : Output status to LOG file (append to existing log).
     /UNILOG+:_file_ : Output status to Unicode Log file (append).
              /TEE : Output to console window, as well as the log file.
               /TS : Include Source file Time Stamps in the output.
               /FP : Include Full Pathname of files in the output.
                     Minimising log output with the 'no' options below will speed up the copy.
               /NS : No Size - don’t log file sizes.
               /NC : No Class - don’t log file classes.
              /NFL : No File List - don’t log file names.
              /NDL : No Directory List - don’t log directory names.
              /NJH : No Job Header, ROBOCOPY © header.
              /NJS : No Job Summary: Stats for Copied,Skipped,Mismatch,Failed,Extras.
                /X : Report all eXtra files, not just those selected & copied.
                /V : Produce Verbose output log, showing skipped files.

 Job Options

      /JOB:_jobname_ : Read parameters from the named JOB file, e.g. multiple /XF _files_ /XD _dirs_ to exclude.
     /SAVE:_jobname_ : SAVE parameters to the named job file, this must be the last option, the command will not be run.
                     The .RCJ job file is an editable text file.
             /NOSD : NO Source Directory is specified.
             /NODD : NO Destination Directory is specified.
                       The command-line and job file cannot contain conflicting Source/Destination paths.
                       In the .RCJ job file, Source/Destination paths can be given as /SD:_path_ and /DD:_path_
                       /NOSD and /NODD can be used either on the command line or in the job file.
             /QUIT : QUIT after processing command line (to view parameters). 
               /IF : Include the following Files.

 Repeated Copy Options

            /MON:_n_ : MONitor source; run again when more than _n_ changes seen.
            /MOT:_m_ : MOnitor source; run again in _m_ minutes Time, if changed.
                     This will continue until you terminate the Robocopy process with Ctrl-C.
                     The Robocopy /MON process can also be started/stopped by setting the run hours, see below.
     /RH:_hhmm-hhmm_ : Run Hours - e.g. /RH:1800-0200
                     If the robocopy command is launched outside the given hours it will pause until the next start time.
               /PF : Check run hours on a Per File (not per pass) basis.

 Exclude/Include

               /XO : Exclude [Older](#fileclasses) - if destination file already exists and is the same date
                     or newer than the source, don’t overwrite it.
               /XC : Exclude [Changed](#fileclasses) files.
               /XN : Exclude [Newer](#fileclasses) files.
               /XL : Exclude "[Lonely](#fileclasses)" files and dirs (present in source but not destination)
                     This will prevent any new files being added to the destination.
               /XX : Exclude "[eXtra](#fileclasses)" files and dirs (present in destination but not source)
                     This will prevent any deletions from the destination. (this is the default)
                     Will also suppress listing extra destination files in the log.

/XF _file_ [_file_]... : Exclude Files matching given names/paths/wildcards.
/XD _dirs_ [_dirs_]... : Exclude Directories matching given names/paths.
                     XF and XD can be used in combination  e.g.
                     ROBOCOPY c:\source d:\dest /XF *.dmp "pagefile.sys" /XD "c:\System Volume Information" /S 

    /IA:[RASHCNETO] : Include files with any of the given Attributes.
    /XA:[RASHCNETO] : Exclude files with any of the given Attributes.

               /IM : Include modified files, copy if the Archive [attribute](attrib.html) is changed on both the source and destination.
                     By default robocopy ignores the Archive attribute and looks only at the file size and modified time.
               /IS : Include [Same](#fileclasses), overwrite files even if they are already the same.
               /IT : Include [Tweaked](#fileclasses) files.
               /XJ : Exclude Junction points from source. (included by default).
              /XJD : Exclude junction points from source directories.
              /XJF : Exclude junction points from source files.

            /MAX:_n_ : MAXimum file size - exclude files bigger than _n_ bytes.
            /MIN:_n_ : MINimum file size - exclude files smaller than _n_ bytes.
         /MAXLAD:_n_ : MAXimum Last Access Date - exclude files unused since _n_.
         /MINLAD:_n_ : MINimum Last Access Date - exclude files used since _n_.
                     (If n < 1900 then n = n days, else n = YYYYMMDD date).

 Advanced options  
            /BYTES : Print sizes as bytes.
            /DEBUG : Show debug volume information (undocumented)
              /ETA : Show Estimated Time of Arrival of copied files.
             /LFSM : Operate in "low free space" mode, enabling copy, pause and resume, see [notes](#lfsm) below.
      /LFSM:_n_[KMG] : /LFSM, specifying the floor size in [K:Kilo,M:Mega,G:Giga] bytes.
           /TIMFIX : FIX file TIMes on all files, even skipped files.
                /Z : Copy files in restartable mode (survive network glitch) use with caution as
                     this significantly reduces copy performance due to the extra logging.
               /ZB : Use restartable mode; if access denied use Backup mode. This option significantly
                     reduces copy performance because of checkpointing.

Robocopy [EXIT CODES](robocopy-exit.html)

By copying only the files that have changed, robocopy can be used to backup very large volumes.

If either the source or desination are a "quoted long foldername" **do not include a trailing backslash** as this will be treated as an [escape](syntax-esc.html) character, i.e. "C:\some path\" will fail but "C:\some path\" or "C:\some path\." or "C:\some path" will work.

If creating a progress logfile with /LOG , specify a destination [directory](md.html) that already exists, robocopy will create the file but will not create a log directory automatically.

/REG Writes to the registry at HKCU\Software\Microsoft\ResKit\Robocopy

/XX (exclude extra) If used in conjunction with /Purge or /Mir, the exclude extra switch will take precedence and prevent any files being deleted from the destination.

The Robocopy /MO 'Monitor source' option can be used to regularly copy new/changed files e.g. database transaction logs.

Running Robocopy commands under PowerShell will add quotation marks to the options creating an "invalid parameter" error, [[details](https://stackoverflow.com/questions/6714165/powershell-stripping-double-quotes-from-command-line-arguments)], this issue is fixed in the latest version of PowerShell 7.2. In most cases you will find it easier to write a simple batch file and call that from PowerShell.

Long FileNames
--------------

> When copying a large tree of multiple files and subfolders, it is likely some files will hit or even exceed the NTFS 256 character limit.
> 
> ROBOCOPY will accept **UNC** pathnames including [long pathnames](syntax-filenames.html) over 256 characters long.  
> Even though Robocopy successfully copies such files, choosing a destination folder with a shorter name than the source folder, can avoid issues such as difficulty accessing the files with Windows Explorer.
> 
> ROBOCOPY \work \backup_files\monday — destination needs 15 extra chars in path ✗
> 
> ROBOCOPY \workgroups \backup — destination is shorter than source ✓

Junctions and Symbolic Links
----------------------------

> For a Directory Symbolic Link, a Junction, or a Hard Link, RoboCopy /S (Copy Subfolders) will follow the source and copy the contents to a standard folder in the destination. For a backup program this is usually the desired behaviour.
> 
> For compatibility with old software the User Profile folder contains a number of Junction Points, '_Application Data_', '_My Documents_', _Recent_, _'Send To_' etc. These can be listed with DIR /ALL %userprofile%
> 
> To exclude Junction points from being copied you can use the options /XJ, /XJD, /XJF this will prevent the source files from being copied. The Junction Point itself will not be copied, with or without these flags.
> 
> /SL Will copy [symbolic links](mklink.html), this will copy a **File Symbolic Link** only, creating a new symbolic link at the destination.
> 
> An NTFS junction point in the **Destination** will not be deleted by RoboCopy, if you select any options which delete from the destination (/purge, /mir) and the destination contains a junction, RoboCopy will blindly follow that junction and delete the contents.  
> The /XJ options do not affect this as they only exclude junctions from the source.

File Attributes [RASHCNETO]
-----------------------------

> These options accept any combination of the following letters, when several are specified, will match if any or all items match:
> 
> R – Read only
> A – Archive
> S – System
> H – Hidden
> C – Compressed
> N – Not content indexed
> E – Encrypted
> T – Temporary
> O - Offline

Server 2016 Deduplicated files.
-------------------------------

> If you run Robocopy /MIR to mirror a system drive, it will attempt to delete 'dedup' files from \System Volume Information\ if also running in backup mode /B or /ZB it will have the permissions to actually delete them.  
> To avoid this either exclude \System Volume Information with /XD, or just avoid that combination of switches.

Performance
-----------

> Multithreaded copying with /MT:_n_ will improve [performance](https://andys-tech.blog/2020/07/robocopy-is-mt-with-more-threads-faster/) until the network and file system latency become the limiting factor, /MT:16 is a good place to start testing.
> 
> To limit the network bandwidth used by robocopy, specify the Inter-Packet Gap parameter /IPG:_n_  
> This will send packets of 64 KB each followed by a delay of _n_ Milliseconds.
> 
> Robocopy will fail to copy files that are locked by other users or applications, so limiting the number of retries with /R:0 will speed up copying by skipping any in-use files. The Windows Volume Shadow Copy service is the only Windows subsystem that can copy open files. Robocopy does not use the Volume Shadow Copy service, but it can backup a volume shadow that has already been created with VSHADOW or [DISKSHADOW](diskshadow.html).

NTFS Permissions
----------------

> /B (backup mode) will allow Robocopy to override file and folder permission settings (ACLs).
> 
> ERROR 5 (0x00000005) Changing File Attributes ... Access is denied  
> This error usually means that File/Folder permissions or Share permissions on either the source or the destination are preventing the copy, either change the permissions or run the command in backup mode with /B.
> 
> To run ROBOCOPY under a non-administrator account will require [SeBackupPrivilege](ntrights.html) (backup files privilege), to copy security information _[auditing](ntrights.html)_ [privilege](ntrights.html) is also required, plus of course you need at least _read_ access to the files and folders.
> 
> All versions of Robocopy will copy security information (ACLs) for files and directories, but will not copy ACL security changes unless the file itself has also changed. The /SEC /SECFIX options [can be used to refresh any ACL changes](https://web.archive.org/web/20150317054750/https://blogs.technet.com/b/filecab/archive/2008/07/31/robocopy-mir-switch-mirroring-file-permissions.aspx) even if the file/folder itself is unchanged.

File Classes
------------

> These file classes can be used to include/exclude files from the copy operation.
> 
> File Class
> 
> In source folder
> 
> In destination folder
> 
> Source/destination  
> File last modified times
> 
> Source/destination  
> File Sizes
> 
> Source/destination  
> File attributes
> 
> Lonely
> 
> **Yes**
> 
> No
> 
> n/a
> 
> n/a
> 
> n/a
> 
> Tweaked
> 
> Yes
> 
> Yes
> 
> Equal
> 
> Equal
> 
> **Different**
> 
> Same
> 
> Yes
> 
> Yes
> 
> Equal
> 
> Equal
> 
> Equal
> 
> Changed
> 
> Yes
> 
> Yes
> 
> Equal
> 
> **Different**
> 
> n/a
> 
> Newer
> 
> Yes
> 
> Yes
> 
> **Source newer than** Destination
> 
> n/a
> 
> n/a
> 
> Older
> 
> Yes
> 
> Yes
> 
> **Source older than** Destination
> 
> n/a
> 
> n/a
> 
> Extra
> 
> No
> 
> **Yes**
> 
> n/a
> 
> n/a
> 
> n/a
> 
> Mismatched
> 
> Yes (file)
> 
> Yes (directory)
> 
> n/a
> 
> n/a
> 
> n/a
> 
> 'Tweaked' files will only be identified and copied when the /IT option is used

Low Free Space Mode (LFSM)
--------------------------

> LFSM was added specifically for use with a target enabled for Azure File Sync cloud tiering. This switch is useful only for targets with tiered storage that might run out of local capacity before Robocopy finishes.
> 
> In LFSM mode, robocopy will pause whenever a file copy would cause the destination volume’s free space to go below a ‘floor’ value, which can be explicitly specified by the LFSM:_n_ form of the flag. If LFSM is specified with no explicit floor value, the floor is set to 10% of the destination volume’s size.
> 
> Low Free Space Mode is incompatible with the /MT, /EFSRAW, /B and /ZB options.  

Bugs
----

> Robocopy /MOVE or /PURGE can be used to delete empty folders by setting _source_ and _destination_ to the same folder, but this does not always deal with nested empty folders in a single pass. It will work if Windows Explorer is closed.
> 
> When copying files larger than 2 GB from some iSCSI/SAN volumes the copy operation may fill all available RAM and then stall out. This typically happens when the RAID virtual disk on the controller is set to _write-through_ caching rather than _write-back_ caching.  
> Copy utilities such as [TeraCopy](https://codesector.com/purchase) ($) and [BITS](../ps/bits.html) will workaround this issue because they copy the file in larger blocks, however the cost of this is that copying smaller files may then be slower than using Robocopy. The /IPG option may help with this issue.
> 
> If the /FAT option is used to copy files into a directory containing existing files with long filenames, if any short filenames match between source and destination, those files will be replaced, as you would expect, but the files will retain their old long filenames even if they don’t match the long filenames of the source file.

### Examples

Simple copy of all **files** from one folder to another:

ROBOCOPY \Server1\reports \Server2\backup

Copy all **files** and **sub-folders** (/S) but not any empty folders:

ROBOCOPY \Server1\source \Server2\dest /s /DCOPY:DAT

Copy Everything: all files, subfolders (even empty ones /E), NTFS ACL permissions, ownership, and file attributes. If this command is run repeatedly it will skip any files already in the destination, however this is not a true mirror as any files deleted from the source will remain in the destination. The *.* is optional as this is the default.

ROBOCOPY \Server1\reports \Server2\backup *.* /E /COPYALL /DCOPY:DAT

Copy all .jpg and .bmp files from one folder to another:

ROBOCOPY \Server1\reports \Server2\backup *.jpg *.bmp

List files over 32 MBytes in size:

ROBOCOPY C:\work /MAX:33554432 /L

Move files over 14 days old: (note the MOVE option will fail if any files are open and locked.)

ROBOCOPY C:\work C:\destination /move /minage:14

Backup a Server:  
The script below copies data from FileServ1 to FileServ2, the destination holds a full mirror along with file security info. When run regularly to synchronize the source and destination, robocopy will only copy those files that have changed (change in time stamp or size).

> @ECHO OFF  
> SETLOCAL
> 
> SET _source=\FileServ1\e$\users
> 
> SET _dest=\FileServ2\e$\BackupUsers
> 
> SET _what=/COPYALL /B /MIR /DCOPY:DAT  
> :: /COPYALL :: COPY ALL file info  
> :: /B :: copy files in Backup mode.  
> :: /MIR :: MIRror a directory tree.  
> :: /DCOPY:DAT :: Include Directory timestamps.
> 
> SET _options=/R:0 /W:0 /LOG:C:\batch\RoboLog.txt /NFL /NDL  
> :: /R:n :: number of Retries  
> :: /W:n :: Wait time between retries  
> :: /LOG :: Output log file  
> :: /NFL :: No file logging  
> :: /NDL :: No dir logging  
>   
> ROBOCOPY %_source% %_dest% %_what% %_options%

Run two robocopy jobs at the same time with [START](start.html) /Min

Start /Min "Job one" Robocopy \FileServA\C$\Database1 \FileServeBackupA\c$\Backups
Start /Min "Job two" Robocopy \FileServB\C$\Database2 \FileServeBackupB\c$\Backups

Copy only permission changes (additions and removals) assuming we already have a copy of the data:  
ROBOCOPY \FileServer\C$ \SVR-Backups\c$\Backups /E /Copy:S /IS /IT /DCOPY:DAT

_“One, a robot may not injure a human being, or through inaction, allow a human being to come to harm” - Isaac Asimov, Laws of Robotics from I. Robot, 1950_

### Related commands

[Robocopy EXIT CODES](robocopy-exit.html)  
[Robocopy /MIR switch](https://techcommunity.microsoft.com/t5/Storage-at-Microsoft/Robocopy-MIR-switch-8211-mirroring-file-permissions/ba-p/423662) – Security changes added to Robocopy in Windows Vista.  
[Set-LastWrite](../ps/syntax-lastmodified.html) - Reset Folder 'Last Modified' to the most recent file in the folder (PowerShell function).  
[DiskShadow](diskshadow.html) - Copy open files (Shadow copies).  
[COPY](../nt/copy.html) - Copy one or more files to another location.  
[DelTree](deltree.html) - Delete subfolders and files / delete empty folders.  
How-to: [Long filenames, NTFS and legal filename characters](syntax-filenames.html) ("\?\" prefix).  
[Convert KB/MB](../convert.html) - Bits and Bytes, bandwidth calculations.  
[KB4571748](https://support.microsoft.com/en-us/topic/august-20-2020-kb4571748-os-build-17763-1432-preview-fa1db909-8923-e70f-9aef-ba09edaee6f0) - Aug 2020 /COMPRESS option added and backported to 1809.  
[Q323275](https://web.archive.org/web/20130605115234/https://support.microsoft.com/kb/323275) - Copy Security info without copying files (/SECFIX or /COPY:S).  
[RichCopy free GUI copy utility](https://docs.microsoft.com/en-us/previous-versions/technet-magazine/dd547088(v=msdn.10)?redirectedfrom=SS64) - Ken Tamaru [MSFT] 2009.  
Equivalent PowerShell command: [BITS cmdlets](../ps/bits.html) - Background Intelligent Transfer Service.  
Equivalent bash command: [rsync](../bash/rsync.html) - Remote file copy (Synchronize file trees).



/. nt/route.html
========================================================

    Route - Manipulate network routing tables - Windows CMD - SS64.com

ROUTE.exe
=========

Manipulate network routing tables. Route packets of network traffic from one subnet to another by modifying the route table.

Syntax


    Display route details:
      ROUTE [-f] PRINT [_destination_host_] [MASK _subnet_mask_value_] [_gateway_] 
         [METRIC _metric_] [IF _interface_no_.]

    Add a route:
      ROUTE [-f] [-p] ADD [_destination_host_] [MASK _subnet_mask_value_] [_gateway_] 
         [METRIC _metric_] [IF _interface_no_.]

    Change a route:
      ROUTE [-f] CHANGE [destination_host] [MASK _subnet_mask_value_] [_gateway_] 
         [METRIC _metric_] [IF _interface_no_.]

    Delete a route:
      ROUTE [-f] DELETE [destination_host] [MASK _subnet_mask_value_] [_gateway_] 
         [METRIC _metric_] [IF _interface_no_.] 

Key
    -f          Clear (flush) the routing tables of all gateway entries.  If this is
               used in conjunction with one of the commands, the tables are
               cleared prior to running the command.

    _destination_host_
               The address (or set of addresses) that you want to reach.

    -p          Create a persistent route - survives system reboots.

    _subnet_mask_value_
               The subnet mask value for this route entry.
               This defines how many addresses are there.
               If not specified, it defaults to 255.255.255.255.

    _gateway_     The gateway.

    _interface_   The interface number (1,2,...) for the specified route.
               If the option \`IF interface_no\` is not given, ROUTE will try
               to find the best interface available.

    _metric_      The metric, ie. cost for the destination.

Note that routes added to the table are not made persistent unless the -p switch is specified. Non-persistent routes only last until the computer is rebooted.

Symbolic names used for Destination_Host are looked up in the network database file NETWORKS.  
  
The symbolic names for gateway are looked up in the host name database file HOSTS.  
  
If the command is PRINT or DELETE. Destination or gateway can be a wildcard ('*'), or the gateway argument can be omitted.  
  
An IP address mask of 0.0.0.0 means _everything_. (rather like the *.* wildcard). In other words it says: When matching this pattern, don’t worry about matching any of the bits - everything matches.  
  
If Destination_Host contains a * or ?, it is treated as a shell pattern, and only matching destination routes are printed. The '*' matches any string, and '?' matches any one char.

### Examples

157.*.1  
157.*  
127.*  
*224*

“Get your kicks on ROUTE 66” ~ Jack Kerouac.

### Related commands

[NETSTAT](netstat.html)-rn - Display TCP/IP network connections, routing and protocol statistics.  
[TRACERT](tracert.html) - Trace route to a remote host.  
Equivalent bash command (Linux): [ip route](../bash/ip-route.html) - Manipulate route table entries.



/. nt/run.html
========================================================

    Start ➞ Run Commands for Windows - Windows CMD - SS64.com

Windows Start ➞ Run commands
============================

Description

Run Command

Accessibility Options

    utilman  
    or  
    control access.cpl

Add Hardware Wizard

    hdwwiz

Programs and Features  
(Add New Programs)  
(Add Remove Windows Components)  
(Set Program Access & Defaults )

    appwiz.cpl  
    control appwiz.cpl,,1  
    control appwiz.cpl,,2  
    control appwiz.cpl,,3

Administrative Tools

    control admintools

Advanced User Accounts Control Panel

    netplwiz

Authorization Manager

    azman.msc

Automatic Update

    control wuaucpl.cpl

Backup and Restore Utility

    sdclt

Bluetooth Transfer Wizard

    fsquirt

Calculator

    calc

Certificate Manager

    certmgr.msc

Character Map

    charmap

Check Disk Utility

[chkdsk](chkdsk.html)

Clear Type (tune or turn off)

    cttune

Color Management

    colorcpl.exe

Command Prompt

[cmd](cmd.html)

Component Services

    dcomcnfg  
    or  
    comexp.msc

Computer Management

    CompMgmtLauncher.exe  
    or  
    compmgmt.msc  

Control Panel

    control

Credential (passwords) Backup and Restore Wizard

    credwiz

Data Execution Prevention

    SystemPropertiesDataExecutionPrevention

Date and Time Properties

    timedate.cpl

Device Manager

    hdwwiz  
    or  
    devmgmt.msc  

Device Pairing Wizard

    DevicePairingWizard

Digitizer Calibration Tool (Tablets/Touch screens)

    tabcal

Direct X Control Panel (if installed)

    directx.cpl

Direct X Troubleshooter

    dxdiag

Disk Cleanup Utility

    cleanmgr

Disk Defragmenter

    dfrgui  
    defrag

Disk Management

    diskmgmt.msc

Disk Partition Manager

    diskpart

Display Color Calibration

    dccw

Display DPI / Text size

    dpiscaling

Display Properties (Themes, Desktop, Screensaver)

    control desktop

Display Properties (Resolution, Orientation)

    desk.cpl

Display Properties (Color & Appearance)

    control color

Documents (open 'My Documents' folder)

    documents

Downloads (open 'Downloads' folder)

    downloads

Driver Verifier Utility

    verifier

DVD Player

    dvdplay

Edit Environment Variables

    rundll32.exe sysdm.cpl,EditEnvironmentVariables

Encrypting File System Wizard (EFS)

    rekeywiz

Event Viewer

    eventvwr.msc

File Signature Verification Tool (Device drivers)

    sigverif

Files and Settings Transfer Tool

    %systemroot%\system32\migwiz\migwiz.exe

Firewall Control Panel

    firewall.cpl

Folders Properties

    control folders

Fonts list  

    control fonts  

Font preview

    fontview arial.ttf

Game Controllers

    joy.cpl

Local Group Policy Editor

    gpedit.msc

Internet Properties

    inetcpl.cpl

IP Configuration

    ipconfig

iSCSI Initiator configuration

    iscsicpl

Keyboard Properties

    control keyboard

Language Pack Installer

    lpksetup

Local Security Policy

    secpol.msc

Local Users and Groups

    lusrmgr.msc

Log out

    logoff

Microsoft Malicious Software Removal Tool

    mrt

Microsoft Management Console

    mmc

Access (Microsoft Office)

    msaccess

Excel (Microsoft Office)

    Excel

Powerpoint (Microsoft Office)

    powerpnt

Word (Microsoft Office)

    winword

Microsoft Paint

    mspaint

Microsoft Support Diagnostic Tool

    msdt

Mouse Properties

    control mouse  
    or  
    main.cpl

Network Connections

    control netconnections  
    or  
    ncpa.cpl

Projector:  
Connect to Network Projector  
Switch projector display

    netproj  
  
    displayswitch

Notepad

    notepad

ODBC Data Source Admin  
Default ODBC driver:  
32-bit ODBC driver under 64-bit platform:  

    C:\windows\system32\odbcad32.exe  
    C:\windows\sysWOW64\odbcad32.exe  

ODBC configuration - Install/configure MDAC drivers

    odbcconf

On Screen Keyboard

    osk

OOB Getting Started

    gettingstarted

Password - Create a Windows Password Reset Disk (USB)

    "C:\Windows\system32\rundll32.exe" keymgr.dll,PRShowSaveWizardExW

Password - Change Password

    C:\Windows\explorer.exe shell:::{2559a1f2-21d7-11d4-bdaf-00c04f60b9f0}

Pen and Touch (Tablet/Pen input configuration)

    tabletpc.cpl

Performance Monitor

    perfmon.msc ('perfmon [/rel](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/perfmon)' for the Reliability Monitor)

Phone and Modem Options

    telephon.cpl

Phone Dialer

    dialer

Power Configuration

    powercfg.cpl and [powercfg.exe](powercfg.html)

Presentation Settings

    PresentationSettings

**Problem Steps Recorder**

[psr](https://windows.microsoft.com/en-gb/windows7/how-do-i-use-problem-steps-recorder)

Program Access and Computer Defaults - browser / email / media

    computerdefaults

Printers and Faxes

    control printers

Print Management (.msc)

    PrintManagement

Printer Migration (backup/restore)

    printbrmui and [printbrm.exe](printbrm.html)

Printer user interface (List all printui.dll options)

    printui

Private Character Editor

    eudcedit

Regional Settings - Language, Date/Time format, keyboard locale.

    intl.cpl

Registry Editor

    regedit

Remote Assistance

    msra

**Remote Desktop**

    mstsc

Resource Monitor

    resmon

Resultant Set of Policy

    rsop.msc

Settings (Windows 10)

    ms-settings:

Scheduled Tasks

    control schedtasks

Screenshot Snipping Tool

    snippingtool

Security Center

    wscui.cpl

Services

    services.msc

Shared Folder Wizard

    shrpubw

Shared Folders

    fsmgmt.msc

Shut Down Windows

    shutdown

Software Licensing/Activation

    slui

Sounds and Audio

    mmsys.cpl

Sound Recorder

    soundrecorder

Sound Volume

    sndvol

Syncronization Tool (Offline files)

    mobsync

System Configuration Utility

    msconfig

System File Checker Utility (Scan/Purge)

    sfc

System Information

    msinfo32

System Properties  

    sysdm.cpl SystemProperties  
    or  
    sysdm.cpl DisplaySYSDMCPL  

System Properties - Performance

    SystemPropertiesPerformance

System Properties - Hardware

    SystemPropertiesHardware

System Properties - Advanced

    SystemPropertiesAdvanced

System Repair - Create a System Repair Disc

    recdisc

System Restore

    rstrui.exe

Task Manager

    taskmgr

Task Scheduler

    taskschd.msc

Telnet Client

    telnet

Trusted Platform Module Initialization Wizard

    tpmInit

  
User Accounts (Autologon)

    control userpasswords2

User Account Control (UAC) Settings

    UserAccountControlSettings

User Profiles - Edit/Change type

    C:\Windows\System32\rundll32.exe sysdm.cpl,EditUserProfiles

Windows Disc Image Burning Tool

    isoburn C:\movies\madmax.iso

Windows Explorer

    explorer.exe  
    explorer.exe .  Will open at the current directory

Windows Features

    optionalfeatures

Windows Firewall  
Windows Firewall with Advanced Security

    firewall.cpl  
    wf.msc

Windows Image Acquisition (scanner)

    wiaacmgr

Windows Magnifier

    magnify

Windows Management Infrastructure

    wmimgmt.msc

Windows Memory Diagnostic Scheduler

    mdsched

Windows Mobility Center (Mobile PCs only)

    mblctr

Windows [PowerShell](../ps/)

    powershell

Windows PowerShell ISE

    powershell_ise

Windows Security Action Center

    wscui.cpl

Windows Script Host([VBScript](../vb/))

    wscript _NAME_OF_SCRIPT_.VBS

Windows System Security Tool. Encrypt the SAM database.  
(boot password.)

    syskey

Windows Update

    wuapp

Windows Update Standalone Installer

    wusa

Windows Version ([About Windows](syntax-settings.html))

    winver

WordPad

    write

Unless indicated otherwise, all the commands above work in all versions of Windows from Vista upwards.  
Most of these utilities can be found in %systemroot%\System32\

_“The Macintosh uses an experimental pointing device called a 'mouse.' There is no evidence that people want to use these things” ~ John Dvorak_

### Related commands

How-to: [ms-settings](syntax-settings.html) - Shortcuts to settings.  
How-to: [Shell: folder](shell.html) - Shortcuts to key folders.  
How-to: [Keyboard shortcuts](syntax-keyboard.html) For CMD, PowerShell and Windows.  
How-to: [MMC Snap-ins](syntax-mmc.html) - Admin commands.  
How-to: [ProfileFolders](syntax-folders.html) - Location of user profile folders.  
How-to: [Run a script](syntax-run.html) - How to create and run a batch file.  
[START](start.html) - Start a program, command or batch file.  
[EXPLORER](explorer.html) - Open Windows Explorer.



/. nt/runas.html
========================================================

    Runas - Run under a different user account - Windows CMD - SS64.com

RUNAS
=====

Execute a program under a different user account (non-elevated).

Syntax

      RUNAS [ [/noprofile | /profile] [/env] [/savecred | /netonly] ]
         /**user**:_UserName_ _program_

      RUNAS [ [/noprofile | /profile] [/env] [/savecred] ]
         /**smartcard** [/user:_UserName_] _program_

      Display the trust levels that can be used:
      RUNAS **/showtrustlevels**

      Run a program at a given TrustLevel:
      RUNAS /**trustlevel**:_TrustLevel_ _program_

Key
    /noprofile       Do not load the user's profile.
                    This causes the application to load more quickly, but
                    can cause some applications to malfunction.

    /profile         Load the user's profile. (default)

    /env             Use the current environment instead of user's.

    /netonly         Use the credentials for remote access only.

    /savecred        Use credentials previously saved by the user.

    /smartcard       Load the credentials from a smartcard.

    /user            _UserName_ in the form USER@DOMAIN or DOMAIN\USER

    /trustlevel _Level_  One of levels enumerated in /showtrustlevels.
                      RunAs is not able to launch an application with an [elevated](syntax-elevate.html)
                      access token.

    _program_          The program to run.

Enter the password when prompted.  
/profile is not compatible with /netonly.  
/savecred is not compatible with /smartcard.

When you start a program with RunAs /netonly, the program will execute on your local computer as the user you are currently logged on as, but any connections to other computers on the network will be made using the user account specified.

Without /netonly everything will run under the user account specified.

The RUNAS command unlike most other CMD and DOS commands [requires](https://devblogs.microsoft.com/oldnewthing/20110815-00/?p=9903) that it’s command line is quoted, it uses the regular C runtime library command line parser. This also means that RUNAS requires the backslash \ as an [escape](syntax-esc.html) character, not the standard ^ escape used by other CMD commands.

RunAs Reqires the "Secondary Logon" [service](syntax-services.html) to be running.

The error level %ERRORLEVEL% returned by RunAs: success = 0, failure = 1

Run with Elevated permissions
-----------------------------

> In Windows Vista and above, you can run a script with elevated permissions by right clicking and choosing "Run As Administrator"
> 
> The RunAs command predates elevation, so it has no switch for running an elevated command.  
> Alternatives: invoke the UAC dialogue by calling the VBScript function [.ShellExecute](../vb/shellexecute.html)  
> or call PowerShell.exe [-Verb runAs](../ps/syntax-elevate.html)
> 
> If you are already running elevated, for example an elevated CMD shell, then RUNAS will launch an application as elevated, but this is equally true just running a command without RUNAS, it makes no difference.
> 
> When a script is [run with elevated permissions](../vb/syntax-elevate.html) several aspects of the user environment will change: The current directory, the current TEMP folder and any mapped drives will be disconnected.

RunAs from Windows Explorer
---------------------------

> Select an executable file, Shift-Right-click and select **Run As..  
> **This option can be hidden by setting  
> HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer  
> HideRunAsVerb=1

RunAs to force a password Sync
------------------------------

> If you are connecting to a remote network/VPN and the remote/domain password gets out of sync with the local machine, use RunAs to open a second prompt explicitly passing the domain and username to force a password sync.
> 
> *   runas /user:_SS64Dom__User64_ cmd.exe
> *   Enter the domain password.
> *   Wait a few minutes until you see the notification area pop-up: "_Windows Needs Your Current Credentials Please lock this computer, then unlock it using your most recent password or smart card_.

### Examples

Run notepad.exe as the user Jdoe on domain SS64dom with no profile:

C:> Runas /noprofile /user:SS64Dom\jDoe "notepad.exe"

Run CMD.exe as the Administrator on the local machine Dellpc64:

C:> Runas /profile /user:DELLPC64\administrator CMD

Run Notepad.exe as 'Natasha' on domain SS64dom using the current environment, and open a file, escape the quote characters around the filename with \ :

C:> Runas /profile /env /user:SS64Dom\natasha "notepad \"C:\work\demo file.txt\""

Run Active Directory Users and Computers (dsa.msc) as the user Jdoe on domain SS64dom:

C:> Runas /env /user:SS64Dom\jDoe "START %windir%\system32\dsa.msc"

“He who reigns within himself, and rules passions, desires, and fears, is more than a king” ~ Milton

### Related commands

[PsExec](psexec.html) - Execute process remotely.  
[ShellRunAs](shellrunas.html) - Run a command under a different user account.  
[START](start.html) - Start a program, command or batch file.  
How-to: [Run with elevated permissions](syntax-elevate.html)  
How-to: [Logon Types](syntax-logon-types.html) - Windows Logon types.  
[Aaron Margosis](https://blogs.msdn.microsoft.com/aaron_margosis/) - Running with least privilege.  
[joeware.net](https://www.joeware.net/freetools/) - CPAU (Create Process As User) like RunAs but with an options to encrypt the password.  
PowerShell: [Run As Admin / elevation](../ps/syntax-elevate.html)  
Equivalent bash command (Linux): [SU](../bash/su.html) - Switch User.



/. nt/rundll32.html
========================================================

    RunDLL32 - Windows CMD - SS64.com

RunDLL32.exe
============

Run a 32 bit DLL function.  
Rundll32 is available on all version of Windows from Windows 95 onwards, but only runs in 32 bit mode.

Syntax

       RUNDLL32.EXE _dll_name_**,**_EntryPoint_ [_optional_arguments_]

Key
    _dll_name_     A full path to the DLL to ensure that the correct one is found.
                For best results, use the short file name.

    _EntryPoint_   The name of the entry point function.

The _dll_name_ and the _EntryPoint_ function name can be separated by either a space ( ) or a comma (,)

In some cases two or more commas are required, for example here we pass the value 1 as the second argument to Intl.cpl:

Rundll32.exe shell32.dll,Control_RunDLL Intl.cpl,,1

DLL options may be case sensitive, Rundll32 may also fail if there is any additional white space in between the _dll_name_, the comma, and the _EntryPoint_ function. If you pass the wrong type of DLL to Rundll32, it may fail to run without returning any error message.

Rundll32 was originally designed only for internal use at Microsoft. It can be used generally but requires the DLL being called to include a suitable function signature to match the operation you are calling. See the full details in [Q164787](https://support.microsoft.com/en-gb/help/164787/info-windows-rundll-and-rundll32-interface).

The internet has many lists of Rundll32 'cheat codes' [[example](https://www.tenforums.com/tutorials/77458-rundll32-commands-list-windows-10-a.html)], that do mostly work, but many are calling an invalid or missing function signature. This means there is a chance they may stop working (or start working in a _different_ way) after some future Windows update.  
There are often more robust methods to achieve the same thing such as [Start Run](run.html) commands or [Shell: folder](shell.html) shortcuts.  

### Examples

Add a Network Printer:  
RUNDLL32 printui.dll,PrintUIEntry /ia /c\server /m "AGFA-AccuSet v52.3"  
   /h "Intel" /v "Windows 2000" /f %windir%\inf\ntprint.inf  
  
Add a Local Printer:  
RUNDLL32 printui.dll,PrintUIEntry /if /b "Test Printer" /c\SERVER  
   /f "%windir%\inf\ntprint.inf" /r "lpt1:" /m "AGFA-AccuSet v52.3"  
  
Add a printer connection that's available to anyone who logs on:  
Rundll32 printui.dll,PrintUIEntry /ga /n\Server\PrintShare

Display the per-Machine printer connections:  
RUNDLL32 printui.dll,PrintUIEntry /ge /c"\workstation64"  
  
Display all the available commands for PRINTUI.DLL - add/remove print drivers, print queues, preferences, properties etc:  
RUNDLL32 printui.dll,PrintUIEntry /?  
  
Clear IE Tracks:

RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess _number_

> where _number_ is one (or several added) of the following values:
> 
>    1   Browsing History
>    2   Cookies
>    4   Temporary Internet Files
>    8   Offline favorites and download history
>   16   Form Data
>   32   Passwords
>   64   Phishing Filter Data
>  128   Web page Recovery Data
>  256   Do not Show GUI when running the cache clear
>  512   Do not use Multi-threading for deletion
> 1024   Valid only when browser is in private browsing mode
> 2048   Tracking Data
> 4096   Data stored by add-ons
> 8192   Preserve Cached data for Favorite websites

Lock workstation:  
RUNDLL32.exe user32.dll, LockWorkStation  
n.b. this is an unsupported hack, which may fail in the future - [details on oldnewthing](https://devblogs.microsoft.com/oldnewthing/?p=41043)  
A PowerShell function: [Lock-WorkStation](https://community.idera.com/database-tools/powershell/powertips/b/tips/posts/locking-workstation) is supported.

“If you're rich you can buy books. If you're poor, you need a library” ~ John Kenneth Galbraith  

### Related commands

[Qchange.vbs](../vb/syntax-qchange.html) - Change Printer Connection.  
[PRNCNFG](prncnfg.html) - Configure or rename a printer.  
[PRNMNGR](prnmngr.html) - Add, delete, list printers and printer connections.  
[REGSVR32](regsvr32.html) - Register or unregister a DLL.  
[WMIC PRINTER](wmic.html) - Set printing options through WMI.  
[Q164787](https://support.microsoft.com/en-gb/help/164787/) - Rundll32 command line.  
PowerShell: [Get-CIMinstance](../ps/get-ciminstance.html) - Get WMI information.



/. nt/sc.html
========================================================

    SC - Service Control - Windows CMD - SS64.com

SC.exe
======

Service Control - Create, Start, Stop, Query or Delete any Windows [SERVICE](syntax-services.html). The command _options_ for SC are case sensitive.

Syntax

      SC [\_server_] [_command_] [_service_name_] [_Options_]

Key
    _server_       : The machine where the service is running

    _service_name_ : The KeyName of the service, this is often but not always
                  the same as the DisplayName shown in Control Panel, Services.
                  You can get the KeyName by running: 
                     SC GetKeyName _DisplayName_

    _command_s:
          **query**  [_qryOpt_]   Show status.
          queryEx [_qryOpt_]  Show extended info - pid, flags.
          GetDisplayName    Show the DisplayName.
          GetKeyName        Show the Service KeyName.
          EnumDepend        Show Dependencies.
          qc                Show config - dependencies, full path etc.
          **start**          START a service.
          **stop**           STOP a service
          pause          PAUSE a service.
          continue       CONTINUE a service.
          create         Create a service. (add it to the registry).
          **config**         permanently change the service configuration.
          delete         Delete a service (from the registry).
          control        Send a control to a service.
          interrogate    Send an INTERROGATE control request to a service.
          Qdescription   Query the description of a service.
          description    Change the description of a service.
          Qfailure       Query the actions taken by a service upon failure.
          failure        Change the actions taken by a service upon failure.
          sdShow         Display a service's security descriptor using SDDL.
          SdSet          Sets a service's security descriptor using SDDL.

    _qryOpt_:
          type= driver|service|all
                         Query specific types of service.
          state= active|inactive|all
                         Query services in a particular state only.
          bufsize= _bytes_ 
          ri= _resume_index_number_ (default=0)
          group= _groupname_
                         Query services in a particular group.

    _Misc command_s that don’t require a service name:
          SC  QueryLock  Query the LockStatus for the ServiceManager Database.
                         This will show if a service request is running.
          SC  Lock       Lock the Service Database.
          SC  BOOT       Values are {ok | bad} Indicates whether to save  
                         the last restart configuration as the \`last-known-good\`
                         restart configuration.
    Options
     The CREATE and CONFIG commands allow additional service options to be set
     e.g. to disable a service: SC config "Name of Service" start= disabled
     see the built-in help for more: 'SC create' and 'SC config'

The qryOpt options above are case sensitive, they must be entered in lower case, also the position of spaces and = must be exactly as shown.

Kernel device drivers are not displayed in the Windows Control Panel ➞ Services but can be displayed by SC.

The SC command duplicates some aspects of the [NET](net.html) command but adds the ability to create a service.

Query a Service state
---------------------

> SC query will display if a service is running, giving output like this:
> 
>      SERVICE_NAME       : messenger
>      TYPE               : 20  WIN32_SHARE_PROCESS
>      STATE              : 4  RUNNING
>                              (STOPPABLE,NOT_PAUSABLE,ACCEPTS_SHUTDOWN)
>      WIN32_EXIT_CODE    : 0  (0x0)
>      SERVICE_EXIT_CODE  : 0  (0x0)
>      CHECKPOINT         : 0x0
>      WAIT_HINT          : 0x0
> 
> To retrieve specific information from SC's output, [pipe](syntax-redirection.html) into [FIND](find.html) or [FindStr](findstr.html)  
> e.g.
> 
>   C:> SC query messenger | FIND "STATE" | FIND "STOPPED"
> 
>   C:> SC query messenger | FIND "STATE" | FIND "RUNNING"
> 
> The statements above will return an [%ERRORLEVEL%](errorlevel.html) = 1 if the text is not found
> 
> IF errorlevel 1 GOTO :my_subroutine  
> The [NET](net.html) START command can be used in a similar way to check if a service is running:
> 
>    NET START | FIND "Service name" > nul
>    IF errorlevel 1 ECHO The service is not running
> 
> Watch out for extra spaces:  
> SC QUERY state= all Works  
> SC QUERY state =all Fails!

Start a Service
---------------

> Start the schedule service:
> 
> SC start schedule
> 
> The service control manager will normally wait up to 30 seconds to allow a service to start, you can modify this time (30,000 milliseconds) in the registry
> 
> HKLM\SYSTEM\CurrentControlSet\Control  
> ServicesPipeTimeout (REG_DWORD)
> 
> Some options only take effect at the point when the service is started e.g. the SC config command allows the executable of a service to be changed. When the service next starts up it will run the new executable. Config changes requires the current user to have “permission to configure the service”.

PowerShell
----------

> Like every other [external](syntax-internal.html) command SC can be run under PowerShell instead of CMD, however there is one extra complication for SC and that is the standard PowerShell alias SC which redirects to the [Set-Content](../ps/set-content.html) cmdlet.
> 
> To avoid that, use the [call](../ps/call.html) operator to run SC.exe from PowerShell:
> 
> & sc.exe

### Examples

 SC GetKeyName "task scheduler"
 SC GetDisplayName schedule 
 SC start schedule
 SC QUERY schedule
 SC CONFIG "Schedule" start= disabled
 SC QUERY type= driver
 SC QUERY state= all |findstr "DISPLAY_NAME STATE" >svc_installed.txt 
 SC \myServer CONFIG myService obj= LocalSystem password= mypassword
 SC CONFIG MyService binPath=c:\myprogram.exe obj=".\LocalSystem" password=""

Disable Windows Update (Windows 10)

 SC config wuauserv start= disabled
 NET stop wuauserv

 SC config bits start= disabled
 NET stop bits

 SC config dosvc start= disabled
 NET stop dosvc

To re-enable Windows Update set the start= back to auto and start the services.

Enable remote registry access on computer64:

 SC \computer64 config remoteregistry start= auto
 SC \computer64 start remoteregistry

“There is always room at the top” ~ Daniel Webster

### Related commands

DELSRV - Delete a service.  
INSTSRV - Install a service (run under a specific account).  
[NET](net.html) - manage network resources.  
[PsService](psservice.html) - View and control services.  
Svcmon - Monitor services and raise an alert if they stop. ([Win 2K ResKit](../links/windows.html#kits))  
[SUBINACL](subinacl.html) - Set service permissions.  
[WMIC SERVICE](wmic.html) - WMI access to services.  
[Win32_Service class](service-errors.html) error return codes.  
[List of Windows Services](syntax-services.html)  
[Q251192](https://support.microsoft.com/en-gb/help/251192/) - Create a Windows Service using SC.  
[Q166819](https://web.archive.org/web/20130730182634/http://support.microsoft.com:80/kb/166819) - Control Services Remotely.  
[Q170738](https://web.archive.org/web/20070703215229/https://support.microsoft.com/kb/170738) - Debug a Windows Service.  
Equivalent PowerShell: [Get-Service](../ps/get-service.html) - Get a list of services / [Invoke-CimMethod](../ps/invoke-cimmethod.html) - start/stop services via CIM.  
Equivalent bash command (Linux): [nice](../bash/nice.html) - Change job scheduling priority.



/. nt/schtasks.html
========================================================

    Schtasks - Scheduled tasks - Windows CMD - SS64.com

SCHTASKS
========

Create / edit a Scheduled Job/Task. The job can be created on the local or a remote computer.

Syntax:

    Create a new scheduled task:
    SCHTASKS /Create [_Connect_Options_] _Create_Options_ /TN _taskname_

    Delete the scheduled task(s)
    SCHTASKS /Delete [_Connect_Options_] /TN _taskname_ [/F]
   
    Display one or all scheduled tasks:
    SCHTASKS /Query  [_Connect_Options_] [/FO _format_ | /XML] [/NH] [/V] [/TN _taskname_]
   
    Run the scheduled task on demand:
    SCHTASKS /Run [_Connect_Options_] /TN _taskname_

    Stop the currently running scheduled task:
    SCHTASKS /End [_Connect_Options_] /TN _taskname_

    Change the properties of scheduled task, Enable or Disable a task:
    SCHTASKS /Change [_Connect_Options_] {[/RU _username_] [/RP _password_] [/TR _taskrun_]} /TN taskname
      [/ST _starttime_]  [/RI _interval_] [ {/ET _endtime_ | /DU _duration_} [/K] ] [/SD _startdate_] [/ED _enddate_]
         [/ENABLE | /DISABLE] [/RL _level_] [/IT] [/Z]

    Show the security identifier corresponding to a scheduled task name:
    SCHTASKS /ShowSID [_Connect_Options_] /TN _taskname_

 _Connect_Options_:
     /S _system_                      # Remote system (default is local)
    [/U _username_ [/P _password_]]     # Submit job under this name

 _Create_Options_:
    /TN _taskname_                    # A name which uniquely identifies the scheduled task.
    /TR _taskrun_                     # Pathname of the executable to run.
    [/ST _starttime]_                 # HH:MM (24 hour)
    [/RU _username_ [/RP _password_]]   # Run job as this user.
    /SC _schedul_e                    # The schedule frequency:
                                        MINUTE, HOURLY, **DAILY**, WEEKLY, MONTHLY, ONCE, ONSTART,ONLOGON,ONIDLE.
    [/MO _modifier_]                  # When to run:
          MINUTE:  1 - 1439 minutes.
          HOURLY:  1 - 23   hours.
          DAILY:   1 - 365  days.
          WEEKLY:  1 - 52   weeks.
          ONCE:             No modifiers.
          ONSTART:          No modifiers, runs every time the system starts. Optionally specify a start date.
          ONLOGON:          No modifiers, runs whenever a user (any user) logs on. Optionally specify a start date.
          ONIDLE:           No modifiers. Specify a start date, or run the next time the system is idle.
          MONTHLY: 1 - 12, or FIRST, SECOND, THIRD, FOURTH, LAST, LASTDAY.
          ONEVENT: XPath event query string.

    [/D _day_]                        # Day = MON,TUE,WED,THU,FRI,SAT,SUN
    [/M _months_]                     # Month=JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC.
    [/I _idletime_]                   # 1 - 999 minutes (ONIDLE task only)
    [/SD _startdate_] [/ED _enddate_]   # Start / End date in Region specific format e.g. "12/12/2015"

    [/RI _interval_]                  # Repetition Interval in minutes. 
                                      N/A for schedule types: MINUTE, HOURLY, ONSTART, ONLOGON, ONIDLE, and ONEVENT.
                                      If either /ET or /DU is specified, the default is 10 minutes.
                                      Range is 1 - 599940 minutes.

    [/DELAY _delaytime_]              # Specify the wait time to delay the task after the trigger is fired.
                                      This option is only valid for schedule types ONSTART, ONLOGON, and ONEVENT.
                                      The time format is mmmm:ss.

    [/EC _ChannelName_]               # Specify the event channel for an ONEVENT trigger.
    [/RL _level_]                     # Set the run level for the task. LIMITED or HIGHEST. Default= LIMITED. 
    [{/ET _endtime_ | /DU _duration_} ] # End time/Duration to run as HH:mm (24-hour time). e.g. 14:50
    [/F]                            # Force, create the task and suppress warnings if the specified task already exists.
    [/K]                            # Kill/Terminate the task at the end time or duration time.
                                      N/A for schedule types: ONSTART, ONLOGON, ONIDLE, and ONEVENT. Either /ET or /DU must be specified.

    [/NP]                           # No password is stored. The task will not run interactively as the given user.
                                      Only local resources are available.

    [/XML _xmlfile_]                  # Create a task from an XML file. (These are found in the 'Tasks' folder)
                                      This can be combined with /RU and /RP switches, or with the /RP switch alone when
                                      the task XML already contains the principal. 

    [/V1]]                          # Create a task visible to Windows 2000, 2003, and XP.
    [/IT]                           # Interactive, enable the task to run interactively only if /RU _user_ is
                                      currently logged on at the time the task runs. The task runs only if the user is logged on.
    [/Z]                            # Delete the task after its final run.

 _Query Options_:

    /FO   Output format: TABLE, LIST, CSV
    /NH   No header
    /V    Verbose output

For MONTHLY schedules give the DAY as a number 1 - 31 (default=1)  
  
To prompt for the password, specify /RP * or /RP none

The User Account under which the Schedule service runs will require specific file access permissions, user permissions and drive mappings.

If the /RU _username_ and /RP _Password_ parameters match the currently logged-in user, the task will run interactively (visible in the foreground).  
  
For the system account, /RU _username_ can be written as "", "NT AUTHORITY\SYSTEM" or "SYSTEM", a Password is not required. The system account has full access to the local machine but has no permissions on any other machines (or mapped drives) across the Network.

The new task must be set to start a minimum of 1 minute into the future.

In the Task Scheduler GUI the task properties include a tick box for "Hidden", this does not minify or hide the command window, but does hide the task from Task Scheduler's list of tasks. (The menu View > Show hidden tasks is by default ticked.)  
To run a command script and hide the window from appearing, call the task using [VBScript.Run](../vb/run.html)

By default SCHTASKS event logs are disabled. They can be enabled if needed using [WEVUTIL](wevtutil.html).

PowerShell cmdlets
------------------

> SCHTASKS.exe is limited to commands with less than 255 characters and does not have access to all of Scheduler 2.0 options such as "_Wake up the machine to run this task_".
> 
> These additional options are available via the GUI or by using the [Task Scheduler PowerShell cmdlets](../ps/scheduler.html).

UAC (User Account Control) prompts.
-----------------------------------

> If a scheduled task invokes a UAC prompt, then the task will fail to run unattended.  
> To prevent this make sure that you select the '_Run With Highest Privileges_' check box:
> 
> ![Elevate Scheduled task](elevate.png)

Other languages.
----------------

> If you are running a non-english language version of Windows then the Days and Months accepted by SCHTASKS might be localised.  
> e.g. Italian days: lun, mar, mer, gio, ven, sab, dom Italian months: gen, feb, mar, apr, mag, giu, lug, set, ott, nov, dic.

### Examples

Create a task to run at 11 pm every weekday

SCHTASKS /Create /SC weekly /D MON,TUE,WED,THU,FRI /TN MyDailyBackup /ST 23:00 /TR c:\backup.cmd /RU MyDomain\MyLogin /RP MyPassword

Now delete the task:

SCHTASKS /Delete /TN "MyDailyBackup" /f

Create a one-off task to run a script at exactly12 midday:

SCHTASKS /create /tn "once only" /tr "**\"**c:\my folder\one.cmd**\"** arguments" /sc ONCE /sd 12/29/2014 /st 12:00

From PowerShell create a new task called 'GetFridayData' to run a PowerShell script every Friday at 18:30:

PS C:> $Taskpath = "%SystemRoot%\system32\WindowsPowerShell\v1.0\powershell.exe -command 'C:\batch\friday.ps1'" 
PS C:> SCHTASKS /create /SC weekly /ST 18:30 /D FRI /TN GetFridayData /tr $Taskpath

Create a daily task to run a script at 5 pm:

SCHTASKS /create /tn "My Script" /tr "**\"**c:\my folder\script.cmd**\"** arguments" /sc daily /sd 12/29/2014 /st 17:00

Create a task ready to run on demand - this is done by creating a task scheduled far in the past:  

SCHTASKS /create /tn "On demand demo" /tr "C:\Windows\notepad.exe" /sc ONCE /sd 01/01/1910 /st 00:00

Task Scheduler options are stored in the registry

HKLM\SOFTWARE\Microsoft\SchedulingAgent\

_“We don’t wake up for less than $10,000 a day” ~ Linda Evangelista_

### Related commands

[Q823093](https://support.microsoft.com/en-us/help/823093/) - Scheduled task does not run when the Path contains a space.  
[WAITFOR](waitfor.html) - Wait for or send a signal.  
[POWERCFG](powercfg.html) /WakeTimers - Configure power settings, list wake timers.  
PowerShell: To schedule a PowerShell script or task call [Powershell.exe](../ps/powershell.html)  
Equivalent bash command (linux): [crontab](../bash/crontab.html) - Schedule a command to run at a later time.



/. nt/scriptrunner.html
========================================================

    ScriptRunner - Windows CMD - SS64.com

ScriptRunner.exe
================

Run one or more scripts in sequence. Supplied with Windows 10 (1607+).

Syntax

      ScriptRunner
         -appvscript _scriptFileName_ [_Arguments_]
            **[**-appvscriptRunnerParameters [-wait] [-timeout=_TimeInSeconds_] [-rollbackOnError]**]**
         -appvscript _scriptFileName_ [_Arguments_]
            **[**-appvscriptRunnerParameters [-wait] [-timeout=_TimeInSeconds_] [-rollbackOnError]**]**
         ...

Key
    -appvscript  The script to be executed: PowerShell (.ps1), VBScript (.vbs), executable(.exe), Batch (.bat).
                Multiple scripts may be run by including multiple -appvscript options.
                ScriptRunner will run any script whose file type is associated with an application installed
                on the computer.
                If the associated application is missing, or the script’s file type isn't associated with any
                of the computer's applications, the script won't run.
                An alternative is to call [powershell.exe](../ps/powershell.html) or [CMD.exe](cmd.html) and pass the script name as an argument.

    _Arguments_    Any arguments for the script being run.

    -appvscriptRunnerParameters
      -wait            Wait for this script to complete before continuing.
      -timeout         Timeout after _TimeInSeconds_ seconds and continue.
      -rollbackOnError Rollback if the script exits with a non zero exit code.
                       If -rollbackOnError is set, then by implication -wait will also be True.

Default values for -appvscriptRunnerParameters: No wait, No timeout, No rollback on error.

Every parameter must be separated by a space character.

The **rollback on error** is limited in its effect, if the script creates a _new_ output file, then rollback will delete the file, but if the script updates or replaces an existing file then rollback will not revert those changes.  
If a ScriptRunner command contains more than one -appvscript clause, then **rollback on error** may fail to work for either script.

You can use ScriptRunner in DeploymentConfig.xml, UserConfig.xml and AppxManifest.xml files (all trigger events).

### Examples

Demonstrate the timeout by running a [pause](pause.html) command:

ScriptRunner.exe -appvscript cmd "/c" "pause" -appvscriptrunnerparameters -wait -timeout=20  
  
Run two scripts passing parameters to each (this is all one line):  
  
ScriptRunner.exe -appvscript demoA.cmd arg1 arg2 -appvscriptrunnerparameters -wait -timeout=30 -rollbackonerror -appvscript demoB.ps1 arg3 arg4 -appvscriptrunnerparameters -wait -timeout=30 -rollbackonerror  

In XML:
<MachineScripts>
 <AddPackage>
    <Path>ScriptRunner.exe>/Path>
    <Argument>
    -appvscript script1.exe arg1 arg2 –appvscriptrunnerparameters –wait –timeout=10
    -appvscript script2.vbs arg1 arg2
    -appvscript script3.cmd arg1 arg2 –appvscriptrunnerparameters –wait –timeout=30 –rollbackonerror
    </Arguments>
    <Wait timeout="40" RollbackOnError="true"/>
 </AddPackage>
</MachineScripts>>

"He can run. But he can’t hide" ~ Joe Louis, 1946

### Related commands

[START](start.html) - Start a program, command or batch file.  
[Run a script](syntax-run.html) - How to create and run a batch file.  
Equivalent PowerShell: [Run a script](../ps/syntax-run.html) How to run a .ps1 script by calling [PowerShell.exe](../ps/powershell.html)  
Equivalent bash command (Linux): [Run a bash shell script](../bash/syntax-script.html)



/. nt/set.html
========================================================

    Set - Environment Variable - Windows CMD - SS64.com

SET
===

Display, set, or remove CMD environment variables. Changes made with SET will remain only for the duration of the current CMD session.

Syntax

      SET _variable_
      SET _variable_=_string_
      SET "_variable_=_string_"
      SET "_variable_="

      SET /A _"variable_=_expression_"
      SET /P _variable_=[_promptString_]
      SET "

Key
    _variable_   A new or existing environment variable name e.g. _num
    _string_     A text string to assign to the variable.
    /A         Arithmetic expression see full details [below](#expressions).
    /P         Prompt for user input.

Variable names are not case sensitive but the contents can be.

It is good practice to avoid using any [delimiter](syntax-esc.html#delimiters) characters (spaces, commas etc) in the variable _name_.

Delimiter characters can be used in the _value_ if the complete assignment is surrounded with double quotes to prevent the delimiter being interpreted.

Any extra spaces around either the variable name or the _string_, will **not** be ignored, SET is not forgiving of extra spaces like many other scripting languages. So use SET alpha=beta, not SET alpha = beta

The first character of the name must [not be numeric](syntax-percent.html). It is a common practice to prefix variable names with either an undescore or a dollar sign _variable or $variable, these prefixes are not required but help to prevent any confusion with the standard built-in [Windows Environment variables](syntax-variables.html) or any other other command strings.

The CMD shell will fail to read an environment variable if it contains more than [8,191](https://support.microsoft.com/en-gb/help/830473/) characters.

Display a variable:
-------------------

> In most contexts, surround the variable _name_ with %'s and the variable's _value_ will be used  
> e.g. To display the value of the _department variable with the ECHO command:  
> ECHO %_department%
> 
> If the variable name is not found in the current environment then SET will set %ERRORLEVEL% to 1 .  
> This can be detected using [IF](if.html) ERRORLEVEL ...
> 
> Including extra characters can be useful to show any white space:  
> ECHO [%_department%]  
> ECHO "%_department%"  
> 
> Type SET without parameters to display all the current environment variables.  
>   
> Type SET with a variable name to display that variable  
> SET _department  
>   
> The SET command invoked with a string (and no equal sign) will display a wildcard list of all matching variables  
>   
> Display variables that begin with 'P':  
> SET p  
> Display variables that begin with an underscore  
> SET _

Set a variable:
---------------

> Example of storing a text string:  
>   
> C:> SET _dept=Sales and Marketing  
> C:> set _  
> _dept=Sales and Marketing
> 
> Set a variable that contains a [redirection](syntax-redirection.html) character, note the position of the quotes which are not saved:
> 
> SET "_dept=Sales & Marketing"
> 
> One variable can be based on another, but this is not dynamic  
> E.g.
> 
> C:> set "xx=fish"  
> C:> set "msg=%xx% chips"  
> C:> set msg  
> msg=fish chips
> 
> C:> set "xx=sausage"  
> C:> set msg  
> msg=fish chips
> 
> C:> set "msg=%xx% chips"  
> C:> set msg  
> msg=sausage chips
> 
> Avoid starting variable names with a number, this will avoid the variable being mis-interpreted as a [parameter](syntax-args.html)  
> %123_myvar% < > %1 23_myvar  
>   
> To display undocumented system variables:
> 
>    SET "

Values with Spaces - using Double Quotes
----------------------------------------

> Although it is advisable, there is no requirement to add quotation marks when assigning a value that includes spaces:
> 
> SET _variable=one two three
> 
> For special characters like & surround the entire expression with quotation marks.  
> The variable contents will **not** include the surrounding quotes:
> 
> SET **"**_variable=one & two**"**
> 
> n.b. if you only place quotation marks around the value, then those quotes will be stored:
> 
> SET _variable=**"**one & two**"**

Variable names with spaces
--------------------------

> A variable can contain spaces and also the variable name itself can contain spaces, therefore the following assignment:  
> SET _var =MyText  
> will create a variable called "_var " ← note the trailing space.

Prompt for user input
---------------------

> The /P switch allows you to set a variable equal to a line of input entered by the user.  
> The Prompt string is displayed before the user input is read.
> 
> @echo off
> Set /P _ans=Please enter Department: || Set _ans=NothingChosen
> :: remove &'s and quotes from the answer (via string [replace](syntax-replace.html))
> Set _ans=%_ans:&=%
> Set _ans=%_ans:"=%
>   
> If "%_ans%"=="NothingChosen" goto sub_error  
> If /i "%_ans%"=="finance" goto sub_finance  
> If /i "%_ans%"=="hr" goto sub_hr
> goto:eof
> 
> :sub_finance
> echo You chose the finance dept
> goto:eof
> 
> :sub_hr
> echo You chose the hr dept  
> goto:eof
> 
> :sub_error
> echo Nothing was chosen
> 
> Both the Prompt string and the answer provided can be left empty. If the user does not enter anything (just presses return) then the variable will be unchanged and the [errorlevel](errorlevel.html) will be set to 1.
> 
> The script above strips out any '&' and " characters but may still break if the string provided contains both.  
> For user provided input, it is a good idea to fully [sanitize any input string](syntax-sanitize.html) for potentially problematic characters (unicode/smart quotes etc).
> 
> The [CHOICE](choice.html) command is an alternative for user input, CHOICE accepts only one character/keypress, when selecting from a limited set of options it will be faster to use.  

Echo a string with no trailing CR/LF
------------------------------------

> The standard ECHO command will always add a CR/LF to the end of each string displayed, returning the cursor to the start of the next line.  
> SET /P does not do this, so it can be used to display a string. Feed a NUL character into SET /P like this, so it doesn’t wait for any user input:
> 
> Set /P _scratch="This is a message to the user " <nul

Place the first line of a file into a variable:
-----------------------------------------------

> Set /P _MyVar=<MyFilename.txt  
> Echo %_MyVar%
> 
> The second and any subsequent lines of text in the file will be discarded.
> 
> In very early versions of CMD, any carriage returns/new lines (CR+LF) before the first line containing text were ignored.

Delete a variable
-----------------

> Type SET with just the variable name and an equals sign:  
>   
> SET _department=  
>   
> Better still, to be sure there is no trailing space after the = place the expression in parentheses or quotes:  
> (SET _department=)  
>   or  
> SET "_department="

Arithmetic expressions (SET /a)
-------------------------------

> Placing expressions in "quotes" is optional for simple arithmetic but required for any expression using logical operators.
> 
> When refering to a variable in your expression, SET /A allows you to omit the %'s so _myvar instead of %_myvar%
> 
> Any SET /A calculation that returns a fractional result will be rounded down to the nearest whole integer.
> 
> The expression to be evaluated can include the following operators:  
> For the Modulus operator use (%) on the command line, or in a batch script it must be [doubled up](syntax-percent.html) to (%%) as below.  
> This is to distinguish it from a [FOR](for.html) parameter.
> 
>    +   Add                set /a "_num=_num+5"
>    +=  Add variable       set /a "_num+=5"
>    -   Subtract           set /a "_num=_num-5"
>    -=  Subtract variable  set /a "_num-=5"
>    *   Multiply           set /a "_num=_num*5"
>    *=  Multiply variable  set /a "_num*=5"
>    /   Divide             set /a "_num=_num/5"
>    /=  Divide variable    set /a "_num/=5"
>    %%  [Modulus](https://www.geeksforgeeks.org/difference-between-modulo-and-modulus/)            set /a "_num=17%%5"
>    %%= Modulus            set /a "_num%%=5"
>    !   Logical negation  0 (FALSE) ⇨ 1 (TRUE) and any non-zero value (TRUE) ⇨ 0 (FALSE)
>    ~   Bitwise invert
>    &   AND                set /a "_num=5&3"    0101 [AND](https://www.guru99.com/c-bitwise-operators.html) 0011 = 0001 (decimal 1)
>    &=  AND variable       set /a "_num&=3"
>    |   OR                 set /a "_num=5|3"    0101 [OR](https://www.guru99.com/c-bitwise-operators.html) 0011 = 0111 (decimal 7)
>    |=  OR variable        set /a "_num|=3"
>    ^   XOR                set /a "_num=5^3"    0101 [XOR](https://www.guru99.com/c-bitwise-operators.html) 0011 = 0110 (decimal 6)
>    ^=  XOR variable       set /a "_num=^3"
>    <<  Left [Shift](https://www.bbc.co.uk/bitesize/guides/z6qqmsg/revision/4).    (sign bit ⇨ 0) An arithmetic shift.
>    >>  Right [Shift](https://www.bbc.co.uk/bitesize/guides/z6qqmsg/revision/4).   (Fills in the sign bit such that a negative number always remains negative.)
>                        Neither ShiftRight nor ShiftLeft will detect overflow.
>    <<= Left Shift variable     set /a "_num<<=2"
>    >>= Right Shift variable    set /a "_num>>=2"
> 
>   ( )  Parenthesis group expressions  set /a "_num=(2+3)*5"
>    ,   Commas separate expressions    set /a "_num=2,_result=_num*5"
> 
> If a variable name is specified as part of the expression, but is not defined in the current environment, then SET /a will use a value of 0.
> 
> SET /A arithmetic shift operators do not detect overflow which can cause problems for any non-trivial math, e.g. the bitwise invert often incorrectly reverses the + / - sign of the result.  
>   
> See [SET /a examples](#expressions) below and [this forum thread](https://ss64.org/viewtopic.php?f=2&t=336) for more.  
> also see [SetX](setx.html), [VarSearch](syntax-replace.html) and [VarSubstring](syntax-substring.html) for more on variable manipulation.
> 
> SET /A should work within the full range of 32 bit signed integer numbers (-2,147,483,648 through 2,147,483,647) but in practice for negative integers it will not go below -2,147,483,647 because the correct two's complement result 2,147,483,648 would cause a positive overflow.
> 
> **Examples:**
> 
> SET /A "_result=2+4"  
> (=6)  
>   
> SET /A "_result=5"  
> (=5)  
> SET /A "_result**+=**5"  
> (=10)  
>   
> SET /A "_result=2**<<**3"  
> (=16) { 2 Lsh 3 = binary 10 Lsh 3 = binary 10000 = decimal 16 }  
>   
> SET /A "_result=5**%%**2"  
> (=1) { 5/2 = 2 + 2 remainder 1 = 1 }  
>   
> SET /A "_var1=_var2=_var3=10"  
> (sets 3 variables to the same value - undocumented syntax.)
> 
> SET /A will treat any character string in the expression as an environment variable name. This allows you to do arithmetic with environment variables without having to type any % signs to get the values. SET /A "_result=5 + _MyVar"
> 
> Multiple calculations can be performed in one line, by separating each calculation with commas, for example:
> 
> Set "_year=1999"  
> Set /a "_century=_year/100, _next=_century+1"
> 
> The numbers must all be within the range of 32 bit signed integer numbers (-2,147,483,648 through 2,147,483,647) to handle larger numbers use [PowerShell](/ps/) or [VBScript](/vb/).
> 
> You can also store a math expression in a variable and substitute in different values, rather like a [macro](syntax-macros.html).
> 
> SET "_math=(#+6)*5"  
> SET /A _result="%_math:#=4%  
> Echo %_result%  
> SET /A _result="%_math:#=10%  
> Echo %_result%

Leading Zero will specify Octal
-------------------------------

> Numeric values are decimal numbers, unless prefixed by  
> **0x** for hexadecimal numbers,  
> **0** for octal numbers.  
>   
> So 0x10 = 020 = 16 decimal  
>   
> The octal notation can be confusing - all numeric values that start with zeros are treated as octal but 08 and 09 are not valid octal digits.  
> For example SET /a "_month=07" will return the value 7, but SET /a "_month=09" will return an error.

Permanent changes
-----------------

> Changes made using the SET command are NOT permanent, they apply to the current CMD prompt only and remain only until the CMD window is closed.  
> To permanently change a variable at the command line use [SetX](setx.html)  
> or with the GUI: Control Panel ➞ System ➞ Environment ➞ System/User Variables  
>   
> Changing a variable permanently with SetX will not affect any CMD prompt that is already open.  
> Only new CMD prompts will get the new setting.  
>   
> You can of course use SetX in conjunction with SET to change both at the same time:
> 
> Set _Library=T:\Library\  
> SetX _Library T:\Library\ /m

Change the environment for other sessions
-----------------------------------------

> Neither SET nor SetX will affect other CMD sessions that are already running on the machine . This as a good thing, particularly on multi-user machines, your scripts won’t have to contend with a dynamically changing environment while they are running.
> 
> It is possible to add permanent environment variables to the registry (HKCU\Environment), but this is an undocumented (and likely unsupported) technique and still it will not take effect until the users next login.
> 
> System environment variables can be found in the registry here:  
> HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment

CALL SET
--------

> The CALL SET syntax will expand any variables passed on the same line, which is useful if you need to set one variable based on the value of another variable. CALL SET can also evaluate a [variable substring](syntax-substring.html), the [CALL](call.html) page has more detail on this technique, though in many cases a faster to execute solution is to use Setlocal [EnableDelayedExpansion](delayedexpansion.html).

Autoexec.bat
------------

> Any SET statement in c:\autoexec.bat will be parsed at boot time  
> Variables set in this way are not available to 32 bit gui programs - they won’t appear in the control panel.  
> They will appear at the CMD prompt.  
>   
> If autoexec.bat CALLS any secondary batch files, the additional batch files will NOT be parsed at boot.  
> This behaviour can be useful on a dual boot PC.

Errorlevels
-----------

> When [CMD Command Extensions](cmd.html) are enabled (the default):
> 
> [Errorlevel](errorlevel.html)
> 
> If the variable was successfully changed
> 
> _unchanged_, typically this will be 0 but if a previous command set an errorlevel, that will be preserved (this is a bug).
> 
> SET No variable found or invalid name.  
> SET _var=value when _var name starts with "/" and not enclosed in quotes.  
> SET /P Empty response from user.
> 
> 1
> 
> SET /A Unbalanced parentheses
> 
> 1073750988
> 
> SET /A Missing operand
> 
> 1073750989
> 
> SET /A Syntax error
> 
> 1073750990
> 
> SET /A Invalid number
> 
> 1073750991
> 
> SET /A Number larger than 32-bits
> 
> 1073750992
> 
> SET /A Division by zero
> 
> 1073750993

SET is an [internal](syntax-internal.html) command.  
If [Command Extensions](cmd.html) are disabled all SET commands are disabled other than simple assignments like: _variable=MyText

\# I got my mind set on you  
\# I got my mind set on you... - Rudy Clark ([James Ray](https://www.youtube.com/watch?v=k68Fob0QA_k)/[George Harrison](https://www.youtube.com/watch?v=_71w4UA2Oxo))

### Related commands

[Syntax - VarSubstring](syntax-substring.html) Extract part of a variable (substring).  
[Syntax - VarSearch](syntax-replace.html) Search & replace part of a variable.  
[Syntax - Environment Variables](syntax-variables.html) - List of default variables.  
[CALL](call.html) - Evaluate environment variables.  
[CHOICE](choice.html) - Accept keyboard input to a batch file.  
[ENDLOCAL](endlocal.html) - End localisation of environment changes, use to return values.  
[EXIT](exit.html) - Set a specific ERRORLEVEL.  
[PATH](path.html) - Display or set a search path for executable files.  
[REG](reg.html) - Read or Set Registry values.  
[SETLOCAL](setlocal.html) - Begin localisation of environment variable changes.  
[SETX](setx.html) - Set an environment variable permanently.  
[Parameters](syntax-args.html) - get a full or partial pathname from a command line variable.  
[StackOverflow](https://stackoverflow.com/questions/6379619/explain-how-dos-batch-newline-variable-hack-works) - Storing a Newline in a variable.  
Equivalent PowerShell: [Set-Variable](../ps/set-variable.html) - Set a variable and a value (set/sv).  
Equivalent PowerShell: [Read-Host](../ps/read-host.html) - Prompt for user input.  
Equivalent bash command (Linux): [env](../bash/env.html) - Display, set, or remove environment variables.



/. nt/setlocal.html
========================================================

    Setlocal - Local variables - Windows CMD - SS64.com

SETLOCAL
========

Set options to control the visibility of environment variables in a batch file.

Syntax

      SETLOCAL

      SETLOCAL {[EnableDelayedExpansion](delayedexpansion.html) | DisableDelayedExpansion}  {EnableExtensions | DisableExtensions}

Key
    EnableDelayedExpansion  Expand variables at execution time rather than at parse time.

    DisableDelayedExpansion Expand variables at parse time rather than at execution time.

    EnableExtensions        Attempt to enable [Command](cmd.html) extensions. 

    DisableExtensions       Attempt to disable [Command](cmd.html) extensions. 

SETLOCAL on it's own, usually at the start of a batch file, will begin localisation of Environment Variables.

Issuing a SETLOCAL command, the batch script will inherit all current variables from the master environment/session.

Issuing an [ENDLOCAL](endlocal.html) command will restore all environment variables to the state they had before the SETLOCAL was issued.

If a batch script does not use SETLOCAL then all variables will be Global, i.e. visible and modifiable by other scripts.

Although global variables are easy to work with they are not good practice - for example if you have several batch scripts dealing with filenames (and these scripts are [CALL](call.html)ing one another), the first script has a variable called _filename, the second script a different variable called file-name (a different name to avoid conflicting with the first script) a third script now needs something like file_name this quickly becomes very difficult to manage.

With local variables you are free to use the same variable names in multiple batch scripts - there is no conflict because the local variables are not visible to any other script.  
Local Variables can be passed from one batch routine to another with the [ENDLOCAL](endlocal.html) command.

EnableDelayedExpansion
----------------------

> Setting [EnabledDelayedExpansion](delayedexpansion.html) will cause each variable to be expanded at execution time rather than at parse time.

DisableDelayedExpansion
-----------------------

> Setting DisabledDelayedExpansion will cause each variable to be expanded at parse time rather than at execution time, this is the default behaviour.

Overloading a variable:
-----------------------

> SETLOCAL can be used more than once in the same batch file so that multiple values can be stored in the same Environment Variable. To keep track of variable definitions, pair each SETLOCAL with a corresponding ENDLOCAL.
> 
> SETLOCAL is limited to [32](https://ss64.org/viewtopic.php?f=2&t=11) active instantiations per [CALL](call.html) level. At the root level a script can have up to 32 active SETLOCAL, and then CALL a subroutine that gets its own allocation of up to 32 SETLOCAL, etc.  
>   
> @Echo off  
> SETLOCAL  
> ::Standard commission  
> Set _Commission=20  
> Echo Standard commission %_Commission%  
>   
> ::Premium commission  
> SETLOCAL  
> Set _Commission=30  
> Echo Premium commission %_Commission%  
>   
> ::back to Standard commission  
> ENDLOCAL  
> Echo %_Commission%

ErrorLevel
----------

> When run from a batch file, SETLOCAL will always set an ERRORLEVEL.  
> If given a valid argument or no arguments, a new environment is created [%ERRORLEVEL%](errorlevel.html) = 0  
> If bad parameters given, %ERRORLEVEL% = 1

EnableExtensions / DisableExtensions
------------------------------------

> Command Extensions are enabled by default, there is rarely any need to disable them.
> 
> If [Command Extensions](cmd.html) are permanently disabled or if a script is running under the Windows 95 command processor command.com then SETLOCAL ENABLEEXTENSIONS will not be able to restore them.  
>   
> A batch file to warn if command extensions are not available (see [forum thread](https://ss64.org/viewtopic.php?f=2&t=33)):

    VERIFY errors 2>nul
    SETLOCAL ENABLEEXTENSIONS
    IF ERRORLEVEL 1 echo Unable to enable extensions

SETLOCAL is an [internal](syntax-internal.html) command.

_"A local shop for local people" - The League Of Gentlemen_

### Related commands

[ENDLOCAL](endlocal.html) - End localisation of environment changes in a batch file.  
How To: [Functions](syntax-functions.html) - How to package blocks of code 'tunneling'.  
Equivalent PowerShell: [Set-PSdebug -strict](../ps/set-psdebug.html) - Equivalent to 'Option Explicit' in VB.  
Equivalent bash command (Linux): [readonly](../bash/readonly.html) - Mark variables/functions as readonly.



/. nt/setobjectsecurity.html
========================================================

    SetObjectSecurity - Windows CMD - SS64.com

SetObjectSecurity.exe ([Security Compliance Toolkit](https://www.microsoft.com/en-us/download/details.aspx?id=55319))
=====================================================================================================================

Set the security descriptor for just about any type of Windows securable object (files, directories, registry keys, event logs, services, SMB shares, etc).

Syntax

      SetObjectSecurity.exe _objType objName SDDL_ [...]
Key:
    _objType_   Values include: file, FILE, key, KEY, eventlog, printer, service, share, kobject, process, thread, or regbinary.
             (All-caps FILE or KEY uses pre-Windows 2000 APIs to avoid applying inheritance.)

    _objName_   The name of the object (quoted if it contains spaces); or a Process ID (PID) or Thread ID (TID)
             in decimal if objType is “process" or "thread"; or a registry value name if objType is "regbinary"

    _SDDL_      The security descriptor to apply, in Security Descriptor Definition Language

    -v         Report verbose diagnostic output to stderr (optional).

    -q         Do not display the startup banner and copyright message (optional).

SetObjectSecurity.exe enables you to set the security descriptor for just about any type of Windows securable object (files, directories, registry keys, event logs, services, SMB shares, etc). For file system and registry objects, you can choose whether to apply inheritance rules. You can also choose to output the security descriptor in a .reg-file-compatible representation of the security descriptor for a REG_BINARY registry value.

Use cases include:

*   Restoring default security descriptor on the file system root directory (which sometimes gets misconfigured by some system setup tools).
*   Restricting access to sensitive event logs that grant access too broadly (examples include AppLocker and PowerShell script block logs that grant read or read-write to NT AUTHORITY\INTERACTIVE).
*   Locking down (or opening access to) file shares, directories, registry keys.

SetObjectSecurity.exe is a **32-bit** standalone executable that needs no installer, has no dependencies on redistributable DLLs, and works on all supported x86 and x64 versions of Windows. (x64 systems must support WOW64) e.g. WinPE doesn't have WOW64.

**Object examples**:

  file/FILE - absolute or relative path to local or remote file or folder; or a device name:
        C:\TestFolder\Sample.dat
        C:\TestFolder
        Sample.dat
        ..\Sample.dat
        \ComputerName\Share\Sample.dat
        \.\CdRom0
  key/KEY - accepts these forms for hive roots: HKLM, HKLM:, HKEY_LOCAL_MACHINE:
        HKLM\Software\MyApp
        HKCU:\Software\MyApp
        HKEY_CLASSES_ROOT\.abc
  eventlog:
        Application
        Microsoft-Windows-AppLocker/EXE and DLL
  printer:
        MyPrinter
        \ComputerName\MyPrinter
  service:
        MyService
        \ComputerName\MyService
  share:
        MyShare
        \ComputerName\MyShare
  kobject - named instance of a semaphore, event, mutex, waitable timer,
            or file mapping; prepend "Global\" for global namespace objects:
        MyEvent
        Local\MyEvent  (same as "MyEvent")
        Global\MyEvent
  process - PID in decimal:
        3022
  thread - TID in decimal:
        2044
  regbinary: see example below  

**SDDL examples** (these usually must be quoted in PowerShell):  

  Admins+System, File-All-Access, protected, inherited by all children:
        D:P(A;OICI;FA;;;BA)(A;OICI;FA;;;SY)
  The above with Users, File-Read:
        D:P(A;OICI;FA;;;BA)(A;OICI;FA;;;SY)(A;OICI;FR;;;BU)
  Interactive Users, Generic-All:
        D:(A;;GA;;;IU)
  Everyone full control but deny List permission:
        D:P(D;;CC;;;WD)(A;;FA;;;WD)
  Empty DACL (no access, no inherited ACEs):
        D:P
  Reset inherited DACL (empty DACL but unprotected):
        D:
  Inherited DACL, Low IL (Vista and newer):
        D:S:(ML;;NW;;;LW)
  Inherited DACL, remove IL (Vista and newer):
        D:S:
  NULL DACL (all access):
        ""
  Set owner to BUILTIN\Administrators, leave DACL intact:
        O:BA
  Set SACL to audit Success and Failure for everything for Everyone:
        S:(AU;SAFA;GA;;;WD)

> Note that event log security descriptors must explicitly specify an owner SID and a group SID. If you set event log permissions with either missing, owner will be set to BA and group SID to SY.

**regbinary example:**  

  SetObjectSecurity.exe regbinary SrvsvcSec O:SYG:SYD:(A;;CCSDRCWDWO;;;BA)(A;;CCSDRCWDWO;;;SY)
outputs this, which can be incorporated into a .reg file:
  "SrvsvcSec"=hex:01,00,04,80,48,00,00,00,54,00,00,00,00,00,00,00,14,00,00,00,02,00,34,00,..

**Example:**  

Restore Windows 10 default permissions on the C:\ root directory  
Using the ALL-CAPS "FILE" option to avoid propagating inherited permissions:  

C:> SetObjectSecurity.exe FILE C:\ "O:S-1-5-80-956008885-3418522649-1831038044-1853292631-2271478464D:PAI(A;OICI;FA;;;BA)(A;OICI;FA;;;SY)(A;OICI;0x1200a9;;;BU)(A;OICIIO;SDGXGWGR;;;AU)(A;;LC;;;AU)S:P(ML;OINPIO;NW;;;HI)"

### Related commands

[CACLS](../nt/cacls.html) - Change file and folder permissions (ACLs).  
[iCACLS](icacls.html) - Change file and folder permissions (ACLs).  
[XCACLS](xcacls.html) - Display or modify Access Control Lists (ACLs) for files and folders.  
[AccessChk](accesschk.html) -L - Get the SDDL representing an object’s current security descriptor (Sysinternals).  
Equivalent bash command (Linux): [cp](../bash/cp.html) - Copy one or more files to another location.



/. nt/setspn.html
========================================================

    Setspn - Windows CMD - SS64.com

SETSPN.exe
==========

Read, modify, or delete the Service Principal Names (SPN) for an Active Directory service account.

Syntax

      SETSPN [_modifiers switch_] [_accountname_]

Key
    _accountname_  The name or domain\name of the target computer or user account

    Edit Mode Switches:
    -R = reset HOST ServicePrincipalName
        Usage:  setspn -R _accountname_

    -S = add arbitrary SPN after verifying no duplicates exist
        Usage:  setspn -S _SPN_ accountname

    -D = delete arbitrary SPN
        Usage:  setspn -D _SPN accountname_

    -L = list SPNs registered to target account
        Usage:  setspn [-L] _accountname_   

  Edit Mode Modifiers:
    -C = _accountname_ is a computer account
    -U = _accountname_ is a user account
   
        Note: -C and -U are exclusive.  If neither is specified, setspn
        will interpret _accountname_ as a computer name if such a computer
        exists, and a user name if it does not.

  Query Mode Switches:
    -Q = query for existence of SPN
        Usage:  setspn -Q _SPN_

    -X = search for duplicate SPNs
        Usage:  setspn -X

> searching for duplicates, especially forestwide, can take a long period of time and a large amount of memory.  
> -Q will execute on each target domain/forest.  
> -X will return duplicates that exist across all targets. SPNs are not required to be unique across forests, but duplicates can cause authentication issues when authenticating cross-forest.  

  Query Mode Modifiers:
    -P = suppress progress to the console, use when redirecting output to a file or 
        in an unattended script. There will be no output until the command is complete.

    -F = perform queries at the forest, rather than domain level

    -T = perform query on the specified domain or forest (when -F is also used)
        Usage:  setspn -T domain (switches and other parameters)
        "" or * can be used to indicate the current domain or forest.

> Note: these modifiers can be used with the -S switch in order to specify where the check for duplicates should be performed before adding the SPN. Note: -T can be specified multiple times.

setspn must be run from an elevated command prompt.

If setspn does not appear to be available, enable the _Active Directory Domain Services_ or the _AD LDS server_ role.

SPNs are set up automatically when a computer joins a domain (and when some services are installed). Some services and applications (e.g. SharePoint) require manual modification of a service account's SPN information to authenticate correctly.

If the computer name or Alias is changed, the SPNs for installed services must be changed to match.

Early versions of Setspn had the option Setspn -A, which skipped the check for duplicates, use Setspn -S in preference to this.

Administrators with only delegated authority (non domain administrators) will require the _Validated write to service principle name_ permission to configure service principal names (SPNs).

Duplicate SPNs will cause Kerberos to fail and fall back to NTLM, run setspn -x periodically to check for this.

SPN Format
----------

> When you manipulate SPNs with setspn, the SPN must be entered in the correct format. The format of an SPN is _serviceclass/host:port/servicename_, in which each item represents a _name_ or _value_.  
> Unless the service name and port are non standard, you do not have to enter them.
> 
> For example, the default SPNs for a server named Server64 that is providing remote desktop (RDP) services (TERMSRV) over the default port (TCP 3389) register the following two SPNs in its own Active Directory computer object:  
> TERMSRV/Server64  
> TERMSRV/Server64.ss64.com

### Examples

View a list of the SPNs that the computer server64 has registered with Active Directory from a command prompt:

setspn –l server64

View a list of the SPNs that the local computer has registered with Active Directory from a command prompt:

setspn –l [hostname](hostname.html)

Reset the SPNs for the computer server64 back to the default:

setspn -r server64

Add an SPN for LDAP to an AD domain controller with the host name dc1.ss64.com:

setspn -s ldap/dc1.ss64.com dc1

Delete the SPN for LDAP from an AD domain controller with the host name dc1.ss64.com:

setspn -d ldap/dc1.ss64.com dc1

Create an alias name for a server:

> Create a CNAME record (not a normal Host(A) record.) in DNS:
> 
> Set the [DisableStrictNameChecking](https://support2.microsoft.com/?id=281308) key in the registry:  
> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanServer\Parameters  
> DisableStrictNameChecking Data type: REG_DWORD  
> Set Value: 1
> 
> On the server create SPN's for the flat name and the fully qualified name of the cname alias:  
> setspn -S host/_your_ALIAS_name ServerName_  
> setspn -S host/_your_ALIAS_name.domain.com ServerName_
> 
> Then **[reboot](shutdown.html)** the Host.

“I have the world's worst taste in men, so now I simply have wonderful relationships of the friend kind, but trying to settle down with somebody? No, no, no, no, no, no, no. I'm beyond that” ~ Harvey Fierstein

### Related commands

RepAdmin - Diagnose Active Directory replication problems between domain controllers.  
[DcDiag](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc731968(v=ws.11)?redirectedfrom=SS64) - Analyze the state of domain controllers and report any problems.  
[DsMgmt](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc732473(v=ws.11)) - Manage password operations over unsecured connections, AD Lightweight Directory Services application partitions, flexible single master operations (FSMO), and clean up AD metadata.  
TechNet - [Troubleshooting SPN Issues](https://go.microsoft.com/fwlink/?LinkId=198395)



/. nt/setx.html
========================================================

    SetX - Set environment variables - Windows CMD - SS64.com

SETX.exe
========

Set environment variables permanently, SETX can be used to set Environment Variables for the machine (HKLM) or currently logged on user (HKCU):

Syntax


    SETX [/s _Computer_ [_Credentials_]] _Variable_ _**Value**_ [/m]

    SETX [/s _Computer_ [_Credentials_]] [_Variable_] /k _**RegistryPath**_ [/m]

    SETX [/s _Computer_ [_Credentials_]] /f _**FileName**_ {[_Variable_] {/a _L_,_T_ | /r _oL_,oT "_SearchString_"}
        [/m] | /x} [/d _Delimiters_]

Key:

    /s _Computer
_      The name or IP address of a remote computer.
      Do not use backslashes. (default = the local computer)

    _Credentials_
      The username and password used to connect to _Computer_:
         /u [_Domain_\]_UserName_ [/p [_Password_]]]

    /u [_Domain_\]_UserName_
      Run the script with the credentials of the specified user account.
      The default value is the system permissions.

    /p [_Password_]
      The password of the user account that is specified in the /u parameter.

    _Variable
_      The name of the environment variable that you want to set.

    _Value_
      The value to which you want to set the environment variable.

    /k _RegistryPath_
      Set the variable based on information from a registry key.
      The registry path consists of: \HIVE\KEY\...\Value
      For example:
      HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\TimeZoneInformation\StandardName

    /f _FileName_
      The file that you want to read.

    /a _L,T_
      Get token _T_ from line _L_ in the file. 
      The L (line) and T (token) coordinates are numbered starting from 0.

    /r _oL,oT_ "_SearchString_"
      Search the file for a token that matches _SearchString_, case insensitive.
      The offset _oL_ (line) and _oT_ (token) coordinates are numbered starting from 0.
      Negative numbers for oL & oT will count upwards and left respectively.
      If the token is not found, %errorlevel% will be set to 1.

    /m
      Set the variable in the system environment HKLM.
      (The default is the local environment HKCU)

    /x
      Display the file with coordinates against each token.

    /d _Delimiters_
      Specifies delimiters such as "," or "\" to be used _in addition_ to the four
      built-in delimiters: SPACE, TAB, CR, and LINEFEED.
      Valid delimiters include any ASCII character.
      The maximum number of delimiters is 15, including built-in delimiters.

Because SETX writes variables to the master environment in the registry, edits will only take effect when a new command window is opened - they do not affect the current CMD or PowerShell session.

Environment variables are stored in the registry, see How-to: [Environment Variables](syntax-variables.html) for more detail.

User variables are stored in the user profile and will follow the users roaming profile.

Machine variables are stored on the machine and will not follow a users roaming profile. To set a machine variable (/m) requires Administrator rights.

If variables with the same name are stored as both User and Machine Environment variables, the user variable will take precedence. If a [Session](set.html) variable is created that will take precedence over any User and/or Machine Environment variable with the same name.

To edit environment variables in the Windows GUI: Control Panel ➞ System ➞ Advanced ➞ Environment Variables

To delete an environment variable either use the GUI (recommended) or delete the value from the registry with [REG](reg.html) delete HKCU\Environment /V __myvar_  
Deleting a variable with REG will not take effect until next logon due to caching of registry data.  
Setting a value of "" (empty quotes) will appear to delete the variable, it's not shown by SET but the variable name will remain in the registry.

The CMD shell will fail to read an environment variable if it contains more than [8,191](https://support.microsoft.com/en-gb/help/830473/) characters. The Command Prompt will also ignore any environment variables that are inherited from a parent process if they are longer than 8191 characters.

SETX can be used to set environment variables from one of three sources (modes): String Value Mode, Registry Mode, or File Mode.

String Value Mode
-----------------

> Setting environment variables equal to a simple string is the most common usage of SetX.
> 
> ### Examples:
> 
> Set the variable _car_park to be 'South' in the users environment:  
>   
> SetX _car_park South
> 
> Set the variable _car_park to be 'North' in the MACHINE environment:  
>   
> SetX _car_park North /m  
>   
> Store the value of _car_park in a second environment variable  
> SetX _oldcarpark %_car_park%  
>   
> Set the _car_park environment variable in the local environment to 'West' on a remote computer named Computer64:
> 
> SetX /s computer64 /u ss64dom\user64 /p P7BmqgWZ1a _car_park West
> 
> Set the _MyPath environment variable in the local environment to use the search path defined in the %PATH% environment variable:
> 
> SetX _MyPath %PATH%
> 
> Set the _MyPath environment variable in the local environment to use the search path defined in the %PATH% environment variable after replacing ~ with %:
> 
> SetX _MyPath ~PATH~
> 
> Set the _MyPath environment variable in the local environment to use the search path defined in the PATH environment variable on a remote computer named Computer64:
> 
> SetX /s computer64 /u ss64dom\user64 /p pa55w0rd _MyPath %PATH%

Registry Mode
-------------

> In registry mode, SetX is an alternative to the [REG QUERY](reg.html) command.
> 
> The only supported hives are: HKEY_CURRENT_USER and HKEY_LOCAL_MACHINE.
> 
> REG_DWORD, REG_EXPAND_SZ, REG_SZ, and REG_MULTI_SZ are the valid RegKey data types.  
> When reading REG_MULTI_SZ values from the registry, only the first item will be extracted and used.  
> REG_DWORD registry values are extracted and used in hexadecimal mode.
> 
> ### Examples:
> 
> Set the _TZone environment variable in the local environment to the value found in the HKLM...\StandardName registry key:
> 
> SetX _TZone /k HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\TimeZoneInformation\StandardName 
> 
> Set the _Build environment variable in the system environment to the value found in the HKLM\...\CurrentBuildNumber registry key:
> 
> SetX _Build /k "HKEY_LOCAL_MACHINE\Software\Microsoft\WindowsNT\CurrentVersion\CurrentBuildNumber" /m

File Mode
---------

> File mode supports the parsing of plain text files only, (with CR/LF line endings).
> 
> ### Examples:
> 
> Display the tokens in a file:
> 
> C:> SetX /f filename.txt /x  
> (0,0 demo1)(0,1 demo2)(0,2 demo3)  
> (1,0 demoA)(1,1 demoB)(1,2 demoC)
> 
> Set the _ipaddr variable in the local environment to the value found at the coordinate 5,11 in the file Ipconfig.out, the variable will only be visible in a new command shell:
> 
> SetX _ipaddr /f ipconfig.out /a 5,11
> 
> When using SetX to extract values from a file, we can ignore the variable that is set and instead use FOR /F to grab the extracted token text into the current session. In this way we are using the SetX command more like [Findstr](findstr.html).  
> So to obtain the fourth token in the 1st line of example.txt:
> 
> For /F "tokens=3" %%G in ('setx /F example.txt dummyVar /A 1^,4 ^|find "Extracted value"') do set _result=%%G
> :: remove the trailing period
> set _result=%result:~0,1%
> Echo %_result%

Thanks to Aacini for suggesting improvements to this page over in the [forum](https://ss64.org/viewtopic.php?f=2&t=58).

_"You are never dedicated to something you have complete confidence in. No-one is fanatically shouting that the sun is going to rise tomorrow. When people are fanatically devoted to political or religious faiths or any other kind of dogmas or goals, its always because these dogmas or goals are in doubt" ~ Robert M Pirsig_

### Related commands

How-to: [Environment Variables](syntax-variables.html) - List of default variables.  
[SET](../nt/set.html) - Display, set, or remove environment variables for a session.  
[SetObjectSecurity](setobjectsecurity.html) - Set security for an object (file, directory, reg key etc).  
[REG](reg.html) - Delete keys or values from the registry.  
[Q104011](https://web.archive.org/web/20141106043035/http:/support2.microsoft.com/kb/104011) - Modify variables by editing the Registry.  
[StackOverflow](https://stackoverflow.com/questions/6379619/explain-how-dos-batch-newline-variable-hack-works) - Storing a Newline in a variable.  
[SETENV](http://barnyard.syr.edu/~vefatica/#SETENV) - Vincent Fatica's improved version (1998).  
[Editenv](https://github.com/Bill-Stewart/editenv) - Bill Stewart's utility for interactive editing of environment variables in a Windows console.  
Equivalent PowerShell: [Set-Variable](../ps/set-variable.html) - Set a variable and a value (set/sv).  
Equivalent bash command (Linux): [setenv](../bash/env.html) - Display, set, or remove environment variables.



/. nt/sfc.html
========================================================

    SFC - System File Checker - Windows CMD - SS64.com

SFC.exe
=======

System File Checker.

Syntax

      Sfc [/Scannow] [/Scanonce] [/Scanboot] [/Revert] [/Purgecache] [/Cachesize=_x_]
Key
    /Scannow   Scan all protected system files immediately and replace
              incorrect versions with correct Microsoft versions. 
              May require access to the Windows installation source files.

    /Scanonce  Scan all protected system files one time when you restart your computer.
              May require access to the Windows installation source
              files when you restart the computer.
              The SfcScan DWORD value is set to 2 in the following registry key
              HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon

    /Scanboot  Scan all protected system files every time you start your computer.
              May require access to the Windows installation source files every 
              time you start the computer.
              The SfcScan DWORD value is set to 1 in the following registry key 
              HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon

    /Revert    Return scan to the default setting
              (do not scan protected files when you start the computer).
              The default cache size is not reset when you run this command.

  /Purgecache Purge the file cache and scan all protected system files immediately.
              May require access to the Windows installation source files.

 /Cachesize=_x_ Set the file cache size to _x_ megabytes (MB).
              The default size of the cache is 50 MB. 
              This command requires you to restart the computer, and then run
              the /purgecache command to adjust the size of the on-disk cache.
              This command sets the SfcQuota DWORD value to x in the following registry key:
              HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon

SFC must be run from an [elevated](syntax-elevate.html) command prompt.

### Examples

Scan all protected system files and replace any incorrect versions:

C:> sfc /scannow

_“Oh, yes, I've learned from my mistakes and I'm sure I could repeat them exactly” ~ Sir Arthur Streeb-Greebling (aka Peter Cook)_

### Related commands

[SLMGR](slmgr.html) - Software Licensing Management.  
[MSINFO32](msinfo32.html) - Windows System Information.  
[SXSTRACE](sxstrace.html) - Diagnose side-by-side problems.



/. nt/share.html
========================================================

    Share.vbs - File and Printer sharing - Windows CMD - SS64.com

Share.vbs ([Resource Kit](../links/windows.html#kits))
======================================================

List or edit a file share or print share (on any computer)

Although missing from recent Resource Kits, this VBS script does still work under recent versions of Windows. The preferred method for creating shares is the [RMTShare](rmtshare.html) command, which can also grant permissions.

Syntax:
 _List Shares_        Share.vbs **/L** [/S <_server_>] [/U <_username_>] [/W <_password_>] [/O <_outputfile_>]  
                _
 Create a Share_  
        Share.vbs **/C** /N <_name_> /P <_path_> [/T <_type_>] [/V <description>]  
                         [/S <_server_>] [/U <_username_>] [/W <_password_>] [/O <_outputfile_>]
 _Delete a Share_  
        Share.vbs **/D** /N <_name_>  
                         [/S <_server_>] [/U <_username_>] [/W <_password_>] [/O <_outputfile_>]

Key:  
  /L             List  
  /C             Create  
  /D             Delete
  /N _name_        Name of the share to be created or deleted.  
  /P _path_        Path of the share to be created.  
  /v _description_ A description for the share.  
  /T _type_        Type of the share to be created. (Disk, Printer, IPC or Special)  
  /S _server_      A machine name.  
  /U _username _   The current user's name.  
  /W _password _   Password of the current user.  
  /O _outputfile _ Output file name.

### Examples

List the shares on the machine \Frodo

cscript Share.vbs /L /s Frodo

Create a file share called "scratch" on the local machine:

cscript Share.vbs /c /n scratch /p "c:\my shared files" /t Disk /v "project files"  
  
Delete the share named "scratch" on the machine \Frodo

cscript Share.vbs /d /n scratch /s Frodo

_"The inherent vice of capitalism is the unequal sharing of blessings, the inherent vice of Socialism is the equal sharing of miseries" ~ Winston Churchill_

### Related commands

[CACLS](../nt/cacls.html) - Display or modify Access Control Lists (ACLs) for files and folders.  
[RMTShare](rmtshare.html) - The preferred method for creating a file system share (it can also grant permissions).  
[RUNDLL32](rundll32.html) - Run a DLL command (add/remove print connections).  
Equivalent PowerShell: [Get-CIMinstance](../ps/get-ciminstance.html) win32_share.  
Equivalent bash command (Linux): [mount](../bash/export.html) - Mount a file system.



/. nt/shellrunas.html
========================================================

    ShellRunas - Windows CMD - SS64.com

ShellRunas ([SysInternals](https://docs.microsoft.com/en-gb/sysinternals/downloads/sysinternals-suite))
=======================================================================================================

Launch a program under a different user account (typically an Admin level account).

Syntax

      shellrunas [/netonly] _program arguments_
      shellrunas /reg [/quiet]
      shellrunas /regnetonly [/quiet] 
      shellrunas unreg

Key
    _program_     Run _program_ with specified credentials and parameters

    /netonly    Use if specified credentials are for remote access only

    /reg        Register ShellRunas shell context-menu entry
    /regnetonly Register Shell /netonly context-menu entry
               Note: a command prompt will flash when the program starts
    /unreg      Unregister ShellRunas shell context-menu entry
    /quiet      Register or unregisters ShellRunas shell context-menu entry without result dialog

### Examples

C:> shellrunas photoshop.exe

"If NumLock is on, pressing a key on the numeric keypad while holding SHIFT overrides NumLock and instead generates an arrow key" ~ [OldNewThing](https://devblogs.microsoft.com/oldnewthing/20040906-00/?p=37953)

### Related commands

[PsExec](psexec.html) - Execute process remotely.  
[RUNAS](runas.html) - Execute a program under a different user account.  
How-to: [Run with elevated permissions](syntax-elevate.html)  
How-to: [Logon Types](syntax-logon-types.html) - Windows Logon types.  
Equivalent VBScript: [ShellExecute method](../vb/shellexecute.html)  
[Aaron Margosis](https://docs.microsoft.com/en-gb/archive/blogs/aaron_margosis/) - Running with least privilege, archived blog (2004-2019).



/. nt/shift.html
========================================================

    Shift - reposition command line parameters - Windows CMD - SS64.com

SHIFT
=====

Change the position of command line arguments passed to a batch file.

Syntax

      SHIFT [/n]

Key
    /n    Start at the _n_th argument, where _n_ is between zero and eight. 

You can get the value of any [argument](syntax-args.html) using a % followed by it's numerical position on the command line. The first item passed is always %1 the second item is always %2 and so on.

Only parameters %1 to %9 can be referenced by number, but it is possibly to pass more than 9 arguments. The SHIFT command provides a way of accessing these additional argument values.

In addition to allowing a large number of parameters to be read, the SHIFT command is also useful for manipulating _optional_ parameters which may or may not be present. See [this StackOverflow answer](https://stackoverflow.com/a/8162578/1720814) for an example.

SHIFT will not affect the value of %* which holds all the original arguments %1 %2 %3...

The argument %0 will initially refer to the path that was used to execute the batch, e.g. MyBatch.cmd if in the current directory or a full path like C:\apps\myBatch.cmd

The SHIFT command will not work within [parentheses/brackets](syntax-brackets.html), so place all your command line arguments in variables before running any FOR commands or other bracketed expressions. Or use the CALL syntax as explained in [this forum thread.](https://ss64.org/viewtopic.php?f=2&t=94)

Drag and Drop
-------------

> If you drag and drop one or more files or folders onto a batch file, the batch will be executed and the filenames (or folder names) will be passed to the batch file as arguments:  
> %1 = "first file", %2 = "second file" etc  
> Like dragging a file into the CMD window, quotes are automatically added to long names.

Warning: SHIFT can change the value of %0
-----------------------------------------

> If SHIFT is used to move a text argument into %0 then any references to %0 will refer instead to the current working directory, unless the new argument value happens to contain a valid path.
> 
> For example:  
> %0\..\MyExecutable.exe will run MyExecutable.exe from the same directory as the Batch file.  
>   
> If the following argument is passed to myBatch.cmd:  
> myBatch.cmd D:\utils\  
>   
> Then SHIFT followed by the same command as before will now run MyExecutable.exe from the directory D:\utils\  
> SHIFT  
> %0\..\MyExecutable.exe
> 
> To avoid this behaviour use SHIFT /1  

Errorlevels
-----------

> If the command line arguments are successfully reassigned [%ERRORLEVEL%](errorlevel.html) = _unchanged_, typically this will be 0 but if a previous command set an errorlevel, that will be preserved (this is a bug).
> 
> If a bad switch is given [%ERRORLEVEL%](errorlevel.html) = 1

### Examples

Demobatch.cmd The Quick Brown

As given %1=The, %2=Quick, %3=Brown  
SHIFT  
will result in %1=Quick, %2=Brown  
A second  
SHIFT  
will result in %1=Brown

Given %1=the, %2=quick, %3=brown, %4=fox  
SHIFT /2  
will result in %1=the, %2=brown, %3=fox

SHIFT is an [internal](syntax-internal.html) command. If [Command Extensions](cmd.html) are disabled, the SHIFT command will not support the /n switch.

“A small key opens big doors" ~ Turkish Proverb

### Related commands

[CALL](call.html) - Call one batch program from another.  
[SET](set.html) - Display or edit environment variables.  
powershell: [param](../ps/syntax-args.html)( $var1, $var2,... )  
Equivalent bash command (Linux): [shift](../bash/shift.html) - Shift positional arguments.



/. nt/shortcut.html
========================================================

    Shortcut - Create shortcut - Windows CMD - SS64.com

SHORTCUT.exe
============

Create a windows shortcut (.LNK file) Originally in the NT4 Server Resource Kit, this utility fails under Windows 10.  
A good free alternative is shortcut.exe from [OptimumX.com](https://optimumx.com/downloads.html) [[Archive.org](https://web.archive.org/web/20200530144108/http://optimumx.com/download/Shortcut.zip) mirror].

Shortcuts can also be created using VBScript or PowerShell see the [examples](#e) below.

Syntax

      SHORTCUT [_options_]

Key
    -t _target_    : The path and file name of the application/document to open.
    -a _arguments_ : The arguments passed when the shortcut is used.
    -d _directory_ : The folder to start the application in.
    -i _iconfile_  : The file the icon is in.
    -x _index_     : The index into the icon file.
    -n _name_      : The path and file name (.LNK) of the shortcut file.
    -c           : Change existing shortcut.
    -r           : Resolve broken shortcut.
    -f           : Force overwrite of an existing short cut.
    -s           : Make shortcut simple (don’t use LinkResolve).
    -l _logfile_   : Save any error messages in the specified file.
    -u [_spec_]    : ECHO the contents of an existing shortcut. 
                  'all' is the same as 'natdix' but the letters 
                  of 'natdix' specify the _options_ to be exported
                  The same option can be specified more than once e.g. -u natn

Shortcut Icons
--------------

> Any DLL or other icon resource _iconfile_ can be used as the source for a custom shortcut icon.  
> If you will be transferring the Shortcut file to another machine, the _iconfile_ must be in a location that is available to that machine.  
> The _index_ selects a specific icon within the file.
> 
> The following classic Icon Resource files are available on all Windows 10 and 11 machines:  
> [%SystemRoot%](syntax-variables.html)\SystemResources\shell32.dll.mun  
> %SystemRoot%\SystemResources\imageres.dll.mun
> 
> Sample shell32.dll index numbers:  
> ![shell32.dll icon samples](shell32.jpg)
> 
> Sample imageres.dll index numbers:  
> ![imageres.dll icon samples](imageres.jpg)
> 
> In Desktop.ini files, a negative number for IconIndex indicates a resource ID (WinAPI) not a file reference.
> 
> Bonus: a small zip file with 19 simple color square [Start-Menu .ico icons](../docs/icons.zip) (Free/Public Domain).

Shortcut Auto LinkResolve
-------------------------

> By default shortcuts will include the machine name of the destination, even for a local file like C:\MyFile.doc  
> This is not immediately visible until the shortcut file is copied to another machine, the shortcut target will then be automatically updated to point back to \Machine1\c$\MyFile.doc  
> To turn this behaviour off add a DWORD value of 1 to the registry (before creating the shortcut):  
>   
> HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer  
> "LinkResolveIgnoreLinkInfo"=1

Shortcut NTFS file system tracking
----------------------------------

> If a shortcut to a file breaks because the destination file has moved, then by default Windows will attempt to [automatically locate the shortcut destination](https://docs.microsoft.com/en-us/previous-versions/technet-magazine/ee518860(v=msdn.10)?redirectedfrom=SS64) by performing a search or matching file properties.  
> This can be turned on or off via the Group Policy [_Do not use the tracking-based method when resolving shell shortcuts_](https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.StartMenu::NoResolveTrack) or directly in the registry:  
>   
> HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer  
> NoResolveTrack
> 
> 0 = disabled, 1 = enabled (REG_DWORD)

Internet Shortcuts
------------------

> Unlike file/folder shortcuts, Favourite (.URL) files are simple text files which you can create with a text editor or a couple of ECHO statements, they will open in the default browser:
> 
> Echo [InternetShortcut] > demo.url  
> Echo URL=https://ss64.com/ >> demo.url

Internet Explorer Pinned .website links
---------------------------------------

> A file saved with a .website extension is an IE Pinned link. These are deprecated and by default will no longer open in IE11 or Microsoft Edge. The internal format is vaguely similar to the older [.url file format](https://www.cyanwerks.com/formats/file-format-url.html), so simply renaming the file from .website to .url may mean that it opens in Edge. This is very much a dirty hack, so don't bulk rename hundreds of .website files and expect them all to work.

Microsoft Edge Shortcuts
------------------------

> If MS Edge is not your default browser, but you want to open a web page using Edge, set an explorer Shortcut _Target_ to a path like the following:
> 
> %windir%\explorer.exe microsoft-edge:https://ss64.com
> 
> Or if Edge is installed on the C: drive, you can simply do:
> 
> "C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe" https://ss64.com  
> Note that Edge installs itself in the x86 folder even though it is a 64 bit application.

Chrome Shortcuts
----------------

> If Google Chrome is not your default browser, but you want to open a web page using Chrome, set the Shortcut _Target_ to a path like the following, note that Chrome installs itself in the x86 folder even though it is a 64 bit application:
> 
> "C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" https://ss64.com

### Examples

Create a shortcut to MyApp.exe

 SHORTCUT -f -t C:\demo\MyApp.exe -n %userprofile%"\start menu\programs\MY APP\MY APP"

An alternative is to use [VBScript](../vb/), call the VB script with cscript like so:  
CSCRIPT C:\batch\makeshortcut.vbs

Optional sections in the VBscript below are commented out:

    strLinkFile = "$env:Public\Desktop\MyShortcut.lnk"
    strTargetPath = "C:\demo\MyApp.exe"
    Set objWS = WScript.CreateObject("WScript.Shell")
    Set objLink = objWS.CreateShortcut(strLinkFile)
   
    objLink.TargetPath = $strTargetPath
    '  objLink.Arguments = ""
    '  objLink.Description = "MyProgram"
    '  objLink.HotKey = "ALT+CTRL+F"
    '  objLink.IconLocation = "%SystemRoot%\SystemResources\shell32.dll.mun, 94"
    '  objLink.WindowStyle = "1"
    '  objLink.WorkingDirectory = "C:\Program Files\MyApp"
    objLink.Save

The same thing can be done to create a shortcut in PowerShell:

    $strTargetPath = "C:\demo\MyApp.exe"
    $strLinkFile = "$env:Public\Desktop\MyShortcut.lnk"
    $WScriptShell = New-Object -ComObject WScript.Shell
    $Shortcut = $WScriptShell.CreateShortcut($strLinkFile)
    $Shortcut.TargetPath = $strTargetPath
    $Shortcut.IconLocation = "%SystemRoot%\SystemResources\shell32.dll.mun, 94"
    $Shortcut.Save()

_“The reasonable man adapts himself to the world: the unreasonable one persists in trying to adapt the world to himself. Therefore all progress depends on the unreasonable man” ~ George Bernard Shaw_

### Related commands

[Explorer.exe](explorer.html) - Open Windows Explorer to show a directory, also accepts variables.  
[MD](../nt/md.html) - Create folder(s)  
[FSUTIL](fsutil.html) - Create a Hardlink.  
[Pin a SHORTCUT](../vb/syntax-pin.html) to the start Menu (VBScript)  
PowerShell: [New-Item -ItemType SymbolicLink](../ps/new-item.html)  
[RUN commands](run.html) - Start ➞ Run commands.  
[Q158682](https://web.archive.org/web/20100130173200/https://support.microsoft.com/kb/158682) - Shortcuts resolve to a UNC Path (LinkResolveIgnoreLinkInfo)  
[Q150215](https://web.archive.org/web/20100725204735/https://support.microsoft.com/kb/150215) - Disable Automatic Shortcut Resolution.  
[Q254493](https://web.archive.org/web/20120216231757/https://support.microsoft.com/kb/254493) - Shortcut.exe fails with sub-folder names.  
[Q263324](https://web.archive.org/web/20120420180105/https://support.microsoft.com/kb/263324) - Shortcut.exe truncates long path names.  
[Q134552](https://support.microsoft.com/en-us/help/134552/) - Shortcut key for shortcut only works when placed on Start Menu.  
Equivalent bash command (Linux): [symlink](../bash/symlink.html) - Make a new name for a file, [ln](../bash/ln.html) - Make links between files.



/. nt/shutdown.html
========================================================

    Shutdown - Shutdown the computer - Windows CMD - SS64.com

SHUTDOWN.exe
============

Shutdown the computer

Syntax

      SHUTDOWN [_shutdown_option_s] [/m \_Computer_] [_other_options_]

shutdown_options:
    /i       Display the GUI (must be the first option)

    /l       Log off. This cannot be used with /m or /d option.

    /s       Shutdown.
    /sg      Shutdown and on the next boot restart any registered applications.

    /r       Restart.
    /g       Restart, after restarting restart any registered applications.

    /a       Cancel a system shutdown during the time-out period.

    /p       Turn off the local computer with no time-out or warning
            (only with /d)

    /h       Hibernate the local computer (can be used with /f )

    /e       Document the reason for an unexpected shutdown of a computer.

    /hybrid  Perform a shutdown of the computer and prepare it for fast startup.
            Must be used with /s (shutdown) option.

    /f       Force running applications to close.
            This will not prompt for File-Save in any open applications.
            so will result in a loss of any unsaved data.

    /soft    Perform a 'soft' shutdown/restart/logoff.
            This will ask programs to close and wait for them to end.

    /fw      Combine with a shutdown option to cause the next boot to go to the
            firmware user interface.

    /o       Go to the advanced boot options menu and restart the computer.
            Must be used with /r option.

other_options:  
    /m \_Computer_  A remote computer to shutdown or restart.

    /t _xxx_   Time until system shutdown in seconds. 
            The valid range for _xxx_ is 0-**315360000** seconds (10 years) [default=30]
            The /f parameter is implied when a value greater than 0 is specified for /t

    /c "_Hello_"  An optional shutdown message [Max 127 chars]
              This will appear onscreen before the shutdown, and in the Windows event log comment.

    /d [u][p] :_xx_:_yy_
            List the reason code for the shutdown or restart. The following table lists the different values.
               **p** will list a **P**lanned reason code.
               **u** will list a **U**ser Defined reason code.
            If neither p nor u is specified the restart or shutdown is unplann**E**d.
               _xx_ = The Major reason code (0-255) see below.
               _yy_ = The Minor reason code (0-65535)

            For a User defined Reason the Major reason code must be in the range 64-255,
            (If not it will be ignored and logged as unplann**E**d.)

Alert Messages to logged in users
---------------------------------

> Shutdown will display one or two alert messages to the user depending on the delay (set with /t) as follows:
> 
> Delay  
> < 3 minutes - A custom popup alert appears immediately (default).  
> >=3 mins and <=10 mins - A custom popup alert immediately and then a generic popup alert **2 mins** before shutdown.  
> > 10 mins and < 11 mins - A system tray alert (with custom message) appears immediately, and then nothing else.  
> >=11 mins - A system tray alert (with custom message) appears immediately, and then a generic popup alert **10 mins** before shutdown.
> 
> System Tray alerts can be disabled/hidden by the user.  
> Also, if the computer goes to sleep (due to Power management) before the shutdown actually occurs, then the countdown will resume after the machine is re-awakened - so the delay is running time not clock time.  
> For these reasons, setting a delay longer than 10 minutes (600 seconds) is not recommended.
> 
> If the computer is manually restarted before the schedule set with Shutdown.exe, the scheduled shutdown will be cancelled.
> 
> If two shutdown commands are issued against the same computer, the first command will run and the second will fail with errorlevel 1190. If you need to make a change, cancel the first command with shutdown /a

Fast Startup
------------

> If Fast Startup is enabled in Settings ➞ Power Options ➞ Turn on Fast startup (which is on by default) then a **shutdown** will not reload any Drivers, Devices and Services, they are stored and retrieved into memory at next startup from a hibernation file.  
> Holding down the [Shift key](syntax-keyboard.html) while clicking shut down will also bypass hibernation.
> 
> To completely reload Drivers, Devices and Services from scratch, use the **restart** option.

Restarting Registered Applications
----------------------------------

> The Windows Restart Manager, introduced in Windows Vista, supports restarting applications after a system shutdown if they have been registered for restart with the [RegisterApplicationRestart](https://docs.microsoft.com/en-us/windows/desktop/api/winbase/nf-winbase-registerapplicationrestart) API.  
> If the application is forcefully shutdown, (not a standard gracefull termination) then the Restart Manager will not attempt to restart the application.
> 
> This functionality is used by Windows Update, Microsoft Office, IE/Edge, Visual Studio, and many other recent applications.

Event Log
---------

> Just before the computer is shutdown, shutdown.exe will record the shutdown event in the Windows SYSTEM Event log with a Source=User32 and event ID 1074 along with any custom message & reason code.
> 
> The event log is the only way to tell that a reboot triggered from Shutdown.exe is pending. It also records the username and date/time when the shutdown command was issued.
> 
> When using Shutdown.exe to reboot a server, the shutdown process will normally allow 30 seconds to ensure each running service has time to stop. Services are shutdown in alphabetical order. Halting the services manually in a specific order with [NET STOP](net-service.html) or [SC](sc.html) can in some cases be slightly faster.

Reason codes
------------

 E = unplann**E**d 0x10000000  
  U = Unexpected 0x00000000  
   P = Planned 0x80000000  
   C = customer defined 0x40000000 (for these, specify your own Major reason # in the range 64-255)

Type    Major Minor Title
  U      0     0    Other (Unplanned)
 E       0     0    Other (Unplanned) 
 E P     0     0    Other (Planned)
  U      0     5    Other Failure: System Unresponsive
 E       1     1    Hardware: Maintenance (Unplanned)
 E P     1     1    Hardware: Maintenance (Planned)
 E       1     2    Hardware: Installation (Unplanned)
 E P     1     2    Hardware: Installation (Planned)
    P     2     3    Operating System: Upgrade (Planned)
 E       2     4    Operating System: Reconfiguration (Unplanned)
 E P     2     4    Operating System: Reconfiguration (Planned)
    P     2     16   Operating System: Service pack (Planned)
         2     17   Operating System: Hot fix (Unplanned)
    P     2     17   Operating System: Hot fix (Planned)
         2     18   Operating System: Security fix (Unplanned)
    P     2     18   Operating System: Security fix (Planned)
 E       4     1    Application: Maintenance (Unplanned)
 E P     4     1    Application: Maintenance (Planned)
 E P     4     2    Application: Installation (Planned)
 E       4     5    Application: Unresponsive
 E       4     6    Application: Unstable
  U      5     15   System Failure: Stop error
 E       5     19   Security issue
  U      5     19   Security issue
 E P     5     19   Security issue
 E       5     20   Loss of network connectivity (Unplanned)
  U      6     11   Power Failure: Cord Unplugged
  U      6     12   Power Failure: Environment
    P     7     0    Legacy API shutdown

The reason codes, specified with /d are logged in the Windows **System** Event Log as [System Shutdown Reason Codes](https://docs.microsoft.com/en-gb/windows/desktop/Shutdown/system-shutdown-reason-codes) (in Hex).

An emergency restart can also be initiated with the GUI: Press [Ctrl-Alt-Del](syntax-keyboard.html) (the Secure Attention Sequence) and then hold down Ctrl and click on the power icon at the bottom right.  

Shutdown.exe will also accept options prefixed with dashes instead of forward slashes: -s -f etc

### Examples

Shutdown the local system in one second from now:  
  
SHUTDOWN.exe /s /f /t 1  
  
Restart the remote system server64 in 60 seconds time and specify the reason "Application: Installation (Planned)" [0x80040002]:

SHUTDOWN.exe /r /f /m \Server64 /t 60 /d P:4:2

To shut down the local machine in 30 seconds time, force running applications to close, restart the computer after shutdown, indicate a user code, indicate that the shutdown is planned, log major/minor reason codes and a comment:

shutdown /r /f /c "Demo of Shutdown" /d up:125:1

Restart the remote system server64 and specify the reason "Security Fix, Planned"

shutdown /r /f /m \server64 /d P:2:17

Using PowerShell, remotely restart a list of computers from a text file of computer names.

$msg = "Due to network maintenance, this computer must be restarted. You have 5 minutes to save your work"
$delay = 300  # seconds
$computers = [get-content](../ps/get-content.html) E:\work\MachineNames.txt
foreach ($computer in $computers)
{
    & 'C:\Windows\System32\SHUTDOWN.exe' "-m \$computer **-r** -c $msg -t $delay"
}

_“I shall go the way of the open sea, To the lands I knew before you came,  
And the cool ocean breezes shall blow from me, The memory of your name” ~ Laurence Hope_

### Related commands

[LOGOFF](logoff.html) - Log off a user.  
[PsShutdown](psshutdown.html) - Shutdown/reboot/logoff one or multiple computers.  
[SCHTASKS](schtasks.html) - Schedule a command to run at a specific time.  
SlideToShutDown.exe - Swipe the lockscreen down to shutdown.  
[EVENTCREATE](eventcreate.html) - Add a message to the Windows event log.  
PowerShell: [Stop-Computer](../ps/stop-computer.html) / [Restart-Computer](../ps/restart-computer.html)



/. nt/sigcheck.html
========================================================

    SigCheck - Windows CMD - SS64.com

SigCheck ([SysInternals](https://docs.microsoft.com/en-gb/sysinternals/downloads/sigcheck))
===========================================================================================

Display file version number, [VirusTotal](https://www.virustotal.com/) status, timestamp information, and digital signature details, including certificate chains.

Syntax

      sigcheck [-a][-h][-i][-e][-l][-n][[-s]|[-c|-ct]|[-m]][-q][-r][-u][-vt]
                  [-v[r][s]][-f _catalog_file_] _file_or_directory_

      sigcheck -d [-c|-ct] _file_or_directory_ 

      sigcheck -o [-vt][-v[r]] _sigcheck_csv_file_
      sigcheck -t[u][v] [-i] [-c|-ct] <_certificate_store_name_ | * >

Key:

    -a   Show extended version information.
        The entropy measure reported is the bits per byte of information of the file's contents.
    -c   CSV output with comma delimiter
    -ct  CSV output with tab delimiter
    -d   Dump contents of a catalog file
    -e   Scan executable images only (regardless of their extension)
    -f   Look for signature in the specified catalog file
    -h   Show file hashes
    -i   Show catalog name and signing chain
    -l   Traverse symbolic links and directory junctions
    -m   Dump manifest
    -n   Only show file version number
    -o   Performs Virus Total lookups of hashes captured in a CSV file previously captured by
        Sighcheck when using the -h option. This usage is intended for scans of offline systems.
    -q   Quiet (no banner)
    -r   Disable check for certificate revocation
    -s   Recurse subdirectories
    -t[u][v]  Dump contents of specified certificate store ('*' for all stores).
             Specify -tu to query the user store (machine store is the default).
             Append '-v' to have Sigcheck download the trusted Microsoft root certificate list and only output
             valid certificates not rooted to a certificate on that list.
             If the site is not accessible, authrootstl.cab or authroot.stl in the current directory are used
             instead, if present.
    -u   If VirusTotal check is enabled, show files that are unknown by VirusTotal or have non-zero detection,
        otherwise show only unsigned files.
    -v[rs]    Query [VirusTotal](https://www.virustotal.com/) for malware based on file hash.
             Add 'r' to open reports for files with non-zero detection.
             Files reported as not previously scanned will be uploaded to VirusTotal if the 's' option is
             specified. Note scan results may not be available for five or more minutes.
    -vt   Accept the  [VirusTotal terms of service](https://www.virustotal.com/en/about/terms-of-service/).Before using VirusTotal features, you must accept at least once.
         Without this option you may be interactively prompted if you haven't already accepted the terms.

VirusTotal.com is a website that performs automated file scanning against over 40 antivirus engines, with an option to upload a file for scanning. You should investigate the purpose of any files found that are not signed.

If scanning a large number of files [redirect](syntax-redirection.html) the output of sigcheck to a text file.

### Examples

Check for unknown/unsigned executable files in your C:\Windows\System32 directory:  
sigcheck -u -e -vt c:\windows\system32

Check for malware files in the C:\Windows\System32 directory (files will NOT be uploaded to VirusTotal):  
sigcheck -vr -vt c:\windows\system32\

Check for malware within executable files only, in C:\Windows\System32 directory and upload any suspect file to VirusTotal:  
sigcheck -vrs -e -vt c:\windows\system32

Return the Windows major/minor version no. by testing a key Windows DLL, this will return the same information as [VER](ver.html) but potentially you could run this against a remote machine:  
sigcheck -n C:\Windows\System32\ntoskrnl.exe -nobanner

“The real test of friendship is: can you literally do nothing with the other person? Can you enjoy those moments of life that are utterly simple?” ~ Eugene Kennedy

### Related commands

[VER](ver.html) - Display version information.



/. nt/sleep.html
========================================================

    Sleep - fixed delay - Windows CMD - SS64.com

SLEEP.exe ([2003 Resource Kit](../links/windows.html#kits))
===========================================================

Delay execution for a few seconds/minutes, for use within a batch file.

Syntax

      SLEEP _time_

Key
    _time_  The number of seconds to pause

### Examples

Pause for 10 seconds before running the next command in a batch file:  
  
SLEEP 10  
  
**Alternative**  
A delay can also be produced by the [PING](ping.html) command with a loopback address (127.0.0.1), in tests this consumes less processor time than Sleep.exe or Timeout.exe. The delay **between** each ping is 1 second, so for a delay of **5** seconds ping **6** times.  
  
e.g. for a delay of 30 seconds:  
PING -n 31 127.0.0.1>nul

See [Clay Calvert's](https://groups.google.com/forum/#!msg/alt.msdos.batch.nt/nSRpfQE-lko/WEWG9aCfSoAJ) newsgroup posting for a full explanation of this technique.  

“O sleep, O gentle sleep, nature's soft nurse, how have I frighted thee, that thou no more wilt weigh my eyelids down, and steep my senses in forgetfulness” ~ Shakespeare (Henry IV)

### Related commands

[TIMEOUT](timeout.html) - Delay execution for a few seconds/minutes (for use within a batch file.)  
[WAITFOR](waitfor.html) - Wait for or send a signal.  
[PING](ping.html) - Test a network connection.  
[WScript.Sleep](../vb/sleep.html) - Sleep  
Equivalent PowerShell: [Start-Sleep](../ps/start-sleep.html) - Suspend shell, script, or runspace activity (sleep)  
Equivalent bash command: [sleep](../bash/sleep.html) - Delay for a specified time.



/. nt/slmgr.html
========================================================

    SLMGR - Software Licensing Management Tool - Windows CMD - SS64.com

SLMGR.vbs
=========

Software Licensing Management Tool. Windows Activation and Key Management Service (KMS)

Syntax

      slmgr [_MachineName_ [_Username Password_]] [_Option_]  
Key

    _machinename_   The machine to administer, by default the current local machine.

    _username _     An administrator equivalent user account for the remote computer.

    _password _     The password for the user account on the remote computer.

    /ad-activation-online _ProductKey_ [_Activation Object Name_]
          Activate AD forest with user provided product key.

    /ad-activation-get-iid
          Display activation ID for AD forest.

    /ao-list  Display activation objects in AD.

    /del-ao [_Activation Object DN_/_RDN_]
          Delete activation objects in AD for user provided Activation Object.

    /ato   Activate Windows license and product key against Microsoft's server.

    /atp _Confirmation_ID_   Activate Windows with user-provided Confirmation ID 

    /ckhc  Disable KMS host caching. This setting instructs the client to use DNS auto-discovery
          each time it attempts KMS activation (recommended when using priority and weight)

    /ckms  Clear the name of KMS server used to default and port to default.

    /ckms-domain _FQDN_ [Activation ID]
          Clear the specific DNS domain in which all KMS SRV records can be found.
          The specific KMS host will be used if set via /skms otherwise default KMS auto-discovery will be used.

    /cpky  Clear product key from the registry (prevents disclosure attacks)
  
    /dli   Display the current license information with activation
          status and partial product key.

    /dlv   Verbose, similar to -dli but with more information.

    /dti   Display Installation ID for offline activation

    /ipk _Key_  Enter a new product _key_ supplied as xxxxx-xxxxx-xxxxx-xxxxx-xxxxx 

    /ilc _License_file _  Install license

    /rilc               Re-install system license files

    /rearm  Reset the [evaluation period](https://web.archive.org/web/20140320194913/https://support.microsoft.com/kb/948472)/licensing status and activation state of the machine

    /rearm-app Reset the licensing status of the given app.

    /rearm-sku Reset the licensing status of the given SKU.  

    /skms _activationservername:port_ 
          Set the Volume Licensing KMS server and/or the port used for KMS activation
          (where supported by your Windows edition)

    /skms-domain _FQDN_ [Activation ID]
          Set the specific DNS domain in which all KMS SRV records can be found.
          This setting has no effect if the specific KMS host is set via the /skms option.

    /skhc  Enable KMS host caching (default), this blocks the use of DNS priority and
          weight after the initial discovery of a working KMS host.
          If the system can no longer contact the working KMS host, discovery will be attempted again.

    /sai _interval_ 
          Sets the interval in minutes for unactivated clients to attempt KMS connection.
          The activation _interval_ must be between 15 minutes and 30 days, although the default (2 hours)
          is recommended.
          The KMS client initially picks up this interval from the registry but switches to the KMS
          setting after the first KMS response has been received.

    /sri _interval_
          Sets the renewal _interval_ in minutes for activated clients to attempt KMS connection.
          The renewal interval must be between 15 minutes and 30 days.
          This option is set initially on both the KMS server and client sides.
          The default is 10080 minutes (7 days).

    /spri  Set the KMS priority to normal (default).

    /cpri  Set the KMS priority to low.
          Use this option to minimize contention from KMS in a co-hosted environment.
          Note that this could lead to KMS starvation, depending on what other applications
          or server roles are active. Use with care.

    /sprt _port_
          Set the port on which the KMS host listens for client activation requests. The default TCP port is 1688.

    /sdns  Enable DNS publishing by the KMS host (default).

    /cdns  Disable DNS publishing by the KMS host.

    /upk   Uninstall current installed product key and return license status back to trial state.

    /xpr   Show the expiry date of current license (if not permanently activated)

    /lil   List the installed token-based activation issuance licenses.

    /ril _ILID ILvID_
         Remove an installed token-based activation issuance license.

    /stao  Set the Token-based Activation Only flag, disabling automatic KMS activation.

    /ctao  Clear the Token-based Activation Only flag (default), enabling automatic KMS activation.

    /ltc   List valid token-based activation certificates that can activate installed software.

    /fta _Certificate Thumbprint_ [PIN]
          Force token-based activation using the identified certificate.
          The optional personal identification number (PIN) is provided to unlock the private
          key without a PIN prompt when using certificates that are protected by hardware
          (for example, smart cards).

All actions (other than displaying status) require elevated administrator privileges.  
Slmgr.vbs script is not intended to work across platforms i.e. between Windows 7 and WIndows 10.

### Examples

Display the current license information:

C:> [cscript](../vb/cscript.html) C:\windows\system32\slmgr.vbs wkstn64 administrator pa55w0rd1 /dli

Set the Volume Licensing KMS server:  
  
C:> cscript slmgr.vbs /skms 192.168.10.1:8090  
  
C:> cscript slmgr.vbs -skms KMSServer:8090

Enter a new product key:

C:> cscript slmgr.vbs /ipk zfgwx-zvc9b-646c9-t64zx

"One resolution I have made, and try always to keep, is this: To rise above little things" ~ John Burroughs

### Related commands

SLUI - Software Licensing (Windows Activation) SLUI.exe 3 _XXXXX.XXXXXX.XXXXXX.XXXXX_  
[Activation Error Codes](https://docs.microsoft.com/en-us/previous-versions//ff793399(v=technet.10)?redirectedfrom=SS64) - docs.microsoft.com  
[CHANGEPK](changepk.html) - Upgrade device Edition/Product Key.  
[CERTREQ](certreq.html) - Request certificate from a certification authority.  
WINVER - Display Licence Activation status.  
[Get-Windows-Key](../ps/syntax-product-key.html) - Retrieve the Windows product key.  
[Q921471](https://support.microsoft.com/en-gb/help/921471/windows-activation-or-validation-fails-with-error-code-0x8004fe33) - Activation fails when you try to activate Windows 10.  
[PERMS](perms.html) - Show permissions for a user.  
[SYSTEMINFO](systeminfo.html) - List system configuration.



/. nt/sort.html
========================================================

    Sort - Windows CMD - SS64.com

SORT
====

Sort will accept a redirected or piped file input and TYPE the file, sorted line by line.

Syntax

      SORT [_options_] 

Options

    /+_n_   Sort the file ignoring the first one or more characters in each row.
         The default (/+1) will sort using all characters in each row.
          /+2 will start comparing at the second character, /+3 the third etc.
         Lines with fewer than _n_ characters collate before other lines.

    /C[ASE_SENSITIVE]

         Case sensitive sort. (undocumented switch in Win7 and above)
         Dependent on the locale some characters will sort before A ('- !#) or after Z (~£¬Ξ)

  [drive:][_pathname_]

         The file to be sorted.
         If not specified, the standard input is sorted.
         Specifying an input file is faster than [redirecting](syntax-redirection.html) the same file as standard input.

    /L[OCALE] _locale_

         Override the system default locale with the specified one.
         The "C" locale yields the fastest collating sequence and is currently the only alternative.
         The default sort with the C locale is case insensitive, so will not consistently place 'A' before or after 'a'.
         When both the C locale and Case-Sensitive are specified, all capitals will sort before lower case, so Z before a.
         The C locale is not the same collation as LC_ALL=C in Unix.

    /M[EMORY] _kilobytes_

         The amount of main memory to use for the sort, in KiB.
         The best performance is usually achieved by not specifying a memory size.

         The memory size is always constrained to be a minimum of 160 KiB.
         If the memory size is specified the exact amount will be used for the sort,
         regardless of how much main memory is available.

         By default the sort will be done with one pass (no temporary file) if it fits in the
         default maximum memory size, otherwise the sort will be done in two passes
         (with the partially sorted data being stored in a temporary file) such that the
         amount of memory used for both the sort and merge passes are equal.  The default
         maximum memory size is 90% of available main memory if both the input and output are
         files, and 45% of main memory otherwise.

         SORT will only create a temporary file when required by limitations in available memory.

    /REC[ORD_MAXIMUM] _characters_ 

         The maximum number of characters in a row or record
         (default 4096, maximum 65535)

    /R[EVERSE]  Reverse the sort order (Z to A, 9 to 0)

    /T[EMPORARY] [_drive_:][_path_]

         The path of the directory to hold SORT's working storage, in case the data does not fit in RAM.
         The default is the system temporary directory %temp%

    /O[UTPUT] [_drive_:][_pathname_]

         The file where the sorted input is to be stored.
         If not specified, the data is written to standard output.
         Specifying an output file is faster than [redirecting](syntax-redirection.html) standard output to the same file.

    /U[NI_OUTPUT]
         Output in unicode. (undocumented switch in Win7 and above)

    /UNIQ[UE]
         Output only unique lines (undocumented switch in Windows 10 and above)

The sort order (collation) is not the same as that used by Windows Explorer ([StrCmpLogicalW](https://docs.microsoft.com/en-gb/windows/win32/api/shlwapi/nf-shlwapi-strcmplogicalw)). In your default country [locale](../locale.html) the sort order should follow the sorting rules for that language. Windows Explorer has its own rather complex set of sorting rules.

In the default locale, many Unicode chracters e.g. the greek character [Xi](https://emw3.com/unicode-accents.html) 'Ξ', or Omega 'Ω' will sort after 'Z' in both Windows Explorer, and in  
'SORT /L C filename.txt'.

First → Last (Default Locale sort order)  
'- !"#$%()*,./:;?@[\]^_\`~+<=>¬£01..89aAbBcCdDeE...zZ

When the locale is set to C, some ASCII characters will sort after Z:  
First → Last (C locale sort order)  
!"#$%'()*+,-./01..89:;<=>?@[\]^_\`aABbcCDdeE...zZ~£¬

Because the /C and /U options are undocumented some Unicode characters may not sort correctly.

### Examples

Sort the file C:\demo\musiclist.txt  
  
SORT "C:\demo\musiclist.txt"

Sort a file and output only the unique values to a file:

TYPE demofile.txt | SORT /unique /o C:\work\unique.txt  
  
Pipe the output of a DIR command into SORT:  
  
DIR /b "C:\demo\" | SORT  
  
Pipe the output from DIR into SORT, reverse the list and save into a file:  
  
DIR /b | SORT /r /o demo.txt  
  
Pipe the output from DIR into SORT, and include any errors in the output (by [redirecting](syntax-redirection.html) the error stream):  
  
DIR /b "folder-that-doesnt-exist" 2>&1 | SORT /r /o demo.txt

"Cultivate peace and order before confusion and disorder" ~ Tao Teh Ching

### Related commands

[TYPE](type.html) - Display the contents of a text file.  
[Redirection](syntax-redirection.html) - Redirect files, command output and error messages.  
Equivalent PowerShell: [Sort-Object](../ps/sort-object.html) - Sort objects by property value (sort).  
Equivalent bash command (Linux): [sort](../bash/sort.html) - Sort text files.



/. nt/ssh.html
========================================================

    SSH OpenSSH - Windows CMD - SS64.com

SSH.exe
=======

OpenSSH remote login client.  
In Windows 10 (>1709) this is an optional feature available under Settings ➞ Apps ➞ “Manage optional features”.

Syntax

      ssh [options] _destination_ [_command_]

Options
    -4    Use IPv4 addresses only.
    -6    Use IPv6 addresses only.

    -A    Enable forwarding of the authentication agent connection.
    -a    Disable forwarding of the authentication agent connection.

    -B _bind_interface_
         Bind to the address of _bind_interface_ before attempting to connect to the destination host.
         This is only useful on systems with more than one address.

    -b _bind_address_
         Use bind_address on the local machine as the source address of the connection.
         Only useful on systems with more than one address.

    -C    Use data compression.

    -c _cipher_spec_
         Select the cipher specification for encrypting the session.

    -D [bind_address:]port
         Dynamic application-level port forwarding.
         This allocates a socket to listen to port on the local side.
         When a connection is made to this port, the connection is forwarded over the secure channel,
         and the application protocol is then used to determine where to connect to from the remote machine.

    -E _log_file_
         Append debug logs to _log_file_ instead of standard error.

    -e _escape_char_
         Set the escape character for sessions with a pty (default: ‘~’).
         The escape character is only recognized at the beginning of a line. The escape character
         followed by a dot (.) closes the connection; followed by control-Z suspends the connection;
         and followed by itself sends the escape character once.
         Setting the character to 'none' disables any escapes and makes the session fully transparent. 

    -F _configfile_
         Specifies a per-user configuration file.
         The default for the per-user configuration file is ~/.ssh/config.

    -f    Request ssh to go to background just before command execution.
         Useful if ssh is going to ask for a passwords, but the user wants it in the background.
         This implies -n. A recommended way to start X11 programs at a remote site is ssh -f host xterm.

         If the ExitOnForwardFailure configuration option is set to 'yes', then a client started with -f 
         will wait for all remote port forwards to be successfully established before placing itself in the background.

    -G    Causes ssh to print its configuration after evaluating Host and Match blocks and exit.

    -g    Allow remote hosts to connect to local forwarded ports.
         If used on a multiplexed connection, then this option must be specified on the master process. 

    -I _pkcs11_
         Specify the PKCS#11 shared library ssh should use to communicate with a PKCS#11 token
         providing keys for user authentication. 

    -i _identity_file_
         A file from which the identity key (private key) for public key authentication is read.

    -J [_user_@]_host_[:_port_]
         Connect to the target host by first making a ssh connection to the pjump host[(/iam/jump-host)
         and then establishing a TCP forwarding to the ultimate destination from there.

    -K    Enable GSSAPI-based authentication and forwarding (delegation) of GSSAPI credentials to the server. 

    -k    Disable forwarding (delegation) of GSSAPI credentials to the server. 

    -l _login_name_
         The user to log in as on the remote machine.

    -M    Place the ssh client into 'master mode for connection sharing.
         Multiple -M options places ssh into 'master' mode but with confirmation required using ssh-askpass(1)
         before each operation that changes the multiplexing state (e.g. opening a new session). 

    -m _mac_spec_
         A comma-separated list of MAC (message authentication code) algorithms, specified in order of preference.

    -N    Do not execute a remote command. This is useful for just forwarding ports. 

    -O _ctl_cmd_
         Control an active connection multiplexing master process.
         When the -O option is specified, the _ctl_cmd_ argument is interpreted and passed to the master process.
         Valid commands are: 'check' (check that the master process is running), 'forward' (request forwardings
         without command execution), 'cancel' (cancel forwardings), 'exit' (request the master to exit),
         and 'stop' (request the master to stop accepting further multiplexing requests).

    -o _option_
         Can be used to give [options](https://man.openbsd.org/ssh) in the format used in the configuration file. 

    -p _port_
         Port to connect to on the remote host.

    -Q _query_option_
         Query ssh for the algorithms supported for the specified version 2. The available features are:
         cipher (supported symmetric ciphers), cipher-auth (supported symmetric ciphers that support authenticated
         encryption), help (supported query terms for use with the -Q flag), mac (supported message integrity codes),
         kex (key exchange algorithms), key (key types), key-cert (certificate key types), key-plain (non-certificate
         key types), protocol-version (supported SSH protocol versions), and sig (supported signature algorithms). 

    -q    Quiet mode.
       
    -R [_bind_address_:]_port_:_host_:_hostport_
    -R [_bind_address_:]_port_:local_socket
    -R _remote_socket_:host:_hostport_
    -R _remote_socket_:_local_socket_
    -R [_bind_address_:]_port_
         Specifies that connections to the given TCP port or Unix socket on the remote (server) host are to be forwarded
         to the local side. 
         Port forwardings can also be specified in the configuration file. Privileged ports can be forwarded only when
         logging in as root on the remote machine. Specify IPv6 addresses be enclosing the address in square brackets.

    -S _ctl_path_
         Specifies the location of a control socket for connection sharing, or the string 'none' to disable connection sharing.
         Refer to the description of ControlPath and ControlMaster in ssh_config(5) for details.

    -T    Disable pseudo-terminal allocation.

    -t    Force pseudo-terminal allocation.
         This can be used to execute arbitrary screen-based programs on a remote machine, which can be very useful,
         e.g. when implementing menu services. Multiple -t options force tty allocation, even if ssh has no local tty.

    -V    Display the version number.

    -v    Verbose mode.

    -W _host_:_port_
         Request that standard input and output on the client be forwarded to host on port over the secure channel.
         Implies -N, -T, ExitOnForwardFailure and ClearAllForwardings, though these can be overridden in the configuration
         file or using -o command line options.

    -w _local_tun_[:_remote_tun_]]
         Request tunnel device forwarding with the specified tun(4) devices between the client (local_tun) and
         the server (remote_tun). The devices may be specified by numerical ID or the keyword 'any', which uses the next
         available tunnel device. If remote_tun is not specified, it defaults to 'any'.
         See also the Tunnel and TunnelDevice directives in ssh_config(5).

         If the Tunnel directive is unset, it will be set to the default tunnel mode, which is 'point-to-point'.
         If a different Tunnel forwarding mode it desired, then it should be specified before -w.

    -X    Enable X11 forwarding. This can also be specified on a per-host basis in a configuration file.
         X11 forwarding should be enabled with caution. Users with the ability to bypass file permissions on the remote
         host (for the user's X authorization database) can access the local X11 display through the forwarded
         connection. An attacker may then be able to perform activities such as keystroke monitoring.

         For this reason, X11 forwarding is subjected to X11 SECURITY extension restrictions by default.
         Please refer to the ssh -Y option and the ForwardX11Trusted directive in ssh_config(5) for more information.

    -x    Disable X11 forwarding. 

    -Y    Enable trusted X11 forwarding. Trusted X11 forwardings are not subjected to the X11 SECURITY extension controls. 
    -y    Send log information using the syslog(3) system module. By default this information is sent to stderr.

By default, ssh attempts to connect to an SSH server running on port 22, use the -p option to select a different port.

ssh may additionally obtain configuration data from a per-user configuration file and a system-wide configuration file. The file format and configuration options are described in ssh_config(5).

### Examples

Install SSH with PowerShell:

C:> powershell "[Add-WindowsCapability](../ps/add-windowscapability.html) -Online -Name OpenSSH.Client~~~~0.0.1.0"

Connect to an SSH server at ssh.example.com with the username xiaoping:

C:> ssh -l xiaoping ssh.example.com

This can be shortened to:

C:> ssh xiaoping@ssh.example.com

“The happiest, healthiest, and longest lasting relationships happen when each partner is secure and whole within themselves” ~ Pamela Cummins

### Related commands

[OpenSSH Man Pages  
](https://www.openssh.com/manual.html)[PuTTY](https://www.chiark.greenend.org.uk/~sgtatham/putty/) - A Free Telnet/SSH Client.  
[OpenSSH For Windows Server](https://docs.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse) - Installation of the SSH server.  
[TELNET](telnet.html) - Communicate with another host using the TELNET protocol.



/. nt/start.html
========================================================

    Start - Start a program - Windows CMD - SS64.com

START
=====

Start a program, command or batch script, opens in a new/separate [Command Prompt](cmd.html) window.

Syntax

      START "_title_" [**/D** _path_] [_options_] "_command_" [_parameters_]

Key:
    _title_       Text for the CMD window title bar (required.)
    _path_        Starting directory.
    _command_     The command, batch file or executable program to run.
    _parameters_  The parameters passed to the _command_.

Options:
    /MIN         Start window Minimized.
    /MAX         Start window Maximized.
    /W or /WAIT  Start application and wait for it to terminate.
                (see below)

    /LOW         Use IDLE priority class.
    /NORMAL      Use NORMAL priority class.
    /ABOVENORMAL Use ABOVENORMAL priority class.
    /BELOWNORMAL Use BELOWNORMAL priority class.
    /HIGH        Use HIGH priority class.
    /REALTIME    Use REALTIME priority class.  
    /B         Start application without creating a new window. In this case
              Ctrl-C will be ignored - leaving Ctrl-Break as the only way to 
              interrupt the application.

    /I         Ignore any changes to the current environment, typically made with [SET](set.html).
              Use the original environment passed to cmd.exe

    /NODE      The preferred [Non-Uniform Memory Architecture](https://linuxhint.com/understanding_numa_architecture/) (NUMA)
              node as a decimal integer.

    /AFFINITY  The processor affinity mask as a [hexadecimal](../convert.html) number.
              The process will be restricted to running on these processors.

    _Options for 16-bit WINDOWS programs only_

    /SEPARATE  Start in separate memory space. (more robust) 32 bit only.
    /SHARED    Start in shared memory space. (default) 32 bit only.

Always include a **TITLE** this can be a simple string like "My Script" or just a pair of empty quotes ""  
According to the Microsoft documentation, the _title_ is optional, but depending on the other options chosen you can have problems if it is omitted.

If _command_ is an internal cmd command or a batch file then the command processor is run with the /K switch to cmd.exe. This means that the window will remain after the command has been run.

In a batch script, a START command without /wait will run the program and just continue, so a script containing nothing but a START command will close the CMD console and leave the new program running.

Document files can be invoked through their file association just by typing the name of the file as a command.  
e.g. START "" MarchReport.DOC will launch the application associated with the .DOC file extension and load the document.

To minimise any chance of the wrong exectuable being run, specify the full path to _command_ or at a minimum include the file extension: START "" notepad**.exe**

If you START an application without a file extension (for example WinWord instead of WinWord.exe)then the [PATHEXT](syntax-variables.html) environment variable will be read to determine which file extensions to search for and in what order.  
The default value for the PATHEXT variable is: .COM;.EXE;.BAT;.CMD

Start - run in parallel
-----------------------

> The default behaviour of START is to instantiate a new process that runs in parallel with the main process. For arcane technical reasons, this does not work for some types of executable, in those cases the process will act as a blocker, pausing the main script until it's complete.
> 
> In practice you just need to test it and see how it behaves.
> 
> Often you can work around this issue by creating a one line batch script (runme.cmd ) to launch the executable, and then call that script with START runme.cmd

Start /Wait
-----------

> The /WAIT option should reverse the default 'run in parallel' behaviour of START but again your results will vary depending on the item being started, for example:
> 
> Echo Starting
> START /wait "demo" calc.exe
> Echo Done
> 
> The above will start the calculator and wait before continuing. However if you replace calc.exe with Winword.exe, to run Word instead, then the /wait will stop working, this is because Winword.exe is a stub which launches the main Word application and then exits.
> 
> A similar problem will occur when starting a batch file, by default START will run the equivalent of [CMD /K](cmd.html) which opens a second command window and leaves it open. In most cases you will want the batch script to complete and then just close it's CMD console to resume the initial batch script. This can be done by explicitly running [CMD /C](cmd.html) ...
> 
> Echo Starting
> START /wait "demo" **CMD /c** demoscript.cmd
> Echo Done
> 
> Add /B to have everything run in a single window.
> 
> In a batch file, an alternative is to use [TIMEOUT](timeout.html) to delay processing of individual commands.

START vs CALL
-------------

> Starting a new process with [CALL](call.html), is very similar to running START /wait, in both cases the calling script will (usually) pause until the second script has completed.
> 
> Starting a new process with [CALL](call.html), will run in the same shell environment as the calling script. For a GUI application this makes no difference, but a second 'called' batch file will be able to change variables and pass those changes back to the caller.
> 
> In comparison START will instantiate a new CMD.exe shell for the called batch. This will inherit variables from the calling shell, but any variable changes will be discarded when the second script ends.

Run a program
-------------

> To start a new program (not a batch script), you don’t have to use CALL or START, just enter the path/file to be executed, either on the command line or within a batch script. This will behave as follows:
> 
> *   On the command line, CMD.EXE does not wait for the application to terminate and control immediately returns to the command prompt.
> *   Running a program from within a batch script, CMD.EXE will pause the initial script and wait for the application to terminate before continuing.
> *   If you run one batch script from another _without_ using either CALL or START, then the first script is terminated and the second one takes over.

Multiprocessor systems
----------------------

> Processor affinity is assigned as a hex number but calculated from the binary positions (similar to [NODRIVES](syntax-nodrives.html))
> 
> Hex Binary        Processors  
>  1 00000001 Proc 1   
>  3 00000011 Proc 1+2  
>  7 00000111 Proc 1+2+3  
>  C 00001100 Proc 3+4 etc
> 
> Specifying /NODE allows processes to be created in a way that leverages memory locality on NUMA systems. For example, two processes that communicate with each other heavily through shared memory can be created to share the same preferred NUMA node in order to minimize memory latencies. They allocate memory from the same NUMA node when possible, and they are free to run on processors outside the specified node.
> 
> start /NODE 1 app1.exe  
> start /NODE 1 app2.exe
> 
> These two processes can be further constrained to run on specific processors within the same NUMA node.
> 
> In the following example, app1 runs on the low-order two processors of the node, while app2 runs on the next two processors of the node. This example assumes the specified node has at least four logical processors. Note that the node number can be changed to any valid node number for that computer without having to change the affinity mask.
> 
> start /NODE 1 /AFFINITY 0x**3** app1.exe  
> start /NODE 1 /AFFINITY 0x**c** app2.exe

Running executable (.EXE) files
-------------------------------

> When a file that contains a .exe header, is invoked from a CMD prompt or batch file (with or without START), it will be opened as an executable file. The filename extension does not have to be .EXE. The file header of executable files start with the 'magic sequence' of ASCII characters 'MZ' (0x4D, 0x5A) The 'MZ' being the initials of [Mark Zibowski](https://www.tavi.co.uk/phobos/exeformat.html), a Microsoft employee at the time the file format was designed.

Command Extensions
------------------

> If Command Extensions are enabled, external command invocation through the command line or the START command changes as follows:
> 
> Non-executable files can be invoked through their file association just by typing the name of the file as a command. (e.g. WORD.DOC would launch the application associated with the .DOC file extension). This is based on the setting in HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ext\OpenWithList, or if that is not specified, then the file associations - see [ASSOC](assoc.html) and [FTYPE](ftype.html).
> 
> When executing a command line whose first token is the string CMD without an extension or path qualifier, then CMD is replaced with the value of the COMSPEC variable. This prevents picking up CMD.EXE from the current directory.
> 
> When executing a command line whose first token does NOT contain an extension, then CMD.EXE uses the value of the [COMSPEC environment variable](syntax-variables.html). This prevents picking up CMD.EXE from the current directory.
> 
> When executing a command line whose first token does NOT contain an extension, then CMD.EXE uses the value of the PATHEXT environment variable to determine which extensions to look for and in what order. The default value for the PATHEXT variable is: .COM;.EXE;.BAT;.CMD Notice the syntax is the same as the [PATH](path.html) variable, with semicolons separating the different elements.
> 
> When searching for an executable, if there is no match on any extension, then looks to see if the name matches a directory name. If it does, the START command launches the Explorer on that path. If done from the command line, it is the equivalent to doing a CD /D to that path.

Errorlevels
-----------

> If the command is successfully started [ERRORLEVEL](errorlevel.html) =_unchanged_, typically this will be 0 but if a previous command set an errorlevel, that will be preserved (this is a bug).  
> If the command fails to start then [ERRORLEVEL](errorlevel.html) = 9059  
> START /WAIT _batch_file_ - will return the ERRORLEVEL specified by [EXIT](exit.html)  

START is an [internal](syntax-internal.html) command.

### Examples

Run a minimised Login script:  
START "My Login Script" /Min Login.cmd

Start a program and wait for it to complete before continuing:  
START "" /wait autocad.exe

Open a file with a particular program:  
START "" "C:\Program Files\Microsoft Office\Winword.exe" "D:\Docs\demo.txt"

Open Windows Explorer and list the files in the current folder (.) :  
C:\any\old\directory> START .

Open a webpage in the default browser, note the protocol is required (https://)  
START https://ss64.com

Open a webpage in Microsoft Edge:  
%windir%[explorer.exe](explorer.html) microsoft-edge:https://ss64.com  
or with a hard-coded path:  
"C:\Program Files (x86)\Microsoft Edge\Application\msedge.exe" https://ss64.com

Connect to a new printer: (this will setup the print connection/driver )  
START \print_server\printer_name  
  
Start an application and specify where files will be saved (Working Directory):  
START /D C:\Documents\ /MAX "Maximised Notes" notepad.exe  

“Do not run; scorn running with thy heels” ~ Shakespeare, The Merchant of Venice

### Related commands

[WMIC process call create](wmic.html) "c:\some.exe","c:\exec_dir" - This method returns the PID of the started process.  
[CALL](call.html) - Call one batch program from another.  
[CMD](cmd.html) - can be used to call a subsequent batch and ALWAYS return even if errors occur.  
[TIMEOUT](timeout.html) - Delay processing of a batch file/command.  
[TITLE](title.html) - Change the title displayed above the CMD window.  
[RUN commands](run.html) Start ➞ Run commands.  
[ScriptRunner](scriptrunner.html) - Run one or more scripts in sequence.  
[Run a script](syntax-run.html) - How to create and run a batch file.  
[Q162059](https://support.microsoft.com/en-gb/help/162059/) - Opening Office documents.  
Equivalent PowerShell: [Start-Process](../ps/start-process.html) - Start one or more processes.  
Equivalent bash command (Linux) : [open](../bash/open.html) - Open a file in it’s default application.  
Equivalent macOS command: [open](../osx/open.html) - Open a file in a chosen application.



/. nt/strings.html
========================================================

    Strings - Windows CMD - SS64.com

Strings ([SysInternals](https://docs.microsoft.com/en-gb/sysinternals/downloads/sysinternals-suite))
====================================================================================================

Search for ANSI and UNICODE strings in binary files.

Syntax

      strings [-a] [-f _offset_] [-b _bytes_] [-n _length_] [-o] [-q] [-s]
         [-u] _file_or_directory_

Key
    -a  Ascii-only search (Unicode and Ascii is default)
    -b  Bytes of file to scan
    -f  File offset at which to start scanning.
    -o  Print offset in file string was located
    -n  Minimum string length (default is 3)
    -q  Quiet (no banner)
    -s  Recurse subdirectories
    -u  Unicode-only search (Unicode and Ascii is default)

Strings just scans the file you pass it for UNICODE (or ASCII) strings of a default length of 3 or more UNICODE (or ASCII) characters.

If you run strings on a .jpg and it includes: 'This program cannot be run in DOS mode' that indicates, it is an executable, not a JPEG. Malware authors often disguise portable executables that end in .gif/.jpg/etc to evade human checks. [[source](https://twitter.com/jepayneMSFT/status/969742842410094593)]

When installing strings.exe just ensure it is placed somewhere in either the system [PATH](path.html) or in the [current](cd.html) directory.

Because strings will scan through the entirety of a binary file it can be useful for finding undocumented command line options.

### Examples

Export the Unicode and ASCII content of an executable file to a csv file:

strings -q demo.exe > demo.csv

Search a jpg file for signs of executable code:

strings sample.jpg | findstr /i /c:"This program cannot be run in DOS mode"

Search multiple DLL files for the string 'quiet':

strings *.dll | findstr /i quiet

_“My advice is, don’t spend money on therapy. Spend it in a record store” ~ Wim Wenders_

### Related commands

[ANSI colors](syntax-ansi.html) - Use ANSI colors in the terminal.  
[FINDSTR](findstr.html) - Search for strings in files.  
[TYPE](type.html) - Display the contents of a text file.  
[BinText 3.0](https://www.portablefreeware.com/forums/viewtopic.php?t=20653) - Free GUI utility, search/extract text from binary files.



/. nt/subinacl.html
========================================================

    Subinacl - Modify Access Control Entries - Windows CMD - SS64.com

SUBINACL.exe ([Windows 2003 Resource kit](/links/windows.html#news))
====================================================================

Download via [Archive.org](https://web.archive.org/web/20190830103837/http://www.microsoft.com/en-us/download/confirmation.aspx?id=23510) mirror (2004)  
Display or modify Access Control Entries (ACEs) for file and folder Permissions, Ownership and Domain.  
  
Access Control Lists apply only to files stored on an NTFS formatted drive, each ACL determines which users (or groups of users) can read or edit the file. When a new file is created it normally inherits ACL's from the folder where it was created.

Syntax

      SUBINACL [/noverbose] /_object_type_ _object_name_ [/_action_=_parameter_] [/help]

Key
    object_types ** service**         e.g. /service Messenger \ServerName\Messenger
                 **keyreg**          e.g. /keyreg HKEY_CURRENT_USER\Software
                                      /keyreg \Srv\HKEY_LOCAL_MACHINE\KeyPath
                 **file**            e.g. /file *.obj  /file c:\test.txt
                                      /file \ServerName\Share\Path
                 **subdirectories**  Manipulate files in specified directory and all subdirectories

    object_name   The object we are applying permissions to.

    action        **setowner**=owner
                 Change the owner of the object e.g. /setowner=ss64dom\Administrators

                 **grant**=_domain__principle_=_ACE_
                 
                 **deny**=_domain__principle_=_ACE_

                 **replace**=_DomainName__Old_Account_=_DomainName__New_Account_
                 This will replace all Permission ACEs on the object.
                 e.g. /replace=ss64dom\Finance=ss64dom\accounts

                 **changedomain**=_OldDomainName_=_NewDomainName_
                 Replace all ACEs with a Sid from OldDomainName
                 with the equivalent Sid found in NewSamServer 
                 e.g. /changedomain=MyOldDomain=NEWDOMAIN
                 This option requires a trust relationship with the server containing the object.

  Help           Run SUBINACL /Help (or SUBINACL /Help /_action_) for more
                 detail on the many other options.

SUBINACL is a powerful command that can do everything cacls and xcacls can do and more besides.

When running subinacl against a subfolder, its important to include the trailing backslash, (or *.*) if this is missed out subinacl will interpret the path as a filename and search the entire drive for it, this can be very slow!

If the file/folder is currently open (locked) it may not be possible to change the permissions or ownership without first closing the file locks. This can be done in Computer Management ➞ Shared Folders ➞ Open files.

The following Permission ACEs (PACEs) may be used with the **/grant** and **/deny** actions, dependent on the object type being modified.

* Files | F C R P O X E W D
* Shares | F C R
* Cluster Share | F C R
* Printers | P
* Process | R R O E W U
* Registry | F R W (Write DAC) D A Q S C (Create SubKey) E Y L P I S
* Services | F C R X W L Q E T O
* Security Accounts Manager (SAM) objects | F R E (Enumerate Dependent Services) W

> Full Control | F
> Change | C C (Service Change Configuration)
> Read | R R (Generic Read)
> Change Permissions | P
> Ownership | O (Take Ownership)  O (Write Owner)
> eXecute | X  X (Generic eXecute)
> Read eXecute | E
> Write | W W (Write DAC) W (Generic Write)
> Delete | D
> Manage Documents | M 
> Print | P
> ReAd ControL | A  L
> Query Value | Q  Q (Query Service Configuration)
> Set Value | S
> Create SubKey | C
> Enumerate Subkeys | E E (Enumerate Dependent Services)
> NotifY | Y
> Create Link | L
> Start Service | T
> Stop Service | O
> Pause/Continue Service | P
> Interrogate Service | I
> Query Service Status | S
> Service User-Defined Control Commands | U

### Examples

Save permissions to a log file:  
subinacl /noverbose /nostatistic /outputlog=SS64.log /subdirectories "C:\Program Files\My Folder*.*" /display

Restore Permissions from a log file:  
subinacl /nostatistic /playfile SS64.log

Change owner :  
subinacl /file C:\demofile.doc /setowner=SS64Dom\AliceT

[More examples](https://social.technet.microsoft.com/wiki/contents/articles/51625.subinacl-a-complete-solution-to-configure-security-permission.aspx) on the Technet wiki.  

_“It's easier to ask forgiveness than it is to get permission” ~ Rear Admiral Grace Hopper_

### Related commands

[TAKEOWN](takeown.html) - Take ownership of a file.  
[ATTRIB](attrib.html) - Display or change file attributes.  
[CACLS](cacls.html) - Change file permissions.  
[XCACLS](xcacls.html) - Display or modify Access Control Lists (ACLs) for files and folders.  
[PERMS](perms.html) - Show permissions for a user.  
[XCACLS](xcacls.html) - Display or modify Access Control Lists (ACLs) for files and folders.  
[Q288129](https://web.archive.org/web/20140712133551/https://support.microsoft.com/kb/288129) - Grant users the right to manage services with SUBINACL.  
Equivalent PowerShell: [Set-Acl](../ps/set-acl.html) - Set permissions.  
Equivalent bash command (Linux): [chmod](../bash/chmod.html) - Change access permissions.



/. nt/subst.html
========================================================

    Subst - Substitute a drive letter for a network path. - Windows CMD - SS64.com

SUBST
=====

Substitute a drive letter for a network or local path.

Syntax

      SUBST _drive_letter_: _path_

      SUBST

      SUBST _drive_letter_: /D

Key
    SUBST with no parameters will display current SUBST drives

    /D    Delete the drive_letter substitution.

The SUBST command can be used to map a drive letter to a LOCAL folder on the same machine.

When a Substed drive is used to delete files or folders, that action will bypass the recycle bin. It will act like a network drive.

SUBST does not have any options to persist after a reboot or logoff, but you can re-initialise the substitution using a one line batch file in the [Windows Startup folder](syntax-autoexec.html) or via a logon script.

If you map a drive with the [NET](net-use.html) command, use the NET command to remove it, similarly if you substitute a drive letter with SUBST then use the SUBST command to remove it.

If the network resource is unavailable (i.e. the server is down) SUBST will continually retry, unlike NET USE which will try to connect once and fail. SUBST is generally used against a local drive path where this is unlikely to be a problem.

Undocumented behaviour: if a drive is substed using characters other than [A-Z](https://ss64.org/viewtopic.php?f=2&t=70) ($,#, :, !, 0-9) it will not appear in Windows Explorer or in the drives reported by SUBST. In early versions of Windows, SUBST also provided some drive mapping options that are now covered by [NET USE](net-share.html). In early versions of Windows, SUBST would create a RECYCLER for each Substed drive.

### Examples

Substitute the drive letter P: for the path D:\work files\April\ :

C:> subst p: D:\work files\April\

Remove the drive substitution from P: this does not remove any files:

C:> subst p: /d

Map the drive letter O: to a local _OneDrive for Business_ folder:

C:> subst O: C:\Users\Tanisha\OneDrive

"A man should never be ashamed to own he has been in the wrong, which is saying in other words, that he is wiser today than he was yesterday" ~ Alexander Pope (thoughts on various subjects)

### Related commands

[NET USE](net-use.html) - Map a drive letter to a network drive.



/. nt/sxstrace.html
========================================================

    SXSTRACE - Windows CMD - SS64.com

SXSTRACE
========

Diagnose side-by-side (SxS) problems. The logfile produced can identify any missing run time components.  

Syntax

      SXSTRACE [trace -logfile:_filename_ [-nostop]
      SXSTRACE [parse -logfile:_filename_ -outfile:_parsedfile_  [-filter:_appname_]
      SXSTRACE stoptrace

Key
    trace     Enable tracing for side-by-side.
    -logfile 	The raw log file.
    _filename_ 	Save tracing log to _filename_.
    -nostop    Do not prompt to stop tracing.

    parse     Translate the raw trace file into a human readable format and save the result into _parsedfile_.
    -outfile _parsedfile_  The output filename.
    -filter _appname_      Filter the output by the name of an application.
    stoptrace           Stop the trace, if it wasn't stopped before.
    -?                   Help.

Sxstrace requires [elevation](syntax-elevate.html)

Sxstrace can be used to diagnose the error message "_The application has failed to start because the side by side configuration is incorrect_"

Start the trace and then reproduce the error by starting the application.

[Side by side assembly](https://docs.microsoft.com/en-us/windows/win32/sbscs/about-side-by-side-assemblies-) (also known as WinSxS or SxS) is a technique for versioning files. Multiple versions of a file are installed on a single machine and an assembly manifest keeps track of the files and versions available. This may include DLLs, Windows classes, COM servers, type libraries, and interfaces.

Some runtime libraries in no longer use this technology; instead, they include the version number of a DLL in its file name. e.g. Visual C++

Side by Side files are stored in the \windows\winsxs directory.

The size of the SxS system folders displayed in Windows Explorer does not necessarily match the actual disk space because of hard links to existing files. The command [Dism.exe](dism.html) /Online /Cleanup-Image /AnalyzeComponentStore will display the disk space used by the WinSxS folder. See also: [ways to reduce the size of the WinSxS folder](https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/clean-up-the-winsxs-folder).  

### Examples

Enable tracing and to save the trace file to ss64.etl:

C:> sxstrace trace -logfile:ss64.etl

Translate the raw trace file into a human readable format ss64.txt:

C:> sxstrace parse -logfile:ss64.etl -outfile:C:\demo\ss64.txt

“Droplets of water would roll around the surface of a lotus leaf and not leave any trace” ~ Zhou Qunfei

### Related commands

[SFC /scannow](sfc.html) - System File Checker.  
[Visual Studio downloads](https://support.microsoft.com/en-us/topic/the-latest-supported-visual-c-downloads-2647da03-1eea-4433-9aff-95f26a218cc0) - latest supported Visual C++ redistributable downloads.



/. nt/sysmon.html
========================================================

    SysMon System Monitor - Windows CMD - SS64.com

SYSMON.exe ([download](https://docs.microsoft.com/en-gb/sysinternals/downloads/sysinternals-suite))
===================================================================================================

System Monitor - monitor and log system activity to the Windows event log.  
  
By monitoring process creation, network connections, and file changes with SysMon, you can identify malicious or anomalous activity on a network. SysMon should not be confused with [Process Monitor](https://docs.microsoft.com/en-gb/sysinternals/downloads/procmon), the graphical tool for analysing running processes.

Syntax

    Install:    Sysmon.exe -i [-h [sha1|md5|sha256]] [-n] [-accepteula]
    Configure:  Sysmon.exe -c [[-h [sha1|md5|sha256]] [-n]|--]
    Uninstall:  Sysmon.exe -u

Key
    -c  Update configuration of an installed Sysmon driver or dump the current
       configuration if no other argument is provided.
    -h  Specify the hash algorithm used for image identification (default is SHA1).
    -i  Install service and driver.
    -m  Install the event manifest (done on service install as well).
    -accepteula  Automatically accept the EULA on installation.
    -n  Log network connections.
    -u  Uninstall service and driver.

The service logs events immediately and the driver installs as a boot-start driver to capture activity from early in the boot that the service will write to the event log when it starts.

On Vista and higher, events are stored in "Applications and Services Logs/Microsoft/Windows/Sysmon/Operational"  
On older systems events write to the System event log.

Specify -accepteula to automatically accept the EULA on installation, otherwise you will be interactively prompted to accept it. Neither install nor uninstall require a reboot.

Event types generated by Sysmon:

Event ID 1: Process creation  
Event ID 2: A process changed a file creation time  
Event ID 3: Network connection

### Examples

Install with default settings (process images hashed with sha1 and no network monitoring):

sysmon –i -accepteula

Install with md5 hashing of process created and monitoring network connections:

sysmon –i -accepteula –h md5 –n

Uninstall:

sysmon –u

Dump the current configuration:

sysmon –c

Change the configuration (when Sysmon is running) to be hash sha256 and no network monitoring:

sysmon –c –h sha256

Change the configuration to default settings:

sysmon –c --

“When I despair, I remember that all through history the way of truth and love have always won. There have been tyrants and murderers, and for a time, they can seem invincible, but in the end, they always fall. Think of it--always” ~ Mahatma Gandhi

### Related commands

[SwiftOnSecurity/sysmon-config](https://github.com/SwiftOnSecurity/sysmon-config) - A Sysmon config file with default high-quality event tracing.  
[LOGMAN](logman.html) - Manage Performance Monitor logs.  
[PsLogList](psloglist.html) - Event log records.  
[PsKill](pskill.html) - Kill processes by name or process ID.  
[PsList](pslist.html) - List detailed information about processes.  
PowerShell: [Get-WinEvent](../ps/get-winevent.html) - Get event log data.



/. nt/systeminfo.html
========================================================

    SYSTEMINFO - Windows CMD - SS64.com

SYSTEMINFO
==========

List system configuration.

Syntax

      SYSTEMINFO [/S _system_ [/U _username_ [/P [_password_]]] ]
                    [/FO _format_] [/NH]

Key:
    /S  system         Remote system to connect to.
    /U  [domain\]user  User context under which to execute.
    /P  [password]     Password for the given user (will prompt if omitted)
    /FO format         Output format: TABLE, LIST or CSV
    /NH                No "Column Header" in the Table/CSV output

The output includes OS configuration, security info, product ID, RAM, disk space, and network cards.  
On a server you may run out of CMD window buffer, to avoid this either increase the window buffer size or redirect the output to a file.

### Examples

SYSTEMINFO  
SYSTEMINFO |find "Total Physical Memory:"  
SYSTEMINFO |find "me:  "  
SYSTEMINFO /S computer64  
SYSTEMINFO /S computer64 /FO CSV /NH >>pcaudit.csv

In PowerShell we can convert the CSV ouptut into an object:  
$objects = systeminfo.exe /FO CSV | ConvertFrom-Csv  
$objects.'Available Physical Memory'  
This output will be localised, on English systems the property names will be in English etc, to normalize these for international use see [here](https://community.idera.com/database-tools/powershell/powertips/b/tips/posts/get-computerinfo-vs-systeminfo-exe-part-1).

“plus ça change, plus c'est la même chose (The more things change, the more they are the same.)” ~ Jean-Baptiste Alphonse Karr 1849.

### Related commands

WINVER.exe - In client OS's this will open the GUI Version dialogue box (Help, About).  
[MSINFO32](msinfo32.html) - Windows System Information.  
[VER](ver.html) - Display version information.  
[PsGetSid](psgetsid.html) - Display the SID of a computer or a user.  
Equivalent PowerShell: [Get-ComputerInfo](../ps/get-computerinfo.html) - Get system and operating system properties.



/. nt/takeown.html
========================================================

    Takeown - Windows CMD - SS64.com

TAKEOWN
=======

Take ownership of a file or folder.

Syntax

      TAKEOWN [/s _Computer_ [/u [_Domain_\]_UserName_ [/p [_Password_]]]]
         /f _FileName_ [/a] [/r [/d {Y|N}]]  
Key
    /s _Computer_
           The name or IP address of a remote computer (do not use backslashes).
           default = local computer.
           This parameter applies to all of the files and folders specified in the command.

    /u [_Domain_\]_UserName_
           Run the script with the permissions of the specified user account.
           default = system permissions.

    /p [_Password_]
           The password of the user account that is specified in the /u parameter.

    /f _FileName_
           The file name, UNC path or directory name pattern.
           Accepts the wildcard character *

    /a      Give ownership to the Administrators group instead of the current user.

    /r      Perform a recursive operation on all files in the specified directory
           and subdirectories.

    /d {Y | N}
           Suppress the confirmation prompt that is displayed when the current user
           does not have the "List Folder" permission on a specified directory,
           and instead use a default value:
              Y: Take ownership of the directory.
              N: Skip the directory.
           Note that you must use this option in conjunction with the /r option.

If the /a parameter is not specified, file ownership is given to the user who is currently logged on to the computer.

Mixed patterns using (? and *) are not supported by the takeown command.

If the file/folder is currently open (locked) it may not be possible to change the ownership or permissions without first closing the file locks. This can be done in Computer Management ➞ Shared Folders ➞ Open files.

After changing the owner for a file/folder, you can then assign full permissions to the files and subsequently read or delete them.

### Examples

Transfer ownership of the file D:\demo\sample.xlsx to the Administrators group:

C:> takeown /f D:\demo\sample.xlsx /a

“As every cat owner knows, nobody owns a cat” ~ Ellen Perry Berkeley

### Related commands

[CACLS](cacls.html) - Change file permissions.  
[iCACLS](icacls.html) - Change file and folder permissions.  
[ATTRIB](attrib.html) - Display or change file attributes.



/. nt/tar.html
========================================================

    TAR - Windows CMD - SS64.com

TAR.exe
=======

Store, list or extract files in an archive (originally on tape - Tape ARchiver).  
BSD TAR.exe was added to Windows 10 (1803) from build [17063](ver.html) or later.  

Syntax

     List:    TAR **-t**f _archive-filename_
              TAR **-t** [options] [_patterns_]

     Extract: TAR **-x**f _archive-filename_
              TAR **-x** [_options_] [_patterns_]

     Create:  TAR **-c**f _archive-filename_ [_filenames_...]
              TAR **-c** [options] **[** _file_ | _dir_ | @_archive_ | -C _dir_ **]** _file_, _dir_

     Update:  TAR **-r**f _archive-filename_ [_filenames_...]
              TAR **-r** [_options_] **[** _file_ | _dir_ | @_archive_ | -C _dir_ **]** _file_, _dir_

     Help:    TAR --help

The first option must be a mode specifier:
    -c   Create
    -r   Add/Replace
    -t   List
    -u   Update (alias for -r)
    -x   Extract

Common Options:
    -b #         Use # 512-byte records per I/O block.
    -f _filename_  Location of archive (default \.\tape0).
    -v           Verbose.
    -w           Interactive.
    _patterns_     If specified, only use entries that match.

Create Options (when adding items to an archive):
    -z      Compress archive with gzip.
    -j      Compress archive with bzip2.
    -J      Compress archive with xz.
    --lzma  Compress archive with lzma.
    --format {ustar|pax|cpio|shar}  Select archive format.
    --exclude _pattern_  Skip files that match pattern.
    -C _dir_     Change to _dir_ before processing remaining files.
    @_archive_   Add entries from _archive_ to output.

Extract Options:
    -k    Keep (don’t overwrite) existing files.
    -m    Don't restore modification times.
    -O    Write entries to stdout, don’t restore to disk.
    -p    Restore permissions (including ACLs, owner, file flags).

The tar utility exits with one of the following values:  
0 All files were processed successfully.  
1 An error occurred.

### Examples

Verbosely create a gzip archive, called sqlbackup.tar.gz, of all files matching the pattern *.sql:

C:> tar -cvzf C:\TARS\sqlbackup.tar.gz *.sql

List the content of the gzip archive C:\TARS\sqlbackup.tar.gz:

C:> tar -tvzf C:\TARS\sqlbackup.tar.gz

“Put three grains of sand inside a vast cathedral, and the cathedral will be more closely packed with sand than space is with stars” ~ James Jeans

### Related commands

[COMPACT](compact.html) - Compress files or folders on an NTFS partition.  
[COMPRESS](compress.html) - Compress one or more files  
[IEXPRESS](iexpress.html) - Create a self extracting ZIP file archive.  
[MAKECAB](makecab.html) - Create .CAB files.  
[Compress-Archive](../ps/compress-archive.html) - PowerShell.  
[Zip a file](https://superuser.com/questions/110991/) - using only built-in Batch/VBS commands (Superuser.com)



/. nt/tasklist.html
========================================================

    Tasklist - Display all running applications - Windows CMD - SS64.com

TASKLIST
========

TaskList displays all running applications and [services](syntax-services.html) with their Process ID (PID) This can be run on either a local or a remote computer.

Syntax

      Tasklist _options_

Options:

    /s _computer_  Name or IP address of a remote computer.
                Don’t use backslashes. Default = local computer.

    /u _domain__user_ [/p _password_]]
                Run under a different account.

    /P [_password_]
                The password for the given user context. Prompts for input if omitted.

    /M [_module_]
                List all tasks currently using the given exe/dll name.
                If the module name is not specified all loaded modules are displayed.

    /svc         List information for each process without truncation.
                Valid when /fo=TABLE. Cannot be used with /m or /v

    /APPS        Display Store Apps and their associated processes. (Windows 8.1+)

    /V           Verbose task information.

    /FO {TABLE|LIST|CSV}]
                Output format, the default is TABLE.

    /NH          No Headers in the output (does not apply to LIST output)

    /FI _FilterName_ [/FI _FilterName2_ [ ... ]]
                Apply one of the Filters below:

                   ImageName   eq, ne                  Image Name _String_
                   PID         eq, ne, gt, lt, ge, le  Process ID, A Positive integer.
                   Session     eq, ne, gt, lt, ge, le  Any valid session number.
                   SessionName eq, ne                  _String_
                   Status      eq, ne                  RUNNING | NOT RESPONDING | UNKNOWN
                   CPUTime     eq, ne, gt, lt, ge, le  _Time_ hh:mm:ss
                   MemUsage    eq, ne, gt, lt, ge, le  Memory usage in KB, specify a valid integer.
                   Username    eq, ne                  _User name_ ([Domain\]User).
                   Services    eq, ne                  Service Name _String_
                   Windowtitle eq, ne                  Window Title _String_
                   Modules     eq, ne                  DLL Name _String_

> > Image Name is the name of the process or the executable file running the process, often svchost.exe
> > 
> > Filters must be surrounded with double quotation marks, if a filter string itself includes a double quotation mark, this must be escaped with a backslash \" one exception to this is a double quote at the end, which can be matched using a wildcard: *
> > 
> > if a filter string includes a backslash, that can be escaped with a double backslash \

Home editions of Windows do not have TASKLIST, use [QPROCESS](query-process.html) instead.

### Examples

List the services running under each process:

TASKLIST /svc

List the services running under each SvcHost process:

TASKLIST /FI "imagename eq svchost.exe" /svc

List the services running now:  
  
TASKLIST /v /fi "STATUS eq running"

List the services with an ImageName that starts with "C" - notice that a wildcard can only be used at the **end** of the string:

TASKLIST /FI "IMAGENAME eq c*"

List the services running under a specific user account:  
  
TASKLIST /v /fi "username eq SERVICE_ACCT05"

“Here's to the success of our impossible task!” ~ Soviet dissidents, 1975

### Related commands

[Query Process](query-process.html) - Display processes (TS/Remote Desktop).  
[PsList](pslist.html) - List detailed information about processes.  
[TLIST](tlist.html) - Task list with full path.  
[MSINFO32](msinfo32.html) - Windows System Information.  
[WMIC](wmic.html) /OUTPUT:C:\demo\procs.txt PROCESS get Caption,Commandline,Processid  
Equivalent PowerShell: [Get-Process](../ps/get-process.html) - Get a list of processes on a machine (ps/gps).  
Equivalent bash command (Linux): [ps](../bash/ps.html) - Process status, information about processes running in memory.



/. nt/taskkill.html
========================================================

    Taskkill - end one or more processes. - Windows CMD - SS64.com

TASKKILL
========

End one or more processes (by process id or image name).

Syntax

      TASKKILL [/S _system_ [/U _username_ [/P [_password_]]]]
         { [/FI _filter_] [/PID _processid_ | /IM _imagename_] } [/F] [/T]

_Options
_    /S   _system_           The remote system to connect to.

    /U   [domain\]_user_    The user context under which
                          the command should execute.

    /P   [password]       The password. Prompts for input if omitted.

    /F                    Forcefully terminate the process(es).

    /FI  _filter_           Display a set of tasks that match a
                          given criteria specified by the filter.

    /PID _process id   _    The PID of the process to be terminated.

    /IM  _image name_       The image name of the process to be terminated.
                          Wildcard '*' can be used to specify all image names.

    /T                     Tree kill: terminates the specified process
                           and any child processes which were started by it.

  Filters    Apply one of the Filters below:

             Imagename   eq, ne                  _String_
             PID         eq, ne, gt, lt, ge, le  Positive integer.
             Session     eq, ne, gt, lt, ge, le  Any valid session number.
             Status      eq, ne                  RUNNING | NOT RESPONDING
             CPUTime     eq, ne, gt, lt, ge, le  _Time_ hh:mm:ss
             MemUsage    eq, ne, gt, lt, ge, le  Any valid integer.
             Username    eq, ne                  _User name_ ([Domain\]User).
             Services    eq, ne                  _String_ The service name
             Windowtitle eq, ne                  _String_
             Modules     eq, ne                  _String_ The DLL name

The process name must include the file extension, or a wildcard.

### Examples

Kill and then restart Windows Explorer:  
TASKKILL /F /IM explorer.exe  
START explorer.exe

Kill including child processes (/T):  
TASKKILL /S system /F /IM notepad.exe /T  
TASKKILL /PID 1230 /PID 1241 /PID 1253 /T  
  
Force Kill (/F):  
TASKKILL /F /IM notepad.exe /IM mspaint.exe  
TASKKILL /F /FI "PID ge 1000" /FI "WINDOWTITLE ne untitle*"  
TASKKILL /F /FI "USERNAME eq NT AUTHORITY\SYSTEM" /IM notepad.exe  
  
Kill on a remote System (/S):  
TASKKILL /S system /U domain\username /FI "USERNAME ne NT*" /IM *  
TASKKILL /S system /U username /P password /FI "IMAGENAME eq note*"  

“Here's to the success of our impossible task!” ~ Soviet dissidents, 1975

### Related commands

[TSKILL](tskill.html) - End a running process.  
[PsKill](pskill.html) - Kill processes by name or process ID.  
[TIMEOUT](timeout.html) - Delay processing of a batch file/command  
Equivalent PowerShell: [Stop-Process](../ps/stop-process.html) - Kill a process.  
Equivalent bash command (Linux): [kill](../bash/kill.html) - Kill a process.



/. nt/telnet.html
========================================================

    Telnet - Windows CMD - SS64.com

TELNET
======

Communicate with another host using the TELNET protocol.

Syntax

      TELNET [-a] [-e _escape_char_] [-f _log_file_] [-l _user_] [-t _term_] [_host_ [_port_]]

Key
    -a   Attempt automatic logon Same as -l except uses currently logged on user name
    -e   Escape character to enter telnet client prompt.
    -f   Filename for client side logging.
    -l   The username to login with on the remote system.
        Requires that the remote system support the TELNET ENVIRON option.
    -t   The terminal type: vt100, vt52, ansi or vtnt.
  _host_  The hostname or IP address of the remote computer.
  _port_  A port number or service name.   

Telnet sends all data as clear text including the username/password used for the intial connection.  
For this reason it is strongly advised to use [SSH](ssh.html) instead.

The telnet client is disabled by default.  
To enable it open 'Windows Features' ➞ 'Turn Windows features on and off' and select Telnet Client.  
or in PowerShell run [Install-WindowsFeature](../ps/install-windowsfeature.html) -name telnet-client

Telnet commands
---------------

 close    Disconnect from an existing Telnet connection.
 display  Show the current settings for Telnet Client.
 open     Use open hostname to establish a Telnet connection to a host.
 quit     Disconnect from the remote server (if connected) and close the Telnet Client.
 send     Send commands to the Telnet server. 
 send ao  Abort Output command.
 send ayt "Are you there?" command.
 send esc Sends the current escape character.
 send ip  Interrupt process command.
 send synch Perform a Telnet synch operation. 
 send brk   Send a break signal.
 set        Configure the Telnet Client for the current session:
 set bsasdel Backspace will be sent as delete
 set codeset option  Available only when the language is set to [Japanese](https://go.microsoft.com/fwlink/?LinkId=108380).
 set crlf  Set new-line mode; causes the RETURN key to send the combination of carriage
           return and line feed: 0x0D, 0x0A. When turned off, it sends only the carriage
           return character, 0x0D.
 set delasbs  Delete will be sent as backspace.
 set escape _character_
           Specifies the character that will switch from Telnet session mode to the
           Telnet command mode. From command mode, press ENTER to return to session mode.
 set localecho  Turn on local echo. All characters typed will be displayed on the local console.
               Remote Telnet servers usually send each character typed back, so setting this
               option could result in duplicate characters displayed for each one typed.
 set logfile _name_  The name of the Telnet log file for this session, also turns on logging.
                   The default path is your current directory.
 set logging  Turn on logging for this session.
 Set mode console
          Change the mode of operation to console mode (default).
          Setting the mode to console causes Telnet server to include ANSI or other escape
          commands to control cursor positioning within a fixed window of x rows and y columns.
 Set mode stream
          Change the mode of operation to stream mode.
          Setting the mode to stream turns off the ANSI or other escape commands that
          attempt to control cursor placement or clearing the screen.
          Stream mode is useful when you do not want the Telnet client to emulate a terminal.
          The output is sent as if there is no terminal window with x rows and y columns.
          Some applications that use Telnet for file transfer fail to work correctly when
          console mode is enabled.
 set ntlm Turn on NTLM authentication.
 set term {ansi | vt100 | vt52 | vtnt}  The type of terminal to emulate.
 status   Determines whether the computer running Telnet Client is connected.
 unset    Turns off an option previously set by using the set command.
 ?/help   Display Help.  ?/set Display Help information for the set command.

Anything other than one of the commands above will be sent as a string to the Telnet server.  
For example, send ss64 sends the string ss64 to the Telnet server, which echoes the string in the Telnet session window.

Telnet communicates with the peer (telnet server) in clear text which is a potential security hazard for machines connected to the internet. Telnet traffic can be secured with Internet Protocol security ([IPsec](https://redmondmag.com/articles/2001/04/01/tightening-telnet-step-by-step.aspx))

A more secure alternative to telnet is [SSH](ssh.html) (which is cross platform) or [PuTTY](https://www.chiark.greenend.org.uk/~sgtatham/putty/): A Free Telnet/SSH Client.

Ports
-----

20 & 21 File Transfer Protocol (FTP)  
22 Secure Shell (SSH)  
23 Telnet remote login service (the telnet client default)  
25 Simple Mail Transfer Protocol (SMTP)  
53 Domain Name System (DNS) service  
80 Hypertext Transfer Protocol (HTTP) used in the World Wide Web  
110 Post Office Protocol (POP3)  
119 Network News Transfer Protocol (NNTP)  
143 Internet Message Access Protocol (IMAP)  
161 Simple Network Management Protocol (SNMP)  
194 Internet Relay Chat (IRC)  
443 HTTP Secure (HTTPS)  
465 SMTP Secure (SMTPS)

### Examples

Connect to the remote webserver for ss64.com through HTTP port number 80 and retrieve the home page, note the GET command is case sensitive:

C:> telnet ss64.com 80  
GET /index.html  
<line feed>  

“Is this to be an empathy test? Capillary dilation of the so-called blush response? Fluctuation of the pupil. Involuntary dilation of the iris... Deckard: We call it Voight-Kampff for short” ~ BladeRunner script

### Related commands

[SSH](ssh.html) - OpenSSH remote login client.  
Equivalent bash command (Linux): telnet - Communicate with another host using the TELNET protocol.  
Equivalent PowerShell cmdlet: [Enter-PSSession](../ps/enter-pssession.html)



/. nt/time.html
========================================================

    time - Windows CMD - SS64.com

TIME
====

Display or set the system time.

Syntax

      TIME [_new_time_]  
      TIME
  
      TIME /T

Key
    _new_time_ : The time as _HH_:_MM_

    TIME with no parameters will display the current time and prompt 
    for a new value. Pressing ENTER will keep the same time.

  /T : Just display the time, formatted according to the current Regional settings.

Time Formatting
---------------

> In Control Panel, Regional settings a Time Appearance can be set. This can be used to change the separator, and the number of characters used to display hours and minutes.  
>   
> The time Separator, Country Code and Time format can be read from the registry using [REG](reg.html) as follows:
> 
> @Echo off
> FOR /F "TOKENS=3" %%D IN ('REG QUERY ^"HKEY_CURRENT_USER\Control Panel\International^" /v iCountry ^| find ^"REG_SZ^"') DO (
>         SET _country_code=%%D)
> Echo Country Code %_country_code%
> 
> FOR /F "TOKENS=3" %%D IN ('REG QUERY ^"HKEY_CURRENT_USER\Control Panel\International^" /v sTime ^| find ^"REG_SZ^"') DO (
>         SET _time_sep=%%D)
> Echo Separator %_time_sep%
> 
> FOR /F "TOKENS=3" %%D IN ('REG QUERY ^"HKEY_CURRENT_USER\Control Panel\International^" /v sTimeFormat ^| find ^"REG_SZ^"') DO (
>         SET _time_format=%%D)
> Echo Format %_time_format%

Country Codes/Formats
---------------------

> The default time formats for different country codes are below.  
> These values are user changeable so it is not safe to assue the default will be correct for any particular user.

    **Country/language   Date format  Time format  Country**
                                                **Code**
    United States       MM/dd/yyyy   H:mm:ss.tt  001
  
    Czechoslovakia      dd.MM.yyyy  HH:mm:ss     042
    France              dd.MM.yyyy  HH:mm:ss,tt  033
    Germany             dd.MM.yyyy  HH:mm:ss,tt  049
    Latin America       dd/MM/yyyy   H:mm:ss.tt  003
    Intl. English       dd/MM/yyyy  HH:mm:ss.tt  061
    Portugal            dd-MM-yyyy  HH:mm:ss     351
    Finland               d.M.yyyy  HH.mm.ss     358
    Switzerland         dd.MM.yy    HH mm.ss     041
    Norway              dd.MM.yy    HH:mm:ss     047
    Belgium             dd/MM/yy    HH:mm:ss     032
    Brazil              dd/MM/yy    HH:mm:ss     055
    Italy               dd/MM/yy    HH.mm.ss     039
    United Kingdom      dd/MM/yy    HH:mm:ss     044
    Denmark             dd-MM-yy    HH.mm.ss     045
    Netherlands         dd-MM-yy    HH:mm:ss     031
    Spain                d/MM/yy    HH:mm:ss     034
    Hungary             yyyy.MM.dd  HH:mm:ss     036
    Canadian-French     yyyy-MM-dd  HH:mm:ss     002
    Poland              yyyy-MM-dd  HH:mm:ss     048
    Sweden              yyyy-MM-dd  HH.mm.ss     046

yyyy = 4 digit year
  yy = 2 digit year
  dd = 2 digit day
    d = 1/2 digit day
  HH = 2 digit Hour
    H = 1/2 digit hour
  mm = 2 digit minutes
  ss = 2 digit seconds
  tt = AM/PM indicator
    t = a/p indicator

Errorlevels
-----------

> If the time was successfully changed (or not given) [%ERRORLEVEL%](errorlevel.html) = 0  
> If it fails, e.g. the user lacks the privilege [%ERRORLEVEL%](errorlevel.html) = 1

TIME is an [internal](syntax-internal.html) command. In early versions of Windows, disabling [Command Extensions](cmd.html) will disable the /T switch.

### Examples

Display the time:  
  
C:> TIME /t  
09:27

Display the time including Seconds and Hundredths of a second:  
  
C:> ECHO:| TIME  
The current time is: 09:28:55.73

“Time is like money, the less we have of it to spare, the further we make it go” - Josh Billings

### Related commands

%TIME% - Dynamic [variable](syntax-variables.html) containing the current time HH:mm:ss.  
[DATE](date.html) - Display or change the date.  
[NOW](now.html) - Display Message with Current Date and Time.  
[W32TM](w32tm.html) - Time Service.  
[TZUTIL](tzutil.html) - Time Zone Utility.  
[GetTime.cmd](syntax-gettime.html) - Script to get current time.  
[GMT.cmd](syntax-gmt.html) - Current time in GMT (World Time).  
[Custom date and time format strings](https://docs.microsoft.com/en-us/dotnet/standard/base-types/custom-date-and-time-format-strings) - Microsoft.com  
[The Time Zone Database](https://www.iana.org/time-zones) - IANA.  
Equivalent PowerShell: [Get-Date](../ps/get-date.html) - Get current date and time.  
Equivalent bash command (Linux): [date](../bash/date.html) - Display or change the date & time.



/. nt/timeout.html
========================================================

    Timeout - delay in seconds - Windows CMD - SS64.com

TIMEOUT.exe
===========

Delay execution for a few seconds or minutes, for use within a batch file.

Syntax

      TIMEOUT -T _delay_ [/nobreak] 

Key
    _delay_  Delay in seconds (between -1 and 100000) to wait before continuing. 
          The value -1 causes the computer to wait indefinitely for a keystroke 
          (like the PAUSE command)

    /nobreak
          Ignore user key strokes.

Timeout will pause command execution for a number of seconds, after which it continues without requiring a user keystroke. If the user does press a key at any point, execution will resume immediately.

A timeout of 1 second will wait until the "next second" so in practice may be as short as 1/10th of a second.

A more accurate delay can be produced by the [PING](ping.html) command with a loopback address (127.0.0.1), there is a delay of 1 second between each consecutive ping, so 3 pings will produce a delay of 2 seconds, 11 pings will produce a delay of 10 seconds and so on.

In tests PING consumes less processor time than Sleep.exe or Timeout.exe, this allows other processes to run in the background. The PING command can only be interrupted with Ctrl-C. Source: [Clay Calvert](https://groups.google.com/forum/#!msg/alt.msdos.batch.nt/nSRpfQE-lko/WEWG9aCfSoAJ) (usenet 2001.)

### Examples

@Echo off
Echo Start Microsoft Word, wait for 10 seconds and then start Excel.
[START](start.html) "" "C:Program Files (x86)\Microsoft Office\Office16\WINWORD.EXE"
TIMEOUT /T 10
[START](start.html) "" "C:Program Files (x86)\Microsoft Office\Office16\EXCEL.EXE"

Set a delay for 40 seconds:  
PING -n 41 127.0.0.1>nul  
Echo Now we are ready

Wait for **up to** 600 seconds for a file to appear on a remote server:
Set _seconds=0
:waitloop
  :: Wait for 10 seconds
  Set /a "_seconds=_seconds+10">nul
  PING -n 11 127.0.0.1>nul
  :: If 600 seconds have elapsed exit the loop
  if %_seconds%==600 goto nextstep
  if not exist \Server64\updates\monday.csv goto waitloop
:nextstep 
copy \Server64\updates\monday.csv D:\imports\

“It is awful work this love and prevents all a mans projects of good or glory” ~ Lord Byron

### Related commands

[CHOICE](choice.html) /T _Timeout_ - Accept keyboard input to a batch file.  
[PAUSE](pause.html) - Suspend processing of a batch file and display a message.  
[SLEEP](sleep.html) - Delay execution for a few seconds/minutes (for use within a batch file).  
[WAITFOR](waitfor.html) - Wait for or send a signal.  
Equivalent PowerShell: [Start-Sleep](../ps/start-sleep.html) - Suspend shell, script, or runspace activity (sleep).



/. nt/title.html
========================================================

    Title - Windows CMD - SS64.com

TITLE
=====

Change the title text displayed across the top of the CMD terminal window.

Syntax 
      TITLE [_string_]

Key
    _string_   The title for the command prompt window, up to [243](https://ss64.org/viewtopic.php?t=116) characters.

The TITLE command is typically used in a batch file to give the script window a meaningful name.

The default title for the CMD shell is %comspec% however, since the title can be re-defined in a program shortcut, the title is typically set to "Command Prompt".

If you start a second CMD shell, or PowerShell, this will be added to the Title, when you [EXIT](exit.html) back to the initial shell, the Title will also revert making it possible to track how many nested shells you have open.

The [START](start.html) command, used to start a program in a separate window also has an option to specify a title for the new Window.

If you call a batch script in a new CMD session, then any TITLE set within the batch file will revert when the second CMD session ends.

  TITLE Some initial title text
  CMD /c MyBatchFile.cmd
  ...

TITLE is an [internal](syntax-internal.html) command.

### Examples

Set a title for the current session:  
  
C:> title Remember, all I’m offering is the truth. Nothing more

Set the default %comspec% title:  
  
C:> title %comspec%

In a batch file, set the title to match the name of the batch file with:  
  
@Echo off  
TITLE [%~](syntax-args.html)nx0

"The longer the title, the less important the job" - George McGovern.

### Related commands

[MODE](mode.html) - change the size of the CMD window.  
[COLOR](color.html) - change the colour of the CMD window.  
[PROMPT](prompt.html) - change the CMD window prompt.  
[START](start.html) - start a program in a separate window.  
[Max length of the TITLE command](https://ss64.org/viewtopic.php?f=2&t=116) - SS64 forum.  
QuickEdit mode - also changes the title (temporarily).  
Equivalent PowerShell: Set the [console title](https://devblogs.microsoft.com/powershell/setting-the-console-title-to-be-your-current-working-directory/) to current working dir (save in Profile.ps1 to make permanent).



/. nt/tlist.html
========================================================

    Tlist - Task list - Windows CMD - SS64.com

TLIST ([Resource Kit](../links/windows.html#kits) & Windows 2000 support tools)
===============================================================================

Task List.  
  
Show the command, command line, working directory, memory usage and DLLs for each running task. This command is no longer supplied with recent versions of the Windows resource kit, having been replaced by TASKLIST, however if you can find a copy Tlist does have the advantage of showing the full path of the process.

Syntax

      TLIST
      TLIST -t
      TLIST _pid_
      TLIST -t _pid_
      TLIST _pattern_
      TLIST -t _pattern_

Key
    -t   : Show Task dependencies in Tree form
  
    pid  : List module information for this task
          if no PID is given - all Tasks are listed
     
pattern : A complete task name or expression pattern (e.g. CMD.*)
          if a pattern is given it will match against
          task names or window titles.

### Examples

Batch file to show the full path of all running programs:

@ECHO off
FOR /f "tokens=1" %%G in ('tlist') DO (call :s_item %%G)
GOTO :eof

:s_item
tlist %1 | find "CmdLine"

_"When I first started running, I was so embarrassed, I'd walk when cars passed me. I'd pretend I was looking at the flowers" ~ Joan Benoit Samuelson, 1984 Olympic Marathon gold medalist_

### Related commands

[PsList](pslist.html) - List detailed information about processes.  
[TASKLIST](tasklist.html) - List running applications and services.  
[MSINFO32](msinfo32.html) - Windows diagnostics.  
Equivalent PowerShell: [Get-Process](../ps/get-process.html) - Get a list of processes on a machine (ps/gps).  
Equivalent bash command (Linux): [ps](../bash/ps.html) - Process status, information about processes running in memory.



/. nt/touch.html
========================================================

    Touch - Change file timestamp - Windows CMD - SS64.com

TOUCH (Windows 2000 [Resource Kit](../links/windows.html#kits))
===============================================================

Change file timestamps

Syntax

      TOUCH [_option_]... _files_ ...

Key
    /t _year month day hour minute second_

This is a POSIX utility.  
  
Use the optional argument /t to specify a date other than the current time.  
( four-digit years, two-digit months, days, hours, minutes, seconds)

An alternative Touch using the COPY command.
--------------------------------------------

> As first documented in the ancient (MSDOS) KB article [Q69581](https://web.archive.org/web/20010217184808/http://support.microsoft.com/support/kb/articles/Q69/5/81.ASP) the [COPY](copy.html) /b command can be used to touch the date/time of a file:
> 
> COPY /B Source.txt+,,Source.txt
> 
> This takes a source file, adds nothing (represented by the commas) and copies it to the same file as a destination. If you are working in a single folder, the second filename can be omitted as it will default to writing the same filename.
> 
> or as a batch file:
> 
> @Echo Off  
> COPY /B %1+,, %1
> 
> There are a few caveats with this technique:  
> It fails for read-only or [hidden](attrib.html) files.  
> It may reset file permissions back to the default for the folder.  
> In some versions of Windows, if the file is 0 bytes long it will be deleted!  
> If the file is a binary file with trailing null characters (0x00), they will be deleted, corrupting the file.  
> It is no longer a documented option in current versions of Windows.
> 
> A better alternative is PowerShell, you can call a [one-line script](../ps/syntax-touch.html) with [powershell.exe](../ps/powershell.html)

### Examples

Set the date to 7:30 am 1st October 2022:  
  
C:> TOUCH /t 2022 10 01 07 30 00 MyFile.txt

#And smiles you'll give and tears you'll cry  
And all you touch and all you see  
Is all your life will ever be# ~ Pink Floyd (Breathe)

### Related commands

[Q299648](https://web.archive.org/web/20140208235803/https://support.microsoft.com/kb/299648) - Date and Time Stamps for Files and Folders (FAT vs NTFS)  
[COPY](copy.html) - Copy one or more files to another location.  
Equivalent PowerShell Script: [touch](../ps/syntax-touch.html) - Change file timestamps.  
Equivalent bash command (Linux): [touch](../bash/touch.html) - Change file timestamps.



/. nt/tracert.html
========================================================

    Tracert - Windows CMD - SS64.com

TRACERT
=======

Trace Route - Find the IP address of any remote host. TRACERT is useful for troubleshooting large networks where several paths can be taken to arrive at the same point, or where many intermediate systems (routers or bridges) are involved.

Syntax  
      TRACERT [_options_] _target_name_

Key
    _target_name_     The HTTP or UNC name of the host

Options:
    -d             Do not resolve addresses to hostnames.
                   (avoids performing a DNS lookup)

    -h _max_hops_    Maximum number of hops to search for target.(default=30)

    -j _host-list_   Trace route along given host-list. 
                   up to 9 hosts in dotted decimal notation, separated by spaces.

    -w _timeout_     Wait _timeout_ milliseconds for each reply.

The functionality of TRACERT is the same under all versions of windows but the output is cosmetically improved under XP.

Tracert uses the IP TTL field and ICMP error messages to determine the route from one host to another through a network.

Care must be taken with tracert as it shows the optimal route, not necessarily the actual route. To be accurate, it is possible to **ping** from a UNIX machine back to the PC using the -R option to record the route taken - but only if the particular network devices support it.

This diagnostic tool determines the path taken to a destination by sending ICMP Echo Request messages with varying Time to Live (TTL) values to the destination.

TTL (Time to Live) calculation
------------------------------

> TTL is effectively a count of the (maximum) number of links to the destination host. Each router along the path decrements the TTL in an IP packet by at least 1 before forwarding it.
> 
> When the TTL on a packet reaches 0, the router is expected to return an ICMP _Time Exceeded_ message to the source computer.
> 
> Tracert determines the path by sending the first Echo Request message with a TTL of 1 and incrementing the TTL by 1 on each subsequent transmission until either the target host responds or the maximum number of hops is reached.
> 
> This process relys on intermediate routers to return ICMP _Time Exceeded_ messages. However, some routers do not return _Time Exceeded_ messages for packets with expired TTL values and are invisible to the tracert command. In this case, a row of asterisks (*) is displayed for that hop.

Firewalls
---------

> Many firewalls will block ICMP traffic by default. If an attacker is able to forge ICMP redirect packets, he or she can alter the routing tables on the host and possibly subvert the security of the host by causing traffic to flow via a path you didn’t intend.

### Examples

 TRACERT www.doubleclick.net

 TRACERT 123.45.67.89

 TRACERT local_server

Get your kicks on ROUTE 66 ~ Jack Kerouac.

### Related commands

[NSLOOKUP](nslookup.html) - Name server lookup.  
[PING](ping.html) - Test a network connection.  
[PATHPING](pathping.html) - Trace route and provide network latency and packet loss for each router and link in the path.  
[ROUTE](route.html) - Manipulate network routing tables.  
[Q314868](https://support.microsoft.com/en-gb/help/314868/) - How to use TRACERT to troubleshoot TCP/IP.  
[TRACE.bat](http://www.pc-help.org/trace.htm) - PCHelp's handy report on any given Internet address.  
Equivalent bash command (Linux): [traceroute](../bash/traceroute.html) - Print the route packets take to network host.



/. nt/tree.html
========================================================

    TREE - Windows CMD - SS64.com

TREE.com
========

Display the folder structure of a drive or path as a graphical tree.

Syntax

      TREE [_drive_:][_path_] [/F] [/A]
Key
    [_drive_:][_path_]  The startng directory for the tree listing.

    /F   Display the names of the files in each folder.

    /A   Use ASCII instead of extended characters.

Like the DIR command, the first two lines of output from Tree are the Volume Label and Serial Number, in Windows 10 the Serial number is prefixed with the Device ID.

The output can be [redirected](syntax-redirection.html) to a file with > c:\filename.txt

### Examples

Display a tree for the "C:\Program Files" folder:  
tree "C:\program files"

Display a tree for the users home folder:  
tree %homedrive%%homepath%  
  
or from PowerShell:  
tree $home

“The significance of the cherry blossom tree in Japanese culture goes back hundreds of years. In their country, the cherry blossom represents the fragility and the beauty of life. It's a reminder that life is almost overwhelmingly beautiful but that it is also tragically short” ~Homaro Cantu

### Related commands

[DIR](dir.html) - Display a list of files and folders.  
[DIRUSE](diruse.html) - Show size of multiple subfolders. (Resource Kit)  
[VOL](vol.html) - Display a disk label.



/. nt/tsdiscon.html
========================================================

    TSDISCON - Windows CMD - SS64.com

TSDISCON.exe
============

Disconnect a Remote Desktop Session.

Syntax

      tsdiscon [_SessionID_ | _SessionName_] [/server:_ServerName_] [/v]

Key
    SessionId    The ID of the session to disconnect.

    SessionName  The name of the session to disconnect.

    ServerName   The terminal server containING the session to disconnect.
                Default=the current RD Session Host server.

    /v           Display verbose information.

    /?           Display help at the command prompt.

You must have Full Control permission or Disconnect special access permission to disconnect another user from a session.

If no session ID or session name is specified, tsdiscon disconnects the current session. Any applications that were running when you disconnected the session are automatically running when you reconnect to that session with no loss of data.

Use reset session to end the running applications of the disconnected session, but be aware that this might result in loss of data at the session. The /server parameter is required only if you use tsdiscon from a remote server. The console session cannot be disconnected.

### Examples

Disconnect the current session:

C:> tsdiscon

Disconnect session 10:

C:> tsdiscon 10

Disconnect the session named TERM64:

C:> tsdiscon TERM64

“One final paragraph of advice: Do not burn yourselves out. Be as I am - a reluctant enthusiast…a part time crusader, a half-hearted fanatic. Save the other half of yourselves and your lives for pleasure and adventure. It is not enough to fight for the land; it is even more important to enjoy it. While you can. While it’s still here.” ~ Edward Abbey

### Related commands

[MSTSC](mstsc.html) - Terminal Server Connection (Remote Desktop Protocol).  
[QUERY session](query-session.html) - List TS sessions.  
TSCON - Connect to another session on a Remote Desktop Session Host (RD Session Host) server.  
[TSPROF](tsprof.html) - Set the Terminal Server profile path for a user  
[Q321705](https://web.archive.org/web/20140416071155/https://support.microsoft.com/kb/321705) - Disconnect a TS Session using TSDISCON.  
[SuperUser](https://superuser.com/questions/401283/display-user-selection-screen-tsdiscon-exe-instead-of-lock-screen-after-screen) - Display User Selection screen instead of lock screen after screensaver inactivity.



/. nt/tskill.html
========================================================

    TSKILL - Kill Task - Windows CMD - SS64.com

TSKILL
======

End a process running in a session on a Remote Desktop Session Host (RD Session Host) server.  
  
Tskill can be used to end any process that belongs to you, unless you are an administrator. Administrators have full access to all tskill functions and can end processes that are running in other user sessions.

Syntax

      TSKILL _processid_ | _processname_ [ /SERVER:_servername_] [ /ID:_sessionid_ | /A] [ /V]

Key
    _processid_           Process ID for the process to be terminated.

    _processname_         Process name to be terminated
                       (Usually the name of the executable with trimmed ".exe" suffix).

    /SERVER:_servername_  Server containing processID (default is current).
                          /ID or /A must be specified when using processname
                          and /SERVER

    /ID:_sessionid_       End process running under the specified session (default is current).
    /A                  End process running under ALL sessions.

    /V                  Display information about actions being performed.

processname is limited to 18 characters.

When all processes that are running in a session end, the session also ends.

If you use the ProcessName and the /server:ServerName parameters, you must also specify either the /id:SessionID or the /a parameter. This is because potentially multiple users could be running the same program.

### Examples

Terminate a running instance of notepad.

tskill notepad

Terminate the running process #6464.

tskill 6464

"Managers tend to treat organizations as if they are infinitely plastic. They hire and fire, merge, downsize, terminate programs, add capacities. But there are limits to the shifts that organizations can absorb" ~ Kevin Kelly

### Related commands

[TASKKILL](taskkill.html) - End a running process.  
[PsKill](pskill.html) - Kill processes by name or process ID.  
[WMIC](wmic.html) PROCESS where name='evil.exe' delete  
[WMIC](wmic.html) PROCESS where processid='6464' delete  
Equivalent PowerShell: [Stop-Process](../ps/stop-process.html) - Kill a process.  
Equivalent bash command (Linux): [kill](../bash/kill.html) - Kill a process.



/. nt/type.html
========================================================

    Type - Display a text file - Windows CMD - SS64.com

TYPE
====

Display the contents of one or more text files.

Syntax

      TYPE [_drive_:]_pathname_(s)

If more than one file is specified the filenames are included in the output.  
If a wildcard is used the filenames are displayed even if only one file matches. The file names are printed to the error stream and so can be hidden by [redirecting](syntax-redirection.html) to NUL  TYPE * 2>nul

In Windows 1909 or newer, if the text file incluses [ANSI](syntax-ansi.html) color escapes, they will be decoded and displayed in color.

Errorlevels
-----------

> If the file(s) were successfully displayed [%ERRORLEVEL%](errorlevel.html) = 0  
> If the file was not found or bad parameters given [%ERRORLEVEL%](errorlevel.html) = 1

TYPE is an [internal](syntax-internal.html) command.

### Examples

Redirect output into a new file:  
  
TYPE file.txt > Newfile.txt  
  
Append output to an existing file:  
  
TYPE file.txt >> ExistingFile.txt  
  
To do the same with [user console](con.html) input:  
  
TYPE CON > Newfile.txt  
  
This will require typing a CTRL-Z to indicate the end of file.  
  
When using redirection to SORT a file the TYPE command is used implicitly  
For example:  
  
SORT < MyFile.txt

Create an empty (zero byte) file:  
TYPE nul >filename.log

Check filesize during a download (to monitor progress of a large download) Since TYPE won’t lock the file, this does not pose a threat to the download completing successfully:

TYPE _file_being_downloaded_ >NUL 
DIR _file_being_downloaded_

Convert an ASCII (Windows1252) file into a Unicode (UCS-2 le) text file:  

For /f "tokens=2 delims=:" %%G in ('CHCP') do Set _codepage=%%G  
CHCP 1252 >NUL  
CMD.EXE /D /A /C (SET/P=ÿþ)<NUL > unicode.txt 2>NUL  
CMD.EXE /D /U /C TYPE ascii_file.txt >> unicode.txt  
CHCP %_codepage%

The technique above (based on a [script](https://www.robvanderwoude.com/type.php) by Carlos M.) first creates a file with a [Byte Order Mark](https://docs.microsoft.com/en-us/globalization/encoding/byte-order-mark) (BOM) and then appends the content of the original file. [CHCP](chcp.html) is used to ensure the session is running with the Windows1252 code page so that the characters 0xFF and 0xFE (ÿþ) are interpreted correctly.

_“Writing is easy; all you do is sit staring at a blank sheet of paper until the drops of blood form on your forehead” ~ Gene Fowler_

### Related commands

[MORE](more.html) - Display output, one screen at a time.  
[SORT](sort.html) - Sort input.  
[STRINGS](strings.html) - Search for [ANSI](syntax-ansi.html) and UNICODE strings in binary files (SysInternals).  
Equivalent PowerShell: [Get-Content](../ps/get-content.html) - Get content from item (cat / type / gc).  
Equivalent bash command (Linux): [cat](../bash/cat.html) - Display the contents of a file.



/. nt/typeperf.html
========================================================

    TypePerf - Windows CMD - SS64.com

TypePerf.exe
============

Write performance data to the command window or to a log file. To stop Typeperf, press CTRL+C.

Syntax

      typeperf _counter_ [_counter_ ...] [_options_]

      typeperf -cf _filename_  [_options_]

      typeperf -q [_object_] [_options_]

      typeperf -qx [_object_] [_options_]

Key
    _counter_              The [Performance counters](syntax-performance-counters.html) to monitor.
    -f {CSV|TSV|BIN|SQL} Output file format. Default is CSV.
    -cf _filename _        File containing performance counters to monitor, one per line.
    -si [[_hh_:]_mm_:]_ss_     Time between samples. Default is 1 second.
    -o _filename_          Path of output file or SQL database.
                        Default is STDOUT.
    -q [_object_]          List installed counters (no instances).
                        To list counters for one object, 
                        include the object name, such as Processor.
    -qx [_object_]         List installed counters with instances.
                        To list counters for one object, 
                        include the object name, such as Processor.
    -sc _samples_          Number of samples to collect. Default is
                        to sample until CTRL+C.
    -config _filename_     Settings file containing command options.
    -s _computer_name_     Server to monitor if no server is specified in the counter path.
    -y                   Answer yes to all questions without prompting.
    -?                   Display context sensitive help.

_Counter_ is the full name of a performance counter in the format:"\_Computer__Object_(_Instance_)_Counter_"  
e.g. "\Server1\Processor(0)\% User Time".

### Examples

Display % Processor time until interrupted:

C:> typeperf "\Processor(_Total)\% Processor Time"

Gather 600 samples of % Processor time on the local computer (this will take 10 minutes):

C:> typeperf "\processor(_Total)\% Processor Time" -O C:\SS64demo1.csv -SC 600

Gather samples of all the counters listed in counters.txt :

C:> typeperf -cf counters.txt -si 5 -sc 50 -o C:\SS64demo2.csv

_“Weekends don’t count unless you spend them doing something completely pointless” ~ Bill Watterson_

### Related commands

[LOGMAN](logman.html) - Manage Performance Monitor.  
Equivalent PowerShell: [New-Object](../ps/new-object.html) System.Diagnostics.PerformanceCounter.  
Equivalent PowerShell: [Get-CIMinstance](../ps/get-ciminstance.html) Win32_Process -Filter "Name='System idle process'" | Format-List Name, KernelModeTime



/. nt/tzutil.html
========================================================

    tzutil - Windows CMD - SS64.com

TZUTIL.exe
==========

Time Zone Utility.

Syntax

      TZUTIL /g | /l | /s "_[TimeZoneValue](../timezones.html)_[_dstoff]" | /?

Key
    /g   Display the current time zone value.

    /l   List all valid time zone values and display names in the following format:

    /s   Set the time zone to _TimeZoneValue_
        The **_dstoff** suffix will disable Daylight Savings Time adjustment
        for the time zone (where applicable).

    /?  Display help.

TZUTIL does not require elevation, the time zone only applies to the current logged in user.

### Examples

Display the current time zone id

%SYSTEMROOT%\System32\tzutil.exe /g

Set the current time zone to Pacific Standard Time

tzutil /s "Pacific Standard Time"

Set the current time zone to Pacific Standard Time and disable Daylight Saving Time adjustment

tzutil /s "Pacific Standard Time_dstoff"

“We have a normal. As you move outside of your comfort zone, what was once the unknown and frightening becomes your new normal” ~ Robin S. Sharma

### Related commands

[DATE](date.html) - Display or change the date.  
[TIME](time.html) - Display or set the system time.  
[Time Zones](../timezones.html) _-_ A full, sortable list of time zones.  
[W32TM](w32tm.html) - Time Service.  
PowerShell: [Get-TimeZone](../ps/get-timezone.html) / [Set-TimeZone](../ps/set-timezone.html)



/. nt/vbc.html
========================================================

    VBC - Visual Basic compiler - Windows CMD - SS64.com

VBC.exe
=======

.Net Visual Basic compiler.

Syntax

      VBC.exe _program_.vb _options_

Options
    @(_Response-File_)   A response file.
    -additionalfile 	  Additional files that don’t directly affect code generation but may be used by analyzers for errors/warnings.
    -addmodule:_fileList_  Causes the compiler to make all type information from the specified file(s) available to the project.
    -analyzer 	          Run the analyzers from this assembly (Short form: -a)
    -baseaddress:_address_  The base address when creating a DLL.
    -bugreport:_file_     Create a file that contains information that makes it easy to report a bug.
    -checksumAlgorithm:{SHA1, SHA256}. The algorithm for calculating the source file checksum stored in PDB.
                      Due to collision problems with SHA1, Microsoft recommends SHA256 or better.
    -codepage:_id_       The code page to use for all source code files in the compilation.
    -debug:[full | pdbonly] 	Produce debugging information.
    -define:_symbol_=_value_,..  Define symbols for conditional compilation.
    -delaysign 	      Specifies whether the assembly will be fully or partially signed.
    -deterministic 	  Output an assembly whose binary content is identical across compilations if inputs are identical.
    -doc:_file_          Process documentation comments to an XML file.
    -errorreport{ prompt | queue | send | none } 	Report VB internal compiler errors (ICE) to the VB team at Microsoft.
    -filealign 	      Where to align the sections of the output file,most developers do not need to use this option.
    -help 	            Display compiler options. The same as -? No compilation occurs.
    -highentropyva[+ | -]   Support high entropy Address Space Layout Randomization (ASLR).
    -imports:_namespaceList_  Import a namespace from a specified assembly.
    -keycontainer:_container_ A key container name for a key pair to give an assembly a strong name.
    -keyfile:_file_      A file that contains a key or key pair to give an assembly a strong name.
    -langversion:_version_  Language version: 9|9.0|10|10.0|11|11.0.
    -libpath:_dirList_   The location of assemblies referenced by the -reference option.
    -link:_fileList_     Make COM type information in the specified assemblies available to the project.
    -linkresource:_filename_[,_identifier_[,public|private]] 	Create a link to a managed resource.
    -main:_location_ 	  A class that contains the Sub Main procedure to use at startup.
    -moduleassemblyname:_assembly_name_ 	The name of an assembly that a module will be a part of.
    -modulename: _string_  The name of the source module
    -netcf 	          Set the compiler to target the .NET Compact Framework.
    -noconfig 	        Do not compile with Vbc.rsp.
    -nologo          	Suppress compiler banner information.
    -nostdlib 	        Causes the compiler not to reference the standard libraries.
    -nowarn[:_numberList_] 	Warning ID numbers that the compiler should suppress. If no IDs in list all warnings are suppressed.
    -nowin32manifest 	Instructs the compiler not to embed any application manifest into the executable file.
    -optimize[ + | - ] Enables or disable code optimization.
    -optioncompare:{binary | text} 	Whether string comparisons should be binary or use locale-specific text semantics.
    -optionexplicit 	  Enforce explicit declaration of variables, does not override source code statements.
    -optioninfer 	    Enable the use of local type inference in variable declarations.
    -optionstrict 	    Enforces strict language semantics.
    **-out:**_filename_ 	    The output file.
    -parallel[+|-] 	  Whether to use concurrent build (+).
    -platform{ x86 | x64 | Itanium | arm | anycpu | anycpu32bitpreferred } The processor to target for the output file.
    -preferreduilang 	The preferred output language name.
    -quiet 	          Prevent the compiler from displaying code for syntax-related errors and warnings.
    -recurse:[_dir_\]_file_  Search subdirectories for source files to compile.
    -reference:_fileList_  Import metadata from an assembly.
    -refonly 	        Output only a reference assembly.
    -refout:_filepath_ 	The output path of a reference assembly.
    -removeintchecks[+ | -] 	Disable [-] or Enable[+] integer overflow checking.
    -resource:_filename_[,_identifier_[,public|private]]  Embed a managed resource in an assembly.
    -rootnamespace:_namespace_  A namespace for all type declarations.
    -ruleset:_file_ 	    A ruleset file that disables specific diagnostics.
    -sdkpath:_path_      Specifies the location of Mscorlib.dll and Microsoft.VisualBasic.dll.
    -subsystemversion:_major_._minor_ 	The minimum version of the subsystem that the generated executable file can use.
    -target:{exe | library | module | winexe | appcontainerexe | winmdobj} 	The format of the output file.
    -utf8output 	      Display compiler output using UTF-8 encoding.
    -vbruntime:{ - | + | * | _path_ }   Compile with or without a reference to the VB Runtime Library, or with
                      a reference to a specific runtime library.
    -verbose 	        Output extra information during compilation.
    -warnaserror 	    Promote warnings to errors.
    -win32icon:_filename_ Insert an .ico file into the output file.
    -win32manifest:_fileName_  A user-defined Win32 application manifest to embed into the project's portable executable (PE) file.
    -win32resource:_filename_  Insert a Win32 resource into the output file.
    -? 	              Display compiler options. The same as -help. No compilation occurs.

The .Net 2.0 vbc.exe is located in the system drive/path at C:\Windows\Microsoft.NET\Framework\v2.0.50727\vbc.exe  
The .Net 4.0 vbc.exe is located in the system drive/path at C:\Windows\Microsoft.NET\Framework\v4.0.30319\vbc.exe  
VBC is not on the default system PATH.

### Examples

Compile a VB program to create an executable:

C:> C:\Windows\Microsoft.NET\Framework\v4.0.30319\vbc "C:\code\demo.vb" /out:"C:\code\demo.exe" /target:exe

_“One resolution I have made, and try always to keep, is this: To rise above little things” ~ John Burroughs_

### Related commands

[Visual Basic command-line compiler](https://docs.microsoft.com/en-us/dotnet/visual-basic/reference/command-line-compiler/) - Microsoft



/. nt/ver.html
========================================================

    Ver - OS version - Windows CMD - SS64.com

VER
===

Display the current operating system version.

Syntax

      VER

A very simple method of version checking is to pipe a version string into FIND, however there is a possibility that something which is a unique string today might match a minor version released in the future.

e.g. the following would also match "7.6.1"  

ver | find "6.1" > nul
if %ERRORLEVEL% == 0 goto ver_2008R2

PowerShell to retrieve Version / Release ID
-------------------------------------------

> The VER command returns the Major/Minor / Build number, but does not include the Version/Release ID as displayed in Settings ➞ About.
> 
> The Release ID is a 4 digit code - a 2 digit year plus 2 digit planned month of release. 1703,1809...  
> DisplayVersion is a 4 digit code - a 2 digit year plus H1 or H2.. for 1st, 2nd releases. 20H2, 21H1…
> 
> Mobile, Desktop and Server releases will have the same Version/Release ID but different build numbers.
> 
> For Windows 10 up to May 2020 / 2004, this can be retrieved from the registry via the **ReleaseID**:
> 
> $release = (Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion" -Name ReleaseId).ReleaseId
> 
> For all later versions, this can be retrieved from the registry via the **DisplayVersion**:
> 
> $ver = (Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion" -Name DisplayVersion).DisplayVersion
> 
> The ReleaseID is now deprecated and will return '2009' for 20H2 and all subsequent versions of Windows.
> 
> If ($release -lt '2009') {$release} Else {$ver}

List of Windows Version numbers
-------------------------------

> Windows Version Numbers
> 
> Product name
> 
> Major version.build
> 
> Release ID
> 
> Version
> 
> Windows 95
> 
> 4.0.950
> 
>  
> 
>  
> 
> Windows XP
> 
> 5.1.2600
> 
>  
> 
>  
> 
> Windows Vista, Service Pack 2
> 
> 6.0.6002
> 
>  
> 
>  
> 
> Windows 7, RTM (Release to Manufacturing)
> 
> 6.1.7600.16385
> 
>  
> 
>  
> 
> Windows 8, RTM
> 
> 6.2.9200.16384
> 
>  
> 
>  
> 
> Windows 10 Gold
> 
> 10.0.10240
> 
> 1507
> 
>  
> 
> Windows 10 November Update, 2015-11-03
> 
> 10.0.10586
> 
> 1511
> 
>  
> 
> Windows 10 Aniversary Update 2016-08-02
> 
> 10.0.14393.1794
> 
> 1607
> 
>  
> 
> Windows 10 Creators Update 2017-04-11
> 
> 10.0.15063.674
> 
> 1703
> 
>  
> 
> Windows 10 Fall Creators Update 2017-10-17
> 
> 10.0.16299.19
> 
> **1709**
> 
>  
> 
> Windows 10 April 2018 Update
> 
> 10.0.17134
> 
> 1803
> 
>  
> 
> Windows 10 October 2018 Update
> 
> 10.0.[17763.55](https://support.microsoft.com/en-gb/help/4464330/windows-10-update-kb4464330)
> 
> **1809**
> 
>  
> 
> Windows 10 version 1903 (May 2019 Update)
> 
> 10.0.18362.239
> 
> 1903
> 
>  
> 
> Windows 10 version 1909 (Nov 2019 Update)
> 
> 10.0.18363
> 
> **1909**
> 
>  
> 
> Windows 10 version 2004 (May 2020 Update)
> 
> 10.0.19041
> 
> 2004
> 
>  
> 
> Windows 10 version 20H2 (October 2020 Update)
> 
> 10.0.19042
> 
> 2009
> 
> 20H2
> 
> Windows 10 version 21H1 (May 2021 Update)
> 
> 10.0.19043
> 
> 2009
> 
> 21H1
> 
> Windows 10 version 21H2 (October 2021 Update)
> 
> 10.0.19044
> 
> 2009
> 
> 21H2
> 
> Windows 10 version 22H2 (October 2022 Update)
> 
> 10.0.19045
> 
> 2009
> 
> 22H2
> 
> Windows 11
> 
> 10.22000.194  
> 10.22000.1042
> 
> 2009
> 
> 21H2
> 
> Windows 11 version 22H2 (September 2022 Update)
> 
> 10.22621.521
> 
> 2009
> 
> 22H2
> 
>  
> 
>  
> 
>  
> 
> 23H2
> 
>   
> 
> Server versions
> 
> Product name
> 
> Major version / build
> 
> Release ID
> 
> Version
> 
> Windows Server 2003
> 
> 5.2.3790
> 
>  
> 
>  
> 
> Windows Server 2008
> 
> 6.0.6001
> 
>  
> 
>  
> 
> Windows Server 2008 R2, RTM
> 
> 6.1.7600.16385
> 
>  
> 
>  
> 
> Windows Server 2012
> 
> 6.2.9200
> 
>  
> 
>  
> 
> Windows Server 2012 R2
> 
> 6.3.9600
> 
>  
> 
>  
> 
> Windows Server 2016 RTM 2016-09-26
> 
> 10.0.14393
> 
> 1607
> 
>  
> 
> Windows Server 2016 Aniversary Update 2017-03-22
> 
> 10.0.14393.970
> 
> 1703
> 
>  
> 
> Windows Server 2016 Fall Creators Update
> 
> 10.0.16299.15
> 
> 1709
> 
>  
> 
> Windows Server 2019 (Semi-Annual Channel) (Datacenter, Standard)
> 
> 10.0.17134.1
> 
> 1803
> 
>  
> 
> Windows Server 2019
> 
> 10.0.18342
> 
> 1903
> 
>  
> 
> Windows Server 2019
> 
> 10.0.17763
> 
> 1909
> 
>  
> 
> Windows Server 2019
> 
> 10.0.19041
> 
> 2004
> 
>  
> 
> Windows Server 2019
> 
> 10.0.19042
> 
> 2009
> 
> 20H2
> 
> Windows Server 2022 (preview)
> 
> 10.0.20285
> 
> 2009
> 
>  
> 
> See also [Microsoft Windows 10 release history](https://docs.microsoft.com/en-gb/windows/release-health/), [support dates](https://docs.microsoft.com/en-us/windows-server/get-started/windows-server-release-info).

Finding the version remotely
----------------------------

> PowerShell can be used to find the OS versions of multiple machines across a domain:
> 
> [Get-ADComputer](../ps/get-adcomputer.html) -Filter {OperatingSystem -like "Windows 10*"} -Property * | Format-Table Name,OperatingSystem,OperatingSystemVersion -Wrap –Auto

Service Pack Level
------------------

> This batch [script](spack.txt) or this [PowerShell script](../ps/syntax-osversion.html) will return the Service Pack level.  

32 bit or 64 bit OS detection
-----------------------------

> The environment variable PROCESSOR_ARCHITECTURE holds the following possible values:
> 
> 64-bit process: AMD64 or IA64  
> 32-bit process or WOW64 ([32bit Program](syntax-64bit.html) on 64 bit OS): x86
> 
> If we are running WOW64 then PROCESSOR_ARCHITEW6432 =AMD64
> 
> IF PROCESSOR_ARCHITECTURE == x86 AND  
>   PROCESSOR_ARCHITEW6432 NOT DEFINED THEN  
>   // OS is 32bit  
> ELSE  
>   // OS is 64bit  
> END IF
> 
> via [David Wang](https://blogs.msdn.microsoft.com/david.wang/2006/03/27/howto-detect-process-bitness/) @MSFT

Errorlevels
-----------

> If the version was successfully displayed [%ERRORLEVEL%](errorlevel.html) = 0  
> If a bad parameter is given %ERRORLEVEL% = 1  
> VER /? will not reset the ERRORLEVEL, this is a bug.

VER is an [internal](syntax-internal.html) command.

### Examples

Batch file to find the current operating system version, for Vista and later:  

@Echo off
For /f "tokens=4,5,6 delims=[]. " %%G in ('ver') Do (set _major=%%G& set _minor=%%H& set _build=%%I) 

Echo Major Version: [%_major%]
Echo Minor Version: [%_minor%]
Echo Build: [%_build%]
Echo Architecture: [%PROCESSOR_ARCHITECTURE%]
pause

_“Always be a first-rate version of yourself, instead of a second-rate version of somebody else” ~ Judy Garland_

### Related commands

Win32_OperatingSystem OperatingSystemSKU - Retrieve the OS Type via [WMI](wmic.html) (sku=Stock Keeping Unit ).  
[Sigcheck](sigcheck.html) - Check a file version, both OS files and others.  
[SystemInfo](systeminfo.html) - Return OS, Service pack, BIOS, Memory etc.  
WINVER.exe - In client OS's this will open the GUI Version dialogue box (Help ➞ About).  
[docs.microsoft.com/windows/whats-new](https://docs.microsoft.com/en-us/windows/whats-new/) - New features in each release.  
macOS equivalent: [sw_vers](../osx/sw_vers.html) - Print macOS operating system version.  
PowerShell equivalent:  
[Get-ComputerInfo](../ps/get-computerinfo.html) - Get system and OS properties.  
[OS Version](../ps/syntax-ver.html) - How to retrieve the OS version in PowerShell (several methods compared).  
Equivalent bash command (Linux): [uname -r](../bash/uname.html) - Print system information.



/. nt/verify.html
========================================================

    Verify - file copy - Windows CMD - SS64.com

VERIFY
======

To check that files are saved to disk correctly; the system can re-read the disk after saving to verify that the file is readable.

Syntax

      VERIFY [ON | OFF]

By default the CMD shell has verify OFF  

Verify checks that the destination file, once written, can be read. No comparison with the source the files occurs.

Copying files with verify OFF can be significantly faster, up to twice as fast.  
  
VERIFY without a parameter will display the current setting.  

Errorlevels
-----------

> Valid or no parameters given [%ERRORLEVEL%](errorlevel.html) = 0  
> Bad parameters given [%ERRORLEVEL%](errorlevel.html) = 1

VERIFY is an [internal](syntax-internal.html) command.

### Examples

Turn verify on:

C:> verify on

“Most of what is shaping you in the course of your reading you will not be able to remember.  
The most formative years of my life were the first five, and if those years were to be evaluated on the basis of my ability to pass a test on them, the conclusion would be that nothing important happened then, which would be false.  
The fact that you can’t remember things doesn’t mean that you haven’t been shaped by them” ~ Douglas Wilson, (author of Wordsmithy)

### Related commands

[COPY /V](copy.html) - Copy and Verify.  
[MOVE](move.html) - Move files from one folder to another.  
[EXIT](exit.html) - Quit the current script/routine, optionally setting an errorlevel.  
[Q126457](https://support.microsoft.com/en-us/kb/126457) - VERIFY ON, COPY /V, XCOPY /V commands do not compare data.  
Equivalent bash command (Linux): [cksum](../bash/cksum.html) - Print CRC checksum and byte counts.



/. nt/vmconnect.html
========================================================

    VMConnect - Windows CMD - SS64.com

VMConnect.exe
=============

Connect to a Hyper-V Virtual Machine.

Syntax

      vmconnect.exe _ServerName_ _VMName_ [-C _count_]

      vmconnect.exe _ServerName_ [_VMName_] -G _GUID_ [-C _count_]
Key
    -C _count_ 
         Specify an connection iD VMConnect will then stack the VM console windows
         with a small offset so that they are all visible.
         Larger numbers will space the windows further apart.

    -G    Connect using a GUID

A connection may be established both locally on the Hyper-V server or remotely over a network or the internet from a client on which the tool installed. Add Features ➞ Remote Administration Tools ➞ Role Administration Tools ➞ Hyper-V Tools.

### Examples

Connect to the Virtual Machine 'VM01' on server64:

C:> VMConnect.exe Server64 VM01

Open 3 VM consoles:

C:> VMConnect.exe Server64 VM01 -C 1  
C:> VMConnect.exe Server64 VM02 -C 2  
C:> VMConnect.exe localhost "Test Virtual Machine" -C 3

_“A hidden connection is stronger than an obvious one” ~ Heraclitus of Ephesus (Greek philosopher)_

### Related commands

Hyper-V MMC snap-in (GUI).  
[MSTSC](mstsc.html) - Terminal Server Connection (Remote Desktop Protocol).  
[Allowing non-Administrators](https://blogs.msdn.microsoft.com/virtual_pc_guy/2008/01/17/allowing-non-administrators-to-control-hyper-v/) to control Hyper-V.



/. nt/vol.html
========================================================

    Vol - volume label - Windows CMD - SS64.com

VOL
===

Display the volume label of a disk.

Syntax

      VOL [_drive_:[_drive_:]]

If the drive exists, VOL will display it's disk [label](label.html) and serial number and will return an [%ERRORLEVEL%](errorlevel.html) of 0.

If the drive does not exist or is not ready (CD/DVD drive with no disk loaded), VOL will return an %ERRORLEVEL% of 1.

If several drives are given, VOL will iterate through and check each of them. If any drive is invalid it will change the errorlevel but will still display information about the others.

Errorlevels
-----------

> If the Volume label was successfully displayed [%ERRORLEVEL%](errorlevel.html) = 0  
> If Drive not found or bad parameters given [%ERRORLEVEL%](errorlevel.html) = 1

VOL is an [internal](syntax-internal.html) command.

### Examples

vol c: h:

“I've found the Nobel label very handy because who'd want to hear anything from Betty Williams, ordinary housewife?” ~ Betty Williams Nobel Prize 1976

### Related commands

[LABEL](label.html) - Edit the volume label of a disk.  
[BCDEDIT](bcdedit.html) - Manage Boot Configuration Data.  
PowerShell: [Get-CIMinstance](../ps/get-ciminstance.html) Win32_LogicalDisk $label.  
Equivalent bash command (Linux): [hostname](../bash/hostname.html) - Print or set system name.



/. nt/vssadmin.html
========================================================

    VSSADMIN - Windows CMD - SS64.com

VSSADMIN
========

Display the current volume shadow copy backups and all installed shadow copy writers and providers.

Syntax

      Add a volume shadow copy storage association:
      VSSADMIN add shadowstorage /for=_ForVolumeSpec_ /on=_OnVolumeSpec_ [/maxsize=_MaxSizeSpec_]

      Create a new volume shadow copy:
      VSSADMIN **create shadow** /for=_ForVolumeSpec_ [/autoretry=_MaxRetryMinutes_]

      Delete volume shadow copies:
      VSSADMIN delete shadows /for=_ForVolumeSpec_ [/oldest | /all | /shadow=_ShadowID_] [/quiet]

      Delete volume shadow copy storage associations:
      VSSADMIN delete shadowstorage /for=_ForVolumeSpec_ [/on=_OnVolumeSpec_] [/quiet]

      List registered volume shadow copy providers:
      VSSADMIN list providers

      List existing volume shadow copies:
      VSSADMIN list shadows [/for=_ForVolumeSpec_] [/shadow=_ShadowID_]

      List all shadow copy storage associations on the system:
      VSSADMIN list shadowstorage {/for=_ForVolumeSpec_ | /on=_OnVolumeSpec_}

      List volumes that are eligible for shadow copies:
      VSSADMIN list volumes

      List all subscribed volume shadow copy writers on the system:
      VSSADMIN list writers

      Resize the maximum size for a shadow copy storage association:
      VSSADMIN resize shadowstorage /for=_ForVolumeSpec_ /on=_OnVolumeSpec_ [/maxsize=_MaxSizeSpec_]
             ** Resizing the storage association may cause shadow copies to disappear.

Key
    /all                Delete all of the shadow copies for the specified volume.

    /autoretry=_MaxRetryMinutes_
                       The maximum amount of time (in minutes) during which the vssadmin command will attempt
                       to create the shadow copy, if another process is simultaneously attempting to create a shadow copy.

    /for=_ForVolumeSpec_  The volume for which the shadow copy storage operation is intended.

    /on=_OnVolumeSpec_    The volume to be used as storage for the volume that is defined in the /for parameter.

    /maxsize=_MaxSizeSpec_ The max amount of storage space FOR the volume specified in /on.
                       If _MaxSizeSpec_ is not specified, there is no limit placed on the space to be used.
                       If the max. number of shadow copy storage associations have already been made, an
                       error is returned. _MaxSizeSpec_ must be 300 MB or greater and it must be expressed
                       in one of the following units: bytes, KB, MB, GB, TB, PB, or EB.
                       These units can be abbreviated as B, K, M, G, T, P, and E, respectively.
                       If no unit is specified, _MaxSizeSpec_ uses bytes (B) by default.

    /oldest             Delete only the oldest shadow copy.

    /shadow=_ShadowID_    Delete the shadow copy specified by _ShadowID_. 

    _ShadowID_            To get the shadow copy ID, use the VSSADMIN list shadows command.
                       When you type a shadow copy ID, use the following format, where
                       each X represents a hexadecimal character: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX

    /quiet              Suppress messages.

To enable VSS on a volume. Right-click on the volume and select Properties ➞ Shadow Copies. From here, you can then click Enable to create the first snapshot.

Shadow copies are exposed to PowerShell by a WMI class called Win32_ShadowCopy.

### Examples

Specify that for volume C, volume D is to be used for storage and the maximum size for storage space is to be 900 MB

VSSADMIN add shadowstorage /for=c: /on=d: /maxsize=900mb

Create a shadow copy of volume C

VSSADMIN create shadow /for=c:

Delete the oldest shadow copy of volume C:

VSSADMIN delete shadows /for=c: /oldest

Create a shadow copy with PowerShell, requires elevation. If this returns no result then no instances of win32_shadowcopy exist. This is normal behaviour. [[source](https://docs.microsoft.com/en-gb/previous-versions/windows/desktop/vsswmi/create-method-in-class-win32-shadowcopy)]

\# get existing shadow copies 
$shadow = Get-CIMinstance win32_shadowcopy
 "There are {0} shadow copies on this sytem" -f $shadow.count ""

\# get static method
$class=[WMICLASS]"root\cimv2:win32_shadowcopy"

\# create a new shadow copy 
"Creating a new shadow copy" 
$class.create("E:\", "ClientAccessible")  

# Count again 
$shadow = Get-CIMinstance win32_shadowcopy 
 "There are now {0} shadow copies on this sytem" -f $shadow.count

Create a shadow copy with a single line of PowerShell:
(Get-CIMinstance -list win32_shadowcopy).Create('E:\','ClientAccessible')

Create a shadow copy with [WMIC](wmic.html):  
WMIC shadowcopy call create Volume='E:\'

“You are on a soulful path that asks you to step into the greatest version of yourself. It is a sacred gift to shine your brightest light, not just in your moments of glory, but each day” ~ Debbie Ford

### Related commands

[PowerShell Script](https://web.archive.org/web/20200520103546/https://gallery.technet.microsoft.com/scriptcenter/PowerShell-Script-to-ce858ca8) - Delete shadow copies over 30 days old.  
[DISKSHADOW](diskshadow.html) - Volume Shadow Copy Service.  
[WBADMIN](wbadmin.html) - Windows Backup Admin.  
[Renaming vssadmin.exe](https://www.bleepingcomputer.com/news/security/why-everyone-should-disable-vssadmin-exe-now/) - Hide VSSADMIN from Crypto Ransomware.



/. nt/w32tm.html
========================================================

    W32tm - Windows CMD - SS64.com

W32TM.exe
=========

Time Service Utility.

Syntax


  Register the time service, and add default config to the registry:
      W32TM **/register**

  Unregister the time service, and remove config from the registry:
      W32TM **/unregister**

  The domain/computers to monitor:
      W32TM **/monitor** [/domain:_domain_name_] [/computers:_name_[,_name_[,_name_...]]] [/threads:_num_] [/ipprotocol: <4|6>] [/nowarn]

  Convert a Windows NT system time, in (10^-7)s intervals from 0h 1-Jan 1601, into a readable format.
      W32TM **/ntte** _NT_Time_Epoch_

  Converts a Network Time Protocol ([NTP](http://www.ntp.org/)) time, in (2^-32)s intervals from 0h 1-Jan 1900, into a readable format:
      W32TM **/ntpte** _Network_Time_

  Tell a computer that it should resynchronize its clock as soon as possible, discarding all accumulated error stats:
      W32TM **/resync** [/computer:_computer_] [/nowait] [/rediscover] [/soft]

  Display a strip chart of the offset between this computer and another computer:
      W32TM **/stripchart** /computer:_target_ [/period:_refresh_] [/dataonly]
              [/samples:_count_] [/packetinfo] [/ipprotocol:<4|6>] [rdtsc]

  Adjust the configuration of _target_:
      W32TM **/config** [/computer:_target_] [/update] [/manualpeerlist:_peers_]
              [/syncfromflags:_source_] [/LocalClockDispersion:_seconds_]
                 [/reliable:(YES|NO)] [/largephaseoffset:_milliseconds_]

  Display the current time zone settings:
      W32TM **/tz**

  Display the values that are associated with a given registry key:
      (default/root key is HKLM\System\CurrentControlSet\Services\W32Time)
      W32TM **/dumpreg** [/subkey:_key_] [/computer:_target_]

  Display a computer's Windows Time service information:
      W32TM **/query** [/computer:_target_] {/source | /configuration | /peers | /status} [/verbose]

  Enable or disable a local computer Windows Time service private log:
      W32TM **/debug** {**/disable** | {**/enable** /file:_name_ /size:_bytes_ /entries:_value_ [/truncate]}}

  Display the status of leap seconds on the local machine:
      W32TM **/leapseconds** /getstatus [/verbose]

Options:

    _Domain_  The domain to monitor. If no domain name is specified, or neither the domain nor
            computers option is specified, the default domain is used.
            This option might be used more than once.

    _computers_ Monitor the given list of computers. Computer names are separated by commas, with
            no spaces. If a name has a prefix of a ‘*’, it is treated as a primary domain
            controller (PDC). You can use this option more than once.

    _computer_ The computer to act upon, by default the local computer.

    _threads_  The number of computers to analyze simultaneously. 1-50, default=3.

 _ipprotocol_ Select IPv4 or ipv6 (default=whatever is available).

    _NT_Time_Epoch_
            A hex value representing a 64 bit integer that represents the number of seconds
            elapsed since 1900-01-01 00:00:00 (can be supplied as either Hex or integer)
            In reverse byte order, the first hex byte is the least significant:
            (1900-01-01 00:00:**01** is encoded as 0x**01**000000)

    /nowait  Do not wait for the resynchronization to occur; return immediately.
            Otherwise, wait for the resynchronization to complete before returning.

    /nowarn  Do not display a warning message.

    /rdtsc   Display the TSC values (time for NTP response) and time offset data in CSV format.

    /rediscover  Redetect the network configuration and rediscover network sources;
            then, resynchronize.

    /soft    This option is only provided for compatibility with older time servers and will
            resynchronize using existing error statistics..

    /period:_refresh_
            The time between samples, in seconds. The default value is 2 seconds.

    /Dataonly Display only the data, without graphics.

    /samples:_count_
            Collect _count_ samples; then, stop.
            If a value is not specified, samples will be collected until Ctrl+C is pressed.

    /packetinfo
            Print out NTP packet response message.

    /Ipprotocol 4|6
            Specify the IP protocol to use. Default = use whatever is available.

    /update  Notify the time service that the configuration has changed, causing the changes
            to take effect.

    /manualpeerlist:_peers_
            Set the manual peer list to _peers_, which is a space-delimited list of Domain Name
            System (DNS) and/or IP addresses. When you are specifying multiple peers, this option
            must be enclosed in quotation marks (").

    /syncfromflags:_source_
            Sets what sources the NTP client should synchronize from. _source_ should be a
            comma-separated list of these keywords (not case sensitive):
              MANUAL — Include peers from the manual peer list.
              DOMHIER — Synchronize from a domain controller in the domain hierarchy.
              NO     — Do not synchronize from any server.
              ALL    — Synchronize from both manual and domain peers.

    /LocalClockDispersion:_seconds_
            Configures the accuracy of the internal clock that W32time will assume when
            it cannot acquire time from its configured sources.

    /reliable:(YES|NO)
            Set whether this computer is a reliable time source. This setting is meaningful only on domain controllers.

    /largephaseoffset:_milliseconds_
            Sets the time difference between local time and network time that W32time will consider to be a spike. 

    /source  Display the time source.

    /configuration
            Display the configuration of run time and where the setting comes from.
            In verbose mode, display the undefined or unused setting also.

    /peers   Display a list of peers and their status.

    /status  Display Windows Time service status.

    /verbose Set the verbose mode to display more information.

    /disable Disable the private log.

    /enable  Enable the private log.
              file:_name_   The absolute file name.
              size:_bytes_  The maximum size for circular logging.
              entries:_value_  Contains a list of flags, specified by number and separated by commas, that specify
                             the types of information that should be logged. Valid numbers are 0 to 300.
                             A range of numbers is valid, in addition to single numbers, such as 0 through 100,103,106.
                             Value 0-300 is for logging all information.
    /truncate Truncate the file if it exists.

    /?       Display help.

The W32Time service is not a full-featured [Network Time Protocol](http://www.ntp.org/) (NTP) solution that meets time-sensitive needs.

By default the Windows Time [service](syntax-services.html) (w32time) will synchronize it's time once per week.  
This can be extended to daily by setting a Scheduled Task to [start the service and run w32tm /resync](https://www.pretentiousname.com/timesync/).

The options /debug, /packetinfo and /ipprotocol are available from Windows Vista and above.

/stripchart /packetinfo - will output three timestamps - The first hex number is byte order reversed NTP date, followed by the ANSI date (number of days since 1st Jan 1601) followed by the date/time in readable/local format.

The option /ntpte - will output three timestamps - The first hex number is an NTTE date (as also understood by w32tm.exe /ntte ), followed by the ANSI date (number of days since 1st Jan 1601) followed by the date/time in readable/local format.

The option /ntte - will output two timestamps - first the ANSI date (number of days since 1st Jan 1601) followed by the date/time in readable/local format.

A computer that is a member of a domain is configured by default to synchronize from the domain hierarchy, manually-specified synchronization is most useful for the forest root of the domain or for computers that are not joined to a domain.

Public NTP servers:

*   [NIST Internet Time Service](https://www.nist.gov/pml/time-and-frequency-division/services/internet-time-service-its) time.nist.gov - part of the NIST Physical Measurement Laboratory, maintains the standard for frequency and time interval for the United States.
*   [NTP Pool project](https://www.pool.ntp.org/en/use.html) pool.ntp.org (or "0.pool.ntp.org 1.pool.ntp.org 2.pool.ntp.org 3.pool.ntp.org") a big virtual cluster of timeservers.
*   time.windows.com - Microsoft's own time server (not particularly reliable).

### Examples

Set the local Windows Time client to point to two different time servers, one named time.nist.gov and another named pool.ntp.org

W32TM.exe /config /manualpeerlist:"time.nist.gov pool.ntp.org" /syncfromflags:manual /update

Check the Windows Time client configuration from a client computer running Windows 7 that has a host name of PC64

W32TM.exe /query /computer:PC64 /configuration

Convert an NTTE formatted date into a readable format, if using hex, prefix with **0x**:

W32TM.exe /ntte 0x01cf070000000000

W32TM.exe /ntte 130330610798428160

Convert an NTP formatted date into a readable format, if using hex, prefix with **0x**:

W32TM.exe /ntpte 0x72386aa6917c63d8

“We have a normal. As you move outside of your comfort zone, what was once the unknown and frightening becomes your new normal” ~Robin S. Sharma

### Related commands

[TZUTIL](tzutil.html) - Time Zone Utility.  
[TIME](time.html) - Display or set the system time.  
[Convert Hex](../convert.html) - Convert between Hex and Integer numbers.  
[Old New Thing](https://devblogs.microsoft.com/oldnewthing/?p=42653) - How to recognize date/time stamps (0x01=NTTE/Win32 FILETIME, 0x08=CLR System.DateTime)



/. nt/waitfor.html
========================================================

    Waitfor - delay in seconds - Windows CMD - SS64.com

WAITFOR.exe (Windows 7/2008 or later)
=====================================

Wait for or send a signal. Waitfor is used to synchronize events between one or more networked computers.

Syntax

    Wait for a signal:
      waitfor [/t _Timeout_] _SignalName_

    Send a signal:
      waitfor [/s _Computer_ [/u [_Domain_\]_User_ [/p [_Password_]]]] **/si** _SignalName_

Key
    /s _Computer_  The name or IP address of the computer to signal
                (do not include backslashes).

    /u _User_      Run the script using the credentials of the specified user account.
                By default, waitfor uses the current user's credentials.

    /p [_Password_] The password of the user account specified with /u

    /si          Send the signal across the network to waiting machines.

    /t _Timeout_   Number of seconds to wait for a signal.
                The valid range is 1 - 99999 (27.7 hours)
                default = wait indefinitely.

  _ SignalName_   The signal that waitfor waits for or sends.
                SignalName is not case-sensitive.

    /?           Display help.

Signal names cannot exceed 225 characters. Valid characters include a-z, A-Z, 0-9, the SignalName is not case-sensitive.

If the command line includes /s _Computer_, the signal will be broadcast only to the specified system rather than all the computers across the domain. On large domains or wide area networks this will reduce unnecessary network traffic.

To cancel WAITFOR before its timeout has been reached, either launch Waitfor /si _signal_ from a separate command-prompt or [KILL](tskill.html) the session.

You can run multiple instances of WAITFOR on a single computer, but each instance must wait for a different signal. Only one instance of WAITFOR can wait for a given signal on a given computer. Computers can only receive signals if they are in the same domain as the computer sending the signal.

Batch scripts including WAITFOR can be run as [Scheduled](schtasks.html) tasks under the SYSTEM account.

Typical WAITFOR applications include waiting for large ROBOCOPY jobs to complete, restarting services across a cluster/farm, FTP or BITS downloads, compiling software builds etc.

### Examples

Wait for 60 seconds or until the "simon" signal is received on the local computer:

C:> waitfor /t 60 simon

Activate the "simon" signal on the local computer:

C:> waitfor /s %computername% /si simon

Wait for 1 hour or until the "backupComplete" signal is received on the local computer:

C:> waitfor /t 3600 BackupComplete

Activate the "backupComplete" signal on the computer Server64:

C:> waitfor /s Server64 /si backupComplete

“Non-violence is not inaction. It is not discussion. It is not for the timid or weak... Non-violence is hard work. It is the willingness to sacrifice. It is the patience to win” ~ Cesar Chavez

### Related commands

[PAUSE](pause.html) - Suspend processing of a batch file and display a message.  
[SLEEP](sleep.html) - Delay execution for a few seconds/minutes (for use within a batch file).  
[TIMEOUT](timeout.html) - Delay execution for a few seconds/minutes (for use within a batch file).  
Equivalent PowerShell: [Start-Sleep](../ps/start-sleep.html) - Suspend shell, script, or runspace activity (sleep).  
Bash: [wait](../bash/wait.html) - Wait for a process to complete.



/. nt/wbadmin.html
========================================================

    wbadmin - Windows CMD - SS64.com

wbadmin.exe
===========

Windows Backup Administration.  
The syntax below is for Windows Server 2008 R2 or later, other than where stated. See [docs.microsoft.com](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc754015(v=ws.11)?redirectedfrom=MSDN) for earlier versions.

Syntax

           --Create and enable a daily backup schedule or modify an existing backup schedule:
      WBADMIN **enable backup** [-addtarget:_BackupTarget_] [-removetarget: _BackupTarget_]
         [-schedule:_TimeToRunBackup_] [-exclude:_ItemsToExclude_]
            [-include:_VolumesToInclude_]
               [-nonRecurseInclude:_ItemsToInclude_] [-nonRecurseExclude:_ItemsToExclude_]
                  [-systemState] [-allCritical]
                     [-hyperv:_HyperVComponentsToExclude_]     *Server 2012 or greater
                        [-vssFull | -vssCopy]                *Server 2012 or greater
                           [-user:_UserName_][-password:_Password_] [-quiet]
                              [-allowDeleteOldBackups]       *Server 2012 or greater

      WBADMIN **disable backup** [-quiet]    --Stop running the existing scheduled daily backups.

      WBADMIN **start backup** [-backupTarget:{_BackupTargetLocation_ | _TargetNetworkShare_}]
         [-include:_ItemsToInclude_] [-exclude:_ItemsToExclude_]
            [-nonRecurseInclude:_ItemsToInclude_] [-nonRecurseExclude:_ItemsToExclude_]
               [-systemState] [-allCritical] [-noVerify]
                  [-user:_UserName_] [-password:_Password_]
                     [-noInheritAcl]
                        [-vssFull | -vssCopy]      *Server 2012 or greater
                           [-quiet]

      WBADMIN **stop job** [-quiet]    --Cancel the backup or recovery operation that is currently running.

      WBADMIN **get disks**            --List the internal and external disks that are currently online for the local computer.

      WBADMIN **get items** -version:_VersionIdentifier_ [-backupTarget:{_BackupDestinationVolume_ | _NetworkSharePath_}]
        [-machine:_BackupMachineName_]       --List the items included in a specific backup.

      WBADMIN **get status**   --Report the status of the backup or recovery operation that is currently running.

      WBADMIN **get versions** [-backupTarget:{_BackupTargetLocation_ | _NetworkSharePath_}]
        [-machine:_BackupMachineName_]       --List details about the available stored backups. 

      WBADMIN **start recovery** -version:_VersionIdentifier_ -items:{_VolumesToRecover_ | _AppsToRecover_ | _FilesOrFoldersToRecover_}
         -itemtype:{Volume | App | File} [-backupTarget:{_VolumeHostingBackup_ | _NetworkShareHostingBackup_}]
            [-machine:_BackupMachineName_] [-recoveryTarget:{_TargetVolumeForRecovery_ | _TargetPathForRecovery_}]
               [-recursive] [-overwrite:{Overwrite | CreateCopy | Skip}]
                  [-notRestoreAcl] [-skipBadClusterCheck] [-noRollForward] [-quiet]

      WBADMIN **start systemstatebackup** -backupTarget:_VolumeName_ [-quiet]

      WBADMIN **start systemstaterecovery** -version:_VersionIdentifier_ -showsummary
        [-backupTarget:{_BackupDestinationVolume_ | _NetworkSharePath_}]
           [-machine:_BackupMachineName_] [-recoveryTarget:_TargetPathForRecovery_] [-authsysvol] [-autoReboot] [-quiet]

      WBADMIN **delete systemstatebackup** {-keepVersions:_NumberofCopies_ | -version:_VersionIdentifier_ | -deleteOldest}
        [-backupTarget:_VolumeName_] [-machine:_BackupMachineName_] [-quiet]

      WBADMIN **start sysrecovery** -version:_VersionIdentifier_ -backupTarget:{_BackupDestinationVolume_ | _NetworkShareHostingBackup_}
        [-machine:_BackupMachineName_] [-restoreAllVolumes] [-recreateDisks] [-excludeDisks] [-skipBadClusterCheck] [-quiet]

      WBADMIN **delete catalog** [-quiet]    --Delete the backup catalog from the local computer.
                                         --Use when the catalog is corrupt and cannot be restored with 'wbadmin restore catalog'.

      WBADMIN **restore catalog** -backupTarget:{_BackupDestinationVolume_ | _NetworkShareHostingBackup_}
        [-machine:_BackupMachineName_] [-quiet]    --Recovers a backup catalog for the local computer from a storage location that you specify.

Key
  -addtarget     Storage location for backups. A disk, volume, or UNC path.
  -allCritical   Include all critical volumes in the backups. Use only with -backupTarget. Can be used with -include.
  -allowDeleteOldBackups  Overwrite any backups made before the computer was upgraded.
  -authsysvol    If used, performs an authoritative restore of SYSVOL (the System Volume shared directory).
  -autoReboot    Restart the system at the end of the system state recovery operation.
                 This parameter is valid only for a recovery to the original location.
                 We do not recommend you use this parameter if you need to perform steps after the recovery operation.

  -backupTarget  The storage location for this backup. Requires an HD drive letter, a volume GUID-based path or UNC path.

  -exclude       A comma-delimited list of items to exclude from the backup: files, folders, or volumes.
  -include       A comma-delimited list of items to include in the backup: multiple files, folders, or volumes.

  -excludeDisks  Valid only when specified with -recreateDisks and must be input as a comma-delimited list of disk identifiers
                 (as listed in the output of wbadmin get disks). Excluded disks are not partitioned or formatted.
                 This parameter helps preserve data on disks that you do not want modified during the recovery operation.

  -hyperv        A comma-delimited list of components to be included in backup.
                 The identifier could be a component name or component GUID (with or without braces).

  -machine       The computer that you want backup details for. Use when backups of multiple computers are stored together.

  -nonRecurseExclude   Non-recursive, comma-delimited list of items to exclude from the backup.
  -nonRecurseInclude   Non-recursive, comma-delimited list of items to include in the backup. 
                       Use only with the -backupTarget parameter.

  -noRollForward Valid only when recovering applications. Allows for previous point-in-time recovery of an application
                 if the latest version from the backups is selected.
                 For other versions of the application that are not the latest, previous point-in-time recovery is done as the default.

  -noVerify      Specifies that backups saved to removable media (such as a DVD) are not verified for errors.
  -noInheritAcl  Apply the access control list (ACL) permissions that correspond to the credentials provided by the
                  -user and -password parameters to the folder that contains the backup.

  -overwrite     Valid only when recovering files. If a file being recovered already exists:
                     Skip       - Skip the existing file and continue with recovery of the next file.
                     CreateCopy - Create a copy of the existing file so that the existing file is not modified.
                     Overwrite  - Overwrite the existing file with the file from the backup.

  -recoveryTarget  The location to restore to. Use if this location is different than the location that was previously backed up.

  -recreateDisks Recover a disk configuration to the state that existed when the backup was created.
                 Warning: This parameter deletes all data on volumes that host operating system components.
                 It might also delete data from data volumes.

  -recursive     Valid only when recovering files. Recover the files in the folders and all sub-folders.
                 By default, only files which reside directly in the specified folders are recovered.

  -restoreAllVolumes  Recover all volumes from the selected backup. If this parameter is not specified, only critical volumes
                 (volumes that contain the system state and operating system components) are recovered.
                 This parameter is useful when you need to recover non-critical volumes during system recovery.

  -schedule      Times of day to create a backup, formatted as HH:MM and comma delimited.
  -showsummary   Report the summary of the last system state recovery (after the restart required to complete the operation).
                 This parameter cannot be accompanied by any other parameters.

  -skipBadClusterCheck   Skip checking the recovery disks for bad cluster information. If you are restoring to an alternate
                 server or hardware, we recommend that you do not use this parameter.
                 You can manually run [chkdsk /b](chkdsk.html) on your recovery disks at any time to check them for bad clusters, and then
                 update the file system information accordingly.
                 Warning: Until you run chkdsk the bad clusters reported on your recovered system may not be accurate.

  -systemState   Create a backup that includes the system state in addition to items specified with the -include.

  -user          The user with write permission to the backup storage destination.
                 A member of the Administrators group or Backup Operators group on the computer being backed up.
  -password      The password for -user.

  -version       The version of the backup in MM/DD/YYYY-HH:MM format. To view version information, type 'wbadmin get versions'.

  -vssFull       Perform a full back up using the Volume Shadow Copy Service (VSS).
                 All files are backed up, each _file's history_ is updated to reflect that it was backed up, and the logs
                 of previous backups may be truncated.
                 Do not use this parameter if you are using a product other than Windows Server Backup to back up applications
                 that are on the volumes included in the current backup. Doing so can potentially break the incremental,
                 differential, or other type of backups that the other backup product is creating because the history that
                 they rely on might be missing and they might perform a full backup unnecessarily.

  -vssCopy       Perform a copy backup using VSS. All files are backed up but the history of the files being backup up
                 is not updated so you preserve the all the change information and log files.
                 This is the default value. A copy backup cannot be used for incremental or differential backups or restores.

  -quiet         Run the subcommand with no prompts to the user.

Volume paths can be specified using volume drive letters, mount points, or GUID-based volume names.  
If you use a GUID-based volume name, it should be terminated with a backslash (\).

You can use the wildcard character (*) in the file name when specifying a path to a file.  
  
Standard [ISO 8601 date formats](../dates.html) are not supported by wbadmin, use USA formatted dates.

### Examples

Schedule backups of the folder d:\demo to the network location \backupshare\BK1 at 12:00 Midnight. and 7:00 P.M.:

C:> wbadmin enable backup –addtarget:\backupshare\BK1 –include: d:\demo –user:SS64dom\user64 –password:pass30r6 –schedule:00:00,19:00

Recover data from the backup that was run on 2013-03-31 at 9:00 A.M., located on drive d:

C:> wbadmin start sysrecovery -version:03/31/2013-09:00 -backupTarget:d:

Create a system state backup and store it on volume F:

C:> wbadmin start systemstatebackup -backupTarget:F:

Perform a system state recovery of the backup from 03/31/2017 at 9:00 A.M.:

C:> wbadmin start systemstaterecovery -version:03/31/2017-09:00

_“Get back, get back, Get back to where you once belonged” ~ Get Back (The Beatles)_

### Related commands

[Windows Server PowerShell Backup Cmdlets](https://docs.microsoft.com/en-us/powershell/module/windowserverbackup/?view=winserver2012r2-ps&redirectedfrom=SS64)  
[NTBACKUP](ntbackup.html) - Windows Backup (pre Vista).  
[VSSADMIN](vssadmin.html) - Volume Shadow Copy.



/. nt/wecutil.html
========================================================

    wecutil Windows Event Collector Utility - Windows CMD - SS64.com

wecutil.exe
===========

Windows Event Collector Utility.  
Create and manage subscriptions to events forwarded from remote event sources that support WS-Management protocol.

Syntax

      wecutil _command_ [_Argument_ [_Argument_] ...] [/_Option_:_VALUE_ [/_Option_:_VALUE_] ...]

Key
    List all existent remote event subscriptions:
    **es** (enum-subscription)

    Get subscription configuration:
    **gs** (get-subscription) _SUBSCRIPTION_ID_ [/_Option_:_VALUE_ [/_Option_:_VALUE_] ...]
       /f:_VALUE_
       /format:_VALUE_
        VALUE can be XML or Terse name-value pairs(default). 

       /u:_VALUE_
       /unicode:_VALUE_
       Display output in unicode (UTF-16).
      _ VALUE_ can be true or false. If _VALUE_ is true then output is in Unicode.

    Get subscription runtime status:
    **gr** (get-subscriptionruntimestatus)  _SUBSCRIPTION_ID_ [_EVENT_SOURCE_ [_EVENT_SOURCE_] ...]
       where EVENT_SOURCE identifies a machine serving as a source of events

    Set subscription configuration: 
    **ss** (set-subscription) _SUBSCRIPTION_ID_ [/_Option_:_VALUE_ [/_Option_:_VALUE_] ...]

    **ss** (set-subscription) /c:_CONFIG_FILE_ [/cus:_Username_ [/cup:_Password_] ...]
   
    Create new subscription:
    **cs** (create-subscription) _CONFIGURATION_FILE_ [/_Option_:_VALUE_ [/_Option_:_VALUE_] ...]

    Delete subscription:
    **ds** (delete-subscription) _SUBSCRIPTION_ID_
   
    Retry subscription:
    **rs** (retry-subscription) SUBSCRIPTION_ID [EVENT_SOURCE [EVENT_SOURCE] ...]
   
    Configure Windows Event Collector service:
    **qc** (quick-config)  /quiet:{true|false}                

    /help | ?  Help for the wecutil program.

For a full list of subscriptions/options for specific commands:
    wecutil _COMMAND_ -?

You can use either the short or long (shown in parentheses) version of each command name.

### Examples

Display configuration information for a subscription named sub1:

C:> wecutil gs sub1

Display the runtime status of a subscription named sub1:

C:> wecutil gr sub1

Create a subscription to forward events using an XML configuration file:

C:> wecutil cs subscription.xml

Delete a subscription named sub1:

C:> wecutil ds sub1

“The two offices of memory are collection and distribution” ~ Samuel Johnson

### Related commands

[EVENTCREATE](eventcreate.html) - Add a message to the Windows event log.  
[PsLogList](psloglist.html) - Event log records.



/. nt/wevtutil.html
========================================================

    WEVTUTIL - Windows CMD - SS64.com

WEVTUTIL
========

Retrieve information about event logs and publishers. Archive logs in a self-contained format, Enumerate the available logs, Install and uninstall event manifests, run queries, Exports events (from an event log, from a log file, or using a structured query) to a specified file, Clear event logs.

Syntax

      WEVTUTIL {al | **archive-log**} _Logpath_ [/l:_Locale_]     # Archive an exported log.

      WEVTUTIL {cl | **clear-log**} _Logname_  [/bu:_Backup_]     # Clear a log and optionally backup.

      WEVTUTIL {el | **enum-logs**}]           # List Log_Names and configuration, including max. size, enabled Y/N, and
                                             pathname where the log is stored.

      WEVTUTIL {epl | **export-log**} _LogFile_ _Exportfile_      # Export Event log, optionally a logfile path + structured query.
         [/lf | Logfile :[true|false]] [/{q | query}:_VALUE_]  # provide a Log name or log_file_path (if /lf = true)
            [/{sq | structuredquery}:[true|false]]  [/ow | Overwrite :[true|false] ]
                                           
      WEVTUTIL {ep | **enum-publishers**}       # List event publishers.

      WEVTUTIL {gl | **get-log**} _Logname_       # Display the log configuration and optionally output
         [/{f | format}:[XML|Text]]         # the config details in XML, plain text is the default.

      WEVTUTIL {gli | **get-loginfo**} _LogName_ [/lf | Logfile:[true|false]]    # Get log status
                                            # provide a Log name or log_file_path (if /lf = true)
 
      WEVTUTIL {gp | **get-publisher**} _PublisherName_        # Get publisher configuration, and optionally Event Metadata.
         [/{ge | getevents}:[true|false]] [/gm:_Message_]  # Obtain the publisher names with Wevtutil ep
            [/{f | format}:[ XML | Text ]]               # gm=get message, f=log file format. 

      WEVTUTIL {qe | **query-events**} _Path_ [/lf | Logfile:[true|false]]  # Query events from a log or log file.
         [/sq:_Structquery_] [/q:_XPathQuery_] [/bm:_Bookmark_]             # provide a Log name or log_file_path (if /lf = true)
            [/sbm:_SaveBookmark_] [/rd }:[true|false]]        # Reverse direction so most recent events first.
               [{f | format}:[ _XML | Text | RenderedXml_ ]]  # Output format.
                  [/{l | locale}:_VALUE_]                     # A [Locale](../locale.html) short string.
                     [{c | count}:_N_]                        # Maximum no. of events to read (1=most recent only).
                        [/{e | element}:_VALUE_]              # Select an XML Root Element.

      WEVTUTIL [{sl | **set-log**} _LogName_ [/{e | enabled}:[true|false]]     # Modify the configuration of a log.
         [/{q | quiet}:[true|false]] [/{fm | filemax}:_N_]                 # Quiet / Max. enablements.
            [/{i | isolation}:[system|application|custom]]               # Log isolation mode.
               [/{lfn | logfilename}:_VALUE_] [/{rt | retention}:[true|false]]   # Log file / Log retention.
                  [/{ab | autobackup}:[true|false]] [/{ms | maxsize}:_Size_]  # Log autobackup policy /Max log size.
                     [/{l | level}:_Level_] [/{k | keywords}:_VALUE_]        # Level filter of log / Keywords filter.
                        [/{ca | channelaccess}:_VALUE_] [/{c | config}:_VALUE_] # Access permission (SDDL)/Path to the config file
                                                      # If /config is specified, do not also specify the _LOG_NAME_.

      WEVTUTIL {im | **install-manifest** } _MANIFEST_        # Install event publishers and logs from _MANIFEST_.
         [ /{rf | resourceFilePath}:_VALUE_ ] [/{mf | messageFilePath}:_VALUE_]  # Resource/MessageFileName of the Provider
            [ /{pf | parameterFilePath}:_VALUE_]          # ParameterFileName of the Provider Element to be replaced.

      WEVTUTIL {um | **uninstall-manifest**} _MANIFEST_]      # Uninstall event publishers and logs from _MANIFEST_.

Common options:

    /{r | remote}:_VALUE_
              If specified, run the command on a remote computer. VALUE is the remote computer
              name. Options /im and /um do not support remote operations.

    /{u | username}:_VALUE_
              Specify a different user to log on to the remote computer. VALUE is a user name
              in the form domain\user or user. Only applicable when option /r is specified.
    /{p | password}:_VALUE_
              Password for the specified user. If not specified, or if VALUE is "*", the user
              will be prompted to enter a password. Only applicable when the /u option is specified.

    /{a | authentication}:[Default|Negotiate|Kerberos|NTLM]
              Authentication type for connecting to remote computer. The default is Negotiate.

    /{uni | unicode}:[true|false]
              Display output in Unicode. If true, then output is in Unicode.

The primary focus of WEVTUTIL is the configuration and setup of event logs.

Some applications can completely fill their respective event log with errors (Office 2016 I'm looking at you) being able to enumerate the log size and location is a useful tool for tracking down such problems.

Most options for WEVTUTIL are not case sensitive, but the built-in help is and must be requested in UPPER case.  
To retrieve event log data the PowerShell cmdlet [Get-WinEvent](../ps/get-winevent.html) is easier to use and more flexible.

WEVTUTIL was first made available in Windows Vista.

### Examples

Clear all the events from the Application log:  
C:> WEVTUtil.exe clear-log Application

List the most recent shutdown event (Event ID 1074) from the System event log:

C:> WEVTUtil query-events system "/q:*[System [(EventID=1074)]]" /rd:true /c:1 /format:text

Batch file to parse every Event log installed on the computer and **clear** them all:

@echo off  
for /f "tokens=*" %%G in ('wevtutil.exe el') do (wevtutil.exe cl "%%G")

Export events from the System log to C:\backup\ss64.evtx  
C:> WEVTUtil export-log System C:\backup\ss64.evtx

List the event publishers on the current computer.  
C:> WEVTUtil enum-publishers

Uninstall publishers and logs from the SS64.man manifest file:  
C:> WEVTUtil uninstall-manifest SS64.man

Enable event logs for the [Task Scheduler](schtasks.html):  
C:> WEVTUtil set-log "Microsoft-Windows-TaskScheduler/Operational" /e:true >null 2>&1

Display the 50 most recent events from the Application log in text format:  
wevtutil qe Application /c:50 /rd:true /f:text

Find the last 20 startup events in the System log:  

C:> WEVTUtil query-events System /count:20 /rd:true /format:text /q:"Event[System[(EventID=12)]]"

From an elevated command prompt, dump a list of all the 360 or so possible Security Event messages (publisher=Microsoft-Windows-Security-Auditing); other publishers can be enumerated with the enum-publishers switch.  

C:> WEVTUtil get-publisher Microsoft-Windows-Security-Auditing /ge /gm:true

_"The Statesman who yields to war fever must realize that once the signal is given, he is no longer the master of policy but the slave of unforeseeable and uncontrollable events" ~ Sir Winston Spencer Churchill_

### Related commands

[EVENTCREATE](eventcreate.html) - Add a message to the Windows event log.  
[SYSMON](sysmon.html) - Monitor and log system activity to the Windows event log.  
PowerShell: [Get-WinEvent](../ps/get-winevent.html) - Get event log data (Vista+).  
[List of Windows Event IDs.](../ps/syntax-eventids.html)  
[WMIC NTEVENTLOG](wmic.html) - WMI access to the event log.



/. nt/where.html
========================================================

    Where - locate files - Windows CMD - SS64.com

WHERE.exe
=========

Locate and display files in a directory tree.  
  
The WHERE command is roughly equivalent to the UNIX 'which' command. By default, the search is done in the [current directory](cd.html) and in the [PATH](path.html).

Syntax

      WHERE [/R _Dir_] [/Q] [/F] [/T] _Pattern_ ...

      WHERE [/Q] [/F] [/T] [_Path_**;**_Path_**;**... **:**]_Pattern_ ...

      In PowerShell:
      C:\Windows\System32\WHERE.exe .._options as above_

key
    /R      A recursive search, starting with the specified _Dir_ directory.

    /Q      Don’t display the files but return either an exit code of 0 for success
           or 1 for failure.

    /F      Display the output file name in quotation marks.

    /T      Display the size, time stamp, and date stamp of the file.

  _pattern_  The Drive\Directory\file, or set of files to be found.
           you can use wildcard characters ( ? * ) and UNC paths.

           The pattern can also be $_ENV_:_Pattern_ where _ENV_ is an existing environment variable
           containing one or more paths.

  _Path_     One or more semicolon-separated paths to search. 

The WHERE command can either perform a recursive search within one directory (/R) or search through a list of folders (_Path_;_Path_:), but not both.

By default, WHERE searches the current directory and the paths specified in the [PATH](path.html) environment variable.

Unlike the DIR command WHERE always returns the full path to each file found.

The WHERE command is particularly useful to reveal multiple versions of the same comand/script/utility on the system PATH.

WHERE will use the PATHEXT [variable](syntax-variables.html) to include all executable files, so WHERE robocopy will find the location of robocopy**.exe**

This PATHEXT expansion applies even if you are not searching for an executable. For instance, the command WHERE monday.csv will list the file monday.csv in the current directory, as expected, but this will also list files like monday.csv.exe, monday.csv.com should they exist. To avoid this behaviour, clear the PATHEXT variable temporarily with Set "PATHEXT="

To run the WHERE command from PowerShell it is necessary to specify the .exe extension: 'WHERE**.exe**' otherwise the Where-Object cmdlet will take precedence.

### Examples

Find all files named 'Zappa' on the remote computer 'Server64' searching the subdirectories of Share1:  
  
C:> WHERE /r \Server64\Share1 Zappa.*

List all the files in the Demo folder:

C:> WHERE "C:\demo\:*.*"

List all the .CSV files on both the work and play folders:

C:> WHERE C:\work\;C:\Play\:*.csv

In PowerShell, find **all** copies of robocopy.exe in the current system path:

PS C:> WHERE**.exe** robocopy.exe

“Who never walks, save where he sees men's tracks, makes no discoveries” ~ Josiah Gilbert Holland

### Related commands

[Which.cmd](syntax-which.html) - Show full path to executable.  
[OldNewthing](https://devblogs.microsoft.com/oldnewthing/20050120-00/?p=102308) - Describes this 90 byte 'whereis' batch file:  
@for %%e in (%PATHEXT%) do @for %%i in (%1%%e) do @if NOT "%%~$PATH:i"=="" echo %%~$PATH:i  
[whereis utility](http://www.flounder.com/whereis.htm) - Flounder.com.  
[Which](https://www.robvanderwoude.com/unixports.php#WHICH) - several scripts from Rob Vanderwoude.  
[ATTRIB](attrib.html) - Display or change file attributes, with just the parameter specifying a file or a wildcard, ATTRIB will return similar results to WHERE.  
[CD](cd.html) - Change Directory.  
[DIR](dir.html) - Display a list of files and subfolders.  
[TYPE](type.html) - Display the contents of a text file.  
[Advanced Query Syntax](explorer.html) (AQS) in Windows File Explorer.  
Equivalent bash command (Linux): [which](../bash/which.html) - Show full path of commands.  
Similar PowerShell cmdlet, finds the first copy only: ([get-command](../ps/get-command.html) robocopy.exe).Definition



/. nt/whoami.html
========================================================

    Whoami - user, group and privileges - Windows CMD - SS64.com

WHOAMI.exe
==========

Display user, group and privileges for the current user.

Syntax

      whoami [/upn | /fqdn | /logonid]

      whoami {[/user] [/groups] [/priv]} [/fo _Format_] [/nh]

      whoami /all [/fo _Format_] [/nh]

Key

    /upn      Display the user name in user principal name (UPN) format.

    /fqdn     Display the user name in fully qualified domain name (FQDN) format.

    /logonid  Display the logon ID of the current user.

    /user     Display the current domain and user name and the security identifier (SID).

    /groups   Display the user groups to which the current user belongs.

             Includes the [Integrity Control](https://docs.microsoft.com/en-us/windows/win32/secauthz/mandatory-integrity-control) level:
             Mandatory Label\Low Mandatory Level    = Low.
             Mandatory Label\Medium Mandatory Level = Medium/Standard.
             Mandatory Label\High Mandatory Level   = [Elevated](syntax-elevate.html).

    /priv     Display the security privileges of the current user.

    /fo       The output format. Valid values:
                table  Table format (default)
                list   List format.
                csv    Comma-separated value (CSV) format.

    /all      Display all information in the current access token, including
             the current user name, security identifiers (SID), privileges,
             and groups that the current user belongs to.

    /nh       Don't display the column header in the output.
             This is valid only for table and CSV formats.

    /?        Help

### Examples

Display the domain and user name of the current user:  
whoami

Display the user groups to which the current user belongs:  
whoami /groups

Display all of the information in the current access token:  
whoami /all

“We can now manipulate images to such an extrodinary extent that there's no lie you cannot tell” ~ Sir David Attenborough  

### Related commands

[icacls /setintegritylevel](icacls.html) - Add an integrity control ACE.  
[SET](set.html) - Display, set, or remove Windows environment variables.  
VER - Display version information.  
[VOL](vol.html) - Display a disk label.  
[Whereami.cmd](whereami.txt) - Display user information.  
Environment variables: %USERDOMAIN% and %USERNAME%  
Equivalent PowerShell: PS> whoami /groups /fo csv | [convertfrom-csv](../ps/convertfrom-csv.html)  
Equivalent bash command (Linux): whoami - Print the current user id and name (\`[id](../bash/id.html) -un').



/. nt/whois.html
========================================================

    Whois - Event log records - Windows CMD - SS64.com

Whois ([SysInternals](https://docs.microsoft.com/en-us/sysinternals/downloads/whois))
=====================================================================================

Lookup the registration record for a domain name or IP address.

Syntax

      whois [-v] _domainname_ [_whois.server_]

Options:

    _Domainname_  Either a DNS name (e.g. www.sysinternals.com) or IP address (e.g. 66.193.254.46).

     -v        Print whois information for referrals.

### Examples

Lookup the registration record for myspace.com:

whois myspace.com

“Events, dear boy, events” ~ British Prime Minister Harold Macmillan (answer to 'what is the biggest problem in politics'?)

### Related commands

[SysInternals Forum](https://social.technet.microsoft.com/Forums/en-US/home?category=sysinternals&$filter=alltypes&$sort=lastpostdesc)  
[WECUTIL](wecutil.html) - Windows Event Collector Utility.  
Equivalent bash command (Linux): whois



/. nt/windiff.html
========================================================

    WinDiff - GUI to compare files - Windows CMD - SS64.com

WinDiff (Windows SDK core SDK Tools)
====================================

Compare the contents of two files or sets of files with a graphical interface.

Syntax

      windiff [_path1_] [_path2_]

Key
    _path_   Individual files to compare or a directory of files to compare.

If either _path_ is not specified it will default to the current directory (or a matching file in the current directory)

If nothing is specified, the GUI will appear - select files to compare with the menus.

White background = parts common to both files.  
Red background = parts that belong to the file listed on the left .  
Yellow background = parts that belong to the file listed on the right .

Registry files (exported with [regedit](regedit.html)) can also be compared. Also see the help file Windiff.hlp.

**Download  
**Originally part of the Microsoft Windows 2008 SDK it can now be found via Grigsoft (3rd party mirror) [WinDiff](https://www.grigsoft.com/download-windiff.htm) (75 Kb).  

"Shall I compare thee to a summer's day? Thou art more lovely and more temperate.  
Rough winds do shake the darling buds of May, And summer's lease hath all too short a date" ~ Shakespeare

### Related commands

[COMP](comp.html) - Compare two files and display any characters which do NOT match.  
[FC](fc.html) - Compare two files.  
[FIND](find.html) - Search for a text string in a file.  
[FINDSTR](findstr.html) - Search for strings in files.  
[WinMerge](https://winmerge.org/) - Free compare utility.  
[Beyond Compare](https://www.scootersoftware.com/) - not free, 30 day trial.  
[Q159214](https://docs.microsoft.com/en-GB/troubleshoot/windows-client/shell-experience/how-to-use-windiff-utility) - How to Use the Windiff.exe Utility.  
Equivalent bash command (Linux): [diff](../bash/diff.html) - Display the differences between two files.



/. nt/winget.html
========================================================

    Winget - Windows CMD - SS64.com

WINGET
======

Discover, install, upgrade, remove and configure applications on Windows computers.  

Syntax

      WINGET _exe_ [_command_] [_options_]

Commands:

    [WINGET export](winget-export.html) [-o] _output_ [_options_]     Export a JSON file of apps to a specified file.

    [WINGET hash](winget-hash.html) [--file] _file_ [_options_]   Generate a SHA256 hash for the installer.

    WINGET [--help] [/?]      Display help for all the supported commands and sub commands.
                             Pass the --help argument to any other WINGET command to get
                             details about all additional command options.

    [WINGET import](winget-import.html) [-i] _import-file_ [_options_]    Import a JSON file of apps to install.

    [WINGET install](winget-install.html) [[-q] _query_] [_options_] [-?]  Install an application.

    [WINGET list](winget-list.html) [[-q] _query_] [_options_]     Display a list of installed applications.

    [WINGET features](winget-features.html)  Display a list of experimental features.

    [WINGET search](winget-search.html) [[-q] _query_] [_options_]   Search/Show all applications available for installation.

    WINGET settings        Configure WinGet by editing the settings.json file.
                          Running WINGET settings will open the file in your default json editor;
                          [List of settings](https://github.com/microsoft/winget-cli/blob/master/doc/Settings.md) you can configure, appearance, telemetry etc.

    [WINGET show](winget-show.html) [[-q] _query_] [_options_]      Display details for the specified application.

    [WINGET source](winget-source.html) _sub-command_ _options_       Add, remove, or update the Windows Package Manager repositories accessed by WINGET.

    [WINGET uninstall](winget-uninstall.html) [[-q] _query_] [_options_]  Uninstall the specified application

    [WINGET upgrade](winget-upgrade.html) [[-q] _query_] [_options_]    Upgrade the specified application.

    [WINGET validate](winget-validate.html) [--manifest] _path_    Validate a manifest file for submission to the Windows Package Manager repository.

Options

    -v, --version   Return the current version of winget.
       --info      Detailed information including links to the license and privacy statement.
    -?, --help      Get additional help on winget.

Winget is bundled with Windows 11 by default.  
For Windows 10 it is available as [App Installer](https://www.microsoft.com/en-gb/p/app-installer/9nblggh4nns1?SilentAuth=1&wa=wsignin1.0&rtc=1#activetab=pivot:overviewtab) on the WIndows Store. Requires Windows 10 1709 (build 16299) or later.

When scripted, winget will launch the applications in the specified order. When an installer returns success or failure, winget will launch the next installer. If an installer launches another process, it is possible that it will return to winget prematurely. This will cause winget to install the next installer before the previous installer has completed.

This tool is the client interface to the Windows _Package Manager_ service.

### Examples

Search for software:  
C:> winget search powertoys  
  
Install software:  
C:> winget install Microsoft.PowerToys

“The process of assessing how you feel about the things you own, identifying those that have fulfilled their purpose, expressing your gratitude, and bidding them farewell, is really about examining your inner self, a rite of passage to a new life” ~ Marie Kondo

### Related commands

[GitHub repository](https://github.com/microsoft/winget-cli)  
[WINGET](winget.html) - Discover, install, upgrade, remove and configure applications on Windows computers.  
[MSIEXEC](msiexec.html) - Microsoft Windows Installer.  
[WUAUCLT](wuauclt.html) - Windows Update.  
Equivalent PowerShell: [Install-Package](../ps/install-package.html) - Install one or more software packages.



/. nt/winmgmt.html
========================================================

    WinMgmt - Windows CMD - SS64.com

WinMgmt
=======

Manage the WMI service/WMI repository.

Syntax

      WINMGMT [/backup _filename_] 
      WINMGMT [/restore _filename_ _restore-mode_] 
      WINMGMT [/resyncperf _winmgmt service-process-id_] 
      WINMGMT [/standalonehost _level_]
      WINMGMT [/sharedhost]
      WINMGMT [/verifyrepository _path_]
      WINMGMT [/salvagerepository] 
      WINMGMT [/resetrepository]

Options:

    /backup _filename_
      Back up the repository to the specified file name.
      The _filename_ argument should contain the full path to the file location.
      This process requires a write lock on the repository so that write operations to the repository are suspended
      until the backup process is completed.
      If you do not specify a path for the file, it is saved to the %Windir%\System32 directory.

    /restore _filename_ _restore-mode_
      Manually restore the WMI repository from the specified backup file.
      The _filename_ argument should contain the full path to the backup file location.
      To perform the restore operation, WMI saves the existing repository to write back if the operation fails.
      Then the repository is restored from the backup file that is specified in the filename argument.
      If exclusive access to the repository cannot be achieved, existing clients are disconnected from WMI.

      The _restore_mode_ flag must be a 1 (force disconnect users and restore)
      or 0 (default restore if no users connected).

    /resyncperf _winmgmt-service-process-id_
      Register the computer's performance libraries with WMI. WMI PID is the process ID for the WMI service.
      Only needed if the performance monitor classes are not returning reliable results.

    /standalonehost [_level_]
      Move the Winmgmt service to a standalone Svchost process that has a fixed DCOM endpoint.
      The default endpoint is "ncacn_ip_tcp.0.24158". However, the endpoint may be changed by running [Dcomcnfg.exe](https://docs.microsoft.com/en-us/windows/win32/com/enabling-com-security-using-dcomcnfg).
      For more information about setting up a fixed port for WMI, see [Setting Up a Fixed Port for WMI](https://docs.microsoft.com/en-us/windows/win32/wmisdk/setting-up-a-fixed-port-for-wmi).

      The _level_ argument is the authentication level for the Svchost process. WMI normally runs as part of a shared service host and
      you cannot increase the authentication level for WMI alone.
      If _level_ is not specified, the default is 4 (RPC_C_AUTHN_LEVEL_PKT or WbemAuthenticationLevelPkt).

      You can run WMI more securely by increasing the authentication level to Packet Privacy
      (RPC_C_AUTHN_LEVEL_PKT_PRIVACY or WbemAuthenticationLevelPktPrivacy).
      The authentication levels for Visual Basic and scripting are described in [WbemAuthenticationLevelEnum](https://docs.microsoft.com/en-us/windows/win32/api/wbemdisp/ne-wbemdisp-wbemauthenticationlevelenum).
      For C++, see [Setting the Default Process Security Level Using C++](https://docs.microsoft.com/en-us/windows/win32/wmisdk/setting-the-default-process-security-level-using-c-). For more information, see [Maintaining WMI Security](https://docs.microsoft.com/en-us/windows/win32/wmisdk/maintaining-wmi-security).

    /sharedhost
      Move the Winmgmt service into the shared Svchost process.

    /verifyrepository _path_
      Performs a consistency check on the WMI repository.
      When you add the /verifyrepository switch without the _path_ argument, then the live repository currently used by WMI is verified.
      When you specify the path argument, you can verify any saved copy of the repository.
      In this case, the path argument should contain the full path to the saved repository copy. The saved repository should be a copy of the
      entire repository folder. For more information about errors returned by this command, see the Remarks section.

    /salvagerepository
      Perform a consistency check on the WMI repository, and if an inconsistency is detected, rebuild the repository.
      The content of the inconsistent repository is merged into the rebuilt repository, if it can be read.
      The salvage operation always works with the repository that the WMI service is currently using.
      For more information about errors returned by this command, see the Remarks section.
      % MOF files that contain the #pragma autorecover preprocessor statement are restored to the repository.

    /resetrepository
      The repository is reset to the initial state when the operating system is first installed.
      MOF files that contain the #pragma autorecover preprocessor statement are restored to the repository.

    /?   Display Help.

Remarks
-------

> This tool is located in the %Windir%\System32\wbem directory.
> 
> The WMI repository, also known as the CIM repository, is not just a single file, but a collection of files within the Repository folder that work together as a database.
> 
> When you use the /backup switch to backup the repository, the resulting backup is a single compressed file.
> 
> WMI returns the error ERROR_INTERNAL_DB_CORRUPTION (net helpmsg 1358) if a verification operation indicates that the repository is not in a consistent state. This error can be returned from any command which performs repository verification, such as /verifyrepository or /salvagerepository.
> 
> If WMI returns error messages, be aware that they may not indicate problems in the WMI service or in WMI providers. Failures can originate in other parts of the operating system and emerge as errors through WMI.
> 
> Under any circumstances, do not delete the WMI repository as a first action because deleting the repository can cause damage to the system or to installed applications. For more information about the source of the problem, download and run the [WMI Diagnosis Utility](https://web.archive.org/web/20171011130327/http://www.microsoft.com/en-us/download/details.aspx?id=7684) diagnostic command line tool ([unsupported](https://techcommunity.microsoft.com/t5/ask-the-performance-team/wmidiag-2-2-is-here/ba-p/375642)). This tool produces a report that can usually isolate the source of the problem and provide instructions on how to fix it. The report also aids Microsoft support services in assisting you.

### Examples

Check/verify the repository:

WINMGMT /verifyrepository

Salvage the repository, after running this repeat the verify:

WINMGMT /salvagerepository

“Events, dear boy, events” ~ British Prime Minister Harold Macmillan (answer to 'what is the biggest problem in politics'?)

### Related commands

[WMIC](wmic.html) - WMI Commands.  



/. nt/winrm.html
========================================================

    Winrm - Windows CMD - SS64.com

WINRM
=====

Windows Remote Management  
  
Secure communication with local and remote computers using web services.

Syntax

      winrm g[et] | s[et] | c[reate] | d[elete] | e[numerate] | 
            i[nvoke] |  id[entify] | quickconfig |  configSDDL |  helpmsg

    Retrieve instances of _RESOURCE_URI_:
      **winrm get** _RESOURCE_URI_ [-SWITCH:_VALUE_ [-SWITCH:_VALUE_] ...]

      winrm get winrm/config
      winrm get winrm/config/client
      winrm get winrm/config/service

    Modify settings in _RESOURCE_URI_: 
      **winrm set** _RESOURCE_URI_ [-SWITCH:_VALUE_ [-SWITCH:_VALUE_] ...]
         [@{KEY="VALUE"[;KEY="VALUE"]}]
            [-file:VALUE]

    Spawn an instance of _RESOURCE_URI_:
      **winrm create** _RESOURCE_URI_ [-SWITCH:_VALUE_ [-SWITCH:_VALUE_] ...]
         [@{KEY="_VALUE_"[;KEY="_VALUE_"]}]
            [-file:_VALUE_]

    Control remote access to WinRM resources, launch a GUI to edit security settings.
      **winrm configsddl** _RESOURCE_URI_

    Enable this machine for remote management.
      **winrm quickconfig** [-quiet] [-transport:_VALUE_]

      This will start the WinRM service, set the service to auto start, create
      a listener and enable an http firewall exception for WS-Management traffic

       -q[uiet]          Don’t prompt for confirmation.

       -transport:_VALUE_  Perform quickconfig for either http or https.  Default = http.

    List instances of _RESOURCE_URI_:
      **[winrm enumerate](winrm-enumerate.html)** _RESOURCE_URI_ [-ReturnType:Value] [-Shallow]
         [-BasePropertiesOnly] [-SWITCH:_VALUE_ [-SWITCH:_VALUE_] ...]

    Remove an instance of _RESOURCE_URI_:
      **winrm delete** _RESOURCE_URI_ [-SWITCH:_VALUE_ [-SWITCH:_VALUE_] ...]

    Execute method specified by _ACTION_ on target object specified by _RESOURCE_URI_
      **winrm invoke** _ACTION RESOURCE_URI_ [-SWITCH:_VALUE_ [-SWITCH:_VALUE_] ...]
         [@{KEY="_VALUE_"[;KEY="_VALUE_"]}]
            [-file:_VALUE_]

    Display error message associate with the error code.
      **winrm helpmsg** errorcode

Key

    -a[uthentication]:_VALUE_
                    The authentication mechanism to use when communicating
                    with the remote machine.

    -defaultCreds    Allow implicit credentials when Negotiate is used.
                    Remote HTTPS operations for trusted machines.

    -dialect:_VALUE_   Dialect of the filter expression for enumeration or fragment.
                    Example: Use a WQL query
                      -dialect:http://schemas.microsoft.com/wbem/wsman/1/WQL
                    Example: Use XPATH for filtering with enumeration or fragment get/set.
                      -dialect:https://www.w3.org/TR/1999/REC-xpath-19991116

    -encoding:_VALUE_  The encoding type when talking to remote machine (see [-remote](winrm-remote.html)).
                    Possible options are "utf-8" (the default) or "utf-16".

    -f[ormat]:_FORMAT_ The format of output. FORMAT can be "xml",
                    "pretty" (better formatted XML), or "text".

    [-r[emote]:_VALUE_](winrm-remote.html)  Specify the identifier of a remote endpoint/system.
                    This can be a simple host name or a complete URL.

    -skipCAcheck     The certificate issuer need not be a trusted root authority.
                    Remote HTTPS operations for trusted machines.

    -skipCNcheck     The certificate common name (CN) of the server need not match
                    the hostname of the server. HTTPS operations for trusted machines.

    -skipRevocationcheck  Do not check the revocation status of the server certificate.
                    Remote HTTPS operations for trusted machines.

    -SPNPort         Append port number to the Service Principal Name (SPN) of the
                    remote server. 
                    Service principal name is used when Negotiate or Kerberos authentication
                    mechanism is in use.

    -timeout:_MS_      Timeout in milliseconds. Limits duration of corresponding operation.
                    Default timeout can be configured by:
                       winrm set winrm/config @{MaxTimeoutms="XXXXXX"}
                    Where XXXXXX is an integer indicating milliseconds.

    -file:_VALUE_

    @{KEY="_VALUE_"[;KEY="_VALUE_"]}
                    Input from an XML file or via key/value pairs.
                    Applies to set, create, and invoke operations

    -fragment:_VALUE_  Specify a section inside the instance XML that is to be updated or
                    retrieved for the given operation.
                     Example: Get the status of the spooler service
                       winrm get wmicimv2/Win32_Service?name=spooler -fragment:Status/text()
                     
                     -options:{KEY="_VALUE_"[;KEY="_VALUE_"]}

                     Key/value pairs for provider-specific options.
                     
                     Example:
                       -options:{key1="value1";key2=$null}

WinRM is the Microsoft implementation of WS-Management Protocol, a standard Simple Object Access Protocol (SOAP)-based, firewall-friendly protocol that allows hardware and operating systems, from different vendors, to interoperate.

To improve security, WinRM 2.0 uses HTTP/HTTPS ports 5985/5986 by default.

If the computer name is passed using r:<Computername> , then the default client port will be used (by default, 5985/5986).  
If the computer name is passed as a URI, such as r:https://Mycomputer/wsman, then the IE default ports will be used (ports 80/443 by default).

Files:  
C:\WINDOWS\system32\winrm.vbs

### Examples

Configure Windows Remote Management on the server (DemoServer2), run this from an elevated CMD (or powershell) prompt:  
C:> winrm quickconfig

> On a client you can then open a remote shell connected to DemoServer2 with:  
> [winrs](winrs.html) -r:DemoServer2 cmd

Retrieve current configuration in XML format:  
winrm get winrm/config -format:pretty

Retrieve spooler instance of Win32_Service class:  
winrm get wmicimv2/Win32_Service?Name=spooler

Modify a configuration property of WinRM:  
winrm set winrm/config @{MaxEnvelopeSizekb="100"}

Disable a listener on this machine:  
winrm set winrm/config/Listener?Address=*+Transport=HTTPS @{Enabled="false"}

Add remote machine to the trusted hosts list (used if your computers aren’t on a domain):  
winrm set winrm/config/client '@{TrustedHosts="workstation64,server1"}'

Create instance of HTTP Listener on IPv6 address:  
winrm create winrm/config/Listener?Address=IP:3ffe:8311:ffff:f2c1::5e61+Transport=HTTP

Delete the HTTP listener on this machine for given IP address:  
winrm delete winrm/config/Listener?Address=IP:192.168.2.1+Transport=HTTP

Call StartService method on Spooler service:  
winrm invoke StartService wmicimv2/Win32_Service?Name=spooler

Call Create method of Win32_Process class with specified parameters:  
winrm invoke Create wmicimv2/Win32_Process @{CommandLine="notepad.exe";CurrentDirectory="C:\"}

Display error message associated with the error code 0x5:  
winrm helpmsg 0x5

“Start where you are. Distant fields always look greener, but opportunity lies right where you are. Take advantage of every opportunity of service” ~ Robert Collier

### Related commands

[WINRS](winrs.html) - Windows Remote Shell.  
Equivalent PowerShell: [Enable-PSRemoting](../ps/enable-psremoting.html) - Configure the computer to receive remote commands.  
Equivalent PowerShell: [Enter-PSSession](../ps/enter-pssession.html) - Start an interactive session with a remote computer.



/. nt/winrs.html
========================================================

    Winrs - Windows CMD - SS64.com

WINRS
=====

Windows Remote Shell.

Syntax

      winrs [-/_SWITCH_[:_VALUE_]] _COMMAND_

Key
    _COMMAND_    Any string that can be executed as a command in the cmd.exe shell.

           (All switches accept both short form or long form. For example both -r and 
            -remote are valid.)

    -r[emote]:_ENDPOINT_        The target endpoint using a NetBIOS name or the standard
                             connection URL: [_TRANSPORT_://]_TARGET_[:_PORT_].
                             If not specified  -r:localhost is used.

    -un[encrypted]            Messages to the remote shell will not be encrypted. This is useful for
                             troubleshooting, or when the network traffic is already encrypted using
                             ipsec, or when physical security is enforced.
                             By default the messages are encrypted using Kerberos or NTLM keys.
                             This switch is ignored when HTTPS transport is selected. 

    -u[sername]:_USERNAME_      Username. If -username is specified, -password must be as well.
                             If not specified Winrs will negotiate authentication or prompt. 

    -p[assword]:_PASSWORD_      Password. If not specified winrs will prompt for it.

    -d[irectory]:_PATH_         The starting directory for remote shell.
                             If not specified the remote shell will start in %USERPROFILE%.

    -env[ironment]:_STRING_=_VALUE_
                             A single environment variable to be set when shell starts.
                             This allows changing default environment for the shell.
                             Multiple occurrences of this switch can be used.

    -noe[cho]                 Disable echo. This might be necessary to ensure that user's answers
                             to remote prompts are not displayed locally. By default echo is "on".

    -nop[rofile]              Do not load the user's profile. By default the server will attempt to load
                             the user profile. If the remote user is not a local administrator on the
                             target system then this option will be required.

    -comp[ression]            Turn on compression.  Older installations on remote machines may
                             not support compression so it is off by default.

    -[use]ssl                 Use an SSL connection when using a remote endpoint. Specifying this instead
                             of the transport "https:" will use the default WinRM default port. 

    -?                        Help

To terminate the remote command press Ctrl-C or Ctrl-Break, which will be sent to the remote shell. The second Ctrl-C will force termination of winrs.exe.  
The URI alias to manage active shells is shell/cmd. The URI alias for WinRS configuration is winrm/config/winrs.

### Examples

Configure Windows Remote Management on the server (DemoServer2), run this from an elevated CMD (or powershell) prompt:  
C:> [winrm](winrm.html) quickconfig

> On a client you can then open a remote shell connected to DemoServer2 with:  
> winrs -r:DemoServer2 cmd

Batch file to quickly open a remote cmd shell:  
[rshell.cmd]  
@echo off  
winrs -r:%1 cmd

Run a dir command on a remote machine:  
C:> winrs -r:DemoServer3 dir

Run an install package on a remote server:  
C:> winrs -r:Server25 msiexec.exe /i c:\install.msi /quiet

Run a PowerShell script on the remote box:

C:> winrs /r:DemoServer2 powershell.exe -nologo -noprofile -command d:\test\test.ps1

You can’t open a full interactive remote PowerShell console, but as remoting is built-in to PowerShell 2.0 there is no need.

Connecting to the remote server 'myserver'

winrs -r:https://myserver.com command  
winrs -r:myserver.com -usessl command  
winrs -r:myserver command  
winrs -r:http://127.0.0.1 command  
winrs -r:http://169.51.2.101:80 -unencrypted command  
winrs -r:https://[::FFFF:129.144.52.38] command  
winrs -r:http://[1080:0:0:0:8:800:200C:417A]:80 command  
winrs -r:https://myserver.com -t:600 -u:administrator -p:$%fgh7 ipconfig  
winrs -r:myserver -env:PATH=^%PATH^%;c:\tools -env:TEMP=d:\temp config.cmd  
winrs -r:myserver netdom join myserver /domain:testdomain /userd:johns /passwordd:$%fgh789

“Perhaps when distant people on other planets pick up some wavelength of ours all they hear is a continuous scream” ~ Iris Murdoch

### Related commands

[WINRM](winrm.html) - Windows Remote Management, manage active remote shells & WinRS configuration.  
Equivalent PowerShell: [Enable-PSRemoting](../ps/enable-psremoting.html) - Configure the computer to receive remote commands.



/. nt/wmic.html
========================================================

    WMIC - Windows Management - Windows CMD - SS64.com .prompt {color: #993300}

WMIC.exe
========

Windows Management Instrumentation Command.  
Retrieve a huge range of information about local or remote computers. Make configuration changes to multiple remote machines.

The WMIC tool is [deprecated](https://docs.microsoft.com/en-us/windows/deployment/planning/windows-10-deprecated-features) in Windows 10, version 21H1 and the 21H1 semi-annual channel release of Windows Server.

The _ALIAS_ defines the component of your system that you want WMIC to interact with.  
The WHERE clause can be added to filter down to a specific item, e.g. a specific printer instead of all printers.

Syntax

    WMIC [_global_switch(s)_] _Alias_ [_[options](#alias_options)_] [[format](#format_specifiers)]

    WMIC [_global_switch(s)_] _Command_

    WMIC [_global_switch_:_value_] [_global_switch_:_value_] _Command_

    WMIC CONTEXT

    Interactive mode:
    WMIC

Global_Switches:
 /NODE         Servers to operate against:
                  @filename
                  machine_id <,machine id list>
 /APPEND       Mode for output redirection:  STDOUT, CLIPBOARD, <filename>
 /AUTHLEVEL    Client authentication level:  Default,None,Connect,Call,Pkt,Pktintegrity,Pktprivacy
 /AGGREGATE    Aggregate mode: (column titles)    ON, OFF
 /AUTHORITY    The <authority type> for the connection.
 /FAILFAST     FailFast mode:(timeout for connection to remote machine)   ON, OFF
 /IMPLEVEL     Client impersonation level:    Anonymous,Identify,Impersonate,Delegate
 /INTERACTIVE  Interactive mode:(prompt before WMI schema changes)    ON, OFF
 /LOCALE       Language id.    (ms_409=US)
 /NAMESPACE    Path for the namespace the alias operates against.
 /OUTPUT       Mode for output redirection:    STDOUT, CLIPBOARD, <filename>
 /PASSWORD     Password for session login.   <password>
 /PRIVILEGES   Enable or disable all privileges:  ENABLE, DISABLE
 /RECORD       Log all input commands and output: <FilePath>
 /ROLE         Path for the role containing the alias definitions.
 /TRACE        Output debugging information to stderr.  ON, OFF
 /USER         User for this session:      <domain>\<userid>

 CONTEXT       Display the current state of all global switches.
 CLASS         Escape to full WMI schema.
 PATH          Escape to full WMI object paths.
 QUIT/EXIT     Exit WMIC

Aliases:

 ALIAS               - Access local system aliases [CALL]
 BASEBOARD           - Base board management (motherboard or system board) 
 BIOS                - BIOS management (Basic input/output services) 
 BOOTCONFIG          - Boot configuration
 CDROM               - CD-ROM
 COMPUTERSYSTEM      - Computer system [CALL/SET]
 CPU                 - CPU
 CSPRODUCT           - Computer system product information from SMBIOS. 
 DATAFILE            - DataFiles [CALL]
 DCOMAPP             - DCOM Applications.
 DESKTOP             - User's Desktop
 DESKTOPMONITOR      - Desktop Monitor
 DEVICEMEMORYADDRESS - Device memory addresses
 DISKDRIVE           - Physical disk drive
 DISKQUOTA           - Disk space usage for NTFS volumes.[SET]
 DMACHANNEL          - Direct memory access (DMA) channel
 ENVIRONMENT         - System environment settings [SET]
 FSDIR               - Filesystem directory entry [CALL]
 GROUP               - Group account [CALL]
 IDECONTROLLER       - IDE Controller
 IRQ                 - Interrupt request line
 JOB                 - Jobs scheduled using the schedule service.[CALL]
 LOADORDER           - System services that define execution dependencies. 
 LOGICALDISK         - Local storage devices [CALL/SET]
 LOGON               - LOGON Sessions.
 MEMCACHE            - Cache memory
 MEMORYCHIP          - Memory chip information.
 MEMLOGICAL          - System memory, layout and availability
 MEMPHYSICAL         - Physical memory management
 NETCLIENT           - Network Client management.
 NETLOGIN            - Network login information for a particular user. 
 NETPROTOCOL         - Protocols (and their network characteristics).
 NETUSE              - Active network connection.
 NIC                 - Network Interface Controller (NIC)
 NICCONFIG           - Network adapter. [CALL] 
 NTDOMAIN            - NT Domain. [SET]  
 NTEVENT             - NT Event Log.  
 NTEVENTLOG          - NT eventlog file [CALL/SET]
 ONBOARDDEVICE       - Common adapter devices built into the motherboard.
 OS                  - Operating System/s [CALL/SET]
 PAGEFILE            - Virtual memory file swapping
 PAGEFILESET         - Page file settings [SET]
 PARTITION           - Partitioned areas of a physical disk.
 PORT                - I/O ports
 PORTCONNECTOR       - Physical connection ports
 PRINTER             - Printer device [CALL/SET]
 PRINTERCONFIG       - Printer device configuration  
 PRINTJOB            - Print job [CALL]
 PROCESS             - Processes [CALL]*
 PRODUCT             - Windows Installer [CALL]
 QFE                 - Quick Fix Engineering (patches)
 QUOTASETTING        - Setting information for disk quotas on a volume. [SET]
 RDACCOUNT           - Remote Desktop connection permission [CALL]
 RDNIC               - Remote Desktop connection on a specific network adapter [CALL/SET]
 RDPERMISSIONS       - Permissions to a specific Remote Desktop connection [CALL]
 RDTOGGLE            - Turn Remote Desktop listener on or off remotely[CALL]
 RECOVEROS           - Blue Screen Information [SET]
 REGISTRY            - Computer system registry [SET]
 SCSICONTROLLER      - SCSI Controller [CALL]
 SERVER              - Server information 
 SERVICE             - Service application [CALL]
 SHADOWCOPY          - Shadow copy management [CALL]
 SHADOWSTORAGE       - Shadow copy storage areas [CALL/SET]
 SHARE               - Shared resourcees [CALL]
 SOFTWAREELEMENT     - Elements of a software product*
 SOFTWAREFEATURE     - Subsets of SoftwareElement. [CALL]*
 SOUNDDEV            - Sound Devices 
 STARTUP             - Commands that run automatically when users logon
 SYSACCOUNT          - System account  
 SYSDRIVER           - System driver for a base service. [CALL]
 SYSTEMENCLOSURE     - Physical system enclosure
 SYSTEMSLOT          - Physical connection points including ports,
                       slots and peripherals, and proprietary connections points.
 TAPEDRIVE           - Tape drives  
 TEMPERATURE         - Temperature sensor (electronic thermometer).
 TIMEZONE            - Time zone data 
 UPS                 - Uninterruptible power supply (UPS) 
 USERACCOUNT         - User accounts [CALL/SET]
 VOLTAGE             - Voltage sensor (electronic voltmeter) data
 VOLUME              - Local storage volume [CALL/SET]
 VOLUMEQUOTASETTING  - Associates the disk quota setting with a specific disk volume. [SET]
 VOLUMEUSERQUOTA     - Per user storage volume quotas  [SET]
 WMISET              - WMI service operational parameters [SET]

 for more inofrmation on a specific alias, type alias /?

**Options**

> By default an alias will return a standard LIST of information, you can also use GET to return one or more specific properties.
> 
> GET * will also return all properties.
> 
> Configuration changes can be made, where indicated above with: [CALL or SET ]
> 
> The CREATE and DELETE options allow you to change the WMI schema itself.

    _alias_ 
    _alias_ LIST [BRIEF | FULL | INSTANCE | STATUS |SYSTEM | WRITEABLE]
                [/TRANSLATE:BasicXml_|_NoComma ]
                   [/EVERY:_no_secs_] [/FORMAT:_format_]
    _alias_ GET [_property list_]
                [/VALUE ] [/ALL ] [/TRANSLATE:BasicXml_|_NoComma ]
                   [/EVERY:_no_secs_] [/FORMAT:_format_]
    _alias_ CALL _method_name_ [_parameters_]
    _alias_ SET [_assignments_]
    _alias_ CREATE 
    _alias_ DELETE
    _alias_ ASSOC [/RESULTCLASS:_classname_] [/RESULTROLE:_rolename_][/ASSOCCLASS:_assocclass_]

    For more help
    WMIC _alias_ /?
    WMIC _alias option_ /?
    e.g.
    WMIC BIOS CALL /?
    WMIC MEMLOGICAL SET /?

> The order of the /FORMAT and /TRANSLATE switches is significant: if /TRANSLATE follows /FORMAT, the output is formatted first and then translated.

Where
-----

> The options above can be filtered with a WHERE clause:
> 
> Where _item_='_string value_' \# Test if Equal  
> Where _item_!='_string value_' \# NOT EQUAL
> 
> Use single quotes to delimit spaces or special characters, do not add spaces to either side of the = or !=  
> See further examples below.

**Format**:

> Format defines the layout of the information, XML output is automatically formatted using a default style sheet, while other formats (HTML, Table, MOF, Raw XML etc) can be specified using [/FORMAT: _stylesheet_name_](wmicstylesheets.html)
> 
> Stylesheets supplied with WMIC:
> 
>     csv.xsl, hform.xsl, htable-sortby.xsl, htable.xsl  
>     texttable.xsl, textvaluelist.xsl, xml.xsl
> 
> Tab Separated Values (.tsv) can be opened in excel
> 
> The PROCESS alias can be used to start a new installation process, if doing this across the network, place the installer files on a share with permissions EVERYONE : Read Only. This is because network credentials will be dropped when jumping from one remote machine to another (unless you have kerberos configured).

Encoding
--------

> All WMIC output is UTF16 Unicode text with a BOM, convert this to plain ASCII with [TYPE](type.html) or [MORE](more.html)  
> e.g. WMIC OS LIST BRIEF |more >> "C:\demo.txt"

Notes
-----

> To run WMIC requires administrator rights and for many operations [Elevation](syntax-elevate.html).
> 
> The last element returned by WMIC is a single <CR> character (an empty line), when running WMIC in a FOR loop you might need to [remove](https://stackoverflow.com/questions/8015489/why-is-the-for-f-loop-in-this-batch-script-evaluating-a-blank-line) this, particularly if [delayed expansion](delayedexpansion.html) is involved.
> 
> The number of WMI properties that can be monitored has increased with every new version of Windows.
> 
> For bulk operations [CIM](../ps/get-ciminstance.html) is significantly faster than WMI.
> 
> Running WMIC within a batch file it can sometimes hang, possible workarounds for this:  
> START "" /W CMD /C WMIC _options_...  
> WMIC _options_... <NUL
> 
> The WMI information for installed software packages (PACKAGE and SOFTWAREFEATURE) is often incomplete and inconsistent for a variety of historical reasons. A more reliable method is to retrieve a list of installed programs directly from the Add/Remove list in the registry, with a VBScript like [this](installed.txt) from Torgeir Bakken or a PowerShell script: [Get-Programs.ps1](../ps/syntax-programs.html)

### Examples

:: Display the DELL Serial number (also works for some other brands)
WMIC **BIOS** get serialnumber

:: List the available key/value pairs for the computer:
WMIC **COMPUTERSYSTEM** get * /format:list |more

:: Display Memory and domain join status:
WMIC **COMPUTERSYSTEM** get PartofDomain,TotalPhysicalMemory /format:list 

:: List the available key/value pairs for the OS:
WMIC **OS** get * /format:list |more

:: List the OS build and [version](ver.html)
WMIC **OS** LIST BRIEF

:: List the computername, locale and Bootdevice:
WMIC **OS** GET csname, locale, bootdevice /value

WMIC **OS** GET osarchitecture /value

:: Get a list of installed Windows updates on a remote machine, unlike Get-Hotfix, this includes the installation date.
WMIC /NODE:"server64" **QFE** list 

:: Get the local date and time
WMIC **OS** GET localdatetime

:: List all local Disks
WMIC **LOGICALDISK** where drivetype!=4 get deviceid, description, volumename

:: List ipv4 adapters 
WMIC **NICCONFIG** where (IPEnabled=True and TcpipNetbiosOptions!=null and TcpipNetbiosOptions!=2) GET caption,index,TcpipNetbiosOptions,IPEnabled

:: [Disable Netbios](https://241931348f64b1d1.wordpress.com/2010/04/21/how-to-disable-netbios-via-command-line-on-windows/)
WMIC **NICCONFIG** where (IPEnabled=True and TcpipNetbiosOptions!=null and TcpipNetbiosOptions!=2) CALL SetTcpipNetbios 2

:: Dump the full application event log to a text file:
WMIC **NTEVENT** List Full >appevents.txt

:: List all the running services and save to a file
WMIC **SERVICE** where (state="running") GET caption, name, state > services.tsv

:: Stop the TELNET service (also StartService, PauseService,ResumeService)
WMIC **SERVICE** where caption='TELNET' CALL StopService

:: List the installed software MSI's
WMIC **PRODUCT** GET name,vendor,version
WMIC **PRODUCT** GET InstallDate, Name,localPackage 

:: Display Printer Status
WMIC **PRINTER** LIST brief
WMIC **PRINTER** LIST /?
WMIC **PRINTER** where PortName="LPT1:" GET PortName, Name, ShareName
 
WMIC /INTERACTIVE:ON **PRINTER** where PortName="LPT1:" DELETE

WMIC **PROCESS** where name='evil.exe' delete

WMIC /output:"%computername%.txt" **MEMORYCHIP** where "memorytype=17" get Capacity

WMIC /node:computer64,computer65 **PROCESS** call create **"**netstat.exe -ano > C:\output.txt**"**

WMIC /node:@computers.txt /failfast:on **PROCESS** call create **"**\server\share\installer.cmd**"**

WMIC /node:computer64 /output:shares.html **SHARE** get name,path /format:htable

WMIC /node:computer64 **SHARE** where name="Share1" 

Interactive mode:
C:> WMIC
wmic:root\cli> **OS** get csname
wmic:root\cli> quit

“Life is like a game of cards. The hand you are dealt is determinism; the way you play it is free will” ~ Jawaharial Nehru

### Related commands

[SYSTEMINFO](systeminfo.html) - List system configuration.  
[The Grammar of WMIC](https://isc.sans.edu/diary.html?storyid=2376) - ISC.  
MOF (Managed Object Format) - A language that describes management information.  
Equivalent PowerShell: [Get-CIMinstance](../ps/get-ciminstance.html) - Get information via CIM.  
[Docs.Microsoft.com](https://docs.microsoft.com/en-gb/windows/desktop/WmiSdk/wmi-reference) - Full WMI reference, Classes and providers.



/. nt/wpeutil.html
========================================================

    Wpeutil - Windows CMD - SS64.com

WPEUTIL.exe
===========

Run commands during a Windows Preinstallation Environment ([WinPE](syntax-recovery.html)) session. To get Windows PE, [install the ADK](https://docs.microsoft.com/en-us/windows-hardware/get-started/adk-install) and choose the Deployment Tools and Windows Preinstallation Environment options.

Syntax

      Wpeutil CreatePageFile [/path=_path_] [/size=_size_]
      Wpeutil DisableExtendedCharactersForVolume _path_on_target_volume_
      Wpeutil Disablefirewall
      Wpeutil EnableExtendedCharactersForVolume _path_on_target_volume
      Wpeutil Enablefirewall
      Wpeutil InitializeNetwork
      Wpeutil ListKeyboardLayouts _[LCID](../locale.html)_
      Wpeutil Reboot
      Wpeutil SaveProfile
      Wpeutil SetKeyboardLayout _keyboard_layout_ID_
        Run ListKeyboardLayouts to get a list of supported keyboard layouts
      Wpeutil SetMuiLanguage _[language-name](../locale.html)_[;_[language-name](../locale.html)_]
        Specify multiple languages in priority order, separating them with a semicolon.
        For example: Wpeutil SetMuiLanguage de-DE;en-US
      Wpeutil SetUserLocale _[language-name](../locale.html)_[;_[language-name](../locale.html)_]
      Wpeutil Shutdown
      Wpeutil UpdateBootInfo
      Wpeutil WaitForNetwork   (Waits for the network card to be initialized.)
      Wpeutil WaitForRemovableStorage (block startup until removable devices, e.g. USB drives, are initialized.)

Wpeutil can only accept one command per line.

A common method to initiate an unattended Setup is to boot the computer using Windows PE, and then launch Setup with an answer file from a distribution folder on the network.

### Examples

Reboot from a WinPE session:

Wpeutil Reboot

Enable the firewall, set the language and then wait for the network to initialise:

Wpeutil Enablefirewall  
Wpeutil SetMuiLanguage en-US  
Wpeutil WaitForNetwork

_“Since the day of my birth, my death began its walk. It is walking toward me, without hurrying” ~Jean Cocteau_

### Related commands

[Wpeutil](https://docs.microsoft.com/en-gb/windows-hardware/manufacture/desktop/wpeutil-command-line-options) - Microsoft help page.  
[BCDBOOT](bcdboot.html) - Create or repair a system partition.  
[BCDEDIT](bcdedit.html) - Manage Boot Configuration Data.  
[BOOTREC](bootrec.html) - Repair or replace a partition boot sector (WinRE).  
[WinPE Intro](https://docs.microsoft.com/en-gb/windows-hardware/manufacture/desktop/winpe-intro) - Microsoft help page.  
[Recovery /Reset options in Windows](https://support.microsoft.com/en-us/windows/recovery-options-in-windows-31ce2444-7de3-818c-d626-e3b5a3024da5#bkmk_reset_pc&ID0EDD=Windows_10) - Microsoft support.



/. nt/wpr.html
========================================================

    WPR Windows Performance Recorder - Windows CMD - SS64.com

WPR.exe
=======

Windows Performance Recorder  
  
Record system events for analysis with [Windows Performance Analyzer](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-8.1-and-8/hh448170(v=win.10)) (WPA)  
WPR is part of the [Windows Assessment and Deployment Kit](https://docs.microsoft.com/en-gb/windows-hardware/get-started/adk-install) (Windows ADK) for Windows 10

Syntax

      WPR _options..._
Key
    -cancel        - Cancel recording initiated via WPR (if any).
    -help          - Provide command line help information.
    -log {enabled|disabled|remove} - Configure debug logging to the event log.

    -marker _scenario_name_     - Fire an event marker.
    -markerflush _scenario_name_  - Fire an event marker and flush the working set.

    -profiles      - Enumerate the profile names and descriptions from a profile file.
    -purgecache    - Purges the dynamic symbols cache.
    -profiledetails _profile1+profile2.._+_profilen_ [-filemode] -onoffscenario _OnOff Transition Type_
                    Display the detailed information about a set of profiles.
                    The naming convention of the profiles is exactly the same as used
                    in wpr -start, a profile is specified as  _profile_name_[.{light|verbose}].

    -providers     - Display detailed information about providers.

    -status        - Display status on active recording (if any).
    -start _[options](#start)_ - Start one or more profiles.
    -stop [_recording_filename_] [_problem_description_]
                  - Stop recording initiated via WPR (if any) and save.

    -enablePeriodicSnapshot   Enable Periodic Snapshot for the specified interval and process_id.
    -disablePeriodicSnapshot  Disable Periodic Snapshot for all process.
    -singlesnapshot  Get an on-demand Snapshot for the specified process.

    -disablepagingexecutive {on|off} - Change the Disable Paging Executive settings.
    -heaptracingconfig _process_name_ [_Package_full_name_ _Package_relative_app_ID_] [{enable|disable}]
                  - Change heap tracing settings for a process.
                    If the {enable|disable} parameter is omitted the current heap tracing
                    configuration for the process or app will be displayed.

    -capturestateondemand   - Capture states for the configured providers in the current recording.
    -pmcsources    - Query the list of hardware counters available on the system.
    -setprofint    - Set the sampled profile interval to _n_  [1221...10000000].
                    [Default: _n_ = 10000 (1msec)]

    -profint       - Query the current profile interval.
    -resetprofint  - Restore the default profile interval values.

 **start options:**
    -start [_filename.wprp_!] _profile_ [-start _profile_...]
      [-filemode] [-recordtempto _temp_folder_path_] [-onoffscenario _OnOff_Transition_Type_]
         [-onoffresultspath  _path_to_which_the_trace_files_are_saved_]
            [-onoffproblemdescription _description_of_the_scenario_]
               [-onoffpretracecommand _command_to_run_synchronously_each_iteration_before_tracing_starts_]
                  [-onoffposttracecommand _command_to_run_asynchronously_after_all_the_iterations_complete_or_fail_]
                     [-numiterations _number_of_iterations_for_OnOff_tracing_]

      -start [_filename.wprp_!] _profile_ is either a built-in profile (if no filename is specified) or a path to
                      (and name of) a user-defined custom profile.
                       The user can specify up to 64 profiles on the command line.  Each profile is specified as:
           _profile_ := [_filename.wprp_!]_profile_name_[.{light|verbose}]
                       Each profile can define both light and verbose variants or just one of the two.
                       If neither option is specified, the verbose variant is used unless the profile has only a light variant.

      -filemode        Specifies that recording is done in file mode, the default is memory mode.
      -onoffscenario   Specifies one of the on/off transition types: Boot, FastStartup, Shutdown, RebootCycle, Standby, or Hibernate.
      -numiterations   Set the number of iterations for OnOff recording.

      By default the settings from the built-in or custom profile file are used.

WPR must be run [elevated.](syntax-elevate.html)

### Examples

List the available/built in profiles:

C:> wpr -profiles

Record some registry events to c:\wpr\registry

C:> md wpr & cd wpr  
C:\wpr> wpr -start registry  
C:\wpr> wpr -stop registry  

“The essential matter of history is not what happened but what people thought or said about it” ~ Frederic William Maitland

### Related commands

[PSR](https://support.microsoft.com/en-us/help/22878/windows-10-record-steps) - Windows Problem Steps Recorder.  
[Microsoft.com](https://learn.microsoft.com/en-us/windows-hardware/test/wpt/wpr-command-line-options) - WPR Command-Line Options



/. nt/wt.html
========================================================

    WT.exe Windows Terminal - Windows CMD - SS64.com

WT.exe Windows Terminal ([download](https://www.microsoft.com/en-us/p/windows-terminal/9n0dx20hk701) from the Windows Store)
============================================================================================================================

Windows Terminal with support for [CMD](cmd.html), [PowerShell](../ps/), WSL and [SSH](ssh.html).

Syntax   
      WT [_options_] [_command_ ; ]

Commands and Parameters

Create a new tab:
    new-tab, nt 	   --profile, -p _profile-name_,
                      --startingDirectory, -d _starting-directory_,
                         _commandline_, --title _TitleText_
Split pane:
    split-pane, sp  -H, --horizontal, -V, --vertical,
                      --profile, -p _profile-name_,
                         --startingDirectory, -d _starting-directory_,
                            _commandline_, --title _TitleText_

Focus on a tab:
    focus-tab, ft   --target, -t _tab-index_

    If several tabs or panes are being opened, the commands above may be repeated,
    separate the options for each tab with ';' 

Options
    --help, -h, -?, /? Display help.
    --maximized, -M    Launch the terminal maximized.
    --fullscreen, -F   Launch the terminal Full screen.

The first stable release of WIndows Terminal was v1.2.2381.0 / 2020-August-26

--profile, -p will always open a new window. Windows Terminal is not yet capable of opening new tabs or panes in an existing instance.

The keyboard shortcut Ctrl+Shift+P will open a command palette listing available commands. Ctrl+Tab and Ctrl+Shift+Tab will navigate between tabs. This is enabled by default with "useTabSwitcher": true (global setting).

By default, PowerShell (unlike CMD), will always wait for Windows Store applications (like WT.exe) to close before returning to the prompt. To avoid this delay, use [Start-Process](../ps/start-process.html) to run WT.exe.

Windows Terminal uses the semicolon character ; as a delimiter for separating commands in the wt command line.  
Unfortunately, PowerShell also uses ; as a command separator.  
To work around this, you can run Start-Process WT and wrap all the wt parameters in single quotes (') so that everything is passed to wt unchanged.

### Examples

Open a new terminal instance from cmd, use the default profile and specify the starting directory for the console, as H:  
  
WT -d h:\

Open a new terminal instance from cmd, using your custom "[cmd](cmd.html)" profile settings:

WT -p cmd

Open a new terminal instance, using the profile named "Ubuntu-18.04" (Substitute "Ubuntu-18.04" with the name of any terminal profile that you have installed.)  
  
WT -p "Ubuntu-18.04"

Open a new terminal instance with multiple tabs:

WT ; ;

Open a new terminal instance with multiple tabs: a Command Prompt profile and a PowerShell profile:

WT -p "Command Prompt" ; new-tab -p "Windows PowerShell"

Open a new terminal instance with one tab containing three panes running a Command Prompt profile, a PowerShell profile, and your default profile running a WSL command line:

WT -p "Command Prompt" ; split-pane -p "Windows PowerShell" ; split-pane -H wsl.exe

The new-tab and split-pane commands can be sequenced to get multiple tabs, each with split panes. To open a new terminal instance with two tabs, each with two panes running a Command Prompt and a WSL command line, with each tab in a different directory:

WT -p "Command Prompt" ; split-pane -V wsl.exe ; new-tab -d c:\ ; split-pane -H -d c:\ wsl.exe

From a PowerShell prompt, open Windows Terminal with CMD, PowerShell and WSL:

PS C:> start WT 'new-tab "cmd" ; split-pane -p "Windows PowerShell" ; split-pane -H wsl.exe'

"If you want to go fast, go alone, If you want to go far, go together"~ African proverb

### Related commands

[COLOR](color.html) - Change colors of the CMD window.  
[ANSI colors](syntax-ansi.html) - Use ANSI colors in the terminal.  
[CMD](cmd.html) - Start a new CMD shell.  
[Introduction](https://devblogs.microsoft.com/commandline/introducing-windows-terminal/) + [Windows Terminal DevBlog](https://devblogs.microsoft.com/commandline/) - Microsoft.com  
[Github](https://github.com/Microsoft/Terminal) source.



/. nt/wusa.html
========================================================

    wusa - Windows Update - Windows CMD - SS64.com

WUSA.exe
========

Windows Update Standalone Installer.

Syntax

      WUSA _options_
Options:
    /extract    Extract the package contents to a destination folder.
               This option was removed from Windows 10 due to a security issue, privilege elevation
               would allow executables to be extracted to C:\windows\system32 [[x](https://msitpros.com/?p=3100)].

    /kb:_#####_   Uninstall a package led by using its KB number. Use only together with /uninstall.

    /quiet      Run Wusa.exe in quiet mode without user interaction. When the tool runs in quiet mode,
               it runs without user interaction. The computer restarts if this is required.

               For example, if the Windows6.0-KB934307-x86.msu file is in the D:\934307 folder,
               type the following command at a command prompt to install the update package without
               user interaction:

               wusa.exe d:\934307\Windows6.0-KB934307-x86.msu /quiet

               When you use this switch, the Microsoft Software License Terms do not appear.

    /norestart  Prevent Wusa.exe from restarting the computer.
               The /norestart switch is ignored if the /quiet switch is not present.
               If you run Wusa.exe together with these two switches, you must manually restart the
               operating system after the installation is complete (if the installation requires a restart)

               For example, if the Windows6.0-KB934307-x86.msu file is in the D:\934307 folder, type
               the following command to install the update package:

               wusa.exe D:\934307\Windows6.0-KB934307-x86.msu /quiet /norestart

    /warnrestart
               When this switch is combined with the /quiet switch, Wusa.exe prompts you before it
               begins a restart for install and uninstall operations.

    /forcerestart
               When this switch is combined with the /quiet switch, Wusa.exe forcibly closes
               applications and then begins a restart.

    /uninstall /kb:_#####_
               Uninstall an update.

    /?, /h, /help   View help.

The wusa usage to _quietly_ uninstall an update has been [deprecated](https://docs.microsoft.com/en-us/windows/deployment/planning/windows-10-deprecated-features). (wusa.exe /uninstall /kb:####### /quiet )  
The uninstall command with /quiet switch fails with event ID 8 in the Setup event log. Uninstalling updates quietly could be a security risk because malicious software could quietly uninstall an update in the background without user intervention.

On sites where WSUS is enabled, you may sometimes need to temporarily revert to Windows Update (0) in place of the WSUS server (1).

HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU

Value name: UseWUServer  
value = 0 to use a _Windows Update_ server.  
value = 1 to use a local server that is running Software Update Services.

Restart the Windows Update Service to ensure the changes take effect:

NET stop wuauserv  
NET start wuauserv

### Examples

C:> WUSA d:\934307\Windows6.0-KB934307-x86.msu /quiet

C:> WUSA D:\934307\Windows6.0-KB934307-x86.msu /quiet /norestart

C:> WUSA /uninstall /kb:934307 /norestart

“A scar does not form on the dying. A scar means I survived” ~ Chris Cleave

### Related commands

[EXPAND](expand.html) - Uncompress CAB/MSU files.  
[DISM](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-8.1-and-8/hh825265(v=win.10)) - Operating System Package Servicing.  
[WUAUCLT](wuauclt.html) - Windows Update Agent.  
%systemroot%\WindowsUpdate.log  
[Q934307](https://support.microsoft.com/en-gb/help/934307/) - Description of the Windows Update Standalone Installer.  
[Q824687](https://support.microsoft.com/en-us/help/824687/) - Command-line switches for Microsoft software update packages.



/. nt/wuauclt.html
========================================================

    wuauclt - Windows Update - Windows CMD - SS64.com

WUAUCLT.exe
===========

Windows Update Agent, download new [Windows Update](https://windowsupdate.microsoft.com/) files.

Syntax

      wuauclt _Options_

Options:

    /a or /ResetAuthorization  Initiate an asynchronous background search for applicable updates.
                              If Automatic Updates are disabled, this has no effect.

    /r or /ReportNow           Send all queued reporting events to the server asynchronously.

    /DetectNow                 Initiate detection right away, Query the WSUS server immediately 
                              to see if any new updates are needed.

WSUS uses a cookie on client computers to store computer group membership when client-side targeting is used. By default this cookie expires an hour after WSUS creates it. If you are using client-side targeting and change group membership, use /ResetAuthorization /detectnow to expire the cookie, initiate detection, and have WSUS update computer group membership.

If Windows Update has been blocked, disabled or failing for a long period of time a long history of updates will build up in the archive, this can cause high CPU use. [Resetting the client](https://docs.microsoft.com/en-us/windows/deployment/update/windows-update-resources) can help with this, but it will take a long time to run Windows Update afterwards.

Preventing Automatic reboots
----------------------------

> Run gpedit.msc
> 
> Navigate to: Computer Configuration ➞ Administrative Templates ➞ Windows Components ➞ Windows Update
> 
> Open this and change the "_No auto-restart with logged on users for scheduled automatic updates installations_" to ENABLED
> 
> In the control panel choose _Update and Security_ > _Windows Update_.
> 
> Click "_Check for updates_"
> 
> Alternatively set this in the registry:
> 
> HKLM:\Software\Policies\Microsoft\Windows\WindowsUpdate\AU  
> NoAutoRebootWithLoggedOnUsers (DWORD=1 to disable automatic reboots)

Fixing Windows Update when it gets stuck
----------------------------------------

> Open Settings ➞ Troubleshoot Other problems ➞ Windows Update.
> 
> In Windows 11, this can be found in Settings ➞ Troubleshoot ➞ Other Troubleshooters.
> 
> If that doesn't work, try deleting Windows Update's cache by booting into Safe Mode, stopping the wuauserv service, and deleting the files in C:\Windows\Software\Distribution.
> 
> If all else fails, download updates manually using the [WSUS Offline Update tool](https://download.wsusoffline.net/).

### Examples

C:> wuauclt /a /DetectNow

C:> wuauclt /r /DetectNow

“We must always change, renew, rejuvenate ourselves; otherwise we harden” ~ Johann Wolfgang von Goethe

### Related commands

[WUSA](wusa.html) - Windows Update Standalone Installer.  
wuauserv - The _Windows Update_ [Service](syntax-services.html)  
[Windows Update Troubleshooting](https://docs.microsoft.com/en-us/windows/deployment/update/windows-update-resources) - completely reset the _Windows Update_ client settings.  
[AskWoody.com](https://www.askwoody.com/) - Blog with a focus on _Windows Update_ conflicts.  
%systemroot%\WindowsUpdate.log  
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate



/. nt/xcacls.html
========================================================

    Xcacls.exe - Display or modify Access Control Lists - Windows CMD - SS64.com

XCACLS.exe (NT 4 Resource Kit, Windows XP and 2003)
===================================================

Display or modify Access Control Lists (ACLs) for files and folders.

For Vista and greater use [icacls](icacls.html) or [SetObjectSecurity](setobjectsecurity.html).

Syntax

      XCACLS _filename_ [_options_]

      XCACLS _filename_  
Key
    If no _options_ are specified XCACLS will display the ACLs for the file(s)

    _options_ can be any combination of:

    /T       Traverse all subfolders and change all matching files found. 
  
    /E       Edit ACL instead of replacing it. 

    /x       Edit ACL instead of replacing it; affect only ACEs that this user already owns

    /R _user_  Revoke all access rights from the given user.

    /D _user_  Deny specified user access, this will over-ride
            all other permissions the user has.

    /C       Continue on access denied errors. 
    /Y       Replace user's rights without verify

    /P _user_:_permision_[;_FolderSpec_]
            Replace user's rights. see /G option below

    /G _user_:_permision_[;_FolderSpec_]
           Grant specified user access rights, _permision_ can be: 
           r  Read 
           c  Change (write) 
           f  Full control
           p  Change Permissions (Special access)
           o  Take Ownership (Special access)
           x  EXecute (Special access)
           e  REad (Special access)
           w  Write (Special access)
           d  Delete (Special access)
           t  Used only by _FolderSpec_. see below

FolderSpec is a permission applied to a folder. If FolderSpec is not specified then permission will apply to both files and folders.  
This allows you to set different permissions that will apply (through inheritance) when new files are added to the folder.  
  
FolderSpec = ;T@ where @ is one of the rights above, when this is specified new files will inherit FolderSpec instead of permission. At least one folder access right must follow the T For example ;TF will apply full control (but ;FT is not valid).

If the file/folder is currently open (locked) it may not be possible to change the permissions without first closing the file locks. This can be done in Computer Management ➞ Shared Folders ➞ Open files.  
  
Wildcards can be used to specify more that one file in a command. You can specify more than one _user_ in a command. You can combine access rights.

Although taking ownership is listed as an option it does not work, use [SUBINACL](subinacl.html) for this.

**Inheritance Errors**

"_Permissions incorrectly ordered_" - the quickest way to resolve or avoid these errors is to use the newer [iCACLS](icacls.html) command instead of XCACLS.

Inherited folder permissions are displayed as:

 OI - Object inherit    - This folder and files. (no inheritance to subfolders)
 CI - Container inherit - This folder and subfolders.
 IO - Inherit only      - The ACE does not apply to the current file/directory

These can be combined as follows:
 (OI)(CI)      This folder, subfolders, and files.
 (OI)(CI)(IO)  Subfolders and files only.
     (CI)(IO)  Subfolders only.
 (OI)    (IO)  Files only. 

So BUILTIN\Administrators:(OI)(CI)F means that both files and Subdirectories will inherit 'F' (Fullcontrol)  
similarly (CI)R means Directories will inherit 'R' (Read folders only = List permission)

When xcacls is applied to the current folder only there is no inheritance and so no output.

By default, an object will inherit permissions from its parent object, either at the time of creation or when it is copied or moved. The only exception to this rule occurs when you **move** an object to a different folder on the same volume. In this case, the original permissions are retained. In controlled environments this ensures that users cannot change file permissions by just moving items to a different folder. This behaviour can be disabled by setting a system-wide registry key, see [Q310316](https://learn.microsoft.com/en-GB/troubleshoot/windows-client/windows-security/permissions-on-copying-moving-files).

NTFS permissions have changed with different versions of Windows and XCACLS has been updated to suit.

### Examples

Allow _guests_ the right to read and execute in "C:\demo\reports"  
XCACLS "C:\demo\reports" /E /G guests:rx  
  
Allow _guests_ the Full Control permission in "C:\demo\reports" and all subfolders  
XCACLS "C:\demo\reports" /T /E /G guests:f  
  
Grant _guests_ only read access to all files in and below "C:\demo\reports",  
new folders created will be Read Access only, new files will not inherit any rights.  
XCACLS "C:\demo\reports" /T /P guests:R;Tr  
  
Grant _guests_ only execute access to all files in and below "C:\demo\reports"  
XCACLS "C:\demo\reports" /T /P guests:x

“I spent most of the eighties, most of my life, riding around in somebody else's car, in possession of, or ingested of, something illegal, on my way from something illegal to something illegal with many illegal things happening all around me” - Iggy Pop

### Related commands

[ATTRIB](../nt/attrib.html) - Display or change file attributes.  
[CACLS](../nt/cacls.html) - Change file and folder permissions (ACLs).  
[iCACLS](icacls.html) - Change file and folder permissions (ACLs).  
[SUBINACL](subinacl.html) - Edit file and folder Permissions, Ownership and/or Domain.  
[DIR /Q](dir.html) - Display the owner for a list of files (try it for Program files).  
[AccessEnum](https://docs.microsoft.com/en-gb/sysinternals/downloads/sysinternals-suite) - SysInternals utility to browse a tree view of user privileges.  
[NTRIGHTS](ntrights.html) - Edit user account rights.  
[PERMS](perms.html) - Show permissions for a user.  
[SetObjectSecurity](setobjectsecurity.html) - Set security for an object (file, directory, reg key etc).  
[SUBINACL](subinacl.html) - Change an ACL's user/domain.  
[TAKEOWN](takeown.html) - Take ownership of files.  
How-to: [Permissions & Local/Global Workgroups](syntax-permissions.html)  
[Permissions explained](https://go.microsoft.com/fwlink/?LinkId=48679) - Microsoft.com  
[Access-based Enumeration](net-share.html) - Set file listing to only display files you can read.  
[Q822790](https://web.archive.org/web/20130622002005/https://support.microsoft.com/kb/822790) - Xcacls /E - Objects do not inherit permissions as expected.  
[SetAcl](https://helgeklein.com/setacl/) - ACL utility from Helge Klein.  
PowerShell: [Set-Acl](../ps/set-acl.html) - Set permissions.  
Equivalent bash command (Linux): [chmod](../bash/chmod.html) - Change access permissions, [chown](../bash/chown.html) - Change file owner and group.



/. nt/xcopy.html
========================================================

    Xcopy - Copy files and folders - Windows CMD - SS64.com

XCOPY
=====

Copy files and/or directory trees to another folder. XCOPY is similar to the COPY command except that it has additional switches to specify both the source and destination in detail.

Syntax

      XCOPY _source_ [_destination_] [_options_]  
Key
    _source_      : Pathname for the file(s) to be copied (accepts [wildcards](syntax-wildcards.html)).
                   C:\demo.txt     Filename with extension.
                   C:\demo         Filename without extension.
                   C:\demo\        Folder.
                   C:\demo*.txt   Folder with wildcard.

    _destination_ : Pathname for the new file(s).
   
    [options] can be any combination of the following:
      
Source Options
      
    /A    Copy files with the archive attribute set (default=Y)  
    /M    Copy files with the archive attribute set and
         turn off the archive attribute, use this option
         when making regular Backups (default=Y)
                                   
    /H    Copy hidden and system files and folders (default=N)  
    /D:_mm-dd-yyyy_
         Copy files changed on or after the specified date.
         If no date is given, copy only files whose
         source date/time is newer than the destination time.  
    /U    Copy only files that already exist in destination.
   
    /S    Copy folders and subfolders  
    /E    Copy folders and subfolders, including Empty folders.
         can be used to modify /T.

    /EXCLUDE:_file1_[+_file2_][+_file3_]...

         The files can each contain one or more full or partial pathnames to be excluded.
         When any of these match any part of the absolute path of a SOURCE file, then 
         that file will be excluded.
         For example, specifying a string like \obj\ or .obj will exclude
         all files underneath the directory obj or all files with the
         .obj extension respectively.
               
Copy Options
               
    /B    Copy the Symbolic link itself, not the target of the file.
    /C    Continue copying even if an error occurs.
    /F    Display full source and destination file names while copying.
    /G    Allow the copying of encrypted files to a destination that does not support encryption.
    /L    List only, Display files that would be copied.
    /Q    Do not display file names while copying.
    /V    [Verify](verify.html) that the new files are readable.
    /W    Prompt you to press a key before starting to copy.
    /P    Prompt before creating each file.
    /Y    Suppress prompt to confirm overwriting a file.
         can be preset in the COPYCMD env variable.
    /-Y   Prompt to confirm overwriting a file.


Performance tweaks

    /COMPRESS  Request [SMB network compression](https://www.youtube.com/watch?v=_iP3Dge1U6w) during file transfer, if applicable.
    /J         Copy using unbuffered I/O. Recommended for very large files.
    /Z         Copy files in restartable mode. If the copy is interrupted part way through,
              it will restart if possible. use with caution as this significantly
              reduces copy performance due to the extra logging.

Destination Options  
 
    /I    If in doubt always assume the destination is a folder
         e.g. when the destination does not exist.

    /R    Overwrite read-only files.  
    /T    Create folder structure, but do not copy files. 
         Do not include empty folders or subfolders.   
          /T /E will include empty folders and subfolders.  
    /K    Copy attributes. XCOPY will otherwise reset read-only attributes.  
  
    /N    If at all possible, use only a short filename (8.3) when creating
         a destination file. This can be necessary when copying between disks
         that are formatted differently e.g NTFS and VFAT, or when archiving 
         data to an ISO9660 CDROM.

    /O    Copy file Ownership and ACL information.

    /X    Copy file audit settings (implies /O).

XCOPY will accept UNC pathnames**.**

If the source directory contains a [symbolic link](mklink.html) XCOPY will create a matching directory in the destination on the first run (if one doesn’t already exist) but all subsequent XCOPY operations will then fail returning errorlevel 4. Use [Robocopy](robocopy.html) to avoid this.

To always overwrite destination files use the COPYCMD environment variable: SET COPYCMD=/Y  
  
XCOPY is particularly useful when copying files from CDROM to a hard drive, as it will automatically remove the read-only attribute.

When comparing Dates/Times the granularity (the finest increment of the timestamp) is 2 seconds for a FAT volume and 0.1 microsecond for an NTFS volume.

Copy a single file
------------------

> In many cases copying a single file is best done with the [COPY](copy.html) command. When copying a single file with XCOPY, there is no option to indicate if the destination is a filename or a directory (with the filename defaulting to that of the source file).  
> In such cases XCOPY will prompt with a (locale specific) message like:  
>   
> C:> xcopy C:\demo\foo.txt C:\demo\bar.txt  
> Does C:\demo\foo.txt specify a file name  
> or directory name on the target  
> (F = file, D = directory)?
> 
> Adding a wildcard (*) to the end of the destination will suppress this prompt and default to copying as a file:  
>   
> C:> xcopy foo.txt bar.txt*  
> C:foo.txt  
> 1 File(s) copied  
> This requires the source and target file extensions to be the same length, typically 3 characters.

Insufficient Memory error
-------------------------

> Attempting to XCOPY a source file that has a pathname longer than the Windows [maximum path](syntax-filenames.html) length (254 characters) will result in a rather unhelpful 'Insufficient Memory' error, the operation will then halt. This bug which has been around for over 10 years makes XCOPY a poor choice for any kind of backup script, use [ROBOCOPY](robocopy.html) instead.

Comparison with Robocopy
------------------------

> In 2007 XCOPY was [deprecated](https://docs.microsoft.com/en-gb/archive/blogs/matt_pietrek/robocopy-built-into-vista) in favor of [Robocopy](robocopy.html), but it has since been given a reprieve and some new features added.
> 
> There is a lot of overlap between the two tools, Robocopy is generally better (more 'robust') at copying very large directories.
> 
> In XCOPY the *.* filename-mask is required to match all files, in robocopy this is not needed as it is the default action.  
> The XCOPY /D option will copy only files whose source date/time is newer than the destination time, this is also a default action for Robocopy.  
> To exclude files (XCOPY /exclude) use the Robocopy options /XF (exclude files) and /XD (exclude directories).  
> For multiple exclusions, use Robocopy /JOB files_to_exclude.rcj

Exit Codes
----------

> 0 Files were copied without error.  
> 1 No files were found to copy.  
> 2 The user pressed CTRL+C to terminate xcopy.  
> 4 Initialization error occurred. There is not enough memory or disk space, or you entered an invalid drive name or invalid syntax on the command line. In the case of symbolic links: the destination folder already exists.  
> 5 Disk write error occurred.

### Examples

Copy a file:  
echo F| XCOPY C:\demo\sourceFile.txt D:\work\DestFile.txt  
  
Copy all files within the 'demo' folder:  
XCOPY C:\demo\ D:\work\april\  
  
Copy all files within the 'source' folder and copy them to a subfolder called 'new':  
XCOPY C:\source\ C:\source\new /i  
or  
XCOPY C:\source\ C:\source\new\

Copy all files within the 'demo' folder plus all subfolders.  
XCOPY C:\demo* D:\work\april /s  

“It is easier to copy than to think, hence fashion” ~ Wallace Stevens

### Related commands

[COPY](copy.html) - Copy one or more files to another location.  
[DEL](del.html) - Delete files.  
[MOVE](move.html) - Move a file from one folder to another.  
[ROBOCOPY](robocopy.html) - Robust File and Folder Copy.  
PowerShell: [Copy-Item](../ps/copy-item.html) - Copy an item from one location to another.  
Equivalent bash command (Linux): [cp](../bash/cp.html) - Copy one or more files to another location.



/. nt/rem.html
========================================================

    Rem - Comment - Windows CMD - SS64.com

REM
===

In a batch file REM at the start of a line signifies a comment or REMARK.

An alternative is adding :: at the start of a line, this has a similar effect to REM. Double colons act like a [GOTO](goto.html) or [CALL](call.html) :label the second colon is invalid as a name but is still treated as a label, and so the line is always skipped.

### Examples

@ECHO OFF  
::  
:: First comment  
  
REM Second comment  
REM  
  
Echo Hello REM This remark is displayed by echo  
Echo Hello & REM This remark is ignored by echo  
  
Copy work.xls backup.xls [&](syntax-redirection.html):: We backed up the file  
  
Although you can use REM without a comment to add vertical spacing to a batch file, you can also use completely blank lines. The blank lines are ignored when processing the batch program.

The double-colon :: is not documented as a comment command. An important limitation of this is that as a label it can only be used at the beginning of the line. Also because the double colon is a command, it will be displayed if you run a batch file without [@ECHO](echo.html) OFF

A REM comment is slightly slower to process than :: (360µs versus 58µs per comment line)  
A REM comment is a documented command that may be used almost anywhere within a command line.  
  
C:> Echo This will work REM Echo But will this show  
This will work REM Echo But will this show

You can add a comment to the end of a command line using &REM or &::  
C:> Echo This will work &:: Echo this will not show  
This will work  
This approach works because ['&'](syntax-redirection.html) introduces a new command on the same line.

Multi-Line Comments
-------------------

> One approach to adding a large multi-line block of comment test is to use plain text and a [goto](goto.html) command to jump execution past the comments:
> 
> @Echo OFF
> Goto :START
> 
> Description can go here
> which can even include - | > characters
> 
> :START
> 
> The technique above will not work in the middle of a bracketed expression such as a FOR... DO(...) loop.  
> This is because a Goto command cannot be used inside brackets - it would break their context.  
>   
> Such cases can be handled by also putting the comment text within brackets, as below:
> 
> (
>   Echo the lines below are commented
>   Rem/||**(**
>     some comment text that will work within brackets.
>     The REM command always evaluates to TRUE so these
>     lines will never be executed.
>   **)**
> )

Comments within bracketed code blocks.
--------------------------------------

> When :: labels are used as comments within a [bracketed code block](syntax-brackets.html) or FOR command, the command processor will expect (not unreasonably) that every label is followed by at least one command. (That way if you jump to the label it will have something to execute.) In fact the CMD shell will attempt to execute the second line [even if it is formatted as a label](https://ss64.org/viewtopic.php?f=2&t=118).  
> Anything which is not a valid command, even a blank line or a closing parenthesis will cause a :: style comment to fail:
> 
> (
>  Echo This example will fail
>  :: some comment
> )
> 
> (  
>  :NormalLabel & Echo this will not be executed.  
>  :SecondaryLine & Echo This will be executed.  
> ) 
> 
> When working within parentheses/brackets it is safer to use REM for all comment lines.
> 
> (
>  REM something & Echo this will not be executed.
>  REM somethingelse & Echo This also will not be executed.
> )
> 
> However these do have to be on a separate line to any brackets:
> 
> (REM My comment & ECHO Something else)
> 
> The line above is equivalent to:  
> (REM  
> The REM wipes out everything following, including the close bracket which will typically break the script.

Bugs
----

> It is possible, (though rare) to [SUBST](subst.html) a drive with the character : resulting in the drive :: that will break the use of double colons as a remark.
> 
> A comment like the examples below will be interpreted as a command and will produce a fatal error:  
> ::%~  
> or  
> REM %~  
>   
> or similarly with a variable  
> set var=demo  
> rem %var:=  
> or  
> rem %var:*=  
>   
> There errors will terminate all further batch processing and return an error message:  
> _The following usage of the path operator in batch-parameter substitution is invalid: %~_  
> 
> This behaviour is a result of the [batch parsing rules](https://stackoverflow.com/questions/4094699/how-does-the-windows-command-interpreter-cmd-exe-parse-scripts/4095133#4095133) used by CMD.EXE and so is unlikely to ever change.
> 
> To avoid these issues, make sure your comments do not contain any % characters.

Inline comments
---------------

> We have covered adding a whole line comment and adding a comment at the end of a line, but sometimes there is a need to add a small comment in the middle of a line to explain some detail.
> 
> Batch variable [names](set.html) can contain spaces and punctuation, we can take advantage of this fact by typing our comment as a non-existent variable. Because it doesn’t exist, this variable will expand to nothing and so will have no effect when the script is run.
> 
> n.b. This only works in batch files, not directly at the command prompt.
> 
> To be sure that we don’t accidently choose a name which is in fact a real variable, start and end the comment with "="  
> 
> @Echo off  
> Echo This is an example of an %= Inline Comment =% in the middle of a line.
> 
> (Variable names starting with "=" are reserved for undocumented dynamic [variables](syntax-variables.html). Those dynamic variables never end with "=", so by using an "=" at both the start and end of our comment, there is [no](https://stackoverflow.com/a/12411082/1720814) possibility of a name clash.)  
> Limitations: the comment text cannot contain % or :

Registry Comments
-----------------

> Within a registry .REG file comments can be preceded by ;  
>   
> ;  
> ; Turn the NUMLOCK on at login  
> ;  
> [HKEY_CURRENT_USER\Control Panel\Keyboard]  
> "InitialKeyboardIndicators"="2"

FTP Comments
------------

> There is no valid comment character for [FTP](ftp.html) but you can cheat by escaping to the shell and running REM  
> e.g.  
>   
> C:\WORK>type ftpscript  
> !REM This is a remark  
> bye
> 
> C:\WORK>ftp -s:ftpscript  
> ftp> !REM This is a remark  
> ftp> bye
> 
> C:\WORK>

REM does not set or clear the [Errorlevel](errorlevel.html).  
REM is an [internal](syntax-internal.html) command.

_“_I can’t stand a naked light bulb, any more than I can a rude remark or a vulgar action_”_ ~ Tennessee Williams

### Related commands

In the text editor, Notepad++ you can add REM to the beginning of multiple lines: Select them and hit Ctrl-Q  
Equivalent PowerShell: # - Comment / Remark.  
Equivalent bash command: [#](../bash/rem.html) - Comment / Remark.

